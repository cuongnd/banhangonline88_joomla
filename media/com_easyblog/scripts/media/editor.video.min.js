EasyBlog.module("media/editor.video",function(e){var t=this;EasyBlog.require().view("media/editor.video","media/editor.video.player").done(function(){EasyBlog.Controller("Media.Editor.Video",{defaultOptions:{view:{panel:"media/editor.video",player:"media/editor.video.player"},player:{width:400,height:225,autostart:!1,controlbar:"bottom",backcolor:"#333333",frontcolor:"#ffffff",modes:[{type:"html5"},{type:"flash",src:e.rootPath+"components/com_easyblog/assets/vendors/jwplayer/player.swf"},{type:"download"}]},"{editorPreview}":".editorPreview","{editorPanel}":".editorPanel","{playerContainer}":".playerContainer","{insertWidth}":".insertWidth","{insertHeight}":".insertHeight","{autoplay}":".autoplay"}},function(t){var n,r,i;return{init:function(){n=t.media,r=n.library,i=n.browser;var e=t.meta(),s=n.options.exporter.video.width,o=n.options.exporter.video.height;s!==undefined&&(t.options.player.width=s),o!==undefined&&(t.options.player.height=o),t.editorPanel().html(t.view.panel({meta:e,insertWidth:t.options.player.width,insertHeight:t.options.player.height})).implement(EasyBlog.Controller.Media.Editor.Panel,{},function(){t.panel=this}),t.editorPreview().implement(EasyBlog.Controller.Media.Editor.Preview,{},function(){t.preview=this,t.initPlayer()})},initPlayer:function(){t.preview.showDialog("loading"),EasyBlog.require().script(e.rootPath+"/components/com_easyblog/assets/vendors/jwplayer/jwplayer.js").done(function(e){var n=t.meta(),r=t.place(),i="player-"+e.uid(),s=e.extend(t.options.player,{id:i,file:t.meta().url}),o=t.view.player({id:i,meta:n,options:s});t.preview.container().append(o),t.player=jwplayer(i).setup(s),t.preview.resetLayout(),t.preview.hideDialog("loading")}).fail(function(){})},meta:function(){return r.getMeta(t.key)},place:function(){return r.getPlace(t.meta().place)},setLayout:function(){},"{self} cancelItem":function(){t.player&&t.player.getState()=="PLAYING"&&t.player.pause()},"{self} insertItem":function(){var e={autostart:t.autoplay().val()=="1"?!0:!1,width:parseInt(t.insertWidth().val(),10),height:parseInt(t.insertHeight().val(),10)};n.insert(t.meta(),e)},resize:function(){if(t.player){var e=parseInt(t.insertWidth().val(),10),n=parseInt(t.insertHeight().val(),10);t.player.resize(e,n),t.preview.resetLayout()}},"{insertWidth} keyup":function(){t.resize()},"{insertHeight} keyup":function(){t.resize()}}}),t.resolve()})});
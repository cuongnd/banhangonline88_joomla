(function(){var e=function(e){var t=this,n=e,r=function(){(function(e,t,n){t.infinitescroll=function(n,r,i){this.element=t(i),this._create(n,r)},t.infinitescroll.defaults={loading:{finished:n,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:n},state:{isDuringAjax:!1,isInvalidPage:!1,isDestroyed:!1,isDone:!1,isPaused:!1,currPage:1},callback:n,debug:!1,behavior:n,binder:t(e),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:!1,pathParse:n,dataType:"html",appendCallback:!0,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:n,path:n},t.infinitescroll.prototype={_binding:function(t){var r=this,i=r.options;i.v="2.0b2.111027";if(!!i.behavior&&this["_binding_"+i.behavior]!==n){this["_binding_"+i.behavior].call(this);return}if(t!=="bind"&&t!=="unbind")return this._debug("Binding value  "+t+" not valid"),!1;t=="unbind"?this.options.binder.unbind("smartscroll.infscr."+r.options.infid):this.options.binder[t]("smartscroll.infscr."+r.options.infid,function(){r.scroll()}),this._debug("Binding",t)},_create:function(r,i){if(!this._validate(r))return!1;var s=this.options=t.extend(!0,{},t.infinitescroll.defaults,r),o=t(s.nextSelector).attr("href");s.contentSelector=s.contentSelector||this.element,s.loading.selector=s.loading.selector||s.contentSelector;if(!o){this._debug("Navigation selector not found");return}s.path=this._determinepath(o),s.loading.msg=t('<div id="infscr-loading"><img alt="Loading..." src="'+s.loading.img+'" /><div>'+s.loading.msgText+"</div></div>"),(new Image).src=s.loading.img,s.pixelsFromNavToBottom=t(document).height()-t(s.navSelector).offset().top,s.loading.start=s.loading.start||function(){t(s.navSelector).hide(),s.loading.msg.appendTo(s.loading.selector).show(s.loading.speed,function(){beginAjax(s)})},s.loading.finished=s.loading.finished||function(){s.loading.msg.fadeOut("normal")},s.callback=function(e,r){!!s.behavior&&e["_callback_"+s.behavior]!==n&&e["_callback_"+s.behavior].call(t(s.contentSelector)[0],r),i&&i.call(t(s.contentSelector)[0],r,s)},this._setup()},_debug:function(){if(this.options&&this.options.debug)return e.console&&console.log.call(console,arguments)},_determinepath:function(t){var r=this.options;if(!r.behavior||this["_determinepath_"+r.behavior]===n){if(!r.pathParse){if(t.match(/^(.*?)\b2\b(.*?$)/))t=t.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(t.match(/^(.*?)2(.*?$)/)){if(t.match(/^(.*?page=)2(\/.*|$)/))return t=t.match(/^(.*?page=)2(\/.*|$)/).slice(1),t;t=t.match(/^(.*?)2(.*?$)/).slice(1)}else{if(t.match(/^(.*?page=)1(\/.*|$)/))return t=t.match(/^(.*?page=)1(\/.*|$)/).slice(1),t;this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com."),r.state.isInvalidPage=!0}return this._debug("determinePath",t),t}return this._debug("pathParse manual"),r.pathParse(t,this.options.state.currPage+1)}this["_determinepath_"+r.behavior].call(this,t);return},_error:function(t){var r=this.options;if(!!r.behavior&&this["_error_"+r.behavior]!==n){this["_error_"+r.behavior].call(this,t);return}t!=="destroy"&&t!=="end"&&(t="unknown"),this._debug("Error",t),t=="end"&&this._showdonemsg(),r.state.isDone=!0,r.state.currPage=1,r.state.isPaused=!1,this._binding("unbind")},_loadcallback:function(i,s){var o=this.options,u=this.options.callback,a=o.state.isDone?"done":o.appendCallback?"append":"no-append",f;if(!!o.behavior&&this["_loadcallback_"+o.behavior]!==n){this["_loadcallback_"+o.behavior].call(this,i,s);return}switch(a){case"done":return this._showdonemsg(),!1;case"no-append":o.dataType=="html"&&(s="<div>"+s+"</div>",s=t(s).find(o.itemSelector));break;case"append":var l=i.children();if(l.length==0)return this._error("end");f=document.createDocumentFragment();while(i[0].firstChild)f.appendChild(i[0].firstChild);this._debug("contentSelector",t(o.contentSelector)[0]),t(o.contentSelector)[0].appendChild(f),s=l.get()}o.loading.finished.call(t(o.contentSelector)[0],o);if(o.animate){var c=t(e).scrollTop()+t("#infscr-loading").height()+o.extraScrollPx+"px";t("html,body").animate({scrollTop:c},800,function(){o.state.isDuringAjax=!1})}o.animate||(o.state.isDuringAjax=!1),u(this,s)},_nearbottom:function(){var i=this.options,s=0+t(document).height()-i.binder.scrollTop()-t(e).height();return!i.behavior||this["_nearbottom_"+i.behavior]===n?(this._debug("math:",s,i.pixelsFromNavToBottom),s-i.bufferPx<i.pixelsFromNavToBottom):this["_nearbottom_"+i.behavior].call(this)},_pausing:function(t){var r=this.options;if(!r.behavior||this["_pausing_"+r.behavior]===n){t!=="pause"&&t!=="resume"&&t!==null&&this._debug("Invalid argument. Toggling pause value instead"),t=!t||t!="pause"&&t!="resume"?"toggle":t;switch(t){case"pause":r.state.isPaused=!0;break;case"resume":r.state.isPaused=!1;break;case"toggle":r.state.isPaused=!r.state.isPaused}return this._debug("Paused",r.state.isPaused),!1}this["_pausing_"+r.behavior].call(this,t);return},_setup:function(){var t=this.options;if(!t.behavior||this["_setup_"+t.behavior]===n)return this._binding("bind"),!1;this["_setup_"+t.behavior].call(this);return},_showdonemsg:function(){var r=this.options;if(!!r.behavior&&this["_showdonemsg_"+r.behavior]!==n){this["_showdonemsg_"+r.behavior].call(this);return}r.loading.msg.find("img").hide().parent().find("div").html(r.loading.finishedMsg).animate({opacity:1},2e3,function(){t(this).parent().fadeOut("normal")}),r.errorCallback.call(t(r.contentSelector)[0],"done")},_validate:function(n){for(var r in n)if(r.indexOf&&r.indexOf("Selector")>-1&&t(n[r]).length===0)return this._debug("Your "+r+" found no elements."),!1;return!0},bind:function(){this._binding("bind")},destroy:function(){return this.options.state.isDestroyed=!0,this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},retrieve:function(r){var i=this,s=i.options,o=s.path,u,a,f,l,c,r=r||null,h=r?r:s.state.currPage;beginAjax=function(n){n.state.currPage++,i._debug("heading into ajax",o),u=t(n.contentSelector).is("table")?t("<tbody/>"):t("<div/>"),f=o.join(n.state.currPage),l=n.dataType=="html"||n.dataType=="json"?n.dataType:"html+callback",n.appendCallback&&n.dataType=="html"&&(l+="+callback");switch(l){case"html+callback":i._debug("Using HTML via .load() method"),u.load(f+" "+n.itemSelector,null,function(t){i._loadcallback(u,t)});break;case"html":case"json":i._debug("Using "+l.toUpperCase()+" via $.ajax() method"),t.ajax({url:f,dataType:n.dataType,complete:function(t,n){c=typeof t.isResolved!="undefined"?t.isResolved():n==="success"||n==="notmodified",c?i._loadcallback(u,t.responseText):i._error("end")}})}};if(!!s.behavior&&this["retrieve_"+s.behavior]!==n){this["retrieve_"+s.behavior].call(this,r);return}if(s.state.isDestroyed)return this._debug("Instance is destroyed"),!1;s.state.isDuringAjax=!0,s.loading.start.call(t(s.contentSelector)[0],s)},scroll:function(){var t=this.options,r=t.state;if(!!t.behavior&&this["scroll_"+t.behavior]!==n){this["scroll_"+t.behavior].call(this);return}if(r.isDuringAjax||r.isInvalidPage||r.isDone||r.isDestroyed||r.isPaused)return;if(!this._nearbottom())return;this.retrieve()},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(n){t.isPlainObject(n)&&(this.options=t.extend(!0,this.options,n))}},t.fn.infinitescroll=function(n,r){var i=typeof n;switch(i){case"string":var s=Array.prototype.slice.call(arguments,1);this.each(function(){var e=t.data(this,"infinitescroll");if(!e)return!1;if(!t.isFunction(e[n])||n.charAt(0)==="_")return!1;e[n].apply(e,s)});break;case"object":this.each(function(){var e=t.data(this,"infinitescroll");e?e.update(n):t.data(this,"infinitescroll",new t.infinitescroll(n,r,this))})}return this};var r=t.event,i;r.special.smartscroll={setup:function(){t(this).bind("scroll",r.special.smartscroll.handler)},teardown:function(){t(this).unbind("scroll",r.special.smartscroll.handler)},handler:function(e,n){var r=this,s=arguments;e.type="smartscroll",i&&clearTimeout(i),i=setTimeout(function(){t.event.handle.apply(r,s)},n==="execAsap"?0:100)}},t.fn.smartscroll=function(e){return e?this.bind("smartscroll",e):this.trigger("smartscroll",["execAsap"])}})(window,n)};r(),t.resolveWith(r)};dispatch("infinitescroll").containing(e).to("Foundry/2.1 Modules")})();
dispatch.to("Foundry/2.1 Core Plugins").at(function($,manifest){var Component=$.Component=function(e,t,n){return arguments.length<1?Component.registry:arguments.length<2?Component.registry[e]:Component.register(e,t,n)};Component.registry={},Component.proxy=function(e,t,n){$.isFunction(n)?e[t]=$.proxy(n,e):e[t]=n},Component.register=function(name,options,callback){var queue=window[name]?window[name].queue||[]:[],self=Component.registry[name]=window[name]=function(e){return $.isFunction(e)?e($):component};$.each(Component.prototype,function(e,t){Component.proxy(self,e,t)}),self.$=$,self.options=options,self.className=name,self.identifier=name.toLowerCase(),self.componentName="com_"+self.identifier,self.version=options.version,self.safeVersion=self.version.replace(/\./g,""),self.environment=options.environment||$.environment,self.debug=self.environment=="development",self.language=options.language||$.locale.lang||"en",self.baseUrl=options.baseUrl||$.indexUrl+"?option="+self.componentName,self.scriptPath=options.scriptPath||$.rootPath+"media/"+self.componentName+(self.debug?"/scripts_/":"/scripts/"),self.templatePath=options.templatePath||options.scriptPath,self.languagePath=options.languagePath||self.baseUrl+"&tmpl=component&no_html=1&controller=lang&task=getLanguage",self.viewPath=options.viewPath||self.baseUrl+"&tmpl=component&no_html=1&controller=themes&task=getAjaxTemplate",self.prefix=self.identifier+"/",self.optimizeResources=options.optimizeResources||self.environment==="optimized"?!0:!1,self.resourcePath=options.resourcePath||self.baseUrl+"&tmpl=component&no_html=1&controller=foundry&task=getResource",self.resourceCollectionInterval=1200,self.scriptVersioning=options.scriptVersioning||!1,self.initRecovery=options.initRecovery||!1,self.isReady=!1,self.dependencies=$.Deferred(),self.console=function(e){if(!self.debug)return;var t=window.console;if(!t)return;var e=t[e];if(!e)return;var n=$.makeArray(arguments).slice(1);e.apply?e.apply(t,n):e(n.join(" "))};var resolveComponent=function(){self.dependencies.resolve(),self.ready(function(){self.isReady=!0,self.run(callback)})};if($.isFunction(options.dependencies)){var require=self.require({loadingComponentDependencies:!0});options.dependencies.call(self,require),require.done(resolveComponent)}else resolveComponent();$.each(queue,function(e,t){$.isPlainObject(t)&&self[t.method].apply(self,t.args);if($.isArray(t)){var n=t,r=self;$.each(n,function(e,t){r=r[t.method].apply(r,t.args)})}}),self.initRecovery&&$(document).ready(function(){if(self.module("init").state()!=="pending")return;var initializer=$("script[data-id='"+self.identifier+"-init']")[0];if(!initializer)return;try{eval(initializer.innerHTML)}catch(e){throw"Unable to recover component initializer for "+self.className+". "+e}})},Component.extend=function(e,t){Component.prototype[e]=t,$.each(Component.registry,function(n,r){Component.proxy(r,e,t)})},$.extend(Component.prototype,{run:function(e){return $.isFunction(e)?e($):component},ready:function(e){if(!$.isFunction(e))return;var t=this;$.module("component/mvc").done(function(){t.dependencies.done(function(){$(document).ready(function(){t.run(e)})})})},template:function(e){var t=this;return e==undefined?$.grep($.template(),function(e){return e.indexOf(t.prefix)==0}):(arguments[0]=t.prefix+e,$.template.apply(null,arguments))},require:function(e){var t=this,e=e||{},n=$.require($.extend({path:t.scriptPath},e)),r={};return $.each(["library","script","language","template","done"],function(e,t){r[t]=n[t]}),n.resource=function(e){if(!$.isPlainObject(e))return;if(!e.type||!e.name||!$.isDeferred(e.loader))return;var r=this,i=t.resourceCollector;i||(i=t.resourceCollector=$.Deferred(),$.extend(i,{name:$.uid("ResourceCollector"),manifest:[],loaderList:[],loaders:[],load:function(){delete t.resourceCollector;if(i.manifest.length<0){i.resolve();return}$.Ajax({type:"POST",url:t.resourcePath,dataType:"json",data:{resource:i.manifest}}).done(function(e){if(!$.isArray(e)){i.reject("Server did not return a valid resource manifest.");return}$.each(e,function(e,t){var n=t.content;i.loaders[t.id][n!==undefined?"resolve":"reject"](n)})}),$.when.apply(null,i.loaderList).done(i.resolve).fail(i.reject)}}),setTimeout(i.load,t.resourceCollectionInterval));var s=e.id=$.uid("Resource");return i.loaders[s]=e.loader,i.loaderList.push(e.loader),delete e.loader,i.manifest.push(e),n},n.view=function(){var e=this,r=e.expand(arguments,{path:t.viewPath}),i={},s=r.options,o=$.map(r.names,function(r){var o=t.prefix+r,u=$.template.loader(o);/resolved|failed/.test(u.state())&&s.reload&&(u=u.reset()),e.addTask(u);if(u.state()!=="pending")return;if(t.optimizeResources){n.resource({type:"view",name:r,loader:u});return}return i[r]=u,r});return o.length>0&&$.Ajax({url:s.path,dataType:"json",data:{names:o}}).done(function(e){if(!$.isArray(e))return;$.each(e,function(e,t){var n=t.content;i[t.name][n!==undefined?"resolve":"reject"](n)})}),n},n.language=function(){var e=this,i=e.expand(arguments,{path:t.languagePath});return t.optimizeResources?$.each(i.names,function(t,r){var i=$.Deferred();i.name=r,i.done(function(e){$.language.add(r,e)}),e.addTask(i),n.resource({type:"language",name:r,loader:i})}):r.language.apply(n,[i.options].concat(i.names)),n},n.library=function(){var e=n.script;return n.script=r.script,r.library.apply(n,arguments),n.script=e,n},n.script=function(){var e=this,i=e.expand(arguments);return names=$.map(i.names,function(n){if($.isArray(n)||$.isUrl(n)||/^(\/|\.)/.test(n))return n;var r=t.prefix+n,s=$.uri(e.options.path).toPath("./"+n+"."+(i.options.extension||"js")+(t.scriptVersioning?"?version="+t.safeVersion:""))+"";return[[r,s,!0]]}),r.script.apply(n,names)},n.template=function(){var e=this,i=e.expand(arguments,{path:t.templatePath});return r.template.apply(n,[i.options].concat($.map(i.names,function(e){return[[t.prefix+e,e]]})))},n.done=function(i){return r.done.call(n,function(){$.module("component/mvc").done(e.loadingComponentDependencies?function(){i.call(t,$)}:function(){t.ready(i)})})},n},module:function(e,t){var n=this;if($.isArray(e))return;var r=n.prefix+e;return t?$.module.apply(null,[r,function(){var n=this;if(e==="init"){t.call(n,$);return}$.module("component/mvc").done(function(){t.call(n,$)})}]):$.module(r)}}),$.module("component/mvc",function(){var e=this;$.require().library("server","mvc/controller","mvc/model","mvc/model.list","mvc/view","mvc/view.ejs","mvc/lang.json").done(function(){$.Component.extend("ajax",function(e,t,n){var r=this,i={url:r.baseUrl,data:$.extend(t,{option:r.componentName,namespace:e})};i=$.extend(!0,i,r.options.ajax);var s=$("span#"+r.identifier+"-token input").attr("name");s&&(i.data[s]=1),i.data.hasOwnProperty("args")&&(i.data.args=$.toJSON(i.data.args));if($.isPlainObject(n)){if(n.type){switch(n.type){case"jsonp":n.dataType="jsonp",n.crossDomain=!0,i.data.transport="jsonp";break;case"iframe":n.iframe=!0,n.processData=!1,n.files=i.data.files,delete i.data.files,i.data.transport="iframe"}delete n.type}$.extend(i,n)}return $.isFunction(n)&&(i.success=n),$.server(i)}),$.Component.extend("Controller",function(){var e=this,t=$.makeArray(arguments),n=e.className+".Controller."+t[0],r,i;return t.length==1?$.String.getObject(t[0]):(t.length>2?(r=t[1],i=t[2]):(r={},i=t[1]),$.extend(r,{component:e}),$.Controller.apply(this,[n,r,i]))}),$.Component.extend("Model",function(){var e=this,t=$.makeArray(arguments),n=e.className+".Model."+t[0],r,i;return t.length==1?$.String.getObject(t[0]):(t.length==2&&(r={},i=t[1]),t.length>2&&(r=t[1],i=t[2]),$.extend(r,{component:e}),$.Model.apply(this,[n,r,i]))}),$.Component.extend("Model.List",function(){var e=this,t=$.makeArray(arguments),n=e.className+".Model.List."+t[0],r,i;return t.length==1?$.String.getObject(t[0]):(t.length==2&&(r={},i=t[1]),t.length>2&&(r=t[1],i=t[2]),$.extend(r,{component:e}),$.Model.List.apply(this,[n,r,i]))}),$.Component.extend("View",function(e){var t=this;return arguments.length<1?t.template():(arguments[0]=t.prefix+arguments[0],$.View.apply(this,arguments))}),e.resolve()})}),dispatch("Foundry/2.1").toAll()});
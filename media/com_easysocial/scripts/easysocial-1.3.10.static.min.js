(function(){var deletedIds=[];var slice=deletedIds.slice;var concat=deletedIds.concat;var push=deletedIds.push;var indexOf=deletedIds.indexOf;var class2type={};var toString=class2type.toString;var hasOwn=class2type.hasOwnProperty;var trim="".trim;var support={};var version="1.11.1pre",jQuery=function(selector,context){return new jQuery.fn.init(selector,context)},rtrim=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,rmsPrefix=/^-ms-/,rdashAlpha=/-([\da-z])/gi,fcamelCase=function(all,letter){return letter.toUpperCase()};jQuery.fn=jQuery.prototype={jquery:version,constructor:jQuery,selector:"",length:0,toArray:function(){return slice.call(this)},get:function(num){return num!=null?(num<0?this[num+this.length]:this[num]):slice.call(this)},pushStack:function(elems){var ret=jQuery.merge(this.constructor(),elems);ret.prevObject=this;ret.context=this.context;return ret},each:function(callback,args){return jQuery.each(this,callback,args)},map:function(callback){return this.pushStack(jQuery.map(this,function(elem,i){return callback.call(elem,i,elem)}))},slice:function(){return this.pushStack(slice.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(i){var len=this.length,j=+i+(i<0?len:0);return this.pushStack(j>=0&&j<len?[this[j]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:push,sort:deletedIds.sort,splice:deletedIds.splice};jQuery.extend=jQuery.fn.extend=function(){var src,copyIsArray,copy,name,options,clone,target=arguments[0]||{},i=1,length=arguments.length,deep=!1;if(typeof target==="boolean"){deep=target;target=arguments[i]||{};i++}
if(typeof target!=="object"&&!jQuery.isFunction(target)){target={}}
if(i===length){target=this;i--}
for(;i<length;i++){if((options=arguments[i])!=null){for(name in options){src=target[name];copy=options[name];if(target===copy){continue}
if(deep&&copy&&(jQuery.isPlainObject(copy)||(copyIsArray=jQuery.isArray(copy)))){if(copyIsArray){copyIsArray=!1;clone=src&&jQuery.isArray(src)?src:[]}else{clone=src&&jQuery.isPlainObject(src)?src:{}}
target[name]=jQuery.extend(deep,clone,copy)}else if(copy!==undefined){target[name]=copy}}}}
return target};jQuery.extend({expando:"jQuery"+(version+Math.random()).replace(/\D/g,""),isReady:!0,error:function(msg){throw new Error(msg)},noop:function(){},isFunction:function(obj){return jQuery.type(obj)==="function"},isArray:Array.isArray||function(obj){return jQuery.type(obj)==="array"},isWindow:function(obj){return obj!=null&&obj==obj.window},isNumeric:function(obj){return obj-parseFloat(obj)>=0},isEmptyObject:function(obj){var name;for(name in obj){return!1}
return!0},isPlainObject:function(obj){var key;if(!obj||jQuery.type(obj)!=="object"||obj.nodeType||jQuery.isWindow(obj)){return!1}
try{if(obj.constructor&&!hasOwn.call(obj,"constructor")&&!hasOwn.call(obj.constructor.prototype,"isPrototypeOf")){return!1}}catch(e){return!1}
if(support.ownLast){for(key in obj){return hasOwn.call(obj,key)}}
for(key in obj){}
return key===undefined||hasOwn.call(obj,key)},type:function(obj){if(obj==null){return obj+""}
return typeof obj==="object"||typeof obj==="function"?class2type[toString.call(obj)]||"object":typeof obj},globalEval:function(data){if(data&&jQuery.trim(data)){(window.execScript||function(data){window["eval"].call(window,data)})(data)}},camelCase:function(string){return string.replace(rmsPrefix,"ms-").replace(rdashAlpha,fcamelCase)},nodeName:function(elem,name){return elem.nodeName&&elem.nodeName.toLowerCase()===name.toLowerCase()},each:function(obj,callback,args){var value,i=0,length=obj.length,isArray=isArraylike(obj);if(args){if(isArray){for(;i<length;i++){value=callback.apply(obj[i],args);if(value===!1){break}}}else{for(i in obj){value=callback.apply(obj[i],args);if(value===!1){break}}}}else{if(isArray){for(;i<length;i++){value=callback.call(obj[i],i,obj[i]);if(value===!1){break}}}else{for(i in obj){value=callback.call(obj[i],i,obj[i]);if(value===!1){break}}}}
return obj},trim:trim&&!trim.call("\uFEFF\xA0")?function(text){return text==null?"":trim.call(text)}:function(text){return text==null?"":(text+"").replace(rtrim,"")},makeArray:function(arr,results){var ret=results||[];if(arr!=null){if(isArraylike(Object(arr))){jQuery.merge(ret,typeof arr==="string"?[arr]:arr)}else{push.call(ret,arr)}}
return ret},inArray:function(elem,arr,i){var len;if(arr){if(indexOf){return indexOf.call(arr,elem,i)}
len=arr.length;i=i?i<0?Math.max(0,len+i):i:0;for(;i<len;i++){if(i in arr&&arr[i]===elem){return i}}}
return-1},merge:function(first,second){var len=+second.length,j=0,i=first.length;while(j<len){first[i++]=second[j++]}
if(len!==len){while(second[j]!==undefined){first[i++]=second[j++]}}
first.length=i;return first},grep:function(elems,callback,invert){var callbackInverse,matches=[],i=0,length=elems.length,callbackExpect=!invert;for(;i<length;i++){callbackInverse=!callback(elems[i],i);if(callbackInverse!==callbackExpect){matches.push(elems[i])}}
return matches},map:function(elems,callback,arg){var value,i=0,length=elems.length,isArray=isArraylike(elems),ret=[];if(isArray){for(;i<length;i++){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}else{for(i in elems){value=callback(elems[i],i,arg);if(value!=null){ret.push(value)}}}
return concat.apply([],ret)},guid:1,proxy:function(fn,context){var args,proxy,tmp;if(typeof context==="string"){tmp=fn[context];context=fn;fn=tmp}
if(!jQuery.isFunction(fn)){return undefined}
args=slice.call(arguments,2);proxy=function(){return fn.apply(context||this,args.concat(slice.call(arguments)))};proxy.guid=fn.guid=fn.guid||jQuery.guid++;return proxy},now:function(){return+(new Date())},support:support});jQuery.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(i,name){class2type["[object "+name+"]"]=name.toLowerCase()});function isArraylike(obj){var length=obj.length,type=jQuery.type(obj);if(type==="function"||jQuery.isWindow(obj)){return!1}
if(obj.nodeType===1&&length){return!0}
return type==="array"||length===0||typeof length==="number"&&length>0&&(length-1)in obj}
var Sizzle=(function(window){var i,support,Expr,getText,isXML,compile,select,outermostContext,sortInput,hasDuplicate,setDocument,document,docElem,documentIsHTML,rbuggyQSA,rbuggyMatches,matches,contains,expando="sizzle"+ -(new Date()),preferredDoc=window.document,dirruns=0,done=0,classCache=createCache(),tokenCache=createCache(),compilerCache=createCache(),sortOrder=function(a,b){if(a===b){hasDuplicate=!0}
return 0},strundefined=typeof undefined,MAX_NEGATIVE=1<<31,hasOwn=({}).hasOwnProperty,arr=[],pop=arr.pop,push_native=arr.push,push=arr.push,slice=arr.slice,indexOf=arr.indexOf||function(elem){var i=0,len=this.length;for(;i<len;i++){if(this[i]===elem){return i}}
return-1},booleans="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",whitespace="[\\x20\\t\\r\\n\\f]",characterEncoding="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",identifier=characterEncoding.replace("w","w#"),attributes="\\["+whitespace+"*("+characterEncoding+")"+whitespace+"*(?:([*^$|!~]?=)"+whitespace+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+identifier+")|)|)"+whitespace+"*\\]",pseudos=":("+characterEncoding+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+attributes.replace(3,8)+")*)|.*)\\)|)",rtrim=new RegExp("^"+whitespace+"+|((?:^|[^\\\\])(?:\\\\.)*)"+whitespace+"+$","g"),rcomma=new RegExp("^"+whitespace+"*,"+whitespace+"*"),rcombinators=new RegExp("^"+whitespace+"*([>+~]|"+whitespace+")"+whitespace+"*"),rattributeQuotes=new RegExp("="+whitespace+"*([^\\]'\"]*?)"+whitespace+"*\\]","g"),rpseudo=new RegExp(pseudos),ridentifier=new RegExp("^"+identifier+"$"),matchExpr={"ID":new RegExp("^#("+characterEncoding+")"),"CLASS":new RegExp("^\\.("+characterEncoding+")"),"TAG":new RegExp("^("+characterEncoding.replace("w","w*")+")"),"ATTR":new RegExp("^"+attributes),"PSEUDO":new RegExp("^"+pseudos),"CHILD":new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+whitespace+"*(even|odd|(([+-]|)(\\d*)n|)"+whitespace+"*(?:([+-]|)"+whitespace+"*(\\d+)|))"+whitespace+"*\\)|)","i"),"bool":new RegExp("^(?:"+booleans+")$","i"),"needsContext":new RegExp("^"+whitespace+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+whitespace+"*((?:-\\d)?\\d*)"+whitespace+"*\\)|)(?=[^-]|$)","i")},rinputs=/^(?:input|select|textarea|button)$/i,rheader=/^h\d$/i,rnative=/^[^{]+\{\s*\[native \w/,rquickExpr=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,rsibling=/[+~]/,rescape=/'|\\/g,runescape=new RegExp("\\\\([\\da-f]{1,6}"+whitespace+"?|("+whitespace+")|.)","ig"),funescape=function(_,escaped,escapedWhitespace){var high="0x"+escaped-0x10000;return high!==high||escapedWhitespace?escaped:high<0?String.fromCharCode(high+0x10000):String.fromCharCode(high>>10|0xD800,high&0x3FF|0xDC00)};try{push.apply((arr=slice.call(preferredDoc.childNodes)),preferredDoc.childNodes);arr[preferredDoc.childNodes.length].nodeType}catch(e){push={apply:arr.length?function(target,els){push_native.apply(target,slice.call(els))}:function(target,els){var j=target.length,i=0;while((target[j++]=els[i++])){}
target.length=j-1}}}
function Sizzle(selector,context,results,seed){var match,elem,m,nodeType,i,groups,old,nid,newContext,newSelector;if((context?context.ownerDocument||context:preferredDoc)!==document){setDocument(context)}
context=context||document;results=results||[];if(!selector||typeof selector!=="string"){return results}
if((nodeType=context.nodeType)!==1&&nodeType!==9){return[]}
if(documentIsHTML&&!seed){if((match=rquickExpr.exec(selector))){if((m=match[1])){if(nodeType===9){elem=context.getElementById(m);if(elem&&elem.parentNode){if(elem.id===m){results.push(elem);return results}}else{return results}}else{if(context.ownerDocument&&(elem=context.ownerDocument.getElementById(m))&&contains(context,elem)&&elem.id===m){results.push(elem);return results}}}else if(match[2]){push.apply(results,context.getElementsByTagName(selector));return results}else if((m=match[3])&&support.getElementsByClassName&&context.getElementsByClassName){push.apply(results,context.getElementsByClassName(m));return results}}
if(support.qsa&&(!rbuggyQSA||!rbuggyQSA.test(selector))){nid=old=expando;newContext=context;newSelector=nodeType===9&&selector;if(nodeType===1&&context.nodeName.toLowerCase()!=="object"){groups=tokenize(selector);if((old=context.getAttribute("id"))){nid=old.replace(rescape,"\\$&")}else{context.setAttribute("id",nid)}
nid="[id='"+nid+"'] ";i=groups.length;while(i--){groups[i]=nid+toSelector(groups[i])}
newContext=rsibling.test(selector)&&testContext(context.parentNode)||context;newSelector=groups.join(",")}
if(newSelector){try{push.apply(results,newContext.querySelectorAll(newSelector));return results}catch(qsaError){}finally{if(!old){context.removeAttribute("id")}}}}}
return select(selector.replace(rtrim,"$1"),context,results,seed)}
function createCache(){var keys=[];function cache(key,value){if(keys.push(key+" ")>Expr.cacheLength){delete cache[keys.shift()]}
return(cache[key+" "]=value)}
return cache}
function markFunction(fn){fn[expando]=!0;return fn}
function assert(fn){var div=document.createElement("div");try{return!!fn(div)}catch(e){return!1}finally{if(div.parentNode){div.parentNode.removeChild(div)}
div=null}}
function addHandle(attrs,handler){var arr=attrs.split("|"),i=attrs.length;while(i--){Expr.attrHandle[arr[i]]=handler}}
function siblingCheck(a,b){var cur=b&&a,diff=cur&&a.nodeType===1&&b.nodeType===1&&(~b.sourceIndex||MAX_NEGATIVE)-(~a.sourceIndex||MAX_NEGATIVE);if(diff){return diff}
if(cur){while((cur=cur.nextSibling)){if(cur===b){return-1}}}
return a?1:-1}
function createInputPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type===type}}
function createButtonPseudo(type){return function(elem){var name=elem.nodeName.toLowerCase();return(name==="input"||name==="button")&&elem.type===type}}
function createPositionalPseudo(fn){return markFunction(function(argument){argument=+argument;return markFunction(function(seed,matches){var j,matchIndexes=fn([],seed.length,argument),i=matchIndexes.length;while(i--){if(seed[(j=matchIndexes[i])]){seed[j]=!(matches[j]=seed[j])}}})})}
function testContext(context){return context&&typeof context.getElementsByTagName!==strundefined&&context}
support=Sizzle.support={};isXML=Sizzle.isXML=function(elem){var documentElement=elem&&(elem.ownerDocument||elem).documentElement;return documentElement?documentElement.nodeName!=="HTML":!1};setDocument=Sizzle.setDocument=function(node){var hasCompare,doc=node?node.ownerDocument||node:preferredDoc,parent=doc.defaultView;if(doc===document||doc.nodeType!==9||!doc.documentElement){return document}
document=doc;docElem=doc.documentElement;documentIsHTML=!isXML(doc);if(parent&&parent!==parent.top){if(parent.addEventListener){parent.addEventListener("unload",function(){setDocument()},!1)}else if(parent.attachEvent){parent.attachEvent("onunload",function(){setDocument()})}}
support.attributes=assert(function(div){div.className="i";return!div.getAttribute("className")});support.getElementsByTagName=assert(function(div){div.appendChild(doc.createComment(""));return!div.getElementsByTagName("*").length});support.getElementsByClassName=rnative.test(doc.getElementsByClassName)&&assert(function(div){div.innerHTML="<div class='a'></div><div class='a i'></div>";div.firstChild.className="i";return div.getElementsByClassName("i").length===2});support.getById=assert(function(div){docElem.appendChild(div).id=expando;return!doc.getElementsByName||!doc.getElementsByName(expando).length});if(support.getById){Expr.find.ID=function(id,context){if(typeof context.getElementById!==strundefined&&documentIsHTML){var m=context.getElementById(id);return m&&m.parentNode?[m]:[]}};Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){return elem.getAttribute("id")===attrId}}}else{delete Expr.find.ID;Expr.filter.ID=function(id){var attrId=id.replace(runescape,funescape);return function(elem){var node=typeof elem.getAttributeNode!==strundefined&&elem.getAttributeNode("id");return node&&node.value===attrId}}}
Expr.find.TAG=support.getElementsByTagName?function(tag,context){if(typeof context.getElementsByTagName!==strundefined){return context.getElementsByTagName(tag)}}:function(tag,context){var elem,tmp=[],i=0,results=context.getElementsByTagName(tag);if(tag==="*"){while((elem=results[i++])){if(elem.nodeType===1){tmp.push(elem)}}
return tmp}
return results};Expr.find.CLASS=support.getElementsByClassName&&function(className,context){if(typeof context.getElementsByClassName!==strundefined&&documentIsHTML){return context.getElementsByClassName(className)}};rbuggyMatches=[];rbuggyQSA=[];if((support.qsa=rnative.test(doc.querySelectorAll))){assert(function(div){div.innerHTML="<select t=''><option selected=''></option></select>";if(div.querySelectorAll("[t^='']").length){rbuggyQSA.push("[*^$]="+whitespace+"*(?:''|\"\")")}
if(!div.querySelectorAll("[selected]").length){rbuggyQSA.push("\\["+whitespace+"*(?:value|"+booleans+")")}
if(!div.querySelectorAll(":checked").length){rbuggyQSA.push(":checked")}});assert(function(div){var input=doc.createElement("input");input.setAttribute("type","hidden");div.appendChild(input).setAttribute("name","D");if(div.querySelectorAll("[name=d]").length){rbuggyQSA.push("name"+whitespace+"*[*^$|!~]?=")}
if(!div.querySelectorAll(":enabled").length){rbuggyQSA.push(":enabled",":disabled")}
div.querySelectorAll("*,:x");rbuggyQSA.push(",.*:")})}
if((support.matchesSelector=rnative.test((matches=docElem.webkitMatchesSelector||docElem.mozMatchesSelector||docElem.oMatchesSelector||docElem.msMatchesSelector)))){assert(function(div){support.disconnectedMatch=matches.call(div,"div");matches.call(div,"[s!='']:x");rbuggyMatches.push("!=",pseudos)})}
rbuggyQSA=rbuggyQSA.length&&new RegExp(rbuggyQSA.join("|"));rbuggyMatches=rbuggyMatches.length&&new RegExp(rbuggyMatches.join("|"));hasCompare=rnative.test(docElem.compareDocumentPosition);contains=hasCompare||rnative.test(docElem.contains)?function(a,b){var adown=a.nodeType===9?a.documentElement:a,bup=b&&b.parentNode;return a===bup||!!(bup&&bup.nodeType===1&&(adown.contains?adown.contains(bup):a.compareDocumentPosition&&a.compareDocumentPosition(bup)&16))}:function(a,b){if(b){while((b=b.parentNode)){if(b===a){return!0}}}
return!1};sortOrder=hasCompare?function(a,b){if(a===b){hasDuplicate=!0;return 0}
var compare=!a.compareDocumentPosition-!b.compareDocumentPosition;if(compare){return compare}
compare=(a.ownerDocument||a)===(b.ownerDocument||b)?a.compareDocumentPosition(b):1;if(compare&1||(!support.sortDetached&&b.compareDocumentPosition(a)===compare)){if(a===doc||a.ownerDocument===preferredDoc&&contains(preferredDoc,a)){return-1}
if(b===doc||b.ownerDocument===preferredDoc&&contains(preferredDoc,b)){return 1}
return sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0}
return compare&4?-1:1}:function(a,b){if(a===b){hasDuplicate=!0;return 0}
var cur,i=0,aup=a.parentNode,bup=b.parentNode,ap=[a],bp=[b];if(!aup||!bup){return a===doc?-1:b===doc?1:aup?-1:bup?1:sortInput?(indexOf.call(sortInput,a)-indexOf.call(sortInput,b)):0}else if(aup===bup){return siblingCheck(a,b)}
cur=a;while((cur=cur.parentNode)){ap.unshift(cur)}
cur=b;while((cur=cur.parentNode)){bp.unshift(cur)}
while(ap[i]===bp[i]){i++}
return i?siblingCheck(ap[i],bp[i]):ap[i]===preferredDoc?-1:bp[i]===preferredDoc?1:0};return doc};Sizzle.matches=function(expr,elements){return Sizzle(expr,null,null,elements)};Sizzle.matchesSelector=function(elem,expr){if((elem.ownerDocument||elem)!==document){setDocument(elem)}
expr=expr.replace(rattributeQuotes,"='$1']");if(support.matchesSelector&&documentIsHTML&&(!rbuggyMatches||!rbuggyMatches.test(expr))&&(!rbuggyQSA||!rbuggyQSA.test(expr))){try{var ret=matches.call(elem,expr);if(ret||support.disconnectedMatch||elem.document&&elem.document.nodeType!==11){return ret}}catch(e){}}
return Sizzle(expr,document,null,[elem]).length>0};Sizzle.contains=function(context,elem){if((context.ownerDocument||context)!==document){setDocument(context)}
return contains(context,elem)};Sizzle.attr=function(elem,name){if((elem.ownerDocument||elem)!==document){setDocument(elem)}
var fn=Expr.attrHandle[name.toLowerCase()],val=fn&&hasOwn.call(Expr.attrHandle,name.toLowerCase())?fn(elem,name,!documentIsHTML):undefined;return val!==undefined?val:support.attributes||!documentIsHTML?elem.getAttribute(name):(val=elem.getAttributeNode(name))&&val.specified?val.value:null};Sizzle.error=function(msg){throw new Error("Syntax error, unrecognized expression: "+msg)};Sizzle.uniqueSort=function(results){var elem,duplicates=[],j=0,i=0;hasDuplicate=!support.detectDuplicates;sortInput=!support.sortStable&&results.slice(0);results.sort(sortOrder);if(hasDuplicate){while((elem=results[i++])){if(elem===results[i]){j=duplicates.push(i)}}
while(j--){results.splice(duplicates[j],1)}}
sortInput=null;return results};getText=Sizzle.getText=function(elem){var node,ret="",i=0,nodeType=elem.nodeType;if(!nodeType){while((node=elem[i++])){ret+=getText(node)}}else if(nodeType===1||nodeType===9||nodeType===11){if(typeof elem.textContent==="string"){return elem.textContent}else{for(elem=elem.firstChild;elem;elem=elem.nextSibling){ret+=getText(elem)}}}else if(nodeType===3||nodeType===4){return elem.nodeValue}
return ret};Expr=Sizzle.selectors={cacheLength:50,createPseudo:markFunction,match:matchExpr,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{"ATTR":function(match){match[1]=match[1].replace(runescape,funescape);match[3]=(match[4]||match[5]||"").replace(runescape,funescape);if(match[2]==="~="){match[3]=" "+match[3]+" "}
return match.slice(0,4)},"CHILD":function(match){match[1]=match[1].toLowerCase();if(match[1].slice(0,3)==="nth"){if(!match[3]){Sizzle.error(match[0])}
match[4]=+(match[4]?match[5]+(match[6]||1):2*(match[3]==="even"||match[3]==="odd"));match[5]=+((match[7]+match[8])||match[3]==="odd")}else if(match[3]){Sizzle.error(match[0])}
return match},"PSEUDO":function(match){var excess,unquoted=!match[5]&&match[2];if(matchExpr.CHILD.test(match[0])){return null}
if(match[3]&&match[4]!==undefined){match[2]=match[4]}else if(unquoted&&rpseudo.test(unquoted)&&(excess=tokenize(unquoted,!0))&&(excess=unquoted.indexOf(")",unquoted.length-excess)-unquoted.length)){match[0]=match[0].slice(0,excess);match[2]=unquoted.slice(0,excess)}
return match.slice(0,3)}},filter:{"TAG":function(nodeNameSelector){var nodeName=nodeNameSelector.replace(runescape,funescape).toLowerCase();return nodeNameSelector==="*"?function(){return!0}:function(elem){return elem.nodeName&&elem.nodeName.toLowerCase()===nodeName}},"CLASS":function(className){var pattern=classCache[className+" "];return pattern||(pattern=new RegExp("(^|"+whitespace+")"+className+"("+whitespace+"|$)"))&&classCache(className,function(elem){return pattern.test(typeof elem.className==="string"&&elem.className||typeof elem.getAttribute!==strundefined&&elem.getAttribute("class")||"")})},"ATTR":function(name,operator,check){return function(elem){var result=Sizzle.attr(elem,name);if(result==null){return operator==="!="}
if(!operator){return!0}
result+="";return operator==="="?result===check:operator==="!="?result!==check:operator==="^="?check&&result.indexOf(check)===0:operator==="*="?check&&result.indexOf(check)>-1:operator==="$="?check&&result.slice(-check.length)===check:operator==="~="?(" "+result+" ").indexOf(check)>-1:operator==="|="?result===check||result.slice(0,check.length+1)===check+"-":!1}},"CHILD":function(type,what,argument,first,last){var simple=type.slice(0,3)!=="nth",forward=type.slice(-4)!=="last",ofType=what==="of-type";return first===1&&last===0?function(elem){return!!elem.parentNode}:function(elem,context,xml){var cache,outerCache,node,diff,nodeIndex,start,dir=simple!==forward?"nextSibling":"previousSibling",parent=elem.parentNode,name=ofType&&elem.nodeName.toLowerCase(),useCache=!xml&&!ofType;if(parent){if(simple){while(dir){node=elem;while((node=node[dir])){if(ofType?node.nodeName.toLowerCase()===name:node.nodeType===1){return!1}}
start=dir=type==="only"&&!start&&"nextSibling"}
return!0}
start=[forward?parent.firstChild:parent.lastChild];if(forward&&useCache){outerCache=parent[expando]||(parent[expando]={});cache=outerCache[type]||[];nodeIndex=cache[0]===dirruns&&cache[1];diff=cache[0]===dirruns&&cache[2];node=nodeIndex&&parent.childNodes[nodeIndex];while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if(node.nodeType===1&&++diff&&node===elem){outerCache[type]=[dirruns,nodeIndex,diff];break}}}else if(useCache&&(cache=(elem[expando]||(elem[expando]={}))[type])&&cache[0]===dirruns){diff=cache[1]}else{while((node=++nodeIndex&&node&&node[dir]||(diff=nodeIndex=0)||start.pop())){if((ofType?node.nodeName.toLowerCase()===name:node.nodeType===1)&&++diff){if(useCache){(node[expando]||(node[expando]={}))[type]=[dirruns,diff]}
if(node===elem){break}}}}
diff-=last;return diff===first||(diff%first===0&&diff/first>=0)}}},"PSEUDO":function(pseudo,argument){var args,fn=Expr.pseudos[pseudo]||Expr.setFilters[pseudo.toLowerCase()]||Sizzle.error("unsupported pseudo: "+pseudo);if(fn[expando]){return fn(argument)}
if(fn.length>1){args=[pseudo,pseudo,"",argument];return Expr.setFilters.hasOwnProperty(pseudo.toLowerCase())?markFunction(function(seed,matches){var idx,matched=fn(seed,argument),i=matched.length;while(i--){idx=indexOf.call(seed,matched[i]);seed[idx]=!(matches[idx]=matched[i])}}):function(elem){return fn(elem,0,args)}}
return fn}},pseudos:{"not":markFunction(function(selector){var input=[],results=[],matcher=compile(selector.replace(rtrim,"$1"));return matcher[expando]?markFunction(function(seed,matches,context,xml){var elem,unmatched=matcher(seed,null,xml,[]),i=seed.length;while(i--){if((elem=unmatched[i])){seed[i]=!(matches[i]=elem)}}}):function(elem,context,xml){input[0]=elem;matcher(input,null,xml,results);return!results.pop()}}),"has":markFunction(function(selector){return function(elem){return Sizzle(selector,elem).length>0}}),"contains":markFunction(function(text){return function(elem){return(elem.textContent||elem.innerText||getText(elem)).indexOf(text)>-1}}),"lang":markFunction(function(lang){if(!ridentifier.test(lang||"")){Sizzle.error("unsupported lang: "+lang)}
lang=lang.replace(runescape,funescape).toLowerCase();return function(elem){var elemLang;do{if((elemLang=documentIsHTML?elem.lang:elem.getAttribute("xml:lang")||elem.getAttribute("lang"))){elemLang=elemLang.toLowerCase();return elemLang===lang||elemLang.indexOf(lang+"-")===0}}while((elem=elem.parentNode)&&elem.nodeType===1);return!1}}),"target":function(elem){var hash=window.location&&window.location.hash;return hash&&hash.slice(1)===elem.id},"root":function(elem){return elem===docElem},"focus":function(elem){return elem===document.activeElement&&(!document.hasFocus||document.hasFocus())&&!!(elem.type||elem.href||~elem.tabIndex)},"enabled":function(elem){return elem.disabled===!1},"disabled":function(elem){return elem.disabled===!0},"checked":function(elem){var nodeName=elem.nodeName.toLowerCase();return(nodeName==="input"&&!!elem.checked)||(nodeName==="option"&&!!elem.selected)},"selected":function(elem){if(elem.parentNode){elem.parentNode.selectedIndex}
return elem.selected===!0},"empty":function(elem){for(elem=elem.firstChild;elem;elem=elem.nextSibling){if(elem.nodeType<6){return!1}}
return!0},"parent":function(elem){return!Expr.pseudos.empty(elem)},"header":function(elem){return rheader.test(elem.nodeName)},"input":function(elem){return rinputs.test(elem.nodeName)},"button":function(elem){var name=elem.nodeName.toLowerCase();return name==="input"&&elem.type==="button"||name==="button"},"text":function(elem){var attr;return elem.nodeName.toLowerCase()==="input"&&elem.type==="text"&&((attr=elem.getAttribute("type"))==null||attr.toLowerCase()==="text")},"first":createPositionalPseudo(function(){return[0]}),"last":createPositionalPseudo(function(matchIndexes,length){return[length-1]}),"eq":createPositionalPseudo(function(matchIndexes,length,argument){return[argument<0?argument+length:argument]}),"even":createPositionalPseudo(function(matchIndexes,length){var i=0;for(;i<length;i+=2){matchIndexes.push(i)}
return matchIndexes}),"odd":createPositionalPseudo(function(matchIndexes,length){var i=1;for(;i<length;i+=2){matchIndexes.push(i)}
return matchIndexes}),"lt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;--i>=0;){matchIndexes.push(i)}
return matchIndexes}),"gt":createPositionalPseudo(function(matchIndexes,length,argument){var i=argument<0?argument+length:argument;for(;++i<length;){matchIndexes.push(i)}
return matchIndexes})}};Expr.pseudos.nth=Expr.pseudos.eq;for(i in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0}){Expr.pseudos[i]=createInputPseudo(i)}
for(i in{submit:!0,reset:!0}){Expr.pseudos[i]=createButtonPseudo(i)}
function setFilters(){}
setFilters.prototype=Expr.filters=Expr.pseudos;Expr.setFilters=new setFilters();function tokenize(selector,parseOnly){var matched,match,tokens,type,soFar,groups,preFilters,cached=tokenCache[selector+" "];if(cached){return parseOnly?0:cached.slice(0)}
soFar=selector;groups=[];preFilters=Expr.preFilter;while(soFar){if(!matched||(match=rcomma.exec(soFar))){if(match){soFar=soFar.slice(match[0].length)||soFar}
groups.push((tokens=[]))}
matched=!1;if((match=rcombinators.exec(soFar))){matched=match.shift();tokens.push({value:matched,type:match[0].replace(rtrim," ")});soFar=soFar.slice(matched.length)}
for(type in Expr.filter){if((match=matchExpr[type].exec(soFar))&&(!preFilters[type]||(match=preFilters[type](match)))){matched=match.shift();tokens.push({value:matched,type:type,matches:match});soFar=soFar.slice(matched.length)}}
if(!matched){break}}
return parseOnly?soFar.length:soFar?Sizzle.error(selector):tokenCache(selector,groups).slice(0)}
function toSelector(tokens){var i=0,len=tokens.length,selector="";for(;i<len;i++){selector+=tokens[i].value}
return selector}
function addCombinator(matcher,combinator,base){var dir=combinator.dir,checkNonElements=base&&dir==="parentNode",doneName=done++;return combinator.first?function(elem,context,xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){return matcher(elem,context,xml)}}}:function(elem,context,xml){var oldCache,outerCache,newCache=[dirruns,doneName];if(xml){while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){if(matcher(elem,context,xml)){return!0}}}}else{while((elem=elem[dir])){if(elem.nodeType===1||checkNonElements){outerCache=elem[expando]||(elem[expando]={});if((oldCache=outerCache[dir])&&oldCache[0]===dirruns&&oldCache[1]===doneName){return(newCache[2]=oldCache[2])}else{outerCache[dir]=newCache;if((newCache[2]=matcher(elem,context,xml))){return!0}}}}}}}
function elementMatcher(matchers){return matchers.length>1?function(elem,context,xml){var i=matchers.length;while(i--){if(!matchers[i](elem,context,xml)){return!1}}
return!0}:matchers[0]}
function multipleContexts(selector,contexts,results){var i=0,len=contexts.length;for(;i<len;i++){Sizzle(selector,contexts[i],results)}
return results}
function condense(unmatched,map,filter,context,xml){var elem,newUnmatched=[],i=0,len=unmatched.length,mapped=map!=null;for(;i<len;i++){if((elem=unmatched[i])){if(!filter||filter(elem,context,xml)){newUnmatched.push(elem);if(mapped){map.push(i)}}}}
return newUnmatched}
function setMatcher(preFilter,selector,matcher,postFilter,postFinder,postSelector){if(postFilter&&!postFilter[expando]){postFilter=setMatcher(postFilter)}
if(postFinder&&!postFinder[expando]){postFinder=setMatcher(postFinder,postSelector)}
return markFunction(function(seed,results,context,xml){var temp,i,elem,preMap=[],postMap=[],preexisting=results.length,elems=seed||multipleContexts(selector||"*",context.nodeType?[context]:context,[]),matcherIn=preFilter&&(seed||!selector)?condense(elems,preMap,preFilter,context,xml):elems,matcherOut=matcher?postFinder||(seed?preFilter:preexisting||postFilter)?[]:results:matcherIn;if(matcher){matcher(matcherIn,matcherOut,context,xml)}
if(postFilter){temp=condense(matcherOut,postMap);postFilter(temp,[],context,xml);i=temp.length;while(i--){if((elem=temp[i])){matcherOut[postMap[i]]=!(matcherIn[postMap[i]]=elem)}}}
if(seed){if(postFinder||preFilter){if(postFinder){temp=[];i=matcherOut.length;while(i--){if((elem=matcherOut[i])){temp.push((matcherIn[i]=elem))}}
postFinder(null,(matcherOut=[]),temp,xml)}
i=matcherOut.length;while(i--){if((elem=matcherOut[i])&&(temp=postFinder?indexOf.call(seed,elem):preMap[i])>-1){seed[temp]=!(results[temp]=elem)}}}}else{matcherOut=condense(matcherOut===results?matcherOut.splice(preexisting,matcherOut.length):matcherOut);if(postFinder){postFinder(null,results,matcherOut,xml)}else{push.apply(results,matcherOut)}}})}
function matcherFromTokens(tokens){var checkContext,matcher,j,len=tokens.length,leadingRelative=Expr.relative[tokens[0].type],implicitRelative=leadingRelative||Expr.relative[" "],i=leadingRelative?1:0,matchContext=addCombinator(function(elem){return elem===checkContext},implicitRelative,!0),matchAnyContext=addCombinator(function(elem){return indexOf.call(checkContext,elem)>-1},implicitRelative,!0),matchers=[function(elem,context,xml){return(!leadingRelative&&(xml||context!==outermostContext))||((checkContext=context).nodeType?matchContext(elem,context,xml):matchAnyContext(elem,context,xml))}];for(;i<len;i++){if((matcher=Expr.relative[tokens[i].type])){matchers=[addCombinator(elementMatcher(matchers),matcher)]}else{matcher=Expr.filter[tokens[i].type].apply(null,tokens[i].matches);if(matcher[expando]){j=++i;for(;j<len;j++){if(Expr.relative[tokens[j].type]){break}}
return setMatcher(i>1&&elementMatcher(matchers),i>1&&toSelector(tokens.slice(0,i-1).concat({value:tokens[i-2].type===" "?"*":""})).replace(rtrim,"$1"),matcher,i<j&&matcherFromTokens(tokens.slice(i,j)),j<len&&matcherFromTokens((tokens=tokens.slice(j))),j<len&&toSelector(tokens))}
matchers.push(matcher)}}
return elementMatcher(matchers)}
function matcherFromGroupMatchers(elementMatchers,setMatchers){var bySet=setMatchers.length>0,byElement=elementMatchers.length>0,superMatcher=function(seed,context,xml,results,outermost){var elem,j,matcher,matchedCount=0,i="0",unmatched=seed&&[],setMatched=[],contextBackup=outermostContext,elems=seed||byElement&&Expr.find.TAG("*",outermost),dirrunsUnique=(dirruns+=contextBackup==null?1:Math.random()||0.1),len=elems.length;if(outermost){outermostContext=context!==document&&context}
for(;i!==len&&(elem=elems[i])!=null;i++){if(byElement&&elem){j=0;while((matcher=elementMatchers[j++])){if(matcher(elem,context,xml)){results.push(elem);break}}
if(outermost){dirruns=dirrunsUnique}}
if(bySet){if((elem=!matcher&&elem)){matchedCount--}
if(seed){unmatched.push(elem)}}}
matchedCount+=i;if(bySet&&i!==matchedCount){j=0;while((matcher=setMatchers[j++])){matcher(unmatched,setMatched,context,xml)}
if(seed){if(matchedCount>0){while(i--){if(!(unmatched[i]||setMatched[i])){setMatched[i]=pop.call(results)}}}
setMatched=condense(setMatched)}
push.apply(results,setMatched);if(outermost&&!seed&&setMatched.length>0&&(matchedCount+setMatchers.length)>1){Sizzle.uniqueSort(results)}}
if(outermost){dirruns=dirrunsUnique;outermostContext=contextBackup}
return unmatched};return bySet?markFunction(superMatcher):superMatcher}
compile=Sizzle.compile=function(selector,match){var i,setMatchers=[],elementMatchers=[],cached=compilerCache[selector+" "];if(!cached){if(!match){match=tokenize(selector)}
i=match.length;while(i--){cached=matcherFromTokens(match[i]);if(cached[expando]){setMatchers.push(cached)}else{elementMatchers.push(cached)}}
cached=compilerCache(selector,matcherFromGroupMatchers(elementMatchers,setMatchers));cached.selector=selector}
return cached};select=Sizzle.select=function(selector,context,results,seed){var i,tokens,token,type,find,compiled=typeof selector==="function"&&selector,match=!seed&&tokenize((selector=compiled.selector||selector));results=results||[];if(match.length===1){tokens=match[0]=match[0].slice(0);if(tokens.length>2&&(token=tokens[0]).type==="ID"&&support.getById&&context.nodeType===9&&documentIsHTML&&Expr.relative[tokens[1].type]){context=(Expr.find.ID(token.matches[0].replace(runescape,funescape),context)||[])[0];if(!context){return results}else if(compiled){context=context.parentNode}
selector=selector.slice(tokens.shift().value.length)}
i=matchExpr.needsContext.test(selector)?0:tokens.length;while(i--){token=tokens[i];if(Expr.relative[(type=token.type)]){break}
if((find=Expr.find[type])){if((seed=find(token.matches[0].replace(runescape,funescape),rsibling.test(tokens[0].type)&&testContext(context.parentNode)||context))){tokens.splice(i,1);selector=seed.length&&toSelector(tokens);if(!selector){push.apply(results,seed);return results}
break}}}}(compiled||compile(selector,match))(seed,context,!documentIsHTML,results,rsibling.test(selector)&&testContext(context.parentNode)||context);return results};support.sortStable=expando.split("").sort(sortOrder).join("")===expando;support.detectDuplicates=!!hasDuplicate;setDocument();support.sortDetached=assert(function(div1){return div1.compareDocumentPosition(document.createElement("div"))&1});if(!assert(function(div){div.innerHTML="<a href='#'></a>";return div.firstChild.getAttribute("href")==="#"})){addHandle("type|href|height|width",function(elem,name,isXML){if(!isXML){return elem.getAttribute(name,name.toLowerCase()==="type"?1:2)}})}
if(!support.attributes||!assert(function(div){div.innerHTML="<input/>";div.firstChild.setAttribute("value","");return div.firstChild.getAttribute("value")===""})){addHandle("value",function(elem,name,isXML){if(!isXML&&elem.nodeName.toLowerCase()==="input"){return elem.defaultValue}})}
if(!assert(function(div){return div.getAttribute("disabled")==null})){addHandle(booleans,function(elem,name,isXML){var val;if(!isXML){return elem[name]===!0?name.toLowerCase():(val=elem.getAttributeNode(name))&&val.specified?val.value:null}})}
return Sizzle})(window);jQuery.find=Sizzle;jQuery.expr=Sizzle.selectors;jQuery.expr[":"]=jQuery.expr.pseudos;jQuery.unique=Sizzle.uniqueSort;jQuery.text=Sizzle.getText;jQuery.isXMLDoc=Sizzle.isXML;jQuery.contains=Sizzle.contains;var rneedsContext=jQuery.expr.match.needsContext;var rsingleTag=(/^<(\w+)\s*\/?>(?:<\/\1>|)$/);var risSimple=/^.[^:#\[\.,]*$/;function winnow(elements,qualifier,not){if(jQuery.isFunction(qualifier)){return jQuery.grep(elements,function(elem,i){return!!qualifier.call(elem,i,elem)!==not})}
if(qualifier.nodeType){return jQuery.grep(elements,function(elem){return(elem===qualifier)!==not})}
if(typeof qualifier==="string"){if(risSimple.test(qualifier)){return jQuery.filter(qualifier,elements,not)}
qualifier=jQuery.filter(qualifier,elements)}
return jQuery.grep(elements,function(elem){return(jQuery.inArray(elem,qualifier)>=0)!==not})}
jQuery.filter=function(expr,elems,not){var elem=elems[0];if(not){expr=":not("+expr+")"}
return elems.length===1&&elem.nodeType===1?jQuery.find.matchesSelector(elem,expr)?[elem]:[]:jQuery.find.matches(expr,jQuery.grep(elems,function(elem){return elem.nodeType===1}))};jQuery.fn.extend({find:function(selector){var i,ret=[],self=this,len=self.length;if(typeof selector!=="string"){return this.pushStack(jQuery(selector).filter(function(){for(i=0;i<len;i++){if(jQuery.contains(self[i],this)){return!0}}}))}
for(i=0;i<len;i++){jQuery.find(selector,self[i],ret)}
ret=this.pushStack(len>1?jQuery.unique(ret):ret);ret.selector=this.selector?this.selector+" "+selector:selector;return ret},filter:function(selector){return this.pushStack(winnow(this,selector||[],!1))},not:function(selector){return this.pushStack(winnow(this,selector||[],!0))},is:function(selector){return!!winnow(this,typeof selector==="string"&&rneedsContext.test(selector)?jQuery(selector):selector||[],!1).length}});var rootjQuery,document=window.document,rquickExpr=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,init=jQuery.fn.init=function(selector,context){var match,elem;if(!selector){return this}
if(typeof selector==="string"){if(selector.charAt(0)==="<"&&selector.charAt(selector.length-1)===">"&&selector.length>=3){match=[null,selector,null]}else{match=rquickExpr.exec(selector)}
if(match&&(match[1]||!context)){if(match[1]){context=context instanceof jQuery?context[0]:context;jQuery.merge(this,jQuery.parseHTML(match[1],context&&context.nodeType?context.ownerDocument||context:document,!0));if(rsingleTag.test(match[1])&&jQuery.isPlainObject(context)){for(match in context){if(jQuery.isFunction(this[match])){this[match](context[match])}else{this.attr(match,context[match])}}}
return this}else{elem=document.getElementById(match[2]);if(elem&&elem.parentNode){if(elem.id!==match[2]){return rootjQuery.find(selector)}
this.length=1;this[0]=elem}
this.context=document;this.selector=selector;return this}}else if(!context||context.jquery){return(context||rootjQuery).find(selector)}else{return this.constructor(context).find(selector)}}else if(selector.nodeType){this.context=this[0]=selector;this.length=1;return this}else if(jQuery.isFunction(selector)){return typeof rootjQuery.ready!=="undefined"?rootjQuery.ready(selector):selector(jQuery)}
if(selector.selector!==undefined){this.selector=selector.selector;this.context=selector.context}
return jQuery.makeArray(selector,this)};init.prototype=jQuery.fn;rootjQuery=jQuery(document);var rparentsprev=/^(?:parents|prev(?:Until|All))/,guaranteedUnique={children:!0,contents:!0,next:!0,prev:!0};jQuery.extend({dir:function(elem,dir,until){var matched=[],cur=elem[dir];while(cur&&cur.nodeType!==9&&(until===undefined||cur.nodeType!==1||!jQuery(cur).is(until))){if(cur.nodeType===1){matched.push(cur)}
cur=cur[dir]}
return matched},sibling:function(n,elem){var r=[];for(;n;n=n.nextSibling){if(n.nodeType===1&&n!==elem){r.push(n)}}
return r}});jQuery.fn.extend({has:function(target){var i,targets=jQuery(target,this),len=targets.length;return this.filter(function(){for(i=0;i<len;i++){if(jQuery.contains(this,targets[i])){return!0}}})},closest:function(selectors,context){var cur,i=0,l=this.length,matched=[],pos=rneedsContext.test(selectors)||typeof selectors!=="string"?jQuery(selectors,context||this.context):0;for(;i<l;i++){for(cur=this[i];cur&&cur!==context;cur=cur.parentNode){if(cur.nodeType<11&&(pos?pos.index(cur)>-1:cur.nodeType===1&&jQuery.find.matchesSelector(cur,selectors))){matched.push(cur);break}}}
return this.pushStack(matched.length>1?jQuery.unique(matched):matched)},index:function(elem){if(!elem){return(this[0]&&this[0].parentNode)?this.first().prevAll().length:-1}
if(typeof elem==="string"){return jQuery.inArray(this[0],jQuery(elem))}
return jQuery.inArray(elem.jquery?elem[0]:elem,this)},add:function(selector,context){return this.pushStack(jQuery.unique(jQuery.merge(this.get(),jQuery(selector,context))))},addBack:function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}});function sibling(cur,dir){do{cur=cur[dir]}while(cur&&cur.nodeType!==1);return cur}
jQuery.each({parent:function(elem){var parent=elem.parentNode;return parent&&parent.nodeType!==11?parent:null},parents:function(elem){return jQuery.dir(elem,"parentNode")},parentsUntil:function(elem,i,until){return jQuery.dir(elem,"parentNode",until)},next:function(elem){return sibling(elem,"nextSibling")},prev:function(elem){return sibling(elem,"previousSibling")},nextAll:function(elem){return jQuery.dir(elem,"nextSibling")},prevAll:function(elem){return jQuery.dir(elem,"previousSibling")},nextUntil:function(elem,i,until){return jQuery.dir(elem,"nextSibling",until)},prevUntil:function(elem,i,until){return jQuery.dir(elem,"previousSibling",until)},siblings:function(elem){return jQuery.sibling((elem.parentNode||{}).firstChild,elem)},children:function(elem){return jQuery.sibling(elem.firstChild)},contents:function(elem){return jQuery.nodeName(elem,"iframe")?elem.contentDocument||elem.contentWindow.document:jQuery.merge([],elem.childNodes)}},function(name,fn){jQuery.fn[name]=function(until,selector){var ret=jQuery.map(this,fn,until);if(name.slice(-5)!=="Until"){selector=until}
if(selector&&typeof selector==="string"){ret=jQuery.filter(selector,ret)}
if(this.length>1){if(!guaranteedUnique[name]){ret=jQuery.unique(ret)}
if(rparentsprev.test(name)){ret=ret.reverse()}}
return this.pushStack(ret)}});var rnotwhite=(/\S+/g);var optionsCache={};function createOptions(options){var object=optionsCache[options]={};jQuery.each(options.match(rnotwhite)||[],function(_,flag){object[flag]=!0});return object}
jQuery.Callbacks=function(options){options=typeof options==="string"?(optionsCache[options]||createOptions(options)):jQuery.extend({},options);var firing,memory,fired,firingLength,firingIndex,firingStart,list=[],stack=!options.once&&[],fire=function(data){memory=options.memory&&data;fired=!0;firingIndex=firingStart||0;firingStart=0;firingLength=list.length;firing=!0;for(;list&&firingIndex<firingLength;firingIndex++){if(list[firingIndex].apply(data[0],data[1])===!1&&options.stopOnFalse){memory=!1;break}}
firing=!1;if(list){if(stack){if(stack.length){fire(stack.shift())}}else if(memory){list=[]}else{self.disable()}}},self={add:function(){if(list){var start=list.length;(function add(args){jQuery.each(args,function(_,arg){var type=jQuery.type(arg);if(type==="function"){if(!options.unique||!self.has(arg)){list.push(arg)}}else if(arg&&arg.length&&type!=="string"){add(arg)}})})(arguments);if(firing){firingLength=list.length}else if(memory){firingStart=start;fire(memory)}}
return this},remove:function(){if(list){jQuery.each(arguments,function(_,arg){var index;while((index=jQuery.inArray(arg,list,index))>-1){list.splice(index,1);if(firing){if(index<=firingLength){firingLength--}
if(index<=firingIndex){firingIndex--}}}})}
return this},has:function(fn){return fn?jQuery.inArray(fn,list)>-1:!!(list&&list.length)},empty:function(){list=[];firingLength=0;return this},disable:function(){list=stack=memory=undefined;return this},disabled:function(){return!list},lock:function(){stack=undefined;if(!memory){self.disable()}
return this},locked:function(){return!stack},fireWith:function(context,args){if(list&&(!fired||stack)){args=args||[];args=[context,args.slice?args.slice():args];if(firing){stack.push(args)}else{fire(args)}}
return this},fire:function(){self.fireWith(this,arguments);return this},fired:function(){return!!fired}};return self};jQuery.extend({Deferred:function(func){var tuples=[["resolve","done",jQuery.Callbacks("once memory"),"resolved"],["reject","fail",jQuery.Callbacks("once memory"),"rejected"],["notify","progress",jQuery.Callbacks("memory")]],state="pending",promise={state:function(){return state},always:function(){deferred.done(arguments).fail(arguments);return this},then:function(){var fns=arguments;return jQuery.Deferred(function(newDefer){jQuery.each(tuples,function(i,tuple){var fn=jQuery.isFunction(fns[i])&&fns[i];deferred[tuple[1]](function(){var returned=fn&&fn.apply(this,arguments);if(returned&&jQuery.isFunction(returned.promise)){returned.promise().done(newDefer.resolve).fail(newDefer.reject).progress(newDefer.notify)}else{newDefer[tuple[0]+"With"](this===promise?newDefer.promise():this,fn?[returned]:arguments)}})});fns=null}).promise()},promise:function(obj){return obj!=null?jQuery.extend(obj,promise):promise}},deferred={};promise.pipe=promise.then;jQuery.each(tuples,function(i,tuple){var list=tuple[2],stateString=tuple[3];promise[tuple[1]]=list.add;if(stateString){list.add(function(){state=stateString},tuples[i^1][2].disable,tuples[2][2].lock)}
deferred[tuple[0]]=function(){deferred[tuple[0]+"With"](this===deferred?promise:this,arguments);return this};deferred[tuple[0]+"With"]=list.fireWith});promise.promise(deferred);if(func){func.call(deferred,deferred)}
return deferred},when:function(subordinate){var i=0,resolveValues=slice.call(arguments),length=resolveValues.length,remaining=length!==1||(subordinate&&jQuery.isFunction(subordinate.promise))?length:0,deferred=remaining===1?subordinate:jQuery.Deferred(),updateFunc=function(i,contexts,values){return function(value){contexts[i]=this;values[i]=arguments.length>1?slice.call(arguments):value;if(values===progressValues){deferred.notifyWith(contexts,values)}else if(!(--remaining)){deferred.resolveWith(contexts,values)}}},progressValues,progressContexts,resolveContexts;if(length>1){progressValues=new Array(length);progressContexts=new Array(length);resolveContexts=new Array(length);for(;i<length;i++){if(resolveValues[i]&&jQuery.isFunction(resolveValues[i].promise)){resolveValues[i].promise().done(updateFunc(i,resolveContexts,resolveValues)).fail(deferred.reject).progress(updateFunc(i,progressContexts,progressValues))}else{--remaining}}}
if(!remaining){deferred.resolveWith(resolveContexts,resolveValues)}
return deferred.promise()}});var readyList;jQuery.fn.ready=function(fn){jQuery.ready.promise().done(fn);return this};jQuery.extend({isReady:!1,readyWait:1,holdReady:function(hold){if(hold){jQuery.readyWait++}else{jQuery.ready(!0)}},ready:function(wait){if(wait===!0?--jQuery.readyWait:jQuery.isReady){return}
if(!document.body){return setTimeout(jQuery.ready)}
jQuery.isReady=!0;if(wait!==!0&&--jQuery.readyWait>0){return}
readyList.resolveWith(document,[jQuery]);if(jQuery.fn.trigger){jQuery(document).trigger("ready").off("ready")}}});function detach(){if(document.addEventListener){document.removeEventListener("DOMContentLoaded",completed,!1);window.removeEventListener("load",completed,!1)}else{document.detachEvent("onreadystatechange",completed);window.detachEvent("onload",completed)}}
function completed(){if(document.addEventListener||event.type==="load"||document.readyState==="complete"){detach();jQuery.ready()}}
jQuery.ready.promise=function(obj){if(!readyList){readyList=jQuery.Deferred();if(document.readyState==="complete"){setTimeout(jQuery.ready)}else if(document.addEventListener){document.addEventListener("DOMContentLoaded",completed,!1);window.addEventListener("load",completed,!1)}else{document.attachEvent("onreadystatechange",completed);window.attachEvent("onload",completed);var top=!1;try{top=window.frameElement==null&&document.documentElement}catch(e){}
if(top&&top.doScroll){(function doScrollCheck(){if(!jQuery.isReady){try{top.doScroll("left")}catch(e){return setTimeout(doScrollCheck,50)}
detach();jQuery.ready()}})()}}}
return readyList.promise(obj)};var strundefined=typeof undefined;var i;for(i in jQuery(support)){break}
support.ownLast=i!=="0";support.inlineBlockNeedsLayout=!1;jQuery(function(){var container,div,body=document.getElementsByTagName("body")[0];if(!body){return}
container=document.createElement("div");container.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px";div=document.createElement("div");body.appendChild(container).appendChild(div);if(typeof div.style.zoom!==strundefined){div.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1";if((support.inlineBlockNeedsLayout=(div.offsetWidth===3))){body.style.zoom=1}}
body.removeChild(container);container=div=null});(function(){var div=document.createElement("div");if(support.deleteExpando==null){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}
div=null})();jQuery.acceptData=function(elem){var noData=jQuery.noData[(elem.nodeName+" ").toLowerCase()],nodeType=+elem.nodeType||1;return nodeType!==1&&nodeType!==9?!1:!noData||noData!==!0&&elem.getAttribute("classid")===noData};var rbrace=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,rmultiDash=/([A-Z])/g;function dataAttr(elem,key,data){if(data===undefined&&elem.nodeType===1){var name="data-"+key.replace(rmultiDash,"-$1").toLowerCase();data=elem.getAttribute(name);if(typeof data==="string"){try{data=data==="true"?!0:data==="false"?!1:data==="null"?null:+data+""===data?+data:rbrace.test(data)?jQuery.parseJSON(data):data}catch(e){}
jQuery.data(elem,key,data)}else{data=undefined}}
return data}
function isEmptyDataObject(obj){var name;for(name in obj){if(name==="data"&&jQuery.isEmptyObject(obj[name])){continue}
if(name!=="toJSON"){return!1}}
return!0}
function internalData(elem,name,data,pvt){if(!jQuery.acceptData(elem)){return}
var ret,thisCache,internalKey=jQuery.expando,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[internalKey]:elem[internalKey]&&internalKey;if((!id||!cache[id]||(!pvt&&!cache[id].data))&&data===undefined&&typeof name==="string"){return}
if(!id){if(isNode){id=elem[internalKey]=deletedIds.pop()||jQuery.guid++}else{id=internalKey}}
if(!cache[id]){cache[id]=isNode?{}:{toJSON:jQuery.noop}}
if(typeof name==="object"||typeof name==="function"){if(pvt){cache[id]=jQuery.extend(cache[id],name)}else{cache[id].data=jQuery.extend(cache[id].data,name)}}
thisCache=cache[id];if(!pvt){if(!thisCache.data){thisCache.data={}}
thisCache=thisCache.data}
if(data!==undefined){thisCache[jQuery.camelCase(name)]=data}
if(typeof name==="string"){ret=thisCache[name];if(ret==null){ret=thisCache[jQuery.camelCase(name)]}}else{ret=thisCache}
return ret}
function internalRemoveData(elem,name,pvt){if(!jQuery.acceptData(elem)){return}
var thisCache,i,isNode=elem.nodeType,cache=isNode?jQuery.cache:elem,id=isNode?elem[jQuery.expando]:jQuery.expando;if(!cache[id]){return}
if(name){thisCache=pvt?cache[id]:cache[id].data;if(thisCache){if(!jQuery.isArray(name)){if(name in thisCache){name=[name]}else{name=jQuery.camelCase(name);if(name in thisCache){name=[name]}else{name=name.split(" ")}}}else{name=name.concat(jQuery.map(name,jQuery.camelCase))}
i=name.length;while(i--){delete thisCache[name[i]]}
if(pvt?!isEmptyDataObject(thisCache):!jQuery.isEmptyObject(thisCache)){return}}}
if(!pvt){delete cache[id].data;if(!isEmptyDataObject(cache[id])){return}}
if(isNode){jQuery.cleanData([elem],!0)}else if(support.deleteExpando||cache!=cache.window){delete cache[id]}else{cache[id]=null}}
jQuery.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(elem){elem=elem.nodeType?jQuery.cache[elem[jQuery.expando]]:elem[jQuery.expando];return!!elem&&!isEmptyDataObject(elem)},data:function(elem,name,data){return internalData(elem,name,data)},removeData:function(elem,name){return internalRemoveData(elem,name)},_data:function(elem,name,data){return internalData(elem,name,data,!0)},_removeData:function(elem,name){return internalRemoveData(elem,name,!0)}});jQuery.fn.extend({data:function(key,value){var i,name,data,elem=this[0],attrs=elem&&elem.attributes;if(key===undefined){if(this.length){data=jQuery.data(elem);if(elem.nodeType===1&&!jQuery._data(elem,"parsedAttrs")){i=attrs.length;while(i--){name=attrs[i].name;if(name.indexOf("data-")===0){name=jQuery.camelCase(name.slice(5));dataAttr(elem,name,data[name])}}
jQuery._data(elem,"parsedAttrs",!0)}}
return data}
if(typeof key==="object"){return this.each(function(){jQuery.data(this,key)})}
return arguments.length>1?this.each(function(){jQuery.data(this,key,value)}):elem?dataAttr(elem,key,jQuery.data(elem,key)):undefined},removeData:function(key){return this.each(function(){jQuery.removeData(this,key)})}});jQuery.extend({queue:function(elem,type,data){var queue;if(elem){type=(type||"fx")+"queue";queue=jQuery._data(elem,type);if(data){if(!queue||jQuery.isArray(data)){queue=jQuery._data(elem,type,jQuery.makeArray(data))}else{queue.push(data)}}
return queue||[]}},dequeue:function(elem,type){type=type||"fx";var queue=jQuery.queue(elem,type),startLength=queue.length,fn=queue.shift(),hooks=jQuery._queueHooks(elem,type),next=function(){jQuery.dequeue(elem,type)};if(fn==="inprogress"){fn=queue.shift();startLength--}
if(fn){if(type==="fx"){queue.unshift("inprogress")}
delete hooks.stop;fn.call(elem,next,hooks)}
if(!startLength&&hooks){hooks.empty.fire()}},_queueHooks:function(elem,type){var key=type+"queueHooks";return jQuery._data(elem,key)||jQuery._data(elem,key,{empty:jQuery.Callbacks("once memory").add(function(){jQuery._removeData(elem,type+"queue");jQuery._removeData(elem,key)})})}});jQuery.fn.extend({queue:function(type,data){var setter=2;if(typeof type!=="string"){data=type;type="fx";setter--}
if(arguments.length<setter){return jQuery.queue(this[0],type)}
return data===undefined?this:this.each(function(){var queue=jQuery.queue(this,type,data);jQuery._queueHooks(this,type);if(type==="fx"&&queue[0]!=="inprogress"){jQuery.dequeue(this,type)}})},dequeue:function(type){return this.each(function(){jQuery.dequeue(this,type)})},clearQueue:function(type){return this.queue(type||"fx",[])},promise:function(type,obj){var tmp,count=1,defer=jQuery.Deferred(),elements=this,i=this.length,resolve=function(){if(!(--count)){defer.resolveWith(elements,[elements])}};if(typeof type!=="string"){obj=type;type=undefined}
type=type||"fx";while(i--){tmp=jQuery._data(elements[i],type+"queueHooks");if(tmp&&tmp.empty){count++;tmp.empty.add(resolve)}}
resolve();return defer.promise(obj)}});var pnum=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source;var cssExpand=["Top","Right","Bottom","Left"];var isHidden=function(elem,el){elem=el||elem;return jQuery.css(elem,"display")==="none"||!jQuery.contains(elem.ownerDocument,elem)};var access=jQuery.access=function(elems,fn,key,value,chainable,emptyGet,raw){var i=0,length=elems.length,bulk=key==null;if(jQuery.type(key)==="object"){chainable=!0;for(i in key){jQuery.access(elems,fn,i,key[i],!0,emptyGet,raw)}}else if(value!==undefined){chainable=!0;if(!jQuery.isFunction(value)){raw=!0}
if(bulk){if(raw){fn.call(elems,value);fn=null}else{bulk=fn;fn=function(elem,key,value){return bulk.call(jQuery(elem),value)}}}
if(fn){for(;i<length;i++){fn(elems[i],key,raw?value:value.call(elems[i],i,fn(elems[i],key)))}}}
return chainable?elems:bulk?fn.call(elems):length?fn(elems[0],key):emptyGet};var rcheckableType=(/^(?:checkbox|radio)$/i);(function(){var fragment=document.createDocumentFragment(),div=document.createElement("div"),input=document.createElement("input");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a>";support.leadingWhitespace=div.firstChild.nodeType===3;support.tbody=!div.getElementsByTagName("tbody").length;support.htmlSerialize=!!div.getElementsByTagName("link").length;support.html5Clone=document.createElement("nav").cloneNode(!0).outerHTML!=="<:nav></:nav>";input.type="checkbox";input.checked=!0;fragment.appendChild(input);support.appendChecked=input.checked;div.innerHTML="<textarea>x</textarea>";support.noCloneChecked=!!div.cloneNode(!0).lastChild.defaultValue;fragment.appendChild(div);div.innerHTML="<input type='radio' checked='checked' name='t'/>";support.checkClone=div.cloneNode(!0).cloneNode(!0).lastChild.checked;support.noCloneEvent=!0;if(div.attachEvent){div.attachEvent("onclick",function(){support.noCloneEvent=!1});div.cloneNode(!0).click()}
if(support.deleteExpando==null){support.deleteExpando=!0;try{delete div.test}catch(e){support.deleteExpando=!1}}
fragment=div=input=null})();(function(){var i,eventName,div=document.createElement("div");for(i in{submit:!0,change:!0,focusin:!0}){eventName="on"+i;if(!(support[i+"Bubbles"]=eventName in window)){div.setAttribute(eventName,"t");support[i+"Bubbles"]=div.attributes[eventName].expando===!1}}
div=null})();var rformElems=/^(?:input|select|textarea)$/i,rkeyEvent=/^key/,rmouseEvent=/^(?:mouse|contextmenu)|click/,rfocusMorph=/^(?:focusinfocus|focusoutblur)$/,rtypenamespace=/^([^.]*)(?:\.(.+)|)$/;function returnTrue(){return!0}
function returnFalse(){return!1}
function safeActiveElement(){try{return document.activeElement}catch(err){}}
jQuery.event={global:{},add:function(elem,types,handler,data,selector){var tmp,events,t,handleObjIn,special,eventHandle,handleObj,handlers,type,namespaces,origType,elemData=jQuery._data(elem);if(!elemData){return}
if(handler.handler){handleObjIn=handler;handler=handleObjIn.handler;selector=handleObjIn.selector}
if(!handler.guid){handler.guid=jQuery.guid++}
if(!(events=elemData.events)){events=elemData.events={}}
if(!(eventHandle=elemData.handle)){eventHandle=elemData.handle=function(e){return typeof jQuery!==strundefined&&(!e||jQuery.event.triggered!==e.type)?jQuery.event.dispatch.apply(eventHandle.elem,arguments):undefined};eventHandle.elem=elem}
types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){continue}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;special=jQuery.event.special[type]||{};handleObj=jQuery.extend({type:type,origType:origType,data:data,handler:handler,guid:handler.guid,selector:selector,needsContext:selector&&jQuery.expr.match.needsContext.test(selector),namespace:namespaces.join(".")},handleObjIn);if(!(handlers=events[type])){handlers=events[type]=[];handlers.delegateCount=0;if(!special.setup||special.setup.call(elem,data,namespaces,eventHandle)===!1){if(elem.addEventListener){elem.addEventListener(type,eventHandle,!1)}else if(elem.attachEvent){elem.attachEvent("on"+type,eventHandle)}}}
if(special.add){special.add.call(elem,handleObj);if(!handleObj.handler.guid){handleObj.handler.guid=handler.guid}}
if(selector){handlers.splice(handlers.delegateCount++,0,handleObj)}else{handlers.push(handleObj)}
jQuery.event.global[type]=!0}
elem=null},remove:function(elem,types,handler,selector,mappedTypes){var j,handleObj,tmp,origCount,t,events,special,handlers,type,namespaces,origType,elemData=jQuery.hasData(elem)&&jQuery._data(elem);if(!elemData||!(events=elemData.events)){return}
types=(types||"").match(rnotwhite)||[""];t=types.length;while(t--){tmp=rtypenamespace.exec(types[t])||[];type=origType=tmp[1];namespaces=(tmp[2]||"").split(".").sort();if(!type){for(type in events){jQuery.event.remove(elem,type+types[t],handler,selector,!0)}
continue}
special=jQuery.event.special[type]||{};type=(selector?special.delegateType:special.bindType)||type;handlers=events[type]||[];tmp=tmp[2]&&new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)");origCount=j=handlers.length;while(j--){handleObj=handlers[j];if((mappedTypes||origType===handleObj.origType)&&(!handler||handler.guid===handleObj.guid)&&(!tmp||tmp.test(handleObj.namespace))&&(!selector||selector===handleObj.selector||selector==="**"&&handleObj.selector)){handlers.splice(j,1);if(handleObj.selector){handlers.delegateCount--}
if(special.remove){special.remove.call(elem,handleObj)}}}
if(origCount&&!handlers.length){if(!special.teardown||special.teardown.call(elem,namespaces,elemData.handle)===!1){jQuery.removeEvent(elem,type,elemData.handle)}
delete events[type]}}
if(jQuery.isEmptyObject(events)){delete elemData.handle;jQuery._removeData(elem,"events")}},trigger:function(event,data,elem,onlyHandlers){var handle,ontype,cur,bubbleType,special,tmp,i,eventPath=[elem||document],type=hasOwn.call(event,"type")?event.type:event,namespaces=hasOwn.call(event,"namespace")?event.namespace.split("."):[];cur=tmp=elem=elem||document;if(elem.nodeType===3||elem.nodeType===8){return}
if(rfocusMorph.test(type+jQuery.event.triggered)){return}
if(type.indexOf(".")>=0){namespaces=type.split(".");type=namespaces.shift();namespaces.sort()}
ontype=type.indexOf(":")<0&&"on"+type;event=event[jQuery.expando]?event:new jQuery.Event(type,typeof event==="object"&&event);event.isTrigger=onlyHandlers?2:3;event.namespace=namespaces.join(".");event.namespace_re=event.namespace?new RegExp("(^|\\.)"+namespaces.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;event.result=undefined;if(!event.target){event.target=elem}
data=data==null?[event]:jQuery.makeArray(data,[event]);special=jQuery.event.special[type]||{};if(!onlyHandlers&&special.trigger&&special.trigger.apply(elem,data)===!1){return}
if(!onlyHandlers&&!special.noBubble&&!jQuery.isWindow(elem)){bubbleType=special.delegateType||type;if(!rfocusMorph.test(bubbleType+type)){cur=cur.parentNode}
for(;cur;cur=cur.parentNode){eventPath.push(cur);tmp=cur}
if(tmp===(elem.ownerDocument||document)){eventPath.push(tmp.defaultView||tmp.parentWindow||window)}}
i=0;while((cur=eventPath[i++])&&!event.isPropagationStopped()){event.type=i>1?bubbleType:special.bindType||type;handle=(jQuery._data(cur,"events")||{})[event.type]&&jQuery._data(cur,"handle");if(handle){handle.apply(cur,data)}
handle=ontype&&cur[ontype];if(handle&&handle.apply&&jQuery.acceptData(cur)){event.result=handle.apply(cur,data);if(event.result===!1){event.preventDefault()}}}
event.type=type;if(!onlyHandlers&&!event.isDefaultPrevented()){if((!special._default||special._default.apply(eventPath.pop(),data)===!1)&&jQuery.acceptData(elem)){if(ontype&&elem[type]&&!jQuery.isWindow(elem)){tmp=elem[ontype];if(tmp){elem[ontype]=null}
jQuery.event.triggered=type;try{elem[type]()}catch(e){}
jQuery.event.triggered=undefined;if(tmp){elem[ontype]=tmp}}}}
return event.result},dispatch:function(event){event=jQuery.event.fix(event);var i,ret,handleObj,matched,j,handlerQueue=[],args=slice.call(arguments),handlers=(jQuery._data(this,"events")||{})[event.type]||[],special=jQuery.event.special[event.type]||{};args[0]=event;event.delegateTarget=this;if(special.preDispatch&&special.preDispatch.call(this,event)===!1){return}
handlerQueue=jQuery.event.handlers.call(this,event,handlers);i=0;while((matched=handlerQueue[i++])&&!event.isPropagationStopped()){event.currentTarget=matched.elem;j=0;while((handleObj=matched.handlers[j++])&&!event.isImmediatePropagationStopped()){if(!event.namespace_re||event.namespace_re.test(handleObj.namespace)){event.handleObj=handleObj;event.data=handleObj.data;ret=((jQuery.event.special[handleObj.origType]||{}).handle||handleObj.handler).apply(matched.elem,args);if(ret!==undefined){if((event.result=ret)===!1){event.preventDefault();event.stopPropagation()}}}}}
if(special.postDispatch){special.postDispatch.call(this,event)}
return event.result},handlers:function(event,handlers){var sel,handleObj,matches,i,handlerQueue=[],delegateCount=handlers.delegateCount,cur=event.target;if(delegateCount&&cur.nodeType&&(!event.button||event.type!=="click")){for(;cur!=this;cur=cur.parentNode||this){if(cur.nodeType===1&&(cur.disabled!==!0||event.type!=="click")){matches=[];for(i=0;i<delegateCount;i++){handleObj=handlers[i];sel=handleObj.selector+" ";if(matches[sel]===undefined){matches[sel]=handleObj.needsContext?jQuery(sel,this).index(cur)>=0:jQuery.find(sel,this,null,[cur]).length}
if(matches[sel]){matches.push(handleObj)}}
if(matches.length){handlerQueue.push({elem:cur,handlers:matches})}}}}
if(delegateCount<handlers.length){handlerQueue.push({elem:this,handlers:handlers.slice(delegateCount)})}
return handlerQueue},fix:function(event){if(event[jQuery.expando]){return event}
var i,prop,copy,type=event.type,originalEvent=event,fixHook=this.fixHooks[type];if(!fixHook){this.fixHooks[type]=fixHook=rmouseEvent.test(type)?this.mouseHooks:rkeyEvent.test(type)?this.keyHooks:{}}
copy=fixHook.props?this.props.concat(fixHook.props):this.props;event=new jQuery.Event(originalEvent);i=copy.length;while(i--){prop=copy[i];event[prop]=originalEvent[prop]}
if(!event.target){event.target=originalEvent.srcElement||document}
if(event.target.nodeType===3){event.target=event.target.parentNode}
event.metaKey=!!event.metaKey;return fixHook.filter?fixHook.filter(event,originalEvent):event},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(event,original){if(event.which==null){event.which=original.charCode!=null?original.charCode:original.keyCode}
return event}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(event,original){var body,eventDoc,doc,button=original.button,fromElement=original.fromElement;if(event.pageX==null&&original.clientX!=null){eventDoc=event.target.ownerDocument||document;doc=eventDoc.documentElement;body=eventDoc.body;event.pageX=original.clientX+(doc&&doc.scrollLeft||body&&body.scrollLeft||0)-(doc&&doc.clientLeft||body&&body.clientLeft||0);event.pageY=original.clientY+(doc&&doc.scrollTop||body&&body.scrollTop||0)-(doc&&doc.clientTop||body&&body.clientTop||0)}
if(!event.relatedTarget&&fromElement){event.relatedTarget=fromElement===event.target?original.toElement:fromElement}
if(!event.which&&button!==undefined){event.which=(button&1?1:(button&2?3:(button&4?2:0)))}
return event}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==safeActiveElement()&&this.focus){try{this.focus();return!1}catch(e){}}},delegateType:"focusin"},blur:{trigger:function(){if(this===safeActiveElement()&&this.blur){this.blur();return!1}},delegateType:"focusout"},click:{trigger:function(){if(jQuery.nodeName(this,"input")&&this.type==="checkbox"&&this.click){this.click();return!1}},_default:function(event){return jQuery.nodeName(event.target,"a")}},beforeunload:{postDispatch:function(event){if(event.result!==undefined){event.originalEvent.returnValue=event.result}}}},simulate:function(type,elem,event,bubble){var e=jQuery.extend(new jQuery.Event(),event,{type:type,isSimulated:!0,originalEvent:{}});if(bubble){jQuery.event.trigger(e,null,elem)}else{jQuery.event.dispatch.call(elem,e)}
if(e.isDefaultPrevented()){event.preventDefault()}}};jQuery.removeEvent=document.removeEventListener?function(elem,type,handle){if(elem.removeEventListener){elem.removeEventListener(type,handle,!1)}}:function(elem,type,handle){var name="on"+type;if(elem.detachEvent){if(typeof elem[name]===strundefined){elem[name]=null}
elem.detachEvent(name,handle)}};jQuery.Event=function(src,props){if(!(this instanceof jQuery.Event)){return new jQuery.Event(src,props)}
if(src&&src.type){this.originalEvent=src;this.type=src.type;this.isDefaultPrevented=src.defaultPrevented||src.defaultPrevented===undefined&&(src.returnValue===!1||src.getPreventDefault&&src.getPreventDefault())?returnTrue:returnFalse}else{this.type=src}
if(props){jQuery.extend(this,props)}
this.timeStamp=src&&src.timeStamp||jQuery.now();this[jQuery.expando]=!0};jQuery.Event.prototype={isDefaultPrevented:returnFalse,isPropagationStopped:returnFalse,isImmediatePropagationStopped:returnFalse,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=returnTrue;if(!e){return}
if(e.preventDefault){e.preventDefault()}else{e.returnValue=!1}},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=returnTrue;if(!e){return}
if(e.stopPropagation){e.stopPropagation()}
e.cancelBubble=!0},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=returnTrue;this.stopPropagation()}};jQuery.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(orig,fix){jQuery.event.special[orig]={delegateType:fix,bindType:fix,handle:function(event){var ret,target=this,related=event.relatedTarget,handleObj=event.handleObj;if(!related||(related!==target&&!jQuery.contains(target,related))){event.type=handleObj.origType;ret=handleObj.handler.apply(this,arguments);event.type=fix}
return ret}}});if(!support.submitBubbles){jQuery.event.special.submit={setup:function(){if(jQuery.nodeName(this,"form")){return!1}
jQuery.event.add(this,"click._submit keypress._submit",function(e){var elem=e.target,form=jQuery.nodeName(elem,"input")||jQuery.nodeName(elem,"button")?elem.form:undefined;if(form&&!jQuery._data(form,"submitBubbles")){jQuery.event.add(form,"submit._submit",function(event){event._submit_bubble=!0});jQuery._data(form,"submitBubbles",!0)}})},postDispatch:function(event){if(event._submit_bubble){delete event._submit_bubble;if(this.parentNode&&!event.isTrigger){jQuery.event.simulate("submit",this.parentNode,event,!0)}}},teardown:function(){if(jQuery.nodeName(this,"form")){return!1}
jQuery.event.remove(this,"._submit")}}}
if(!support.changeBubbles){jQuery.event.special.change={setup:function(){if(rformElems.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){jQuery.event.add(this,"propertychange._change",function(event){if(event.originalEvent.propertyName==="checked"){this._just_changed=!0}});jQuery.event.add(this,"click._change",function(event){if(this._just_changed&&!event.isTrigger){this._just_changed=!1}
jQuery.event.simulate("change",this,event,!0)})}
return!1}
jQuery.event.add(this,"beforeactivate._change",function(e){var elem=e.target;if(rformElems.test(elem.nodeName)&&!jQuery._data(elem,"changeBubbles")){jQuery.event.add(elem,"change._change",function(event){if(this.parentNode&&!event.isSimulated&&!event.isTrigger){jQuery.event.simulate("change",this.parentNode,event,!0)}});jQuery._data(elem,"changeBubbles",!0)}})},handle:function(event){var elem=event.target;if(this!==elem||event.isSimulated||event.isTrigger||(elem.type!=="radio"&&elem.type!=="checkbox")){return event.handleObj.handler.apply(this,arguments)}},teardown:function(){jQuery.event.remove(this,"._change");return!rformElems.test(this.nodeName)}}}
if(!support.focusinBubbles){jQuery.each({focus:"focusin",blur:"focusout"},function(orig,fix){var handler=function(event){jQuery.event.simulate(fix,event.target,jQuery.event.fix(event),!0)};jQuery.event.special[fix]={setup:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix);if(!attaches){doc.addEventListener(orig,handler,!0)}
jQuery._data(doc,fix,(attaches||0)+1)},teardown:function(){var doc=this.ownerDocument||this,attaches=jQuery._data(doc,fix)-1;if(!attaches){doc.removeEventListener(orig,handler,!0);jQuery._removeData(doc,fix)}else{jQuery._data(doc,fix,attaches)}}}})}
jQuery.fn.extend({on:function(types,selector,data,fn,one){var type,origFn;if(typeof types==="object"){if(typeof selector!=="string"){data=data||selector;selector=undefined}
for(type in types){this.on(type,selector,data,types[type],one)}
return this}
if(data==null&&fn==null){fn=selector;data=selector=undefined}else if(fn==null){if(typeof selector==="string"){fn=data;data=undefined}else{fn=data;data=selector;selector=undefined}}
if(fn===!1){fn=returnFalse}else if(!fn){return this}
if(one===1){origFn=fn;fn=function(event){jQuery().off(event);return origFn.apply(this,arguments)};fn.guid=origFn.guid||(origFn.guid=jQuery.guid++)}
return this.each(function(){jQuery.event.add(this,types,fn,data,selector)})},one:function(types,selector,data,fn){return this.on(types,selector,data,fn,1)},off:function(types,selector,fn){var handleObj,type;if(types&&types.preventDefault&&types.handleObj){handleObj=types.handleObj;jQuery(types.delegateTarget).off(handleObj.namespace?handleObj.origType+"."+handleObj.namespace:handleObj.origType,handleObj.selector,handleObj.handler);return this}
if(typeof types==="object"){for(type in types){this.off(type,selector,types[type])}
return this}
if(selector===!1||typeof selector==="function"){fn=selector;selector=undefined}
if(fn===!1){fn=returnFalse}
return this.each(function(){jQuery.event.remove(this,types,fn,selector)})},trigger:function(type,data){return this.each(function(){jQuery.event.trigger(type,data,this)})},triggerHandler:function(type,data){var elem=this[0];if(elem){return jQuery.event.trigger(type,data,elem,!0)}}});function createSafeFragment(document){var list=nodeNames.split("|"),safeFrag=document.createDocumentFragment();if(safeFrag.createElement){while(list.length){safeFrag.createElement(list.pop())}}
return safeFrag}
var nodeNames="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|"+"header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",rinlinejQuery=/ jQuery\d+="(?:null|\d+)"/g,rnoshimcache=new RegExp("<(?:"+nodeNames+")[\\s/>]","i"),rleadingWhitespace=/^\s+/,rxhtmlTag=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,rtagName=/<([\w:]+)/,rtbody=/<tbody/i,rhtml=/<|&#?\w+;/,rnoInnerhtml=/<(?:script|style|link)/i,rchecked=/checked\s*(?:[^=]|=\s*.checked.)/i,rscriptType=/^$|\/(?:java|ecma)script/i,rscriptTypeMasked=/^true\/(.*)/,rcleanScript=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,wrapMap={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},safeFragment=createSafeFragment(document),fragmentDiv=safeFragment.appendChild(document.createElement("div"));wrapMap.optgroup=wrapMap.option;wrapMap.tbody=wrapMap.tfoot=wrapMap.colgroup=wrapMap.caption=wrapMap.thead;wrapMap.th=wrapMap.td;function getAll(context,tag){var elems,elem,i=0,found=typeof context.getElementsByTagName!==strundefined?context.getElementsByTagName(tag||"*"):typeof context.querySelectorAll!==strundefined?context.querySelectorAll(tag||"*"):undefined;if(!found){for(found=[],elems=context.childNodes||context;(elem=elems[i])!=null;i++){if(!tag||jQuery.nodeName(elem,tag)){found.push(elem)}else{jQuery.merge(found,getAll(elem,tag))}}}
return tag===undefined||tag&&jQuery.nodeName(context,tag)?jQuery.merge([context],found):found}
function fixDefaultChecked(elem){if(rcheckableType.test(elem.type)){elem.defaultChecked=elem.checked}}
function manipulationTarget(elem,content){return jQuery.nodeName(elem,"table")&&jQuery.nodeName(content.nodeType!==11?content:content.firstChild,"tr")?elem.getElementsByTagName("tbody")[0]||elem.appendChild(elem.ownerDocument.createElement("tbody")):elem}
function disableScript(elem){elem.type=(jQuery.find.attr(elem,"type")!==null)+"/"+elem.type;return elem}
function restoreScript(elem){var match=rscriptTypeMasked.exec(elem.type);if(match){elem.type=match[1]}else{elem.removeAttribute("type")}
return elem}
function setGlobalEval(elems,refElements){var elem,i=0;for(;(elem=elems[i])!=null;i++){jQuery._data(elem,"globalEval",!refElements||jQuery._data(refElements[i],"globalEval"))}}
function cloneCopyEvent(src,dest){if(dest.nodeType!==1||!jQuery.hasData(src)){return}
var type,i,l,oldData=jQuery._data(src),curData=jQuery._data(dest,oldData),events=oldData.events;if(events){delete curData.handle;curData.events={};for(type in events){for(i=0,l=events[type].length;i<l;i++){jQuery.event.add(dest,type,events[type][i])}}}
if(curData.data){curData.data=jQuery.extend({},curData.data)}}
function fixCloneNodeIssues(src,dest){var nodeName,e,data;if(dest.nodeType!==1){return}
nodeName=dest.nodeName.toLowerCase();if(!support.noCloneEvent&&dest[jQuery.expando]){data=jQuery._data(dest);for(e in data.events){jQuery.removeEvent(dest,e,data.handle)}
dest.removeAttribute(jQuery.expando)}
if(nodeName==="script"&&dest.text!==src.text){disableScript(dest).text=src.text;restoreScript(dest)}else if(nodeName==="object"){if(dest.parentNode){dest.outerHTML=src.outerHTML}
if(support.html5Clone&&(src.innerHTML&&!jQuery.trim(dest.innerHTML))){dest.innerHTML=src.innerHTML}}else if(nodeName==="input"&&rcheckableType.test(src.type)){dest.defaultChecked=dest.checked=src.checked;if(dest.value!==src.value){dest.value=src.value}}else if(nodeName==="option"){dest.defaultSelected=dest.selected=src.defaultSelected}else if(nodeName==="input"||nodeName==="textarea"){dest.defaultValue=src.defaultValue}}
jQuery.extend({clone:function(elem,dataAndEvents,deepDataAndEvents){var destElements,node,clone,i,srcElements,inPage=jQuery.contains(elem.ownerDocument,elem);if(support.html5Clone||jQuery.isXMLDoc(elem)||!rnoshimcache.test("<"+elem.nodeName+">")){clone=elem.cloneNode(!0)}else{fragmentDiv.innerHTML=elem.outerHTML;fragmentDiv.removeChild(clone=fragmentDiv.firstChild)}
if((!support.noCloneEvent||!support.noCloneChecked)&&(elem.nodeType===1||elem.nodeType===11)&&!jQuery.isXMLDoc(elem)){destElements=getAll(clone);srcElements=getAll(elem);for(i=0;(node=srcElements[i])!=null;++i){if(destElements[i]){fixCloneNodeIssues(node,destElements[i])}}}
if(dataAndEvents){if(deepDataAndEvents){srcElements=srcElements||getAll(elem);destElements=destElements||getAll(clone);for(i=0;(node=srcElements[i])!=null;i++){cloneCopyEvent(node,destElements[i])}}else{cloneCopyEvent(elem,clone)}}
destElements=getAll(clone,"script");if(destElements.length>0){setGlobalEval(destElements,!inPage&&getAll(elem,"script"))}
destElements=srcElements=node=null;return clone},buildFragment:function(elems,context,scripts,selection){var j,elem,contains,tmp,tag,tbody,wrap,l=elems.length,safe=createSafeFragment(context),nodes=[],i=0;for(;i<l;i++){elem=elems[i];if(elem||elem===0){if(jQuery.type(elem)==="object"){jQuery.merge(nodes,elem.nodeType?[elem]:elem)}else if(!rhtml.test(elem)){nodes.push(context.createTextNode(elem))}else{tmp=tmp||safe.appendChild(context.createElement("div"));tag=(rtagName.exec(elem)||["",""])[1].toLowerCase();wrap=wrapMap[tag]||wrapMap._default;tmp.innerHTML=wrap[1]+elem.replace(rxhtmlTag,"<$1></$2>")+wrap[2];j=wrap[0];while(j--){tmp=tmp.lastChild}
if(!support.leadingWhitespace&&rleadingWhitespace.test(elem)){nodes.push(context.createTextNode(rleadingWhitespace.exec(elem)[0]))}
if(!support.tbody){elem=tag==="table"&&!rtbody.test(elem)?tmp.firstChild:wrap[1]==="<table>"&&!rtbody.test(elem)?tmp:0;j=elem&&elem.childNodes.length;while(j--){if(jQuery.nodeName((tbody=elem.childNodes[j]),"tbody")&&!tbody.childNodes.length){elem.removeChild(tbody)}}}
jQuery.merge(nodes,tmp.childNodes);tmp.textContent="";while(tmp.firstChild){tmp.removeChild(tmp.firstChild)}
tmp=safe.lastChild}}}
if(tmp){safe.removeChild(tmp)}
if(!support.appendChecked){jQuery.grep(getAll(nodes,"input"),fixDefaultChecked)}
i=0;while((elem=nodes[i++])){if(selection&&jQuery.inArray(elem,selection)!==-1){continue}
contains=jQuery.contains(elem.ownerDocument,elem);tmp=getAll(safe.appendChild(elem),"script");if(contains){setGlobalEval(tmp)}
if(scripts){j=0;while((elem=tmp[j++])){if(rscriptType.test(elem.type||"")){scripts.push(elem)}}}}
tmp=null;return safe},cleanData:function(elems,acceptData){var elem,type,id,data,i=0,internalKey=jQuery.expando,cache=jQuery.cache,deleteExpando=support.deleteExpando,special=jQuery.event.special;for(;(elem=elems[i])!=null;i++){if(acceptData||jQuery.acceptData(elem)){id=elem[internalKey];data=id&&cache[id];if(data){if(data.events){for(type in data.events){if(special[type]){jQuery.event.remove(elem,type)}else{jQuery.removeEvent(elem,type,data.handle)}}}
if(cache[id]){delete cache[id];if(deleteExpando){delete elem[internalKey]}else if(typeof elem.removeAttribute!==strundefined){elem.removeAttribute(internalKey)}else{elem[internalKey]=null}
deletedIds.push(id)}}}}}});jQuery.fn.extend({text:function(value){return access(this,function(value){return value===undefined?jQuery.text(this):this.empty().append((this[0]&&this[0].ownerDocument||document).createTextNode(value))},null,value,arguments.length)},append:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.appendChild(elem)}})},prepend:function(){return this.domManip(arguments,function(elem){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var target=manipulationTarget(this,elem);target.insertBefore(elem,target.firstChild)}})},before:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this)}})},after:function(){return this.domManip(arguments,function(elem){if(this.parentNode){this.parentNode.insertBefore(elem,this.nextSibling)}})},remove:function(selector,keepData){var elem,elems=selector?jQuery.filter(selector,this):this,i=0;for(;(elem=elems[i])!=null;i++){if(!keepData&&elem.nodeType===1){jQuery.cleanData(getAll(elem))}
if(elem.parentNode){if(keepData&&jQuery.contains(elem.ownerDocument,elem)){setGlobalEval(getAll(elem,"script"))}
elem.parentNode.removeChild(elem)}}
return this},empty:function(){var elem,i=0;for(;(elem=this[i])!=null;i++){if(elem.nodeType===1){jQuery.cleanData(getAll(elem,!1))}
while(elem.firstChild){elem.removeChild(elem.firstChild)}
if(elem.options&&jQuery.nodeName(elem,"select")){elem.options.length=0}}
return this},clone:function(dataAndEvents,deepDataAndEvents){dataAndEvents=dataAndEvents==null?!1:dataAndEvents;deepDataAndEvents=deepDataAndEvents==null?dataAndEvents:deepDataAndEvents;return this.map(function(){return jQuery.clone(this,dataAndEvents,deepDataAndEvents)})},html:function(value){return access(this,function(value){var elem=this[0]||{},i=0,l=this.length;if(value===undefined){return elem.nodeType===1?elem.innerHTML.replace(rinlinejQuery,""):undefined}
if(typeof value==="string"&&!rnoInnerhtml.test(value)&&(support.htmlSerialize||!rnoshimcache.test(value))&&(support.leadingWhitespace||!rleadingWhitespace.test(value))&&!wrapMap[(rtagName.exec(value)||["",""])[1].toLowerCase()]){value=value.replace(rxhtmlTag,"<$1></$2>");try{for(;i<l;i++){elem=this[i]||{};if(elem.nodeType===1){jQuery.cleanData(getAll(elem,!1));elem.innerHTML=value}}
elem=0}catch(e){}}
if(elem){this.empty().append(value)}},null,value,arguments.length)},replaceWith:function(){var arg=arguments[0];this.domManip(arguments,function(elem){arg=this.parentNode;jQuery.cleanData(getAll(this));if(arg){arg.replaceChild(elem,this)}});return arg&&(arg.length||arg.nodeType)?this:this.remove()},detach:function(selector){return this.remove(selector,!0)},domManip:function(args,callback){args=concat.apply([],args);var first,node,hasScripts,scripts,doc,fragment,i=0,l=this.length,set=this,iNoClone=l-1,value=args[0],isFunction=jQuery.isFunction(value);if(isFunction||(l>1&&typeof value==="string"&&!support.checkClone&&rchecked.test(value))){return this.each(function(index){var self=set.eq(index);if(isFunction){args[0]=value.call(this,index,self.html())}
self.domManip(args,callback)})}
if(l){fragment=jQuery.buildFragment(args,this[0].ownerDocument,!1,this);first=fragment.firstChild;if(fragment.childNodes.length===1){fragment=first}
if(first){scripts=jQuery.map(getAll(fragment,"script"),disableScript);hasScripts=scripts.length;for(;i<l;i++){node=fragment;if(i!==iNoClone){node=jQuery.clone(node,!0,!0);if(hasScripts){jQuery.merge(scripts,getAll(node,"script"))}}
callback.call(this[i],node,i)}
if(hasScripts){doc=scripts[scripts.length-1].ownerDocument;jQuery.map(scripts,restoreScript);for(i=0;i<hasScripts;i++){node=scripts[i];if(rscriptType.test(node.type||"")&&!jQuery._data(node,"globalEval")&&jQuery.contains(doc,node)){if(node.src){if(jQuery._evalUrl){jQuery._evalUrl(node.src)}}else{jQuery.globalEval((node.text||node.textContent||node.innerHTML||"").replace(rcleanScript,""))}}}}
fragment=first=null}}
return this}});jQuery.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(name,original){jQuery.fn[name]=function(selector){var elems,i=0,ret=[],insert=jQuery(selector),last=insert.length-1;for(;i<=last;i++){elems=i===last?this:this.clone(!0);jQuery(insert[i])[original](elems);push.apply(ret,elems.get())}
return this.pushStack(ret)}});var iframe,elemdisplay={};function actualDisplay(name,doc){var elem=jQuery(doc.createElement(name)).appendTo(doc.body),display=window.getDefaultComputedStyle?window.getDefaultComputedStyle(elem[0]).display:jQuery.css(elem[0],"display");elem.detach();return display}
function defaultDisplay(nodeName){var doc=document,display=elemdisplay[nodeName];if(!display){display=actualDisplay(nodeName,doc);if(display==="none"||!display){iframe=(iframe||jQuery("<iframe frameborder='0' width='0' height='0'/>")).appendTo(doc.documentElement);doc=(iframe[0].contentWindow||iframe[0].contentDocument).document;doc.write();doc.close();display=actualDisplay(nodeName,doc);iframe.detach()}
elemdisplay[nodeName]=display}
return display}(function(){var a,shrinkWrapBlocksVal,div=document.createElement("div"),divReset="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;"+"display:block;padding:0;margin:0;border:0";div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];a.style.cssText="float:left;opacity:.5";support.opacity=/^0.5/.test(a.style.opacity);support.cssFloat=!!a.style.cssFloat;div.style.backgroundClip="content-box";div.cloneNode(!0).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";a=div=null;support.shrinkWrapBlocks=function(){var body,container,div,containerStyles;if(shrinkWrapBlocksVal==null){body=document.getElementsByTagName("body")[0];if(!body){return}
containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";container=document.createElement("div");div=document.createElement("div");body.appendChild(container).appendChild(div);shrinkWrapBlocksVal=!1;if(typeof div.style.zoom!==strundefined){div.style.cssText=divReset+";width:1px;padding:1px;zoom:1";div.innerHTML="<div></div>";div.firstChild.style.width="5px";shrinkWrapBlocksVal=div.offsetWidth!==3}
body.removeChild(container);body=container=div=null}
return shrinkWrapBlocksVal}})();var rmargin=(/^margin/);var rnumnonpx=new RegExp("^("+pnum+")(?!px)[a-z%]+$","i");var getStyles,curCSS,rposition=/^(top|right|bottom|left)$/;if(window.getComputedStyle){getStyles=function(elem){return elem.ownerDocument.defaultView.getComputedStyle(elem,null)};curCSS=function(elem,name,computed){var width,minWidth,maxWidth,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed.getPropertyValue(name)||computed[name]:undefined;if(computed){if(ret===""&&!jQuery.contains(elem.ownerDocument,elem)){ret=jQuery.style(elem,name)}
if(rnumnonpx.test(ret)&&rmargin.test(name)){width=style.width;minWidth=style.minWidth;maxWidth=style.maxWidth;style.minWidth=style.maxWidth=style.width=ret;ret=computed.width;style.width=width;style.minWidth=minWidth;style.maxWidth=maxWidth}}
return ret===undefined?ret:ret+""}}else if(document.documentElement.currentStyle){getStyles=function(elem){return elem.currentStyle};curCSS=function(elem,name,computed){var left,rs,rsLeft,ret,style=elem.style;computed=computed||getStyles(elem);ret=computed?computed[name]:undefined;if(ret==null&&style&&style[name]){ret=style[name]}
if(rnumnonpx.test(ret)&&!rposition.test(name)){left=style.left;rs=elem.runtimeStyle;rsLeft=rs&&rs.left;if(rsLeft){rs.left=elem.currentStyle.left}
style.left=name==="fontSize"?"1em":ret;ret=style.pixelLeft+"px";style.left=left;if(rsLeft){rs.left=rsLeft}}
return ret===undefined?ret:ret+""||"auto"}}
function addGetHookIf(conditionFn,hookFn){return{get:function(){var condition=conditionFn();if(condition==null){return}
if(condition){delete this.get;return}
return(this.get=hookFn).apply(this,arguments)}}}(function(){var a,reliableHiddenOffsetsVal,boxSizingVal,boxSizingReliableVal,pixelPositionVal,div=document.createElement("div"),containerStyles="border:0;width:0;height:0;position:absolute;top:0;left:-9999px",divReset="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;"+"display:block;padding:0;margin:0;border:0";div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];a.style.cssText="float:left;opacity:.5";support.opacity=/^0.5/.test(a.style.opacity);support.cssFloat=!!a.style.cssFloat;div.style.backgroundClip="content-box";div.cloneNode(!0).style.backgroundClip="";support.clearCloneStyle=div.style.backgroundClip==="content-box";a=div=null;jQuery.extend(support,{reliableHiddenOffsets:function(){if(reliableHiddenOffsetsVal!=null){return reliableHiddenOffsetsVal}
var container,tds,isSupported,div=document.createElement("div"),body=document.getElementsByTagName("body")[0];if(!body){return}
div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";container=document.createElement("div");container.style.cssText=containerStyles;body.appendChild(container).appendChild(div);div.innerHTML="<table><tr><td></td><td>t</td></tr></table>";tds=div.getElementsByTagName("td");tds[0].style.cssText="padding:0;margin:0;border:0;display:none";isSupported=(tds[0].offsetHeight===0);tds[0].style.display="";tds[1].style.display="none";reliableHiddenOffsetsVal=isSupported&&(tds[0].offsetHeight===0);body.removeChild(container);div=body=null;return reliableHiddenOffsetsVal},boxSizing:function(){if(boxSizingVal==null){computeStyleTests()}
return boxSizingVal},boxSizingReliable:function(){if(boxSizingReliableVal==null){computeStyleTests()}
return boxSizingReliableVal},pixelPosition:function(){if(pixelPositionVal==null){computeStyleTests()}
return pixelPositionVal},reliableMarginRight:function(){var body,container,div,marginDiv,reliableMarginRightVal=!0;if(window.getComputedStyle){body=document.getElementsByTagName("body")[0];if(!body){return}
container=document.createElement("div");div=document.createElement("div");container.style.cssText=containerStyles;body.appendChild(container).appendChild(div);marginDiv=div.appendChild(document.createElement("div"));marginDiv.style.cssText=div.style.cssText=divReset;marginDiv.style.marginRight=marginDiv.style.width="0";div.style.width="1px";reliableMarginRightVal=!parseFloat((window.getComputedStyle(marginDiv,null)||{}).marginRight);body.removeChild(container)}
return reliableMarginRightVal}});function computeStyleTests(){var container,div,body=document.getElementsByTagName("body")[0];if(!body){return}
container=document.createElement("div");div=document.createElement("div");container.style.cssText=containerStyles;body.appendChild(container).appendChild(div);div.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;"+"position:absolute;display:block;padding:1px;border:1px;width:4px;"+"margin-top:1%;top:1%";jQuery.swap(body,body.style.zoom!=null?{zoom:1}:{},function(){boxSizingVal=div.offsetWidth===4});boxSizingReliableVal=!0;pixelPositionVal=!1;if(window.getComputedStyle){pixelPositionVal=(window.getComputedStyle(div,null)||{}).top!=="1%";boxSizingReliableVal=(window.getComputedStyle(div,null)||{width:"4px"}).width==="4px"}
body.removeChild(container);div=body=null}})();jQuery.swap=function(elem,options,callback,args){var ret,name,old={};for(name in options){old[name]=elem.style[name];elem.style[name]=options[name]}
ret=callback.apply(elem,args||[]);for(name in options){elem.style[name]=old[name]}
return ret};var ralpha=/alpha\([^)]*\)/i,ropacity=/opacity\s*=\s*([^)]*)/,rdisplayswap=/^(none|table(?!-c[ea]).+)/,rnumsplit=new RegExp("^("+pnum+")(.*)$","i"),rrelNum=new RegExp("^([+-])=("+pnum+")","i"),cssShow={position:"absolute",visibility:"hidden",display:"block"},cssNormalTransform={letterSpacing:0,fontWeight:400},cssPrefixes=["Webkit","O","Moz","ms"];function vendorPropName(style,name){if(name in style){return name}
var capName=name.charAt(0).toUpperCase()+name.slice(1),origName=name,i=cssPrefixes.length;while(i--){name=cssPrefixes[i]+capName;if(name in style){return name}}
return origName}
function showHide(elements,show){var display,elem,hidden,values=[],index=0,length=elements.length;for(;index<length;index++){elem=elements[index];if(!elem.style){continue}
values[index]=jQuery._data(elem,"olddisplay");display=elem.style.display;if(show){if(!values[index]&&display==="none"){elem.style.display=""}
if(elem.style.display===""&&isHidden(elem)){values[index]=jQuery._data(elem,"olddisplay",defaultDisplay(elem.nodeName))}}else{if(!values[index]){hidden=isHidden(elem);if(display&&display!=="none"||!hidden){jQuery._data(elem,"olddisplay",hidden?display:jQuery.css(elem,"display"))}}}}
for(index=0;index<length;index++){elem=elements[index];if(!elem.style){continue}
if(!show||elem.style.display==="none"||elem.style.display===""){elem.style.display=show?values[index]||"":"none"}}
return elements}
function setPositiveNumber(elem,value,subtract){var matches=rnumsplit.exec(value);return matches?Math.max(0,matches[1]-(subtract||0))+(matches[2]||"px"):value}
function augmentWidthOrHeight(elem,name,extra,isBorderBox,styles){var i=extra===(isBorderBox?"border":"content")?4:name==="width"?1:0,val=0;for(;i<4;i+=2){if(extra==="margin"){val+=jQuery.css(elem,extra+cssExpand[i],!0,styles)}
if(isBorderBox){if(extra==="content"){val-=jQuery.css(elem,"padding"+cssExpand[i],!0,styles)}
if(extra!=="margin"){val-=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)}}else{val+=jQuery.css(elem,"padding"+cssExpand[i],!0,styles);if(extra!=="padding"){val+=jQuery.css(elem,"border"+cssExpand[i]+"Width",!0,styles)}}}
return val}
function getWidthOrHeight(elem,name,extra){var valueIsBorderBox=!0,val=name==="width"?elem.offsetWidth:elem.offsetHeight,styles=getStyles(elem),isBorderBox=support.boxSizing()&&jQuery.css(elem,"boxSizing",!1,styles)==="border-box";if(val<=0||val==null){val=curCSS(elem,name,styles);if(val<0||val==null){val=elem.style[name]}
if(rnumnonpx.test(val)){return val}
valueIsBorderBox=isBorderBox&&(support.boxSizingReliable()||val===elem.style[name]);val=parseFloat(val)||0}
return(val+augmentWidthOrHeight(elem,name,extra||(isBorderBox?"border":"content"),valueIsBorderBox,styles))+"px"}
jQuery.extend({cssHooks:{opacity:{get:function(elem,computed){if(computed){var ret=curCSS(elem,"opacity");return ret===""?"1":ret}}}},cssNumber:{"columnCount":!0,"fillOpacity":!0,"fontWeight":!0,"lineHeight":!0,"opacity":!0,"order":!0,"orphans":!0,"widows":!0,"zIndex":!0,"zoom":!0},cssProps:{"float":support.cssFloat?"cssFloat":"styleFloat"},style:function(elem,name,value,extra){if(!elem||elem.nodeType===3||elem.nodeType===8||!elem.style){return}
var ret,type,hooks,origName=jQuery.camelCase(name),style=elem.style;name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(value!==undefined){type=typeof value;if(type==="string"&&(ret=rrelNum.exec(value))){value=(ret[1]+1)*ret[2]+parseFloat(jQuery.css(elem,name));type="number"}
if(value==null||value!==value){return}
if(type==="number"&&!jQuery.cssNumber[origName]){value+="px"}
if(!support.clearCloneStyle&&value===""&&name.indexOf("background")===0){style[name]="inherit"}
if(!hooks||!("set" in hooks)||(value=hooks.set(elem,value,extra))!==undefined){try{style[name]="";style[name]=value}catch(e){}}}else{if(hooks&&"get" in hooks&&(ret=hooks.get(elem,!1,extra))!==undefined){return ret}
return style[name]}},css:function(elem,name,extra,styles){var num,val,hooks,origName=jQuery.camelCase(name);name=jQuery.cssProps[origName]||(jQuery.cssProps[origName]=vendorPropName(elem.style,origName));hooks=jQuery.cssHooks[name]||jQuery.cssHooks[origName];if(hooks&&"get" in hooks){val=hooks.get(elem,!0,extra)}
if(val===undefined){val=curCSS(elem,name,styles)}
if(val==="normal"&&name in cssNormalTransform){val=cssNormalTransform[name]}
if(extra===""||extra){num=parseFloat(val);return extra===!0||jQuery.isNumeric(num)?num||0:val}
return val}});jQuery.each(["height","width"],function(i,name){jQuery.cssHooks[name]={get:function(elem,computed,extra){if(computed){return elem.offsetWidth===0&&rdisplayswap.test(jQuery.css(elem,"display"))?jQuery.swap(elem,cssShow,function(){return getWidthOrHeight(elem,name,extra)}):getWidthOrHeight(elem,name,extra)}},set:function(elem,value,extra){var styles=extra&&getStyles(elem);return setPositiveNumber(elem,value,extra?augmentWidthOrHeight(elem,name,extra,support.boxSizing()&&jQuery.css(elem,"boxSizing",!1,styles)==="border-box",styles):0)}}});if(!support.opacity){jQuery.cssHooks.opacity={get:function(elem,computed){return ropacity.test((computed&&elem.currentStyle?elem.currentStyle.filter:elem.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":computed?"1":""},set:function(elem,value){var style=elem.style,currentStyle=elem.currentStyle,opacity=jQuery.isNumeric(value)?"alpha(opacity="+value*100+")":"",filter=currentStyle&&currentStyle.filter||style.filter||"";style.zoom=1;if((value>=1||value==="")&&jQuery.trim(filter.replace(ralpha,""))===""&&style.removeAttribute){style.removeAttribute("filter");if(value===""||currentStyle&&!currentStyle.filter){return}}
style.filter=ralpha.test(filter)?filter.replace(ralpha,opacity):filter+" "+opacity}}}
jQuery.cssHooks.marginRight=addGetHookIf(support.reliableMarginRight,function(elem,computed){if(computed){return jQuery.swap(elem,{"display":"inline-block"},curCSS,[elem,"marginRight"])}});jQuery.each({margin:"",padding:"",border:"Width"},function(prefix,suffix){jQuery.cssHooks[prefix+suffix]={expand:function(value){var i=0,expanded={},parts=typeof value==="string"?value.split(" "):[value];for(;i<4;i++){expanded[prefix+cssExpand[i]+suffix]=parts[i]||parts[i-2]||parts[0]}
return expanded}};if(!rmargin.test(prefix)){jQuery.cssHooks[prefix+suffix].set=setPositiveNumber}});jQuery.fn.extend({css:function(name,value){return access(this,function(elem,name,value){var styles,len,map={},i=0;if(jQuery.isArray(name)){styles=getStyles(elem);len=name.length;for(;i<len;i++){map[name[i]]=jQuery.css(elem,name[i],!1,styles)}
return map}
return value!==undefined?jQuery.style(elem,name,value):jQuery.css(elem,name)},name,value,arguments.length>1)},show:function(){return showHide(this,!0)},hide:function(){return showHide(this)},toggle:function(state){if(typeof state==="boolean"){return state?this.show():this.hide()}
return this.each(function(){if(isHidden(this)){jQuery(this).show()}else{jQuery(this).hide()}})}});function Tween(elem,options,prop,end,easing){return new Tween.prototype.init(elem,options,prop,end,easing)}
jQuery.Tween=Tween;Tween.prototype={constructor:Tween,init:function(elem,options,prop,end,easing,unit){this.elem=elem;this.prop=prop;this.easing=easing||"swing";this.options=options;this.start=this.now=this.cur();this.end=end;this.unit=unit||(jQuery.cssNumber[prop]?"":"px")},cur:function(){var hooks=Tween.propHooks[this.prop];return hooks&&hooks.get?hooks.get(this):Tween.propHooks._default.get(this)},run:function(percent){var eased,hooks=Tween.propHooks[this.prop];if(this.options.duration){this.pos=eased=jQuery.easing[this.easing](percent,this.options.duration*percent,0,1,this.options.duration)}else{this.pos=eased=percent}
this.now=(this.end-this.start)*eased+this.start;if(this.options.step){this.options.step.call(this.elem,this.now,this)}
if(hooks&&hooks.set){hooks.set(this)}else{Tween.propHooks._default.set(this)}
return this}};Tween.prototype.init.prototype=Tween.prototype;Tween.propHooks={_default:{get:function(tween){var result;if(tween.elem[tween.prop]!=null&&(!tween.elem.style||tween.elem.style[tween.prop]==null)){return tween.elem[tween.prop]}
result=jQuery.css(tween.elem,tween.prop,"");return!result||result==="auto"?0:result},set:function(tween){if(jQuery.fx.step[tween.prop]){jQuery.fx.step[tween.prop](tween)}else if(tween.elem.style&&(tween.elem.style[jQuery.cssProps[tween.prop]]!=null||jQuery.cssHooks[tween.prop])){jQuery.style(tween.elem,tween.prop,tween.now+tween.unit)}else{tween.elem[tween.prop]=tween.now}}}};Tween.propHooks.scrollTop=Tween.propHooks.scrollLeft={set:function(tween){if(tween.elem.nodeType&&tween.elem.parentNode){tween.elem[tween.prop]=tween.now}}};jQuery.easing={linear:function(p){return p},swing:function(p){return 0.5-Math.cos(p*Math.PI)/2}};jQuery.fx=Tween.prototype.init;jQuery.fx.step={};var fxNow,timerId,rfxtypes=/^(?:toggle|show|hide)$/,rfxnum=new RegExp("^(?:([+-])=|)("+pnum+")([a-z%]*)$","i"),rrun=/queueHooks$/,animationPrefilters=[defaultPrefilter],tweeners={"*":[function(prop,value){var tween=this.createTween(prop,value),target=tween.cur(),parts=rfxnum.exec(value),unit=parts&&parts[3]||(jQuery.cssNumber[prop]?"":"px"),start=(jQuery.cssNumber[prop]||unit!=="px"&&+target)&&rfxnum.exec(jQuery.css(tween.elem,prop)),scale=1,maxIterations=20;if(start&&start[3]!==unit){unit=unit||start[3];parts=parts||[];start=+target||1;do{scale=scale||".5";start=start/scale;jQuery.style(tween.elem,prop,start+unit)}while(scale!==(scale=tween.cur()/target)&&scale!==1&&--maxIterations)}
if(parts){start=tween.start=+start||+target||0;tween.unit=unit;tween.end=parts[1]?start+(parts[1]+1)*parts[2]:+parts[2]}
return tween}]};function createFxNow(){setTimeout(function(){fxNow=undefined});return(fxNow=jQuery.now())}
function genFx(type,includeWidth){var which,attrs={height:type},i=0;includeWidth=includeWidth?1:0;for(;i<4;i+=2-includeWidth){which=cssExpand[i];attrs["margin"+which]=attrs["padding"+which]=type}
if(includeWidth){attrs.opacity=attrs.width=type}
return attrs}
function createTween(value,prop,animation){var tween,collection=(tweeners[prop]||[]).concat(tweeners["*"]),index=0,length=collection.length;for(;index<length;index++){if((tween=collection[index].call(animation,prop,value))){return tween}}}
function defaultPrefilter(elem,props,opts){var prop,value,toggle,tween,hooks,oldfire,display,dDisplay,anim=this,orig={},style=elem.style,hidden=elem.nodeType&&isHidden(elem),dataShow=jQuery._data(elem,"fxshow");if(!opts.queue){hooks=jQuery._queueHooks(elem,"fx");if(hooks.unqueued==null){hooks.unqueued=0;oldfire=hooks.empty.fire;hooks.empty.fire=function(){if(!hooks.unqueued){oldfire()}}}
hooks.unqueued++;anim.always(function(){anim.always(function(){hooks.unqueued--;if(!jQuery.queue(elem,"fx").length){hooks.empty.fire()}})})}
if(elem.nodeType===1&&("height" in props||"width" in props)){opts.overflow=[style.overflow,style.overflowX,style.overflowY];display=jQuery.css(elem,"display");dDisplay=defaultDisplay(elem.nodeName);if(display==="none"){display=dDisplay}
if(display==="inline"&&jQuery.css(elem,"float")==="none"){if(!support.inlineBlockNeedsLayout||dDisplay==="inline"){style.display="inline-block"}else{style.zoom=1}}}
if(opts.overflow){style.overflow="hidden";if(!support.shrinkWrapBlocks()){anim.always(function(){style.overflow=opts.overflow[0];style.overflowX=opts.overflow[1];style.overflowY=opts.overflow[2]})}}
for(prop in props){value=props[prop];if(rfxtypes.exec(value)){delete props[prop];toggle=toggle||value==="toggle";if(value===(hidden?"hide":"show")){if(value==="show"&&dataShow&&dataShow[prop]!==undefined){hidden=!0}else{continue}}
orig[prop]=dataShow&&dataShow[prop]||jQuery.style(elem,prop)}}
if(!jQuery.isEmptyObject(orig)){if(dataShow){if("hidden" in dataShow){hidden=dataShow.hidden}}else{dataShow=jQuery._data(elem,"fxshow",{})}
if(toggle){dataShow.hidden=!hidden}
if(hidden){jQuery(elem).show()}else{anim.done(function(){jQuery(elem).hide()})}
anim.done(function(){var prop;jQuery._removeData(elem,"fxshow");for(prop in orig){jQuery.style(elem,prop,orig[prop])}});for(prop in orig){tween=createTween(hidden?dataShow[prop]:0,prop,anim);if(!(prop in dataShow)){dataShow[prop]=tween.start;if(hidden){tween.end=tween.start;tween.start=prop==="width"||prop==="height"?1:0}}}}}
function propFilter(props,specialEasing){var index,name,easing,value,hooks;for(index in props){name=jQuery.camelCase(index);easing=specialEasing[name];value=props[index];if(jQuery.isArray(value)){easing=value[1];value=props[index]=value[0]}
if(index!==name){props[name]=value;delete props[index]}
hooks=jQuery.cssHooks[name];if(hooks&&"expand" in hooks){value=hooks.expand(value);delete props[name];for(index in value){if(!(index in props)){props[index]=value[index];specialEasing[index]=easing}}}else{specialEasing[name]=easing}}}
function Animation(elem,properties,options){var result,stopped,index=0,length=animationPrefilters.length,deferred=jQuery.Deferred().always(function(){delete tick.elem}),tick=function(){if(stopped){return!1}
var currentTime=fxNow||createFxNow(),remaining=Math.max(0,animation.startTime+animation.duration-currentTime),temp=remaining/animation.duration||0,percent=1-temp,index=0,length=animation.tweens.length;for(;index<length;index++){animation.tweens[index].run(percent)}
deferred.notifyWith(elem,[animation,percent,remaining]);if(percent<1&&length){return remaining}else{deferred.resolveWith(elem,[animation]);return!1}},animation=deferred.promise({elem:elem,props:jQuery.extend({},properties),opts:jQuery.extend(!0,{specialEasing:{}},options),originalProperties:properties,originalOptions:options,startTime:fxNow||createFxNow(),duration:options.duration,tweens:[],createTween:function(prop,end){var tween=jQuery.Tween(elem,animation.opts,prop,end,animation.opts.specialEasing[prop]||animation.opts.easing);animation.tweens.push(tween);return tween},stop:function(gotoEnd){var index=0,length=gotoEnd?animation.tweens.length:0;if(stopped){return this}
stopped=!0;for(;index<length;index++){animation.tweens[index].run(1)}
if(gotoEnd){deferred.resolveWith(elem,[animation,gotoEnd])}else{deferred.rejectWith(elem,[animation,gotoEnd])}
return this}}),props=animation.props;propFilter(props,animation.opts.specialEasing);for(;index<length;index++){result=animationPrefilters[index].call(animation,elem,props,animation.opts);if(result){return result}}
jQuery.map(props,createTween,animation);if(jQuery.isFunction(animation.opts.start)){animation.opts.start.call(elem,animation)}
jQuery.fx.timer(jQuery.extend(tick,{elem:elem,anim:animation,queue:animation.opts.queue}));return animation.progress(animation.opts.progress).done(animation.opts.done,animation.opts.complete).fail(animation.opts.fail).always(animation.opts.always)}
jQuery.Animation=jQuery.extend(Animation,{tweener:function(props,callback){if(jQuery.isFunction(props)){callback=props;props=["*"]}else{props=props.split(" ")}
var prop,index=0,length=props.length;for(;index<length;index++){prop=props[index];tweeners[prop]=tweeners[prop]||[];tweeners[prop].unshift(callback)}},prefilter:function(callback,prepend){if(prepend){animationPrefilters.unshift(callback)}else{animationPrefilters.push(callback)}}});jQuery.speed=function(speed,easing,fn){var opt=speed&&typeof speed==="object"?jQuery.extend({},speed):{complete:fn||!fn&&easing||jQuery.isFunction(speed)&&speed,duration:speed,easing:fn&&easing||easing&&!jQuery.isFunction(easing)&&easing};opt.duration=jQuery.fx.off?0:typeof opt.duration==="number"?opt.duration:opt.duration in jQuery.fx.speeds?jQuery.fx.speeds[opt.duration]:jQuery.fx.speeds._default;if(opt.queue==null||opt.queue===!0){opt.queue="fx"}
opt.old=opt.complete;opt.complete=function(){if(jQuery.isFunction(opt.old)){opt.old.call(this)}
if(opt.queue){jQuery.dequeue(this,opt.queue)}};return opt};jQuery.fn.extend({fadeTo:function(speed,to,easing,callback){return this.filter(isHidden).css("opacity",0).show().end().animate({opacity:to},speed,easing,callback)},animate:function(prop,speed,easing,callback){var empty=jQuery.isEmptyObject(prop),optall=jQuery.speed(speed,easing,callback),doAnimation=function(){var anim=Animation(this,jQuery.extend({},prop),optall);if(empty||jQuery._data(this,"finish")){anim.stop(!0)}};doAnimation.finish=doAnimation;return empty||optall.queue===!1?this.each(doAnimation):this.queue(optall.queue,doAnimation)},stop:function(type,clearQueue,gotoEnd){var stopQueue=function(hooks){var stop=hooks.stop;delete hooks.stop;stop(gotoEnd)};if(typeof type!=="string"){gotoEnd=clearQueue;clearQueue=type;type=undefined}
if(clearQueue&&type!==!1){this.queue(type||"fx",[])}
return this.each(function(){var dequeue=!0,index=type!=null&&type+"queueHooks",timers=jQuery.timers,data=jQuery._data(this);if(index){if(data[index]&&data[index].stop){stopQueue(data[index])}}else{for(index in data){if(data[index]&&data[index].stop&&rrun.test(index)){stopQueue(data[index])}}}
for(index=timers.length;index--;){if(timers[index].elem===this&&(type==null||timers[index].queue===type)){timers[index].anim.stop(gotoEnd);dequeue=!1;timers.splice(index,1)}}
if(dequeue||!gotoEnd){jQuery.dequeue(this,type)}})},finish:function(type){if(type!==!1){type=type||"fx"}
return this.each(function(){var index,data=jQuery._data(this),queue=data[type+"queue"],hooks=data[type+"queueHooks"],timers=jQuery.timers,length=queue?queue.length:0;data.finish=!0;jQuery.queue(this,type,[]);if(hooks&&hooks.stop){hooks.stop.call(this,!0)}
for(index=timers.length;index--;){if(timers[index].elem===this&&timers[index].queue===type){timers[index].anim.stop(!0);timers.splice(index,1)}}
for(index=0;index<length;index++){if(queue[index]&&queue[index].finish){queue[index].finish.call(this)}}
delete data.finish})}});jQuery.each(["toggle","show","hide"],function(i,name){var cssFn=jQuery.fn[name];jQuery.fn[name]=function(speed,easing,callback){return speed==null||typeof speed==="boolean"?cssFn.apply(this,arguments):this.animate(genFx(name,!0),speed,easing,callback)}});jQuery.each({slideDown:genFx("show"),slideUp:genFx("hide"),slideToggle:genFx("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(name,props){jQuery.fn[name]=function(speed,easing,callback){return this.animate(props,speed,easing,callback)}});jQuery.timers=[];jQuery.fx.tick=function(){var timer,timers=jQuery.timers,i=0;fxNow=jQuery.now();for(;i<timers.length;i++){timer=timers[i];if(!timer()&&timers[i]===timer){timers.splice(i--,1)}}
if(!timers.length){jQuery.fx.stop()}
fxNow=undefined};jQuery.fx.timer=function(timer){jQuery.timers.push(timer);if(timer()){jQuery.fx.start()}else{jQuery.timers.pop()}};jQuery.fx.interval=13;jQuery.fx.start=function(){if(!timerId){timerId=setInterval(jQuery.fx.tick,jQuery.fx.interval)}};jQuery.fx.stop=function(){clearInterval(timerId);timerId=null};jQuery.fx.speeds={slow:600,fast:200,_default:400};jQuery.fn.delay=function(time,type){time=jQuery.fx?jQuery.fx.speeds[time]||time:time;type=type||"fx";return this.queue(type,function(next,hooks){var timeout=setTimeout(next,time);hooks.stop=function(){clearTimeout(timeout)}})};(function(){var a,input,select,opt,div=document.createElement("div");div.setAttribute("className","t");div.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";a=div.getElementsByTagName("a")[0];select=document.createElement("select");opt=select.appendChild(document.createElement("option"));input=div.getElementsByTagName("input")[0];a.style.cssText="top:1px";support.getSetAttribute=div.className!=="t";support.style=/top/.test(a.getAttribute("style"));support.hrefNormalized=a.getAttribute("href")==="/a";support.checkOn=!!input.value;support.optSelected=opt.selected;support.enctype=!!document.createElement("form").enctype;select.disabled=!0;support.optDisabled=!opt.disabled;input=document.createElement("input");input.setAttribute("value","");support.input=input.getAttribute("value")==="";input.value="t";input.setAttribute("type","radio");support.radioValue=input.value==="t";a=input=select=opt=div=null})();var rreturn=/\r/g;jQuery.fn.extend({val:function(value){var hooks,ret,isFunction,elem=this[0];if(!arguments.length){if(elem){hooks=jQuery.valHooks[elem.type]||jQuery.valHooks[elem.nodeName.toLowerCase()];if(hooks&&"get" in hooks&&(ret=hooks.get(elem,"value"))!==undefined){return ret}
ret=elem.value;return typeof ret==="string"?ret.replace(rreturn,""):ret==null?"":ret}
return}
isFunction=jQuery.isFunction(value);return this.each(function(i){var val;if(this.nodeType!==1){return}
if(isFunction){val=value.call(this,i,jQuery(this).val())}else{val=value}
if(val==null){val=""}else if(typeof val==="number"){val+=""}else if(jQuery.isArray(val)){val=jQuery.map(val,function(value){return value==null?"":value+""})}
hooks=jQuery.valHooks[this.type]||jQuery.valHooks[this.nodeName.toLowerCase()];if(!hooks||!("set" in hooks)||hooks.set(this,val,"value")===undefined){this.value=val}})}});jQuery.extend({valHooks:{option:{get:function(elem){var val=jQuery.find.attr(elem,"value");return val!=null?val:jQuery.text(elem)}},select:{get:function(elem){var value,option,options=elem.options,index=elem.selectedIndex,one=elem.type==="select-one"||index<0,values=one?null:[],max=one?index+1:options.length,i=index<0?max:one?index:0;for(;i<max;i++){option=options[i];if((option.selected||i===index)&&(support.optDisabled?!option.disabled:option.getAttribute("disabled")===null)&&(!option.parentNode.disabled||!jQuery.nodeName(option.parentNode,"optgroup"))){value=jQuery(option).val();if(one){return value}
values.push(value)}}
return values},set:function(elem,value){var optionSet,option,options=elem.options,values=jQuery.makeArray(value),i=options.length;while(i--){option=options[i];if(jQuery.inArray(jQuery.valHooks.option.get(option),values)>=0){try{option.selected=optionSet=!0}catch(_){option.scrollHeight}}else{option.selected=!1}}
if(!optionSet){elem.selectedIndex=-1}
return options}}}});jQuery.each(["radio","checkbox"],function(){jQuery.valHooks[this]={set:function(elem,value){if(jQuery.isArray(value)){return(elem.checked=jQuery.inArray(jQuery(elem).val(),value)>=0)}}};if(!support.checkOn){jQuery.valHooks[this].get=function(elem){return elem.getAttribute("value")===null?"on":elem.value}}});var nodeHook,boolHook,attrHandle=jQuery.expr.attrHandle,ruseDefault=/^(?:checked|selected)$/i,getSetAttribute=support.getSetAttribute,getSetInput=support.input;jQuery.fn.extend({attr:function(name,value){return access(this,jQuery.attr,name,value,arguments.length>1)},removeAttr:function(name){return this.each(function(){jQuery.removeAttr(this,name)})}});jQuery.extend({attr:function(elem,name,value){var hooks,ret,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}
if(typeof elem.getAttribute===strundefined){return jQuery.prop(elem,name,value)}
if(nType!==1||!jQuery.isXMLDoc(elem)){name=name.toLowerCase();hooks=jQuery.attrHooks[name]||(jQuery.expr.match.bool.test(name)?boolHook:nodeHook)}
if(value!==undefined){if(value===null){jQuery.removeAttr(elem,name)}else if(hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined){return ret}else{elem.setAttribute(name,value+"");return value}}else if(hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null){return ret}else{ret=jQuery.find.attr(elem,name);return ret==null?undefined:ret}},removeAttr:function(elem,value){var name,propName,i=0,attrNames=value&&value.match(rnotwhite);if(attrNames&&elem.nodeType===1){while((name=attrNames[i++])){propName=jQuery.propFix[name]||name;if(jQuery.expr.match.bool.test(name)){if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem[propName]=!1}else{elem[jQuery.camelCase("default-"+name)]=elem[propName]=!1}}else{jQuery.attr(elem,name,"")}
elem.removeAttribute(getSetAttribute?name:propName)}}},attrHooks:{type:{set:function(elem,value){if(!support.radioValue&&value==="radio"&&jQuery.nodeName(elem,"input")){var val=elem.value;elem.setAttribute("type",value);if(val){elem.value=val}
return value}}}}});boolHook={set:function(elem,value,name){if(value===!1){jQuery.removeAttr(elem,name)}else if(getSetInput&&getSetAttribute||!ruseDefault.test(name)){elem.setAttribute(!getSetAttribute&&jQuery.propFix[name]||name,name)}else{elem[jQuery.camelCase("default-"+name)]=elem[name]=!0}
return name}};jQuery.each(jQuery.expr.match.bool.source.match(/\w+/g),function(i,name){var getter=attrHandle[name]||jQuery.find.attr;attrHandle[name]=getSetInput&&getSetAttribute||!ruseDefault.test(name)?function(elem,name,isXML){var ret,handle;if(!isXML){handle=attrHandle[name];attrHandle[name]=ret;ret=getter(elem,name,isXML)!=null?name.toLowerCase():null;attrHandle[name]=handle}
return ret}:function(elem,name,isXML){if(!isXML){return elem[jQuery.camelCase("default-"+name)]?name.toLowerCase():null}}});if(!getSetInput||!getSetAttribute){jQuery.attrHooks.value={set:function(elem,value,name){if(jQuery.nodeName(elem,"input")){elem.defaultValue=value}else{return nodeHook&&nodeHook.set(elem,value,name)}}}}
if(!getSetAttribute){nodeHook={set:function(elem,value,name){var ret=elem.getAttributeNode(name);if(!ret){elem.setAttributeNode((ret=elem.ownerDocument.createAttribute(name)))}
ret.value=value+="";if(name==="value"||value===elem.getAttribute(name)){return value}}};attrHandle.id=attrHandle.name=attrHandle.coords=function(elem,name,isXML){var ret;if(!isXML){return(ret=elem.getAttributeNode(name))&&ret.value!==""?ret.value:null}};jQuery.valHooks.button={get:function(elem,name){var ret=elem.getAttributeNode(name);if(ret&&ret.specified){return ret.value}},set:nodeHook.set};jQuery.attrHooks.contenteditable={set:function(elem,value,name){nodeHook.set(elem,value===""?!1:value,name)}};jQuery.each(["width","height"],function(i,name){jQuery.attrHooks[name]={set:function(elem,value){if(value===""){elem.setAttribute(name,"auto");return value}}}})}
if(!support.style){jQuery.attrHooks.style={get:function(elem){return elem.style.cssText||undefined},set:function(elem,value){return(elem.style.cssText=value+"")}}}
var rfocusable=/^(?:input|select|textarea|button|object)$/i,rclickable=/^(?:a|area)$/i;jQuery.fn.extend({prop:function(name,value){return access(this,jQuery.prop,name,value,arguments.length>1)},removeProp:function(name){name=jQuery.propFix[name]||name;return this.each(function(){try{this[name]=undefined;delete this[name]}catch(e){}})}});jQuery.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(elem,name,value){var ret,hooks,notxml,nType=elem.nodeType;if(!elem||nType===3||nType===8||nType===2){return}
notxml=nType!==1||!jQuery.isXMLDoc(elem);if(notxml){name=jQuery.propFix[name]||name;hooks=jQuery.propHooks[name]}
if(value!==undefined){return hooks&&"set" in hooks&&(ret=hooks.set(elem,value,name))!==undefined?ret:(elem[name]=value)}else{return hooks&&"get" in hooks&&(ret=hooks.get(elem,name))!==null?ret:elem[name]}},propHooks:{tabIndex:{get:function(elem){var tabindex=jQuery.find.attr(elem,"tabindex");return tabindex?parseInt(tabindex,10):rfocusable.test(elem.nodeName)||rclickable.test(elem.nodeName)&&elem.href?0:-1}}}});if(!support.hrefNormalized){jQuery.each(["href","src"],function(i,name){jQuery.propHooks[name]={get:function(elem){return elem.getAttribute(name,4)}}})}
if(!support.optSelected){jQuery.propHooks.selected={get:function(elem){var parent=elem.parentNode;if(parent){parent.selectedIndex;if(parent.parentNode){parent.parentNode.selectedIndex}}
return null}}}
jQuery.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){jQuery.propFix[this.toLowerCase()]=this});if(!support.enctype){jQuery.propFix.enctype="encoding"}
var rclass=/[\t\r\n\f]/g;jQuery.fn.extend({addClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).addClass(value.call(this,j,this.className))})}
if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):" ");if(cur){j=0;while((clazz=classes[j++])){if(cur.indexOf(" "+clazz+" ")<0){cur+=clazz+" "}}
finalValue=jQuery.trim(cur);if(elem.className!==finalValue){elem.className=finalValue}}}}
return this},removeClass:function(value){var classes,elem,cur,clazz,j,finalValue,i=0,len=this.length,proceed=arguments.length===0||typeof value==="string"&&value;if(jQuery.isFunction(value)){return this.each(function(j){jQuery(this).removeClass(value.call(this,j,this.className))})}
if(proceed){classes=(value||"").match(rnotwhite)||[];for(;i<len;i++){elem=this[i];cur=elem.nodeType===1&&(elem.className?(" "+elem.className+" ").replace(rclass," "):"");if(cur){j=0;while((clazz=classes[j++])){while(cur.indexOf(" "+clazz+" ")>=0){cur=cur.replace(" "+clazz+" "," ")}}
finalValue=value?jQuery.trim(cur):"";if(elem.className!==finalValue){elem.className=finalValue}}}}
return this},toggleClass:function(value,stateVal){var type=typeof value;if(typeof stateVal==="boolean"&&type==="string"){return stateVal?this.addClass(value):this.removeClass(value)}
if(jQuery.isFunction(value)){return this.each(function(i){jQuery(this).toggleClass(value.call(this,i,this.className,stateVal),stateVal)})}
return this.each(function(){if(type==="string"){var className,i=0,self=jQuery(this),classNames=value.match(rnotwhite)||[];while((className=classNames[i++])){if(self.hasClass(className)){self.removeClass(className)}else{self.addClass(className)}}}else if(type===strundefined||type==="boolean"){if(this.className){jQuery._data(this,"__className__",this.className)}
this.className=this.className||value===!1?"":jQuery._data(this,"__className__")||""}})},hasClass:function(selector){var className=" "+selector+" ",i=0,l=this.length;for(;i<l;i++){if(this[i].nodeType===1&&(" "+this[i].className+" ").replace(rclass," ").indexOf(className)>=0){return!0}}
return!1}});jQuery.each(("blur focus focusin focusout load resize scroll unload click dblclick "+"mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave "+"change select submit keydown keypress keyup error contextmenu").split(" "),function(i,name){jQuery.fn[name]=function(data,fn){return arguments.length>0?this.on(name,null,data,fn):this.trigger(name)}});jQuery.fn.extend({hover:function(fnOver,fnOut){return this.mouseenter(fnOver).mouseleave(fnOut||fnOver)},bind:function(types,data,fn){return this.on(types,null,data,fn)},unbind:function(types,fn){return this.off(types,null,fn)},delegate:function(selector,types,data,fn){return this.on(types,selector,data,fn)},undelegate:function(selector,types,fn){return arguments.length===1?this.off(selector,"**"):this.off(types,selector||"**",fn)}});var nonce=jQuery.now();var rquery=(/\?/);var rvalidtokens=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;jQuery.parseJSON=function(data){if(window.JSON&&window.JSON.parse){return window.JSON.parse(data+"")}
var requireNonComma,depth=null,str=jQuery.trim(data+"");return str&&!jQuery.trim(str.replace(rvalidtokens,function(token,comma,open,close){if(requireNonComma&&comma){depth=0}
if(depth===0){return token}
requireNonComma=open||comma;depth+=!close-!open;return ""}))?(Function("return "+str))():jQuery.error("Invalid JSON: "+data)};jQuery.parseXML=function(data){var xml,tmp;if(!data||typeof data!=="string"){return null}
try{if(window.DOMParser){tmp=new DOMParser();xml=tmp.parseFromString(data,"text/xml")}else{xml=new ActiveXObject("Microsoft.XMLDOM");xml.async="false";xml.loadXML(data)}}catch(e){xml=undefined}
if(!xml||!xml.documentElement||xml.getElementsByTagName("parsererror").length){jQuery.error("Invalid XML: "+data)}
return xml};var ajaxLocParts,ajaxLocation,rhash=/#.*$/,rts=/([?&])_=[^&]*/,rheaders=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,rlocalProtocol=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,rnoContent=/^(?:GET|HEAD)$/,rprotocol=/^\/\//,rurl=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,prefilters={},transports={},allTypes="*/".concat("*");try{ajaxLocation=location.href}catch(e){ajaxLocation=document.createElement("a");ajaxLocation.href="";ajaxLocation=ajaxLocation.href}
ajaxLocParts=rurl.exec(ajaxLocation.toLowerCase())||[];function addToPrefiltersOrTransports(structure){return function(dataTypeExpression,func){if(typeof dataTypeExpression!=="string"){func=dataTypeExpression;dataTypeExpression="*"}
var dataType,i=0,dataTypes=dataTypeExpression.toLowerCase().match(rnotwhite)||[];if(jQuery.isFunction(func)){while((dataType=dataTypes[i++])){if(dataType.charAt(0)==="+"){dataType=dataType.slice(1)||"*";(structure[dataType]=structure[dataType]||[]).unshift(func)}else{(structure[dataType]=structure[dataType]||[]).push(func)}}}}}
function inspectPrefiltersOrTransports(structure,options,originalOptions,jqXHR){var inspected={},seekingTransport=(structure===transports);function inspect(dataType){var selected;inspected[dataType]=!0;jQuery.each(structure[dataType]||[],function(_,prefilterOrFactory){var dataTypeOrTransport=prefilterOrFactory(options,originalOptions,jqXHR);if(typeof dataTypeOrTransport==="string"&&!seekingTransport&&!inspected[dataTypeOrTransport]){options.dataTypes.unshift(dataTypeOrTransport);inspect(dataTypeOrTransport);return!1}else if(seekingTransport){return!(selected=dataTypeOrTransport)}});return selected}
return inspect(options.dataTypes[0])||!inspected["*"]&&inspect("*")}
function ajaxExtend(target,src){var deep,key,flatOptions=jQuery.ajaxSettings.flatOptions||{};for(key in src){if(src[key]!==undefined){(flatOptions[key]?target:(deep||(deep={})))[key]=src[key]}}
if(deep){jQuery.extend(!0,target,deep)}
return target}
function ajaxHandleResponses(s,jqXHR,responses){var firstDataType,ct,finalDataType,type,contents=s.contents,dataTypes=s.dataTypes;while(dataTypes[0]==="*"){dataTypes.shift();if(ct===undefined){ct=s.mimeType||jqXHR.getResponseHeader("Content-Type")}}
if(ct){for(type in contents){if(contents[type]&&contents[type].test(ct)){dataTypes.unshift(type);break}}}
if(dataTypes[0]in responses){finalDataType=dataTypes[0]}else{for(type in responses){if(!dataTypes[0]||s.converters[type+" "+dataTypes[0]]){finalDataType=type;break}
if(!firstDataType){firstDataType=type}}
finalDataType=finalDataType||firstDataType}
if(finalDataType){if(finalDataType!==dataTypes[0]){dataTypes.unshift(finalDataType)}
return responses[finalDataType]}}
function ajaxConvert(s,response,jqXHR,isSuccess){var conv2,current,conv,tmp,prev,converters={},dataTypes=s.dataTypes.slice();if(dataTypes[1]){for(conv in s.converters){converters[conv.toLowerCase()]=s.converters[conv]}}
current=dataTypes.shift();while(current){if(s.responseFields[current]){jqXHR[s.responseFields[current]]=response}
if(!prev&&isSuccess&&s.dataFilter){response=s.dataFilter(response,s.dataType)}
prev=current;current=dataTypes.shift();if(current){if(current==="*"){current=prev}else if(prev!=="*"&&prev!==current){conv=converters[prev+" "+current]||converters["* "+current];if(!conv){for(conv2 in converters){tmp=conv2.split(" ");if(tmp[1]===current){conv=converters[prev+" "+tmp[0]]||converters["* "+tmp[0]];if(conv){if(conv===!0){conv=converters[conv2]}else if(converters[conv2]!==!0){current=tmp[0];dataTypes.unshift(tmp[1])}
break}}}}
if(conv!==!0){if(conv&&s["throws"]){response=conv(response)}else{try{response=conv(response)}catch(e){return{state:"parsererror",error:conv?e:"No conversion from "+prev+" to "+current}}}}}}}
return{state:"success",data:response}}
jQuery.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:ajaxLocation,type:"GET",isLocal:rlocalProtocol.test(ajaxLocParts[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":allTypes,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":jQuery.parseJSON,"text xml":jQuery.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(target,settings){return settings?ajaxExtend(ajaxExtend(target,jQuery.ajaxSettings),settings):ajaxExtend(jQuery.ajaxSettings,target)},ajaxPrefilter:addToPrefiltersOrTransports(prefilters),ajaxTransport:addToPrefiltersOrTransports(transports),ajax:function(url,options){if(typeof url==="object"){options=url;url=undefined}
options=options||{};var parts,i,cacheURL,responseHeadersString,timeoutTimer,fireGlobals,transport,responseHeaders,s=jQuery.ajaxSetup({},options),callbackContext=s.context||s,globalEventContext=s.context&&(callbackContext.nodeType||callbackContext.jquery)?jQuery(callbackContext):jQuery.event,deferred=jQuery.Deferred(),completeDeferred=jQuery.Callbacks("once memory"),statusCode=s.statusCode||{},requestHeaders={},requestHeadersNames={},state=0,strAbort="canceled",jqXHR={readyState:0,getResponseHeader:function(key){var match;if(state===2){if(!responseHeaders){responseHeaders={};while((match=rheaders.exec(responseHeadersString))){responseHeaders[match[1].toLowerCase()]=match[2]}}
match=responseHeaders[key.toLowerCase()]}
return match==null?null:match},getAllResponseHeaders:function(){return state===2?responseHeadersString:null},setRequestHeader:function(name,value){var lname=name.toLowerCase();if(!state){name=requestHeadersNames[lname]=requestHeadersNames[lname]||name;requestHeaders[name]=value}
return this},overrideMimeType:function(type){if(!state){s.mimeType=type}
return this},statusCode:function(map){var code;if(map){if(state<2){for(code in map){statusCode[code]=[statusCode[code],map[code]]}}else{jqXHR.always(map[jqXHR.status])}}
return this},abort:function(statusText){var finalText=statusText||strAbort;if(transport){transport.abort(finalText)}
done(0,finalText);return this}};deferred.promise(jqXHR).complete=completeDeferred.add;jqXHR.success=jqXHR.done;jqXHR.error=jqXHR.fail;s.url=((url||s.url||ajaxLocation)+"").replace(rhash,"").replace(rprotocol,ajaxLocParts[1]+"//");s.type=options.method||options.type||s.method||s.type;s.dataTypes=jQuery.trim(s.dataType||"*").toLowerCase().match(rnotwhite)||[""];if(s.crossDomain==null){parts=rurl.exec(s.url.toLowerCase());s.crossDomain=!!(parts&&(parts[1]!==ajaxLocParts[1]||parts[2]!==ajaxLocParts[2]||(parts[3]||(parts[1]==="http:"?"80":"443"))!==(ajaxLocParts[3]||(ajaxLocParts[1]==="http:"?"80":"443"))))}
if(s.data&&s.processData&&typeof s.data!=="string"){s.data=jQuery.param(s.data,s.traditional)}
inspectPrefiltersOrTransports(prefilters,s,options,jqXHR);if(state===2){return jqXHR}
fireGlobals=s.global;if(fireGlobals&&jQuery.active++===0){jQuery.event.trigger("ajaxStart")}
s.type=s.type.toUpperCase();s.hasContent=!rnoContent.test(s.type);cacheURL=s.url;if(!s.hasContent){if(s.data){cacheURL=(s.url+=(rquery.test(cacheURL)?"&":"?")+s.data);delete s.data}
if(s.cache===!1){s.url=rts.test(cacheURL)?cacheURL.replace(rts,"$1_="+nonce++):cacheURL+(rquery.test(cacheURL)?"&":"?")+"_="+nonce++}}
if(s.ifModified){if(jQuery.lastModified[cacheURL]){jqXHR.setRequestHeader("If-Modified-Since",jQuery.lastModified[cacheURL])}
if(jQuery.etag[cacheURL]){jqXHR.setRequestHeader("If-None-Match",jQuery.etag[cacheURL])}}
if(s.data&&s.hasContent&&s.contentType!==!1||options.contentType){jqXHR.setRequestHeader("Content-Type",s.contentType)}
jqXHR.setRequestHeader("Accept",s.dataTypes[0]&&s.accepts[s.dataTypes[0]]?s.accepts[s.dataTypes[0]]+(s.dataTypes[0]!=="*"?", "+allTypes+"; q=0.01":""):s.accepts["*"]);for(i in s.headers){jqXHR.setRequestHeader(i,s.headers[i])}
if(s.beforeSend&&(s.beforeSend.call(callbackContext,jqXHR,s)===!1||state===2)){return jqXHR.abort()}
strAbort="abort";for(i in{success:1,error:1,complete:1}){jqXHR[i](s[i])}
transport=inspectPrefiltersOrTransports(transports,s,options,jqXHR);jqXHR.send=function(){jqXHR.readyState=1;if(fireGlobals){globalEventContext.trigger("ajaxSend",[jqXHR,s])}
if(s.async&&s.timeout>0){timeoutTimer=setTimeout(function(){jqXHR.abort("timeout")},s.timeout)}
try{state=1;transport.send(requestHeaders,done)}catch(e){if(state<2){done(-1,e)}else{throw e}}}
if(!transport){done(-1,"No Transport")}else{options.autostart!==!1&&jqXHR.send()}
function done(status,nativeStatusText,responses,headers){var isSuccess,success,error,response,modified,statusText=nativeStatusText;if(state===2){return}
state=2;if(timeoutTimer){clearTimeout(timeoutTimer)}
transport=undefined;responseHeadersString=headers||"";jqXHR.readyState=status>0?4:0;isSuccess=status>=200&&status<300||status===304;if(responses){response=ajaxHandleResponses(s,jqXHR,responses)}
response=ajaxConvert(s,response,jqXHR,isSuccess);if(isSuccess){if(s.ifModified){modified=jqXHR.getResponseHeader("Last-Modified");if(modified){jQuery.lastModified[cacheURL]=modified}
modified=jqXHR.getResponseHeader("etag");if(modified){jQuery.etag[cacheURL]=modified}}
if(status===204||s.type==="HEAD"){statusText="nocontent"}else if(status===304){statusText="notmodified"}else{statusText=response.state;success=response.data;error=response.error;isSuccess=!error}}else{error=statusText;if(status||!statusText){statusText="error";if(status<0){status=0}}}
jqXHR.status=status;jqXHR.statusText=(nativeStatusText||statusText)+"";if(isSuccess){deferred.resolveWith(callbackContext,[success,statusText,jqXHR])}else{deferred.rejectWith(callbackContext,[jqXHR,statusText,error])}
jqXHR.statusCode(statusCode);statusCode=undefined;if(fireGlobals){globalEventContext.trigger(isSuccess?"ajaxSuccess":"ajaxError",[jqXHR,s,isSuccess?success:error])}
completeDeferred.fireWith(callbackContext,[jqXHR,statusText]);if(fireGlobals){globalEventContext.trigger("ajaxComplete",[jqXHR,s]);if(!(--jQuery.active)){jQuery.event.trigger("ajaxStop")}}}
return jqXHR},getJSON:function(url,data,callback){return jQuery.get(url,data,callback,"json")},getScript:function(url,callback){return jQuery.get(url,undefined,callback,"script")}});jQuery.each(["get","post"],function(i,method){jQuery[method]=function(url,data,callback,type){if(jQuery.isFunction(data)){type=type||callback;callback=data;data=undefined}
return jQuery.ajax({url:url,type:method,dataType:type,data:data,success:callback})}});jQuery.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(i,type){jQuery.fn[type]=function(fn){return this.on(type,fn)}});jQuery._evalUrl=function(url){return jQuery.ajax({url:url,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})};jQuery.fn.extend({wrapAll:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapAll(html.call(this,i))})}
if(this[0]){var wrap=jQuery(html,this[0].ownerDocument).eq(0).clone(!0);if(this[0].parentNode){wrap.insertBefore(this[0])}
wrap.map(function(){var elem=this;while(elem.firstChild&&elem.firstChild.nodeType===1){elem=elem.firstChild}
return elem}).append(this)}
return this},wrapInner:function(html){if(jQuery.isFunction(html)){return this.each(function(i){jQuery(this).wrapInner(html.call(this,i))})}
return this.each(function(){var self=jQuery(this),contents=self.contents();if(contents.length){contents.wrapAll(html)}else{self.append(html)}})},wrap:function(html){var isFunction=jQuery.isFunction(html);return this.each(function(i){jQuery(this).wrapAll(isFunction?html.call(this,i):html)})},unwrap:function(){return this.parent().each(function(){if(!jQuery.nodeName(this,"body")){jQuery(this).replaceWith(this.childNodes)}}).end()}});jQuery.expr.filters.hidden=function(elem){return elem.offsetWidth<=0&&elem.offsetHeight<=0||(!support.reliableHiddenOffsets()&&((elem.style&&elem.style.display)||jQuery.css(elem,"display"))==="none")};jQuery.expr.filters.visible=function(elem){return!jQuery.expr.filters.hidden(elem)};var r20=/%20/g,rbracket=/\[\]$/,rCRLF=/\r?\n/g,rsubmitterTypes=/^(?:submit|button|image|reset|file)$/i,rsubmittable=/^(?:input|select|textarea|keygen)/i;function buildParams(prefix,obj,traditional,add){var name;if(jQuery.isArray(obj)){jQuery.each(obj,function(i,v){if(traditional||rbracket.test(prefix)){add(prefix,v)}else{buildParams(prefix+"["+(typeof v==="object"?i:"")+"]",v,traditional,add)}})}else if(!traditional&&jQuery.type(obj)==="object"){for(name in obj){buildParams(prefix+"["+name+"]",obj[name],traditional,add)}}else{add(prefix,obj)}}
jQuery.param=function(a,traditional){var prefix,s=[],add=function(key,value){value=jQuery.isFunction(value)?value():(value==null?"":value);s[s.length]=encodeURIComponent(key)+"="+encodeURIComponent(value)};if(traditional===undefined){traditional=jQuery.ajaxSettings&&jQuery.ajaxSettings.traditional}
if(jQuery.isArray(a)||(a.jquery&&!jQuery.isPlainObject(a))){jQuery.each(a,function(){add(this.name,this.value)})}else{for(prefix in a){buildParams(prefix,a[prefix],traditional,add)}}
return s.join("&").replace(r20,"+")};jQuery.fn.extend({serialize:function(){return jQuery.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var elements=jQuery.prop(this,"elements");return elements?jQuery.makeArray(elements):this}).filter(function(){var type=this.type;return this.name&&!jQuery(this).is(":disabled")&&rsubmittable.test(this.nodeName)&&!rsubmitterTypes.test(type)&&(this.checked||!rcheckableType.test(type))}).map(function(i,elem){var val=jQuery(this).val();return val==null?null:jQuery.isArray(val)?jQuery.map(val,function(val){return{name:elem.name,value:val.replace(rCRLF,"\r\n")}}):{name:elem.name,value:val.replace(rCRLF,"\r\n")}}).get()}});jQuery.ajaxSettings.xhr=window.ActiveXObject!==undefined?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&createStandardXHR()||createActiveXHR()}:createStandardXHR;var xhrId=0,xhrCallbacks={},xhrSupported=jQuery.ajaxSettings.xhr();if(window.ActiveXObject){jQuery(window).on("unload",function(){for(var key in xhrCallbacks){xhrCallbacks[key](undefined,!0)}})}
support.cors=!!xhrSupported&&("withCredentials" in xhrSupported);xhrSupported=support.ajax=!!xhrSupported;if(xhrSupported){jQuery.ajaxTransport(function(options){if(!options.crossDomain||support.cors){var callback;return{send:function(headers,complete){var i,xhr=options.xhr(),id=++xhrId;xhr.open(options.type,options.url,options.async,options.username,options.password);if(options.xhrFields){for(i in options.xhrFields){xhr[i]=options.xhrFields[i]}}
if(options.mimeType&&xhr.overrideMimeType){xhr.overrideMimeType(options.mimeType)}
if(!options.crossDomain&&!headers["X-Requested-With"]){headers["X-Requested-With"]="XMLHttpRequest"}
for(i in headers){if(headers[i]!==undefined){xhr.setRequestHeader(i,headers[i]+"")}}
xhr.send((options.hasContent&&options.data)||null);callback=function(_,isAbort){var status,statusText,responses;if(callback&&(isAbort||xhr.readyState===4)){delete xhrCallbacks[id];callback=undefined;xhr.onreadystatechange=jQuery.noop;if(isAbort){if(xhr.readyState!==4){xhr.abort()}}else{responses={};status=xhr.status;if(typeof xhr.responseText==="string"){responses.text=xhr.responseText}
try{statusText=xhr.statusText}catch(e){statusText=""}
if(!status&&options.isLocal&&!options.crossDomain){status=responses.text?200:404}else if(status===1223){status=204}}}
if(responses){complete(status,statusText,responses,xhr.getAllResponseHeaders())}};if(!options.async){callback()}else if(xhr.readyState===4){setTimeout(callback)}else{xhr.onreadystatechange=xhrCallbacks[id]=callback}},abort:function(){if(callback){callback(undefined,!0)}}}}})}
function createStandardXHR(){try{return new window.XMLHttpRequest()}catch(e){}}
function createActiveXHR(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}
jQuery.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(text){jQuery.globalEval(text);return text}}});jQuery.ajaxPrefilter("script",function(s){if(s.cache===undefined){s.cache=!1}
if(s.crossDomain){s.type="GET";s.global=!1}});jQuery.ajaxTransport("script",function(s){if(s.crossDomain){var script,head=document.head||jQuery("head")[0]||document.documentElement;return{send:function(_,callback){script=document.createElement("script");script.async=!0;if(s.scriptCharset){script.charset=s.scriptCharset}
script.src=s.url;script.onload=script.onreadystatechange=function(_,isAbort){if(isAbort||!script.readyState||/loaded|complete/.test(script.readyState)){script.onload=script.onreadystatechange=null;if(script.parentNode){script.parentNode.removeChild(script)}
script=null;if(!isAbort){callback(200,"success")}}};head.insertBefore(script,head.firstChild)},abort:function(){if(script){script.onload(undefined,!0)}}}}});var oldCallbacks=[],rjsonp=/(=)\?(?=&|$)|\?\?/;jQuery.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var callback=oldCallbacks.pop()||(jQuery.expando+"_"+(nonce++));this[callback]=!0;return callback}});jQuery.ajaxPrefilter("json jsonp",function(s,originalSettings,jqXHR){var callbackName,overwritten,responseContainer,jsonProp=s.jsonp!==!1&&(rjsonp.test(s.url)?"url":typeof s.data==="string"&&!(s.contentType||"").indexOf("application/x-www-form-urlencoded")&&rjsonp.test(s.data)&&"data");if(jsonProp||s.dataTypes[0]==="jsonp"){callbackName=s.jsonpCallback=jQuery.isFunction(s.jsonpCallback)?s.jsonpCallback():s.jsonpCallback;if(jsonProp){s[jsonProp]=s[jsonProp].replace(rjsonp,"$1"+callbackName)}else if(s.jsonp!==!1){s.url+=(rquery.test(s.url)?"&":"?")+s.jsonp+"="+callbackName}
s.converters["script json"]=function(){if(!responseContainer){jQuery.error(callbackName+" was not called")}
return responseContainer[0]};s.dataTypes[0]="json";overwritten=window[callbackName];window[callbackName]=function(){responseContainer=arguments};jqXHR.always(function(){window[callbackName]=overwritten;if(s[callbackName]){s.jsonpCallback=originalSettings.jsonpCallback;oldCallbacks.push(callbackName)}
if(responseContainer&&jQuery.isFunction(overwritten)){overwritten(responseContainer[0])}
responseContainer=overwritten=undefined});return "script"}});jQuery.parseHTML=function(data,context,keepScripts){if(!data||typeof data!=="string"){return null}
if(typeof context==="boolean"){keepScripts=context;context=!1}
context=context||document;var parsed=rsingleTag.exec(data),scripts=!keepScripts&&[];if(parsed){return[context.createElement(parsed[1])]}
parsed=jQuery.buildFragment([data],context,scripts);if(scripts&&scripts.length){jQuery(scripts).remove()}
return jQuery.merge([],parsed.childNodes)};var _load=jQuery.fn.load;jQuery.fn.load=function(url,params,callback){if(typeof url!=="string"&&_load){return _load.apply(this,arguments)}
var selector,response,type,self=this,off=url.indexOf(" ");if(off>=0){selector=url.slice(off,url.length);url=url.slice(0,off)}
if(jQuery.isFunction(params)){callback=params;params=undefined}else if(params&&typeof params==="object"){type="POST"}
if(self.length>0){jQuery.ajax({url:url,type:type,dataType:"html",data:params}).done(function(responseText){response=arguments;self.html(selector?jQuery("<div>").append(jQuery.parseHTML(responseText)).find(selector):responseText)}).complete(callback&&function(jqXHR,status){self.each(callback,response||[jqXHR.responseText,status,jqXHR])})}
return this};jQuery.expr.filters.animated=function(elem){return jQuery.grep(jQuery.timers,function(fn){return elem===fn.elem}).length};var docElem=window.document.documentElement;function getWindow(elem){return jQuery.isWindow(elem)?elem:elem.nodeType===9?elem.defaultView||elem.parentWindow:!1}
jQuery.offset={setOffset:function(elem,options,i){var curPosition,curLeft,curCSSTop,curTop,curOffset,curCSSLeft,calculatePosition,position=jQuery.css(elem,"position"),curElem=jQuery(elem),props={};if(position==="static"){elem.style.position="relative"}
curOffset=curElem.offset();curCSSTop=jQuery.css(elem,"top");curCSSLeft=jQuery.css(elem,"left");calculatePosition=(position==="absolute"||position==="fixed")&&jQuery.inArray("auto",[curCSSTop,curCSSLeft])>-1;if(calculatePosition){curPosition=curElem.position();curTop=curPosition.top;curLeft=curPosition.left}else{curTop=parseFloat(curCSSTop)||0;curLeft=parseFloat(curCSSLeft)||0}
if(jQuery.isFunction(options)){options=options.call(elem,i,curOffset)}
if(options.top!=null){props.top=(options.top-curOffset.top)+curTop}
if(options.left!=null){props.left=(options.left-curOffset.left)+curLeft}
if("using" in options){options.using.call(elem,props)}else{curElem.css(props)}}};jQuery.fn.extend({offset:function(options){if(arguments.length){return options===undefined?this:this.each(function(i){jQuery.offset.setOffset(this,options,i)})}
var docElem,win,box={top:0,left:0},elem=this[0],doc=elem&&elem.ownerDocument;if(!doc){return}
docElem=doc.documentElement;if(!jQuery.contains(docElem,elem)){return box}
if(typeof elem.getBoundingClientRect!==strundefined){box=elem.getBoundingClientRect()}
win=getWindow(doc);return{top:box.top+(win.pageYOffset||docElem.scrollTop)-(docElem.clientTop||0),left:box.left+(win.pageXOffset||docElem.scrollLeft)-(docElem.clientLeft||0)}},position:function(){if(!this[0]){return}
var offsetParent,offset,parentOffset={top:0,left:0},elem=this[0];if(jQuery.css(elem,"position")==="fixed"){offset=elem.getBoundingClientRect()}else{offsetParent=this.offsetParent();offset=this.offset();if(!jQuery.nodeName(offsetParent[0],"html")){parentOffset=offsetParent.offset()}
parentOffset.top+=jQuery.css(offsetParent[0],"borderTopWidth",!0);parentOffset.left+=jQuery.css(offsetParent[0],"borderLeftWidth",!0)}
return{top:offset.top-parentOffset.top-jQuery.css(elem,"marginTop",!0),left:offset.left-parentOffset.left-jQuery.css(elem,"marginLeft",!0)}},offsetParent:function(){return this.map(function(){var offsetParent=this.offsetParent||docElem;while(offsetParent&&(!jQuery.nodeName(offsetParent,"html")&&jQuery.css(offsetParent,"position")==="static")){offsetParent=offsetParent.offsetParent}
return offsetParent||docElem})}});jQuery.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(method,prop){var top=/Y/.test(prop);jQuery.fn[method]=function(val){return access(this,function(elem,method,val){var win=getWindow(elem);if(val===undefined){return win?(prop in win)?win[prop]:win.document.documentElement[method]:elem[method]}
if(win){win.scrollTo(!top?val:jQuery(win).scrollLeft(),top?val:jQuery(win).scrollTop())}else{elem[method]=val}},method,val,arguments.length,null)}});jQuery.each(["top","left"],function(i,prop){jQuery.cssHooks[prop]=addGetHookIf(support.pixelPosition,function(elem,computed){if(computed){computed=curCSS(elem,prop);return rnumnonpx.test(computed)?jQuery(elem).position()[prop]+"px":computed}})});jQuery.each({Height:"height",Width:"width"},function(name,type){jQuery.each({padding:"inner"+name,content:type,"":"outer"+name},function(defaultExtra,funcName){jQuery.fn[funcName]=function(margin,value){var chainable=arguments.length&&(defaultExtra||typeof margin!=="boolean"),extra=defaultExtra||(margin===!0||value===!0?"margin":"border");return access(this,function(elem,type,value){var doc;if(jQuery.isWindow(elem)){return elem.document.documentElement["client"+name]}
if(elem.nodeType===9){doc=elem.documentElement;return Math.max(elem.body["scroll"+name],doc["scroll"+name],elem.body["offset"+name],doc["offset"+name],doc["client"+name])}
return value===undefined?jQuery.css(elem,type,extra):jQuery.style(elem,type,value,extra)},type,chainable?margin:undefined,chainable,null)}})});jQuery.fn.size=function(){return this.length};jQuery.fn.andSelf=jQuery.fn.addBack;(function(){var matched,browser;jQuery.uaMatch=function(ua){ua=ua.toLowerCase();var match=/(chrome)[ \/]([\w.]+)/.exec(ua)||/(webkit)[ \/]([\w.]+)/.exec(ua)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(ua)||/(msie) ([\w.]+)/.exec(ua)||ua.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(ua)||[];return{browser:match[1]||"",version:match[2]||"0"}};matched=jQuery.uaMatch(navigator.userAgent);browser={};if(matched.browser){browser[matched.browser]=!0;browser.version=matched.version}
if(browser.chrome){browser.webkit=!0}else if(browser.webkit){browser.safari=!0}
jQuery.browser=browser})();jQuery.version="4.0";jQuery.long_version="4.0.32";jQuery.uid=function(p,s){return((p)?p:"")+Math.random().toString().replace(".","")+((s)?s:"")};jQuery.globalNamespace=jQuery.uid("Foundry");window[jQuery.globalNamespace]=jQuery;jQuery.run=function(command){return(jQuery.isFunction(command))?command(jQuery):null};jQuery.initialize=function(options){if(jQuery.initialized)return;jQuery.extend(jQuery,options);if(jQuery.environment=="development"){window.F=jQuery}
jQuery.initialized=!0;FD40.module.execute()}
FD40.jquery(jQuery);return jQuery})();FD40.plugin("lodash",function($){var undefined;var arrayPool=[],objectPool=[];var idCounter=0;var keyPrefix=+new Date+'';var largeArraySize=75;var maxPoolSize=40;var whitespace=(' \t\x0B\f\xA0\ufeff'+'\n\r\u2028\u2029'+'\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000');var reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g;var reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g;var reFlags=/\w*$/;var reFuncName=/^\s*function[ \n\r\t]+\w/;var reInterpolate=/<%=([\s\S]+?)%>/g;var reLeadingSpacesAndZeros=RegExp('^['+whitespace+']*0+(?=.$)');var reNoMatch=/($^)/;var reThis=/\bthis\b/;var reUnescapedString=/['\n\r\t\u2028\u2029\\]/g;var contextProps=['Array','Boolean','Date','Function','Math','Number','Object','RegExp','String','_','attachEvent','clearTimeout','isFinite','isNaN','parseInt','setTimeout'];var templateCounter=0;var argsClass='[object Arguments]',arrayClass='[object Array]',boolClass='[object Boolean]',dateClass='[object Date]',funcClass='[object Function]',numberClass='[object Number]',objectClass='[object Object]',regexpClass='[object RegExp]',stringClass='[object String]';var cloneableClasses={};cloneableClasses[funcClass]=!1;cloneableClasses[argsClass]=cloneableClasses[arrayClass]=cloneableClasses[boolClass]=cloneableClasses[dateClass]=cloneableClasses[numberClass]=cloneableClasses[objectClass]=cloneableClasses[regexpClass]=cloneableClasses[stringClass]=!0;var debounceOptions={'leading':!1,'maxWait':0,'trailing':!1};var descriptor={'configurable':!1,'enumerable':!1,'value':null,'writable':!1};var objectTypes={'boolean':!1,'function':!0,'object':!0,'number':!1,'string':!1,'undefined':!1};var stringEscapes={'\\':'\\',"'":"'",'\n':'n','\r':'r','\t':'t','\u2028':'u2028','\u2029':'u2029'};var root=(objectTypes[typeof window]&&window)||this;var freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports;var freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module;var moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports;var freeGlobal=objectTypes[typeof global]&&global;if(freeGlobal&&(freeGlobal.global===freeGlobal||freeGlobal.window===freeGlobal)){root=freeGlobal}
function baseIndexOf(array,value,fromIndex){var index=(fromIndex||0)-1,length=array?array.length:0;while(++index<length){if(array[index]===value){return index}}
return-1}
function cacheIndexOf(cache,value){var type=typeof value;cache=cache.cache;if(type=='boolean'||value==null){return cache[value]?0:-1}
if(type!='number'&&type!='string'){type='object'}
var key=type=='number'?value:keyPrefix+value;cache=(cache=cache[type])&&cache[key];return type=='object'?(cache&&baseIndexOf(cache,value)>-1?0:-1):(cache?0:-1)}
function cachePush(value){var cache=this.cache,type=typeof value;if(type=='boolean'||value==null){cache[value]=!0}else{if(type!='number'&&type!='string'){type='object'}
var key=type=='number'?value:keyPrefix+value,typeCache=cache[type]||(cache[type]={});if(type=='object'){(typeCache[key]||(typeCache[key]=[])).push(value)}else{typeCache[key]=!0}}}
function charAtCallback(value){return value.charCodeAt(0)}
function compareAscending(a,b){var ac=a.criteria,bc=b.criteria,index=-1,length=ac.length;while(++index<length){var value=ac[index],other=bc[index];if(value!==other){if(value>other||typeof value=='undefined'){return 1}
if(value<other||typeof other=='undefined'){return-1}}}
return a.index-b.index}
function createCache(array){var index=-1,length=array.length,first=array[0],mid=array[(length/2)|0],last=array[length-1];if(first&&typeof first=='object'&&mid&&typeof mid=='object'&&last&&typeof last=='object'){return!1}
var cache=getObject();cache['false']=cache['null']=cache['true']=cache.undefined=!1;var result=getObject();result.array=array;result.cache=cache;result.push=cachePush;while(++index<length){result.push(array[index])}
return result}
function escapeStringChar(match){return '\\'+stringEscapes[match]}
function getArray(){return arrayPool.pop()||[]}
function getObject(){return objectPool.pop()||{'array':null,'cache':null,'criteria':null,'false':!1,'index':0,'null':!1,'number':null,'object':null,'push':null,'string':null,'true':!1,'undefined':!1,'value':null}}
function releaseArray(array){array.length=0;if(arrayPool.length<maxPoolSize){arrayPool.push(array)}}
function releaseObject(object){var cache=object.cache;if(cache){releaseObject(cache)}
object.array=object.cache=object.criteria=object.object=object.number=object.string=object.value=null;if(objectPool.length<maxPoolSize){objectPool.push(object)}}
function slice(array,start,end){start||(start=0);if(typeof end=='undefined'){end=array?array.length:0}
var index=-1,length=end-start||0,result=Array(length<0?0:length);while(++index<length){result[index]=array[start+index]}
return result}
function runInContext(context){context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Boolean=context.Boolean,Date=context.Date,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError;var arrayRef=[];var objectProto=Object.prototype;var oldDash=context._;var toString=objectProto.toString;var reNative=RegExp('^'+String(toString).replace(/[.*+?^${}()|[\]\\]/g,'\\$&').replace(/toString| for [^\]]+/g,'.*?')+'$');var ceil=Math.ceil,clearTimeout=context.clearTimeout,floor=Math.floor,fnToString=Function.prototype.toString,getPrototypeOf=isNative(getPrototypeOf=Object.getPrototypeOf)&&getPrototypeOf,hasOwnProperty=objectProto.hasOwnProperty,push=arrayRef.push,setTimeout=context.setTimeout,splice=arrayRef.splice,unshift=arrayRef.unshift;var defineProperty=(function(){try{var o={},func=isNative(func=Object.defineProperty)&&func,result=func(o,o,o)&&func}catch(e){}
return result}());var nativeCreate=isNative(nativeCreate=Object.create)&&nativeCreate,nativeIsArray=isNative(nativeIsArray=Array.isArray)&&nativeIsArray,nativeIsFinite=context.isFinite,nativeIsNaN=context.isNaN,nativeKeys=isNative(nativeKeys=Object.keys)&&nativeKeys,nativeMax=Math.max,nativeMin=Math.min,nativeParseInt=context.parseInt,nativeRandom=Math.random;var ctorByClass={};ctorByClass[arrayClass]=Array;ctorByClass[boolClass]=Boolean;ctorByClass[dateClass]=Date;ctorByClass[funcClass]=Function;ctorByClass[objectClass]=Object;ctorByClass[numberClass]=Number;ctorByClass[regexpClass]=RegExp;ctorByClass[stringClass]=String;function lodash(value){return(value&&typeof value=='object'&&!isArray(value)&&hasOwnProperty.call(value,'__wrapped__'))?value:new lodashWrapper(value)}
function lodashWrapper(value,chainAll){this.__chain__=!!chainAll;this.__wrapped__=value}
lodashWrapper.prototype=lodash.prototype;var support=lodash.support={};support.funcDecomp=!isNative(context.WinRTError)&&reThis.test(runInContext);support.funcNames=typeof Function.name=='string';lodash.templateSettings={'escape':/<%-([\s\S]+?)%>/g,'evaluate':/<%([\s\S]+?)%>/g,'interpolate':reInterpolate,'variable':'','imports':{'_':lodash}};function baseBind(bindData){var func=bindData[0],partialArgs=bindData[2],thisArg=bindData[4];function bound(){if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}
if(this instanceof bound){var thisBinding=baseCreate(func.prototype),result=func.apply(thisBinding,args||arguments);return isObject(result)?result:thisBinding}
return func.apply(thisArg,args||arguments)}
setBindData(bound,bindData);return bound}
function baseClone(value,isDeep,callback,stackA,stackB){if(callback){var result=callback(value);if(typeof result!='undefined'){return result}}
var isObj=isObject(value);if(isObj){var className=toString.call(value);if(!cloneableClasses[className]){return value}
var ctor=ctorByClass[className];switch(className){case boolClass:case dateClass:return new ctor(+value);case numberClass:case stringClass:return new ctor(value);case regexpClass:result=ctor(value.source,reFlags.exec(value));result.lastIndex=value.lastIndex;return result}}else{return value}
var isArr=isArray(value);if(isDeep){var initedStack=!stackA;stackA||(stackA=getArray());stackB||(stackB=getArray());var length=stackA.length;while(length--){if(stackA[length]==value){return stackB[length]}}
result=isArr?ctor(value.length):{}}
else{result=isArr?slice(value):assign({},value)}
if(isArr){if(hasOwnProperty.call(value,'index')){result.index=value.index}
if(hasOwnProperty.call(value,'input')){result.input=value.input}}
if(!isDeep){return result}
stackA.push(value);stackB.push(result);(isArr?forEach:forOwn)(value,function(objValue,key){result[key]=baseClone(objValue,isDeep,callback,stackA,stackB)});if(initedStack){releaseArray(stackA);releaseArray(stackB)}
return result}
function baseCreate(prototype,properties){return isObject(prototype)?nativeCreate(prototype):{}}
if(!nativeCreate){baseCreate=(function(){function Object(){}
return function(prototype){if(isObject(prototype)){Object.prototype=prototype;var result=new Object;Object.prototype=null}
return result||context.Object()}}())}
function baseCreateCallback(func,thisArg,argCount){if(typeof func!='function'){return identity}
if(typeof thisArg=='undefined'||!('prototype' in func)){return func}
var bindData=func.__bindData__;if(typeof bindData=='undefined'){if(support.funcNames){bindData=!func.name}
bindData=bindData||!support.funcDecomp;if(!bindData){var source=fnToString.call(func);if(!support.funcNames){bindData=!reFuncName.test(source)}
if(!bindData){bindData=reThis.test(source);setBindData(func,bindData)}}}
if(bindData===!1||(bindData!==!0&&bindData[1]&1)){return func}
switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 2:return function(a,b){return func.call(thisArg,a,b)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)}}
return bind(func,thisArg)}
function baseCreateWrapper(bindData){var func=bindData[0],bitmask=bindData[1],partialArgs=bindData[2],partialRightArgs=bindData[3],thisArg=bindData[4],arity=bindData[5];var isBind=bitmask&1,isBindKey=bitmask&2,isCurry=bitmask&4,isCurryBound=bitmask&8,key=func;function bound(){var thisBinding=isBind?thisArg:this;if(partialArgs){var args=slice(partialArgs);push.apply(args,arguments)}
if(partialRightArgs||isCurry){args||(args=slice(arguments));if(partialRightArgs){push.apply(args,partialRightArgs)}
if(isCurry&&args.length<arity){bitmask|=16&~32;return baseCreateWrapper([func,(isCurryBound?bitmask:bitmask&~3),args,null,thisArg,arity])}}
args||(args=arguments);if(isBindKey){func=thisBinding[key]}
if(this instanceof bound){thisBinding=baseCreate(func.prototype);var result=func.apply(thisBinding,args);return isObject(result)?result:thisBinding}
return func.apply(thisBinding,args)}
setBindData(bound,bindData);return bound}
function baseDifference(array,values){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,isLarge=length>=largeArraySize&&indexOf===baseIndexOf,result=[];if(isLarge){var cache=createCache(values);if(cache){indexOf=cacheIndexOf;values=cache}else{isLarge=!1}}
while(++index<length){var value=array[index];if(indexOf(values,value)<0){result.push(value)}}
if(isLarge){releaseObject(values)}
return result}
function baseFlatten(array,isShallow,isStrict,fromIndex){var index=(fromIndex||0)-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value&&typeof value=='object'&&typeof value.length=='number'&&(isArray(value)||isArguments(value))){if(!isShallow){value=baseFlatten(value,isShallow,isStrict)}
var valIndex=-1,valLength=value.length,resIndex=result.length;result.length+=valLength;while(++valIndex<valLength){result[resIndex++]=value[valIndex]}}else if(!isStrict){result.push(value)}}
return result}
function baseIsEqual(a,b,callback,isWhere,stackA,stackB){if(callback){var result=callback(a,b);if(typeof result!='undefined'){return!!result}}
if(a===b){return a!==0||(1/a==1/b)}
var type=typeof a,otherType=typeof b;if(a===a&&!(a&&objectTypes[type])&&!(b&&objectTypes[otherType])){return!1}
if(a==null||b==null){return a===b}
var className=toString.call(a),otherClass=toString.call(b);if(className==argsClass){className=objectClass}
if(otherClass==argsClass){otherClass=objectClass}
if(className!=otherClass){return!1}
switch(className){case boolClass:case dateClass:return+a==+b;case numberClass:return(a!=+a)?b!=+b:(a==0?(1/a==1/b):a==+b);case regexpClass:case stringClass:return a==String(b)}
var isArr=className==arrayClass;if(!isArr){var aWrapped=hasOwnProperty.call(a,'__wrapped__'),bWrapped=hasOwnProperty.call(b,'__wrapped__');if(aWrapped||bWrapped){return baseIsEqual(aWrapped?a.__wrapped__:a,bWrapped?b.__wrapped__:b,callback,isWhere,stackA,stackB)}
if(className!=objectClass){return!1}
var ctorA=a.constructor,ctorB=b.constructor;if(ctorA!=ctorB&&!(isFunction(ctorA)&&ctorA instanceof ctorA&&isFunction(ctorB)&&ctorB instanceof ctorB)&&('constructor' in a&&'constructor' in b)){return!1}}
var initedStack=!stackA;stackA||(stackA=getArray());stackB||(stackB=getArray());var length=stackA.length;while(length--){if(stackA[length]==a){return stackB[length]==b}}
var size=0;result=!0;stackA.push(a);stackB.push(b);if(isArr){length=a.length;size=b.length;result=size==length;if(result||isWhere){while(size--){var index=length,value=b[size];if(isWhere){while(index--){if((result=baseIsEqual(a[index],value,callback,isWhere,stackA,stackB))){break}}}else if(!(result=baseIsEqual(a[size],value,callback,isWhere,stackA,stackB))){break}}}}
else{forIn(b,function(value,key,b){if(hasOwnProperty.call(b,key)){size++;return(result=hasOwnProperty.call(a,key)&&baseIsEqual(a[key],value,callback,isWhere,stackA,stackB))}});if(result&&!isWhere){forIn(a,function(value,key,a){if(hasOwnProperty.call(a,key)){return(result=--size>-1)}})}}
stackA.pop();stackB.pop();if(initedStack){releaseArray(stackA);releaseArray(stackB)}
return result}
function baseMerge(object,source,callback,stackA,stackB){(isArray(source)?forEach:forOwn)(source,function(source,key){var found,isArr,result=source,value=object[key];if(source&&((isArr=isArray(source))||isPlainObject(source))){var stackLength=stackA.length;while(stackLength--){if((found=stackA[stackLength]==source)){value=stackB[stackLength];break}}
if(!found){var isShallow;if(callback){result=callback(value,source);if((isShallow=typeof result!='undefined')){value=result}}
if(!isShallow){value=isArr?(isArray(value)?value:[]):(isPlainObject(value)?value:{})}
stackA.push(source);stackB.push(value);if(!isShallow){baseMerge(value,source,callback,stackA,stackB)}}}
else{if(callback){result=callback(value,source);if(typeof result=='undefined'){result=source}}
if(typeof result!='undefined'){value=result}}
object[key]=value})}
function baseRandom(min,max){return min+floor(nativeRandom()*(max-min+1))}
function baseUniq(array,isSorted,callback){var index=-1,indexOf=getIndexOf(),length=array?array.length:0,result=[];var isLarge=!isSorted&&length>=largeArraySize&&indexOf===baseIndexOf,seen=(callback||isLarge)?getArray():result;if(isLarge){var cache=createCache(seen);indexOf=cacheIndexOf;seen=cache}
while(++index<length){var value=array[index],computed=callback?callback(value,index,array):value;if(isSorted?!index||seen[seen.length-1]!==computed:indexOf(seen,computed)<0){if(callback||isLarge){seen.push(computed)}
result.push(value)}}
if(isLarge){releaseArray(seen.array);releaseObject(seen)}else if(callback){releaseArray(seen)}
return result}
function createAggregator(setter){return function(collection,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=='number'){while(++index<length){var value=collection[index];setter(result,value,callback(value,index,collection),collection)}}else{forOwn(collection,function(value,key,collection){setter(result,value,callback(value,key,collection),collection)})}
return result}}
function createWrapper(func,bitmask,partialArgs,partialRightArgs,thisArg,arity){var isBind=bitmask&1,isBindKey=bitmask&2,isCurry=bitmask&4,isCurryBound=bitmask&8,isPartial=bitmask&16,isPartialRight=bitmask&32;if(!isBindKey&&!isFunction(func)){throw new TypeError}
if(isPartial&&!partialArgs.length){bitmask&=~16;isPartial=partialArgs=!1}
if(isPartialRight&&!partialRightArgs.length){bitmask&=~32;isPartialRight=partialRightArgs=!1}
var bindData=func&&func.__bindData__;if(bindData&&bindData!==!0){bindData=slice(bindData);if(bindData[2]){bindData[2]=slice(bindData[2])}
if(bindData[3]){bindData[3]=slice(bindData[3])}
if(isBind&&!(bindData[1]&1)){bindData[4]=thisArg}
if(!isBind&&bindData[1]&1){bitmask|=8}
if(isCurry&&!(bindData[1]&4)){bindData[5]=arity}
if(isPartial){push.apply(bindData[2]||(bindData[2]=[]),partialArgs)}
if(isPartialRight){unshift.apply(bindData[3]||(bindData[3]=[]),partialRightArgs)}
bindData[1]|=bitmask;return createWrapper.apply(null,bindData)}
var creater=(bitmask==1||bitmask===17)?baseBind:baseCreateWrapper;return creater([func,bitmask,partialArgs,partialRightArgs,thisArg,arity])}
function escapeHtmlChar(match){return htmlEscapes[match]}
function getIndexOf(){var result=(result=lodash.indexOf)===indexOf?baseIndexOf:result;return result}
function isNative(value){return typeof value=='function'&&reNative.test(value)}
var setBindData=!defineProperty?noop:function(func,value){descriptor.value=value;defineProperty(func,'__bindData__',descriptor)};function shimIsPlainObject(value){var ctor,result;if(!(value&&toString.call(value)==objectClass)||(ctor=value.constructor,isFunction(ctor)&&!(ctor instanceof ctor))){return!1}
forIn(value,function(value,key){result=key});return typeof result=='undefined'||hasOwnProperty.call(value,result)}
function unescapeHtmlChar(match){return htmlUnescapes[match]}
function isArguments(value){return value&&typeof value=='object'&&typeof value.length=='number'&&toString.call(value)==argsClass||!1}
var isArray=nativeIsArray||function(value){return value&&typeof value=='object'&&typeof value.length=='number'&&toString.call(value)==arrayClass||!1};var shimKeys=function(object){var index,iterable=object,result=[];if(!iterable)return result;if(!(objectTypes[typeof object]))return result;for(index in iterable){if(hasOwnProperty.call(iterable,index)){result.push(index)}}
return result};var keys=!nativeKeys?shimKeys:function(object){if(!isObject(object)){return[]}
return nativeKeys(object)};var htmlEscapes={'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'};var htmlUnescapes=invert(htmlEscapes);var reEscapedHtml=RegExp('('+keys(htmlUnescapes).join('|')+')','g'),reUnescapedHtml=RegExp('['+keys(htmlEscapes).join('')+']','g');var assign=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=='number'?2:args.length;if(argsLength>3&&typeof args[argsLength-2]=='function'){var callback=baseCreateCallback(args[--argsLength-1],args[argsLength--],2)}else if(argsLength>2&&typeof args[argsLength-1]=='function'){callback=args[--argsLength]}
while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];result[index]=callback?callback(result[index],iterable[index]):iterable[index]}}}
return result};function clone(value,isDeep,callback,thisArg){if(typeof isDeep!='boolean'&&isDeep!=null){thisArg=callback;callback=isDeep;isDeep=!1}
return baseClone(value,isDeep,typeof callback=='function'&&baseCreateCallback(callback,thisArg,1))}
function cloneDeep(value,callback,thisArg){return baseClone(value,!0,typeof callback=='function'&&baseCreateCallback(callback,thisArg,1))}
function create(prototype,properties){var result=baseCreate(prototype);return properties?assign(result,properties):result}
var defaults=function(object,source,guard){var index,iterable=object,result=iterable;if(!iterable)return result;var args=arguments,argsIndex=0,argsLength=typeof guard=='number'?2:args.length;while(++argsIndex<argsLength){iterable=args[argsIndex];if(iterable&&objectTypes[typeof iterable]){var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];if(typeof result[index]=='undefined')result[index]=iterable[index]}}}
return result};function findKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forOwn(object,function(value,key,object){if(callback(value,key,object)){result=key;return!1}});return result}
function findLastKey(object,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forOwnRight(object,function(value,key,object){if(callback(value,key,object)){result=key;return!1}});return result}
var forIn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=='undefined'?callback:baseCreateCallback(callback,thisArg,3);for(index in iterable){if(callback(iterable[index],index,collection)===!1)return result}
return result};function forInRight(object,callback,thisArg){var pairs=[];forIn(object,function(value,key){pairs.push(key,value)});var length=pairs.length;callback=baseCreateCallback(callback,thisArg,3);while(length--){if(callback(pairs[length--],pairs[length],object)===!1){break}}
return object}
var forOwn=function(collection,callback,thisArg){var index,iterable=collection,result=iterable;if(!iterable)return result;if(!objectTypes[typeof iterable])return result;callback=callback&&typeof thisArg=='undefined'?callback:baseCreateCallback(callback,thisArg,3);var ownIndex=-1,ownProps=objectTypes[typeof iterable]&&keys(iterable),length=ownProps?ownProps.length:0;while(++ownIndex<length){index=ownProps[ownIndex];if(callback(iterable[index],index,collection)===!1)return result}
return result};function forOwnRight(object,callback,thisArg){var props=keys(object),length=props.length;callback=baseCreateCallback(callback,thisArg,3);while(length--){var key=props[length];if(callback(object[key],key,object)===!1){break}}
return object}
function functions(object){var result=[];forIn(object,function(value,key){if(isFunction(value)){result.push(key)}});return result.sort()}
function has(object,key){return object?hasOwnProperty.call(object,key):!1}
function invert(object){var index=-1,props=keys(object),length=props.length,result={};while(++index<length){var key=props[index];result[object[key]]=key}
return result}
function isBoolean(value){return value===!0||value===!1||value&&typeof value=='object'&&toString.call(value)==boolClass||!1}
function isDate(value){return value&&typeof value=='object'&&toString.call(value)==dateClass||!1}
function isElement(value){return value&&value.nodeType===1||!1}
function isEmpty(value){var result=!0;if(!value){return result}
var className=toString.call(value),length=value.length;if((className==arrayClass||className==stringClass||className==argsClass)||(className==objectClass&&typeof length=='number'&&isFunction(value.splice))){return!length}
forOwn(value,function(){return(result=!1)});return result}
function isEqual(a,b,callback,thisArg){return baseIsEqual(a,b,typeof callback=='function'&&baseCreateCallback(callback,thisArg,2))}
function isFinite(value){return nativeIsFinite(value)&&!nativeIsNaN(parseFloat(value))}
function isFunction(value){return typeof value=='function'}
function isObject(value){return!!(value&&objectTypes[typeof value])}
function isNaN(value){return isNumber(value)&&value!=+value}
function isNull(value){return value===null}
function isNumber(value){return typeof value=='number'||value&&typeof value=='object'&&toString.call(value)==numberClass||!1}
var isPlainObject=!getPrototypeOf?shimIsPlainObject:function(value){if(!(value&&toString.call(value)==objectClass)){return!1}
var valueOf=value.valueOf,objProto=isNative(valueOf)&&(objProto=getPrototypeOf(valueOf))&&getPrototypeOf(objProto);return objProto?(value==objProto||getPrototypeOf(value)==objProto):shimIsPlainObject(value)};function isRegExp(value){return value&&typeof value=='object'&&toString.call(value)==regexpClass||!1}
function isString(value){return typeof value=='string'||value&&typeof value=='object'&&toString.call(value)==stringClass||!1}
function isUndefined(value){return typeof value=='undefined'}
function mapValues(object,callback,thisArg){var result={};callback=lodash.createCallback(callback,thisArg,3);forOwn(object,function(value,key,object){result[key]=callback(value,key,object)});return result}
function merge(object){var args=arguments,length=2;if(!isObject(object)){return object}
if(typeof args[2]!='number'){length=args.length}
if(length>3&&typeof args[length-2]=='function'){var callback=baseCreateCallback(args[--length-1],args[length--],2)}else if(length>2&&typeof args[length-1]=='function'){callback=args[--length]}
var sources=slice(arguments,1,length),index=-1,stackA=getArray(),stackB=getArray();while(++index<length){baseMerge(object,sources[index],callback,stackA,stackB)}
releaseArray(stackA);releaseArray(stackB);return object}
function omit(object,callback,thisArg){var result={};if(typeof callback!='function'){var props=[];forIn(object,function(value,key){props.push(key)});props=baseDifference(props,baseFlatten(arguments,!0,!1,1));var index=-1,length=props.length;while(++index<length){var key=props[index];result[key]=object[key]}}else{callback=lodash.createCallback(callback,thisArg,3);forIn(object,function(value,key,object){if(!callback(value,key,object)){result[key]=value}})}
return result}
function pairs(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){var key=props[index];result[index]=[key,object[key]]}
return result}
function pick(object,callback,thisArg){var result={};if(typeof callback!='function'){var index=-1,props=baseFlatten(arguments,!0,!1,1),length=isObject(object)?props.length:0;while(++index<length){var key=props[index];if(key in object){result[key]=object[key]}}}else{callback=lodash.createCallback(callback,thisArg,3);forIn(object,function(value,key,object){if(callback(value,key,object)){result[key]=value}})}
return result}
function transform(object,callback,accumulator,thisArg){var isArr=isArray(object);if(accumulator==null){if(isArr){accumulator=[]}else{var ctor=object&&object.constructor,proto=ctor&&ctor.prototype;accumulator=baseCreate(proto)}}
if(callback){callback=lodash.createCallback(callback,thisArg,4);(isArr?forEach:forOwn)(object,function(value,index,object){return callback(accumulator,value,index,object)})}
return accumulator}
function values(object){var index=-1,props=keys(object),length=props.length,result=Array(length);while(++index<length){result[index]=object[props[index]]}
return result}
function at(collection){var args=arguments,index=-1,props=baseFlatten(args,!0,!1,1),length=(args[2]&&args[2][args[1]]===collection)?1:props.length,result=Array(length);while(++index<length){result[index]=collection[props[index]]}
return result}
function contains(collection,target,fromIndex){var index=-1,indexOf=getIndexOf(),length=collection?collection.length:0,result=!1;fromIndex=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex)||0;if(isArray(collection)){result=indexOf(collection,target,fromIndex)>-1}else if(typeof length=='number'){result=(isString(collection)?collection.indexOf(target,fromIndex):indexOf(collection,target,fromIndex))>-1}else{forOwn(collection,function(value){if(++index>=fromIndex){return!(result=value===target)}})}
return result}
var countBy=createAggregator(function(result,value,key){(hasOwnProperty.call(result,key)?result[key]++:result[key]=1)});function every(collection,callback,thisArg){var result=!0;callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=='number'){while(++index<length){if(!(result=!!callback(collection[index],index,collection))){break}}}else{forOwn(collection,function(value,index,collection){return(result=!!callback(value,index,collection))})}
return result}
function filter(collection,callback,thisArg){var result=[];callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=='number'){while(++index<length){var value=collection[index];if(callback(value,index,collection)){result.push(value)}}}else{forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result.push(value)}})}
return result}
function find(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=='number'){while(++index<length){var value=collection[index];if(callback(value,index,collection)){return value}}}else{var result;forOwn(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return!1}});return result}}
function findLast(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);forEachRight(collection,function(value,index,collection){if(callback(value,index,collection)){result=value;return!1}});return result}
function forEach(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=callback&&typeof thisArg=='undefined'?callback:baseCreateCallback(callback,thisArg,3);if(typeof length=='number'){while(++index<length){if(callback(collection[index],index,collection)===!1){break}}}else{forOwn(collection,callback)}
return collection}
function forEachRight(collection,callback,thisArg){var length=collection?collection.length:0;callback=callback&&typeof thisArg=='undefined'?callback:baseCreateCallback(callback,thisArg,3);if(typeof length=='number'){while(length--){if(callback(collection[length],length,collection)===!1){break}}}else{var props=keys(collection);length=props.length;forOwn(collection,function(value,key,collection){key=props?props[--length]:--length;return callback(collection[key],key,collection)})}
return collection}
var groupBy=createAggregator(function(result,value,key){(hasOwnProperty.call(result,key)?result[key]:result[key]=[]).push(value)});var indexBy=createAggregator(function(result,value,key){result[key]=value});function invoke(collection,methodName){var args=slice(arguments,2),index=-1,isFunc=typeof methodName=='function',length=collection?collection.length:0,result=Array(typeof length=='number'?length:0);forEach(collection,function(value){result[++index]=(isFunc?methodName:value[methodName]).apply(value,args)});return result}
function map(collection,callback,thisArg){var index=-1,length=collection?collection.length:0;callback=lodash.createCallback(callback,thisArg,3);if(typeof length=='number'){var result=Array(length);while(++index<length){result[index]=callback(collection[index],index,collection)}}else{result=[];forOwn(collection,function(value,key,collection){result[++index]=callback(value,key,collection)})}
return result}
function max(collection,callback,thisArg){var computed=-Infinity,result=computed;if(typeof callback!='function'&&thisArg&&thisArg[callback]===collection){callback=null}
if(callback==null&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value>result){result=value}}}else{callback=(callback==null&&isString(collection))?charAtCallback:lodash.createCallback(callback,thisArg,3);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current>computed){computed=current;result=value}})}
return result}
function min(collection,callback,thisArg){var computed=Infinity,result=computed;if(typeof callback!='function'&&thisArg&&thisArg[callback]===collection){callback=null}
if(callback==null&&isArray(collection)){var index=-1,length=collection.length;while(++index<length){var value=collection[index];if(value<result){result=value}}}else{callback=(callback==null&&isString(collection))?charAtCallback:lodash.createCallback(callback,thisArg,3);forEach(collection,function(value,index,collection){var current=callback(value,index,collection);if(current<computed){computed=current;result=value}})}
return result}
var pluck=map;function reduce(collection,callback,accumulator,thisArg){if(!collection)return accumulator;var noaccum=arguments.length<3;callback=lodash.createCallback(callback,thisArg,4);var index=-1,length=collection.length;if(typeof length=='number'){if(noaccum){accumulator=collection[++index]}
while(++index<length){accumulator=callback(accumulator,collection[index],index,collection)}}else{forOwn(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)})}
return accumulator}
function reduceRight(collection,callback,accumulator,thisArg){var noaccum=arguments.length<3;callback=lodash.createCallback(callback,thisArg,4);forEachRight(collection,function(value,index,collection){accumulator=noaccum?(noaccum=!1,value):callback(accumulator,value,index,collection)});return accumulator}
function reject(collection,callback,thisArg){callback=lodash.createCallback(callback,thisArg,3);return filter(collection,function(value,index,collection){return!callback(value,index,collection)})}
function sample(collection,n,guard){if(collection&&typeof collection.length!='number'){collection=values(collection)}
if(n==null||guard){return collection?collection[baseRandom(0,collection.length-1)]:undefined}
var result=shuffle(collection);result.length=nativeMin(nativeMax(0,n),result.length);return result}
function shuffle(collection){var index=-1,length=collection?collection.length:0,result=Array(typeof length=='number'?length:0);forEach(collection,function(value){var rand=baseRandom(0,++index);result[index]=result[rand];result[rand]=value});return result}
function size(collection){var length=collection?collection.length:0;return typeof length=='number'?length:keys(collection).length}
function some(collection,callback,thisArg){var result;callback=lodash.createCallback(callback,thisArg,3);var index=-1,length=collection?collection.length:0;if(typeof length=='number'){while(++index<length){if((result=callback(collection[index],index,collection))){break}}}else{forOwn(collection,function(value,index,collection){return!(result=callback(value,index,collection))})}
return!!result}
function sortBy(collection,callback,thisArg){var index=-1,isArr=isArray(callback),length=collection?collection.length:0,result=Array(typeof length=='number'?length:0);if(!isArr){callback=lodash.createCallback(callback,thisArg,3)}
forEach(collection,function(value,key,collection){var object=result[++index]=getObject();if(isArr){object.criteria=map(callback,function(key){return value[key]})}else{(object.criteria=getArray())[0]=callback(value,key,collection)}
object.index=index;object.value=value});length=result.length;result.sort(compareAscending);while(length--){var object=result[length];result[length]=object.value;if(!isArr){releaseArray(object.criteria)}
releaseObject(object)}
return result}
function toArray(collection){if(collection&&typeof collection.length=='number'){return slice(collection)}
return values(collection)}
var where=filter;function compact(array){var index=-1,length=array?array.length:0,result=[];while(++index<length){var value=array[index];if(value){result.push(value)}}
return result}
function difference(array){return baseDifference(array,baseFlatten(arguments,!0,!0,1))}
function findIndex(array,callback,thisArg){var index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(++index<length){if(callback(array[index],index,array)){return index}}
return-1}
function findLastIndex(array,callback,thisArg){var length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(length--){if(callback(array[length],length,array)){return length}}
return-1}
function first(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!='number'&&callback!=null){var index=-1;callback=lodash.createCallback(callback,thisArg,3);while(++index<length&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array?array[0]:undefined}}
return slice(array,0,nativeMin(nativeMax(0,n),length))}
function flatten(array,isShallow,callback,thisArg){if(typeof isShallow!='boolean'&&isShallow!=null){thisArg=callback;callback=(typeof isShallow!='function'&&thisArg&&thisArg[isShallow]===array)?null:isShallow;isShallow=!1}
if(callback!=null){array=map(array,callback,thisArg)}
return baseFlatten(array,isShallow)}
function indexOf(array,value,fromIndex){if(typeof fromIndex=='number'){var length=array?array.length:0;fromIndex=(fromIndex<0?nativeMax(0,length+fromIndex):fromIndex||0)}else if(fromIndex){var index=sortedIndex(array,value);return array[index]===value?index:-1}
return baseIndexOf(array,value,fromIndex)}
function initial(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!='number'&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg,3);while(index--&&callback(array[index],index,array)){n++}}else{n=(callback==null||thisArg)?1:callback||n}
return slice(array,0,nativeMin(nativeMax(0,length-n),length))}
function intersection(){var args=[],argsIndex=-1,argsLength=arguments.length,caches=getArray(),indexOf=getIndexOf(),trustIndexOf=indexOf===baseIndexOf,seen=getArray();while(++argsIndex<argsLength){var value=arguments[argsIndex];if(isArray(value)||isArguments(value)){args.push(value);caches.push(trustIndexOf&&value.length>=largeArraySize&&createCache(argsIndex?args[argsIndex]:seen))}}
var array=args[0],index=-1,length=array?array.length:0,result=[];outer:while(++index<length){var cache=caches[0];value=array[index];if((cache?cacheIndexOf(cache,value):indexOf(seen,value))<0){argsIndex=argsLength;(cache||seen).push(value);while(--argsIndex){cache=caches[argsIndex];if((cache?cacheIndexOf(cache,value):indexOf(args[argsIndex],value))<0){continue outer}}
result.push(value)}}
while(argsLength--){cache=caches[argsLength];if(cache){releaseObject(cache)}}
releaseArray(caches);releaseArray(seen);return result}
function last(array,callback,thisArg){var n=0,length=array?array.length:0;if(typeof callback!='number'&&callback!=null){var index=length;callback=lodash.createCallback(callback,thisArg,3);while(index--&&callback(array[index],index,array)){n++}}else{n=callback;if(n==null||thisArg){return array?array[length-1]:undefined}}
return slice(array,nativeMax(0,length-n))}
function lastIndexOf(array,value,fromIndex){var index=array?array.length:0;if(typeof fromIndex=='number'){index=(fromIndex<0?nativeMax(0,index+fromIndex):nativeMin(fromIndex,index-1))+1}
while(index--){if(array[index]===value){return index}}
return-1}
function pull(array){var args=arguments,argsIndex=0,argsLength=args.length,length=array?array.length:0;while(++argsIndex<argsLength){var index=-1,value=args[argsIndex];while(++index<length){if(array[index]===value){splice.call(array,index--,1);length--}}}
return array}
function range(start,end,step){start=+start||0;step=typeof step=='number'?step:(+step||1);if(end==null){end=start;start=0}
var index=-1,length=nativeMax(0,ceil((end-start)/(step||1))),result=Array(length);while(++index<length){result[index]=start;start+=step}
return result}
function remove(array,callback,thisArg){var index=-1,length=array?array.length:0,result=[];callback=lodash.createCallback(callback,thisArg,3);while(++index<length){var value=array[index];if(callback(value,index,array)){result.push(value);splice.call(array,index--,1);length--}}
return result}
function rest(array,callback,thisArg){if(typeof callback!='number'&&callback!=null){var n=0,index=-1,length=array?array.length:0;callback=lodash.createCallback(callback,thisArg,3);while(++index<length&&callback(array[index],index,array)){n++}}else{n=(callback==null||thisArg)?1:nativeMax(0,callback)}
return slice(array,n)}
function sortedIndex(array,value,callback,thisArg){var low=0,high=array?array.length:low;callback=callback?lodash.createCallback(callback,thisArg,1):identity;value=callback(value);while(low<high){var mid=(low+high)>>>1;(callback(array[mid])<value)?low=mid+1:high=mid}
return low}
function union(){return baseUniq(baseFlatten(arguments,!0,!0))}
function uniq(array,isSorted,callback,thisArg){if(typeof isSorted!='boolean'&&isSorted!=null){thisArg=callback;callback=(typeof isSorted!='function'&&thisArg&&thisArg[isSorted]===array)?null:isSorted;isSorted=!1}
if(callback!=null){callback=lodash.createCallback(callback,thisArg,3)}
return baseUniq(array,isSorted,callback)}
function without(array){return baseDifference(array,slice(arguments,1))}
function xor(){var index=-1,length=arguments.length;while(++index<length){var array=arguments[index];if(isArray(array)||isArguments(array)){var result=result?baseUniq(baseDifference(result,array).concat(baseDifference(array,result))):array}}
return result||[]}
function zip(){var array=arguments.length>1?arguments:arguments[0],index=-1,length=array?max(pluck(array,'length')):0,result=Array(length<0?0:length);while(++index<length){result[index]=pluck(array,index)}
return result}
function zipObject(keys,values){var index=-1,length=keys?keys.length:0,result={};if(!values&&length&&!isArray(keys[0])){values=[]}
while(++index<length){var key=keys[index];if(values){result[key]=values[index]}else if(key){result[key[0]]=key[1]}}
return result}
function after(n,func){if(!isFunction(func)){throw new TypeError}
return function(){if(--n<1){return func.apply(this,arguments)}}}
function bind(func,thisArg){return arguments.length>2?createWrapper(func,17,slice(arguments,2),null,thisArg):createWrapper(func,1,null,null,thisArg)}
function bindAll(object){var funcs=arguments.length>1?baseFlatten(arguments,!0,!1,1):functions(object),index=-1,length=funcs.length;while(++index<length){var key=funcs[index];object[key]=createWrapper(object[key],1,null,null,object)}
return object}
function bindKey(object,key){return arguments.length>2?createWrapper(key,19,slice(arguments,2),null,object):createWrapper(key,3,null,null,object)}
function compose(){var funcs=arguments,length=funcs.length;while(length--){if(!isFunction(funcs[length])){throw new TypeError}}
return function(){var args=arguments,length=funcs.length;while(length--){args=[funcs[length].apply(this,args)]}
return args[0]}}
function curry(func,arity){arity=typeof arity=='number'?arity:(+arity||func.length);return createWrapper(func,4,null,null,null,arity)}
function debounce(func,wait,options){var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if(!isFunction(func)){throw new TypeError}
wait=nativeMax(0,wait)||0;if(options===!0){var leading=!0;trailing=!1}else if(isObject(options)){leading=options.leading;maxWait='maxWait' in options&&(nativeMax(wait,options.maxWait)||0);trailing='trailing' in options?options.trailing:trailing}
var delayed=function(){var remaining=wait-(now()-stamp);if(remaining<=0){if(maxTimeoutId){clearTimeout(maxTimeoutId)}
var isCalled=trailingCall;maxTimeoutId=timeoutId=trailingCall=undefined;if(isCalled){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=null}}}else{timeoutId=setTimeout(delayed,remaining)}};var maxDelayed=function(){if(timeoutId){clearTimeout(timeoutId)}
maxTimeoutId=timeoutId=trailingCall=undefined;if(trailing||(maxWait!==wait)){lastCalled=now();result=func.apply(thisArg,args);if(!timeoutId&&!maxTimeoutId){args=thisArg=null}}};return function(){args=arguments;stamp=now();thisArg=this;trailingCall=trailing&&(timeoutId||!leading);if(maxWait===!1){var leadingCall=leading&&!timeoutId}else{if(!maxTimeoutId&&!leading){lastCalled=stamp}
var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0;if(isCalled){if(maxTimeoutId){maxTimeoutId=clearTimeout(maxTimeoutId)}
lastCalled=stamp;result=func.apply(thisArg,args)}
else if(!maxTimeoutId){maxTimeoutId=setTimeout(maxDelayed,remaining)}}
if(isCalled&&timeoutId){timeoutId=clearTimeout(timeoutId)}
else if(!timeoutId&&wait!==maxWait){timeoutId=setTimeout(delayed,wait)}
if(leadingCall){isCalled=!0;result=func.apply(thisArg,args)}
if(isCalled&&!timeoutId&&!maxTimeoutId){args=thisArg=null}
return result}}
function defer(func){if(!isFunction(func)){throw new TypeError}
var args=slice(arguments,1);return setTimeout(function(){func.apply(undefined,args)},1)}
function delay(func,wait){if(!isFunction(func)){throw new TypeError}
var args=slice(arguments,2);return setTimeout(function(){func.apply(undefined,args)},wait)}
function memoize(func,resolver){if(!isFunction(func)){throw new TypeError}
var memoized=function(){var cache=memoized.cache,key=resolver?resolver.apply(this,arguments):keyPrefix+arguments[0];return hasOwnProperty.call(cache,key)?cache[key]:(cache[key]=func.apply(this,arguments))}
memoized.cache={};memoized.reset=function(){var cache=memoized.cache,key=resolver?resolver.apply(this,arguments):keyPrefix+arguments[0];if(hasOwnProperty.call(cache,key)){delete cache[key]}}
return memoized}
function once(func){var ran,result;if(!isFunction(func)){throw new TypeError}
return function(){if(ran){return result}
ran=!0;result=func.apply(this,arguments);func=null;return result}}
function partial(func){return createWrapper(func,16,slice(arguments,1))}
function partialRight(func){return createWrapper(func,32,null,slice(arguments,1))}
function throttle(func,wait,options){var leading=!0,trailing=!0;if(!isFunction(func)){throw new TypeError}
if(options===!1){leading=!1}else if(isObject(options)){leading='leading' in options?options.leading:leading;trailing='trailing' in options?options.trailing:trailing}
debounceOptions.leading=leading;debounceOptions.maxWait=wait;debounceOptions.trailing=trailing;return debounce(func,wait,debounceOptions)}
function wrap(value,wrapper){return createWrapper(wrapper,16,[value])}
function constant(value){return function(){return value}}
function createCallback(func,thisArg,argCount){var type=typeof func;if(func==null||type=='function'){return baseCreateCallback(func,thisArg,argCount)}
if(type!='object'){return property(func)}
var props=keys(func),key=props[0],a=func[key];if(props.length==1&&a===a&&!isObject(a)){return function(object){var b=object[key];return a===b&&(a!==0||(1/a==1/b))}}
return function(object){var length=props.length,result=!1;while(length--){if(!(result=baseIsEqual(object[props[length]],func[props[length]],null,!0))){break}}
return result}}
function escape(string){return string==null?'':String(string).replace(reUnescapedHtml,escapeHtmlChar)}
function identity(value){return value}
function mixin(object,source,options){var chain=!0,methodNames=source&&functions(source);if(!source||(!options&&!methodNames.length)){if(options==null){options=source}
ctor=lodashWrapper;source=object;object=lodash;methodNames=functions(source)}
if(options===!1){chain=!1}else if(isObject(options)&&'chain' in options){chain=options.chain}
var ctor=object,isFunc=isFunction(ctor);forEach(methodNames,function(methodName){var func=object[methodName]=source[methodName];if(isFunc){ctor.prototype[methodName]=function(){var chainAll=this.__chain__,value=this.__wrapped__,args=[value];push.apply(args,arguments);var result=func.apply(object,args);if(chain||chainAll){if(value===result&&isObject(result)){return this}
result=new ctor(result);result.__chain__=chainAll}
return result}}})}
function noConflict(){context._=oldDash;return this}
function noop(){}
var now=isNative(now=Date.now)&&now||function(){return new Date().getTime()};var parseInt=nativeParseInt(whitespace+'08')==8?nativeParseInt:function(value,radix){return nativeParseInt(isString(value)?value.replace(reLeadingSpacesAndZeros,''):value,radix||0)};function property(key){return function(object){return object[key]}}
function random(min,max,floating){var noMin=min==null,noMax=max==null;if(floating==null){if(typeof min=='boolean'&&noMax){floating=min;min=1}
else if(!noMax&&typeof max=='boolean'){floating=max;noMax=!0}}
if(noMin&&noMax){max=1}
min=+min||0;if(noMax){max=min;min=0}else{max=+max||0}
if(floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+(rand*(max-min+parseFloat('1e-'+((rand+'').length-1)))),max)}
return baseRandom(min,max)}
function result(object,key){if(object){var value=object[key];return isFunction(value)?object[key]():value}}
function template(text,data,options){var settings=lodash.templateSettings;text=String(text||'');options=defaults({},options,settings);var imports=defaults({},options.imports,settings.imports),importsKeys=keys(imports),importsValues=values(imports);var isEvaluating,index=0,interpolate=options.interpolate||reNoMatch,source="__p += '";var reDelimiters=RegExp((options.escape||reNoMatch).source+'|'+interpolate.source+'|'+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+'|'+(options.evaluate||reNoMatch).source+'|$','g');text.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){interpolateValue||(interpolateValue=esTemplateValue);source+=text.slice(index,offset).replace(reUnescapedString,escapeStringChar);if(escapeValue){source+="' +\n__e("+escapeValue+") +\n'"}
if(evaluateValue){isEvaluating=!0;source+="';\n"+evaluateValue+";\n__p += '"}
if(interpolateValue){source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"}
index=offset+match.length;return match});source+="';\n";var variable=options.variable,hasVariable=variable;if(!hasVariable){variable='obj';source='with ('+variable+') {\n'+source+'\n}\n'}
source=(isEvaluating?source.replace(reEmptyStringLeading,''):source).replace(reEmptyStringMiddle,'$1').replace(reEmptyStringTrailing,'$1;');source='function('+variable+') {\n'+(hasVariable?'':variable+' || ('+variable+' = {});\n')+"var __t, __p = '', __e = _.escape"+(isEvaluating?', __j = Array.prototype.join;\n'+"function print() { __p += __j.call(arguments, '') }\n":';\n')+source+'return __p\n}';var sourceURL='\n/*\n//# sourceURL='+(options.sourceURL||'/lodash/template/source['+(templateCounter++)+']')+'\n*/';try{var result=Function(importsKeys,'return '+source+sourceURL).apply(undefined,importsValues)}catch(e){e.source=source;throw e}
if(data){return result(data)}
result.source=source;return result}
function times(n,callback,thisArg){n=(n=+n)>-1?n:0;var index=-1,result=Array(n);callback=baseCreateCallback(callback,thisArg,1);while(++index<n){result[index]=callback(index)}
return result}
function unescape(string){return string==null?'':String(string).replace(reEscapedHtml,unescapeHtmlChar)}
function uniqueId(prefix){var id=++idCounter;return String(prefix==null?'':prefix)+id}
function chain(value){value=new lodashWrapper(value);value.__chain__=!0;return value}
function tap(value,interceptor){interceptor(value);return value}
function wrapperChain(){this.__chain__=!0;return this}
function wrapperToString(){return String(this.__wrapped__)}
function wrapperValueOf(){return this.__wrapped__}
lodash.after=after;lodash.assign=assign;lodash.at=at;lodash.bind=bind;lodash.bindAll=bindAll;lodash.bindKey=bindKey;lodash.chain=chain;lodash.compact=compact;lodash.compose=compose;lodash.constant=constant;lodash.countBy=countBy;lodash.create=create;lodash.createCallback=createCallback;lodash.curry=curry;lodash.debounce=debounce;lodash.defaults=defaults;lodash.defer=defer;lodash.delay=delay;lodash.difference=difference;lodash.filter=filter;lodash.flatten=flatten;lodash.forEach=forEach;lodash.forEachRight=forEachRight;lodash.forIn=forIn;lodash.forInRight=forInRight;lodash.forOwn=forOwn;lodash.forOwnRight=forOwnRight;lodash.functions=functions;lodash.groupBy=groupBy;lodash.indexBy=indexBy;lodash.initial=initial;lodash.intersection=intersection;lodash.invert=invert;lodash.invoke=invoke;lodash.keys=keys;lodash.map=map;lodash.mapValues=mapValues;lodash.max=max;lodash.memoize=memoize;lodash.merge=merge;lodash.min=min;lodash.omit=omit;lodash.once=once;lodash.pairs=pairs;lodash.partial=partial;lodash.partialRight=partialRight;lodash.pick=pick;lodash.pluck=pluck;lodash.property=property;lodash.pull=pull;lodash.range=range;lodash.reject=reject;lodash.remove=remove;lodash.rest=rest;lodash.shuffle=shuffle;lodash.sortBy=sortBy;lodash.tap=tap;lodash.throttle=throttle;lodash.times=times;lodash.toArray=toArray;lodash.transform=transform;lodash.union=union;lodash.uniq=uniq;lodash.values=values;lodash.where=where;lodash.without=without;lodash.wrap=wrap;lodash.xor=xor;lodash.zip=zip;lodash.zipObject=zipObject;lodash.collect=map;lodash.drop=rest;lodash.each=forEach;lodash.eachRight=forEachRight;lodash.extend=assign;lodash.methods=functions;lodash.object=zipObject;lodash.select=filter;lodash.tail=rest;lodash.unique=uniq;lodash.unzip=zip;mixin(lodash);lodash.clone=clone;lodash.cloneDeep=cloneDeep;lodash.contains=contains;lodash.escape=escape;lodash.every=every;lodash.find=find;lodash.findIndex=findIndex;lodash.findKey=findKey;lodash.findLast=findLast;lodash.findLastIndex=findLastIndex;lodash.findLastKey=findLastKey;lodash.has=has;lodash.identity=identity;lodash.indexOf=indexOf;lodash.isArguments=isArguments;lodash.isArray=isArray;lodash.isBoolean=isBoolean;lodash.isDate=isDate;lodash.isElement=isElement;lodash.isEmpty=isEmpty;lodash.isEqual=isEqual;lodash.isFinite=isFinite;lodash.isFunction=isFunction;lodash.isNaN=isNaN;lodash.isNull=isNull;lodash.isNumber=isNumber;lodash.isObject=isObject;lodash.isPlainObject=isPlainObject;lodash.isRegExp=isRegExp;lodash.isString=isString;lodash.isUndefined=isUndefined;lodash.lastIndexOf=lastIndexOf;lodash.mixin=mixin;lodash.noConflict=noConflict;lodash.noop=noop;lodash.now=now;lodash.parseInt=parseInt;lodash.random=random;lodash.reduce=reduce;lodash.reduceRight=reduceRight;lodash.result=result;lodash.runInContext=runInContext;lodash.size=size;lodash.some=some;lodash.sortedIndex=sortedIndex;lodash.template=template;lodash.unescape=unescape;lodash.uniqueId=uniqueId;lodash.all=every;lodash.any=some;lodash.detect=find;lodash.findWhere=find;lodash.foldl=reduce;lodash.foldr=reduceRight;lodash.include=contains;lodash.inject=reduce;mixin(function(){var source={}
forOwn(lodash,function(func,methodName){if(!lodash.prototype[methodName]){source[methodName]=func}});return source}(),!1);lodash.first=first;lodash.last=last;lodash.sample=sample;lodash.take=first;lodash.head=first;forOwn(lodash,function(func,methodName){var callbackable=methodName!=='sample';if(!lodash.prototype[methodName]){lodash.prototype[methodName]=function(n,guard){var chainAll=this.__chain__,result=func(this.__wrapped__,n,guard);return!chainAll&&(n==null||(guard&&!(callbackable&&typeof n=='function')))?result:new lodashWrapper(result,chainAll)}}});lodash.VERSION='2.4.1';lodash.prototype.chain=wrapperChain;lodash.prototype.toString=wrapperToString;lodash.prototype.value=wrapperValueOf;lodash.prototype.valueOf=wrapperValueOf;forEach(['join','pop','shift'],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){var chainAll=this.__chain__,result=func.apply(this.__wrapped__,arguments);return chainAll?new lodashWrapper(result,chainAll):result}});forEach(['push','reverse','sort','unshift'],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){func.apply(this.__wrapped__,arguments);return this}});forEach(['concat','slice','splice'],function(methodName){var func=arrayRef[methodName];lodash.prototype[methodName]=function(){return new lodashWrapper(func.apply(this.__wrapped__,arguments),this.__chain__)}});return lodash}
var _=$._=runInContext();$.each(_,function(prop,func){if(!Object.hasOwnProperty.call(_,prop)||/VERSION/.test(name))return;if(!$[prop])$[prop]=func})});FD40.plugin("bootstrap3",function($){var jQuery=$;if(window["Foundry/Bootstrap"]){throw new Error("An instance of Bootstrap has been initialized before this.")}else{window["Foundry/Bootstrap"]={version:"3.0.3",foundry:jQuery}}+function($){"use strict";function transitionEnd(){var el=document.createElement('bootstrap')
var transEndEventNames={'WebkitTransition':'webkitTransitionEnd','MozTransition':'transitionend','OTransition':'oTransitionEnd otransitionend','transition':'transitionend'}
for(var name in transEndEventNames){if(el.style[name]!==undefined){return{end:transEndEventNames[name]}}}}
$.fn.emulateTransitionEnd=function(duration){var called=!1,$el=this
$(this).one($.support.transition.end,function(){called=!0})
var callback=function(){if(!called)$($el).trigger($.support.transition.end)}
setTimeout(callback,duration)
return this}
$(function(){$.support.transition=transitionEnd()})}(jQuery);+function($){"use strict";var dismiss='[data-bs-dismiss="alert"]'
var Alert=function(el){$(el).on('click',dismiss,this.close)}
Alert.prototype.close=function(e){var $this=$(this)
var selector=$this.attr('data-target')
if(!selector){selector=$this.attr('href')
selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,'')}
var $parent=$(selector)
if(e)e.preventDefault()
if(!$parent.length){$parent=$this.hasClass('alert')?$this:$this.parent()}
$parent.trigger(e=$.Event('close.bs.alert'))
if(e.isDefaultPrevented())return
$parent.removeClass('in')
function removeElement(){$parent.trigger('closed.bs.alert').remove()}
$.support.transition&&$parent.hasClass('fade')?$parent.one($.support.transition.end,removeElement).emulateTransitionEnd(150):removeElement()}
var old=$.fn.alert
$.fn.alert=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.alert')
if(!data)$this.data('bs.alert',(data=new Alert(this)))
if(typeof option=='string')data[option].call($this)})}
$.fn.alert.Constructor=Alert
$.fn.alert.noConflict=function(){$.fn.alert=old
return this}
$(document).on('click.bs.alert.data-api',dismiss,Alert.prototype.close)}(jQuery);+function($){"use strict";var Button=function(element,options){this.$element=$(element)
this.options=$.extend({},Button.DEFAULTS,options)}
Button.DEFAULTS={loadingText:'loading...'}
Button.prototype.setState=function(state){var d='disabled'
var $el=this.$element
var val=$el.is('input')?'val':'html'
var data=$el.data()
state=state+'Text'
if(!data.resetText)$el.data('resetText',$el[val]())
$el[val](data[state]||this.options[state])
setTimeout(function(){state=='loadingText'?$el.addClass(d).attr(d,d):$el.removeClass(d).removeAttr(d)},0)}
Button.prototype.toggle=function(){var $parent=this.$element.closest('[data-bs-toggle="buttons"]')
var changed=!0
if($parent.length){var $input=this.$element.find('input')
if($input.prop('type')==='radio'){if($input.prop('checked')&&this.$element.hasClass('active'))
changed=!1
else $parent.find('.active').removeClass('active')}
if(changed)$input.prop('checked',!this.$element.hasClass('active')).trigger('change')}
if(changed)this.$element.toggleClass('active')}
var old=$.fn.button
$.fn.button=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.button')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.button',(data=new Button(this,options)))
if(option=='toggle')data.toggle()
else if(option)data.setState(option)})}
$.fn.button.Constructor=Button
$.fn.button.noConflict=function(){$.fn.button=old
return this}
$(document).on('click.bs.button.data-api','[data-bs-toggle^=button]',function(e){var $btn=$(e.target)
if(!$btn.hasClass('btn'))$btn=$btn.closest('.btn')
$btn.button('toggle')
e.preventDefault()})}(jQuery);+function($){"use strict";var Carousel=function(element,options){this.$element=$(element)
this.$indicators=this.$element.find('.carousel-indicators')
this.options=options
this.paused=this.sliding=this.interval=this.$active=this.$items=null
this.options.pause=='hover'&&this.$element.on('mouseenter',$.proxy(this.pause,this)).on('mouseleave',$.proxy(this.cycle,this))}
Carousel.DEFAULTS={interval:5000,pause:'hover',wrap:!0}
Carousel.prototype.cycle=function(e){e||(this.paused=!1)
this.interval&&clearInterval(this.interval)
this.options.interval&&!this.paused&&(this.interval=setInterval($.proxy(this.next,this),this.options.interval))
return this}
Carousel.prototype.getActiveIndex=function(){this.$active=this.$element.find('.item.active')
this.$items=this.$active.parent().children()
return this.$items.index(this.$active)}
Carousel.prototype.to=function(pos){var that=this
var activeIndex=this.getActiveIndex()
if(pos>(this.$items.length-1)||pos<0)return
if(this.sliding)return this.$element.one('slid.bs.carousel',function(){that.to(pos)})
if(activeIndex==pos)return this.pause().cycle()
return this.slide(pos>activeIndex?'next':'prev',$(this.$items[pos]))}
Carousel.prototype.pause=function(e){e||(this.paused=!0)
if(this.$element.find('.next, .prev').length&&$.support.transition.end){this.$element.trigger($.support.transition.end)
this.cycle(!0)}
this.interval=clearInterval(this.interval)
return this}
Carousel.prototype.next=function(){if(this.sliding)return
return this.slide('next')}
Carousel.prototype.prev=function(){if(this.sliding)return
return this.slide('prev')}
Carousel.prototype.slide=function(type,next){var $active=this.$element.find('.item.active')
var $next=next||$active[type]()
var isCycling=this.interval
var direction=type=='next'?'left':'right'
var fallback=type=='next'?'first':'last'
var that=this
if(!$next.length){if(!this.options.wrap)return
$next=this.$element.find('.item')[fallback]()}
this.sliding=!0
isCycling&&this.pause()
var e=$.Event('slide.bs.carousel',{relatedTarget:$next[0],direction:direction})
if($next.hasClass('active'))return
if(this.$indicators.length){this.$indicators.find('.active').removeClass('active')
this.$element.one('slid.bs.carousel',function(){var $nextIndicator=$(that.$indicators.children()[that.getActiveIndex()])
$nextIndicator&&$nextIndicator.addClass('active')})}
if($.support.transition&&this.$element.hasClass('slide')){this.$element.trigger(e)
if(e.isDefaultPrevented())return
$next.addClass(type)
$next[0].offsetWidth
$active.addClass(direction)
$next.addClass(direction)
$active.one($.support.transition.end,function(){$next.removeClass([type,direction].join(' ')).addClass('active')
$active.removeClass(['active',direction].join(' '))
that.sliding=!1
setTimeout(function(){that.$element.trigger('slid.bs.carousel')},0)}).emulateTransitionEnd(600)}else{this.$element.trigger(e)
if(e.isDefaultPrevented())return
$active.removeClass('active')
$next.addClass('active')
this.sliding=!1
this.$element.trigger('slid.bs.carousel')}
isCycling&&this.cycle()
return this}
var old=$.fn.carousel
$.fn.carousel=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.carousel')
var options=$.extend({},Carousel.DEFAULTS,$this.data(),typeof option=='object'&&option)
var action=typeof option=='string'?option:options.slide
if(!data)$this.data('bs.carousel',(data=new Carousel(this,options)))
if(typeof option=='number')data.to(option)
else if(action)data[action]()
else if(options.interval)data.pause().cycle()})}
$.fn.carousel.Constructor=Carousel
$.fn.carousel.noConflict=function(){$.fn.carousel=old
return this}
$(document).on('click.bs.carousel.data-api','[data-bs-slide], [data-bs-slide-to]',function(e){var $this=$(this),href
var $target=$($this.attr('data-target')||(href=$this.attr('href'))&&href.replace(/.*(?=#[^\s]+$)/,''))
var options=$.extend({},$target.data(),$this.data())
var slideIndex=$this.attr('data-bs-slide-to')
if(slideIndex)options.interval=!1
$target.carousel(options)
if(slideIndex=$this.attr('data-bs-slide-to')){$target.data('bs.carousel').to(slideIndex)}
e.preventDefault()})
$(window).on('load',function(){$('[data-bs-ride="carousel"]').each(function(){var $carousel=$(this)
$carousel.carousel($carousel.data())})})}(jQuery);+function($){"use strict";var Collapse=function(element,options){this.$element=$(element)
this.options=$.extend({},Collapse.DEFAULTS,options)
this.transitioning=null
if(this.options.parent)this.$parent=$(this.options.parent)
if(this.options.toggle)this.toggle()}
Collapse.DEFAULTS={toggle:!0}
Collapse.prototype.dimension=function(){var hasWidth=this.$element.hasClass('width')
return hasWidth?'width':'height'}
Collapse.prototype.show=function(){if(this.transitioning||this.$element.hasClass('in'))return
var startEvent=$.Event('show.bs.collapse')
this.$element.triggerHandler(startEvent)
if(startEvent.isDefaultPrevented())return
var actives=this.$parent&&this.$parent.find('> .panel > .in')
if(actives&&actives.length){var hasData=actives.data('bs.collapse')
if(hasData&&hasData.transitioning)return
actives.collapse('hide')
hasData||actives.data('bs.collapse',null)}
var dimension=this.dimension()
this.$element.removeClass('collapse').addClass('collapsing')[dimension](0)
this.transitioning=1
var complete=function(){this.$element.removeClass('collapsing').addClass('in')[dimension]('auto')
this.transitioning=0
this.$element.trigger('shown.bs.collapse')}
if(!$.support.transition)return complete.call(this)
var scrollSize=$.camelCase(['scroll',dimension].join('-'))
this.$element.one($.support.transition.end,$.proxy(complete,this)).emulateTransitionEnd(350)[dimension](this.$element[0][scrollSize])}
Collapse.prototype.hide=function(){if(this.transitioning||!this.$element.hasClass('in'))return
var startEvent=$.Event('hide.bs.collapse')
this.$element.triggerHandler(startEvent)
if(startEvent.isDefaultPrevented())return
var dimension=this.dimension()
this.$element[dimension](this.$element[dimension]())[0].offsetHeight
this.$element.addClass('collapsing').removeClass('collapse').removeClass('in')
this.transitioning=1
var complete=function(){this.transitioning=0
this.$element.trigger('hidden.bs.collapse').removeClass('collapsing').addClass('collapse')}
if(!$.support.transition)return complete.call(this)
this.$element[dimension](0).one($.support.transition.end,$.proxy(complete,this)).emulateTransitionEnd(350)}
Collapse.prototype.toggle=function(){this[this.$element.hasClass('in')?'hide':'show']()}
var old=$.fn.collapse
$.fn.collapse=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.collapse')
var options=$.extend({},Collapse.DEFAULTS,$this.data(),typeof option=='object'&&option)
if(!data)$this.data('bs.collapse',(data=new Collapse(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.collapse.Constructor=Collapse
$.fn.collapse.noConflict=function(){$.fn.collapse=old
return this}
$(document).on('click.bs.collapse.data-api','[data-bs-toggle=collapse]',function(e){var $this=$(this),href
var target=$this.attr('data-target')||e.preventDefault()||(href=$this.attr('href'))&&href.replace(/.*(?=#[^\s]+$)/,'')
var $target=$(target)
var data=$target.data('bs.collapse')
var option=data?'toggle':$this.data()
var parent=$this.attr('data-parent')
var $parent=parent&&$(parent)
if(!data||!data.transitioning){if($parent)$parent.find('[data-bs-toggle=collapse][data-parent="'+parent+'"]').not($this).addClass('collapsed')
$this[$target.hasClass('in')?'addClass':'removeClass']('collapsed')}
$target.collapse(option)})}(jQuery);+function($){"use strict";var backdrop='.dropdown-backdrop'
var toggle='[data-bs-toggle=dropdown]'
var Dropdown=function(element){$(element).on('click.bs.dropdown',this.toggle)}
Dropdown.prototype.toggle=function(e){var $this=$(this)
if($this.is('.disabled, :disabled'))return
var $parent=getParent($this)
var isActive=$parent.hasClass('open')
clearMenus()
if(!isActive){if('ontouchstart' in document.documentElement&&!$parent.closest('.navbar-nav').length){$('<div class="dropdown-backdrop"/>').insertAfter($(this)).on('click',clearMenus)}
$parent.triggerHandler(e=$.Event('show.bs.dropdown'))
if(e.isDefaultPrevented())return
$parent.toggleClass('open').trigger('shown.bs.dropdown')
$this.focus()}
return!1}
Dropdown.prototype.keydown=function(e){if(!/(38|40|27)/.test(e.keyCode))return
var $this=$(this)
e.preventDefault()
e.stopPropagation()
if($this.is('.disabled, :disabled'))return
var $parent=getParent($this)
var isActive=$parent.hasClass('open')
if(!isActive||(isActive&&e.keyCode==27)){if(e.which==27)$parent.find(toggle).focus()
return $this.click()}
var $items=$('[role=menu] li:not(.divider):visible a',$parent)
if(!$items.length)return
var index=$items.index($items.filter(':focus'))
if(e.keyCode==38&&index>0)index--
if(e.keyCode==40&&index<$items.length-1)index++
if(!~index)index=0
$items.eq(index).focus()}
function clearMenus(){$(backdrop).remove()
$(toggle).each(function(e){var $parent=getParent($(this))
if(!$parent.hasClass('open'))return
$parent.triggerHandler(e=$.Event('hide.bs.dropdown'))
if(e.isDefaultPrevented())return
$parent.removeClass('open').trigger('hidden.bs.dropdown')})}
function getParent($this){var selector=$this.attr('data-target')
if(!selector){selector=$this.attr('href')
selector=selector&&/#/.test(selector)&&selector.replace(/.*(?=#[^\s]*$)/,'')}
var $parent=selector&&$(selector)
return $parent&&$parent.length?$parent:$this.parent()}
var old=$.fn.dropdown
$.fn.dropdown=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.dropdown')
if(!data)$this.data('bs.dropdown',(data=new Dropdown(this)))
if(typeof option=='string')data[option].call($this)})}
$.fn.dropdown.Constructor=Dropdown
$.fn.dropdown.noConflict=function(){$.fn.dropdown=old
return this}
$(document).on('click.bs.dropdown.data-api',clearMenus).on('click.bs.dropdown.data-api','.dropdown_ form, .dropdown-static',function(e){e.stopPropagation()}).on('click.bs.dropdown.data-api',toggle,Dropdown.prototype.toggle).on('keydown.bs.dropdown.data-api',toggle+', [role=menu]',Dropdown.prototype.keydown)}(jQuery);+function($){"use strict";var Modal=function(element,options){this.options=options
this.$element=$(element)
this.$backdrop=this.isShown=null
if(this.options.remote)this.$element.load(this.options.remote)}
Modal.DEFAULTS={backdrop:!0,keyboard:!0,show:!0}
Modal.prototype.toggle=function(_relatedTarget){return this[!this.isShown?'show':'hide'](_relatedTarget)}
Modal.prototype.show=function(_relatedTarget){var that=this
var e=$.Event('show.bs.modal',{relatedTarget:_relatedTarget})
this.$element.triggerHandler(e)
if(this.isShown||e.isDefaultPrevented())return
this.isShown=!0
this.escape()
this.$element.on('click.dismiss.modal','[data-bs-dismiss="modal"]',$.proxy(this.hide,this))
this.backdrop(function(){var transition=$.support.transition&&that.$element.hasClass('fade')
if(!that.$element.parent().length){that.$element.appendTo(document.body)}
that.$element.show()
if(transition){that.$element[0].offsetWidth}
that.$element.addClass('in').attr('aria-hidden',!1)
that.enforceFocus()
var e=$.Event('shown.bs.modal',{relatedTarget:_relatedTarget})
transition?that.$element.find('.modal-dialog').one($.support.transition.end,function(){that.$element.focus().trigger(e)}).emulateTransitionEnd(300):that.$element.focus().trigger(e)})}
Modal.prototype.hide=function(e){if(e)e.preventDefault()
e=$.Event('hide.bs.modal')
this.$element.triggerHandler(e)
if(!this.isShown||e.isDefaultPrevented())return
this.isShown=!1
this.escape()
$(document).off('focusin.bs.modal')
this.$element.removeClass('in').attr('aria-hidden',!0).off('click.dismiss.modal')
$.support.transition&&this.$element.hasClass('fade')?this.$element.one($.support.transition.end,$.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal()}
Modal.prototype.enforceFocus=function(){$(document).off('focusin.bs.modal').on('focusin.bs.modal',$.proxy(function(e){if(this.$element[0]!==e.target&&!this.$element.has(e.target).length){this.$element.focus()}},this))}
Modal.prototype.escape=function(){if(this.isShown&&this.options.keyboard){this.$element.on('keyup.dismiss.bs.modal',$.proxy(function(e){e.which==27&&this.hide()},this))}else if(!this.isShown){this.$element.off('keyup.dismiss.bs.modal')}}
Modal.prototype.hideModal=function(){var that=this
this.$element.hide()
this.backdrop(function(){that.removeBackdrop()
that.$element.trigger('hidden.bs.modal')})}
Modal.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove()
this.$backdrop=null}
Modal.prototype.backdrop=function(callback){var that=this
var animate=this.$element.hasClass('fade')?'fade':''
if(this.isShown&&this.options.backdrop){var doAnimate=$.support.transition&&animate
this.$backdrop=$('<div class="modal-backdrop '+animate+'" />').appendTo(document.body)
this.$element.on('click.dismiss.modal',$.proxy(function(e){if(e.target!==e.currentTarget)return
this.options.backdrop=='static'?this.$element[0].focus.call(this.$element[0]):this.hide.call(this)},this))
if(doAnimate)this.$backdrop[0].offsetWidth
this.$backdrop.addClass('in')
if(!callback)return
doAnimate?this.$backdrop.one($.support.transition.end,callback).emulateTransitionEnd(150):callback()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass('in')
$.support.transition&&this.$element.hasClass('fade')?this.$backdrop.one($.support.transition.end,callback).emulateTransitionEnd(150):callback()}else if(callback){callback()}}
var old=$.fn.modal
$.fn.modal=function(option,_relatedTarget){return this.each(function(){var $this=$(this)
var data=$this.data('bs.modal')
var options=$.extend({},Modal.DEFAULTS,$this.data(),typeof option=='object'&&option)
if(!data)$this.data('bs.modal',(data=new Modal(this,options)))
if(typeof option=='string')data[option](_relatedTarget)
else if(options.show)data.show(_relatedTarget)})}
$.fn.modal.Constructor=Modal
$.fn.modal.noConflict=function(){$.fn.modal=old
return this}
$(document).on('click.bs.modal.data-api','[data-bs-toggle="modal"]',function(e){var $this=$(this)
var href=$this.attr('href')
var $target=$($this.attr('data-target')||(href&&href.replace(/.*(?=#[^\s]+$)/,'')))
var option=$target.data('modal')?'toggle':$.extend({remote:!/#/.test(href)&&href},$target.data(),$this.data())
e.preventDefault()
$target.modal(option,this).one('hide',function(){$this.is(':visible')&&$this.focus()})})
$(document).on('show.bs.modal','.modal.bs',function(){$(document.body).addClass('modal-open')}).on('hidden.bs.modal','.modal.bs',function(){$(document.body).removeClass('modal-open')})}(jQuery);+function($){"use strict";var Tooltip=function(element,options){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null
this.init('tooltip',element,options)}
Tooltip.DEFAULTS={animation:!0,placement:'top',selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:'hover focus',title:'',delay:0,html:!1,container:!1}
Tooltip.prototype.init=function(type,element,options){this.enabled=!0
this.type=type
this.$element=$(element)
this.options=this.getOptions(options)
var triggers=this.options.trigger.split(' ')
for(var i=triggers.length;i--;){var trigger=triggers[i]
if(trigger=='click'){this.$element.on('click.'+this.type,this.options.selector,$.proxy(this.toggle,this))}else if(trigger!='manual'){var eventIn=trigger=='hover'?'mouseenter':'focus'
var eventOut=trigger=='hover'?'mouseleave':'blur'
this.$element.on(eventIn+'.'+this.type,this.options.selector,$.proxy(this.enter,this))
this.$element.on(eventOut+'.'+this.type,this.options.selector,$.proxy(this.leave,this))}}
this.options.selector?(this._options=$.extend({},this.options,{trigger:'manual',selector:''})):this.fixTitle()}
Tooltip.prototype.getDefaults=function(){return Tooltip.DEFAULTS}
Tooltip.prototype.getOptions=function(options){options=$.extend({},this.getDefaults(),this.$element.data(),options)
if(options.delay&&typeof options.delay=='number'){options.delay={show:options.delay,hide:options.delay}}
return options}
Tooltip.prototype.getDelegateOptions=function(){var options={}
var defaults=this.getDefaults()
this._options&&$.each(this._options,function(key,value){if(defaults[key]!=value)options[key]=value})
return options}
Tooltip.prototype.enter=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data('bs.'+this.type)
clearTimeout(self.timeout)
self.hoverState='in'
if(!self.options.delay||!self.options.delay.show)return self.show()
self.timeout=setTimeout(function(){if(self.hoverState=='in')self.show()},self.options.delay.show)}
Tooltip.prototype.leave=function(obj){var self=obj instanceof this.constructor?obj:$(obj.currentTarget)[this.type](this.getDelegateOptions()).data('bs.'+this.type)
clearTimeout(self.timeout)
self.hoverState='out'
if(!self.options.delay||!self.options.delay.hide)return self.hide()
self.timeout=setTimeout(function(){if(self.hoverState=='out')self.hide()},self.options.delay.hide)}
Tooltip.prototype.show=function(){var e=$.Event('show.bs.'+this.type)
if(this.hasContent()&&this.enabled){this.$element.triggerHandler(e)
if(e.isDefaultPrevented())return
var $tip=this.tip()
this.setContent()
if(this.options.animation)$tip.addClass('fade')
var placement=typeof this.options.placement=='function'?this.options.placement.call(this,$tip[0],this.$element[0]):this.options.placement
var autoToken=/\s?auto?\s?/i
var autoPlace=autoToken.test(placement)
if(autoPlace)placement=placement.replace(autoToken,'')||'top'
$tip.detach().css({top:0,left:0,display:'block'}).addClass(placement.split('-')[0]);this.options.container?$tip.appendTo(this.options.container):$tip.insertAfter(this.$element)
var pos=this.getPosition()
var actualWidth=$tip[0].offsetWidth
var actualHeight=$tip[0].offsetHeight
if(autoPlace){var $parent=this.$element.parent()
var orgPlacement=placement
var docScroll=document.documentElement.scrollTop||document.body.scrollTop
var parentWidth=this.options.container=='body'?window.innerWidth:$parent.outerWidth()
var parentHeight=this.options.container=='body'?window.innerHeight:$parent.outerHeight()
var parentLeft=this.options.container=='body'?0:$parent.offset().left
placement=placement=='bottom'&&pos.top+pos.height+actualHeight-docScroll>parentHeight?'top':placement=='top'&&pos.top-docScroll-actualHeight<0?'bottom':placement=='right'&&pos.right+actualWidth>parentWidth?'left':placement=='left'&&pos.left-actualWidth<parentLeft?'right':placement
$tip.removeClass(orgPlacement).addClass(placement)}
var calculatedOffset=this.getCalculatedOffset(placement,pos,actualWidth,actualHeight)
this.applyPlacement(calculatedOffset,placement)
this.$element.trigger('shown.bs.'+this.type)}}
Tooltip.prototype.applyPlacement=function(offset,placement){var replace
var $tip=this.tip()
var width=$tip[0].offsetWidth
var height=$tip[0].offsetHeight
var marginTop=parseInt($tip.css('margin-top'),10)
var marginLeft=parseInt($tip.css('margin-left'),10)
if(isNaN(marginTop))marginTop=0
if(isNaN(marginLeft))marginLeft=0
offset.top=offset.top+marginTop
offset.left=offset.left+marginLeft
$tip.offset(offset).addClass('in')
var actualWidth=$tip[0].offsetWidth
var actualHeight=$tip[0].offsetHeight
if(placement=='top'&&actualHeight!=height){replace=!0
offset.top=offset.top+height-actualHeight}
if(['top','bottom'].indexOf(placement.split('-')[0])===0){var delta=0
if(offset.left<0){delta=offset.left*-2
offset.left=0
$tip.offset(offset)
actualWidth=$tip[0].offsetWidth
actualHeight=$tip[0].offsetHeight}
this.replaceArrow(delta-width+actualWidth,actualWidth,'left')}
if(['left','right'].indexOf(placement.split('-')[0])===0){this.replaceArrow(actualHeight-height,actualHeight,'top')}
if(replace)$tip.offset(offset)}
Tooltip.prototype.replaceArrow=function(delta,dimension,position){this.arrow().css(position,delta?(50*(1-delta/dimension)+"%"):'')}
Tooltip.prototype.setContent=function(){var $tip=this.tip()
var title=this.getTitle()
$tip.find('.tooltip-inner')[this.options.html?'html':'text'](title)
$tip.removeClass('fade in top bottom left right')}
Tooltip.prototype.hide=function(){var that=this
var $tip=this.tip()
var e=$.Event('hide.bs.'+this.type)
function complete(){if(that.hoverState!='in')$tip.detach()}
this.$element.triggerHandler(e)
if(e.isDefaultPrevented())return
$tip.removeClass('in')
$.support.transition&&this.$tip.hasClass('fade')?$tip.one($.support.transition.end,complete).emulateTransitionEnd(150):complete()
this.$element.trigger('hidden.bs.'+this.type)
return this}
Tooltip.prototype.fixTitle=function(){var $e=this.$element
if($e.attr('title')||typeof($e.attr('data-original-title'))!='string'){$e.attr('data-original-title',$e.attr('title')||'').attr('title','')}}
Tooltip.prototype.hasContent=function(){return this.getTitle()}
Tooltip.prototype.getPosition=function(){var el=this.$element[0]
return $.extend({},(typeof el.getBoundingClientRect=='function')?el.getBoundingClientRect():{width:el.offsetWidth,height:el.offsetHeight},this.$element.offset())}
Tooltip.prototype.getCalculatedOffset=function(placement,pos,actualWidth,actualHeight){return placement=='left-top'?{top:pos.top,left:pos.left-actualWidth}:placement=='left-bottom'?{top:pos.top+pos.height-actualHeight,left:pos.left-actualWidth}:placement=='right-top'?{top:pos.top,left:pos.left+pos.width}:placement=='right-bottom'?{top:pos.top+pos.height-actualHeight,left:pos.left+pos.width}:placement=='top-left'?{top:pos.top-actualHeight,left:pos.left}:placement=='top-right'?{top:pos.top-actualHeight,left:pos.left+pos.width-actualWidth}:placement=='bottom-left'?{top:pos.top+pos.height,left:pos.left}:placement=='bottom-right'?{top:pos.top+pos.height,left:pos.left+pos.width-actualWidth}:placement=='bottom'?{top:pos.top+pos.height,left:pos.left+pos.width/2-actualWidth/2}:placement=='top'?{top:pos.top-actualHeight,left:pos.left+pos.width/2-actualWidth/2}:placement=='left'?{top:pos.top+pos.height/2-actualHeight/2,left:pos.left-actualWidth}:{top:pos.top+pos.height/2-actualHeight/2,left:pos.left+pos.width}}
Tooltip.prototype.getTitle=function(){var title
var $e=this.$element
var o=this.options
title=$e.attr('data-original-title')||(typeof o.title=='function'?o.title.call($e[0]):o.title)
return title}
Tooltip.prototype.tip=function(){return this.$tip=this.$tip||$(this.options.template)}
Tooltip.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find('.tooltip-arrow')}
Tooltip.prototype.validate=function(){if(!this.$element[0].parentNode){this.hide()
this.$element=null
this.options=null}}
Tooltip.prototype.enable=function(){this.enabled=!0}
Tooltip.prototype.disable=function(){this.enabled=!1}
Tooltip.prototype.toggleEnabled=function(){this.enabled=!this.enabled}
Tooltip.prototype.toggle=function(e){var self=e?$(e.currentTarget)[this.type](this.getDelegateOptions()).data('bs.'+this.type):this
self.tip().hasClass('in')?self.leave(self):self.enter(self)}
Tooltip.prototype.destroy=function(){this.hide().$element.off('.'+this.type).removeData('bs.'+this.type)}
var old=$.fn.tooltip
$.fn.tooltip=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.tooltip')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.tooltip',(data=new Tooltip(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.tooltip.Constructor=Tooltip
$.fn.tooltip.noConflict=function(){$.fn.tooltip=old
return this}}(jQuery);+function($){"use strict";var Popover=function(element,options){this.init('popover',element,options)}
if(!$.fn.tooltip)throw new Error('Popover requires tooltip.js')
Popover.DEFAULTS=$.extend({},$.fn.tooltip.Constructor.DEFAULTS,{placement:'right',trigger:'click',content:'',template:'<div id="fd" class="fd-popover"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'})
Popover.prototype=$.extend({},$.fn.tooltip.Constructor.prototype)
Popover.prototype.constructor=Popover
Popover.prototype.getDefaults=function(){return Popover.DEFAULTS}
Popover.prototype.setContent=function(){var $tip=this.tip()
var title=this.getTitle()
var content=this.getContent()
$tip.find('.fd-popover-title')[this.options.html?'html':'text'](title)
$tip.find('.fd-popover-content')[this.options.html?'html':'text'](content)
$tip.removeClass('fade top bottom left right in')
if(!$tip.find('.fd-popover-title').html())$tip.find('.fd-popover-title').hide()}
Popover.prototype.hasContent=function(){return this.getTitle()||this.getContent()}
Popover.prototype.getContent=function(){var $e=this.$element
var o=this.options
return $e.attr('data-content')||(typeof o.content=='function'?o.content.call($e[0]):o.content)}
Popover.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find('.arrow')}
Popover.prototype.tip=function(){if(!this.$tip)this.$tip=$(this.options.template)
return this.$tip}
var old=$.fn.popover
$.fn.popover=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.popover')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.popover',(data=new Popover(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.popover.Constructor=Popover
$.fn.popover.noConflict=function(){$.fn.popover=old
return this}}(jQuery);+function($){"use strict";function ScrollSpy(element,options){var href
var process=$.proxy(this.process,this)
this.$element=$(element).is('body')?$(window):$(element)
this.$body=$('body')
this.$scrollElement=this.$element.on('scroll.bs.scroll-spy.data-api',process)
this.options=$.extend({},ScrollSpy.DEFAULTS,options)
this.selector=(this.options.target||((href=$(element).attr('href'))&&href.replace(/.*(?=#[^\s]+$)/,''))||'')+' .nav li > a'
this.offsets=$([])
this.targets=$([])
this.activeTarget=null
this.refresh()
this.process()}
ScrollSpy.DEFAULTS={offset:10}
ScrollSpy.prototype.refresh=function(){var offsetMethod=this.$element[0]==window?'offset':'position'
this.offsets=$([])
this.targets=$([])
var self=this
var $targets=this.$body.find(this.selector).map(function(){var $el=$(this)
var href=$el.data('target')||$el.attr('href')
var $href=/^#\w/.test(href)&&$(href)
return($href&&$href.length&&[[$href[offsetMethod]().top+(!$.isWindow(self.$scrollElement.get(0))&&self.$scrollElement.scrollTop()),href]])||null}).sort(function(a,b){return a[0]-b[0]}).each(function(){self.offsets.push(this[0])
self.targets.push(this[1])})}
ScrollSpy.prototype.process=function(){var scrollTop=this.$scrollElement.scrollTop()+this.options.offset
var scrollHeight=this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight
var maxScroll=scrollHeight-this.$scrollElement.height()
var offsets=this.offsets
var targets=this.targets
var activeTarget=this.activeTarget
var i
if(scrollTop>=maxScroll){return activeTarget!=(i=targets.last()[0])&&this.activate(i)}
for(i=offsets.length;i--;){activeTarget!=targets[i]&&scrollTop>=offsets[i]&&(!offsets[i+1]||scrollTop<=offsets[i+1])&&this.activate(targets[i])}}
ScrollSpy.prototype.activate=function(target){this.activeTarget=target
$(this.selector).parents('.active').removeClass('active')
var selector=this.selector+'[data-target="'+target+'"],'+this.selector+'[href="'+target+'"]'
var active=$(selector).parents('li').addClass('active')
if(active.parent('.dropdown-menu').length){active=active.closest('li.dropdown').addClass('active')}
active.trigger('activate.bs.scrollspy')}
var old=$.fn.scrollspy
$.fn.scrollspy=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.scrollspy')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.scrollspy',(data=new ScrollSpy(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.scrollspy.Constructor=ScrollSpy
$.fn.scrollspy.noConflict=function(){$.fn.scrollspy=old
return this}
$(window).on('load',function(){$('[data-bs-spy="scroll"]').each(function(){var $spy=$(this)
$spy.scrollspy($spy.data())})})}(jQuery);+function($){"use strict";var Tab=function(element){this.element=$(element)}
Tab.prototype.show=function(){var $this=this.element
var $ul=$this.closest('ul:not(.dropdown-menu)')
var selector=$this.data('target')
if(!selector){selector=$this.attr('href')
selector=selector&&selector.replace(/.*(?=#[^\s]*$)/,'')}
if($this.parent('li').hasClass('active'))return
var previous=$ul.find('.active:last a')[0]
var e=$.Event('show.bs.tab',{relatedTarget:previous})
$this.triggerHandler(e)
if(e.isDefaultPrevented())return
var $target=$(selector)
this.activate($this.parent('li'),$ul)
this.activate($target,$target.parent(),function(){$this.trigger({type:'shown.bs.tab',relatedTarget:previous})})}
Tab.prototype.activate=function(element,container,callback){var $active=container.find('> .active')
var transition=callback&&$.support.transition&&$active.hasClass('fade')
function next(){$active.removeClass('active').find('> .dropdown-menu > .active').removeClass('active')
element.addClass('active')
if(transition){element[0].offsetWidth
element.addClass('in')}else{element.removeClass('fade')}
if(element.parent('.dropdown-menu')){element.closest('li.dropdown').addClass('active')}
callback&&callback()}
transition?$active.one($.support.transition.end,next).emulateTransitionEnd(150):next()
$active.removeClass('in')}
var old=$.fn.tab
$.fn.tab=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.tab')
if(!data)$this.data('bs.tab',(data=new Tab(this)))
if(typeof option=='string')data[option]()})}
$.fn.tab.Constructor=Tab
$.fn.tab.noConflict=function(){$.fn.tab=old
return this}
$(document).on('click.bs.tab.data-api','[data-bs-toggle="tab"], [data-bs-toggle="pill"]',function(e){e.preventDefault()
$(this).tab('show')})}(jQuery);+function($){"use strict";var Affix=function(element,options){this.options=$.extend({},Affix.DEFAULTS,options)
this.$window=$(window).on('scroll.bs.affix.data-api',$.proxy(this.checkPosition,this)).on('click.bs.affix.data-api',$.proxy(this.checkPositionWithEventLoop,this))
this.$element=$(element)
this.affixed=this.unpin=null
this.checkPosition()}
Affix.RESET='affix affix-top affix-bottom'
Affix.DEFAULTS={offset:0}
Affix.prototype.checkPositionWithEventLoop=function(){setTimeout($.proxy(this.checkPosition,this),1)}
Affix.prototype.checkPosition=function(){if(!this.$element.is(':visible'))return
var scrollHeight=$(document).height()
var scrollTop=this.$window.scrollTop()
var position=this.$element.offset()
var offset=this.options.offset
var offsetTop=offset.top
var offsetBottom=offset.bottom
if(typeof offset!='object')offsetBottom=offsetTop=offset
if(typeof offsetTop=='function')offsetTop=offset.top()
if(typeof offsetBottom=='function')offsetBottom=offset.bottom()
var affix=this.unpin!=null&&(scrollTop+this.unpin<=position.top)?!1:offsetBottom!=null&&(position.top+this.$element.height()>=scrollHeight-offsetBottom)?'bottom':offsetTop!=null&&(scrollTop<=offsetTop)?'top':!1
if(this.affixed===affix)return
if(this.unpin)this.$element.css('top','')
this.affixed=affix
this.unpin=affix=='bottom'?position.top-scrollTop:null
this.$element.removeClass(Affix.RESET).addClass('affix'+(affix?'-'+affix:''))
if(affix=='bottom'){this.$element.offset({top:document.body.offsetHeight-offsetBottom-this.$element.height()})}}
var old=$.fn.affix
$.fn.affix=function(option){return this.each(function(){var $this=$(this)
var data=$this.data('bs.affix')
var options=typeof option=='object'&&option
if(!data)$this.data('bs.affix',(data=new Affix(this,options)))
if(typeof option=='string')data[option]()})}
$.fn.affix.Constructor=Affix
$.fn.affix.noConflict=function(){$.fn.affix=old
return this}
$(window).on('load',function(){$('[data-bs-spy="affix"]').each(function(){var $spy=$(this)
var data=$spy.data()
data.offset=data.offset||{}
if(data.offsetBottom)data.offset.bottom=data.offsetBottom
if(data.offsetTop)data.offset.top=data.offsetTop
$spy.affix(data)})})}(jQuery);!function($){var Notification=function(element,options){this.$element=$(element);this.$note=$('<div class="alert"></div>');this.options=$.extend(!0,$.fn.notify.defaults,options);if(this.options.transition)
if(this.options.transition=='fade')
this.$note.addClass('in').addClass(this.options.transition);else this.$note.addClass(this.options.transition);else this.$note.addClass('fade').addClass('in');if(this.options.type)
this.$note.addClass('alert-'+this.options.type);else this.$note.addClass('alert-success');if(!this.options.message&&this.$element.data("message")!=='')
this.$note.html(this.$element.data("message"));else if(typeof this.options.message==='object')
if(this.options.message.html)
this.$note.html(this.options.message.html);else if(this.options.message.text)
this.$note.text(this.options.message.text);else this.$note.html(this.options.message);if(this.options.closable)
var link=$('<a class="close pull-right" href="javascript: void(0);">&times;</a>');$(link).on('click',$.proxy(onClose,this));this.$note.prepend(link);return this};onClose=function(){this.options.onClose();$(this.$note).remove();this.options.onClosed()};Notification.prototype.show=function(){if(this.options.fadeOut.enabled)
this.$note.delay(this.options.fadeOut.delay||3000).fadeOut('slow',$.proxy(onClose,this));this.$element.append(this.$note);this.$note.alert()};Notification.prototype.hide=function(){if(this.options.fadeOut.enabled)
this.$note.delay(this.options.fadeOut.delay||3000).fadeOut('slow',$.proxy(onClose,this));else onClose.call(this)};$.fn.notify=function(options){return new Notification(this,options)};$.fn.notify.defaults={type:'success',closable:!0,transition:'fade',fadeOut:{enabled:!0,delay:3000},message:null,onClose:function(){},onClosed:function(){}}}($)});FD40.plugin("responsive",function($){var defaultOptions={elementWidth:function(elem){return elem.outerWidth(!0)}};$.responsive=function(elem,options){if($.isArray(options)){options={conditions:options}}
var options=$.extend({},defaultOptions,options);return new Responsive(elem,options)};$.fn.responsive=function(conditions){if(conditions){$.responsive($(this),conditions)}
return this};var $window=$(window),$isFunc=$.isFunction;var Responsive=function(elem,options){var self=this;$(elem).each(function(){var elem=$(this),instance=$(this).data("$responsive");if(instance instanceof Responsive){instance.destroy()}});$.extend(self,{elem:elem,options:options,conditions:$.sortBy($.makeArray(options.conditions),function(condition){return condition.at}),event:"resize.responsive."+$.uid(),handler:$.debounce(function(){self.set()},250)});delete options.conditions;$(function(){$window.on(self.event,self.handler);self.set()});$(window).load(function(){self.set()})}
$.extend(Responsive.prototype,{set:function(){var self=this,elementWidth=self.options.elementWidth;$(self.elem).each(function(){var elem=$(this),currentWidth=($isFunc(elementWidth))?elementWidth(elem):elementWidth;$(elem).data("$responsive",self);self.removeCondition(elem.data("currentCondition"),elem);$.each(self.conditions,function(i,condition){var thresholdWidth=condition.at;if(currentWidth<=thresholdWidth){self.applyCondition(condition,elem);return!1}})})},applyCondition:function(condition,elem){var switchTo,alsoSwitch,switchStylesheet,whenApplied;(switchTo=condition.switchTo)&&elem.addClass(switchTo);(alsoSwitch=condition.alsoSwitch)&&$.each(alsoSwitch,function(selector,classname){$(selector).addClass(classname)});(switchStylesheet=condition.switchStylesheet)&&$.each($.makeArray(switchStylesheet),function(i,url){var stylesheet=$('link[href$="'+url+'"]');if(stylesheet.length<1){$('<link/>').attr({rel:'stylesheet',type:'text/css',href:url}).appendTo('head')}});(whenApplied=condition.whenApplied)&&$isFunc(whenApplied)&&whenApplied();elem.data("currentCondition",condition).trigger("responsive",[condition])},removeCondition:function(condition,elem){if(!condition)return;var switchTo,alsoSwitch,switchStylesheet,whenRemoved;(switchTo=condition.switchTo)&&elem.removeClass(switchTo);(alsoSwitch=condition.alsoSwitch)&&$.each(alsoSwitch,function(selector,classname){$(selector).removeClass(classname)});(switchStylesheet=condition.switchStylesheet)&&$.each($.makeArray(switchStylesheet),function(i,url){$('link[href$="'+url+'"]').remove()});(whenRemoved=condition.whenRemoved)&&$isFunc(whenRemoved)&&whenRemoved();elem.removeData("currentCondition")},resetToDefault:function(current){var self=this,elem=$(self.elem);$.each(self.conditions,function(i,condition){if(current&&i==current)return;self.removeCondition(condition,elem)})},destroy:function(){if(self.destroyed)return;$window.off(this.event);var self=this;$(self.elem).each(function(){var elem=$(this);self.removeCondition(elem.data("currentCondition"),elem);elem.removeData("$responsive")});self.destroyed=!0}})});FD40.plugin("utils",function($){(function(){var Bloop=function(items){this.items=items;this.start=0;this.end=items.length-1;this.node=null;this.stopped=!1};$.extend(Bloop.prototype,{isLooping:function(){if(this.stopped)return!1;if(Math.abs(this.start-this.end)>1){this.node=Math.floor((this.start+this.end)/2);return!0}
return!1},flip:function(flip){if(flip){this.end=this.node-1}else{this.start=this.node+1}},stop:function(){this.stop=!0}});$.Bloop=function(items){return new Bloop(items)}})();$.Chunk=function(array,options){if($.isArray(array)){array=[]}
var options=$.extend({},{size:256,every:1000},options);var self=$.extend($.Deferred(),{size:options.size,every:options.every,from:0,to:array.length,process:function(callback){self.process.fn=callback;return self},chunkStart:function(callback){self.chunkStart.fn=callback;return self},chunkEnd:function(callback){self.chunkEnd.fn=callback;return self},start:function(){self.stopped=!1;self.iterate();return self},iterate:function(){if(self.stopped)return;var iterator=self.process.fn;if(!iterator)return;self.to=from.size+self.size;var max=array.length;if(self.to>max){self.to=max}
var range={from:self.from,to:self.to};self.chunkStart.fn&&self.chunkStart.fn.call(self,range.from,range.to);while(self.from<self.to){if(self.stopped)break;iterator.call(self,array[self.from]);self.from++}
self.chunkEnd.fn&&self.chunkEnd.fn.call(self,range.from,range.to);self.completed=(self.from>=array.length-1);if(self.completed){self.resolveWith(self)}else{self.nextIteration=setTimeout(self.iterate,self.every)}
return self},pause:function(){self.stopped=!0;clearTimeout(self.nextIteration);return self},restart:function(){if(self.state()==="rejected")return self;self.from=0;self.start();return self},stop:function(){self.pause();self.rejectWith(self,[self.from]);return self}});return self};(function(isFunction){var Enqueue=function(){this.lastId=0};Enqueue.prototype.queue=function(filter){var self=this,id=$.uid();self.lastId=id;return function(){if(self.lastId===id){var args=arguments,args=(isFunction(filter))?filter.apply(this,args):args;return(isFunction(self.fn))?self.fn.apply(this,args):args}}};$.Enqueue=function(fn){var self=new Enqueue();if(isFunction(fn))self.fn=fn;var func=$.proxy(self.queue,self);func.reset=function(){self.lastId=0};return func}})($.isFunction);(function(){var consoleMethod={error:"error",warning:"warn",success:"log",info:"info"};$.Exception=function(exception){var args=arguments,simple=args.length==1,hasData=args.length==3;exception=$.isPlainObject(exception)?exception:{type:simple?"error":args[0],message:simple?args[0]:args[1]}
hasData&&$.extend(exception,args[2]);if($.environment=="development"){console[consoleMethod[exception.type]](exception.message,exception)}
return exception}})();$.IE=(function(){var ua=navigator.userAgent;if(ua.match(/MSIE 9/))return 9;if(ua.match(/MSIE 10/))return 10;if(ua.match(/rv:11/i))return 11;var undef,v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while(v++,div.innerHTML='<!--[if gt IE '+v+']><i></i><![endif]-->',all[0]);return v>4?v:undef}());$.Task=function(props){var task=$.extend($.Deferred(),{data:{},list:[],add:function(name){var item=$.extend($.Deferred(),{name:name,item:item});task.list.push(item);return task},process:function(){if(!task._promise){task._promise=$.when.apply($,task.list).then(task.resolve,task.reject,task.progress)}
return task}},props);return task};(function(){var Threads=function(options){this.threads=[];this.threadCount=0;this.threadLimit=options.threadLimit||1;this.threadDelay=options.threadDelay||0}
$.extend(Threads.prototype,{add:function(thread,type){if(!$.isFunction(thread))return;thread.type=type||"normal";if(type=="deferred"){thread.deferred=$.Deferred().always($.proxy(this.next,this))}
this.threads.push(thread);this.run()},addDeferred:function(thread){return this.add(thread,"deferred")},next:function(){this.threadCount--;this.run()},run:function(){var self=this;setTimeout(function(){if(self.threads.length<1)return;if(self.threadCount<self.threadLimit){self.threadCount++;var thread=self.threads.shift();try{thread.call(thread,thread.deferred)}
catch(e){console.error(e)}
!thread.deferred&&self.next()}},self.threadDelay)}});$.Threads=function(options){return new Threads(options)}})();$.callback=function(func,persist){if($.isFunction(func)){var funcName=$.uid("cb");window[funcName]=function(){if(!persist){delete window[funcName]}
return func.apply(null,arguments)}
return funcName}
if($.isString(func)){switch(func){case "destroy":var funcName=persist;delete window[funcName];break}}};$.fn.checkList=function(options){var defaultOptions={checkbox:".checkbox",masterCheckbox:".master-checkbox",check:function(){},uncheck:function(){},change:function(){}}
var options=$.extend({},defaultOptions,options),checkList=this,checkboxes=checkList.find(options.checkbox),masterCheckbox=checkList.find(options.masterCheckbox),disableChangeEvent=!1;var change=function(){if(!disableChangeEvent){var checked=checkboxes.filter(':checked'),unchecked=checkboxes.not(':checked');if(checked.length<1){masterCheckbox.removeAttr("checked")}
if(checked.length==checkboxes.length){masterCheckbox.prop("checked",!0)}
options.change.call(checkList,checked,unchecked)}}
checkboxes.checked(function(){options.check.apply(checkList);change()},function(){options.uncheck.apply(checkList);change()});masterCheckbox.checked(function(){disableChangeEvent=!0;checkboxes.checked(!0);disableChangeEvent=!1;change()},function(){disableChangeEvent=!0;checkboxes.checked(!1);disableChangeEvent=!1;change()});change();return this};$.fn.switchClass=function(classname,delimiter){var delimiter=delimiter||"-",prefix=classname.split(delimiter)[0]+delimiter,length=prefix.length;return this.each(function(){var $el=$(this),classnames=$.map($el.attr("class").split(' '),function(classname){return(classname.slice(0,length)==prefix||classname=="")?null:classname});classnames.push(classname);$el.attr("class",classnames.join(" "))})};$.fn.activateClass=function(className){this.prevObject.removeClass(className);return $(this).addClass(className)};$.fn.htmlData=function(prefix){var re=new RegExp("^"+"data-"+(prefix?prefix+"-":"")+"(.*)","i"),parts,data={};$.each(this[0].attributes,function(i,attr){if(attr.specified&&(parts=attr.name.match(re))&&parts[1]){var props=parts[1].split("-"),i,prop,obj=data;max=props.length-1;for(i=0;i<=max;i++){prop=props[i];if(i==max){obj[prop]=attr.value}else{!obj[prop]&&(obj[prop]={});obj=obj[prop]}}}});return data};$.fn.defineData=function(name,value){if(this.data(name)===undefined){this.data(name,value)}
return this};$.deletes=function(obj,props){$.each(props,function(i,prop){delete obj[prop]})};$.fn.disabled=function(state){return(state===undefined)?(this.is(":disabled")||this.hasClass('disabled')):this.prop('disabled',!!state).toggleClass("disabled",!!state)};$.fn.enabled=function(state){return(state===undefined)?!this.disabled():this.disabled(!state)};$.distinct=function(items){var uniqueElements=$.unique;if(items.length<1){return};if(items[0].nodeType){return uniqueElements.apply(this,arguments)};if(typeof items[0]=='object'){var unique=Math.random(),uniqueObjects=[];$.each(items,function(i){if(!items[i][unique]){uniqueObjects.push(items[i]);items[i][unique]=!0}});$.each(uniqueObjects,function(i){delete uniqueObjects[i][unique]});return uniqueObjects};return $.grep(items,function(item,i){return $.inArray(item,items)===i})};$.fn.tagName=function(){return(this[0]||{}).tagName};$.create=function(tagName){return $(document.createElement(tagName))};$.fn.editable=function(editable){if($.isUndefined(editable))return this.prop("contenteditable")==="true";return this.prop("contenteditable",editable)};$.download=function(src){return $("<iframe>").hide().appendTo("body").bind("load",function(){$(this).remove()}).attr("src",src)};$.ns=function(event,ns){return event.split(" ").join(ns+" ")+ns};(function(){var instance="___eventable",publicMethods=["on","off","fire"],getEventName=function(name){return name.split(".")[0]};var Eventable=function(mode){this.fnList={};this.events={};this.mode=mode}
$.extend(Eventable.prototype,{createEvent:function(name){return this.events[name]=$.Callbacks(this.mode)},on:function(name,fn){if(!name||!$.isFunction(fn))return this;var fnList=this.fnList;(fnList[name]||(fnList[name]=[])).push(fn);var basename=getEventName(name);(this.events[basename]||this.createEvent(basename)).add(fn);return this},off:function(name){if(!name)return this;var basename=getEventName(name),event=this.events[basename];if(!event)return this;var removeCallbacks=function(fnList){$.each(fnList,function(i,fn){event.remove(fn)})}
if(basename!==name){$.each(this.fnList,function(name,fnList){if(name.indexOf(basename)>-1){removeCallbacks(fnList)}})}else{removeCallbacks(this.fnList[name])}
return this},fire:function(name){var event=this.events[name];if(!event)return;event.fire.apply(event,$.makeArray(arguments).slice(1));return this},destroy:function(){for(name in this.events){this.events[name].disable()}}});$.eventable=function(obj,mode){var eventable=obj[instance];if(eventable&&mode==="destroy"){eventable.destroy();$.deletes(obj,publicMethods);return delete obj[instance]}
eventable=obj[instance]=new Eventable(mode);obj.on=$.proxy(eventable.on,eventable);obj.off=$.proxy(eventable.off,eventable);obj.fire=$.proxy(eventable.fire,eventable);return obj}})();$.fn.checkList=function(options){var defaultOptions={checkbox:".checkbox",masterCheckbox:".master-checkbox",check:function(){},uncheck:function(){},change:function(){}}
var options=$.extend({},defaultOptions,options),checkList=this,checkboxes=checkList.find(options.checkbox),masterCheckbox=checkList.find(options.masterCheckbox),disableChangeEvent=!1;var change=function(){if(!disableChangeEvent){var checked=checkboxes.filter(':checked'),unchecked=checkboxes.not(':checked');if(checked.length<1){masterCheckbox.removeAttr("checked")}
if(checked.length==checkboxes.length){masterCheckbox.prop("checked",!0)}
options.change.call(checkList,checked,unchecked)}}
checkboxes.checked(function(){options.check.apply(checkList);change()},function(){options.uncheck.apply(checkList);change()});masterCheckbox.checked(function(){disableChangeEvent=!0;checkboxes.checked(!0);disableChangeEvent=!1;change()},function(){disableChangeEvent=!0;checkboxes.checked(!1);disableChangeEvent=!1;change()});change();return this};$.fn.checked=function(checked,unchecked){if(arguments.length<1)
return this.is(':checked');this.each(function(i){var input=$(this);if(typeof checked=="boolean"){input.attr('checked',checked).trigger('change');return}
if(input.is('input[type=checkbox]')||input.is('input[type=radio]')){input.off('change.checked').on('change.checked',function(){try{return(input.is(':checked'))?checked.apply(input):unchecked.apply(input)}catch(e){}})}});return this};$.fn.locate=function(key){var prefix="data";$.each(this[0].attributes,function(i,attr){if(attr.specified&&attr.value==="$"){prefix=attr.name;return!1}});return this.find("["+prefix+"-"+key.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase()+"]")};(function(){var props=["overflow","overflow-x","overflow-y"];$.fn.noscroll=function(lock){if(lock===undefined)lock=!0;return this.each(function(){var el=$(this),overflow=el.data("noscroll");if(!overflow&&lock){overflow={};$.each(props,function(i,prop){overflow[prop]=el.css(prop)});el.data("noscroll",overflow)}
if(lock){$.each(props,function(i,prop){el.css(prop,"hidden")})}else{overflow&&el.css(overflow)}})}})();$.fn.visible=function(partial){var $t=$(this),$w=$(window);if($t.length<1)return;var viewTop=$w.scrollTop(),viewBottom=viewTop+$w.height(),_top=$t.offset().top,_bottom=_top+$t.height(),compareTop=partial===!0?_bottom:_top,compareBottom=partial===!0?_top:_bottom;return((compareBottom<=viewBottom)&&(compareTop>=viewTop))};$.fn.where=$.fn.filterBy=function(key,val,operator){var operator=operator||"=",selector="[data-"+key.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase()+operator+val+"]";return this.filter(selector)};$.fn.checked=function(checked,unchecked){if(arguments.length<1)
return this.is(':checked');this.each(function(i){var input=$(this);if(typeof checked=="boolean"){input.attr('checked',checked).trigger('change');return}
if(input.is('input[type=checkbox]')||input.is('input[type=radio]')){input.off('change.checked').on('change.checked',function(){try{return(input.is(':checked'))?checked.apply(input):unchecked.apply(input)}catch(e){}})}});return this};$.fn.selectAll=function(){return this.each(function(){this.select()})};$.fn.unselect=function(){return this.each(function(){var input=this,value=input.value;input.value+=" ";input.value=value})};$.fn.toObject=$.fn.serializeObject=function(){var obj={};$.each($(this).serializeArray(),function(i,prop){if(obj.hasOwnProperty(prop.name)){if(!$.isArray(obj[prop.name])){obj[prop.name]=[obj[prop.name]]}
obj[prop.name].push(prop.value)}else{obj[prop.name]=prop.value}});return obj};$.fn.toJSON=$.fn.serializeJSON=function(){return JSON.stringify($(this).serializeObject())};$.sanitizeHTML=function(html){return $($.parseHTML(html,document,!0)).toHTML()};$.toHTML=function(str){return $("<div>").html(str).html()};$.fn.toHTML=function(){return $.toHTML(this.clone())};$.toXHTML=function(obj,maintainUppercaseTag){var zz=obj.innerHTML?String(obj.innerHTML):obj,z=zz.match(/(<.+[^>])/g);if(z){for(var i=0;i<z.length;(i=i+1)){var y,zSaved=z[i],attrRE=/\=[a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+[?\s+|?>]/g;z[i]=z[i].replace(/([<|<\/].+?\w+).+[^>]/,function(a){return a});y=z[i].match(attrRE);if(y){var j=0,len=y.length;while(j<len){var replaceRE=/(\=)([a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+)?([\s+|?>])/g,replacer=function(){var args=Array.prototype.slice.call(arguments);return '="'+(maintainUppercaseTag?args[2]:args[2].toLowerCase())+'"'+args[3]};z[i]=z[i].replace(y[j],y[j].replace(replaceRE,replacer));j+=1}}
zz=zz.replace(zSaved,z[i])}}
return zz};$.fn.xhtml=function(){return $.IE?$.toXHTML(this[0]):this.html()};$.buildHTML=function(html,keepScripts){if(html instanceof $)return html;var doc=document;if(window.CloudFlare){var iframe=$.buildHTML.iframe;if(!iframe||!iframe.contentDocument){var iframe=$.buildHTML.iframe=document.createElement("iframe");iframe.style.display="none";document.body.appendChild(iframe)}
doc=iframe.contentDocument}
var html=$.trim(html),scripts=[],fragment=$.buildFragment([html],doc,scripts),nodes=$.merge([],fragment.childNodes);if(!keepScripts&&scripts.length>0){var script=doc.createElement("script");script.text="try{"+$.callback(function(){$(scripts).remove()})+"();}catch(e){}";var i=nodes.length-1,node,inserted;while(node=nodes[i--]){if(node.nodeName==="SCRIPT"){inserted=nodes.push(script)}else if(node.nodeType===1){inserted=node.appendChild(script)}
if(inserted)break}
if(!inserted)nodes.push(script);scripts.push(script)}
return $(nodes)};$.intersects=function(a,b){if($.isArray(b)){b={top:b.y,left:b.x,bottom:b.y,right:b.x}}
return(b.left<=a.right&&a.left<=b.right&&b.top<=a.bottom&&a.top<=b.bottom)};$.fn.intersectsWith=function(top,left,width,height){var offset=this.offset(),reference={top:offset.top,left:offset.left,bottom:offset.top+(sourceHeight=this.height()),right:offset.left+(sourceWidth=this.width()),width:sourceWidth,height:sourceHeight},subject={top:top,left:left,bottom:top+(height||(height=0)),right:left+(width||(width=0)),width:width,height:height};return($.intersects(reference,subject))?{reference:reference,subject:subject}:!1};$.isDeferred=function(obj){return obj&&$.isFunction(obj.always)};$.isNumeric=function(n){return!isNaN(parseFloat(n))&&isFinite(n)};$.rotateNumber=function(n,min,max,offset){if(offset===undefined){offset=0}
n+=offset;if(n<min){n+=max+1}else if(n>max){n-=max+1}
return n};$.regExpEscape=function(str){return str.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,'\\$1').replace(/\x08/g,'\\x08')};$.remap=function(to,from,props){$.each(props,function(i,prop){to[prop]=from[prop]});return obj};(function(){var self=$.Ajax=function(options){options.autostart=!1;var ajax=$.ajax(options);self.queue.addDeferred(function(queue){ajax.send();setTimeout(queue.resolve,self.interval)});return ajax}
self.queue=$.Threads({threadLimit:1});self.interval=1200;var version=$.joomla.version.split("."),majorVersion=version[0],minorVersion=version[1];if(majorVersion>=3&&minorVersion>=2){self.interval=0}})();(function(){$.fn.addTransitoryClass=function(classname,duration){var elem=this.addClass(classname);setTimeout(function(){elem.removeClass(classname)},duration||1);return this};var classAfter=function(operation,classname,timer){var elem=this;setTimeout(function(){elem[operation+"Class"](classname)},timer||50);return this}
$.fn.addClassAfter=function(classname,timer){return classAfter.call(this,"add",classname,timer)};$.fn.removeClassAfter=function(classname,timer){return classAfter.call(this,"remove",classname,timer)};var transitionClass=function(toggle,classname,duration){var suffix=toggle?"-in":"-out";return this.addTransitoryClass(classname.replace(/ /g,suffix+" ")+suffix,duration||1000)[(toggle?"add":"remove")+"ClassAfter"](classname)}
$.fn.addTransitionClass=function(classname,duration){return transitionClass.call(this,!0,classname,duration)}
$.fn.removeTransitionClass=function(classname,duration){return transitionClass.call(this,!1,classname,duration)}})();$.trimSeparators=function(keyword,separator,removeDuplicates){var s=separator;keyword=keyword.replace(new RegExp('^['+s+'\\s]+|['+s+',\\s]+$','g'),'').replace(new RegExp(s+'['+s+'\\s]*'+s,'g'),s).replace(new RegExp('[\\s]+'+s,'g'),s).replace(new RegExp(s+'[\\s]+','g'),s);if(removeDuplicates){keyword=$.distinct(keyword.split(s)).join(s)}
return keyword};$.uid=function(p,s){return((p)?p:'')+Math.random().toString().replace('.','')+((s)?s:'')}});FD40.plugin("storage",function($){var store={},win=window,doc=document,localStorageName='localStorage',scriptTag='script',storage
store.disabled=!1
store.set=function(key,value){}
store.get=function(key){}
store.remove=function(key){}
store.clear=function(){}
store.transact=function(key,defaultVal,transactionFn){var val=store.get(key)
if(transactionFn==null){transactionFn=defaultVal
defaultVal=null}
if(typeof val=='undefined'){val=defaultVal||{}}
transactionFn(val)
store.set(key,val)}
store.getAll=function(){}
store.forEach=function(){}
store.serialize=function(value){return JSON.stringify(value)}
store.deserialize=function(value){if(typeof value!='string'){return undefined}
try{return JSON.parse(value)}
catch(e){return value||undefined}}
function isLocalStorageNameSupported(){try{return(localStorageName in win&&win[localStorageName])}
catch(err){return!1}}
if(isLocalStorageNameSupported()){storage=win[localStorageName]
store.set=function(key,val){if(val===undefined){return store.remove(key)}
storage.setItem(key,store.serialize(val))
return val}
store.get=function(key){return store.deserialize(storage.getItem(key))}
store.remove=function(key){storage.removeItem(key)}
store.clear=function(){storage.clear()}
store.getAll=function(){var ret={}
store.forEach(function(key,val){ret[key]=val})
return ret}
store.forEach=function(callback){for(var i=0;i<storage.length;i++){var key=storage.key(i)
callback(key,store.get(key))}}}else if(doc.documentElement.addBehavior){var storageOwner,storageContainer
try{storageContainer=new ActiveXObject('htmlfile')
storageContainer.open()
storageContainer.write('<'+scriptTag+'>document.w=window</'+scriptTag+'><iframe src="/favicon.ico"></iframe>')
storageContainer.close()
storageOwner=storageContainer.w.frames[0].document
storage=storageOwner.createElement('div')}catch(e){storage=doc.createElement('div')
storageOwner=doc.body}
function withIEStorage(storeFunction){return function(){var args=Array.prototype.slice.call(arguments,0)
args.unshift(storage)
storageOwner.appendChild(storage)
storage.addBehavior('#default#userData')
storage.load(localStorageName)
var result=storeFunction.apply(store,args)
storageOwner.removeChild(storage)
return result}}
var forbiddenCharsRegex=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g")
function ieKeyFix(key){return key.replace(/^d/,'___$&').replace(forbiddenCharsRegex,'___')}
store.set=withIEStorage(function(storage,key,val){key=ieKeyFix(key)
if(val===undefined){return store.remove(key)}
storage.setAttribute(key,store.serialize(val))
storage.save(localStorageName)
return val})
store.get=withIEStorage(function(storage,key){key=ieKeyFix(key)
return store.deserialize(storage.getAttribute(key))})
store.remove=withIEStorage(function(storage,key){key=ieKeyFix(key)
storage.removeAttribute(key)
storage.save(localStorageName)})
store.clear=withIEStorage(function(storage){var attributes=storage.XMLDocument.documentElement.attributes
storage.load(localStorageName)
for(var i=0,attr;attr=attributes[i];i++){storage.removeAttribute(attr.name)}
storage.save(localStorageName)})
store.getAll=function(storage){var ret={}
store.forEach(function(key,val){ret[key]=val})
return ret}
store.forEach=withIEStorage(function(storage,callback){var attributes=storage.XMLDocument.documentElement.attributes
for(var i=0,attr;attr=attributes[i];++i){callback(attr.name,store.deserialize(storage.getAttribute(attr.name)))}})}
try{var testKey='__storejs__'
store.set(testKey,testKey)
if(store.get(testKey)!=testKey){store.disabled=!0}
store.remove(testKey)}catch(e){store.disabled=!0}
store.enabled=!store.disabled
$.Storage=store});FD40.plugin("uri",function($){$.isUrl=function(s)
{var regexp=/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;return regexp.test(s)};var Query=function(queryString){'use strict';var parseQuery=function(q){var arr=[],i,ps,p,kvp,k,v;if(typeof(q)==='undefined'||q===null||q===''){return arr}
if(q.indexOf('?')===0){q=q.substring(1)}
ps=q.toString().split(/[&;]/);for(i=0;i<ps.length;i++){p=ps[i];kvp=p.split('=');k=kvp[0];v=p.indexOf('=')===-1?null:(kvp[1]===null?'':kvp[1]);arr.push([k,v])}
return arr},params=parseQuery(queryString),toString=function(){var s='',i,param;for(i=0;i<params.length;i++){param=params[i];if(s.length>0){s+='&'}
if(param[1]===null){s+=param[0]}
else{s+=param.join('=')}}
return s.length>0?'?'+s:s},decode=function(s){s=decodeURIComponent(s);s=s.replace('+',' ');return s},getParamValue=function(key){var param,i;for(i=0;i<params.length;i++){param=params[i];if(decode(key)===decode(param[0])){return param[1]}}},getParamValues=function(key){var arr=[],i,param;for(i=0;i<params.length;i++){param=params[i];if(decode(key)===decode(param[0])){arr.push(param[1])}}
return arr},deleteParam=function(key,val){var arr=[],i,param,keyMatchesFilter,valMatchesFilter;for(i=0;i<params.length;i++){param=params[i];keyMatchesFilter=decode(param[0])===decode(key);valMatchesFilter=decode(param[1])===decode(val);if((arguments.length===1&&!keyMatchesFilter)||(arguments.length===2&&!keyMatchesFilter&&!valMatchesFilter)){arr.push(param)}}
params=arr;return this},addParam=function(key,val,index){if(arguments.length===3&&index!==-1){index=Math.min(index,params.length);params.splice(index,0,[key,val])}else if(arguments.length>0){params.push([key,val])}
return this},replaceParam=function(key,newVal,oldVal){var index=-1,i,param;if(arguments.length===3){for(i=0;i<params.length;i++){param=params[i];if(decode(param[0])===decode(key)&&decodeURIComponent(param[1])===decode(oldVal)){index=i;break}}
deleteParam(key,oldVal).addParam(key,newVal,index)}else{for(i=0;i<params.length;i++){param=params[i];if(decode(param[0])===decode(key)){index=i;break}}
deleteParam(key);addParam(key,newVal,index)}
return this};return{getParamValue:getParamValue,getParamValues:getParamValues,deleteParam:deleteParam,addParam:addParam,replaceParam:replaceParam,toString:toString}};var Uri=function(uriString){'use strict';var strictMode=!1,urlExtractor=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,parseUri=function(str){var parsers={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/},keys=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],q={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},m=parsers[strictMode?"strict":"loose"].exec(str),uri={},i=14;while(i--){uri[keys[i]]=m[i]||""}
uri[q.name]={};uri[keys[12]].replace(q.parser,function($0,$1,$2){if($1){uri[q.name][$1]=$2}});return uri},uriParts=parseUri(uriString||''),queryObj=new Query(uriParts.query),protocol=function(val){if(typeof val!=='undefined'){uriParts.protocol=val}
return uriParts.protocol},hasAuthorityPrefixUserPref=null,hasAuthorityPrefix=function(val){if(typeof val!=='undefined'){hasAuthorityPrefixUserPref=val}
if(hasAuthorityPrefixUserPref===null){return(uriParts.source.indexOf('//')!==-1)}else{return hasAuthorityPrefixUserPref}},userInfo=function(val){if(typeof val!=='undefined'){uriParts.userInfo=val}
return uriParts.userInfo},host=function(val){if(typeof val!=='undefined'){uriParts.host=val}
return uriParts.host},port=function(val){if(typeof val!=='undefined'){uriParts.port=val}
return uriParts.port},path=function(val){if(typeof val!=='undefined'){uriParts.path=val}
return uriParts.path},query=function(val){if(typeof val!=='undefined'){queryObj=new Query(val)}
return queryObj},anchor=function(val){if(typeof val!=='undefined'){uriParts.anchor=val}
return uriParts.anchor},setProtocol=function(val){protocol(val);return this},setHasAuthorityPrefix=function(val){hasAuthorityPrefix(val);return this},setUserInfo=function(val){userInfo(val);return this},setHost=function(val){host(val);return this},setPort=function(val){port(val);return this},setPath=function(val){path(val);return this},setQuery=function(val){query(val);return this},setAnchor=function(val){anchor(val);return this},getQueryParamValue=function(key){return query().getParamValue(key)},getQueryParamValues=function(key){return query().getParamValues(key)},deleteQueryParam=function(key,val){if(arguments.length===2){query().deleteParam(key,val)}else{query().deleteParam(key)}
return this},addQueryParam=function(key,val,index){if(arguments.length===3){query().addParam(key,val,index)}else{query().addParam(key,val)}
return this},replaceQueryParam=function(key,newVal,oldVal){if(arguments.length===3){query().replaceParam(key,newVal,oldVal)}else{query().replaceParam(key,newVal)}
return this},toPath=function(val){if(val===undefined){return uriParts.path}
if(val.substring(0,1)=='/'){return uriParts.path=val}
var base_path=uriParts.path.split('/'),rel_path=val.split('/');if(base_path.slice(-1)[0]===''){base_path.pop()}
var part;while(part=rel_path.shift()){switch(part){case '..':if(base_path.length>1){base_path.pop()}
break;case '.':break;default:base_path.push(part)}}
uriParts.path=base_path.join('/');return this},toString=function(){var s='',is=function(s){return(s!==null&&s!=='')};if(is(protocol())){s+=protocol();if(protocol().indexOf(':')!==protocol().length-1){s+=':'}
s+='//'}else{if(hasAuthorityPrefix()&&is(host())){s+='//'}}
if(is(userInfo())&&is(host())){s+=userInfo();if(userInfo().indexOf('@')!==userInfo().length-1){s+='@'}}
if(is(host())){s+=host();if(is(port())){s+=':'+port()}}
if(is(path())){s+=path()}else{if(is(host())&&(is(query().toString())||is(anchor()))){s+='/'}}
if(is(query().toString())){if(query().toString().indexOf('?')!==0){s+='?'}
s+=query().toString()}
if(is(anchor())){if(anchor().indexOf('#')!==0){s+='#'}
s+=anchor()}
return s},extract=function(i){var urls=uriString.match(urlExtractor)||[];return(i===undefined)?urls:(urls[i]||"")},clone=function(){return new Uri(toString())};return{protocol:protocol,hasAuthorityPrefix:hasAuthorityPrefix,userInfo:userInfo,host:host,port:port,path:path,query:query,anchor:anchor,setProtocol:setProtocol,setHasAuthorityPrefix:setHasAuthorityPrefix,setUserInfo:setUserInfo,setHost:setHost,setPort:setPort,setPath:setPath,setQuery:setQuery,setAnchor:setAnchor,getQueryParamValue:getQueryParamValue,getQueryParamValues:getQueryParamValues,deleteQueryParam:deleteQueryParam,addQueryParam:addQueryParam,replaceQueryParam:replaceQueryParam,extract:extract,toPath:toPath,toString:toString,clone:clone}};$.uri=function(s){return new Uri(s)}});FD40.plugin("mvc",function($){(function(){var regs={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowUp:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g,dot:/\./},getNext=function(current,nextPart,add){return current[nextPart]!==undefined?current[nextPart]:(add&&(current[nextPart]={}))},isContainer=function(current){var type=typeof current;return current&&(type=='function'||type=='object')},getObject,str=$.String=$.extend($.String||{},{getObject:getObject=function(name,roots,add){var parts=name?name.split(regs.dot):[],length=parts.length,current,ret,i,r=0,type;roots=$.isArray(roots)?roots:[roots||window];if(length==0){return roots[0]}
while(current=roots[r++]){for(i=0;i<length-1&&isContainer(current);i++){current=getNext(current,parts[i],add)}
if(isContainer(current)){ret=getNext(current,parts[i],add);if(ret!==undefined){if(add===!1){delete current[parts[i]]}
return ret}}}},capitalize:function(s,cache){return s.charAt(0).toUpperCase()+s.substr(1)},camelize:function(s){s=str.classize(s);return s.charAt(0).toLowerCase()+s.substr(1)},classize:function(s,join){var parts=s.split(regs.undHash),i=0;for(;i<parts.length;i++){parts[i]=str.capitalize(parts[i])}
return parts.join(join||'')},niceName:function(s){return str.classize(s,' ')},underscore:function(s){return s.replace(regs.colons,'/').replace(regs.words,'$1_$2').replace(regs.lowUp,'$1_$2').replace(regs.dash,'_').toLowerCase()},sub:function(s,data,remove){var obs=[];obs.push(s.replace(regs.replacer,function(whole,inside){var ob=getObject(whole,data,typeof remove=='boolean'?!remove:remove)||getObject(inside,data,typeof remove=='boolean'?!remove:remove),type=typeof ob;if((type==='object'||type==='function')&&type!==null){obs.push(ob);return ""}else{return ""+ob}}));return obs.length<=1?obs[0]:obs},_regs:regs});$.extend($,str)})();(function(){$.String.rsplit=function(string,regex){var result=regex.exec(string),retArr=[],first_idx,last_idx;while(result!==null){first_idx=result.index;last_idx=regex.lastIndex;if(first_idx!==0){retArr.push(string.substring(0,first_idx));string=string.slice(first_idx)}
retArr.push(result[0]);string=string.slice(result[0].length);result=regex.exec(string)}
if(string!==''){retArr.push(string)}
return retArr}})();(function(){var digitTest=/^\d+$/,keyBreaker=/([^\[\]]+)|(\[\])/g,plus=/\+/g,paramTest=/([^?#]*)(#.*)?$/;$.String=$.extend($.String||{},{deparam:function(params){if(!params||!paramTest.test(params)){return{}}
var data={},pairs=params.split('&'),current;for(var i=0;i<pairs.length;i++){current=data;var pair=pairs[i].split('=');if(pair.length!=2){pair=[pair[0],pair.slice(1).join("=")]}
var key=decodeURIComponent(pair[0].replace(plus," ")),value=decodeURIComponent(pair[1].replace(plus," ")),parts=key.match(keyBreaker);for(var j=0;j<parts.length-1;j++){var part=parts[j];if(!current[part]){current[part]=digitTest.test(parts[j+1])||parts[j+1]=="[]"?[]:{}}
current=current[part]}
lastPart=parts[parts.length-1];if(lastPart=="[]"){current.push(value)}else{current[lastPart]=value}}
return data}})})();(function(){var oldClean=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!==undefined;i++){$(elem).triggerHandler("destroyed")}
oldClean(elems)}})();(function(){var oldClosest=$.fn._closest=$.fn.closest;$.fn.closest=function(selectors,context){var rooted={},res,result,thing,i,j,selector,rootedIsEmpty=!0,selector,selectorsArr=selectors;if(typeof selectors=="string")selectorsArr=[selectors];$.each(selectorsArr,function(i,selector){if(selector.indexOf(">")==0){if(selector.indexOf(" ")!=-1){throw " closest does not work with > followed by spaces!"}
rooted[(selectorsArr[i]=selector.substr(1))]=selector;if(typeof selectors=="string")selectors=selector.substr(1);rootedIsEmpty=!1}})
res=oldClosest.call(this,selectors,context);if(rootedIsEmpty)return res;i=0;while(i<res.length){result=res[i],selector=result.selector;if(rooted[selector]!==undefined){result.selector=rooted[selector];rooted[selector]=!1;if(typeof result.selector!=="string"||result.elem.parentNode!==context){res.splice(i,1);continue}}
i++}
return res}})();(function(){$.cookie=function(name,value,options){if(typeof value!='undefined'){options=options||{};if(value===null){value='';options.expires=-1}
if(typeof value=='object'&&jQuery.toJSON){value=jQuery.toJSON(value)}
var expires='';if(options.expires&&(typeof options.expires=='number'||options.expires.toUTCString)){var date;if(typeof options.expires=='number'){date=new Date();date.setTime(date.getTime()+(options.expires*24*60*60*1000))}
else{date=options.expires}
expires='; expires='+date.toUTCString()}
var path=options.path?'; path='+(options.path):'';var domain=options.domain?'; domain='+(options.domain):'';var secure=options.secure?'; secure':'';document.cookie=[name,'=',encodeURIComponent(value),expires,path,domain,secure].join('')}
else{var cookieValue=null;if(document.cookie&&document.cookie!=''){var cookies=document.cookie.split(';');for(var i=0;i<cookies.length;i++){var cookie=jQuery.trim(cookies[i]);if(cookie.substring(0,name.length+1)==(name+'=')){cookieValue=decodeURIComponent(cookie.substring(name.length+1));break}}}
if(jQuery.evalJSON&&cookieValue&&cookieValue.match(/^\s*\{/)){try{cookieValue=jQuery.evalJSON(cookieValue)}
catch(e){}}
return cookieValue}}})();(function(){var initializing=!1,makeArray=$.makeArray,isFunction=$.isFunction,isArray=$.isArray,extend=$.extend,getObject=$.String.getObject,concatArgs=function(arr,args){return arr.concat(makeArray(args))},fnTest=/xyz/.test(function(){xyz})?/\b_super\b/ : /.*/,inheritProps=function(newProps,oldProps,addTo){addTo=addTo||newProps
for(var name in newProps){addTo[name]=isFunction(newProps[name])&&isFunction(oldProps[name])&&fnTest.test(newProps[name])?(function(name,fn){return function(){var tmp=this._super,ret;this._super=oldProps[name];ret=fn.apply(this,arguments);this._super=tmp;return ret}})(name,newProps[name]):newProps[name]}},STR_PROTOTYPE='prototype'
clss=$.Class=function(){if(arguments.length){clss.extend.apply(clss,arguments)}};extend(clss,{proxy:function(funcs){var args=makeArray(arguments),self;funcs=args.shift();if(!isArray(funcs)){funcs=[funcs]}
self=this;return function class_cb(){var cur=concatArgs(args,arguments),isString,length=funcs.length,f=0,func;for(;f<length;f++){func=funcs[f];if(!func){continue}
isString=typeof func=="string";if(isString&&self._set_called){self.called=func}
cur=(isString?self[func]:func).apply(self,cur||[]);if(f<length-1){cur=!isArray(cur)||cur._use_call?[cur]:cur}}
return cur}},newInstance:function(){var inst=this.rawInstance(),args;if(inst.setup){args=inst.setup.apply(inst,arguments)}
if(inst.init){inst.init.apply(inst,isArray(args)?args:arguments)}
return inst},setup:function(baseClass,fullName){this.defaults=extend(!0,{},baseClass.defaults,this.defaults);return arguments},rawInstance:function(){initializing=!0;var inst=new this();initializing=!1;return inst},extend:function(fullName,klass,proto){if(typeof fullName!='string'){proto=klass;klass=fullName;fullName=null}
if(!proto){proto=klass;klass=null}
proto=proto||{};var _super_class=this,_super=this[STR_PROTOTYPE],name,shortName,namespace,prototype;initializing=!0;prototype=new this();initializing=!1;inheritProps(proto,_super,prototype);function Class(){if(initializing)return;if(this.constructor!==Class&&arguments.length){return arguments.callee.extend.apply(arguments.callee,arguments)}else{return this.Class.newInstance.apply(this.Class,arguments)}}
for(name in this){if(this.hasOwnProperty(name)){Class[name]=this[name]}}
inheritProps(klass,this,Class);if(fullName){var root;if(klass&&klass.root){root=klass.root;if($.isString(root)){root=getObject(root,window,!0)}}
var parts=fullName.split(/\./),shortName=parts.pop(),current=getObject(parts.join('.'),root||window,!0),namespace=current;extend(!0,Class,current[shortName]);current[shortName]=Class}
extend(Class,{prototype:prototype,namespace:namespace,shortName:shortName,constructor:Class,fullName:fullName});Class[STR_PROTOTYPE].Class=Class[STR_PROTOTYPE].constructor=Class;var args=Class.setup.apply(Class,concatArgs([_super_class],arguments));if(Class.init){Class.init.apply(Class,args||concatArgs([_super_class],arguments))}
return Class}})
clss.callback=clss[STR_PROTOTYPE].callback=clss[STR_PROTOTYPE].proxy=clss.proxy})();(function(){var bind=function(el,ev,callback,eventData){var wrappedCallback,binder=el.bind&&el.unbind?el:$(isFunction(el)?[el]:el);if(ev.indexOf(">")===0){ev=ev.substr(1);wrappedCallback=function(event){if(event.target===el){callback.apply(this,arguments)}}}
if(eventData){binder.bind(ev,eventData,wrappedCallback||callback)}else{binder.bind(ev,wrappedCallback||callback)}
return function(){binder.unbind(ev,wrappedCallback||callback);el=ev=callback=wrappedCallback=null}},makeArray=$.makeArray,isArray=$.isArray,isFunction=$.isFunction,isString=$.isString,extend=$.extend,Str=$.String,each=$.each,getObject=Str.getObject,STR_PROTOTYPE='prototype',STR_CONSTRUCTOR='constructor',slice=Array[STR_PROTOTYPE].slice,delegate=function(el,selector,ev,callback,eventData){if(selector.indexOf(">")===0){selector=(el.data("directSelector")+" "||"")+selector}
var binder=el.delegate&&el.undelegate?el:$(isFunction(el)?[el]:el)
if(eventData){binder.delegate(selector,ev,eventData,callback)}else{binder.delegate(selector,ev,callback)}
return function(){binder.undelegate(selector,ev,callback);binder=el=ev=callback=selector=null}},binder=function(el,ev,callback,selector,eventData){return selector?delegate(el,selector,ev,callback,eventData):bind(el,ev,callback,eventData)},shifter=function shifter(context,name){var method=typeof name=="string"?context[name]:name;if(isArray(method)&&isFunction(method[1])){method=method[1]}
return function(){context.called=name;return method.apply(context,[this.nodeName?$(this):this].concat(slice.call(arguments,0)))}},dotsReg=/\./g,controllersReg=/_?controllers?/ig,underscoreAndRemoveController=function(className){return Str.underscore(className.replace($.globalNamespace+".","").replace(dotsReg,'_').replace(controllersReg,""))},actionMatcher=/^\S(.*)\s(.*)/,parameterReplacer=/\{([^\}]+)\}/g,controllerReplacer=/\{([^\.]+[\.][^\.]+)\}/g,breaker=/^(?:(.*?)\s)?([\w\.\:>]+)$/,basicProcessor,data=function(el,data){return $.data(el,"controllers",data)};var controllerRoot=$.globalNamespace+".Controller";$.Controller=function(name){var args=makeArray(arguments),_static={root:controllerRoot},_prototype;if(args.length>2){_static=$.extend(_static,args[1]);_prototype=args[2]}else{_prototype=args[1]}
if(_static.namespace){name=_static.namespace+"."+name}
return $.Controller.Class(name,_static,_prototype)}
var controllerClass=controllerRoot+".Class";$.Class(controllerClass,{setup:function(baseClass,name){this._super.apply(this,arguments);if(!this.shortName||this.fullName==controllerClass){return}
var elements=this.elements||[],i=0,defaults=this.defaults;while(element=elements[i++]){var start=element.indexOf("{"),end=element.indexOf("}"),length=element.length,prefix=element.slice(0,start),suffix=element.slice(end+1),names=element.slice(start+1,end).split("|"),j=0;while(name=names[j++]){var prop="{"+$.camelize(name)+"}";!$.has(defaults,prop)&&(defaults[prop]=prefix+name+suffix)}}
this._fullName=underscoreAndRemoveController(this.fullName);this._shortName=underscoreAndRemoveController(this.shortName);var controller=this,funcName,forLint;if(isString(this.pluginName)){var _fullName=this._fullName;var pluginname=this.pluginName;if(!$.fn[pluginname]){$.fn[pluginname]=function(options){var args=makeArray(arguments);if($.isString(options)&&options==="controller"){var controllers=data(this[0]),instance=controllers&&controllers[_fullName];return instance}
return this.each(function(){var controllers=data(this),instance=controllers&&controllers[_fullName];if(instance){if($.isString(options)){var method=instance[options];$.isFunction(method)&&method.apply(instance,args.slice(1));return}
instance.update.apply(instance,args)}else{controller.newInstance.apply(controller,[this].concat(args))}})}}}
var args=makeArray(arguments),prototype=this[STR_PROTOTYPE],protoFactory=args[(args.length>3)?3:2];if(isFunction(protoFactory)){this.protoFactory=protoFactory;prototype=this.protoFactory.call(this,null)}
this.actions={};for(funcName in prototype){if(funcName=='constructor')continue;if(this._isAction(funcName)){var method=prototype[funcName],isMethod=isFunction(method)||(isArray(method)&&isFunction(method[1]));if(!isMethod)continue;this.actions[funcName]=this._action(funcName)}}
$.module("$:/Controllers/"+this.fullName).resolve(this)},hookup:function(el){return new this(el)},_isAction:function(methodName){if(actionMatcher.test(methodName)){return!0}else{return $.inArray(methodName,this.listensTo)>-1||$.event.special[methodName]||processors[methodName]}},_action:function(methodName,options){parameterReplacer.lastIndex=0;if(!options&&parameterReplacer.test(methodName)){return null}
methodName=methodName.replace("{self} ","");var convertedName=methodName;if(options){var bindingOtherController=!1;if(controllerReplacer.test(methodName)){var controller,selector="";convertedName=methodName.replace(controllerReplacer,function(whole,inside){var parts=inside.split(".");controller=options["{"+parts[0]+"}"]||{};if($.isControllerInstance(controller)){selector=(controller[parts[1]]||{})["selector"]}
return selector}).match(breaker);bindingOtherController=!!selector;convertedName=[controller.element].concat(convertedName||[])}
if(!bindingOtherController){convertedName=Str.sub(methodName,[options,window])}}
var arr=isArray(convertedName),parts=(arr?convertedName[1]:convertedName).match(breaker),event=parts[2],processor=processors[event]||basicProcessor;return{processor:processor,parts:parts,delegate:arr?convertedName[0]:undefined}},processors:{},listensTo:[],defaults:{},hostname:"parent"},{setup:function(elem,options){var instance=this,Class=instance[STR_CONSTRUCTOR],prototype=instance[STR_PROTOTYPE];var _fullName=Class._fullName;instance.instanceId=$.uid(_fullName+'_');var instanceOptions=instance.options=extend(!0,{},Class.defaults,Class.defaultOptions,options);var element=instance.element=$(elem);if(Class.protoFactory){prototype=Class.protoFactory.apply(Class,[instance,instanceOptions,element]);extend(!0,instance,prototype)}(data(elem)||data(elem,{}))[_fullName]=instance;if(!element.data("directSelector")){var selector=$.uid("DS");element.addClass(selector).data("directSelector","."+selector)}
for(name in instanceOptions){if(!name.match(/^\{.+\}$/))continue;var key=name.replace(/^\{|\}$/g,''),val=instanceOptions[name];if(isString(val)){var selectorFuncExtension=instance[key];instance[key]=(function(instance,selector,funcName){selector=/^(\.|\#)$/.test(selector)?selector+funcName:selector;var selectorFunc=function(filter){var elements=instance.element.find(selector);if($.isString(filter)){elements=elements.filter(filter)}
if($.isPlainObject(filter)){$.each(filter,function(key,val){elements=elements.filterBy(key,val)})}
return elements};selectorFunc.selector=selector;selectorFunc.css=function(){var cssRule=selectorFunc.cssRule;if(!cssRule){var directSelector=element.data("directSelector"),ruleSelector=$.map(selector.split(","),function(selector){return directSelector+" "+selector});cssRule=selectorFunc.cssRule=$.cssRule(ruleSelector);cssRule.important=!0}
return(arguments.length)?cssRule.css.apply(cssRule,arguments):cssRule};selectorFunc.inside=function(el){return $(el).find(selector)};selectorFunc.of=function(el){return $(el).parents(selector).eq(0)};if($.isPlainObject(selectorFuncExtension)){$.extend(selectorFunc,selectorFuncExtension)}
return selectorFunc})(instance,val,key)}else{instance[key]=val}}
var views=instanceOptions.view;var __view=instance.view;instance.view=function(){return __view.apply(this,arguments)};each(views||{},function(name,view){instance.view[name]=function(useHtml){var args=makeArray(arguments);if($.isBoolean(useHtml)){args=args.slice(1)}else{useHtml=!1}
return instance.view.apply(instance,[useHtml,name].concat(args))}});$.extend(instance,instanceOptions.controller);instance.pluginInstances={};instance.called="init";instance._bind();var __init=instance.init||$.noop;instance.init=function(){instance.init=__init;result=__init.apply(instance,arguments);instance.trigger("init."+Class.fullName.toLowerCase(),[instance]);return result}
return[element,instanceOptions].concat(makeArray(arguments).slice(2))},on:function(eventName){var args=makeArray(arguments),element=this.element,length=args.length;if(length==2){return this._binder(element,eventName,args[1])}
if(length==3&&isString(args[1])){return this._binder(element,eventName,args[2],args[1])}else{return this._binder(args[1],eventName,args[2])}
if(length==4){return this._binder($(args[1]),eventName,args[3],args[2])}},_bind:function(){var instance=this,Class=instance[STR_CONSTRUCTOR],actions=Class.actions,bindings=instance._bindings=[],element=instance.element;each(actions||{},function(name,action){if(!actions.hasOwnProperty(name))return;var ready=Class.actions[name]||Class._action(name,instance.options);if($.isControllerInstance(ready.delegate)){ready.delegate=ready.delegate.element}
bindings.push(ready.processor(ready.delegate||element,ready.parts[2],ready.parts[1],name,instance))});var destroyCB=shifter(this,"destroy");element.bind("destroyed",destroyCB);bindings.push(function(el){$(el).unbind("destroyed",destroyCB)});return bindings.length},_binder:function(el,eventName,func,selector){if(typeof func=='string'){func=shifter(this,func)}
this._bindings.push(binder(el,eventName,func,selector));return this._bindings.length},_unbind:function(){var el=this.element[0];each(this._bindings,function(key,value){value(el)});this._bindings=[]},trigger:function(name){var el=this.element;if(!el)return;var event=$.Event(name);el.trigger.apply(el,[event].concat($.makeArray(arguments).slice(1)));return event},delegate:function(element,selector,eventName,func){if(typeof element=='string'){func=eventName;eventName=selector;selector=element;element=this.element}
return this._binder(element,eventName,func,selector)},update:function(options){extend(this.options,options);this._unbind();this._bind()},destroy:function(){if(this._destroyed){return}
var fname=this[STR_CONSTRUCTOR]._fullName,controllers;for(pname in this.pluginInstances){this.removePlugin(pname)}
this._destroyed=!0;this.element.removeClass(fname);this._unbind();delete this._actions;delete this.element.data("controllers")[fname];$(this).triggerHandler("destroyed");this.element=$()},find:function(selector){return this.element.find(selector)},view:function(){var args=makeArray(arguments),name,options=args,useHtml=!1,context=this[STR_CONSTRUCTOR].component||$,html="",view=this.options.view||{};if(typeof args[0]=="boolean"){useHtml=args[0];options=args.slice(1)}
name=options[0]=view[options[0]];if(name==undefined){return(useHtml)?"":$("")}
html=context.View.apply(context,options);return(useHtml)?html:$($.parseHTML($.trim(html)))},getPlugin:function(name){return this.pluginInstances[name]},addSubscriber:function(instance){var instances=($.isArray(instance))?instance:[instance||{}];var host=this,hostname=this.Class.hostname,options={};options["{"+hostname+"}"]=host;$.map(instances,function(instance,i){if(!$.isControllerInstance(instance))return!1;if(instance.options[hostname]===this)return instance;instance[hostname]=host;return instance.update(options)});return instances},addPlugin:function(name,plugin,options){if(!name)return;if((!plugin&&!options)||$.isPlainObject(plugin)){options=plugin;plugin=[this.Class.root,this.Class.fullName,$.String.capitalize(name)].join(".")}
if($.isString(plugin)){plugin=$.getController(plugin)}
var isPluginInstance=$.isControllerInstance(plugin);if(!isFunction(plugin)&&!isPluginInstance)return;var pluginOptions=this.Class.pluginExtendsInstance?this.options[name]:(this.options.plugin||{})[name];options=$.extend(!0,{element:this.element},options,pluginOptions);var type=((isPluginInstance)?"instance":(($.isController(plugin))?"controller":"function"));this.trigger("addPlugin",[name,plugin,options,type]);var hostname=this.Class.hostname;options["{"+hostname+"}"]=this;var pluginInstance;switch(type){case "instance":pluginInstance=plugin;plugin.update(options);plugin[hostname]=this;break;case "controller":pluginInstance=options.element.addController(plugin,options);break;case "function":pluginInstance=plugin(this,options);break}
if(!pluginInstance)return;this.pluginInstances[name]=pluginInstance;if(this.Class.pluginExtendsInstance){this[name]=pluginInstance}
if(type!=="function"){var hostOptions={};hostOptions["{"+name+"}"]=pluginInstance;this.update(hostOptions)}
this.trigger("registerPlugin",[name,pluginInstance,options,type]);return pluginInstance},removePlugin:function(name){var plugin=this.getPlugin(name);if(!plugin)return;this.trigger("removePlugin",[name,plugin]);delete this.pluginInstances[name];return $.isFunction(plugin.destroy)?plugin.destroy():null},invokePlugin:function(name,method,args){var plugin=this.getPlugin(name);if(!plugin)return;if(!$.isFunction(plugin[method]))return;this.trigger("invokePlugin",[name,plugin,args]);return plugin[method].apply(this,args)},getMessageGroup:function(){var messageGroup=($.isFunction(this.messageGroup))?this.messageGroup():this.element.find("[data-message-group]");if(messageGroup.length<1){messageGroup=$("<div data-message-group></div>").prependTo(this.element)}
return messageGroup},setMessage:function(message,type){var defaultOptions={type:"warning",message:"",parent:this.getMessageGroup(),element:$('<div class="alert fade in"><button type="button" class="close" data-bs-dismiss="alert"></button></div>')},userOptions={},isDeferred=$.isDeferred(message);if($.isPlainObject(message)&&!isDeferred){userOptions=message}else{userOptions={message:message,type:type||"warning"}}
var options=$.extend({},defaultOptions,userOptions),element=options.element;if($.isDeferred(message)){var myself=arguments.callee,context=this;message.done(function(message,type){options.message=message;options.type=type||"warning";myself.call(context,options);element.show()})}else{element.addClass("alert-"+options.type).append(options.message);if($('html').has(element).length<1){element.appendTo(options.parent)}}
return element},clearMessage:function(){this.getMessageGroup().empty()},_set_called:!0});var processors=$.Controller.Class.processors,basicProcessor=function(el,event,selector,methodName,controller){var method=controller[methodName],eventData;if(isArray(method)&&isFunction(method[1])){eventData=method[0]}
return binder(el,event,shifter(controller,methodName),selector,eventData)};each("change click contextmenu dblclick keydown keyup keypress mousedown mousemove mouseout mouseover mouseup reset resize scroll select submit focusin focusout mouseenter mouseleave".split(" "),function(i,v){processors[v]=basicProcessor});var normalizeController=function(controller){return controller.replace("$.Controller",controllerRoot)}
var getController=function(controller){if(isString(controller)){controller=normalizeController(controller);controller=getObject(controller)||getObject(controllerRoot+"."+controller)};if(isController(controller)){return controller}}
var isController=function(controller){return isFunction(controller)&&controller.hasOwnProperty("_fullName")}
var flattenControllers=function(controllers){return $.map(controllers,function(controller){return(isArray(controller))?flattenControllers(controller):getController(controller)})};$.getController=getController;$.isController=function(controller){return!!getController(controller)}
$.isControllerInstance=function(instance){return instance&&instance[STR_CONSTRUCTOR]&&isController(instance[STR_CONSTRUCTOR])}
$.isControllerOf=function(instance,controllers){if(!controllers)return!1;if(!isArray(controllers)){controllers=[controllers]}
for(var i=0;i<controllers.length;i++){var controller=getController(controllers[i]);if(instance instanceof controller)return!0}
return!1};$.fn.extend({controllers:function(){var candidates=flattenControllers(makeArray(arguments)),instances=[];this.each(function(){var controllers=$.data(this,"controllers");each(controllers||{},function(_fullName,instance){if(!controllers.hasOwnProperty(_fullName))return;if(!candidates.length||$.isControllerOf(instance,candidates)){instances.push(instance)}})});return instances},controller:function(controller,options){if(options===undefined){return this.controllers(controller)[0]}
this.addController.apply(this,arguments);return this},hasController:function(controller){var _fullName=(getController(controller)||{})._fullName||(isString(controller)?underscoreAndRemoveController(normalizeController(controller)):"");return(!_fullName)?!1:(($(this).data("controllers")||{}).hasOwnProperty(_fullName))},addController:function(controller,options,callback){var Controller=getController(controller);if(!Controller)return;var instances=[];this.each(function(){if(this.nodeType!==1||this.nodeName=="SCRIPT")return;var existingInstance=$(this).controller(controller);if(existingInstance){instances.push(existingInstance);return}
var instance=new Controller(this,options);isFunction(callback)&&callback.apply(instance,[$(this),instance]);instances.push(instance)});return(instances.length>1)?instances:instances[0]},removeController:function(controller){this.each(function(){var instances=$(this).controllers(controller);while(instances.length){instances.shift().destroy()}});return this},addControllerWhenAvailable:function(controller){var elements=this,args=arguments,task=$.Deferred();if($.isController(controller)){controller=controller.fullName}
if(!isString(controller)){return task.reject()}
$.module("$:/Controllers/"+controller).pipe(function(){var instance=elements.addController.apply(elements,args);task.resolveWith(instance,[elements,instance])},task.reject,task.fail);return task},implement:function(){this.addController.apply(this,arguments);return this}});(function(){var fns=["is","find"],_fns={},fn;while(fn=fns.shift()){_fns[fn]=$.fn[fn];$.fn[fn]=(function(fn){return function(obj){return _fns[fn].apply(this,(obj||{}).hasOwnProperty("of")?[obj.selector]:arguments)}})(fn)}})()})();(function(){var toId=function(src){return src.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},makeArray=$.makeArray,id=1;var $view=$.View=function(view,data,helpers,callback){if(typeof helpers==='function'){callback=helpers;helpers=undefined}
var deferreds=getDeferreds(data);if(deferreds.length){var deferred=$.Deferred();deferreds.push(get(view,!0))
$.when.apply($,deferreds).then(function(resolved){var objs=makeArray(arguments),renderer=objs.pop()[0],result;if(isDeferred(data)){data=usefulPart(resolved)}
else{for(var prop in data){if(isDeferred(data[prop])){data[prop]=usefulPart(objs.shift())}}}
result=renderer(data,helpers);deferred.resolve(result);callback&&callback(result)});return deferred.promise()}
else{var response,async=typeof callback==="function",deferred=get(view,async);if(async){response=deferred;deferred.done(function(renderer){callback(renderer(data,helpers))})}else{deferred.done(function(renderer){response=renderer(data,helpers)})}
return response}},checkText=function(text,url){if(!text.match(/[^\s]/)){throw "$.View ERROR: There is no template or an empty template at "+url}},get=function(url,async){return $.ajax({url:url,dataType:"view",async:async})},isDeferred=function(obj){return obj&&$.isFunction(obj.always)},getDeferreds=function(data){var deferreds=[];if(isDeferred(data)){return[data]}else{for(var prop in data){if(isDeferred(data[prop])){deferreds.push(data[prop])}}}
return deferreds},usefulPart=function(resolved){return $.isArray(resolved)&&resolved.length===3&&resolved[1]==='success'?resolved[0]:resolved};$.ajaxTransport("view",function(options,orig){var url=orig.url,suffix=url.match(/\.[\w\d]+$/),type,el,id,jqXHR,response=function(text){var func=type.renderer(id,text);if($view.cache){$view.cached[id]=func}
return{view:func}};if(el=document.getElementById(url)){suffix="."+el.type.match(/\/(x\-)?(.+)/)[2]}
if(!suffix){suffix=$view.ext;url=url+$view.ext}
id=toId(url);if(url.match(/^\/\//)){var sub=url.substr(2);url=typeof steal==="undefined"?url="/"+sub:steal.root.mapJoin(sub)+''}
type=$view.types[suffix];var template=$.template()[orig.url];return{send:function(headers,callback){if(template){type=$view.types["."+template.type];return callback(200,"success",response(template.content))}else if($view.cached[id]){return callback(200,"success",{view:$view.cached[id]})}else if(el){callback(200,"success",response(el.innerHTML))}else{jqXHR=$.ajax({async:orig.async,url:url,dataType:"text",error:function(){checkText("",url);callback(404)},success:function(text){checkText(text,url);callback(200,"success",response(text))}})}},abort:function(){jqXHR&&jqXHR.abort()}}})
$.extend($view,{hookups:{},hookup:function(cb){var myid=++id;$view.hookups[myid]=cb;return myid},cached:{},cache:!0,register:function(info){this.types["."+info.suffix]=info;if(window.steal){steal.type(info.suffix+" view js",function(options,success,error){var type=$view.types["."+options.type],id=toId(options.rootSrc+'');options.text=type.script(id,options.text)
success()})}},types:{},ext:".ejs",registerScript:function(type,id,src){return "$.View.preload('"+id+"',"+$view.types["."+type].script(id,src)+");"},preload:function(id,renderer){$view.cached[id]=function(data,helpers){return renderer.call(data,data,helpers)}}});if(window.steal){steal.type("view js",function(options,success,error){var type=$view.types["."+options.type],id=toId(options.rootSrc+'');options.text="steal('"+(type.plugin||"jquery/view/"+options.type)+"').then(function($){"+"$.View.preload('"+id+"',"+options.text+");\n})";success()})}
var convert,modify,isTemplate,isHTML,isDOM,getCallback,hookupView,funcs,noHookup={'val':!0,'text':!0};convert=function(func_name){var old=$.fn[func_name];$.fn[func_name]=function(){var args=makeArray(arguments),callbackNum,callback,self=this,result;if(isDeferred(args[0])){args[0].done(function(res){modify.call(self,[res],old)})
return this}
else if(isTemplate(args)){if((callbackNum=getCallback(args))){callback=args[callbackNum];args[callbackNum]=function(result){modify.call(self,[result],old);callback.call(self,result)};$view.apply($view,args);return this}
result=$view.apply($view,args);if(!isDeferred(result)){args=[result]}else{result.done(function(res){modify.call(self,[res],old)})
return this}}
return noHookup[func_name]?old.apply(this,args):modify.call(this,args,old)}};modify=function(args,old){var res,stub,hooks;for(var hasHookups in $view.hookups){break}
if(hasHookups&&args[0]&&isHTML(args[0])){hooks=$view.hookups;$view.hookups={};args[0]=$(args[0])}
res=old.apply(this,args);if(hooks){hookupView(args[0],hooks)}
return res};isTemplate=function(args){var secArgType=typeof args[1];return typeof args[0]=="string"&&(secArgType=='object'||secArgType=='function')&&!isDOM(args[1])};isDOM=function(arg){return arg.nodeType||arg.jquery};isHTML=function(arg){if(isDOM(arg)){return!0}else if(typeof arg==="string"){arg=$.trim(arg);return arg.substr(0,1)==="<"&&arg.substr(arg.length-1,1)===">"&&arg.length>=3}else{return!1}};getCallback=function(args){return typeof args[3]==='function'?3:typeof args[2]==='function'&&2};hookupView=function(els,hooks){var hookupEls,len,i=0,id,func;els=els.filter(function(){return this.nodeType!=3})
hookupEls=els.add("[data-view-id]",els);len=hookupEls.length;for(;i<len;i++){if(hookupEls[i].getAttribute&&(id=hookupEls[i].getAttribute('data-view-id'))&&(func=hooks[id])){func(hookupEls[i],id);delete hooks[id];hookupEls[i].removeAttribute('data-view-id')}}
$.extend($view.hookups,hooks)};$.fn.hookup=function(){var hooks=$view.hookups;$view.hookups={};hookupView(this,hooks);return this};$.each(["prepend","append","after","before","text","html","replaceWith","val"],function(i,func){convert(func)})})();(function(){var myEval=function(script){eval(script)},rSplit=$.String.rsplit,extend=$.extend,isArray=$.isArray,returnReg=/\r\n/g,retReg=/\r/g,newReg=/\n/g,nReg=/\n/,slashReg=/\\/g,quoteReg=/"/g,singleQuoteReg=/'/g,tabReg=/\t/g,leftBracket=/\{/g,rightBracket=/\}/g,quickFunc=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,clean=function(content){return content.replace(slashReg,'\\\\').replace(newReg,'\\n').replace(quoteReg,'\\"').replace(tabReg,'\\t')},escapeHTML=function(content){return content.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(quoteReg,'&#34;').replace(singleQuoteReg,"&#39;")},$View=$.View,bracketNum=function(content){var lefts=content.match(leftBracket),rights=content.match(rightBracket);return(lefts?lefts.length:0)-(rights?rights.length:0)},EJS=function(options){if(this.constructor!=EJS){var ejs=new EJS(options);return function(data,helpers){return ejs.render(data,helpers)}}
if(typeof options=="function"){this.template={fn:options};return}
extend(this,EJS.options,options);this.template=compile(this.text,this.type,this.name)};$&&($.EJS=EJS);EJS.prototype.render=function(object,extraHelpers){object=object||{};this._extra_helpers=extraHelpers;var v=new EJS.Helpers(object,extraHelpers||{});return this.template.fn.call(object,object,v)};extend(EJS,{text:function(input){if(typeof input=='string'){return input}
if(input===null||input===undefined){return ''}
var hook=(input.hookup&&function(el,id){input.hookup.call(input,el,id)})||(typeof input=='function'&&input)||(isArray(input)&&function(el,id){for(var i=0;i<input.length;i++){input[i].hookup?input[i].hookup(el,id):input[i](el,id)}});if(hook){return "data-view-id='"+$View.hookup(hook)+"'"}
return input.toString?input.toString():""},clean:function(text){if(typeof text=='string'){return escapeHTML(text)}else if(typeof text=='number'){return text}else{return EJS.text(text)}},options:{type:'[',ext:'.ejs'}});var scan=function(scanner,source,block){var source_split=rSplit(source,nReg),i=0;for(;i<source_split.length;i++){scanline(scanner,source_split[i],block)}},scanline=function(scanner,line,block){scanner.lines++;var line_split=rSplit(line,scanner.splitter),token;for(var i=0;i<line_split.length;i++){token=line_split[i];if(token!==null){block(token,scanner)}}},makeScanner=function(left,right){var scanner={};extend(scanner,{left:left+'%',right:'%'+right,dLeft:left+'%%',dRight:'%%'+right,eeLeft:left+'%==',eLeft:left+'%=',cmnt:left+'%#',cleanLeft:left+"%~",scan:scan,lines:0});scanner.splitter=new RegExp("("+[scanner.dLeft,scanner.dRight,scanner.eeLeft,scanner.eLeft,scanner.cmnt,scanner.left,scanner.right+'\n',scanner.right,'\n'].join(")|(").replace(/\[/g,"\\[").replace(/\]/g,"\\]")+")");return scanner},compile=function(source,left,name){source=source.replace(returnReg,"\n").replace(retReg,"\n");left=left||'[';var put_cmd="___v1ew.push(",insert_cmd=put_cmd,startTxt='var ___v1ew = [];',finishTxt="return ___v1ew.join('')",buff=new EJS.Buffer([startTxt],[]),content='',put=function(content){buff.push(put_cmd,'"',clean(content),'");')},startTag=null,empty=function(){content=''},doubleParen="));",endStack=[];scan(makeScanner(left,left==='['?']':'>'),source||"",function(token,scanner){var bn;if(startTag===null){switch(token){case '\n':content=content+"\n";put(content);buff.cr();empty();break;case scanner.left:case scanner.eLeft:case scanner.eeLeft:case scanner.cmnt:startTag=token;if(content.length>0){put(content)}
empty();break;case scanner.dLeft:content+=scanner.left;break;default:content+=token;break}}
else{switch(token){case scanner.right:switch(startTag){case scanner.left:bn=bracketNum(content);var last=endStack.length&&bn==-1?endStack.pop():";";if(last===doubleParen){buff.push(finishTxt)}
buff.push(content,last);if(bn===1){endStack.push(";")}
break;case scanner.eLeft:bn=bracketNum(content);if(bn){endStack.push(doubleParen)}
if(quickFunc.test(content)){var parts=content.match(quickFunc)
content="function(__){var "+parts[1]+"=$(__);"+parts[2]+"}"}
buff.push(insert_cmd,$.globalNamespace+".EJS.clean(",content,bn?startTxt:doubleParen);break;case scanner.eeLeft:bn=bracketNum(content);if(bn){endStack.push(doubleParen)}
buff.push(insert_cmd,$.globalNamespace+".EJS.text(",content,bn?startTxt:doubleParen);break}
startTag=null;empty();break;case scanner.dRight:content+=scanner.right;break;default:content+=token;break}}})
if(content.length>0){buff.push(put_cmd,'"',clean(content)+'");')}
var template=buff.close(),out={out:'try { with(_VIEW) { with (_CONTEXT) {'+template+" "+finishTxt+"}}}catch(e){e.lineNumber=null;throw e;}"};myEval.call(out,'this.fn = (function(_CONTEXT,_VIEW){ var $ = '+$.globalNamespace+';'+out.out+'});');return out};EJS.Buffer=function(pre_cmd,post){this.line=[];this.script=[];this.post=post;this.push.apply(this,pre_cmd)};EJS.Buffer.prototype={push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(''),"\n");this.line=[]},close:function(){if(this.line.length>0){this.script.push(this.line.join(''));this.line=[]}
this.post.length&&this.push.apply(this,this.post);this.script.push(";");return this.script.join("")}};EJS.Helpers=function(data,extras){this._data=data;this._extras=extras;extend(this,extras)};EJS.Helpers.prototype={plugin:function(name){var args=$.makeArray(arguments),widget=args.shift();return function(el){var jq=$(el);jq[widget].apply(jq,args)}},view:function(url,data,helpers){helpers=helpers||this._extras;data=data||this._data;return $View(url,data,helpers)}};$View.register({suffix:"ejs",script:function(id,src){return $.globalNamespace+".EJS(function(_CONTEXT,_VIEW) { "+new EJS({text:src,name:id}).template.out+" })"},renderer:function(id,text){return EJS({text:text,name:id})}})})();(function(){var isArray=$.isArray,isObject=function(obj){return typeof obj==='object'&&obj!==null&&obj},makeArray=$.makeArray,each=$.each,hookup=function(val,prop,parent){if(val instanceof $.Observe){unhookup([val],parent._namespace)}else if(isArray(val)){val=new $.Observe.List(val)}else{val=new $.Observe(val)}
val.bind("change"+parent._namespace,function(ev,attr){var args=$.makeArray(arguments),ev=args.shift();if(prop==="*"){args[0]=parent.indexOf(val)+"."+args[0]}else{args[0]=prop+"."+args[0]}
$.event.trigger(ev,args,parent)});return val},unhookup=function(items,namespace){var item;for(var i=0;i<items.length;i++){item=items[i]
if(item&&item.unbind){item.unbind("change"+namespace)}}},id=0,collecting=null,collect=function(){if(!collecting){collecting=[];return!0}},trigger=function(item,event,args){if(item._init){return}
if(!collecting){return $.event.trigger(event,args,item,!0)}else{collecting.push({t:item,ev:event,args:args})}},batchNum=0,sendCollection=function(){var len=collecting.length,items=collecting.slice(0),cur;collecting=null;batchNum ++;for(var i=0;i<len;i++){cur=items[i];$.event.trigger({type:cur.ev,batchNum:batchNum},cur.args,cur.t)}},serialize=function(observe,how,where){observe.each(function(name,val){where[name]=isObject(val)&&typeof val[how]=='function'?val[how]():val})
return where};$.Class($.globalNamespace+'.Observe',{init:function(obj){this._data={};this._namespace=".observe"+(++id);this._init=!0;this.attrs(obj);delete this._init},attr:function(attr,val){if(val===undefined){return this._get(attr)}else{this._set(attr,val);return this}},each:function(){return each.apply(null,[this.__get()].concat(makeArray(arguments)))},removeAttr:function(attr){var parts=isArray(attr)?attr:attr.split("."),prop=parts.shift(),current=this._data[prop];if(parts.length){return current.removeAttr(parts)}else{delete this._data[prop];trigger(this,"change",[prop,"remove",undefined,current]);return current}},_get:function(attr){var parts=isArray(attr)?attr:(""+attr).split("."),current=this.__get(parts.shift());if(parts.length){return current?current._get(parts):undefined}else{return current}},__get:function(attr){return attr?this._data[attr]:this._data},_set:function(attr,value){var parts=isArray(attr)?attr:(""+attr).split("."),prop=parts.shift(),current=this.__get(prop);if(isObject(current)&&parts.length){current._set(parts,value)}else if(!parts.length){if(value!==current){var changeType=this.__get().hasOwnProperty(prop)?"set":"add";this.__set(prop,isObject(value)?hookup(value,prop,this):value);trigger(this,"change",[prop,changeType,value,current]);current&&unhookup([current],this._namespace)}}else{throw "jQuery.Observe: set a property on an object that does not exist"}},__set:function(prop,val){this._data[prop]=val;if(!(prop in this.constructor.prototype)){this[prop]=val}},bind:function(eventType,handler){$.fn.bind.apply($([this]),arguments);return this},unbind:function(eventType,handler){$.fn.unbind.apply($([this]),arguments);return this},serialize:function(){return serialize(this,'serialize',{})},attrs:function(props,remove){if(props===undefined){return serialize(this,'attrs',{})}
props=$.extend(!0,{},props);var prop,collectingStarted=collect();for(prop in this._data){var curVal=this._data[prop],newVal=props[prop];if(newVal===undefined){remove&&this.removeAttr(prop);continue}
if(isObject(curVal)&&isObject(newVal)){curVal.attrs(newVal,remove)}else if(curVal!=newVal){this._set(prop,newVal)}else{}
delete props[prop]}
for(var prop in props){newVal=props[prop];this._set(prop,newVal)}
if(collectingStarted){sendCollection()}}});var list=$.Observe($.globalNamespace+'.Observe.List',{init:function(instances,options){this.length=0;this._namespace=".list"+(++id);this._init=!0;this.bind('change',this.proxy('_changes'));this.push.apply(this,makeArray(instances||[]));$.extend(this,options);if(this.comparator){this.sort()}
delete this._init},_changes:function(ev,attr,how,newVal,oldVal){if(this.comparator&&/^\d+./.test(attr)){var index=+(/^\d+/.exec(attr)[0]),item=this[index],newIndex=this.sortedIndex(item);if(newIndex!==index){[].splice.call(this,index,1);[].splice.call(this,newIndex,0,item);trigger(this,"move",[item,newIndex,index]);ev.stopImmediatePropagation();trigger(this,"change",[attr.replace(/^\d+/,newIndex),how,newVal,oldVal]);return}}
if(attr.indexOf('.')===-1){if(how==='add'){trigger(this,how,[newVal,+attr])}else if(how==='remove'){trigger(this,how,[oldVal,+attr])}}},sortedIndex:function(item){var itemCompare=item.attr(this.comparator),equaled=0,i;for(var i=0;i<this.length;i++){if(item===this[i]){equaled=-1;continue}
if(itemCompare<=this[i].attr(this.comparator)){return i+equaled}}
return i+equaled},__get:function(attr){return attr?this[attr]:this},__set:function(attr,val){this[attr]=val},serialize:function(){return serialize(this,'serialize',[])},splice:function(index,count){var args=makeArray(arguments),i;for(i=2;i<args.length;i++){var val=args[i];if(isObject(val)){args[i]=hookup(val,"*",this)}}
if(count===undefined){count=args[1]=this.length-index}
var removed=[].splice.apply(this,args);if(count>0){trigger(this,"change",[""+index,"remove",undefined,removed]);unhookup(removed,this._namespace)}
if(args.length>2){trigger(this,"change",[""+index,"add",args.slice(2),removed])}
return removed},attrs:function(props,remove){if(props===undefined){return serialize(this,'attrs',[])}
props=props.slice(0);var len=Math.min(props.length,this.length),collectingStarted=collect();for(var prop=0;prop<len;prop++){var curVal=this[prop],newVal=props[prop];if(isObject(curVal)&&isObject(newVal)){curVal.attrs(newVal,remove)}else if(curVal!=newVal){this._set(prop,newVal)}else{}}
if(props.length>this.length){this.push(props.slice(this.length))}else if(props.length<this.length&&remove){this.splice(props.length)}
if(collectingStarted){sendCollection()}},sort:function(method,silent){var comparator=this.comparator,args=comparator?[function(a,b){a=a[comparator]
b=b[comparator]
return a===b?0:(a<b?-1:1)}]:[],res=[].sort.apply(this,args);!silent&&trigger(this,"reset")}}),getArgs=function(args){if(args[0]&&($.isArray(args[0]))){return args[0]}
else{return makeArray(args)}};each({push:"length",unshift:0},function(name,where){list.prototype[name]=function(){var args=getArgs(arguments),len=where?this.length:0;for(var i=0;i<args.length;i++){var val=args[i];if(isObject(val)){args[i]=hookup(val,"*",this)}}
if(args.length==1&&this.comparator){var index=this.sortedIndex(args[0]);this.splice(index,0,args[0]);return this.length}
var res=[][name].apply(this,args)
if(this.comparator&&args.length>1){this.sort(null,!0);trigger(this,"reset",[args])}else{trigger(this,"change",[""+len,"add",args,undefined])}
return res}});each({pop:"length",shift:0},function(name,where){list.prototype[name]=function(){var args=getArgs(arguments),len=where&&this.length?this.length-1:0;var res=[][name].apply(this,args)
trigger(this,"change",[""+len,"remove",undefined,[res]])
if(res&&res.unbind){res.unbind("change"+this._namespace)}
return res}});list.prototype.indexOf=[].indexOf||function(item){return $.inArray(item,this)}
$.O=function(data,options){if(isArray(data)||data instanceof $.Observe.List){return new $.Observe.List(data,options)}else{return new $.Observe(data,options)}}})()});FD40.plugin("joomla",function($){var parser={squeezebox:function(){return(self.isJoomla15)?window.parent.document.getElementById('sbox-window'):window.parent.SqueezeBox}};var self=$.Joomla=function(method,args){if($.isFunction(args)){var fn=args;if(self.isJoomla15){window[method]=fn}else{window.Joomla[method]=fn};return}
var method=parser[method]||((self.isJoomla15)?window[method]:window.Joomla[method]);if($.isFunction(method)){return method.apply(window,args)}};var version=parseFloat($.joomla.version);self.isJoomla15=version<=1.5;self.isJoomla25=version>=1.6&&version<=2.5;self.isJoomla30=version>=3.0});FD40.plugin("module",function($){var Module=function(name){var module=this,ready=$.Callbacks("once memory");$.extend(this,$.Deferred(),{name:name,status:"pending",ready:function(fn){if(fn===!0)ready.fire.call(module,$);if($.isFunction(fn))ready.add(fn)}});module.then(function(){module.exports=this;module.status="resolved"},function(){module.status="rejected"});var done=module.done;module.done=function(){module.required=!0;var factory=module.factory;if(factory&&module.status==="ready"){factory.call(module,$)}
module.done=done;return module.done.apply(this,arguments)}}
$.module=(function(){var self=function(name,factory){var module;if(typeof name==="string"){module=self.get(name);if(factory===undefined){return module}
if($.isFunction(factory)){if(module.status=="resolved")return module;module.factory=factory;module.status="ready";module.ready("true");if(module.required){module.status="executing";factory.call(module,$)}
return module}}
if($.isArray(name)){var tasks=$.map(name,function(task){var module=self.get($.isString(task)?task:task.name);if(!module)return;if(module.status==="pending"){module.status="ready"}
if($.isPlainObject(task))return task});$.each(tasks,function(i,task){self(task.name,task.factory)})}}
$.extend(self,{registry:{},get:function(name){if(!name)return;if($.isModule(name)){name=name.replace("module://","")}
return self.registry[name]||self.create(name)},create:function(name){return self.registry[name]=new Module(name)},remove:function(name){delete self.registry[name]}});return self})();$.isModule=function(module){if($.isString(module)){return!!module.match("module://")}
return module&&module instanceof Module}});FD40.plugin("script",function($){$.script=(function(){var self=function(options){if(options===undefined){return}
if(typeof options==="string"){options={url:options}}
var script=new Script(options);return script};var Script=function(options){var script=$.extend(this,options);script.manager=$.Deferred();$.extend(script,script.manager.promise());script.load()};var head=document.getElementsByTagName("head")[0],baseElement=document.getElementsByTagName("base")[0];$.extend(Script.prototype,{timeout:7000,retry:3,retryCount:1,type:"text/javascript",async:!1,charset:"UTF-8",verbose:!1,head:head,insert:function(){var node=this.node;this.head.appendChild(node)},remove:function(){var node=this.node;setTimeout(function(){node.onload=node.onerror=node.onreadystatechange=null;try{head.removeChild(node)}catch(e){}},1000)},load:function(){var script=this,node;script.endTime=undefined;script.startTime=new Date();script.node=node=document.createElement('script');script.insert();script._ready=$.proxy(script.ready,script);script._error=$.proxy(script.error,script);if(node.attachEvent&&!$.browser.opera){node.attachEvent("onreadystatechange",script._ready);node.attachEvent("onerror",script._error)}else{node.addEventListener("load",script._ready,!1);node.addEventListener("error",script._error,!1)}
$(node).attr({type:script.type,async:script.async,charset:script.charset,src:script.url});script.monitor()},monitor:function(){var script=this;if(script.retryCount>script.retry){script._error();return}
setTimeout(function(){if(script.state()!=="resolved"){if(script.verbose){console.warn('$.script: Load timeout. [Retry: '+script.retryCount+']',script)}
script.remove();script.retryCount++;script.load()}},script.timeout*script.retryCount)},ready:function(event){var script=this,node=script.node;if(event.type==="load"||/loaded|complete/.test(node.readyState)){script.complete.call(script,event);script.manager.resolve(script)}},error:function(event){var script=this;if(script.verbose){console.error('$.script: Unable to load ',script)}
script.complete.call(script,event);script.remove();script.manager.reject(script)},complete:function(event){var script=this,node=script.node;script.endTime=new Date();if(node.detachEvent&&!$.browser.opera){node.detachEvent("onreadystatechange",script._ready);node.detachEvent("onerror",script._error)}else{node.removeEventListener("load",script._ready,!1);node.removeEventListener("error",script._error,!1)}}});return self})()});FD40.plugin("stylesheet",function($){var head=document.getElementsByTagName('head')[0],stylesheets=document.styleSheets,IE_STYLESHEET=document.createStyleSheet,IE_MAX_STYLESHEET=31,IE_MAX_IMPORT=31,IE_MAX_RULE=4095;$.stylesheet=(function(){var self=function(url,attr){var options={};$.extend(options,self.defaultOptions,($.isPlainObject(url))?url:{url:url,attr:attr||{}});if(options.url===undefined){return self.create(options)}
return self.load(options)};$.extend(self,{defaultOptions:{type:"text/css",rel:"stylesheet",media:"all",title:"",forceInject:!1,xhr:!1},setup:function(options){$.extend(self.defaultOptions,options)},availability:function(){var stat={},links=$('link[rel*="stylesheet"]')
styles=$('style');stat.groups=IE_MAX_STYLESHEET-links.length-styles.length;stat.slots=stat.groups*IE_MAX_IMPORT;if(self.currentGroup){stat.slots+=IE_MAX_IMPORT-self.currentGroup.imports.length}
return stat},get:function(style){var i=0;for(;i<stylesheets.length;i++){var stylesheet=stylesheets[i];if((stylesheet.ownerNode||stylesheet.owningElement)==style){return stylesheet}}},create:function(options){var stylesheet,style,length=stylesheets.length;if(IE_STYLESHEET){if(length>=IE_MAX_STYLESHEET)return;stylesheet=document.createStyleSheet();style=stylesheet.ownerNode||stylesheet.owningElement}else{style=document.createElement('style');head.appendChild(style)}
$.extend(style,{type:options.type,title:options.title,media:options.media,rel:options.rel});var content=options.content;if(content!==undefined){if(IE_STYLESHEET){stylesheet.cssText=content}else{style.appendChild(document.createTextNode(content))}}
return style},nextAvailable:function(alsoCreateIfUnavailable){var stylesheet,length=stylesheets.length;if(length){var i;for(i=length;i--;i<0){stylesheet=stylesheets[i];if(IE_STYLESHEET&&((stylesheet.cssRules||stylesheet.rules).length>=IE_MAX_RULE)){stylesheet=undefined;continue}
break}}
return stylesheet.ownerNode||stylesheet.owningElement||((alsoCreateIfUnavailable)?self():undefined)},load:function(options){if($.browser.msie&&!options.forceInject){return self._import(options)}else{var link=$('<link>').attr({href:options.url,type:options.type,rel:options.rel,media:options.media}).appendTo('head');return link[0]}},_import:function(options){var failed;if(self.currentGroup===undefined){var group;try{group=document.createStyleSheet();group.media="all";group.title="jquery_stylesheet"}catch(e){failed=!0;if(options.verbose){console.error('There is not enough slots left to create a new stylesheet group.')}}
if(failed)return!1;self.currentGroup=group}
try{self.currentGroup.addImport(options.url)}catch(e){failed=!0;if(options.verbose){console.info('Import slots exceeded. Creating a new stylesheet group.')}}
if(failed){self.currentGroup=undefined;return self._import(options)}
return!0}});return self})();(function(){var cssRule=function(selectors,rules,style){$.extend(this,{id:$.uid(),style:style,selectors:[],preRule:"",rules:{},legacy:$.IE===8,important:!1});if(selectors){this.set(selectors,rules)}}
$.extend(cssRule.prototype,{set:function(selectors,rules){if($.isString(selectors)){this.selectors=selectors.split(",")}else{this.selectors=selectors}
if($.isString(rules)){this.preRule=rules+"\n";this.rules={}}else{this.preRule="";this.rules=rules||this.rules}
this.update();return this},cssText:function(){return this.selectors.join(",")+"{"+this.ruleText()+"}\n"},ruleText:function(){var important=this.important;return this.preRule+((this.legacy)?"-rule-id:"+this.id+";":"")+$.map(this.rules,function(val,prop){if($.isNumeric(val)&&!$.cssNumber[prop])val+="px";if(important)val+=" !important";return prop+":"+val}).join(";")},update:function(){if(this.legacy)return this.updateLegacy();var cssText=this.cssText();if(this.textNode===undefined){this.textNode=document.createTextNode(cssText);this.style.appendChild(this.textNode)}else{this.textNode.nodeValue=cssText}
return this},updateLegacy:function(){this.removeLegacy();var stylesheet=$.stylesheet.get(this.style),selectors=this.selectors,ruleText=this.ruleText(),i=0;for(;i<selectors.length;i++){stylesheet.addRule(selectors[i],ruleText)}
return this},remove:function(){if(this.legacy)return this.removeLegacy();if(this.textNode!==undefined){this.style.removeChild(this.textNode);delete this.textNode}
return this},removeLegacy:function(){var stylesheet=$.stylesheet.get(this.style),rules=stylesheet.rules,i=0;for(;i<rules.length;i++){if(rules[i].cssText.match(this.id)!==null){stylesheet.removeRule(i)}}
return this},css:function(prop,val){if($.isString(prop)&&val===undefined){return this.rules[prop]}
if($.isPlainObject(prop)){$.extend(this.rules,prop)}else{this.rules[prop]=val}
this.update();return this}});var self=$.cssRule=function(selector,rules,style){var style=style||self.style||$.stylesheet.nextAvailable(!0);if(!style)return;return new cssRule(selector,rules,style)};self.style=$.stylesheet()})();(function(){$.cssUrl=function(url){return 'url("'+encodeURI(url)+'")'}})()});FD40.plugin("language",function($){$.sprintf=function(){var regex=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g;var a=arguments,i=0,format=a[i++];var pad=function(str,len,chr,leftJustify){if(!chr){chr=' '}
var padding=(str.length>=len)?'':Array(1+len-str.length>>>0).join(chr);return leftJustify?str+padding:padding+str};var justify=function(value,prefix,leftJustify,minWidth,zeroPad,customPadChar){var diff=minWidth-value.length;if(diff>0){if(leftJustify||!zeroPad){value=pad(value,minWidth,customPadChar,leftJustify)}else{value=value.slice(0,prefix.length)+pad('',diff,'0',!0)+value.slice(prefix.length)}}
return value};var formatBaseX=function(value,base,prefix,leftJustify,minWidth,precision,zeroPad){var number=value>>>0;prefix=prefix&&number&&{'2':'0b','8':'0','16':'0x'}[base]||'';value=prefix+pad(number.toString(base),precision||0,'0',!1);return justify(value,prefix,leftJustify,minWidth,zeroPad)};var formatString=function(value,leftJustify,minWidth,precision,zeroPad,customPadChar){if(precision!=null){value=value.slice(0,precision)}
return justify(value,'',leftJustify,minWidth,zeroPad,customPadChar)};var doFormat=function(substring,valueIndex,flags,minWidth,_,precision,type){var number;var prefix;var method;var textTransform;var value;if(substring=='%%'){return '%'}
var leftJustify=!1,positivePrefix='',zeroPad=!1,prefixBaseX=!1,customPadChar=' ';var flagsl=flags.length;for(var j=0;flags&&j<flagsl;j++){switch(flags.charAt(j)){case ' ':positivePrefix=' ';break;case '+':positivePrefix='+';break;case '-':leftJustify=!0;break;case "'":customPadChar=flags.charAt(j+1);break;case '0':zeroPad=!0;break;case '#':prefixBaseX=!0;break}}
if(!minWidth){minWidth=0}else if(minWidth=='*'){minWidth=+a[i++]}else if(minWidth.charAt(0)=='*'){minWidth=+a[minWidth.slice(1,-1)]}else{minWidth=+minWidth}
if(minWidth<0){minWidth=-minWidth;leftJustify=!0}
if(!isFinite(minWidth)){throw new Error('sprintf: (minimum-)width must be finite')}
if(!precision){precision='fFeE'.indexOf(type)>-1?6:(type=='d')?0:undefined}else if(precision=='*'){precision=+a[i++]}else if(precision.charAt(0)=='*'){precision=+a[precision.slice(1,-1)]}else{precision=+precision}
value=valueIndex?a[valueIndex.slice(0,-1)]:a[i++];switch(type){case 's':return formatString(String(value),leftJustify,minWidth,precision,zeroPad,customPadChar);case 'c':return formatString(String.fromCharCode(+value),leftJustify,minWidth,precision,zeroPad);case 'b':return formatBaseX(value,2,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case 'o':return formatBaseX(value,8,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case 'x':return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case 'X':return formatBaseX(value,16,prefixBaseX,leftJustify,minWidth,precision,zeroPad).toUpperCase();case 'u':return formatBaseX(value,10,prefixBaseX,leftJustify,minWidth,precision,zeroPad);case 'i':case 'd':number=(+value)|0;prefix=number<0?'-':positivePrefix;value=prefix+pad(String(Math.abs(number)),precision,'0',!1);return justify(value,prefix,leftJustify,minWidth,zeroPad);case 'e':case 'E':case 'f':case 'F':case 'g':case 'G':number=+value;prefix=number<0?'-':positivePrefix;method=['toExponential','toFixed','toPrecision']['efg'.indexOf(type.toLowerCase())];textTransform=['toString','toUpperCase']['eEfFgG'.indexOf(type)%2];value=prefix+Math.abs(number)[method](precision);return justify(value,prefix,leftJustify,minWidth,zeroPad)[textTransform]();default:return substring}};return format.replace(regex,doFormat)}
var self=$.language=$.JText=function(key){if(arguments.length<2){return self._(key)}else{return self.sprintf.apply(null,arguments)}};$.extend(self,{lang:{},add:function(key,val){if($.isPlainObject(key)){$.extend(self.lang,key)}else{self.lang[key]=val}},remove:function(key){delete self.lang[key]},_:function(key){return self.lang.hasOwnProperty(key)?self.lang[key]:key},sprintf:function(){var key=arguments[0];arguments[0]=self.lang[key];return $.sprintf.apply(null,arguments)}})});FD40.plugin("template",function($){$.template=(function(){var defaultTemplate={content:"",type:"ejs"};var self=function(name,content){if(name===undefined){return self.templates}
var template;if(typeof content=="string"){if($.isPlainObject(content)){template=content}else{template=$.extend({},defaultTemplate,{name:name,content:content})}
self.templates[name]=template;return template}else{template=self.templates[name]||{};return template.content||""}};$.extend(self,{templates:{},remove:function(name){delete self.templates[name]}});return self})()});FD40.plugin("require",function($){$.require=(function(){var getFolderPath=function(path){return $.uri(path).setAnchor('').setQuery('').toPath('../').toString()};var self=function(options){var batch=new Batch(options);self.batches[batch.id]=batch;return batch};$.extend(self,{defaultOptions:{path:(function(){var path=$.path+"/scripts/"||$('[require-path]').attr('require-path')||getFolderPath($('script:last').attr('src'))||getFolderPath(window.location.href);if(/^(\/|\.)/.test(path)){path=$.uri(window.location.href).toPath(path).toString()}
return path})(),timeout:10000,retry:3,verbose:($.environment=="development")},setup:function(options){$.extend(self.defaultOptions,options)},batches:{},status:function(filter){$.each(self.batches,function(i,batch){var count={pending:0,resolved:0,rejected:0,ready:0,total:0},messages=[];$.each(batch.tasks,function(i,task){state=(task.module&&task.module.status=="ready")?"ready":task.state();count[state]++;count.total++;messages.push({state:state,content:'['+state+'] '+task.name})});var batchName=batch.id+": "+batch.state()+" ["+count.resolved+"/"+count.total+"]";if(filter&&count[filter]<1)return;if($.IE){console.log("$.require.batches[\""+batch.id+"\"]");$.each(messages,function(i,message){console.log(message.content)});console.log("")}else{console.groupCollapsed(batchName);console.log("$.require.batches[\""+batch.id+"\"]",batch);$.each(messages,function(i,message){var state=message.state,content=message.content;if(!filter||state==filter){switch(state){case 'pending':console.warn(content);break;case 'rejected':console.error(content);break;default:console.info(content);break}}});console.groupEnd(batchName)}});return "$.require.status(pending|resolved|rejected|ready);"},loaders:{},addLoader:function(name,factory){self[name]=factory;Batch.prototype[name]=function(){var batch=this;batch.autoFinalize();factory.apply(batch,arguments);return batch};self.loaders[name]=self[name]=factory},removeLoader:function(name){delete Batch.prototype[name];delete self[name]}});var id=0;var Batch=function(options){var required=$.Callbacks("once memory"),isRequired=!1;var batch=$.extend(this,{id:++id,tasks:[],options:$.extend({},self.defaultOptions,options),autoFinalizeDuration:300,finalized:!1,required:function(fn){if(fn===!0)isRequired=!0&&required.fire();if($.isFunction(fn))required.add(fn);return isRequired}});return batch}
$.extend(Batch.prototype,{addTask:function(task){var batch=this;if(!$.isDeferred(task))return;if(batch.finalized)return;batch.tasks.push(task);task.batch=batch},autoFinalize:function(){var batch=this,duration=batch.autoFinalizeDuration;if(duration===!1)return;clearTimeout(batch.autoFinalizeTimer);batch.autoFinalizeTimer=setTimeout(function(){batch.finalize()},duration)},finalize:function(){var batch=this;if(batch.finalized)return;batch.finalized=!0;var manager=batch.manager=$.when.apply(null,batch.tasks);var promise=manager.promise(),progress=$.Callbacks();$.extend(batch,promise,{progress:progress.add,notify:progress.fire,done:function(){batch.required(!0);batch.done=promise.done;return batch.done.apply(batch,arguments)}});var verbose=batch.options.verbose;manager.progress(function(state,task){if(verbose&&state=="rejected"){console.warn('Require: Task '+task.name+' failed to load.',task)}}).fail(function(){if(verbose){console.warn('Require: Batch '+batch.id+' failed.',batch)}});setTimeout(function(){$.each(batch.tasks,function(i,task){task.then(function(){batch.notify("resolved",task)},function(){batch.notify("rejected",task)},function(){batch.notify("progress",task)})})},1)},expand:function(args,opts){var args=$.makeArray(args),options=opts||{},names=[];if($.isPlainObject(args[0])){options=$.extend(args[0],opts);names=args.slice(1)}else{names=args}
return{options:options,names:names}}});$.each(["done","fail","progress","always","then"],function(i,method){Batch.prototype[method]=function(){var batch=this;batch.finalize();return batch[method].apply(batch,arguments)}});return self})();$.require.addLoader('script',(function(){var ajaxHost=$.uri($.indexUrl).host(),documentHost=$.uri(document.location.href).host();if(ajaxHost!==documentHost&&ajaxHost.match("xn--")){$.support.cors=!0}
var canAsync=document.createElement("script").async===!0||"MozAppearance" in document.documentElement.style||window.opera;var self=function(){var batch=this,args=$.makeArray(arguments),options,names;if($.isPlainObject(args[0])){options=args[0];names=args.slice(1)}else{names=args}
options=$.extend({},self.defaultOptions,batch.options,options,{batch:batch});var taskBefore;$.each(names,function(i,name){var task=new self.task(name,options,taskBefore);batch.addTask(task);if(options.serial&&taskBefore!==undefined){taskBefore.always(task.start)}else{task.start()}
taskBefore=task})};$.extend(self,{defaultOptions:{path:'',extension:(($.mode=='compressed')?'min.js':'js'),serial:!1,async:!1,xhr:!1},setup:function(){$.extend(self.defaultOptions,options)},scripts:{},task:function(name,options,taskBefore){var task=$.extend(this,$.Deferred());task.name=name;task.options=options;task.taskBefore=taskBefore;if($.isArray(name)){task.name=name[0]+"@"+name[1];task.moduleName=name[0];var overrideModuleUrl=name[2];if(!overrideModuleUrl){task.defineModule=!0;if($.module.registry[task.moduleName]){console.warn("$.require.script: "+task.moduleName+' exists! Using existing module instead.')}
task.options.xhr=!0}
name=name[1];task.module=$.module(task.moduleName)}
if($.isUrl(name)){task.url=name}else if(/^(\/|\.)/.test(name)){task.url=$.uri(task.options.path).toPath(name).toString()}else{task.url=$.uri(task.options.path).toPath('./'+name+'.'+task.options.extension).toString();task.module=$.module(name)}}});$.extend(self.task.prototype,{start:function(){var task=this,module=task.module;if(module&&module.status!=="pending"){task.waitForModule();return}
task.load()},waitForModule:function(){var task=this,module=task.module;module.then(task.resolve,task.reject,task.notify);task.batch.required(function(){module.done(task.resolve)})},load:function(){var task=this,taskBefore=task.taskBefore,options={};task.script=self.scripts[task.url]||(function(){var script=(task.options.xhr)?$.ajax({url:task.url,dataType:"text"}):$.script({url:task.url,type:"text/javascript",async:task.options.async,timeout:task.batch.options.timeout,retry:task.batch.options.retry,verbose:task.batch.options.verbose});return self.scripts[task.url]=script})();task.script.done(function(data){var resolveTask=function(){if(task.module){task.waitForModule()}else{task.resolve()}};if(task.options.xhr){if(task.defineModule){task.module=$.module(task.moduleName,function(){var module=this;$.globalEval(data);module.resolveWith(data)})};if(!task.options.async||taskBefore){taskBefore.done(function(){$.globalEval(data);resolveTask()});return}};resolveTask()}).fail(function(){task.reject()})}});return self})());$.require.addLoader('stylesheet',(function(){var self=function(){var batch=this,args=$.makeArray(arguments),options,names;if($.isPlainObject(args[0])){options=args[0];names=args.slice(1)}else{names=args}
options=$.extend({},self.defaultOptions,batch.options,{path:$.path+'/styles/'},options,{batch:batch});$.each(names,function(i,name){var task=new self.task(name,options),existingTask=self.stylesheets[task.url];task=existingTask||task;batch.addTask(task);if(!existingTask){self.stylesheets[task.url]=task;task.start()}})};$.extend(self,{defaultOptions:{path:'',extension:(($.mode=='compressed')?'min.css':'css'),xhr:!1},setup:function(){$.extend(self.defaultOptions,options)},stylesheets:{},task:function(name,options){var task=$.extend(this,$.Deferred());task.name=name;task.options=options;if($.isUrl(name)){task.url=name}else if(/^(\/|\.)/.test(name)){task.url=$.uri(task.options.path).toPath(name).toString()}else{task.url=$.uri(task.options.path).toPath('./'+name+'.'+task.options.extension).toString()}
task.options.url=task.url},loaders:{},loader:function(name){if($.isArray(name)){return $.map(name,function(name){return self.loader(name)})}
if($.isPlainObject(name)){return $.map(name,function(name,options){return self.loader(name).resolve(options)})}
var loader=self.loaders[name];if(!loader){loader=self.loaders[name]=$.Deferred().done(function(options){if($.isPlainObject(options))return;$.stylesheet(options)})}
return loader}});$.extend(self.task.prototype,{start:function(){var task=this;var loader=self.loaders[task.name];if(!loader){loader=self.loader(task.name);if($.stylesheet(task.options)){loader.resolve()}else{loader.reject()}}
loader.then(task.resolve,task.reject)}});return self})());$.require.addLoader('template',(function(){var self=function(){var batch=this,args=$.makeArray(arguments),options,names;if($.isPlainObject(args[0])){options=args[0];names=args.slice(1)}else{names=args}
options=$.extend({},self.defaultOptions,batch.options,options,{batch:batch});$.each(names,function(i,name){var task=new self.task(name,options);batch.addTask(task);task.start()})};$.extend(self,{defaultOptions:{path:'',extension:'htm'},setup:function(){$.extend(self.defaultOptions,options)},task:function(name,options){var task=$.extend(this,$.Deferred());task.name=name;task.options=options;if($.isArray(name)){task.name=name[0];name=name[1]}
if($.isUrl(name)){task.url=name}else if(/^(\/|\.)/.test(name)){task.url=$.uri(task.options.path).toPath(name).toString()}else{task.url=$.uri(task.options.path).toPath('./'+name+'.'+task.options.extension).toString()}},loaders:{},loader:function(name){if($.isArray(name)){return $.map(name,function(name){return self.loader(name)})}
if($.isPlainObject(name)){return $.map(name,function(content,name){return self.loader(name).resolve(content)})}
var loader=self.loaders[name];if(!loader){loader=self.loaders[name]=$.Deferred().done(function(content){$.template(name,content)})}
return loader}});$.extend(self.task.prototype,{start:function(){var task=this;var loader=self.loaders[task.name];if(!loader){loader=self.loader(task.name);loader.xhr=$.Ajax({url:task.url,dataType:"text"}).then(loader.resolve,loader.reject).then(task.resolve,task.reject)}
task.loader=loader;return task}});return self})());$.require.addLoader('language',(function(){var self=function(){var batch=this,args=$.makeArray(arguments),options,names;if($.isPlainObject(args[0])){options=args[0];names=args.slice(1)}else{names=args}
options=$.extend({},self.defaultOptions,batch.options,options,{batch:batch});var task=new self.task(names,options);batch.addTask(task);task.start()};$.extend(self,{defaultOptions:{path:''},setup:function(){$.extend(self.defaultOptions,options)},loaders:{},task:function(names,options){var task=$.extend(this,$.Deferred());task.name=names.join(',');task.options=options;task.url=options.path;task.names=names},loaders:{},loader:function(name){if($.isArray(name)){return $.map(name,function(name){return self.loader(name)})}
if($.isPlainObject(name)){return $.map(name,function(content,name){return self.loader(name).resolve(content)})}
var loader=self.loaders[name];if(!loader){loader=self.loaders[name]=$.Deferred().done(function(string){$.language.add(name,string)})}
return loader}});$.extend(self.task.prototype,{start:function(){var task=this;var loaders=[];var names=$.map(task.names,function(name){var loader=self.loader(name);loader.push(loader);if(/resolved|rejected/.test(loader.state()))return null;return name});task.fail(function(){$.each(names,function(i,name){self.loader(name).reject()})});$.when.apply(null,loaders).then(task.resolve,task.reject);if(names.length<1)return task;task.xhr=$.Ajax({url:task.url,type:"POST",data:{keys:names}}).done(function(strings){if($.isPlainObject(strings)){self.loader(strings)}else{task.reject()}}).fail(function(){task.reject()});return task}});return self})());$.require.addLoader('library',function(){var batch=this,args=$.makeArray(arguments),options={},names;if($.isPlainObject(args[0])){options=args[0];names=args.slice(1)}else{names=args}
$.extend(options,{path:$.scriptPath});return batch.script.apply(batch,[options].concat(names))});$.require.addLoader('image',(function(){var self=function(){var batch=this,args=$.makeArray(arguments),options,names;if($.isPlainObject(args[0])){options=args[0];names=args.slice(1)}else{names=args}
options=$.extend({},self.defaultOptions,batch.options,options,{batch:batch});$.each(names,function(i,name){var task=new self.task(name,options),existingTask=self.images[task.url];task=existingTask||task;batch.addTask(task);if(!existingTask){self.images[task.url]=task;task.start()}})};$.extend(self,{defaultOptions:{path:''},setup:function(){$.extend(self.defaultOptions,options)},images:{},task:function(name,options){var task=$.extend(this,$.Deferred());task.name=name;task.options=options;if($.isUrl(name)){task.url=name}else if(/^(\/|\.)/.test(name)){task.url=$.uri(task.options.path).toPath(name).toString()}else{task.url=$.uri(task.options.path).toPath('./'+name).toString()}
task.options.url=task.url}});$.extend(self.task.prototype,{start:function(){var task=this;task.image=$(new Image()).load(function(){task.resolve()}).error(function(){task.reject()}).attr("src",task.options.url)}});return self})())});FD40.plugin("iframe-transport",function($){$.ajaxPrefilter(function(options,origOptions,jqXHR){if(options.iframe){return "iframe"}});$.ajaxTransport("iframe",function(options,origOptions,jqXHR){var form=null,iframe=null,name="iframe-"+$.now(),files=$(options.files).filter(":file:enabled"),hasFiles=files.length>0,markers=null;function cleanUp(){if(hasFiles){markers.replaceWith(function(idx){return files.get(idx)})}
form.remove();iframe.attr("src","javascript:false;").remove()}
options.dataTypes.shift();form=$("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:options.url,target:name});if(typeof(options.data)==="string"&&options.data.length>0){$.error("data must not be serialized")}
$.each(options.data||{},function(name,value){if($.isPlainObject(value)){name=value.name;value=value.value}
if(!$.isArray(value)){value=[value]}
$.each(value,function(i,value){$("<input type='hidden' />").attr({name:name,value:value}).appendTo(form)})});$("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(form);if(hasFiles){markers=files.after(function(idx){return $(this).clone().prop("disabled",!0)}).next();files.appendTo(form)}
return{send:function(headers,completeCallback){iframe=$("<iframe src='javascript:false;' name='"+name+"' id='"+name+"' style='display:none'></iframe>");iframe.bind("load",function(){iframe.unbind("load").bind("load",function(){var doc=this.contentWindow?this.contentWindow.document:(this.contentDocument?this.contentDocument:this.document),root=doc.documentElement?doc.documentElement:doc.body,textarea=root.getElementsByTagName("textarea")[0],type=textarea?textarea.getAttribute("data-type"):null,status=textarea?textarea.getAttribute("data-status"):200,statusText=textarea?textarea.getAttribute("data-statusText"):"OK",content={html:root.innerHTML,text:type?textarea.value:root?(root.textContent||root.innerText):null};cleanUp();completeCallback(status,statusText,content,type?("Content-Type: "+type):null)});form[0].submit()});$("body").append(form,iframe)},abort:function(){if(iframe!==null){iframe.unbind("load").attr("src","javascript:false;");cleanUp()}}}})});FD40.plugin("server",function($){var self=$.server=function(options){var request=$.Deferred(),ajaxOptions=$.extend(!0,{},self.defaultOptions,options,{success:function(){}}),xhr=request.xhr=$.Ajax(ajaxOptions).done(function(commands){if(typeof commands==="string"){try{commands=$.parseJSON(commands)}catch(e){request.rejectWith(request,["Unable to parse Ajax commands.","error"])}}
if(!$.isArray(commands)){request.rejectWith(request,["Invalid ajax commands.","error"])}else{var parse=function(command){var type=command.type,parser=self.parsers[type]||options[type];if($.isFunction(parser)){return parser.apply(request,command.data)}}
var commands=$.map(commands,function(command){if(command.type=="notify"){parse(command)}else{return command}})
$.each(commands,function(i,command){parse(command)})}
if(request.state()==="pending"){request.resolveWith(request)}}).fail(function(jqXHR,status,statusText){request.rejectWith(request,[statusText,status])});request.abort=xhr.abort;return request};self.defaultOptions={type:'POST',data:{tmpl:'component',format:'ajax',no_html:1},cache:!1,contentType:'application/x-www-form-urlencoded',dataType:'json'};self.parsers={script:function(){var data=$.makeArray(arguments);if(typeof data[0]=='string'){try{eval(data[0])}catch(err){};return}
var chain=window,chainBroken=!1;$.each(data,function(i,chainer)
{if(chainer.property==="Foundry"){chainer.property=$.globalNamespace}
if(chainer.method==="Foundry"){chainer.method=$.globalNamespace}
try{switch(chainer.type)
{case 'get':chain=chain[chainer.property];break;case 'set':chain[chainer.property]=chainer.value;chainBroken=!0;break;case 'call':chain=chain[chainer.method].apply(chain,chainer.args);break}}catch(err){chainBroken=!0}})},resolve:function(){this.resolveWith(this,arguments)},reject:function(){this.rejectWith(this,arguments)},notify:function(){this.notifyWith(this,arguments)},redirect:function(url){window.location=url}}});FD40.plugin("component",function($){var Component=$.Component=function(name,options){if(arguments.length<1){return Component.registry}
if(arguments.length<2){return Component.registry[name]}
return Component.register(name,options)}
Component.registry={};Component.proxy=function(component,property,value){if($.isFunction(value)){component[property]=$.proxy(value,component)}else{component[property]=value}}
Component.register=function(name,options){var abstractComponent;if($.isFunction(name)){abstractComponent=name;name=abstractComponent.className;options=abstractComponent.options}
var self=Component.registry[name]=window[name]=function(command){return($.isFunction(command))?command($):component};$.each(Component.prototype,function(property,value){Component.proxy(self,property,value)});self.$=$;self.options=options;self.className=name;self.identifier=name.toLowerCase();self.componentName="com_"+self.identifier;self.prefix=self.identifier+"/";self.version=options.version;self.safeVersion=self.version.replace(/\./g,"");self.environment=options.environment||$.environment;self.mode=options.mode||$.mode;self.debug=(self.environment==='development');self.console=Component.console(self);self.language=options.language||$.locale.lang||"en";self.baseUrl=options.baseUrl||$.indexUrl+"?option="+self.componentName;self.ajaxUrl=options.ajaxUrl||$.basePath+"/?option="+self.componentName;self.scriptPath=options.scriptPath||$.rootPath+"/media/"+self.componentName+"/scripts/";self.stylePath=options.stylePath||$.rootPath+"/media/"+self.componentName+"/styles/";self.templatePath=options.templatePath||options.scriptPath;self.languagePath=options.languagePath||self.ajaxUrl+'&tmpl=component&no_html=1&controller=lang&task=getLanguage';self.viewPath=options.viewPath||self.ajaxUrl+'&tmpl=component&no_html=1&controller=themes&task=getAjaxTemplate';self.optimizeResources=!0;self.resourcePath=options.resourcePath||self.ajaxUrl+'&tmpl=component&no_html=1&controller=foundry&task=getResource';self.resourceInterval=1200;self.scriptVersioning=options.scriptVersioning||!1;self.tasks=[];FD40.component(name,self);if(!abstractComponent)return;if(self.debug){abstractComponent.queue.execute()}else{var installer,installers=FD40.installer(name);while(installer=installers.shift()){self.install.apply(self,installer)}
$.when(self.install("definitions"),self.install("scripts"),self.install("resources")).done(function(){abstractComponent.queue.execute()})}
var storage=self.storage=function(key,val){var prefix=self.prefix,key=prefix+key,length=arguments.length;if(length==1)return $.Storage.get(key)
if(length==2)return key===!1?$.Storage.remove(prefix+val):$.Storage.set(key,val);return storage.getAll()};$.extend(self.storage,{getAll:function(){var prefix=self.prefix,i=prefix.length,storage=$.Storage.getAll(),obj={};for(key in storage){if(key.substr(0,i)==prefix){obj[key.substr(i)]=storage[key]}}
return obj},remove:function(key){$.Storage.remove(self.prefix+key)},clear:function(){for(key in storage.getAll()){storage.remove(key)}}})}
Component.extend=function(property,value){Component.prototype[property]=value;$.each(Component.registry,function(name,component){Component.proxy(component,property,value)})}
$.template("component/console",'<div id="[%== component.identifier %]-console" class="foundry-console" style="display: none; z-index: 999999;"><div class="console-header"><div class="console-title">[%= component.className %] [%= component.version %]</div><div class="console-remove-button">x</div></div><div class="console-log-item-group"></div><style type="text/css">.foundry-console{position:fixed;width:50%;height:50%;bottom:0;left:0;background:white;box-shadow: 0 0 5px 0;margin-left: 25px;}.console-log-item-group{width: 100%;height: 100%;overflow-y:scroll;}.console-header{position: absolute;background:red;color:white;font-weight:bold;top:-24px;left: 0;line-height:24px;width:100%}.console-remove-button{text-align:center;cursor: pointer;display:block;width: 24px;float:right}.console-remove-button:hover{color: yellow}.console-title{padding: 0 5px;float:left}.console-log-item{padding: 5px}.console-log-item + .console-log-item{border-top: 1px solid #ccc}</style></div>');Component.console=function(component){return(function(self){var instance=function(method){if(arguments.length<1){return instance.toggle()}
return instance[method]&&instance[method].apply(instance,arguments)},element;instance.selector="#"+self.identifier+"-console";instance.init=function(){element=$(instance.selector);if(element.length<1){element=$($.View("component/console",{component:self})).appendTo("body");element.find(".console-remove-button").click(function(){element.hide()})}
instance.element=element;return arguments.callee};instance.methods={log:function(message,type,code){type=type||"info";var itemGroup=element.find(".console-log-item-group"),item=$(document.createElement("div")).addClass("console-log-item type-"+type).attr("data-code",code).html(message);itemGroup.append(item);itemGroup[0].scrollTop=itemGroup[0].scrollHeight;if(self.debug){element.show()}},toggle:function(){element.toggle()},reset:function(){element.find(".console-log-item-group").empty()}};$.each(instance.methods,function(method,fn){instance[method]=function(){instance.init();return fn.apply(instance,arguments)}});return instance})(component)}
var doc=$(document),proto=Component.prototype;$.extend(proto,{run:function(command){return($.isFunction(command))?command($):this},ready:(function(){doc.ready(function(){proto.ready=proto.run});return function(callback){if(!$.isFunction(callback))return;doc.ready(function(){callback($)})}})(),install:function(name,factory){var self=this,task=self.tasks[name]||(self.tasks[name]=$.Deferred());if(!factory)return task;var install=function(){factory($,self);return task.resolve()}
if(name=="definitions")return install();$.when(self.install("definitions")).done(install)},token:function(){var self=this;if(self.token.value)return self.token.value;var identifier=self.identifier,span='span#'+identifier+'-token input',meta='meta[name="'+identifier+':token"]',token=$(span).attr("name")||$(meta).attr("content");return self.token.value=token},template:function(name){var self=this;if(name==undefined){return $.grep($.template(),function(template){return template.indexOf(self.prefix)==0})}
arguments[0]=self.prefix+name;return $.template.apply(null,arguments)},require:function(options){var self=this,options=options||{},require=$.require(options),_require={};$.each(["library","script","language","template","done"],function(i,method){_require[method]=require[method]});require.resource=function(resource){if(!$.isPlainObject(resource))return;if(!resource.type||!resource.name||!$.isDeferred(resource.loader))return;var batch=this;var resourceCollector=self.resourceCollector;if(!resourceCollector){resourceCollector=self.resourceCollector=$.Deferred();$.extend(resourceCollector,{name:$.uid("ResourceCollector"),manifest:[],loaderList:[],loaders:[],load:function(){delete self.resourceCollector;if(resourceCollector.manifest.length<0){resourceCollector.resolve();return}
var retry=0;var loadResources=function(){retry++;$.Ajax({type:'POST',url:self.resourcePath,dataType:"json",data:{resource:resourceCollector.manifest}}).done(function(manifest){if(!$.isArray(manifest)){resourceCollector.reject("Server did not return a valid resource manifest.");return}
$.each(manifest,function(i,resource){var content=resource.content;resourceCollector.loaders[resource.id][content!==undefined?"resolve":"reject"](content)});if(retry>1&&self.debug){console.info("Attempt to try and get resources again was successful!")}}).fail(function(){if(retry>2){if(self.debug){console.error("Unable to get resource again. Giving up!")};return}
if(self.debug){console.warn("Unable to get resource. Trying again...")}
loadResources()})}
loadResources();$.when.apply(null,resourceCollector.loaderList).done(resourceCollector.resolve).fail(resourceCollector.reject)}});setTimeout(resourceCollector.load,self.resourceCollectionInterval)}
var id=resource.id=$.uid("Resource");resourceCollector.loaders[id]=resource.loader;resourceCollector.loaderList.push(resource.loader);delete resource.loader;resourceCollector.manifest.push(resource);return require};require.view=function(){var batch=this,request=batch.expand(arguments,{path:self.viewPath}),loaders={},options=request.options,names=$.map(request.names,function(name){var absoluteName=self.prefix+name,loader=$.require.template.loaders[absoluteName];if(loader)return;loader=$.require.template.loader(absoluteName);loader.name=absoluteName;batch.addTask(loader);if(self.optimizeResources){require.resource({type:"view",name:name,loader:loader});return}else{loaders[name]=loader;return name}});if(names.length>0){$.Ajax({url:options.path,dataType:"json",data:{names:names}}).done(function(templates){if(!$.isArray(templates))return;$.each(templates,function(i,template){var content=template.content;loaders[template.name][content!==undefined?"resolve":"reject"](content)})})}
return require};require.language=function(){var batch=this,request=batch.expand(arguments,{path:self.languagePath});if(self.optimizeResources){$.each(request.names,function(i,name){var loader=$.require.language.loaders[name];if(loader)return;loader=$.require.language.loader(name);loader.name=name;batch.addTask(loader);require.resource({type:"language",name:name,loader:loader})})}else{_require.language.apply(require,[request.options].concat(request.names))}
return require};require.library=function(){_require.script.apply(this,arguments);return require};require.script=function(){var batch=this,request=batch.expand(arguments,{path:self.scriptPath})
names=$.map(request.names,function(name){if($.isArray(name)||$.isUrl(name)||/^(\/|\.)/.test(name))return name;var moduleName=self.prefix+name,moduleUrl=$.uri(request.options.path).toPath('./'+name+'.'+(request.options.extension||'js')+((self.scriptVersioning)?"?"+"version="+self.safeVersion:"")).toString();return[[moduleName,moduleUrl,!0]]});_require.script.apply(require,[request.options].concat(names));return require};require.template=function(){var batch=this,request=batch.expand(arguments,{path:self.templatePath});_require.template.apply(require,[request.options].concat($.map(request.names,function(name){return[[self.prefix+name,name]]})));return require};require.app=function(){var batch=this,request=batch.expand(arguments,{path:self.scriptPath})
names=$.map(request.names,function(name){if($.isArray(name)||$.isUrl(name)||/^(\/|\.)/.test(name))return name;var parts=name.split('/'),path=$.rootPath+'/media/'+self.componentName+'/apps';if(parts.length===4){path+='/'+parts.shift()}
path+='/'+parts[0]+'/'+parts[1]+'/scripts/'+parts[2];var moduleName=self.prefix+name,moduleUrl=path+'.'+(request.options.extension||'js')+((self.scriptVersioning)?"?"+"version="+self.safeVersion:"");return[[moduleName,moduleUrl,!0]]});_require.script.apply(require,[request.options].concat(names));return require};require.done=function(callback){return _require.done.call(require,function(){self.ready(callback)})};return require},module:function(name,factory){var self=this;if($.isArray(name)){return}
var fullname=self.prefix+name;return(factory)?$.module.apply(null,[fullname,function(){var module=this;factory.call(module,$)}]):$.module(fullname)}});$.Component.extend("ajax",function(namespace,params,callback){var self=this,date=new Date();var options={url:self.ajaxUrl+"&_ts="+date.getTime(),data:$.extend(params,{option:self.componentName,namespace:namespace})};options=$.extend(!0,options,self.options.ajax);options.data[self.token()]=1;if(options.data.hasOwnProperty('args')){options.data.args=$.toJSON(options.data.args)}
if($.isPlainObject(callback)){if(callback.type){switch(callback.type){case 'jsonp':callback.dataType='jsonp';callback.crossDomain=!0;options.data.transport='jsonp';break;case 'iframe':callback.iframe=!0;callback.processData=!1;callback.files=options.data.files;delete options.data.files;options.data.transport='iframe';break}
delete callback.type}
$.extend(options,callback)}
if($.isFunction(callback)){options.success=callback}
var ajax=$.server(options);ajax.progress(function(message,type,code){if(self.debug&&type=="debug"){self.console.log(message,type,code)}});return ajax});$.Component.extend("Controller",function(){var self=this,args=$.makeArray(arguments),name=args[0],staticProps,protoFactory;if(args.length==1){return $.String.getObject(name)};if(args.length>2){staticProps=args[1],protoFactory=args[2]}else{staticProps={},protoFactory=args[1]}
$.extend(staticProps,{root:self.className+'.Controller',component:self});return $.Controller.apply(this,[name,staticProps,protoFactory])});$.Component.extend("Model",function(){var self=this,args=$.makeArray(arguments),name=self.className+'.Model.'+args[0],staticProps,protoFactory;if(args.length==1){return $.String.getObject(args[0])}
if(args.length==2){staticProps={},protoFactory=args[1]}
if(args.length>2){staticProps=args[1],protoFactory=args[2]}
$.extend(staticProps,{component:self});return $.Model.apply(this,[name,staticProps,protoFactory])});$.Component.extend("Model.List",function(){var self=this,args=$.makeArray(arguments),name=self.className+'.Model.List.'+args[0],staticProps,protoFactory;if(args.length==1){return $.String.getObject(args[0])}
if(args.length==2){staticProps={},protoFactory=args[1]}
if(args.length>2){staticProps=args[1],protoFactory=args[2]}
$.extend(staticProps,{component:self});return $.Model.List.apply(this,[name,staticProps,protoFactory])});$.Component.extend("View",function(name){var self=this;if(arguments.length<1){return self.template()}
arguments[0]=self.prefix+arguments[0];return $.View.apply(this,arguments)});FD40.module.execute();$.each(FD40.component(),function(i,abstractComponent){if(abstractComponent.registered)return;$.Component.register(abstractComponent)})});FD40.plugin("static",function($){(function(){var stylesheetNames=["dialog/default"];var state=($.stylesheet({"content":".foundryDialog{background:url(images\/333-50.png);padding:5px;border:1px solid #333;border-radius:8px;-moz-border-radius:8px;-webkit-border-radius:8px}.foundryDialog.resizing{padding-bottom:7px}.foundryDialog .dialog-wrap{border:1px solid #333;border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;background:#fff;overflow:hidden;min-height:100%;height:100%}.foundryDialog .dialog-wrap>.in{position:relative}.foundryDialog .dialog-head{font:700 14px\/30px Arial;height:30px;padding:0 9px;border-top:1px solid #f5f5f5;border-bottom:1px solid #666;background:#eaeaea;color:#444 !important;border-radius:4px 4px 0 0;-moz-border-radius:4px 4px 0 0;-webkit-border-radius:4px 4px 0 0;position:relative}.foundryDialog .dialog-body{background:#fff;padding:10px}.foundryDialog .dialog-body.type-iframe{padding:0}.foundryDialog .dialog-footer{background:#fafafa;border-top:1px solid #aaa;padding:6px;border-radius:0 0 4px 4px;-moz-border-radius:0 0 4px 4px;-webkit-border-radius:0 0 4px 4px}.foundryDialog .dialog-buttons{text-align:right}.foundryDialog .dialog-closeButton{background:url(images\/cross-8.png) center;display:block;text-indent:-9999px;width:8px;height:8px;position:absolute !important;right:10px;top:50%;margin-top:-4px;opacity:.4;cursor:pointer}.foundryDialog .dialog-closeButton:hover{opacity:.7}.foundryDialog .dialog-loader{position:absolute;background:rgba(255,255,255,0.5);z-index:9999}.foundryDialog .loader-img{background:url(images\/ajax-loader.gif) center no-repeat;width:32px;height:32px;position:absolute;top:50%;left:50%;margin:-16px 0 0 -16px}"}))?"resolve":"reject";$.each(stylesheetNames,function(i,stylesheet){$.require.stylesheet.loader(stylesheet)[state]()})})();$.module(["uniform","chosen","event/drag","mousewheel","resize","expanding","ui/core","ui/mouse","ui/widget","textboxlist","autosize.input","scrollTo","tinyscrollbar","history","masonry","datetimepicker","","popbox","ui/position","gmaps","placeholder","image","imgareaselect","passwordstrength","mentions","dialog","easing","gritter"]);(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function($){$.uniform={options:{selectClass:'selector',radioClass:'radio',checkboxClass:'checker',fileClass:'uploader',filenameClass:'filename',fileBtnClass:'action',fileDefaultText:'No file selected',fileBtnText:'Choose File',checkedClass:'checked',focusClass:'focus',disabledClass:'disabled',buttonClass:'button',activeClass:'active',hoverClass:'hover',useID:!0,idPrefix:'uniform',resetSelector:!1,autoHide:!0},elements:[]};if($.browser.msie&&$.browser.version<7){$.support.selectOpacity=!1}else{$.support.selectOpacity=!0}
$.fn.uniform=function(options){options=$.extend($.uniform.options,options);var el=this;if(options.resetSelector!=!1){$(options.resetSelector).mouseup(function(){function resetThis(){$.uniform.update(el)}
setTimeout(resetThis,10)})}
function doInput(elem){$el=$(elem);$el.addClass($el.attr("type"));storeElement(elem)}
function doTextarea(elem){$(elem).addClass("uniform");storeElement(elem)}
function doButton(elem){var $el=$(elem);var divTag=$("<div>"),spanTag=$("<span>");divTag.addClass(options.buttonClass);if(options.useID&&$el.attr("id")!="")divTag.attr("id",options.idPrefix+"-"+$el.attr("id"));var btnText;if($el.is("a")||$el.is("button")){btnText=$el.text()}else if($el.is(":submit")||$el.is(":reset")||$el.is("input[type=button]")){btnText=$el.attr("value")}
btnText=btnText==""?$el.is(":reset")?"Reset":"Submit":btnText;spanTag.html(btnText);$el.css("opacity",0);$el.wrap(divTag);$el.wrap(spanTag);divTag=$el.closest("div");spanTag=$el.closest("span");if($el.is(":disabled"))divTag.addClass(options.disabledClass);divTag.bind({"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)},"mousedown.uniform touchbegin.uniform":function(){divTag.addClass(options.activeClass)},"mouseup.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"click.uniform touchend.uniform":function(e){if($(e.target).is("span")||$(e.target).is("div")){if(elem[0].dispatchEvent){var ev=document.createEvent('MouseEvents');ev.initEvent('click',!0,!0);elem[0].dispatchEvent(ev)}else{elem[0].click()}}}});elem.bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)}});$.uniform.noSelect(divTag);storeElement(elem)}
function doSelect(elem){var $el=$(elem);var divTag=$('<div />'),spanTag=$('<span />');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}
divTag.addClass(options.selectClass);if(options.useID&&elem.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+elem.attr("id"))}
var selected=elem.find(":selected:first");if(selected.length==0){selected=elem.find("option:first")}
spanTag.html(selected.html());elem.css('opacity',0);elem.wrap(divTag);elem.before(spanTag);divTag=elem.parent("div");spanTag=elem.siblings("span");elem.bind({"change.uniform":function(){spanTag.text(elem.find(":selected").html());divTag.removeClass(options.activeClass)},"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass);divTag.removeClass(options.activeClass)},"mousedown.uniform touchbegin.uniform":function(){divTag.addClass(options.activeClass)},"mouseup.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"click.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)},"keyup.uniform":function(){spanTag.text(elem.find(":selected").html())}});if($(elem).prop("disabled")){divTag.addClass(options.disabledClass)}
$.uniform.noSelect(spanTag);storeElement(elem)}
function doCheckbox(elem){var $el=$(elem);var divTag=$('<div />'),spanTag=$('<span />');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}
divTag.addClass(options.checkboxClass);if(options.useID&&elem.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+elem.attr("id"))}
$(elem).wrap(divTag);$(elem).wrap(spanTag);spanTag=elem.parent();divTag=spanTag.parent();$(elem).css("opacity",0).bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)},"click.uniform touchend.uniform":function(){if(!$(elem).prop("checked")){spanTag.removeClass(options.checkedClass)}else{spanTag.addClass(options.checkedClass)}},"mousedown.uniform touchbegin.uniform":function(){divTag.addClass(options.activeClass)},"mouseup.uniform touchend.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)}});if($(elem).prop("checked")){spanTag.addClass(options.checkedClass)}
if($(elem).prop("disabled")){divTag.addClass(options.disabledClass)}
storeElement(elem)}
function doRadio(elem){var $el=$(elem);var divTag=$('<div />'),spanTag=$('<span />');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}
divTag.addClass(options.radioClass);if(options.useID&&elem.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+elem.attr("id"))}
$(elem).wrap(divTag);$(elem).wrap(spanTag);spanTag=elem.parent();divTag=spanTag.parent();$(elem).css("opacity",0).bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)},"click.uniform touchend.uniform":function(){if(!$(elem).prop("checked")){spanTag.removeClass(options.checkedClass)}else{var classes=options.radioClass.split(" ")[0];$("."+classes+" span."+options.checkedClass+":has([name='"+$(elem).attr('name')+"'])").removeClass(options.checkedClass);spanTag.addClass(options.checkedClass)}},"mousedown.uniform touchend.uniform":function(){if(!$(elem).is(":disabled")){divTag.addClass(options.activeClass)}},"mouseup.uniform touchbegin.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform touchend.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)}});if($(elem).prop("checked")){spanTag.addClass(options.checkedClass)}
if($(elem).prop("disabled")){divTag.addClass(options.disabledClass)}
storeElement(elem)}
function doFile(elem){var $el=$(elem);var divTag=$('<div />'),filenameTag=$('<span>'+options.fileDefaultText+'</span>'),btnTag=$('<span>'+options.fileBtnText+'</span>');if(!$el.css("display")=="none"&&options.autoHide){divTag.hide()}
divTag.addClass(options.fileClass);filenameTag.addClass(options.filenameClass);btnTag.addClass(options.fileBtnClass);if(options.useID&&$el.attr("id")!=""){divTag.attr("id",options.idPrefix+"-"+$el.attr("id"))}
$el.wrap(divTag);$el.after(btnTag);$el.after(filenameTag);divTag=$el.closest("div");filenameTag=$el.siblings("."+options.filenameClass);btnTag=$el.siblings("."+options.fileBtnClass);if(!$el.attr("size")){var divWidth=divTag.width();$el.attr("size",divWidth/10)}
var setFilename=function()
{var filename=$el.val();if(filename==='')
{filename=options.fileDefaultText}
else{filename=filename.split(/[\/\\]+/);filename=filename[(filename.length-1)]}
filenameTag.text(filename)};setFilename();$el.css("opacity",0).bind({"focus.uniform":function(){divTag.addClass(options.focusClass)},"blur.uniform":function(){divTag.removeClass(options.focusClass)},"mousedown.uniform":function(){if(!$(elem).is(":disabled")){divTag.addClass(options.activeClass)}},"mouseup.uniform":function(){divTag.removeClass(options.activeClass)},"mouseenter.uniform":function(){divTag.addClass(options.hoverClass)},"mouseleave.uniform":function(){divTag.removeClass(options.hoverClass);divTag.removeClass(options.activeClass)}});if($.browser.msie){$el.bind('click.uniform.ie7',function(){setTimeout(setFilename,0)})}else{$el.bind('change.uniform',setFilename)}
if($el.prop("disabled")){divTag.addClass(options.disabledClass)}
$.uniform.noSelect(filenameTag);$.uniform.noSelect(btnTag);storeElement(elem)}
$.uniform.restore=function(elem){if(elem==undefined){elem=$($.uniform.elements)}
$(elem).each(function(){if($(this).is(":checkbox")){$(this).unwrap().unwrap()}else if($(this).is("select")){$(this).siblings("span").remove();$(this).unwrap()}else if($(this).is(":radio")){$(this).unwrap().unwrap()}else if($(this).is(":file")){$(this).siblings("span").remove();$(this).unwrap()}else if($(this).is("button, :submit, :reset, a, input[type='button']")){$(this).unwrap().unwrap()}
$(this).unbind(".uniform");$(this).css("opacity","1");var index=$.inArray($(elem),$.uniform.elements);$.uniform.elements.splice(index,1)})};function storeElement(elem){elem=$(elem).get();if(elem.length>1){$.each(elem,function(i,val){$.uniform.elements.push(val)})}else{$.uniform.elements.push(elem)}}
$.uniform.noSelect=function(elem){function f(){return!1};$(elem).each(function(){this.onselectstart=this.ondragstart=f;$(this).mousedown(f).css({MozUserSelect:'none'})})};$.uniform.update=function(elem){if(elem==undefined){elem=$($.uniform.elements)}
elem=$(elem);elem.each(function(){var $e=$(this);if($e.is("select")){var spanTag=$e.siblings("span");var divTag=$e.parent("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);spanTag.html($e.find(":selected").html());if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":checkbox")){var spanTag=$e.closest("span");var divTag=$e.closest("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);spanTag.removeClass(options.checkedClass);if($e.is(":checked")){spanTag.addClass(options.checkedClass)}
if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":radio")){var spanTag=$e.closest("span");var divTag=$e.closest("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);spanTag.removeClass(options.checkedClass);if($e.is(":checked")){spanTag.addClass(options.checkedClass)}
if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":file")){var divTag=$e.parent("div");var filenameTag=$e.siblings(options.filenameClass);btnTag=$e.siblings(options.fileBtnClass);divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);filenameTag.text($e.val());if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}else if($e.is(":submit")||$e.is(":reset")||$e.is("button")||$e.is("a")||elem.is("input[type=button]")){var divTag=$e.closest("div");divTag.removeClass(options.hoverClass+" "+options.focusClass+" "+options.activeClass);if($e.is(":disabled")){divTag.addClass(options.disabledClass)}else{divTag.removeClass(options.disabledClass)}}})};return this.each(function(){if($.support.selectOpacity){var elem=$(this);if(elem.is("select")){if(elem.attr("multiple")!=!0){if(elem.attr("size")==undefined||elem.attr("size")<=1){doSelect(elem)}}}else if(elem.is(":checkbox")){doCheckbox(elem)}else if(elem.is(":radio")){doRadio(elem)}else if(elem.is(":file")){doFile(elem)}else if(elem.is(":text, :password, input[type='email']")){doInput(elem)}else if(elem.is("textarea")){doTextarea(elem)}else if(elem.is("a")||elem.is(":submit")||elem.is(":reset")||elem.is("button")||elem.is("input[type=button]")){doButton(elem)}}})}})(jQuery)};exports();module.resolveWith(exports)};FD40.module("uniform",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){var globalChosen={};(function(){var SelectParser;SelectParser=(function(){function SelectParser(){this.options_index=0;this.parsed=[]}
SelectParser.prototype.add_node=function(child){if(child.nodeName.toUpperCase()==="OPTGROUP"){return this.add_group(child)}else{return this.add_option(child)}};SelectParser.prototype.add_group=function(group){var group_position,option,_i,_len,_ref,_results;group_position=this.parsed.length;this.parsed.push({array_index:group_position,group:!0,label:group.label,children:0,disabled:group.disabled});_ref=group.childNodes;_results=[];for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];_results.push(this.add_option(option,group_position,group.disabled))}
return _results};SelectParser.prototype.add_option=function(option,group_position,group_disabled){if(option.nodeName.toUpperCase()==="OPTION"){if(option.text!==""){if(group_position!=null)this.parsed[group_position].children+=1;this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:option.value,text:option.text,html:option.innerHTML,selected:option.selected,disabled:group_disabled===!0?group_disabled:option.disabled,group_array_index:group_position,classes:option.className,style:option.style.cssText})}else{this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0})}
return this.options_index+=1}};return SelectParser})();SelectParser.select_to_array=function(select){var child,parser,_i,_len,_ref;parser=new SelectParser();_ref=select.childNodes;for(_i=0,_len=_ref.length;_i<_len;_i++){child=_ref[_i];parser.add_node(child)}
return parser.parsed};this.SelectParser=SelectParser}).call(globalChosen);(function(){var AbstractChosen,root;root=this;AbstractChosen=(function(){function AbstractChosen(form_field,options){this.form_field=form_field;this.options=options!=null?options:{};this.set_default_values();this.is_multiple=this.form_field.multiple;this.set_default_text();this.setup();this.set_up_html();this.register_observers();this.finish_setup()}
AbstractChosen.prototype.set_default_values=function(){var _this=this;this.click_test_action=function(evt){return _this.test_active_click(evt)};this.activate_action=function(evt){return _this.activate_field(evt)};this.active_field=!1;this.mouse_on_container=!1;this.results_showing=!1;this.result_highlighted=null;this.result_single_selected=null;this.allow_single_deselect=(this.options.allow_single_deselect!=null)&&(this.form_field.options[0]!=null)&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||!1;this.search_contains=this.options.search_contains||!1;this.choices=0;this.single_backstroke_delete=this.options.single_backstroke_delete||!1;return this.max_selected_options=this.options.max_selected_options||Infinity};AbstractChosen.prototype.set_default_text=function(){if(this.form_field.getAttribute("data-placeholder")){this.default_text=this.form_field.getAttribute("data-placeholder")}else if(this.is_multiple){this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options"}else{this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option"}
return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"};AbstractChosen.prototype.mouse_enter=function(){return this.mouse_on_container=!0};AbstractChosen.prototype.mouse_leave=function(){return this.mouse_on_container=!1};AbstractChosen.prototype.input_focus=function(evt){var _this=this;if(!this.active_field){return setTimeout((function(){return _this.container_mousedown()}),50)}};AbstractChosen.prototype.input_blur=function(evt){var _this=this;if(!this.mouse_on_container){this.active_field=!1;return setTimeout((function(){return _this.blur_test()}),100)}};AbstractChosen.prototype.result_add_option=function(option){var classes,style;if(!option.disabled){option.dom_id=this.container_id+"_o_"+option.array_index;classes=option.selected&&this.is_multiple?[]:["active-result"];if(option.selected)classes.push("result-selected");if(option.group_array_index!=null)classes.push("group-option");if(option.classes!=="")classes.push(option.classes);style=option.style.cssText!==""?" style=\""+option.style+"\"":"";return '<li id="'+option.dom_id+'" class="'+classes.join(' ')+'"'+style+'>'+option.html+'</li>'}else{return ""}};AbstractChosen.prototype.results_update_field=function(){if(!this.is_multiple)this.results_reset_cleanup();this.result_clear_highlight();this.result_single_selected=null;return this.results_build()};AbstractChosen.prototype.results_toggle=function(){if(this.results_showing){return this.results_hide()}else{return this.results_show()}};AbstractChosen.prototype.results_search=function(evt){if(this.results_showing){return this.winnow_results()}else{return this.results_show()}};AbstractChosen.prototype.keyup_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();switch(stroke){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0){return this.keydown_backstroke()}else if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}
break;case 13:evt.preventDefault();if(this.results_showing)return this.result_select(evt);break;case 27:if(this.results_showing)this.results_hide();return!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};AbstractChosen.prototype.generate_field_id=function(){var new_id;new_id=this.generate_random_id();this.form_field.id=new_id;return new_id};AbstractChosen.prototype.generate_random_char=function(){var chars,newchar,rand;chars="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ";rand=Math.floor(Math.random()*chars.length);return newchar=chars.substring(rand,rand+1)};return AbstractChosen})();root.AbstractChosen=AbstractChosen}).call(globalChosen);(function(){var $,Chosen,get_side_border_padding,root,__hasProp=Object.prototype.hasOwnProperty,__extends=function(child,parent){for(var key in parent){if(__hasProp.call(parent,key))child[key]=parent[key]}function ctor(){this.constructor=child}ctor.prototype=parent.prototype;child.prototype=new ctor;child.__super__=parent.prototype;return child};root=this;$=jQuery;$.fn.extend({chosen:function(options){if($.browser.msie&&($.browser.version==="6.0"||($.browser.version==="7.0"&&document.documentMode===7))){return this}
return this.each(function(input_field){var $this;$this=$(this);if(!$this.hasClass("chzn-done")){return $this.data('chosen',new Chosen(this,options))}})}});Chosen=(function(_super){__extends(Chosen,_super);function Chosen(){Chosen.__super__.constructor.apply(this,arguments)}
Chosen.prototype.setup=function(){this.form_field_jq=$(this.form_field);this.current_value=this.form_field_jq.val();return this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")};Chosen.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")};Chosen.prototype.set_up_html=function(){var container_div,dd_top,dd_width,sf_width;this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,'_'):this.generate_field_id();this.container_id+="_chzn";this.f_width=this.form_field_jq.outerWidth();container_div=$("<div />",{id:this.container_id,"class":"chzn-container"+(this.is_rtl?' chzn-rtl':''),style:'width: '+this.f_width+'px;'});if(this.is_multiple){container_div.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>')}else{container_div.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>')}
this.form_field_jq.hide().after(container_div);this.container=$('#'+this.container_id);this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single"));this.dropdown=this.container.find('div.chzn-drop').first();dd_top=this.container.height();dd_width=this.f_width-get_side_border_padding(this.dropdown);this.dropdown.css({"width":dd_width+"px","top":dd_top+"px"});this.search_field=this.container.find('input').first();this.search_results=this.container.find('ul.chzn-results').first();this.search_field_scale();this.search_no_results=this.container.find('li.no-results').first();if(this.is_multiple){this.search_choices=this.container.find('ul.chzn-choices').first();this.search_container=this.container.find('li.search-field').first()}else{this.search_container=this.container.find('div.chzn-search').first();this.selected_item=this.container.find('.chzn-single').first();sf_width=dd_width-get_side_border_padding(this.search_container)-get_side_border_padding(this.search_field);this.search_field.css({"width":sf_width+"px"})}
this.results_build();this.set_tab_index();return this.form_field_jq.trigger("liszt:ready",{chosen:this})};Chosen.prototype.register_observers=function(){var _this=this;this.container.mousedown(function(evt){return _this.container_mousedown(evt)});this.container.mouseup(function(evt){return _this.container_mouseup(evt)});this.container.mouseenter(function(evt){return _this.mouse_enter(evt)});this.container.mouseleave(function(evt){return _this.mouse_leave(evt)});this.search_results.mouseup(function(evt){return _this.search_results_mouseup(evt)});this.search_results.mouseover(function(evt){return _this.search_results_mouseover(evt)});this.search_results.mouseout(function(evt){return _this.search_results_mouseout(evt)});this.form_field_jq.bind("liszt:updated",function(evt){return _this.results_update_field(evt)});this.form_field_jq.bind("liszt:activate",function(evt){return _this.activate_field(evt)});this.form_field_jq.bind("liszt:open",function(evt){return _this.container_mousedown(evt)});this.search_field.blur(function(evt){return _this.input_blur(evt)});this.search_field.keyup(function(evt){return _this.keyup_checker(evt)});this.search_field.keydown(function(evt){return _this.keydown_checker(evt)});if(this.is_multiple){this.search_choices.click(function(evt){return _this.choices_click(evt)});return this.search_field.focus(function(evt){return _this.input_focus(evt)})}else{return this.container.click(function(evt){return evt.preventDefault()})}};Chosen.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass('chzn-disabled');this.search_field[0].disabled=!0;if(!this.is_multiple){this.selected_item.unbind("focus",this.activate_action)}
return this.close_field()}else{this.container.removeClass('chzn-disabled');this.search_field[0].disabled=!1;if(!this.is_multiple){return this.selected_item.bind("focus",this.activate_action)}}};Chosen.prototype.container_mousedown=function(evt){var target_closelink;if(!this.is_disabled){target_closelink=evt!=null?($(evt.target)).hasClass("search-choice-close"):!1;if(evt&&evt.type==="mousedown"&&!this.results_showing){evt.stopPropagation()}
if(!this.pending_destroy_click&&!target_closelink){if(!this.active_field){if(this.is_multiple)this.search_field.val("");$(document).click(this.click_test_action);this.results_show()}else if(!this.is_multiple&&evt&&(($(evt.target)[0]===this.selected_item[0])||$(evt.target).parents("a.chzn-single").length)){evt.preventDefault();this.results_toggle()}
return this.activate_field()}else{return this.pending_destroy_click=!1}}};Chosen.prototype.container_mouseup=function(evt){if(evt.target.nodeName==="ABBR"&&!this.is_disabled){return this.results_reset(evt)}};Chosen.prototype.blur_test=function(evt){if(!this.active_field&&this.container.hasClass("chzn-container-active")){return this.close_field()}};Chosen.prototype.close_field=function(){$(document).unbind("click",this.click_test_action);if(!this.is_multiple){this.selected_item.attr("tabindex",this.search_field.attr("tabindex"));this.search_field.attr("tabindex",-1)}
this.active_field=!1;this.results_hide();this.container.removeClass("chzn-container-active");this.winnow_results_clear();this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};Chosen.prototype.activate_field=function(){if(!this.is_multiple&&!this.active_field){this.search_field.attr("tabindex",this.selected_item.attr("tabindex"));this.selected_item.attr("tabindex",-1)}
this.container.addClass("chzn-container-active");this.active_field=!0;this.search_field.val(this.search_field.val());return this.search_field.focus()};Chosen.prototype.test_active_click=function(evt){if($(evt.target).parents('#'+this.container_id).length){return this.active_field=!0}else{return this.close_field()}};Chosen.prototype.results_build=function(){var content,data,_i,_len,_ref;this.parsing=!0;this.results_data=root.SelectParser.select_to_array(this.form_field);if(this.is_multiple&&this.choices>0){this.search_choices.find("li.search-choice").remove();this.choices=0}else if(!this.is_multiple){this.selected_item.addClass("chzn-default").find("span").text(this.default_text);if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.container.addClass("chzn-container-single-nosearch")}else{this.container.removeClass("chzn-container-single-nosearch")}}
content='';_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){data=_ref[_i];if(data.group){content+=this.result_add_group(data)}else if(!data.empty){content+=this.result_add_option(data);if(data.selected&&this.is_multiple){this.choice_build(data)}else if(data.selected&&!this.is_multiple){this.selected_item.removeClass("chzn-default").find("span").text(data.text);if(this.allow_single_deselect)this.single_deselect_control_build()}}}
this.search_field_disabled();this.show_search_field_default();this.search_field_scale();this.search_results.html(content);return this.parsing=!1};Chosen.prototype.result_add_group=function(group){if(!group.disabled){group.dom_id=this.container_id+"_g_"+group.array_index;return '<li id="'+group.dom_id+'" class="group-result">'+$("<div />").text(group.label).html()+'</li>'}else{return ""}};Chosen.prototype.result_do_highlight=function(el){var high_bottom,high_top,maxHeight,visible_bottom,visible_top;if(el.length){this.result_clear_highlight();this.result_highlight=el;this.result_highlight.addClass("highlighted");maxHeight=parseInt(this.search_results.css("maxHeight"),10);visible_top=this.search_results.scrollTop();visible_bottom=maxHeight+visible_top;high_top=this.result_highlight.position().top+this.search_results.scrollTop();high_bottom=high_top+this.result_highlight.outerHeight();if(high_bottom>=visible_bottom){return this.search_results.scrollTop((high_bottom-maxHeight)>0?high_bottom-maxHeight:0)}else if(high_top<visible_top){return this.search_results.scrollTop(high_top)}}};Chosen.prototype.result_clear_highlight=function(){if(this.result_highlight)this.result_highlight.removeClass("highlighted");return this.result_highlight=null};Chosen.prototype.results_show=function(){var dd_top;if(!this.is_multiple){this.selected_item.addClass("chzn-single-with-drop");if(this.result_single_selected){this.result_do_highlight(this.result_single_selected)}}else if(this.max_selected_options<=this.choices){this.form_field_jq.trigger("liszt:maxselected",{chosen:this});return!1}
dd_top=this.is_multiple?this.container.height():this.container.height()-1;this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this});this.dropdown.css({"top":dd_top+"px","left":0});this.results_showing=!0;this.search_field.focus();this.search_field.val(this.search_field.val());return this.winnow_results()};Chosen.prototype.results_hide=function(){if(!this.is_multiple){this.selected_item.removeClass("chzn-single-with-drop")}
this.result_clear_highlight();this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this});this.dropdown.css({"left":"-9000px"});return this.results_showing=!1};Chosen.prototype.set_tab_index=function(el){var ti;if(this.form_field_jq.attr("tabindex")){ti=this.form_field_jq.attr("tabindex");this.form_field_jq.attr("tabindex",-1);if(this.is_multiple){return this.search_field.attr("tabindex",ti)}else{this.selected_item.attr("tabindex",ti);return this.search_field.attr("tabindex",-1)}}};Chosen.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}else{this.search_field.val("");return this.search_field.removeClass("default")}};Chosen.prototype.search_results_mouseup=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target.length){this.result_highlight=target;return this.result_select(evt)}};Chosen.prototype.search_results_mouseover=function(evt){var target;target=$(evt.target).hasClass("active-result")?$(evt.target):$(evt.target).parents(".active-result").first();if(target)return this.result_do_highlight(target)};Chosen.prototype.search_results_mouseout=function(evt){if($(evt.target).hasClass("active-result"||$(evt.target).parents('.active-result').first())){return this.result_clear_highlight()}};Chosen.prototype.choices_click=function(evt){evt.preventDefault();if(this.active_field&&!($(evt.target).hasClass("search-choice"||$(evt.target).parents('.search-choice').first))&&!this.results_showing){return this.results_show()}};Chosen.prototype.choice_build=function(item){var choice_id,html,link,_this=this;if(this.is_multiple&&this.max_selected_options<=this.choices){this.form_field_jq.trigger("liszt:maxselected",{chosen:this});return!1}
choice_id=this.container_id+"_c_"+item.array_index;this.choices+=1;if(item.disabled){html='<li class="search-choice search-choice-disabled" id="'+choice_id+'"><span>'+item.html+'</span></li>'}else{html='<li class="search-choice" id="'+choice_id+'"><span>'+item.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+item.array_index+'"></a></li>'}
this.search_container.before(html);link=$('#'+choice_id).find("a").first();return link.click(function(evt){return _this.choice_destroy_link_click(evt)})};Chosen.prototype.choice_destroy_link_click=function(evt){evt.preventDefault();if(!this.is_disabled){this.pending_destroy_click=!0;return this.choice_destroy($(evt.target))}else{return evt.stopPropagation}};Chosen.prototype.choice_destroy=function(link){if(this.result_deselect(link.attr("rel"))){this.choices-=1;this.show_search_field_default();if(this.is_multiple&&this.choices>0&&this.search_field.val().length<1){this.results_hide()}
return link.parents('li').first().remove()}};Chosen.prototype.results_reset=function(){this.form_field.options[0].selected=!0;this.selected_item.find("span").text(this.default_text);if(!this.is_multiple)this.selected_item.addClass("chzn-default");this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()};Chosen.prototype.results_reset_cleanup=function(){this.current_value=this.form_field_jq.val();return this.selected_item.find("abbr").remove()};Chosen.prototype.result_select=function(evt){var high,high_id,item,position;if(this.result_highlight){high=this.result_highlight;high_id=high.attr("id");this.result_clear_highlight();if(this.is_multiple){this.result_deactivate(high)}else{this.search_results.find(".result-selected").removeClass("result-selected");this.result_single_selected=high;this.selected_item.removeClass("chzn-default")}
high.addClass("result-selected");position=high_id.substr(high_id.lastIndexOf("_")+1);item=this.results_data[position];item.selected=!0;this.form_field.options[item.options_index].selected=!0;if(this.is_multiple){this.choice_build(item)}else{this.selected_item.find("span").first().text(item.text);if(this.allow_single_deselect)this.single_deselect_control_build()}
if(!(evt.metaKey&&this.is_multiple))this.results_hide();this.search_field.val("");if(this.is_multiple||this.form_field_jq.val()!==this.current_value){this.form_field_jq.trigger("change",{'selected':this.form_field.options[item.options_index].value})}
this.current_value=this.form_field_jq.val();return this.search_field_scale()}};Chosen.prototype.result_activate=function(el){return el.addClass("active-result")};Chosen.prototype.result_deactivate=function(el){return el.removeClass("active-result")};Chosen.prototype.result_deselect=function(pos){var result,result_data;result_data=this.results_data[pos];if(!this.form_field.options[result_data.options_index].disabled){result_data.selected=!1;this.form_field.options[result_data.options_index].selected=!1;result=$("#"+this.container_id+"_o_"+pos);result.removeClass("result-selected").addClass("active-result").show();this.result_clear_highlight();this.winnow_results();this.form_field_jq.trigger("change",{deselected:this.form_field.options[result_data.options_index].value});this.search_field_scale();return!0}else{return!1}};Chosen.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1){return this.selected_item.find("span").first().after("<abbr class=\"search-choice-close\"></abbr>")}};Chosen.prototype.winnow_results=function(){var found,option,part,parts,regex,regexAnchor,result,result_id,results,searchText,startpos,text,zregex,_i,_j,_len,_len2,_ref;this.no_results_clear();results=0;searchText=this.search_field.val()===this.default_text?"":$('<div/>').text($.trim(this.search_field.val())).html();regexAnchor=this.search_contains?"":"^";regex=new RegExp(regexAnchor+searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),'i');zregex=new RegExp(searchText.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),'i');_ref=this.results_data;for(_i=0,_len=_ref.length;_i<_len;_i++){option=_ref[_i];if(!option.disabled&&!option.empty){if(option.group){$('#'+option.dom_id).css('display','none')}else if(!(this.is_multiple&&option.selected)){found=!1;result_id=option.dom_id;result=$("#"+result_id);if(regex.test(option.html)){found=!0;results+=1}else if(option.html.indexOf(" ")>=0||option.html.indexOf("[")===0){parts=option.html.replace(/\[|\]/g,"").split(" ");if(parts.length){for(_j=0,_len2=parts.length;_j<_len2;_j++){part=parts[_j];if(regex.test(part)){found=!0;results+=1}}}}
if(found){if(searchText.length){startpos=option.html.search(zregex);text=option.html.substr(0,startpos+searchText.length)+'</em>'+option.html.substr(startpos+searchText.length);text=text.substr(0,startpos)+'<em>'+text.substr(startpos)}else{text=option.html}
result.html(text);this.result_activate(result);if(option.group_array_index!=null){$("#"+this.results_data[option.group_array_index].dom_id).css('display','list-item')}}else{if(this.result_highlight&&result_id===this.result_highlight.attr('id')){this.result_clear_highlight()}
this.result_deactivate(result)}}}}
if(results<1&&searchText.length){return this.no_results(searchText)}else{return this.winnow_results_set_highlight()}};Chosen.prototype.winnow_results_clear=function(){var li,lis,_i,_len,_results;this.search_field.val("");lis=this.search_results.find("li");_results=[];for(_i=0,_len=lis.length;_i<_len;_i++){li=lis[_i];li=$(li);if(li.hasClass("group-result")){_results.push(li.css('display','auto'))}else if(!this.is_multiple||!li.hasClass("result-selected")){_results.push(this.result_activate(li))}else{_results.push(void 0)}}
return _results};Chosen.prototype.winnow_results_set_highlight=function(){var do_high,selected_results;if(!this.result_highlight){selected_results=!this.is_multiple?this.search_results.find(".result-selected.active-result"):[];do_high=selected_results.length?selected_results.first():this.search_results.find(".active-result").first();if(do_high!=null)return this.result_do_highlight(do_high)}};Chosen.prototype.no_results=function(terms){var no_results_html;no_results_html=$('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');no_results_html.find("span").first().html(terms);return this.search_results.append(no_results_html)};Chosen.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};Chosen.prototype.keydown_arrow=function(){var first_active,next_sib;if(!this.result_highlight){first_active=this.search_results.find("li.active-result").first();if(first_active)this.result_do_highlight($(first_active))}else if(this.results_showing){next_sib=this.result_highlight.nextAll("li.active-result").first();if(next_sib)this.result_do_highlight(next_sib)}
if(!this.results_showing)return this.results_show()};Chosen.prototype.keyup_arrow=function(){var prev_sibs;if(!this.results_showing&&!this.is_multiple){return this.results_show()}else if(this.result_highlight){prev_sibs=this.result_highlight.prevAll("li.active-result");if(prev_sibs.length){return this.result_do_highlight(prev_sibs.first())}else{if(this.choices>0)this.results_hide();return this.result_clear_highlight()}}};Chosen.prototype.keydown_backstroke=function(){var next_available_destroy;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}else{next_available_destroy=this.search_container.siblings("li.search-choice").last();if(next_available_destroy.length&&!next_available_destroy.hasClass("search-choice-disabled")){this.pending_backstroke=next_available_destroy;if(this.single_backstroke_delete){return this.keydown_backstroke()}else{return this.pending_backstroke.addClass("search-choice-focus")}}}};Chosen.prototype.clear_backstroke=function(){if(this.pending_backstroke){this.pending_backstroke.removeClass("search-choice-focus")}
return this.pending_backstroke=null};Chosen.prototype.keydown_checker=function(evt){var stroke,_ref;stroke=(_ref=evt.which)!=null?_ref:evt.keyCode;this.search_field_scale();if(stroke!==8&&this.pending_backstroke)this.clear_backstroke();switch(stroke){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:if(this.results_showing&&!this.is_multiple)this.result_select(evt);this.mouse_on_container=!1;break;case 13:evt.preventDefault();break;case 38:evt.preventDefault();this.keyup_arrow();break;case 40:this.keydown_arrow();break}};Chosen.prototype.search_field_scale=function(){var dd_top,div,h,style,style_block,styles,w,_i,_len;if(this.is_multiple){h=0;w=0;style_block="position:absolute; left: -1000px; top: -1000px; display:none;";styles=['font-size','font-style','font-weight','font-family','line-height','text-transform','letter-spacing'];for(_i=0,_len=styles.length;_i<_len;_i++){style=styles[_i];style_block+=style+":"+this.search_field.css(style)+";"}
div=$('<div />',{'style':style_block});div.text(this.search_field.val());$('body').append(div);w=div.width()+25;div.remove();if(w>this.f_width-10)w=this.f_width-10;this.search_field.css({'width':w+'px'});dd_top=this.container.height();return this.dropdown.css({"top":dd_top+"px"})}};Chosen.prototype.generate_random_id=function(){var string;string="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();while($("#"+string).length>0){string+=this.generate_random_char()}
return string};return Chosen})(root.AbstractChosen);get_side_border_padding=function(elmt){var side_border_padding;return side_border_padding=elmt.outerWidth()-elmt.width()};root.get_side_border_padding=get_side_border_padding}).call(globalChosen)};exports();module.resolveWith(exports)};FD40.module("chosen",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){;(function($){$.fn.drag=function(str,arg,opts){var type=typeof str=="string"?str:"",fn=$.isFunction(str)?str:$.isFunction(arg)?arg:null;if(type.indexOf("drag")!==0)
type="drag"+type;opts=(str==fn?arg:opts)||{};return fn?this.bind(type,opts,fn):this.trigger(type)};var $event=$.event,$special=$event.special,drag=$special.drag={defaults:{which:1,distance:0,not:':input',handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(obj){var data=$.data(this,drag.datakey),opts=obj.data||{};data.related+=1;$.each(drag.defaults,function(key,def){if(opts[key]!==undefined)
data[key]=opts[key]})},remove:function(){$.data(this,drag.datakey).related-=1},setup:function(){if($.data(this,drag.datakey))
return;var data=$.extend({related:0},drag.defaults);$.data(this,drag.datakey,data);$event.add(this,"touchstart mousedown",drag.init,data);if(this.attachEvent)
this.attachEvent("ondragstart",drag.dontstart)},teardown:function(){var data=$.data(this,drag.datakey)||{};if(data.related)
return;$.removeData(this,drag.datakey);$event.remove(this,"touchstart mousedown",drag.init);drag.textselect(!0);if(this.detachEvent)
this.detachEvent("ondragstart",drag.dontstart)},init:function(event){if(drag.touched)
return;var dd=event.data,results;if(event.which!=0&&dd.which>0&&event.which!=dd.which)
return;if($(event.target).is(dd.not))
return;if(dd.handle&&!$(event.target).closest(dd.handle,event.currentTarget).length)
return;drag.touched=event.type=='touchstart'?this:null;dd.propagates=1;dd.mousedown=this;dd.interactions=[drag.interaction(this,dd)];dd.target=event.target;dd.pageX=event.pageX;dd.pageY=event.pageY;dd.dragging=null;results=drag.hijack(event,"draginit",dd);if(!dd.propagates)
return;results=drag.flatten(results);if(results&&results.length){dd.interactions=[];$.each(results,function(){dd.interactions.push(drag.interaction(this,dd))})}
dd.propagates=dd.interactions.length;if(dd.drop!==!1&&$special.drop)
$special.drop.handler(event,dd);drag.textselect(!1);if(drag.touched)
$event.add(drag.touched,"touchmove touchend",drag.handler,dd);else $event.add(document,"mousemove mouseup",drag.handler,dd);if(!drag.touched||dd.live)
return!1},interaction:function(elem,dd){var offset=$(elem)[dd.relative?"position":"offset"]()||{top:0,left:0};return{drag:elem,callback:new drag.callback(),droppable:[],offset:offset}},handler:function(event){var dd=event.data;switch(event.type){case!dd.dragging&&'touchmove':event.preventDefault();case!dd.dragging&&'mousemove':if(Math.pow(event.pageX-dd.pageX,2)+Math.pow(event.pageY-dd.pageY,2)<Math.pow(dd.distance,2))
break;event.target=dd.target;drag.hijack(event,"dragstart",dd);if(dd.propagates)
dd.dragging=!0;case 'touchmove':event.preventDefault();case 'mousemove':if(dd.dragging){drag.hijack(event,"drag",dd);if(dd.propagates){if(dd.drop!==!1&&$special.drop)
$special.drop.handler(event,dd);break}
event.type="mouseup"}
case 'touchend':case 'mouseup':default:if(drag.touched)
$event.remove(drag.touched,"touchmove touchend",drag.handler);else $event.remove(document,"mousemove mouseup",drag.handler);if(dd.dragging){if(dd.drop!==!1&&$special.drop)
$special.drop.handler(event,dd);drag.hijack(event,"dragend",dd)}
drag.textselect(!0);if(dd.click===!1&&dd.dragging)
$.data(dd.mousedown,"suppress.click",new Date().getTime()+5);dd.dragging=drag.touched=!1;break}},hijack:function(event,type,dd,x,elem){if(!dd)
return;var orig={event:event.originalEvent,type:event.type},mode=type.indexOf("drop")?"drag":"drop",result,i=x||0,ia,$elems,callback,len=!isNaN(x)?x:dd.interactions.length;event.type=type;event.originalEvent=null;dd.results=[];do if(ia=dd.interactions[i]){if(type!=="dragend"&&ia.cancelled)
continue;callback=drag.properties(event,dd,ia);ia.results=[];$(elem||ia[mode]||dd.droppable).each(function(p,subject){callback.target=subject;event.isPropagationStopped=function(){return!1};result=subject?$event.dispatch.call(subject,event,callback):null;if(result===!1){if(mode=="drag"){ia.cancelled=!0;dd.propagates-=1}
if(type=="drop"){ia[mode][p]=null}}
else if(type=="dropinit")
ia.droppable.push(drag.element(result)||subject);if(type=="dragstart")
ia.proxy=$(drag.element(result)||ia.drag)[0];ia.results.push(result);delete event.result;if(type!=="dropinit")
return result});dd.results[i]=drag.flatten(ia.results);if(type=="dropinit")
ia.droppable=drag.flatten(ia.droppable);if(type=="dragstart"&&!ia.cancelled)
callback.update()}
while(++i<len)
event.type=orig.type;event.originalEvent=orig.event;return drag.flatten(dd.results)},properties:function(event,dd,ia){var obj=ia.callback;obj.drag=ia.drag;obj.proxy=ia.proxy||ia.drag;obj.startX=dd.pageX;obj.startY=dd.pageY;obj.deltaX=event.pageX-dd.pageX;obj.deltaY=event.pageY-dd.pageY;obj.originalX=ia.offset.left;obj.originalY=ia.offset.top;obj.offsetX=obj.originalX+obj.deltaX;obj.offsetY=obj.originalY+obj.deltaY;obj.drop=drag.flatten((ia.drop||[]).slice());obj.available=drag.flatten((ia.droppable||[]).slice());return obj},element:function(arg){if(arg&&(arg.jquery||arg.nodeType==1))
return arg},flatten:function(arr){return $.map(arr,function(member){return member&&member.jquery?$.makeArray(member):member&&member.length?drag.flatten(member):member})},textselect:function(bool){$(document)[bool?"unbind":"bind"]("selectstart",drag.dontstart).css("MozUserSelect",bool?"":"none");document.unselectable=bool?"off":"on"},dontstart:function(){return!1},callback:function(){}};drag.callback.prototype={update:function(){if($special.drop&&this.available.length)
$.each(this.available,function(i){$special.drop.locate(this,i)})}};var $dispatch=$event.dispatch;$event.dispatch=function(event){if($.data(this,"suppress."+event.type)-new Date().getTime()>0){$.removeData(this,"suppress."+event.type);return}
return $dispatch.apply(this,arguments)};var touchHooks=$event.fixHooks.touchstart=$event.fixHooks.touchmove=$event.fixHooks.touchend=$event.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(event,orig){if(orig){var touched=(orig.touches&&orig.touches[0])||(orig.changedTouches&&orig.changedTouches[0])||null;if(touched)
$.each(touchHooks.props,function(i,prop){event[prop]=touched[prop]})}
return event}};$special.draginit=$special.dragstart=$special.dragend=drag})(jQuery)};exports();module.resolveWith(exports)};FD40.module("event/drag",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){var toFix=['wheel','mousewheel','DOMMouseScroll','MozMousePixelScroll'];var toBind='onwheel' in document||document.documentMode>=9?['wheel']:['mousewheel','DomMouseScroll','MozMousePixelScroll'];var lowestDelta,lowestDeltaXY;if($.event.fixHooks){for(var i=toFix.length;i;){$.event.fixHooks[toFix[--i]]=$.event.mouseHooks}}
$.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var i=toBind.length;i;){this.addEventListener(toBind[--i],handler,!1)}}else{this.onmousewheel=handler}},teardown:function(){if(this.removeEventListener){for(var i=toBind.length;i;){this.removeEventListener(toBind[--i],handler,!1)}}else{this.onmousewheel=null}}};$.fn.extend({mousewheel:function(fn){return fn?this.bind("mousewheel",fn):this.trigger("mousewheel")},unmousewheel:function(fn){return this.unbind("mousewheel",fn)}});function handler(event){var orgEvent=event||window.event,args=[].slice.call(arguments,1),delta=0,deltaX=0,deltaY=0,absDelta=0,absDeltaXY=0,fn;event=$.event.fix(orgEvent);event.type="mousewheel";if(orgEvent.wheelDelta){delta=orgEvent.wheelDelta}
if(orgEvent.detail){delta=orgEvent.detail*-1}
if(orgEvent.deltaY){deltaY=orgEvent.deltaY*-1;delta=deltaY}
if(orgEvent.deltaX){deltaX=orgEvent.deltaX;delta=deltaX*-1}
if(orgEvent.wheelDeltaY!==undefined){deltaY=orgEvent.wheelDeltaY}
if(orgEvent.wheelDeltaX!==undefined){deltaX=orgEvent.wheelDeltaX*-1}
absDelta=Math.abs(delta);if(!lowestDelta||absDelta<lowestDelta){lowestDelta=absDelta}
absDeltaXY=Math.max(Math.abs(deltaY),Math.abs(deltaX));if(!lowestDeltaXY||absDeltaXY<lowestDeltaXY){lowestDeltaXY=absDeltaXY}
fn=delta>0?'floor':'ceil';delta=Math[fn](delta/lowestDelta);deltaX=Math[fn](deltaX/lowestDeltaXY);deltaY=Math[fn](deltaY/lowestDeltaXY);args.unshift(event,delta,deltaX,deltaY);return($.event.dispatch||$.event.handle).apply(this,args)}};exports();module.resolveWith(exports)};FD40.module("mousewheel",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){var elems=$([]),jq_resize=$.resize=$.extend($.resize,{}),timeout_id,str_setTimeout='setTimeout',str_resize='resize',str_data=str_resize+'-special-event',str_delay='delay',str_throttle='throttleWindow';jq_resize[str_delay]=250;jq_resize[str_throttle]=!0;$.event.special[str_resize]={setup:function(){if(!jq_resize[str_throttle]&&this[str_setTimeout]){return!1}
var elem=$(this);elems=elems.add(elem);$.data(this,str_data,{w:elem.width(),h:elem.height()});if(elems.length===1){loopy()}},teardown:function(){if(!jq_resize[str_throttle]&&this[str_setTimeout]){return!1}
var elem=$(this);elems=elems.not(elem);elem.removeData(str_data);if(!elems.length){clearTimeout(timeout_id)}},add:function(handleObj){if(!jq_resize[str_throttle]&&this[str_setTimeout]){return!1}
var old_handler;function new_handler(e,w,h){var elem=$(this),data=$.data(this,str_data);if(data==null){data={w:null,h:null}}
data.w=w!==undefined?w:elem.width();data.h=h!==undefined?h:elem.height();old_handler.apply(this,arguments)};if($.isFunction(handleObj)){old_handler=handleObj;return new_handler}else{old_handler=handleObj.handler;handleObj.handler=new_handler}}};function loopy(){timeout_id=window[str_setTimeout](function(){elems.each(function(){var elem=$(this),width=elem.width(),height=elem.height(),data=$.data(this,str_data);if(width!==data.w||height!==data.h){elem.trigger(str_resize,[data.w=width,data.h=height])}});loopy()},jq_resize[str_delay])}};exports();module.resolveWith(exports)};FD40.module("resize",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){$.expandingTextarea=$.extend({autoInitialize:!0,initialSelector:"textarea.expanding",opts:{resize:function(){}}},$.expandingTextarea||{});var cloneCSSProperties=['lineHeight','textDecoration','letterSpacing','fontSize','fontFamily','fontStyle','fontWeight','textTransform','textAlign','direction','wordSpacing','fontSizeAdjust','wordWrap','word-break','borderLeftWidth','borderRightWidth','borderTopWidth','borderBottomWidth','paddingLeft','paddingRight','paddingTop','paddingBottom','marginLeft','marginRight','marginTop','marginBottom','boxSizing','webkitBoxSizing','mozBoxSizing','msBoxSizing'];var textareaCSS={position:"absolute",height:"100%",resize:"none"};var preCSS={visibility:"hidden",border:"0 solid",whiteSpace:"pre-wrap"};var containerCSS={position:"relative"};function resize(){var clone=$(this).data("textareaClone");clone.find("div").text(this.value.replace(/\r\n/g,"\n")+' ');$(this).trigger("resize.expanding")}
$.fn.expandingTextarea=function(o){var opts=$.extend({},$.expandingTextarea.opts,o);if(o==="resize"){return this.trigger("input.expanding")}
if(o==="destroy"){this.filter(".expanding-init").each(function(){var textarea=$(this).removeClass('expanding-init');textarea.attr('style',textarea.data('expanding-styles')||'').removeData('expanding-styles')});return this}
this.filter("textarea").not(".expanding-init").addClass("expanding-init").each(function(){var textarea=$(this),container=textarea.parent(),clone=$($.parseHTML("<pre class='textareaClone'><div></div></pre>"));textarea.after(clone).data("textareaClone",clone);container.css(containerCSS);textarea.data('expanding-styles',textarea.attr('style'));textarea.css(textareaCSS);clone.css(preCSS);$.each(cloneCSSProperties,function(i,p){var val=textarea.css(p);if(clone.css(p)!==val){clone.css(p,val)}});textarea.bind("input.expanding propertychange.expanding keyup.expanding",resize);resize.apply(this);if(opts.resize){textarea.bind("resize.expanding",opts.resize)}});return this};$(function(){if($.expandingTextarea.autoInitialize){$($.expandingTextarea.initialSelector).expandingTextarea()}})};exports();module.resolveWith(exports)};FD40.module("expanding",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function($,undefined){var uuid=0,runiqueId=/^ui-id-\d+$/;$.ui=$.ui||{};$.extend($.ui,{version:"1.10.4pre",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}});$.fn.extend({focus:(function(orig){return function(delay,fn){return typeof delay==="number"?this.each(function(){var elem=this;setTimeout(function(){$(elem).focus();if(fn){fn.call(elem)}},delay)}):orig.apply(this,arguments)}})($.fn.focus),scrollParent:function(){var scrollParent;if(($.ui.ie&&(/(static|relative)/).test(this.css("position")))||(/absolute/).test(this.css("position"))){scrollParent=this.parents().filter(function(){return(/(relative|absolute|fixed)/).test($.css(this,"position"))&&(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0)}else{scrollParent=this.parents().filter(function(){return(/(auto|scroll)/).test($.css(this,"overflow")+$.css(this,"overflow-y")+$.css(this,"overflow-x"))}).eq(0)}
return(/fixed/).test(this.css("position"))||!scrollParent.length?$(document):scrollParent},zIndex:function(zIndex){if(zIndex!==undefined){return this.css("zIndex",zIndex)}
if(this.length){var elem=$(this[0]),position,value;while(elem.length&&elem[0]!==document){position=elem.css("position");if(position==="absolute"||position==="relative"||position==="fixed"){value=parseInt(elem.css("zIndex"),10);if(!isNaN(value)&&value!==0){return value}}
elem=elem.parent()}}
return 0},uniqueId:function(){return this.each(function(){if(!this.id){this.id="ui-id-"+(++uuid)}})},removeUniqueId:function(){return this.each(function(){if(runiqueId.test(this.id)){$(this).removeAttr("id")}})}});function focusable(element,isTabIndexNotNaN){var map,mapName,img,nodeName=element.nodeName.toLowerCase();if("area"===nodeName){map=element.parentNode;mapName=map.name;if(!element.href||!mapName||map.nodeName.toLowerCase()!=="map"){return!1}
img=$("img[usemap=#"+mapName+"]")[0];return!!img&&visible(img)}
return(/input|select|textarea|button|object/.test(nodeName)?!element.disabled:"a"===nodeName?element.href||isTabIndexNotNaN:isTabIndexNotNaN)&&visible(element)}
function visible(element){return $.expr.filters.visible(element)&&!$(element).parents().addBack().filter(function(){return $.css(this,"visibility")==="hidden"}).length}
$.extend($.expr[":"],{data:$.expr.createPseudo?$.expr.createPseudo(function(dataName){return function(elem){return!!$.data(elem,dataName)}}):function(elem,i,match){return!!$.data(elem,match[3])},focusable:function(element){return focusable(element,!isNaN($.attr(element,"tabindex")))},tabbable:function(element){var tabIndex=$.attr(element,"tabindex"),isTabIndexNaN=isNaN(tabIndex);return(isTabIndexNaN||tabIndex>=0)&&focusable(element,!isTabIndexNaN)}});if(!$("<a>").outerWidth(1).jquery){$.each(["Width","Height"],function(i,name){var side=name==="Width"?["Left","Right"]:["Top","Bottom"],type=name.toLowerCase(),orig={innerWidth:$.fn.innerWidth,innerHeight:$.fn.innerHeight,outerWidth:$.fn.outerWidth,outerHeight:$.fn.outerHeight};function reduce(elem,size,border,margin){$.each(side,function(){size-=parseFloat($.css(elem,"padding"+this))||0;if(border){size-=parseFloat($.css(elem,"border"+this+"Width"))||0}
if(margin){size-=parseFloat($.css(elem,"margin"+this))||0}});return size}
$.fn["inner"+name]=function(size){if(size===undefined){return orig["inner"+name].call(this)}
return this.each(function(){$(this).css(type,reduce(this,size)+"px")})};$.fn["outer"+name]=function(size,margin){if(typeof size!=="number"){return orig["outer"+name].call(this,size)}
return this.each(function(){$(this).css(type,reduce(this,size,!0,margin)+"px")})}})}
if(!$.fn.addBack){$.fn.addBack=function(selector){return this.add(selector==null?this.prevObject:this.prevObject.filter(selector))}}
if($("<a>").data("a-b","a").removeData("a-b").data("a-b")){$.fn.removeData=(function(removeData){return function(key){if(arguments.length){return removeData.call(this,$.camelCase(key))}else{return removeData.call(this)}}})($.fn.removeData)}
$.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase());$.support.selectstart="onselectstart" in document.createElement("div");$.fn.extend({disableSelection:function(){return this.bind(($.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(event){event.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}});$.extend($.ui,{plugin:{add:function(module,option,set){var i,proto=$.ui[module].prototype;for(i in set){proto.plugins[i]=proto.plugins[i]||[];proto.plugins[i].push([option,set[i]])}},call:function(instance,name,args){var i,set=instance.plugins[name];if(!set||!instance.element[0].parentNode||instance.element[0].parentNode.nodeType===11){return}
for(i=0;i<set.length;i++){if(instance.options[set[i][0]]){set[i][1].apply(instance.element,args)}}}},hasScroll:function(el,a){if($(el).css("overflow")==="hidden"){return!1}
var scroll=(a&&a==="left")?"scrollLeft":"scrollTop",has=!1;if(el[scroll]>0){return!0}
el[scroll]=1;has=(el[scroll]>0);el[scroll]=0;return has}});$(function(){if($("body > [id=fd].ui").length>0)return;$(document.createElement("div")).attr("id","fd").addClass("ui").css({position:"absolute",top:0,left:0,overflow:"visible",width:0,height:0,zIndex:10002}).appendTo("body")})})(jQuery)};exports();module.resolveWith(exports)};FD40.module("ui/core",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;$.require().script("ui/widget").done(function(){var exports=function(){(function($,undefined){var mouseHandled=!1;$(document).mouseup(function(){mouseHandled=!1});$.widget("ui.mouse",{version:"1.10.4pre",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var that=this;this.element.bind("mousedown."+this.widgetName,function(event,eventOverride){return that._mouseDown(eventOverride||event)}).bind("click."+this.widgetName,function(event){if(!0===$.data(event.target,that.widgetName+".preventClickEvent")){$.removeData(event.target,that.widgetName+".preventClickEvent");event.stopImmediatePropagation();return!1}});this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName);if(this._mouseMoveDelegate){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)}},_mouseDown:function(event){if(mouseHandled){return}(this._mouseStarted&&this._mouseUp(event));this._mouseDownEvent=event;var that=this,btnIsLeft=(event.which===1),elIsCancel=(typeof this.options.cancel==="string"&&event.target.nodeName?$(event.target).closest(this.options.cancel).length:!1);if(!btnIsLeft||elIsCancel||!this._mouseCapture(event)){return!0}
this.mouseDelayMet=!this.options.delay;if(!this.mouseDelayMet){this._mouseDelayTimer=setTimeout(function(){that.mouseDelayMet=!0},this.options.delay)}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(event)!==!1);if(!this._mouseStarted){event.preventDefault();return!0}}
if(!0===$.data(event.target,this.widgetName+".preventClickEvent")){$.removeData(event.target,this.widgetName+".preventClickEvent")}
this._mouseMoveDelegate=function(event){return that._mouseMove(event)};this._mouseUpDelegate=function(event){return that._mouseUp(event)};$(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate);event.preventDefault();mouseHandled=!0;return!0},_mouseMove:function(event){if($.ui.ie&&(!document.documentMode||document.documentMode<9)&&!event.button){return this._mouseUp(event)}
if(this._mouseStarted){this._mouseDrag(event);return event.preventDefault()}
if(this._mouseDistanceMet(event)&&this._mouseDelayMet(event)){this._mouseStarted=(this._mouseStart(this._mouseDownEvent,event)!==!1);(this._mouseStarted?this._mouseDrag(event):this._mouseUp(event))}
return!this._mouseStarted},_mouseUp:function(event){$(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate);if(this._mouseStarted){this._mouseStarted=!1;if(event.target===this._mouseDownEvent.target){$.data(event.target,this.widgetName+".preventClickEvent",!0)}
this._mouseStop(event)}
return!1},_mouseDistanceMet:function(event){return(Math.max(Math.abs(this._mouseDownEvent.pageX-event.pageX),Math.abs(this._mouseDownEvent.pageY-event.pageY))>=this.options.distance)},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})})(jQuery)};exports();module.resolveWith(exports)})};FD40.module("ui/mouse",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function($,undefined){var uuid=0,slice=Array.prototype.slice,_cleanData=$.cleanData;$.cleanData=function(elems){for(var i=0,elem;(elem=elems[i])!=null;i++){try{$(elem).triggerHandler("remove")}catch(e){}}
_cleanData(elems)};$.widget=function(name,base,prototype){var fullName,existingConstructor,constructor,basePrototype,proxiedPrototype={},namespace=name.split(".")[0];name=name.split(".")[1];fullName=namespace+"-"+name;if(!prototype){prototype=base;base=$.Widget}
$.expr[":"][fullName.toLowerCase()]=function(elem){return!!$.data(elem,fullName)};$[namespace]=$[namespace]||{};existingConstructor=$[namespace][name];constructor=$[namespace][name]=function(options,element){if(!this._createWidget){return new constructor(options,element)}
if(arguments.length){this._createWidget(options,element)}};$.extend(constructor,existingConstructor,{version:prototype.version,_proto:$.extend({},prototype),_childConstructors:[]});basePrototype=new base();basePrototype.options=$.widget.extend({},basePrototype.options);$.each(prototype,function(prop,value){if(!$.isFunction(value)){proxiedPrototype[prop]=value;return}
proxiedPrototype[prop]=(function(){var _super=function(){return base.prototype[prop].apply(this,arguments)},_superApply=function(args){return base.prototype[prop].apply(this,args)};return function(){var __super=this._super,__superApply=this._superApply,returnValue;this._super=_super;this._superApply=_superApply;returnValue=value.apply(this,arguments);this._super=__super;this._superApply=__superApply;return returnValue}})()});constructor.prototype=$.widget.extend(basePrototype,{widgetEventPrefix:existingConstructor?basePrototype.widgetEventPrefix:name},proxiedPrototype,{constructor:constructor,namespace:namespace,widgetName:name,widgetFullName:fullName});if(existingConstructor){$.each(existingConstructor._childConstructors,function(i,child){var childPrototype=child.prototype;$.widget(childPrototype.namespace+"."+childPrototype.widgetName,constructor,child._proto)});delete existingConstructor._childConstructors}else{base._childConstructors.push(constructor)}
$.widget.bridge(name,constructor)};$.widget.extend=function(target){var input=slice.call(arguments,1),inputIndex=0,inputLength=input.length,key,value;for(;inputIndex<inputLength;inputIndex++){for(key in input[inputIndex]){value=input[inputIndex][key];if(input[inputIndex].hasOwnProperty(key)&&value!==undefined){if($.isPlainObject(value)){target[key]=$.isPlainObject(target[key])?$.widget.extend({},target[key],value):$.widget.extend({},value)}else{target[key]=value}}}}
return target};$.widget.bridge=function(name,object){var fullName=object.prototype.widgetFullName||name;$.fn[name]=function(options){var isMethodCall=typeof options==="string",args=slice.call(arguments,1),returnValue=this;options=!isMethodCall&&args.length?$.widget.extend.apply(null,[options].concat(args)):options;if(isMethodCall){this.each(function(){var methodValue,instance=$.data(this,fullName);if(!instance){return $.error("cannot call methods on "+name+" prior to initialization; "+"attempted to call method '"+options+"'")}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){return $.error("no such method '"+options+"' for "+name+" widget instance")}
methodValue=instance[options].apply(instance,args);if(methodValue!==instance&&methodValue!==undefined){returnValue=methodValue&&methodValue.jquery?returnValue.pushStack(methodValue.get()):methodValue;return!1}})}else{this.each(function(){var instance=$.data(this,fullName);if(instance){instance.option(options||{})._init()}else{$.data(this,fullName,new object(options,this))}})}
return returnValue}};$.Widget=function(){};$.Widget._childConstructors=[];$.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(options,element){element=$(element||this.defaultElement||this)[0];this.element=$(element);this.uuid=uuid++;this.eventNamespace="."+this.widgetName+this.uuid;this.options=$.widget.extend({},this.options,this._getCreateOptions(),options);this.bindings=$();this.hoverable=$();this.focusable=$();if(element!==this){$.data(element,this.widgetFullName,this);this._on(!0,this.element,{remove:function(event){if(event.target===element){this.destroy()}}});this.document=$(element.style?element.ownerDocument:element.document||element);this.window=$(this.document[0].defaultView||this.document[0].parentWindow)}
this._create();this._trigger("create",null,this._getCreateEventData());this._init()},_getCreateOptions:$.noop,_getCreateEventData:$.noop,_create:$.noop,_init:$.noop,destroy:function(){this._destroy();this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData($.camelCase(this.widgetFullName));this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled "+"ui-state-disabled");this.bindings.unbind(this.eventNamespace);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")},_destroy:$.noop,widget:function(){return this.element},option:function(key,value){var options=key,parts,curOption,i;if(arguments.length===0){return $.widget.extend({},this.options)}
if(typeof key==="string"){options={};parts=key.split(".");key=parts.shift();if(parts.length){curOption=options[key]=$.widget.extend({},this.options[key]);for(i=0;i<parts.length-1;i++){curOption[parts[i]]=curOption[parts[i]]||{};curOption=curOption[parts[i]]}
key=parts.pop();if(value===undefined){return curOption[key]===undefined?null:curOption[key]}
curOption[key]=value}else{if(value===undefined){return this.options[key]===undefined?null:this.options[key]}
options[key]=value}}
this._setOptions(options);return this},_setOptions:function(options){var key;for(key in options){this._setOption(key,options[key])}
return this},_setOption:function(key,value){this.options[key]=value;if(key==="disabled"){this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!value).attr("aria-disabled",value);this.hoverable.removeClass("ui-state-hover");this.focusable.removeClass("ui-state-focus")}
return this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(suppressDisabledCheck,element,handlers){var delegateElement,instance=this;if(typeof suppressDisabledCheck!=="boolean"){handlers=element;element=suppressDisabledCheck;suppressDisabledCheck=!1}
if(!handlers){handlers=element;element=this.element;delegateElement=this.widget()}else{element=delegateElement=$(element);this.bindings=this.bindings.add(element)}
$.each(handlers,function(event,handler){function handlerProxy(){if(!suppressDisabledCheck&&(instance.options.disabled===!0||$(this).hasClass("ui-state-disabled"))){return}
return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}
if(typeof handler!=="string"){handlerProxy.guid=handler.guid=handler.guid||handlerProxy.guid||$.guid++}
var match=event.match(/^(\w+)\s*(.*)$/),eventName=match[1]+instance.eventNamespace,selector=match[2];if(selector){delegateElement.delegate(selector,eventName,handlerProxy)}else{element.bind(eventName,handlerProxy)}})},_off:function(element,eventName){eventName=(eventName||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace;element.unbind(eventName).undelegate(eventName)},_delay:function(handler,delay){function handlerProxy(){return(typeof handler==="string"?instance[handler]:handler).apply(instance,arguments)}
var instance=this;return setTimeout(handlerProxy,delay||0)},_hoverable:function(element){this.hoverable=this.hoverable.add(element);this._on(element,{mouseenter:function(event){$(event.currentTarget).addClass("ui-state-hover")},mouseleave:function(event){$(event.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(element){this.focusable=this.focusable.add(element);this._on(element,{focusin:function(event){$(event.currentTarget).addClass("ui-state-focus")},focusout:function(event){$(event.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(type,event,data){var prop,orig,callback=this.options[type];data=data||{};event=$.Event(event);event.type=(type===this.widgetEventPrefix?type:this.widgetEventPrefix+type).toLowerCase();event.target=this.element[0];orig=event.originalEvent;if(orig){for(prop in orig){if(!(prop in event)){event[prop]=orig[prop]}}}
this.element.trigger(event,data);return!($.isFunction(callback)&&callback.apply(this.element[0],[event].concat(data))===!1||event.isDefaultPrevented())}};$.each({show:"fadeIn",hide:"fadeOut"},function(method,defaultEffect){$.Widget.prototype["_"+method]=function(element,options,callback){if(typeof options==="string"){options={effect:options}}
var hasOptions,effectName=!options?method:options===!0||typeof options==="number"?defaultEffect:options.effect||defaultEffect;options=options||{};if(typeof options==="number"){options={duration:options}}
hasOptions=!$.isEmptyObject(options);options.complete=callback;if(options.delay){element.delay(options.delay)}
if(hasOptions&&$.effects&&$.effects.effect[effectName]){element[method](options)}else if(effectName!==method&&element[effectName]){element[effectName](options.duration,options.easing,callback)}else{element.queue(function(next){$(this)[method]();if(callback){callback.call(element[0])}
next()})}}})})(jQuery)};exports();module.resolveWith(exports)};FD40.module("ui/widget",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;$.require().script("autosize.input","scrollTo").done(function(){var exports=function(){var KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};$.template("textboxlist/item",'<div class="textboxlist-item[%== (this.locked) ? " is-locked" : "" %]" data-textboxlist-item><span class="textboxlist-itemContent" data-textboxlist-itemContent>[%== html %]</span><div class="textboxlist-itemRemoveButton" data-textboxlist-itemRemoveButton><i class="ies-cancel-2"></i></a></div>');$.template("textboxlist/itemContent",'[%= title %]<input type="hidden" name="[%= name %]" value="[%= id %]"/>');$.Controller("Textboxlist",{pluginName:"textboxlist",hostname:"textboxlist",defaultOptions:{view:{item:'textboxlist/item',itemContent:'textboxlist/itemContent'},plugin:{},name:"items[]",unique:!0,caseSensitive:!1,max:null,ignoreLocked:!1,filterItem:null,"{item}":"[data-textboxlist-item]","{itemContent}":"[data-textboxlist-itemContent]","{itemRemoveButton}":"[data-textboxlist-itemRemoveButton]","{textField}":"[data-textboxlist-textField]"}},function(self){return{init:function(){var textField=self.textField();textField.autosizeInput();textField.data("placeholderText",textField.attr("placeholder"));var name=textField.data("textboxlistName");if(name){self.options.name=name}
self.item().each(function(){var item=$(this),itemContent=item.find(self.itemContent.selector);self.createItem({id:item.data("id")||(function(){var id=$.uid("item-");item.data("id",id);return id})(),title:item.data("title")||$.trim(itemContent.text()),locked:item.hasClass("is-locked"),html:itemContent.html()})});if(self.options.plugin.autocomplete||self.element.data("query")){self.addPlugin("autocomplete")}
self.on("keypress",self.textField(),function(event){if(event.keyCode==KEYCODE.ENTER)return event.preventDefault()})},setLayout:function(){var textField=self.textField(),placeholderText=textField.data("placeholderText");if(self.item().length>0){placeholderText=""}
textField.attr("placeholder",placeholderText).data("autosizeInputInstance").update()},enable:function(){self.element.removeClass("disabled");self.textField().enabled(!0)},disable:function(){self.element.addClass("disabled");self.textField().disabled(!0)},items:{},itemsByTitle:{},get:function(title){var key=self.getItemKey(title);if(self.itemsByTitle.hasOwnProperty(key)){return self.itemsByTitle[key]}},getItemKey:function(title){return(self.options.caseSensitive)?title:title.toLowerCase()},filterItem:function(item){var options=self.options;var filterItem=options.filterItem;if($.isFunction(filterItem)){item=filterItem.call(self,item)}
var items=self.itemsByTitle;if($.isString(item)&&item!==""){var title=item,key=self.getItemKey(title);item=(items.hasOwnProperty(key))?self.itemsByTitle[key]:{id:$.uid("item-"),title:title,key:self.getItemKey(title),locked:!1}}
item.name=item.name||self.options.name;item.html=item.html||self.view.itemContent(!0,item);return item},createItem:function(item){item.key=self.getItemKey(item.title);self.items[item.id]=item;self.itemsByTitle[item.key]=item},deleteItem:function(id){var item=self.items[id];self.item().filterBy("id",id).remove();delete self.items[id];var key=(self.options.caseSensitive)?item.title:item.title.toLowerCase();delete self.itemsByTitle[key]},addItem:function(item,force){if(!item)return;var options=self.options;var max=options.max;if(!force&&max!==null&&(options.ignoreLocked?self.item(":not(.is-locked)"):self.item()).length>=max)return;item=self.filterItem(item);if(!$.isPlainObject(item))return;var itemEl,existingItemEl=self.item().filterBy("id",item.id);if(options.unique&&existingItemEl.length>0){itemEl=existingItemEl}
if(!itemEl){itemEl=self.view.item(item).addClass(item.className||"").attr("data-id",item.id)}
self.createItem(item);if(item.locked){var lastLockedItem=self.item(".is-locked:last");if(lastLockedItem.length>0){itemEl.insertAfter(lastLockedItem)}else{itemEl.prependTo(self.element)}}else{itemEl.insertBefore(self.textField())}
self.trigger("addItem",[item]);self.trigger("listChange");return item},removeItem:function(id){var item=self.items[id];self.deleteItem(id);self.trigger("removeItem",[item]);self.trigger("listChange")},clearItems:function(){self.item().each(function(){self.removeItem($(this).data("id"))})},getAddedItems:function(){var addedItems=[];self.item().each(function(){var item=$(this),id=item.data("id");addedItems.push(self.items[id])});return addedItems},"{self} addItem":function(){self.setLayout()},"{self} removeItem":function(){self.setLayout()},"{itemRemoveButton} click":function(button){var item=button.parents(self.item.selector);self.removeItem(item.data("id"))},"{textField} keydown":function(textField,event)
{var keyCode=event.keyCode;textField.data("realEnterKey",keyCode==KEYCODE.ENTER)},"{textField} keypress":function(textField,event)
{var keydownIsEnter=textField.data("realEnterKey"),keypressIsEnter=event.keyCode==KEYCODE.ENTER;textField.data("realEnterKey",keydownIsEnter&&keypressIsEnter);var keyword=$.trim(self.textField().val());switch(event.keyCode){case KEYCODE.ENTER:if(textField.data("realEnterKey")){var event=self.trigger("useItem",[keyword]),item=event.item;if(item===undefined){item=keyword}
if(item===!1||item===null)return;self.addItem(item);textField.val("")}
break}},"{textField} keyup":function(textField,event)
{var item=$.trim(self.textField().val());var canRemoveItemUsingBackspace="canRemoveItemUsingBackspace";switch(event.keyCode){case KEYCODE.BACKSPACE:if(item===""){if(!self[canRemoveItemUsingBackspace]){self[canRemoveItemUsingBackspace]=!0}else{var prevItem=textField.prev(self.item.selector);if(prevItem.length>0){var id=prevItem.data("id"),item=self.items[id];!item.locked&&self.removeItem(id)}}}
break;default:self[canRemoveItemUsingBackspace]=!1;break}},"{self} click":function(el,event){var textField=self.textField();if(!textField.is(event.target)){textField.focus()}},"{textField} focusin":function(){if(self.activated)return;self.activated=!0;self.trigger("textboxlistActivate")},"{self} mousedown":function(){self.focusing=!0},"{self} mouseup":function(){self.focusing=!1},"{self} focusout":function(){if(self.focusing)return;self.activated=!1;self.deactivateTimer=setTimeout(function(){if(self.activated)return;self.trigger("textboxlistDeactivate")},1)}}});$(document).on('click.textboxlist.data-api','[data-textboxlist]',function(event){$(this).addController($.Controller.Textboxlist).textField().focus()}).on('focus.textboxlist.data-api','[data-textboxlist] [data-textboxlist-textField]',function(event){$(this).parents("[data-textboxlist]").addController($.Controller.Textboxlist)});$.template("textboxlist/menu",'<div id="fd" class="textboxlist-autocomplete" data-textboxlist-autocomplete><b><b></b></b><div class="textboxlist-autocomplete-inner" data-textboxlist-autocomplete-viewport><div class="textboxlist-autocomplete-loading" data-textboxlist-autocomplete-loading></div><div class="textboxlist-autocomplete-empty" data-textboxlist-autocomplete-empty></div><ul class="textboxlist-menu" data-textboxlist-menu></ul></div></div>');$.template("textboxlist/menuItem",'<li class="textboxlist-menuItem" data-textboxlist-menuItem>[%== html %]</li>');$.template("textboxlist/loadingHint",'<i class="textboxlist-autocomplete-loading-indicator"></i>');$.template("textboxlist/emptyHint",'<span class="textboxlist-autocomplete-empty-text">No items found.</span>');$.Controller("Textboxlist.Autocomplete",{defaultOptions:{view:{menu:"textboxlist/menu",menuItem:"textboxlist/menuItem",loadingHint:"textboxlist/loadingHint",emptyHint:"textboxlist/emptyHint"},cache:!0,minLength:1,limit:10,highlight:!0,caseSensitive:!1,exclusive:!1,query:null,position:{my:'left top',at:'left bottom',collision:'none'},filterItem:null,showEmptyHint:!1,showLoadingHint:!1,id:"fd",component:"",modifier:"",shadow:!1,sticky:!1,animation:!1,"{menu}":"[data-textboxlist-menu]","{menuItem}":"[data-textboxlist-menuItem]","{viewport}":"[data-textboxlist-autocomplete-viewport]","{loadingHint}":"[data-textboxlist-autocomplete-loading]","{emptyHint}":"[data-textboxlist-autocomplete-empty]"}},function(self,opts,base){return{init:function(){if(!self.element.data(self.Class.fullName)){self.destroy();self.view.menu().attr("id",opts.id).addClass(opts.component).addClass(opts.modifier).addClass(opts.shadow?'has-shadow':'').addClass(opts.animation?'has-animation':'').addClass(opts.sticky?'is-sticky':'').addClass(self.textboxlist.options.component).appendTo("body").data(self.Class.fullName,!0).addController(self.Class,self.options);return}
var textboxlist=self.textboxlist;textboxlist.autocomplete=self;textboxlist.pluginInstances.autocomplete=self;self.options.position.of=self.textboxlist.element;self.initQuery();self.view.loadingHint().appendTo(self.loadingHint());self.view.emptyHint().appendTo(self.emptyHint());self.element.detach()},initQuery:function(){var query=self.options.query||self.textboxlist.element.data("query");if($.isUrl(query)){var url=query;self.query=function(keyword){return $.ajax(url+keyword)}
return}
if($.isFunction(query)){var func=query;self.query=function(keyword){return func.call(self,keyword)}
return}
if($.isArray(query)){var dataset=query;self.query=function(keyword){var task=$.Deferred(),keyword=keyword.toLowerCase();setTimeout(function(){var result=$.grep(dataset,function(item){return item.title.toLowerCase().indexOf(keyword)>-1});task.resolve(result)},0);return task}
return}},setLayout:function(){if(!self.hidden){self.element.css({opacity:1,width:self.textboxlist.element.outerWidth()}).position(self.options.position)}},"{window} resize":$.debounce(function(){self.element.css("opacity",0);self.setLayout()},250),"{window} scroll":$.debounce(function(){self.element.css("opacity",0);self.setLayout()},250),"{window} dialogTransitionStart":function(){self.hidden=!0;self.element.css("opacity",0)},"{window} dialogTransitionEnd":function(){self.hidden=!1;self.setLayout()},show:function(){clearTimeout(self.sleep);self.element.appendTo("body").show();self.hidden=!1;self.setLayout()},hide:function(){self.element.hide();var menuItem=self.menuItem(),activeMenuItem=menuItem.filter(".active");if(activeMenuItem.length>0){self.lastItem={keyword:$.trim(self.textboxlist.textField().val()),item:activeMenuItem.data("item")}}
menuItem.removeClass("active");self.render.reset();self.hidden=!0;clearTimeout(self.sleep);self.sleep=setTimeout(function(){self.element.detach()},3000)},queries:{},populated:!1,populate:function(keyword){self.populated=!1;var element=self.element,options=self.options;element.removeClass("loading empty");if(options.showLoadingHint){self.hide()}
var event=self.trigger("populateKeyword",[keyword]);if(event.keyword){keyword=event.keyword};var key=(options.caseSensitive)?keyword:keyword.toLowerCase(),query=self.queries[key];var newQuery=!$.isDeferred(query)||!self.options.cache,runQuery=function(){if(options.showLoadingHint){element.addClass("loading");self.show()}
if(newQuery||(!newQuery&&query.state()=="rejected")){query=self.queries[key]=self.query(keyword)}
query.done(self.render(function(items){return[items,keyword]})).fail(function(){self.hide()}).always(function(){element.removeClass("loading")});self.trigger("queryKeyword",[query,keyword])}
if(newQuery){clearTimeout(self.queryTask);self.queryTask=setTimeout(runQuery,250)}else{runQuery()}},populateTask:null,populateFromTextField:function(){clearTimeout(self.populateTask);self.populateTask=setTimeout(function(){var textField=self.textboxlist.textField(),keyword=$.trim(textField.val());if(keyword===""||(keyword.length<self.options.minLength)){self.hide()}else{self.populate(keyword)}},1)},render:$.Enqueue(function(items,keyword){if(!$.isArray(items)){items=[]};var textboxlist=self.textboxlist,autocomplete=self,element=self.element,options=self.options,menu=self.menu();if(items.length<1){if(options.showEmptyHint){menu.empty();element.addClass("empty");textboxlist.trigger("renderMenu",[menu,autocomplete,textboxlist]);self.show()}else{self.hide()}
return}
element.removeClass("empty");if(!options.cache||menu.data("keyword")!==keyword){menu.empty();$.each(items,function(i,item){textboxlist.trigger("filterItem",[item,autocomplete,textboxlist]);var filterItem=options.filterItem;if($.isFunction(filterItem)){item=filterItem.call(self,item,keyword)}
if(!$.isPlainObject(item)||item.discard)return;var html=item.menuHtml||item.title;self.view.menuItem({html:html}).addClass(item.className||"").data("item",item).appendTo(menu)});menu.data("keyword",keyword)}
var menuItems=self.menuItem();textboxlist.trigger("filterMenu",[menu,menuItems,autocomplete,textboxlist]);if(menuItems.filter(":not(.hidden)").length<1){element.addClass("empty");if(!options.showEmptyHint){return self.hide()}}
if(options.exclusive){self.menuItem(":not(.hidden):first").addClass("active")}
textboxlist.trigger("renderMenu",[menu,autocomplete,textboxlist]);self.show()}),"{textboxlist.textField} keydown":function(textField,event){clearTimeout(self.sleep);var activeMenuItem=self.menuItem(".active:not(.hidden)");if(activeMenuItem.length<1){activeMenuItem=!1}
var textField=self.textboxlist.textField();switch(event.keyCode){case KEYCODE.UP:self.menuItem().removeClass("active");if(!activeMenuItem){self.menuItem(":not(.hidden):last").addClass("active")}else{activeMenuItem.prev(self.menuItem.selector+':not(.hidden)').addClass("active")}
event.preventDefault();break;case KEYCODE.DOWN:self.menuItem().removeClass("active");if(!activeMenuItem){self.menuItem(":not(.hidden):first").addClass("active")}else{activeMenuItem.next(self.menuItem.selector+':not(.hidden)').addClass("active")}
event.preventDefault();break;case KEYCODE.ESCAPE:self.hide();break;case KEYCODE.ENTER:break;default:self.populateFromTextField();break}
var activeMenuItem=self.menuItem(".active:not(.hidden)");if(activeMenuItem.length<1){return}else{}
self.viewport().scrollIntoView(activeMenuItem)},"{textboxlist} textboxlistActivate":function(textboxlist){self.populateFromTextField()},"{textboxlist} textboxlistDeactivate":function(textboxlist){setTimeout(function(){self.hide()},150)},"{textboxlist} destroyed":function(){self.element.remove()},"{textboxlist} useItem":function(textField,event,keyword){var exclusive=self.options.exclusive;if(exclusive)event.item=!1;if(self.hidden){var lastItem=self.lastItem;if(exclusive&&lastItem&&lastItem.keyword==keyword){event.item=lastItem.item}
return}
var activeMenuItem=self.menuItem(".active");if(activeMenuItem.length>0){var item=activeMenuItem.data("item");event.item=item}
self.hide()},"{menuItem} mousedown":function(){self.textboxlist.focusing=!0},"{menuItem} mouseup":function(){self.textboxlist.focusing=!1},"{menuItem} click":function(menuItem){self.hide();var item=menuItem.data("item");self.textboxlist.addItem(item);var textField=self.textboxlist.textField().val("");setTimeout(function(){textField.focus()},150)},"{menuItem} mouseover":function(menuItem){self.menuItem().removeClass("active");menuItem.addClass("active")},"{menuItem} mouseout":function(menuItem){self.menuItem().removeClass("active")}}})};exports();module.resolveWith(exports)})};FD40.module("textboxlist",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){var AutosizeInput=function(input,options){var self=this;self.input=$(input);self.options=$.extend(AutosizeInput.defaultOptions,options);self.mirror=$('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>');$.each(['fontFamily','fontSize','fontWeight','fontStyle','letterSpacing','textTransform','wordSpacing','textIndent'],function(i,val){self.mirror[0].style[val]=self.input.css(val)});$("body").append(self.mirror);self.input.bind("keydown keyup input",function(e){self.update()});self.update()}
AutosizeInput.defaultOptions={space:30}
AutosizeInput.validTypes=["text","password","search","url","tel","email"];AutosizeInput.prototype.update=function(){var self=this,input=self.input,mirror=self.mirror,value=input.val();if(!value){value=input.attr("placeholder")}
if(value===mirror.text()){return}
mirror.text(value);var newWidth=mirror.width()+self.options.space;input.width(newWidth)};$.fn.autosizeInput=function(options){return this.each(function(){if(!(this.tagName=="INPUT"&&$.inArray(this.type,AutosizeInput.validTypes)>-1)){return}
var $this=$(this);if(!$this.data("autosizeInputInstance")){$this.data("autosizeInputInstance",new AutosizeInput(this,options))}})};$(function(){$("input[data-autosize-input]").autosizeInput()})};exports();module.resolveWith(exports)};FD40.module("autosize.input",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){;(function($){var $scrollTo=$.scrollTo=function(target,duration,settings){$(window).scrollTo(target,duration,settings)};$scrollTo.defaults={axis:'xy',duration:parseFloat($.fn.jquery)>=1.3?0:1,limit:!0};$scrollTo.window=function(scope){return $(window)._scrollable()};$.fn._scrollable=function(){return this.map(function(){var elem=this,isWin=!elem.nodeName||$.inArray(elem.nodeName.toLowerCase(),['iframe','#document','html','body'])!=-1;if(!isWin)
return elem;var doc=(elem.contentWindow||elem).document||elem.ownerDocument||elem;return/webkit/i.test(navigator.userAgent)||doc.compatMode=='BackCompat'?doc.body:doc.documentElement})};$.fn.scrollTo=function(target,duration,settings){if(typeof duration=='object'){settings=duration;duration=0}
if(typeof settings=='function')
settings={onAfter:settings};if(target=='max')
target=9e9;settings=$.extend({},$scrollTo.defaults,settings);duration=duration||settings.duration;settings.queue=settings.queue&&settings.axis.length>1;if(settings.queue)
duration/=2;settings.offset=both(settings.offset);settings.over=both(settings.over);return this._scrollable().each(function(){if(target==null)return;var elem=this,$elem=$(elem),targ=target,toff,attr={},win=$elem.is('html,body');switch(typeof targ){case 'number':case 'string':if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(targ)){targ=both(targ);break}
targ=$(targ,this);if(!targ.length)return;case 'object':if(targ.is||targ.style)
toff=(targ=$(targ)).offset()}
$.each(settings.axis.split(''),function(i,axis){var Pos=axis=='x'?'Left':'Top',pos=Pos.toLowerCase(),key='scroll'+Pos,old=elem[key],max=$scrollTo.max(elem,axis);if(toff){attr[key]=toff[pos]+(win?0:old-$elem.offset()[pos]);if(settings.margin){attr[key]-=parseInt(targ.css('margin'+Pos))||0;attr[key]-=parseInt(targ.css('border'+Pos+'Width'))||0}
attr[key]+=settings.offset[pos]||0;if(settings.over[pos])
attr[key]+=targ[axis=='x'?'width':'height']()*settings.over[pos]}else{var val=targ[pos];attr[key]=val.slice&&val.slice(-1)=='%'?parseFloat(val)/100*max:val}
if(settings.limit&&/^\d+$/.test(attr[key]))
attr[key]=attr[key]<=0?0:Math.min(attr[key],max);if(!i&&settings.queue){if(old!=attr[key])
animate(settings.onAfterFirst);delete attr[key]}});animate(settings.onAfter);function animate(callback){$elem.animate(attr,duration,settings.easing,callback&&function(){callback.call(this,target,settings)})}}).end()};$.fn.scrollIntoView=function(target){var target=$(target);if(target.length<1)return;var viewportOffset=this.offset(),viewportHeight=this.height(),viewportTop=viewportOffset.top,viewportBottom=viewportTop+viewportHeight,targetOffset=target.offset(),targetHeight=target.height(),targetTop=targetOffset.top,targetBottom=targetTop+targetHeight;if(targetBottom>viewportBottom){return this.scrollTo(target)}
if(targetTop<viewportTop){return this.scrollTo(target,{offset:(viewportHeight-targetHeight)*-1})}};$scrollTo.max=function(elem,axis){var Dim=axis=='x'?'Width':'Height',scroll='scroll'+Dim;if(!$(elem).is('html,body'))
return elem[scroll]-$(elem)[Dim.toLowerCase()]();var size='client'+Dim,html=elem.ownerDocument.documentElement,body=elem.ownerDocument.body;return Math.max(html[scroll],body[scroll])-Math.min(html[size],body[size])};function both(val){return typeof val=='object'?val:{top:val,left:val}}})(jQuery)};exports();module.resolveWith(exports)};FD40.module("scrollTo",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){var jQuery=$;(function($)
{$.tiny=$.tiny||{};$.tiny.scrollbar={options:{axis:'y',wheel:40,scroll:!0,lockscroll:!0,size:'auto',sizethumb:'auto'}};$.fn.tinyscrollbar=function(params)
{var options=$.extend({},$.tiny.scrollbar.options,params);this.each(function()
{$(this).data('tsb',new Scrollbar($(this),options))});return this};$.fn.tinyscrollbar_update=function(sScroll)
{return $(this).data('tsb').update(sScroll)};function Scrollbar(root,options)
{var oSelf=this,oWrapper=root,oViewport={obj:$('.viewport',root)},oContent={obj:$('.overview',root)},oScrollbar={obj:$('.scrollbar',root)},oTrack={obj:$('.track',oScrollbar.obj)},oThumb={obj:$('.thumb',oScrollbar.obj)},sAxis=options.axis==='x',sDirection=sAxis?'left':'top',sSize=sAxis?'Width':'Height',iScroll=0,iPosition={start:0,now:0},iMouse={},touchEvents=('ontouchstart' in document.documentElement)?!0:!1;function initialize()
{oSelf.update();setEvents();return oSelf}
this.update=function(sScroll)
{oViewport[options.axis]=oViewport.obj[0]['offset'+sSize];oContent[options.axis]=oContent.obj[0]['scroll'+sSize];oContent.ratio=oViewport[options.axis]/oContent[options.axis];oScrollbar.obj.toggleClass('disable',oContent.ratio>=1);oTrack[options.axis]=options.size==='auto'?oViewport[options.axis]:options.size;oThumb[options.axis]=Math.min(oTrack[options.axis],Math.max(0,(options.sizethumb==='auto'?(oTrack[options.axis]*oContent.ratio):options.sizethumb)));oScrollbar.ratio=options.sizethumb==='auto'?(oContent[options.axis]/oTrack[options.axis]):(oContent[options.axis]-oViewport[options.axis])/(oTrack[options.axis]-oThumb[options.axis]);iScroll=(sScroll==='relative'&&oContent.ratio<=1)?Math.min((oContent[options.axis]-oViewport[options.axis]),Math.max(0,iScroll)):0;iScroll=(sScroll==='bottom'&&oContent.ratio<=1)?(oContent[options.axis]-oViewport[options.axis]):isNaN(parseInt(sScroll,10))?iScroll:parseInt(sScroll,10);setSize()};function setSize()
{var sCssSize=sSize.toLowerCase();oThumb.obj.css(sDirection,iScroll/oScrollbar.ratio);oContent.obj.css(sDirection,-iScroll);iMouse.start=oThumb.obj.offset()[sDirection];oScrollbar.obj.css(sCssSize,oTrack[options.axis]);oTrack.obj.css(sCssSize,oTrack[options.axis]);oThumb.obj.css(sCssSize,oThumb[options.axis])}
function setEvents()
{if(!touchEvents)
{oThumb.obj.bind('mousedown',start);oTrack.obj.bind('mouseup',drag)}
else{oViewport.obj[0].ontouchstart=function(event)
{if(1===event.touches.length)
{start(event.touches[0]);event.stopPropagation()}}}
if(options.scroll&&window.addEventListener)
{oWrapper[0].addEventListener('DOMMouseScroll',wheel,!1);oWrapper[0].addEventListener('mousewheel',wheel,!1)}
else if(options.scroll)
{oWrapper[0].onmousewheel=wheel}}
function start(event)
{var oThumbDir=parseInt(oThumb.obj.css(sDirection),10);iMouse.start=sAxis?event.pageX:event.pageY;iPosition.start=oThumbDir=='auto'?0:oThumbDir;if(!touchEvents)
{$(document).bind('mousemove',drag);$(document).bind('mouseup',end);oThumb.obj.bind('mouseup',end)}
else{document.ontouchmove=function(event)
{event.preventDefault();drag(event.touches[0])};document.ontouchend=end}}
function wheel(event)
{if(oContent.ratio<1)
{var oEvent=event||window.event,iDelta=oEvent.wheelDelta?oEvent.wheelDelta/120:-oEvent.detail/3;iScroll-=iDelta*options.wheel;iScroll=Math.min((oContent[options.axis]-oViewport[options.axis]),Math.max(0,iScroll));oThumb.obj.css(sDirection,iScroll/oScrollbar.ratio);oContent.obj.css(sDirection,-iScroll);if(options.lockscroll||(iScroll!==(oContent[options.axis]-oViewport[options.axis])&&iScroll!==0))
{oEvent=$.event.fix(oEvent);oEvent.preventDefault()}}}
function drag(event)
{if(oContent.ratio<1)
{if(!touchEvents)
{iPosition.now=Math.min((oTrack[options.axis]-oThumb[options.axis]),Math.max(0,(iPosition.start+((sAxis?event.pageX:event.pageY)-iMouse.start))))}
else{iPosition.now=Math.min((oTrack[options.axis]-oThumb[options.axis]),Math.max(0,(iPosition.start+(iMouse.start-(sAxis?event.pageX:event.pageY)))))}
iScroll=iPosition.now*oScrollbar.ratio;oContent.obj.css(sDirection,-iScroll);oThumb.obj.css(sDirection,iPosition.now)}}
function end()
{$(document).unbind('mousemove',drag);$(document).unbind('mouseup',end);oThumb.obj.unbind('mouseup',end);document.ontouchmove=document.ontouchend=null}
return initialize()}}(jQuery))};exports();module.resolveWith(exports)};FD40.module("tinyscrollbar",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function(window,undefined){"use strict";var History=window.History=window.History||{};if(typeof History.Adapter!=='undefined'){throw new Error('History.js Adapter has already been loaded...')}
History.Adapter={bind:function(el,event,callback){jQuery(el).bind(event,callback)},trigger:function(el,event,extra){jQuery(el).trigger(event,extra)},extractEventData:function(key,event,extra){var result=(event&&event.originalEvent&&event.originalEvent[key])||(extra&&extra[key])||undefined;return result},onDomLoad:function(callback){jQuery(callback)}};if(typeof History.init!=='undefined'){History.init()}})(window);(function(window,undefined){"use strict";var document=window.document,setTimeout=window.setTimeout||setTimeout,clearTimeout=window.clearTimeout||clearTimeout,setInterval=window.setInterval||setInterval,History=window.History=window.History||{};if(typeof History.initHtml4!=='undefined'){throw new Error('History.js HTML4 Support has already been loaded...')}
History.initHtml4=function(){if(typeof History.initHtml4.initialized!=='undefined'){return!1}
else{History.initHtml4.initialized=!0}
History.enabled=!0;History.savedHashes=[];History.isLastHash=function(newHash){var oldHash=History.getHashByIndex(),isLast;isLast=newHash===oldHash;return isLast};History.saveHash=function(newHash){if(History.isLastHash(newHash)){return!1}
History.savedHashes.push(newHash);return!0};History.getHashByIndex=function(index){var hash=null;if(typeof index==='undefined'){hash=History.savedHashes[History.savedHashes.length-1]}
else if(index<0){hash=History.savedHashes[History.savedHashes.length+index]}
else{hash=History.savedHashes[index]}
return hash};History.discardedHashes={};History.discardedStates={};History.discardState=function(discardedState,forwardState,backState){var discardedStateHash=History.getHashByState(discardedState),discardObject;discardObject={'discardedState':discardedState,'backState':backState,'forwardState':forwardState};History.discardedStates[discardedStateHash]=discardObject;return!0};History.discardHash=function(discardedHash,forwardState,backState){var discardObject={'discardedHash':discardedHash,'backState':backState,'forwardState':forwardState};History.discardedHashes[discardedHash]=discardObject;return!0};History.discardedState=function(State){var StateHash=History.getHashByState(State),discarded;discarded=History.discardedStates[StateHash]||!1;return discarded};History.discardedHash=function(hash){var discarded=History.discardedHashes[hash]||!1;return discarded};History.recycleState=function(State){var StateHash=History.getHashByState(State);if(History.discardedState(State)){delete History.discardedStates[StateHash]}
return!0};if(History.emulated.hashChange){History.hashChangeInit=function(){History.checkerFunction=null;var lastDocumentHash='',iframeId,iframe,lastIframeHash,checkerRunning;if(History.isInternetExplorer()){iframeId='historyjs-iframe';iframe=document.createElement('iframe');iframe.setAttribute('id',iframeId);iframe.style.display='none';document.body.appendChild(iframe);iframe.contentWindow.document.open();iframe.contentWindow.document.close();lastIframeHash='';checkerRunning=!1;History.checkerFunction=function(){if(checkerRunning){return!1}
checkerRunning=!0;var documentHash=History.getHash()||'',iframeHash=History.unescapeHash(iframe.contentWindow.document.location.hash)||'';if(documentHash!==lastDocumentHash){lastDocumentHash=documentHash;if(iframeHash!==documentHash){lastIframeHash=iframeHash=documentHash;iframe.contentWindow.document.open();iframe.contentWindow.document.close();iframe.contentWindow.document.location.hash=History.escapeHash(documentHash)}
History.Adapter.trigger(window,'hashchange')}
else if(iframeHash!==lastIframeHash){lastIframeHash=iframeHash;History.setHash(iframeHash,!1)}
checkerRunning=!1;return!0}}
else{History.checkerFunction=function(){var documentHash=History.getHash();if(documentHash!==lastDocumentHash){lastDocumentHash=documentHash;History.Adapter.trigger(window,'hashchange')}
return!0}}
History.intervalList.push(setInterval(History.checkerFunction,History.options.hashChangeInterval));return!0};History.Adapter.onDomLoad(History.hashChangeInit)}
if(History.emulated.pushState){History.onHashChange=function(event){var currentUrl=((event&&event.newURL)||document.location.href),currentHash=History.getHashByUrl(currentUrl),currentState=null,currentStateHash=null,currentStateHashExits=null,discardObject;if(History.isLastHash(currentHash)){History.busy(!1);return!1}
History.doubleCheckComplete();History.saveHash(currentHash);if(currentHash&&History.isTraditionalAnchor(currentHash)){History.Adapter.trigger(window,'anchorchange');History.busy(!1);return!1}
currentState=History.extractState(History.getFullUrl(currentHash||document.location.href,!1),!0);if(History.isLastSavedState(currentState)){History.busy(!1);return!1}
currentStateHash=History.getHashByState(currentState);discardObject=History.discardedState(currentState);if(discardObject){if(History.getHashByIndex(-2)===History.getHashByState(discardObject.forwardState)){History.back(!1)}else{History.forward(!1)}
return!1}
History.pushState(currentState.data,currentState.title,currentState.url,!1);return!0};History.Adapter.bind(window,'hashchange',History.onHashChange);History.pushState=function(data,title,url,queue){if(History.getHashByUrl(url)){throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).')}
if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.pushState,args:arguments,queue:queue});return!1}
History.busy(!0);var newState=History.createStateObject(data,title,url),newStateHash=History.getHashByState(newState),oldState=History.getState(!1),oldStateHash=History.getHashByState(oldState),html4Hash=History.getHash();History.storeState(newState);History.expectedStateId=newState.id;History.recycleState(newState);History.setTitle(newState);if(newStateHash===oldStateHash){History.busy(!1);return!1}
if(newStateHash!==html4Hash&&newStateHash!==History.getShortUrl(document.location.href)){History.setHash(newStateHash,!1);return!1}
History.saveState(newState);History.Adapter.trigger(window,'statechange');History.busy(!1);return!0};History.replaceState=function(data,title,url,queue){if(History.getHashByUrl(url)){throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).')}
if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.replaceState,args:arguments,queue:queue});return!1}
History.busy(!0);var newState=History.createStateObject(data,title,url),oldState=History.getState(!1),previousState=History.getStateByIndex(-2);History.discardState(oldState,newState,previousState);History.pushState(newState.data,newState.title,newState.url,!1);return!0}}
if(History.emulated.pushState){if(History.getHash()&&!History.emulated.hashChange){History.Adapter.onDomLoad(function(){History.Adapter.trigger(window,'hashchange')})}}};if(typeof History.init!=='undefined'){History.init()}})(window);(function(window,undefined){"use strict";var console=window.console||undefined,document=window.document,navigator=window.navigator,sessionStorage=window.sessionStorage||!1,setTimeout=window.setTimeout,clearTimeout=window.clearTimeout,setInterval=window.setInterval,clearInterval=window.clearInterval,JSON=window.JSON,alert=window.alert,History=window.History=window.History||{},history=window.history;JSON.stringify=JSON.stringify||JSON.encode;JSON.parse=JSON.parse||JSON.decode;if(typeof History.init!=='undefined'){throw new Error('History.js Core has already been loaded...')}
History.init=function(){if(typeof History.Adapter==='undefined'){return!1}
if(typeof History.initCore!=='undefined'){History.initCore()}
if(typeof History.initHtml4!=='undefined'){History.initHtml4()}
return!0};History.initCore=function(){if(typeof History.initCore.initialized!=='undefined'){return!1}
else{History.initCore.initialized=!0}
History.options=History.options||{};History.options.hashChangeInterval=History.options.hashChangeInterval||100;History.options.safariPollInterval=History.options.safariPollInterval||500;History.options.doubleCheckInterval=History.options.doubleCheckInterval||500;History.options.storeInterval=History.options.storeInterval||1000;History.options.busyDelay=History.options.busyDelay||250;History.options.debug=History.options.debug||!1;History.options.initialTitle=History.options.initialTitle||document.title;History.intervalList=[];History.clearAllIntervals=function(){var i,il=History.intervalList;if(typeof il!=="undefined"&&il!==null){for(i=0;i<il.length;i++){clearInterval(il[i])}
History.intervalList=null}};History.debug=function(){if((History.options.debug||!1)){History.log.apply(History,arguments)}};History.log=function(){var
consoleExists=!(typeof console==='undefined'||typeof console.log==='undefined'||typeof console.log.apply==='undefined'),textarea=document.getElementById('log'),message,i,n,args,arg;if(consoleExists){args=Array.prototype.slice.call(arguments);message=args.shift();if(typeof console.debug!=='undefined'){console.debug.apply(console,[message,args])}
else{console.log.apply(console,[message,args])}}
else{message=("\n"+arguments[0]+"\n")}
for(i=1,n=arguments.length;i<n;++i){arg=arguments[i];if(typeof arg==='object'&&typeof JSON!=='undefined'){try{arg=JSON.stringify(arg)}
catch(Exception){}}
message+="\n"+arg+"\n"}
if(textarea){textarea.value+=message+"\n-----\n";textarea.scrollTop=textarea.scrollHeight-textarea.clientHeight}
else if(!consoleExists){alert(message)}
return!0};History.getInternetExplorerMajorVersion=function(){var result=History.getInternetExplorerMajorVersion.cached=(typeof History.getInternetExplorerMajorVersion.cached!=='undefined')?History.getInternetExplorerMajorVersion.cached:(function(){var v=3,div=document.createElement('div'),all=div.getElementsByTagName('i');while((div.innerHTML='<!--[if gt IE '+(++v)+']><i></i><![endif]-->')&&all[0]){}
return(v>4)?v:!1})();return result};History.isInternetExplorer=function(){var result=History.isInternetExplorer.cached=(typeof History.isInternetExplorer.cached!=='undefined')?History.isInternetExplorer.cached:Boolean(History.getInternetExplorerMajorVersion());return result};History.emulated={pushState:!Boolean(window.history&&window.history.pushState&&window.history.replaceState&&!((/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i).test(navigator.userAgent)||(/AppleWebKit\/5([0-2]|3[0-2])/i).test(navigator.userAgent))),hashChange:Boolean(!(('onhashchange' in window)||('onhashchange' in document))||(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<8))};History.enabled=!History.emulated.pushState;History.bugs={setHash:Boolean(!History.emulated.pushState&&navigator.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(navigator.userAgent)),safariPoll:Boolean(!History.emulated.pushState&&navigator.vendor==='Apple Computer, Inc.'&&/AppleWebKit\/5([0-2]|3[0-3])/.test(navigator.userAgent)),ieDoubleCheck:Boolean(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(History.isInternetExplorer()&&History.getInternetExplorerMajorVersion()<7)};History.isEmptyObject=function(obj){for(var name in obj){return!1}
return!0};History.cloneObject=function(obj){var hash,newObj;if(obj){hash=JSON.stringify(obj);newObj=JSON.parse(hash)}
else{newObj={}}
return newObj};History.getRootUrl=function(){var rootUrl=document.location.protocol+'//'+(document.location.hostname||document.location.host);if(document.location.port||!1){rootUrl+=':'+document.location.port}
rootUrl+='/';return rootUrl};History.getBaseHref=function(){var
baseElements=document.getElementsByTagName('base'),baseElement=null,baseHref='';if(baseElements.length===1){baseElement=baseElements[0];baseHref=baseElement.href.replace(/[^\/]+$/,'')}
baseHref=baseHref.replace(/\/+$/,'');if(baseHref)baseHref+='/';return baseHref};History.getBaseUrl=function(){var baseUrl=History.getBaseHref()||History.getBasePageUrl()||History.getRootUrl();return baseUrl};History.getPageUrl=function(){var
State=History.getState(!1,!1),stateUrl=(State||{}).url||document.location.href,pageUrl;pageUrl=stateUrl.replace(/\/+$/,'').replace(/[^\/]+$/,function(part,index,string){return(/\./).test(part)?part:part+'/'});return pageUrl};History.getBasePageUrl=function(){var basePageUrl=document.location.href.replace(/[#\?].*/,'').replace(/[^\/]+$/,function(part,index,string){return(/[^\/]$/).test(part)?'':part}).replace(/\/+$/,'')+'/';return basePageUrl};History.getFullUrl=function(url,allowBaseHref){var fullUrl=url,firstChar=url.substring(0,1);allowBaseHref=(typeof allowBaseHref==='undefined')?!0:allowBaseHref;if(/[a-z]+\:\/\//.test(url)){}
else if(firstChar==='/'){fullUrl=History.getRootUrl()+url.replace(/^\/+/,'')}
else if(firstChar==='#'){fullUrl=History.getPageUrl().replace(/#.*/,'')+url}
else if(firstChar==='?'){fullUrl=History.getPageUrl().replace(/[\?#].*/,'')+url}
else{if(allowBaseHref){fullUrl=History.getBaseUrl()+url.replace(/^(\.\/)+/,'')}else{fullUrl=History.getBasePageUrl()+url.replace(/^(\.\/)+/,'')}}
return fullUrl.replace(/\#$/,'')};History.getShortUrl=function(url){var shortUrl=url,baseUrl=History.getBaseUrl(),rootUrl=History.getRootUrl();if(History.emulated.pushState){shortUrl=shortUrl.replace(baseUrl,'')}
shortUrl=shortUrl.replace(rootUrl,'/');if(History.isTraditionalAnchor(shortUrl)){shortUrl='./'+shortUrl}
shortUrl=shortUrl.replace(/^(\.\/)+/g,'./').replace(/\#$/,'');return shortUrl};History.store={};History.idToState=History.idToState||{};History.stateToId=History.stateToId||{};History.urlToId=History.urlToId||{};History.storedStates=History.storedStates||[];History.savedStates=History.savedStates||[];History.normalizeStore=function(){History.store.idToState=History.store.idToState||{};History.store.urlToId=History.store.urlToId||{};History.store.stateToId=History.store.stateToId||{}};History.getState=function(friendly,create){if(typeof friendly==='undefined'){friendly=!0}
if(typeof create==='undefined'){create=!0}
var State=History.getLastSavedState();if(!State&&create){State=History.createStateObject()}
if(friendly){State=History.cloneObject(State);State.url=State.cleanUrl||State.url}
return State};History.getIdByState=function(newState){var id=History.extractId(newState.url),str;if(!id){str=History.getStateString(newState);if(typeof History.stateToId[str]!=='undefined'){id=History.stateToId[str]}
else if(typeof History.store.stateToId[str]!=='undefined'){id=History.store.stateToId[str]}
else{while(!0){id=(new Date()).getTime()+String(Math.random()).replace(/\D/g,'');if(typeof History.idToState[id]==='undefined'&&typeof History.store.idToState[id]==='undefined'){break}}
History.stateToId[str]=id;History.idToState[id]=newState}}
return id};History.normalizeState=function(oldState){var newState,dataNotEmpty;if(!oldState||(typeof oldState!=='object')){oldState={}}
if(typeof oldState.normalized!=='undefined'){return oldState}
if(!oldState.data||(typeof oldState.data!=='object')){oldState.data={}}
newState={};newState.normalized=!0;newState.title=oldState.title||'';newState.url=History.getFullUrl(History.unescapeString(oldState.url||document.location.href));newState.hash=History.getShortUrl(newState.url);newState.data=History.cloneObject(oldState.data);newState.id=History.getIdByState(newState);newState.cleanUrl=newState.url.replace(/\??\&_suid.*/,'');newState.url=newState.cleanUrl;dataNotEmpty=!History.isEmptyObject(newState.data);if(newState.title||dataNotEmpty){newState.hash=History.getShortUrl(newState.url).replace(/\??\&_suid.*/,'');if(!/\?/.test(newState.hash)){newState.hash+='?'}
newState.hash+='&_suid='+newState.id}
newState.hashedUrl=History.getFullUrl(newState.hash);if((History.emulated.pushState||History.bugs.safariPoll)&&History.hasUrlDuplicate(newState)){newState.url=newState.hashedUrl}
return newState};History.createStateObject=function(data,title,url){var State={'data':data,'title':title,'url':url};State=History.normalizeState(State);return State};History.getStateById=function(id){id=String(id);var State=History.idToState[id]||History.store.idToState[id]||undefined;return State};History.getStateString=function(passedState){var State,cleanedState,str;State=History.normalizeState(passedState);cleanedState={data:State.data,title:passedState.title,url:passedState.url};str=JSON.stringify(cleanedState);return str};History.getStateId=function(passedState){var State,id;State=History.normalizeState(passedState);id=State.id;return id};History.getHashByState=function(passedState){var State,hash;State=History.normalizeState(passedState);hash=State.hash;return hash};History.extractId=function(url_or_hash){var id,parts,url;parts=/(.*)\&_suid=([0-9]+)$/.exec(url_or_hash);url=parts?(parts[1]||url_or_hash):url_or_hash;id=parts?String(parts[2]||''):'';return id||!1};History.isTraditionalAnchor=function(url_or_hash){var isTraditional=!(/[\/\?\.]/.test(url_or_hash));return isTraditional};History.extractState=function(url_or_hash,create){var State=null,id,url;create=create||!1;id=History.extractId(url_or_hash);if(id){State=History.getStateById(id)}
if(!State){url=History.getFullUrl(url_or_hash);id=History.getIdByUrl(url)||!1;if(id){State=History.getStateById(id)}
if(!State&&create&&!History.isTraditionalAnchor(url_or_hash)){State=History.createStateObject(null,null,url)}}
return State};History.getIdByUrl=function(url){var id=History.urlToId[url]||History.store.urlToId[url]||undefined;return id};History.getLastSavedState=function(){return History.savedStates[History.savedStates.length-1]||undefined};History.getLastStoredState=function(){return History.storedStates[History.storedStates.length-1]||undefined};History.hasUrlDuplicate=function(newState){var hasDuplicate=!1,oldState;oldState=History.extractState(newState.url);hasDuplicate=oldState&&oldState.id!==newState.id;return hasDuplicate};History.storeState=function(newState){History.urlToId[newState.url]=newState.id;History.storedStates.push(History.cloneObject(newState));return newState};History.isLastSavedState=function(newState){var isLast=!1,newId,oldState,oldId;if(History.savedStates.length){newId=newState.id;oldState=History.getLastSavedState();oldId=oldState.id;isLast=(newId===oldId)}
return isLast};History.saveState=function(newState){if(History.isLastSavedState(newState)){return!1}
History.savedStates.push(History.cloneObject(newState));return!0};History.getStateByIndex=function(index){var State=null;if(typeof index==='undefined'){State=History.savedStates[History.savedStates.length-1]}
else if(index<0){State=History.savedStates[History.savedStates.length+index]}
else{State=History.savedStates[index]}
return State};History.getHash=function(){var hash=History.unescapeHash(document.location.hash);return hash};History.unescapeString=function(str){var result=str,tmp;while(!0){tmp=window.unescape(result);if(tmp===result){break}
result=tmp}
return result};History.unescapeHash=function(hash){var result=History.normalizeHash(hash);result=History.unescapeString(result);return result};History.normalizeHash=function(hash){var result=hash.replace(/[^#]*#/,'').replace(/#.*/,'');return result};History.setHash=function(hash,queue){var adjustedHash,State,pageUrl;if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.setHash,args:arguments,queue:queue});return!1}
adjustedHash=History.escapeHash(hash);History.busy(!0);State=History.extractState(hash,!0);if(State&&!History.emulated.pushState){History.pushState(State.data,State.title,State.url,!1)}
else if(document.location.hash!==adjustedHash){if(History.bugs.setHash){pageUrl=History.getPageUrl();History.pushState(null,null,pageUrl+'#'+adjustedHash,!1)}
else{document.location.hash=adjustedHash}}
return History};History.escapeHash=function(hash){var result=History.normalizeHash(hash);result=window.escape(result);if(!History.bugs.hashEscape){result=result.replace(/\%21/g,'!').replace(/\%26/g,'&').replace(/\%3D/g,'=').replace(/\%3F/g,'?')}
return result};History.getHashByUrl=function(url){var hash=String(url).replace(/([^#]*)#?([^#]*)#?(.*)/,'$2');hash=History.unescapeHash(hash);return hash};History.setTitle=function(newState){var title=newState.title,firstState;if(!title){firstState=History.getStateByIndex(0);if(firstState&&firstState.url===newState.url){title=firstState.title||History.options.initialTitle}}
try{document.getElementsByTagName('title')[0].innerHTML=title.replace('<','&lt;').replace('>','&gt;').replace(' & ',' &amp; ')}
catch(Exception){}
document.title=title;return History};History.queues=[];History.busy=function(value){if(typeof value!=='undefined'){History.busy.flag=value}
else if(typeof History.busy.flag==='undefined'){History.busy.flag=!1}
if(!History.busy.flag){clearTimeout(History.busy.timeout);var fireNext=function(){var i,queue,item;if(History.busy.flag)return;for(i=History.queues.length-1;i>=0;--i){queue=History.queues[i];if(queue.length===0)continue;item=queue.shift();History.fireQueueItem(item);History.busy.timeout=setTimeout(fireNext,History.options.busyDelay)}};History.busy.timeout=setTimeout(fireNext,History.options.busyDelay)}
return History.busy.flag};History.busy.flag=!1;History.fireQueueItem=function(item){return item.callback.apply(item.scope||History,item.args||[])};History.pushQueue=function(item){History.queues[item.queue||0]=History.queues[item.queue||0]||[];History.queues[item.queue||0].push(item);return History};History.queue=function(item,queue){if(typeof item==='function'){item={callback:item}}
if(typeof queue!=='undefined'){item.queue=queue}
if(History.busy()){History.pushQueue(item)}else{History.fireQueueItem(item)}
return History};History.clearQueue=function(){History.busy.flag=!1;History.queues=[];return History};History.stateChanged=!1;History.doubleChecker=!1;History.doubleCheckComplete=function(){History.stateChanged=!0;History.doubleCheckClear();return History};History.doubleCheckClear=function(){if(History.doubleChecker){clearTimeout(History.doubleChecker);History.doubleChecker=!1}
return History};History.doubleCheck=function(tryAgain){History.stateChanged=!1;History.doubleCheckClear();if(History.bugs.ieDoubleCheck){History.doubleChecker=setTimeout(function(){History.doubleCheckClear();if(!History.stateChanged){tryAgain()}
return!0},History.options.doubleCheckInterval)}
return History};History.safariStatePoll=function(){var
urlState=History.extractState(document.location.href),newState;if(!History.isLastSavedState(urlState)){newState=urlState}
else{return}
if(!newState){newState=History.createStateObject()}
History.Adapter.trigger(window,'popstate');return History};History.back=function(queue){if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.back,args:arguments,queue:queue});return!1}
History.busy(!0);History.doubleCheck(function(){History.back(!1)});history.go(-1);return!0};History.forward=function(queue){if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.forward,args:arguments,queue:queue});return!1}
History.busy(!0);History.doubleCheck(function(){History.forward(!1)});history.go(1);return!0};History.go=function(index,queue){var i;if(index>0){for(i=1;i<=index;++i){History.forward(queue)}}
else if(index<0){for(i=-1;i>=index;--i){History.back(queue)}}
else{throw new Error('History.go: History.go requires a positive or negative integer passed.')}
return History};if(History.emulated.pushState){var emptyFunction=function(){};History.pushState=History.pushState||emptyFunction;History.replaceState=History.replaceState||emptyFunction}
else{History.onPopState=function(event,extra){var stateId=!1,newState=!1,currentHash,currentState;History.doubleCheckComplete();currentHash=History.getHash();if(currentHash){currentState=History.extractState(currentHash||document.location.href,!0);if(currentState){History.replaceState(currentState.data,currentState.title,currentState.url,!1)}
else{History.Adapter.trigger(window,'anchorchange');History.busy(!1)}
History.expectedStateId=!1;return!1}
stateId=History.Adapter.extractEventData('state',event,extra)||!1;if(stateId){newState=History.getStateById(stateId)}
else if(History.expectedStateId){newState=History.getStateById(History.expectedStateId)}
else{newState=History.extractState(document.location.href)}
if(!newState){newState=History.createStateObject(null,null,document.location.href)}
History.expectedStateId=!1;if(History.isLastSavedState(newState)){History.busy(!1);return!1}
History.storeState(newState);History.saveState(newState);History.setTitle(newState);History.Adapter.trigger(window,'statechange');History.busy(!1);return!0};History.Adapter.bind(window,'popstate',History.onPopState);History.pushState=function(data,title,url,queue){if(History.getHashByUrl(url)&&History.emulated.pushState){throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).')}
if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.pushState,args:arguments,queue:queue});return!1}
History.busy(!0);var newState=History.createStateObject(data,title,url);if(History.isLastSavedState(newState)){History.busy(!1)}
else{History.storeState(newState);History.expectedStateId=newState.id;history.pushState(newState.id,newState.title,newState.url);History.Adapter.trigger(window,'popstate')}
return!0};History.replaceState=function(data,title,url,queue){if(History.getHashByUrl(url)&&History.emulated.pushState){throw new Error('History.js does not support states with fragement-identifiers (hashes/anchors).')}
if(queue!==!1&&History.busy()){History.pushQueue({scope:History,callback:History.replaceState,args:arguments,queue:queue});return!1}
History.busy(!0);var newState=History.createStateObject(data,title,url);if(History.isLastSavedState(newState)){History.busy(!1)}
else{History.storeState(newState);History.expectedStateId=newState.id;history.replaceState(newState.id,newState.title,newState.url);History.Adapter.trigger(window,'popstate')}
return!0}}
if(sessionStorage){try{History.store=JSON.parse(sessionStorage.getItem('History.store'))||{}}
catch(err){History.store={}}
History.normalizeStore()}
else{History.store={};History.normalizeStore()}
History.Adapter.bind(window,"beforeunload",History.clearAllIntervals);History.Adapter.bind(window,"unload",History.clearAllIntervals);History.saveState(History.storeState(History.extractState(document.location.href,!0)));if(sessionStorage){History.onUnload=function(){var currentStore,item;try{currentStore=JSON.parse(sessionStorage.getItem('History.store'))||{}}
catch(err){currentStore={}}
currentStore.idToState=currentStore.idToState||{};currentStore.urlToId=currentStore.urlToId||{};currentStore.stateToId=currentStore.stateToId||{};for(item in History.idToState){if(!History.idToState.hasOwnProperty(item)){continue}
currentStore.idToState[item]=History.idToState[item]}
for(item in History.urlToId){if(!History.urlToId.hasOwnProperty(item)){continue}
currentStore.urlToId[item]=History.urlToId[item]}
for(item in History.stateToId){if(!History.stateToId.hasOwnProperty(item)){continue}
currentStore.stateToId[item]=History.stateToId[item]}
History.store=currentStore;History.normalizeStore();sessionStorage.setItem('History.store',JSON.stringify(currentStore))};History.intervalList.push(setInterval(History.onUnload,History.options.storeInterval));History.Adapter.bind(window,'beforeunload',History.onUnload);History.Adapter.bind(window,'unload',History.onUnload)}
if(!History.emulated.pushState){if(History.bugs.safariPoll){History.intervalList.push(setInterval(History.safariStatePoll,History.options.safariPollInterval))}
if(navigator.vendor==='Apple Computer, Inc.'||(navigator.appCodeName||'')==='Mozilla'){History.Adapter.bind(window,'hashchange',function(){History.Adapter.trigger(window,'popstate')});if(History.getHash()){History.Adapter.onDomLoad(function(){History.Adapter.trigger(window,'hashchange')})}}}};History.init()})(window);var timestamps=[];$.fn.route=function(options){if(this.is("a")){var title=this.attr('title'),appendTitle=$.joomla.appendTitle;if(appendTitle==="before"){title=$.joomla.sitename+((title)?" - "+title:"")}
if(appendTitle==="after"){title=((title)?title+" - ":"")+$.joomla.sitename}
var t=new Date().getTime();timestamps[t]=t;History.pushState($.extend({timestamp:t,refresh:!0},options),title,this.attr("href"))}
return this}
History.Adapter.bind(window,'statechange',function(){var state=History.getState();if(state.id===History.savedStates[0].id){window.location=state.url}
if(state.data.timestamp in timestamps){delete timestamps[state.data.timestamp]}
else{if(state.data.refresh){window.location=state.url}}})};exports();module.resolveWith(exports)};FD40.module("history",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function(window,$,undefined){'use strict';var $event=$.event,resizeTimeout;$event.special.smartresize={setup:function(){$(this).bind("resize",$event.special.smartresize.handler)},teardown:function(){$(this).unbind("resize",$event.special.smartresize.handler)},handler:function(event,execAsap){var context=this,args=arguments;event.type="smartresize";if(resizeTimeout){clearTimeout(resizeTimeout)}
resizeTimeout=setTimeout(function(){jQuery.event.dispatch.apply(context,args)},execAsap==="execAsap"?0:100)}};$.fn.smartresize=function(fn){return fn?this.bind("smartresize",fn):this.trigger("smartresize",["execAsap"])};$.Mason=function(options,element){this.element=$(element);this._create(options);this._init()};$.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:'relative'}};$.Mason.prototype={_filterFindBricks:function($elems){var selector=this.options.itemSelector;return!selector?$elems:$elems.filter(selector).add($elems.find(selector))},_getBricks:function($elems){var $bricks=this._filterFindBricks($elems).css({position:'absolute'}).addClass('masonry-brick');return $bricks},_create:function(options){this.options=$.extend(!0,{},$.Mason.settings,options);this.styleQueue=[];var elemStyle=this.element[0].style;this.originalStyle={height:elemStyle.height||''};var containerStyle=this.options.containerStyle;for(var prop in containerStyle){this.originalStyle[prop]=elemStyle[prop]||''}
this.element.css(containerStyle);this.horizontalDirection=this.options.isRTL?'right':'left';this.offset={x:parseInt(this.element.css('padding-'+this.horizontalDirection),10),y:parseInt(this.element.css('padding-top'),10)};this.isFluid=this.options.columnWidth&&typeof this.options.columnWidth==='function';var instance=this;setTimeout(function(){instance.element.addClass('masonry')},0);if(this.options.isResizable){$(window).bind('smartresize.masonry',function(){instance.resize()})}
this.reloadItems()},_init:function(callback){this._getColumns();this._reLayout(callback)},option:function(key,value){if($.isPlainObject(key)){this.options=$.extend(!0,this.options,key)}},layout:function($bricks,callback){for(var i=0,len=$bricks.length;i<len;i++){this._placeBrick($bricks[i])}
var containerSize={};containerSize.height=Math.max.apply(Math,this.colYs);if(this.options.isFitWidth){var unusedCols=0;i=this.cols;while(--i){if(this.colYs[i]!==0){break}
unusedCols++}
containerSize.width=(this.cols-unusedCols)*this.columnWidth-this.options.gutterWidth}
this.styleQueue.push({$el:this.element,style:containerSize});var styleFn=!this.isLaidOut?'css':(this.options.isAnimated?'animate':'css'),animOpts=this.options.animationOptions;var obj;for(i=0,len=this.styleQueue.length;i<len;i++){obj=this.styleQueue[i];obj.$el[styleFn](obj.style,animOpts)}
this.styleQueue=[];if(callback){callback.call($bricks)}
this.isLaidOut=!0},_getColumns:function(){var container=this.options.isFitWidth?this.element.parent():this.element,containerWidth=container.width();this.columnWidth=this.isFluid?this.options.columnWidth(containerWidth):this.options.columnWidth||this.$bricks.outerWidth(!0)||containerWidth;this.columnWidth+=this.options.gutterWidth;this.cols=Math.floor((containerWidth+this.options.gutterWidth)/this.columnWidth);this.cols=Math.max(this.cols,1)},_placeBrick:function(brick){var $brick=$(brick),colSpan,groupCount,groupY,groupColY,j;colSpan=Math.ceil($brick.outerWidth(!0)/(this.columnWidth+this.options.gutterWidth));colSpan=Math.min(colSpan,this.cols);if(colSpan===1){groupY=this.colYs}else{groupCount=this.cols+1-colSpan;groupY=[];for(j=0;j<groupCount;j++){groupColY=this.colYs.slice(j,j+colSpan);groupY[j]=Math.max.apply(Math,groupColY)}}
var minimumY=Math.min.apply(Math,groupY),shortCol=0;for(var i=0,len=groupY.length;i<len;i++){if(groupY[i]===minimumY){shortCol=i;break}}
var position={top:minimumY+this.offset.y};position[this.horizontalDirection]=this.columnWidth*shortCol+this.offset.x;this.styleQueue.push({$el:$brick,style:position});var setHeight=minimumY+$brick.outerHeight(!0),setSpan=this.cols+1-len;for(i=0;i<setSpan;i++){this.colYs[shortCol+i]=setHeight}},resize:function(){var prevColCount=this.cols;this._getColumns();if(this.isFluid||this.cols!==prevColCount){this._reLayout()}},_reLayout:function(callback){var i=this.cols;this.colYs=[];while(i--){this.colYs.push(0)}
this.layout(this.$bricks,callback)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(callback){this.reloadItems();this._init(callback)},appended:function($content,isAnimatedFromBottom,callback){if(isAnimatedFromBottom){this._filterFindBricks($content).css({top:this.element.height()});var instance=this;setTimeout(function(){instance._appended($content,callback)},1)}else{this._appended($content,callback)}},_appended:function($content,callback){var $newBricks=this._getBricks($content);this.$bricks=this.$bricks.add($newBricks);this.layout($newBricks,callback)},remove:function($content){this.$bricks=this.$bricks.not($content);$content.remove()},destroy:function(){this.$bricks.removeClass('masonry-brick').each(function(){this.style.position='';this.style.top='';this.style.left='';this.style.right=''});var elemStyle=this.element[0].style;for(var prop in this.originalStyle){elemStyle[prop]=this.originalStyle[prop]}
this.element.unbind('.masonry').removeClass('masonry').removeData('masonry');$(window).unbind('.masonry')}};$.fn.imagesLoaded=function(callback){var $this=this,$images=$this.find('img').add($this.filter('img')),len=$images.length,blank='data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==',loaded=[];function triggerCallback(){callback.call($this,$images)}
function imgLoaded(event){var img=event.target;if(img.src!==blank&&$.inArray(img,loaded)===-1){loaded.push(img);if(--len<=0){setTimeout(triggerCallback);$images.unbind('.imagesLoaded',imgLoaded)}}}
if(!len){triggerCallback()}
$images.bind('load.imagesLoaded error.imagesLoaded',imgLoaded).each(function(){var src=this.src;this.src=blank;this.src=src});return $this};var logError=function(message){if(window.console){window.console.error(message)}};$.fn.masonry=function(options){if(typeof options==='string'){var args=Array.prototype.slice.call(arguments,1);this.each(function(){var instance=$.data(this,'masonry');if(!instance){logError("cannot call methods on masonry prior to initialization; "+"attempted to call method '"+options+"'");return}
if(!$.isFunction(instance[options])||options.charAt(0)==="_"){logError("no such method '"+options+"' for masonry instance");return}
instance[options].apply(instance,args)})}else{this.each(function(){var instance=$.data(this,'masonry');if(instance){instance.option(options||{});instance._init()}else{$.data(this,'masonry',new $.Mason(options,this))}})}
return this}})(window,jQuery)};exports();module.resolveWith(exports)};FD40.module("masonry",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;$.require().script("moment").done(function(){var exports=function(){var dpgId=0,pMoment=$.moment,DateTimePicker=function(element,options){var defaults={pickDate:!0,pickTime:!0,useMinutes:!0,useSeconds:!1,useCurrent:!0,minuteStepping:1,minDate:new pMoment({y:1900}),maxDate:new pMoment().add(100,"y"),showToday:!0,collapse:!0,language:"en",defaultDate:"",disabledDates:!1,enabledDates:!1,icons:{},useStrict:!1,direction:"auto",sideBySide:!1,daysOfWeekDisabled:!1,component:""},icons={time:'fa fa-clock-o',date:'fa fa-calendar',up:'fa fa-chevron-up',down:'fa fa-chevron-down'},picker=this,init=function(){var icon=!1,i,dDate,longDateFormat;picker.options=$.extend({},defaults,options);picker.options.icons=$.extend({},icons,picker.options.icons);picker.element=$(element);dataToOptions();if(!(picker.options.pickTime||picker.options.pickDate))
throw new Error('Must choose at least one picker');picker.id=dpgId++;pMoment.lang(picker.options.language);picker.date=pMoment();picker.unset=!1;picker.isInput=picker.element.is('input');picker.component=!1;if(picker.element.hasClass('input-group')){if(picker.element.find('.datepickerbutton').size()==0){picker.component=picker.element.find("[class^='input-group-']")}
else{picker.component=picker.element.find('.datepickerbutton')}}
picker.format=picker.options.format;longDateFormat=pMoment()._lang._longDateFormat;if(!picker.format){picker.format=(picker.options.pickDate?longDateFormat.L:'');if(picker.options.pickDate&&picker.options.pickTime)picker.format+=' ';picker.format+=(picker.options.pickTime?longDateFormat.LT:'');if(picker.options.useSeconds){if(~longDateFormat.LT.indexOf(' A')){picker.format=picker.format.split(" A")[0]+":ss A"}
else{picker.format+=':ss'}}}
picker.use24hours=picker.format.toLowerCase().indexOf("a")<1;if(picker.component)icon=picker.component.find('span');if(picker.options.pickTime){if(icon)icon.addClass(picker.options.icons.time)}
if(picker.options.pickDate){if(icon){icon.removeClass(picker.options.icons.time);icon.addClass(picker.options.icons.date)}}
picker.widget=$(getTemplate()).appendTo('body');if(picker.options.useSeconds&&!picker.use24hours){picker.widget.width(300)}
picker.minViewMode=picker.options.minViewMode||0;if(typeof picker.minViewMode==='string'){switch(picker.minViewMode){case 'months':picker.minViewMode=1;break;case 'years':picker.minViewMode=2;break;default:picker.minViewMode=0;break}}
picker.viewMode=picker.options.viewMode||0;if(typeof picker.viewMode==='string'){switch(picker.viewMode){case 'months':picker.viewMode=1;break;case 'years':picker.viewMode=2;break;default:picker.viewMode=0;break}}
picker.options.disabledDates=indexGivenDates(picker.options.disabledDates);picker.options.enabledDates=indexGivenDates(picker.options.enabledDates);picker.startViewMode=picker.viewMode;picker.setMinDate(picker.options.minDate);picker.setMaxDate(picker.options.maxDate);fillDow();fillMonths();fillHours();fillMinutes();fillSeconds();update();showMode();attachDatePickerEvents();if(picker.options.defaultDate!==""&&getPickerInput().val()=="")picker.setValue(picker.options.defaultDate);if(picker.options.minuteStepping!==1){var rInterval=picker.options.minuteStepping;picker.date.minutes((Math.round(picker.date.minutes()/rInterval)*rInterval)%60).seconds(0)}},getPickerInput=function(){if(picker.isInput){return picker.element}else{return dateStr=picker.element.find('input')}},dataToOptions=function(){var eData
if(picker.element.is('input')){eData=picker.element.data()}
else{eData=picker.element.data()}
if(eData.dateFormat!==undefined)picker.options.format=eData.dateFormat;if(eData.datePickdate!==undefined)picker.options.pickDate=eData.datePickdate;if(eData.datePicktime!==undefined)picker.options.pickTime=eData.datePicktime;if(eData.dateUseminutes!==undefined)picker.options.useMinutes=eData.dateUseminutes;if(eData.dateUseseconds!==undefined)picker.options.useSeconds=eData.dateUseseconds;if(eData.dateUsecurrent!==undefined)picker.options.useCurrent=eData.dateUsecurrent;if(eData.dateMinutestepping!==undefined)picker.options.minuteStepping=eData.dateMinutestepping;if(eData.dateMindate!==undefined)picker.options.minDate=eData.dateMindate;if(eData.dateMaxdate!==undefined)picker.options.maxDate=eData.dateMaxdate;if(eData.dateShowtoday!==undefined)picker.options.showToday=eData.dateShowtoday;if(eData.dateCollapse!==undefined)picker.options.collapse=eData.dateCollapse;if(eData.dateLanguage!==undefined)picker.options.language=eData.dateLanguage;if(eData.dateDefaultdate!==undefined)picker.options.defaultDate=eData.dateDefaultdate;if(eData.dateDisableddates!==undefined)picker.options.disabledDates=eData.dateDisableddates;if(eData.dateEnableddates!==undefined)picker.options.enabledDates=eData.dateEnableddates;if(eData.dateIcons!==undefined)picker.options.icons=eData.dateIcons;if(eData.dateUsestrict!==undefined)picker.options.useStrict=eData.dateUsestrict;if(eData.dateDirection!==undefined)picker.options.direction=eData.dateDirection;if(eData.dateSidebyside!==undefined)picker.options.sideBySide=eData.dateSidebyside},place=function(){var position='absolute',offset=picker.component?picker.component.offset():picker.element.offset(),$window=$(window);picker.width=picker.component?picker.component.outerWidth():picker.element.outerWidth();offset.top=offset.top+picker.element.outerHeight();var placePosition;if(picker.options.direction==='up'){placePosition='top'}else if(picker.options.direction==='bottom'){placePosition='bottom'}else if(picker.options.direction==='auto'){if(offset.top+picker.widget.height()>$window.height()+$window.scrollTop()&&picker.widget.height()+picker.element.outerHeight()<offset.top){placePosition='top'}else{placePosition='bottom'}};if(placePosition==='top'){offset.top-=picker.widget.height()+picker.element.outerHeight()+15;picker.widget.addClass('top').removeClass('bottom')}else{offset.top+=1;picker.widget.addClass('bottom').removeClass('top')}
if(picker.options.width!==undefined){picker.widget.width(picker.options.width)}
if(picker.options.orientation==='left'){picker.widget.addClass('left-oriented');offset.left=offset.left-picker.widget.width()+20}
if(isInFixed()){position='fixed';offset.top-=$window.scrollTop();offset.left-=$window.scrollLeft()}
if($window.width()<offset.left+picker.widget.outerWidth()){offset.right=$window.width()-offset.left-picker.width;offset.left='auto';picker.widget.addClass('pull-right')}else{offset.right='auto';picker.widget.removeClass('pull-right')}
picker.widget.css({position:position,top:offset.top,left:offset.left,right:offset.right})},notifyChange=function(oldDate,eventType){if(pMoment(picker.date).isSame(pMoment(oldDate)))return;picker.element.trigger({type:'dp.change',date:pMoment(picker.date),oldDate:pMoment(oldDate)});if(eventType!=='change')
picker.element.change()},notifyError=function(date){picker.element.trigger({type:'dp.error',date:pMoment(date)})},update=function(newDate){pMoment.lang(picker.options.language);var dateStr=newDate;if(!dateStr){dateStr=getPickerInput().val()
if(dateStr)picker.date=pMoment(dateStr,picker.format,picker.options.useStrict);if(!picker.date)picker.date=pMoment()}
picker.viewDate=pMoment(picker.date).startOf("month");fillDate();fillTime()},fillDow=function(){pMoment.lang(picker.options.language);var html=$('<tr>'),weekdaysMin=pMoment.weekdaysMin(),i;if(pMoment()._lang._week.dow==0){for(i=0;i<7;i++){html.append('<th class="dow">'+weekdaysMin[i]+'</th>')}}else{for(i=1;i<8;i++){if(i==7){html.append('<th class="dow">'+weekdaysMin[0]+'</th>')}else{html.append('<th class="dow">'+weekdaysMin[i]+'</th>')}}}
picker.widget.find('.datepicker-days thead').append(html)},fillMonths=function(){pMoment.lang(picker.options.language);var html='',i=0,monthsShort=pMoment.monthsShort();while(i<12){html+='<span class="month">'+monthsShort[i++]+'</span>'}
picker.widget.find('.datepicker-months td').append(html)},fillDate=function(){pMoment.lang(picker.options.language);var year=picker.viewDate.year(),month=picker.viewDate.month(),startYear=picker.options.minDate.year(),startMonth=picker.options.minDate.month(),endYear=picker.options.maxDate.year(),endMonth=picker.options.maxDate.month(),currentDate,prevMonth,nextMonth,html=[],row,clsName,i,days,yearCont,currentYear,months=pMoment.months();picker.widget.find('.datepicker-days').find('.disabled').removeClass('disabled');picker.widget.find('.datepicker-months').find('.disabled').removeClass('disabled');picker.widget.find('.datepicker-years').find('.disabled').removeClass('disabled');picker.widget.find('.datepicker-days th:eq(1)').text(months[month]+' '+year);prevMonth=pMoment(picker.viewDate).subtract("months",1);days=prevMonth.daysInMonth();prevMonth.date(days).startOf('week');if((year==startYear&&month<=startMonth)||year<startYear){picker.widget.find('.datepicker-days th:eq(0)').addClass('disabled')}
if((year==endYear&&month>=endMonth)||year>endYear){picker.widget.find('.datepicker-days th:eq(2)').addClass('disabled')}
nextMonth=pMoment(prevMonth).add(42,"d");while(prevMonth.isBefore(nextMonth)){if(prevMonth.weekday()===pMoment().startOf('week').weekday()){row=$('<tr>');html.push(row)}
clsName='';if(prevMonth.year()<year||(prevMonth.year()==year&&prevMonth.month()<month)){clsName+=' old'}else if(prevMonth.year()>year||(prevMonth.year()==year&&prevMonth.month()>month)){clsName+=' new'}
if(prevMonth.isSame(pMoment({y:picker.date.year(),M:picker.date.month(),d:picker.date.date()}))){clsName+=' active'}
if(isInDisableDates(prevMonth)||!isInEnableDates(prevMonth)){clsName+=' disabled'}
if(picker.options.showToday===!0){if(prevMonth.isSame(pMoment(),'day')){clsName+=' today'}}
if(picker.options.daysOfWeekDisabled){for(i in picker.options.daysOfWeekDisabled){if(prevMonth.day()==picker.options.daysOfWeekDisabled[i]){clsName+=' disabled';break}}}
row.append('<td class="day'+clsName+'">'+prevMonth.date()+'</td>');currentDate=prevMonth.date();prevMonth.add(1,"d");if(currentDate==prevMonth.date()){prevMonth.add(1,"d")}}
picker.widget.find('.datepicker-days tbody').empty().append(html);currentYear=picker.date.year(),months=picker.widget.find('.datepicker-months').find('th:eq(1)').text(year).end().find('span').removeClass('active');if(currentYear===year){months.eq(picker.date.month()).addClass('active')}
if(currentYear-1<startYear){picker.widget.find('.datepicker-months th:eq(0)').addClass('disabled')}
if(currentYear+1>endYear){picker.widget.find('.datepicker-months th:eq(2)').addClass('disabled')}
for(i=0;i<12;i++){if((year==startYear&&startMonth>i)||(year<startYear)){$(months[i]).addClass('disabled')}else if((year==endYear&&endMonth<i)||(year>endYear)){$(months[i]).addClass('disabled')}}
html='';year=parseInt(year/10,10)*10;yearCont=picker.widget.find('.datepicker-years').find('th:eq(1)').text(year+'-'+(year+9)).end().find('td');picker.widget.find('.datepicker-years').find('th').removeClass('disabled');if(startYear>year){picker.widget.find('.datepicker-years').find('th:eq(0)').addClass('disabled')}
if(endYear<year+9){picker.widget.find('.datepicker-years').find('th:eq(2)').addClass('disabled')}
year-=1;for(i=-1;i<11;i++){html+='<span class="year'+(i===-1||i===10?' old':'')+(currentYear===year?' active':'')+((year<startYear||year>endYear)?' disabled':'')+'">'+year+'</span>';year+=1}
yearCont.html(html)},fillHours=function(){pMoment.lang(picker.options.language);var table=picker.widget.find('.timepicker .timepicker-hours table'),html='',current,i,j;table.parent().hide();if(picker.use24hours){current=0;for(i=0;i<6;i+=1){html+='<tr>';for(j=0;j<4;j+=1){html+='<td class="hour">'+padLeft(current.toString())+'</td>';current++}
html+='</tr>'}}
else{current=1;for(i=0;i<3;i+=1){html+='<tr>';for(j=0;j<4;j+=1){html+='<td class="hour">'+padLeft(current.toString())+'</td>';current++}
html+='</tr>'}}
table.html(html)},fillMinutes=function(){var table=picker.widget.find('.timepicker .timepicker-minutes table'),html='',current=0,i,j,step=picker.options.minuteStepping;table.parent().hide();if(step==1)step=5;for(i=0;i<Math.ceil(60/step/4);i++){html+='<tr>';for(j=0;j<4;j+=1){if(current<60){html+='<td class="minute">'+padLeft(current.toString())+'</td>';current+=step}else{html+='<td></td>'}}
html+='</tr>'}
table.html(html)},fillSeconds=function(){var table=picker.widget.find('.timepicker .timepicker-seconds table'),html='',current=0,i,j;table.parent().hide();for(i=0;i<3;i++){html+='<tr>';for(j=0;j<4;j+=1){html+='<td class="second">'+padLeft(current.toString())+'</td>';current+=5}
html+='</tr>'}
table.html(html)},fillTime=function(){if(!picker.date)return;var timeComponents=picker.widget.find('.timepicker span[data-time-component]'),hour=picker.date.hours(),period='AM';if(!picker.use24hours){if(hour>=12)period='PM';if(hour===0)hour=12;else if(hour!=12)hour=hour%12;picker.widget.find('.timepicker [data-action=togglePeriod]').text(period)}
timeComponents.filter('[data-time-component=hours]').text(padLeft(hour));timeComponents.filter('[data-time-component=minutes]').text(padLeft(picker.date.minutes()));timeComponents.filter('[data-time-component=seconds]').text(padLeft(picker.date.second()))},click=function(e){e.stopPropagation();e.preventDefault();picker.unset=!1;var target=$(e.target).closest('span, td, th'),month,year,step,day,oldDate=pMoment(picker.date);if(target.length===1){if(!target.is('.disabled')){switch(target[0].nodeName.toLowerCase()){case 'th':switch(target[0].className){case 'switch':showMode(1);break;case 'prev':case 'next':step=dpGlobal.modes[picker.viewMode].navStep;if(target[0].className==='prev')step=step*-1;picker.viewDate.add(step,dpGlobal.modes[picker.viewMode].navFnc);fillDate();break}
break;case 'span':if(target.is('.month')){month=target.parent().find('span').index(target);picker.viewDate.month(month)}else{year=parseInt(target.text(),10)||0;picker.viewDate.year(year)}
if(picker.viewMode===picker.minViewMode){picker.date=pMoment({y:picker.viewDate.year(),M:picker.viewDate.month(),d:picker.viewDate.date(),h:picker.date.hours(),m:picker.date.minutes(),s:picker.date.seconds()});notifyChange(oldDate,e.type);set()}
showMode(-1);fillDate();break;case 'td':if(target.is('.day')){day=parseInt(target.text(),10)||1;month=picker.viewDate.month();year=picker.viewDate.year();if(target.is('.old')){if(month===0){month=11;year-=1}else{month-=1}}else if(target.is('.new')){if(month==11){month=0;year+=1}else{month+=1}}
picker.date=pMoment({y:year,M:month,d:day,h:picker.date.hours(),m:picker.date.minutes(),s:picker.date.seconds()});picker.viewDate=pMoment({y:year,M:month,d:Math.min(28,day)});fillDate();set();notifyChange(oldDate,e.type)}
break}}}},actions={incrementHours:function(){checkDate("add","hours",1)},incrementMinutes:function(){checkDate("add","minutes",picker.options.minuteStepping)},incrementSeconds:function(){checkDate("add","seconds",1)},decrementHours:function(){checkDate("subtract","hours",1)},decrementMinutes:function(){checkDate("subtract","minutes",picker.options.minuteStepping)},decrementSeconds:function(){checkDate("subtract","seconds",1)},togglePeriod:function(){var hour=picker.date.hours();if(hour>=12)hour-=12;else hour+=12;picker.date.hours(hour)},showPicker:function(){picker.widget.find('.timepicker > div:not(.timepicker-picker)').hide();picker.widget.find('.timepicker .timepicker-picker').show()},showHours:function(){picker.widget.find('.timepicker .timepicker-picker').hide();picker.widget.find('.timepicker .timepicker-hours').show()},showMinutes:function(){picker.widget.find('.timepicker .timepicker-picker').hide();picker.widget.find('.timepicker .timepicker-minutes').show()},showSeconds:function(){picker.widget.find('.timepicker .timepicker-picker').hide();picker.widget.find('.timepicker .timepicker-seconds').show()},selectHour:function(e){var period=picker.widget.find('.timepicker [data-action=togglePeriod]').text(),hour=parseInt($(e.target).text(),10);if(period=="PM")hour+=12
picker.date.hours(hour);actions.showPicker.call(picker)},selectMinute:function(e){picker.date.minutes(parseInt($(e.target).text(),10));actions.showPicker.call(picker)},selectSecond:function(e){picker.date.seconds(parseInt($(e.target).text(),10));actions.showPicker.call(picker)}},doAction=function(e){var oldDate=pMoment(picker.date),action=$(e.currentTarget).data('action'),rv=actions[action].apply(picker,arguments);stopEvent(e);if(!picker.date)picker.date=pMoment({y:1970});set();fillTime();notifyChange(oldDate,e.type);return rv},stopEvent=function(e){e.stopPropagation();e.preventDefault()},change=function(e){pMoment.lang(picker.options.language);var input=$(e.target),oldDate=pMoment(picker.date),newDate=pMoment(input.val(),picker.format,picker.options.useStrict);if(newDate.isValid()&&!isInDisableDates(newDate)&&isInEnableDates(newDate)){update();picker.setValue(newDate);notifyChange(oldDate,e.type);set()}
else{picker.viewDate=oldDate;notifyChange(oldDate,e.type);notifyError(newDate);picker.unset=!0}},showMode=function(dir){if(dir){picker.viewMode=Math.max(picker.minViewMode,Math.min(2,picker.viewMode+dir))}
var f=dpGlobal.modes[picker.viewMode].clsName;picker.widget.find('.datepicker > div').hide().filter('.datepicker-'+dpGlobal.modes[picker.viewMode].clsName).show()},attachDatePickerEvents=function(){var $this,$parent,expanded,closed,collapseData;picker.widget.on('click','.datepicker *',$.proxy(click,this));picker.widget.on('click','[data-action]',$.proxy(doAction,this));picker.widget.on('mousedown',$.proxy(stopEvent,this));if(picker.options.pickDate&&picker.options.pickTime){picker.widget.on('click.togglePicker','.accordion-toggle',function(e){e.stopPropagation();$this=$(this);$parent=$this.closest('ul');expanded=$parent.find('.in');closed=$parent.find('.collapse:not(.in)');if(expanded&&expanded.length){collapseData=expanded.data('collapse');if(collapseData&&collapseData.date-transitioning)return;expanded.collapse('hide');closed.collapse('show');$this.find('span').toggleClass(picker.options.icons.time+' '+picker.options.icons.date);picker.element.find('.input-group-addon span').toggleClass(picker.options.icons.time+' '+picker.options.icons.date)}})}
if(picker.isInput){picker.element.on({'focus':$.proxy(picker.show,this),'change':$.proxy(change,this),'blur':$.proxy(picker.hide,this)})}else{picker.element.on({'change':$.proxy(change,this)},'input');if(picker.component){picker.component.on('click',$.proxy(picker.show,this))}else{picker.element.on('click',$.proxy(picker.show,this))}}},attachDatePickerGlobalEvents=function(){$(window).on('resize.datetimepicker'+picker.id,$.proxy(place,this));if(!picker.isInput){$(document).on('mousedown.datetimepicker'+picker.id,$.proxy(picker.hide,this))}},detachDatePickerEvents=function(){picker.widget.off('click','.datepicker *',picker.click);picker.widget.off('click','[data-action]');picker.widget.off('mousedown',picker.stopEvent);if(picker.options.pickDate&&picker.options.pickTime){picker.widget.off('click.togglePicker')}
if(picker.isInput){picker.element.off({'focus':picker.show,'change':picker.change})}else{picker.element.off({'change':picker.change},'input');if(picker.component){picker.component.off('click',picker.show)}else{picker.element.off('click',picker.show)}}},detachDatePickerGlobalEvents=function(){$(window).off('resize.datetimepicker'+picker.id);if(!picker.isInput){$(document).off('mousedown.datetimepicker'+picker.id)}},isInFixed=function(){if(picker.element){var parents=picker.element.parents(),inFixed=!1,i;for(i=0;i<parents.length;i++){if($(parents[i]).css('position')=='fixed'){inFixed=!0;break}};return inFixed}else{return!1}},set=function(){pMoment.lang(picker.options.language);var formatted='',input;if(!picker.unset)formatted=pMoment(picker.date).format(picker.format);getPickerInput().val(formatted);picker.element.data('date',formatted);if(!picker.options.pickTime)picker.hide()},checkDate=function(direction,unit,amount){pMoment.lang(picker.options.language);var newDate;if(direction=="add"){newDate=pMoment(picker.date);if(newDate.hours()==23)newDate.add(amount,unit);newDate.add(amount,unit)}
else{newDate=pMoment(picker.date).subtract(amount,unit)}
if(isInDisableDates(pMoment(newDate.subtract(amount,unit)))||isInDisableDates(newDate)){notifyError(newDate.format(picker.format));return}
if(direction=="add"){picker.date.add(amount,unit)}
else{picker.date.subtract(amount,unit)}
picker.unset=!1},isInDisableDates=function(date){pMoment.lang(picker.options.language);if(date.isAfter(picker.options.maxDate)||date.isBefore(picker.options.minDate))return!0;if(picker.options.disabledDates===!1){return!1}
return picker.options.disabledDates[pMoment(date).format("YYYY-MM-DD")]===!0},isInEnableDates=function(date){pMoment.lang(picker.options.language);if(picker.options.enabledDates===!1){return!0}
return picker.options.enabledDates[pMoment(date).format("YYYY-MM-DD")]===!0},indexGivenDates=function(givenDatesArray){var givenDatesIndexed={};var givenDatesCount=0;for(i=0;i<givenDatesArray.length;i++){dDate=pMoment(givenDatesArray[i]);if(dDate.isValid()){givenDatesIndexed[dDate.format("YYYY-MM-DD")]=!0;givenDatesCount++}}
if(givenDatesCount>0){return givenDatesIndexed}
return!1},padLeft=function(string){string=string.toString();if(string.length>=2)return string;else return '0'+string},getTemplate=function(){if(picker.options.pickDate&&picker.options.pickTime){var ret='';ret='<div id="fd" class="bootstrap-datetimepicker-widget'+(picker.options.sideBySide?' timepicker-sbs':'')+' '+(picker.options.component)+'" style="z-index:9999 !important;">';if(picker.options.sideBySide){ret+='<div class="row">'+'<div class="col-sm-6 datepicker">'+dpGlobal.template+'</div>'+'<div class="col-sm-6 timepicker">'+tpGlobal.getTemplate()+'</div>'+'</div>'}else{ret+='<ul class="list-unstyled">'+'<li'+(picker.options.collapse?' class="collapse in"':'')+'>'+'<div class="datepicker">'+dpGlobal.template+'</div>'+'</li>'+'<li class="picker-switch accordion-toggle"><a class="btn btn-primary" style="width:100%"><span class="'+picker.options.icons.time+'"></span></a></li>'+'<li'+(picker.options.collapse?' class="collapse"':'')+'>'+'<div class="timepicker">'+tpGlobal.getTemplate()+'</div>'+'</li>'+'</ul>'}
ret+='</div>';return ret}else if(picker.options.pickTime){return('<div id="fd" class="bootstrap-datetimepicker-widget">'+'<div class="timepicker">'+tpGlobal.getTemplate()+'</div>'+'</div>')}else{return('<div id="fd" class="bootstrap-datetimepicker-widget">'+'<div class="datepicker">'+dpGlobal.template+'</div>'+'</div>')}},dpGlobal={modes:[{clsName:'days',navFnc:'month',navStep:1},{clsName:'months',navFnc:'year',navStep:1},{clsName:'years',navFnc:'year',navStep:10}],headTemplate:'<thead>'+'<tr>'+'<th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th>'+'</tr>'+'</thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'},tpGlobal={hourTemplate:'<span data-action="showHours"   data-time-component="hours"   class="timepicker-hour"></span>',minuteTemplate:'<span data-action="showMinutes" data-time-component="minutes" class="timepicker-minute"></span>',secondTemplate:'<span data-action="showSeconds"  data-time-component="seconds" class="timepicker-second"></span>'};dpGlobal.template='<div class="datepicker-days">'+'<table class="table-condensed">'+dpGlobal.headTemplate+'<tbody></tbody></table>'+'</div>'+'<div class="datepicker-months">'+'<table class="table-condensed">'+dpGlobal.headTemplate+dpGlobal.contTemplate+'</table>'+'</div>'+'<div class="datepicker-years">'+'<table class="table-condensed">'+dpGlobal.headTemplate+dpGlobal.contTemplate+'</table>'+'</div>';tpGlobal.getTemplate=function(){return('<div class="timepicker-picker">'+'<table class="table-condensed">'+'<tr>'+'<td><a href="#" class="btn" data-action="incrementHours"><i class="'+picker.options.icons.up+'"></i></a></td>'+'<td class="separator"></td>'+'<td>'+(picker.options.useMinutes?'<a href="#" class="btn" data-action="incrementMinutes"><i class="'+picker.options.icons.up+'"></i></a>':'')+'</td>'+(picker.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn" data-action="incrementSeconds"><i class="'+picker.options.icons.up+'"></i></a></td>':'')+(picker.use24hours?'':'<td class="separator"></td>')+'</tr>'+'<tr>'+'<td>'+tpGlobal.hourTemplate+'</td> '+'<td class="separator">:</td>'+'<td>'+(picker.options.useMinutes?tpGlobal.minuteTemplate:'<span class="timepicker-minute">00</span>')+'</td> '+(picker.options.useSeconds?'<td class="separator">:</td><td>'+tpGlobal.secondTemplate+'</td>':'')+(picker.use24hours?'':'<td class="separator"></td>'+'<td><button type="button" class="btn btn-primary" data-action="togglePeriod"></button></td>')+'</tr>'+'<tr>'+'<td><a href="#" class="btn" data-action="decrementHours"><i class="'+picker.options.icons.down+'"></i></a></td>'+'<td class="separator"></td>'+'<td>'+(picker.options.useMinutes?'<a href="#" class="btn" data-action="decrementMinutes"><i class="'+picker.options.icons.down+'"></i></a>':'')+'</td>'+(picker.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn" data-action="decrementSeconds"><i class="'+picker.options.icons.down+'"></i></a></td>':'')+(picker.use24hours?'':'<td class="separator"></td>')+'</tr>'+'</table>'+'</div>'+'<div class="timepicker-hours" data-action="selectHour">'+'<table class="table-condensed"></table>'+'</div>'+'<div class="timepicker-minutes" data-action="selectMinute">'+'<table class="table-condensed"></table>'+'</div>'+(picker.options.useSeconds?'<div class="timepicker-seconds" data-action="selectSecond"><table class="table-condensed"></table></div>':''))};picker.destroy=function(){detachDatePickerEvents();detachDatePickerGlobalEvents();picker.widget.remove();picker.element.removeData('DateTimePicker');if(picker.component)
picker.component.removeData('DateTimePicker')};picker.show=function(e){if(picker.options.useCurrent){if(getPickerInput().val()==''){if(picker.options.minuteStepping!==1){var mDate=pMoment(),rInterval=picker.options.minuteStepping;mDate.minutes((Math.round(mDate.minutes()/rInterval)*rInterval)%60).seconds(0);picker.setValue(mDate.format(picker.format))}else{picker.setValue(pMoment().format(picker.format))}}}
if(picker.widget.hasClass("picker-open")){picker.widget.hide();picker.widget.removeClass("picker-open")}
else{picker.widget.show();picker.widget.addClass("picker-open")}
picker.height=picker.component?picker.component.outerHeight():picker.element.outerHeight();place();picker.element.trigger({type:'dp.show',date:pMoment(picker.date)});attachDatePickerGlobalEvents();if(e){stopEvent(e)}},picker.disable=function(){var input=picker.element.find('input');if(input.prop('disabled'))return;input.prop('disabled',!0);detachDatePickerEvents()},picker.enable=function(){var input=picker.element.find('input');if(!input.prop('disabled'))return;input.prop('disabled',!1);attachDatePickerEvents()},picker.hide=function(event){if(event&&$(event.target).is(picker.element.attr("id")))
return;var collapse=picker.widget.find('.collapse'),i,collapseData;for(i=0;i<collapse.length;i++){collapseData=collapse.eq(i).data('collapse');if(collapseData&&collapseData.date-transitioning)
return}
picker.widget.hide();picker.widget.removeClass("picker-open");picker.viewMode=picker.startViewMode;showMode();picker.element.trigger({type:'dp.hide',date:pMoment(picker.date)});detachDatePickerGlobalEvents()},picker.setValue=function(newDate){pMoment.lang(picker.options.language);if(!newDate){picker.unset=!0;set()}else{picker.unset=!1}
if(!pMoment.isMoment(newDate))newDate=pMoment(newDate,picker.format);if(newDate.isValid()){picker.date=newDate;set();picker.viewDate=pMoment({y:picker.date.year(),M:picker.date.month()});fillDate();fillTime()}
else{notifyError(newDate)}},picker.getDate=function(){if(picker.unset)return null;return picker.date},picker.setDate=function(date){var oldDate=pMoment(picker.date);if(!date){picker.setValue(null)}else{picker.setValue(date)}
notifyChange(oldDate,"function")},picker.setDisabledDates=function(dates){picker.options.disabledDates=indexGivenDates(dates);if(picker.viewDate)update()},picker.setEnabledDates=function(dates){picker.options.enabledDates=indexGivenDates(dates);if(picker.viewDate)update()},picker.setMaxDate=function(date){if(date==undefined)return;picker.options.maxDate=pMoment(date);if(picker.viewDate)update()},picker.setMinDate=function(date){if(date==undefined)return;picker.options.minDate=pMoment(date);if(picker.viewDate)update()};init()};$.fn._datetimepicker=function(options){return this.each(function(){var $this=$(this),data=$this.data('DateTimePicker');if(!data)$this.data('DateTimePicker',new DateTimePicker(this,options))})}};exports();module.resolveWith(exports)})};FD40.module("datetimepicker",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;$.require().script("ui/position").done(function(){var exports=function(){$.fn.popbox=function(options){if($.isPlainObject(options)){this.each(function(){var button=$(this),popbox=Popbox.get(button);if(popbox){popbox.update(options)}else{popbox=new Popbox(button,options)}});return this}
if($.isString(options)){var button=$(this[0]),popbox=Popbox.get(button)||new Popbox(button),method=popbox[options],ret;if($.isFunction(method)){ret=method.apply(popbox,$.makeArray(arguments).slice(1))}
return ret||this}
return this}
var Popbox=function(button,options){var popbox=this;button.data("popbox",popbox);if($.isString(options)){options={content:options}}
if(!options){options={}}
button.parentsUntil("body").addBack().each(function(){var parent=$(this);if(parent.css("position")==="fixed"){options.fixed=!0;return!1}});var elementOptions={},content=button.attr("data-popbox")||button.find("[data-popbox-content]").html()||$(button.attr("data-popbox-target")).html();if(content)elementOptions.content=content;$(["id","component","type","toggle","position","collision"]).each(function(i,key){var val=button.attr("data-popbox-"+key);elementOptions[key]=val});if(content===undefined)button.attr("data-popbox","");popbox.update($.extend(!0,{},Popbox.defaultOptions,{tooltip:$(),loader:$('<div id="fd" class="popbox loading" data-popbox-tooltip><div class="arrow"></div></div>'),uid:$.uid(),button:button},elementOptions,options))};Popbox.defaultOptions={content:"",id:null,type:"",enabled:!1,wait:!1,locked:!1,exclusive:!1,hideTimer:null,hideDelay:50,toggle:"hover",position:"bottom",collision:"flip",cache:!0,fixed:!1,offset:10};Popbox.get=function(el){var popbox=$(el).data("popbox");if(popbox instanceof Popbox)return popbox}
Popbox.toggleEvent=navigator.userAgent.match(/iPhone|iPad|iPod/i)?"touchstart":"click";$.extend(Popbox.prototype,{positions:"top top-left top-right top-center bottom bottom-left bottom-right bottom-center left left-top left-bottom left-center right right-top right-bottom right-center",update:function(options){var popbox=this;$.extend(!0,popbox,options);if($.isModule(popbox.content)){popbox.wait=!0;$.module(popbox.content).done(function(options){if($.isPlainObject(options)){popbox.update(options)}
if($.isFunction(options)){popbox.update({content:options})}}).fail(function(){popbox.update({content:"Unable to load tooltip content."})}).always(function(){popbox.wait=!1});return}
if($.isString(popbox.content)){popbox.content=$.Deferred().resolve(popbox.content)}
var position=popbox.position;if($.isString(position)){var pos=position.split("-"),x1,y1,x2,y2;switch(pos[0]){case "top":case "bottom":x1=x2=pos[1]||"center";y1=pos[0]=="top"?"bottom":"top";y2=pos[0]=="top"?"top":"bottom";break;case "left":case "right":y1=y2=pos[1]||"center";x1=pos[0]=="left"?"right":"left";x2=pos[0]=="left"?"left":"right";break}
popbox.position={classname:position,my:x1+" "+y1,at:x2+" "+y2,using:function(coords,feedback){var tooltip=$(this),classname=popbox.position.classname,top=coords.top,left=coords.left,offset=popbox.offset,buttonOffset=popbox.button.offset();switch(pos[0]){case "top":case "bottom":var vertical=feedback.vertical;if(vertical==pos[0]){classname=classname.replace(/top|bottom/gi,(vertical=="top")?"bottom":"top")}
top=(vertical=="top")?top+offset:top-offset;if(pos[1]=="left"&&(left<Math.floor(buttonOffset.left))){classname=classname.replace(/left|right/gi,(pos[1]=="left")?"right":"left")}
break;case "left":case "right":var horizontal=feedback.horizontal;if(feedback.horizontal==pos[0]){classname=classname.replace(/left|right/gi,(feedback.horizontal=="left")?"right":"left")}
left=(horizontal=="left")?left+offset:left-offset;break}
tooltip.css({top:top+'px',left:left+'px'}).removeClass(popbox.positions).addClass(classname)}}}
$.extend(popbox.position,{of:popbox.button,collision:popbox.collision});popbox.loader.attr({"id":popbox.id,"data-popbox-tooltip":popbox.type,"style":popbox.fixed?'position: fixed':''}).addClass(popbox.component).addClass("popbox-"+popbox.type);if(popbox.enabled){popbox.show()}},trigger:function(event,args){var popbox=this;this.tooltip.trigger(event,args);this.button.trigger(event,args)},show:function(){var popbox=this;popbox.enabled=!0;if(popbox.wait)return;clearTimeout(popbox.hideTimer);if(popbox.exclusive){$("[data-popbox-tooltip]").each(function(){var popbox=Popbox.get($(this));if(!popbox)return;popbox.hide()})}
if(popbox.toggle=="click"){var doc=$(document),hideOnClick=Popbox.toggleEvent+".popbox."+popbox.uid;doc.off(hideOnClick).on(hideOnClick,function(event){var targets=$(event.target).parents().andSelf();if(targets.filter(popbox.button).length>0||targets.filter(popbox.tooltip).length>0)return;doc.off(hideOnClick);popbox.hide()})}
var win=$(window),repositionOnResize="resize.popbox"+popbox.uid;win.off(repositionOnResize).on(repositionOnResize,function(){if(popbox.tooltip.length>0){popbox.tooltip.position(popbox.position)}});if(popbox.tooltip.length>0){popbox.tooltip.appendTo("body").position(popbox.position);popbox.trigger("popboxActivate",[popbox]);return}
if($.isFunction(popbox.content)){var options=popbox.content(popbox);popbox.update(options);if(popbox.wait)return}
if(!$.isDeferred(popbox.content))return;if(popbox.content.state()=="pending"){popbox.loader.appendTo("body").position(popbox.position);popbox.trigger("popboxLoading",[popbox])}
popbox.content.always(function(){popbox.wait=!1}).done(function(html){if(popbox.tooltip.length>0)return;if(!popbox.enabled)return;popbox.loader.detach();var tooltip=$.buildHTML(html);if(tooltip.filter("[data-popbox-tooltip]").length<1){var content=tooltip;tooltip=$('<div id="fd" class="popbox" data-popbox-tooltip><div class="arrow"></div><div class="popbox-content" data-popbox-content></div></div>').attr({"id":popbox.id,"data-popbox-tooltip":popbox.type,"style":popbox.fixed?'position: fixed':''}).addClass(popbox.component).addClass("popbox-"+popbox.type).appendTo("body");tooltip.find('[data-popbox-content]').append(content)}else{tooltip=tooltip.appendTo("body").filter("[data-popbox-tooltip]")}
popbox.tooltip=tooltip.data("popbox",popbox).position(popbox.position);popbox.trigger("popboxActivate",[popbox])}).fail(function(){popbox.update({content:"Unable to load tooltip content."})})},hide:function(force){var popbox=this;popbox.enabled=!1;clearTimeout(popbox.hideTimer);popbox.loader.detach();var hide=function(){if(popbox.locked&&!force)return;popbox.tooltip.detach();$(window).off("resize.popbox"+popbox.uid);popbox.trigger("popboxDeactivate",[popbox]);if(!popbox.cache){popbox.destroy()}}
popbox.hideTimer=setTimeout(hide,popbox.hideDelay)},destroy:function(){this.button.removeData("popbox")},widget:function(){return this}});$(document).on(Popbox.toggleEvent+'.popbox','[data-popbox]',function(){var popbox=$(this).popbox("widget");if(popbox.enabled){popbox.hide()}else{popbox.show()}}).on('mouseover.popbox','[data-popbox]',function(){var popbox=$(this).popbox("widget");if(popbox.toggle=="hover")popbox.show()}).on('mouseout.popbox','[data-popbox]',function(){var popbox=$(this).popbox("widget");if(popbox.toggle=="hover")popbox.hide()}).on('mouseover.popbox.tooltip','[data-popbox-tooltip]',function(){var popbox=Popbox.get(this);if(!popbox)return;if(popbox.toggle!=="hover")return;popbox.locked=!0;clearTimeout(popbox.hideTimer)}).on('mouseout.popbox.tooltip','[data-popbox-tooltip]',function(){var popbox=Popbox.get(this);if(!popbox)return;if(popbox.toggle!=="hover")return;popbox.locked=!1;popbox.hide()}).on('click.popbox.close','[data-popbox-close]',function(){var popbox=Popbox.get($(this).parents('[data-popbox-tooltip]'));if(!popbox)return;popbox.hide()})};exports();module.resolveWith(exports)})};FD40.module("popbox",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function($,undefined){$.ui=$.ui||{};var cachedScrollbarWidth,max=Math.max,abs=Math.abs,round=Math.round,rhorizontal=/left|center|right/,rvertical=/top|center|bottom/,roffset=/[\+\-]\d+(\.[\d]+)?%?/,rposition=/^\w+/,rpercent=/%$/,_position=$.fn.position;function getOffsets(offsets,width,height){return[parseFloat(offsets[0])*(rpercent.test(offsets[0])?width/100:1),parseFloat(offsets[1])*(rpercent.test(offsets[1])?height/100:1)]}
function parseCss(element,property){return parseInt($.css(element,property),10)||0}
function getDimensions(elem){var raw=elem[0];if(raw.nodeType===9){return{width:elem.width(),height:elem.height(),offset:{top:0,left:0}}}
if($.isWindow(raw)){return{width:elem.width(),height:elem.height(),offset:{top:elem.scrollTop(),left:elem.scrollLeft()}}}
if(raw.preventDefault){return{width:0,height:0,offset:{top:raw.pageY,left:raw.pageX}}}
return{width:elem.outerWidth(),height:elem.outerHeight(),offset:elem.offset()}}
$.position={scrollbarWidth:function(){if(cachedScrollbarWidth!==undefined){return cachedScrollbarWidth}
var w1,w2,div=$("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),innerDiv=div.children()[0];$("body").append(div);w1=innerDiv.offsetWidth;div.css("overflow","scroll");w2=innerDiv.offsetWidth;if(w1===w2){w2=div[0].clientWidth}
div.remove();return(cachedScrollbarWidth=w1-w2)},getScrollInfo:function(within){var overflowX=within.isWindow?"":within.element.css("overflow-x"),overflowY=within.isWindow?"":within.element.css("overflow-y"),hasOverflowX=overflowX==="scroll"||(overflowX==="auto"&&within.width<within.element[0].scrollWidth),hasOverflowY=overflowY==="scroll"||(overflowY==="auto"&&within.height<within.element[0].scrollHeight);return{width:hasOverflowY?$.position.scrollbarWidth():0,height:hasOverflowX?$.position.scrollbarWidth():0}},getWithinInfo:function(element){var withinElement=$(element||window),isWindow=$.isWindow(withinElement[0]);return{element:withinElement,isWindow:isWindow,offset:withinElement.offset()||{left:0,top:0},scrollLeft:withinElement.scrollLeft(),scrollTop:withinElement.scrollTop(),width:isWindow?withinElement.width():withinElement.outerWidth(),height:isWindow?withinElement.height():withinElement.outerHeight()}}};$.fn.position=function(options){if(!options||!options.of){return _position.apply(this,arguments)}
options=$.extend({},options);var atOffset,targetWidth,targetHeight,targetOffset,basePosition,dimensions,target=$(options.of),within=$.position.getWithinInfo(options.within),scrollInfo=$.position.getScrollInfo(within),collision=(options.collision||"flip").split(" "),offsets={};dimensions=getDimensions(target);if(target[0].preventDefault){options.at="left top"}
targetWidth=dimensions.width;targetHeight=dimensions.height;targetOffset=dimensions.offset;basePosition=$.extend({},targetOffset);$.each(["my","at"],function(){var pos=(options[this]||"").split(" "),horizontalOffset,verticalOffset;if(pos.length===1){pos=rhorizontal.test(pos[0])?pos.concat(["center"]):rvertical.test(pos[0])?["center"].concat(pos):["center","center"]}
pos[0]=rhorizontal.test(pos[0])?pos[0]:"center";pos[1]=rvertical.test(pos[1])?pos[1]:"center";horizontalOffset=roffset.exec(pos[0]);verticalOffset=roffset.exec(pos[1]);offsets[this]=[horizontalOffset?horizontalOffset[0]:0,verticalOffset?verticalOffset[0]:0];options[this]=[rposition.exec(pos[0])[0],rposition.exec(pos[1])[0]]});if(collision.length===1){collision[1]=collision[0]}
if(options.at[0]==="right"){basePosition.left+=targetWidth}else if(options.at[0]==="center"){basePosition.left+=targetWidth/2}
if(options.at[1]==="bottom"){basePosition.top+=targetHeight}else if(options.at[1]==="center"){basePosition.top+=targetHeight/2}
atOffset=getOffsets(offsets.at,targetWidth,targetHeight);basePosition.left+=atOffset[0];basePosition.top+=atOffset[1];return this.each(function(){var collisionPosition,using,elem=$(this),elemWidth=elem.outerWidth(),elemHeight=elem.outerHeight(),marginLeft=parseCss(this,"marginLeft"),marginTop=parseCss(this,"marginTop"),collisionWidth=elemWidth+marginLeft+parseCss(this,"marginRight")+scrollInfo.width,collisionHeight=elemHeight+marginTop+parseCss(this,"marginBottom")+scrollInfo.height,position=$.extend({},basePosition),myOffset=getOffsets(offsets.my,elem.outerWidth(),elem.outerHeight());if(options.my[0]==="right"){position.left-=elemWidth}else if(options.my[0]==="center"){position.left-=elemWidth/2}
if(options.my[1]==="bottom"){position.top-=elemHeight}else if(options.my[1]==="center"){position.top-=elemHeight/2}
position.left+=myOffset[0];position.top+=myOffset[1];if(!$.support.offsetFractions){position.left=round(position.left);position.top=round(position.top)}
collisionPosition={marginLeft:marginLeft,marginTop:marginTop};$.each(["left","top"],function(i,dir){if($.ui.position[collision[i]]){$.ui.position[collision[i]][dir](position,{targetWidth:targetWidth,targetHeight:targetHeight,elemWidth:elemWidth,elemHeight:elemHeight,collisionPosition:collisionPosition,collisionWidth:collisionWidth,collisionHeight:collisionHeight,offset:[atOffset[0]+myOffset[0],atOffset[1]+myOffset[1]],my:options.my,at:options.at,within:within,elem:elem})}});if(options.using){using=function(props){var left=targetOffset.left-position.left,right=left+targetWidth-elemWidth,top=targetOffset.top-position.top,bottom=top+targetHeight-elemHeight,feedback={target:{element:target,left:targetOffset.left,top:targetOffset.top,width:targetWidth,height:targetHeight},element:{element:elem,left:position.left,top:position.top,width:elemWidth,height:elemHeight},horizontal:right<0?"left":left>0?"right":"center",vertical:bottom<0?"top":top>0?"bottom":"middle"};if(targetWidth<elemWidth&&abs(left+right)<targetWidth){feedback.horizontal="center"}
if(targetHeight<elemHeight&&abs(top+bottom)<targetHeight){feedback.vertical="middle"}
if(max(abs(left),abs(right))>max(abs(top),abs(bottom))){feedback.important="horizontal"}else{feedback.important="vertical"}
options.using.call(this,props,feedback)}}
elem.offset($.extend(position,{using:using}))})};$.ui.position={fit:{left:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollLeft:within.offset.left,outerWidth=within.width,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=withinOffset-collisionPosLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-withinOffset,newOverRight;if(data.collisionWidth>outerWidth){if(overLeft>0&&overRight<=0){newOverRight=position.left+overLeft+data.collisionWidth-outerWidth-withinOffset;position.left+=overLeft-newOverRight}else if(overRight>0&&overLeft<=0){position.left=withinOffset}else{if(overLeft>overRight){position.left=withinOffset+outerWidth-data.collisionWidth}else{position.left=withinOffset}}}else if(overLeft>0){position.left+=overLeft}else if(overRight>0){position.left-=overRight}else{position.left=max(position.left-collisionPosLeft,position.left)}},top:function(position,data){var within=data.within,withinOffset=within.isWindow?within.scrollTop:within.offset.top,outerHeight=data.within.height,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=withinOffset-collisionPosTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-withinOffset,newOverBottom;if(data.collisionHeight>outerHeight){if(overTop>0&&overBottom<=0){newOverBottom=position.top+overTop+data.collisionHeight-outerHeight-withinOffset;position.top+=overTop-newOverBottom}else if(overBottom>0&&overTop<=0){position.top=withinOffset}else{if(overTop>overBottom){position.top=withinOffset+outerHeight-data.collisionHeight}else{position.top=withinOffset}}}else if(overTop>0){position.top+=overTop}else if(overBottom>0){position.top-=overBottom}else{position.top=max(position.top-collisionPosTop,position.top)}}},flip:{left:function(position,data){var within=data.within,withinOffset=within.offset.left+within.scrollLeft,outerWidth=within.width,offsetLeft=within.isWindow?within.scrollLeft:within.offset.left,collisionPosLeft=position.left-data.collisionPosition.marginLeft,overLeft=collisionPosLeft-offsetLeft,overRight=collisionPosLeft+data.collisionWidth-outerWidth-offsetLeft,myOffset=data.my[0]==="left"?-data.elemWidth:data.my[0]==="right"?data.elemWidth:0,atOffset=data.at[0]==="left"?data.targetWidth:data.at[0]==="right"?-data.targetWidth:0,offset=-2*data.offset[0],newOverRight,newOverLeft;if(overLeft<0){newOverRight=position.left+myOffset+atOffset+offset+data.collisionWidth-outerWidth-withinOffset;if(newOverRight<0||newOverRight<abs(overLeft)){position.left+=myOffset+atOffset+offset}}
else if(overRight>0){newOverLeft=position.left-data.collisionPosition.marginLeft+myOffset+atOffset+offset-offsetLeft;if(newOverLeft>0||abs(newOverLeft)<overRight){position.left+=myOffset+atOffset+offset}}},top:function(position,data){var within=data.within,withinOffset=within.offset.top+within.scrollTop,outerHeight=within.height,offsetTop=within.isWindow?within.scrollTop:within.offset.top,collisionPosTop=position.top-data.collisionPosition.marginTop,overTop=collisionPosTop-offsetTop,overBottom=collisionPosTop+data.collisionHeight-outerHeight-offsetTop,top=data.my[1]==="top",myOffset=top?-data.elemHeight:data.my[1]==="bottom"?data.elemHeight:0,atOffset=data.at[1]==="top"?data.targetHeight:data.at[1]==="bottom"?-data.targetHeight:0,offset=-2*data.offset[1],newOverTop,newOverBottom;if(overTop<0){newOverBottom=position.top+myOffset+atOffset+offset+data.collisionHeight-outerHeight-withinOffset;if((position.top+myOffset+atOffset+offset)>overTop&&(newOverBottom<0||newOverBottom<abs(overTop))){position.top+=myOffset+atOffset+offset}}
else if(overBottom>0){newOverTop=position.top-data.collisionPosition.marginTop+myOffset+atOffset+offset-offsetTop;if((position.top+myOffset+atOffset+offset)>overBottom&&(newOverTop>0||abs(newOverTop)<overBottom)){position.top+=myOffset+atOffset+offset}}}},flipfit:{left:function(){$.ui.position.flip.left.apply(this,arguments);$.ui.position.fit.left.apply(this,arguments)},top:function(){$.ui.position.flip.top.apply(this,arguments);$.ui.position.fit.top.apply(this,arguments)}}};(function(){var testElement,testElementParent,testElementStyle,offsetLeft,i,body=document.getElementsByTagName("body")[0],div=document.createElement("div");testElement=document.createElement(body?"div":"body");testElementStyle={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};if(body){$.extend(testElementStyle,{position:"absolute",left:"-1000px",top:"-1000px"})}
for(i in testElementStyle){testElement.style[i]=testElementStyle[i]}
testElement.appendChild(div);testElementParent=body||document.documentElement;testElementParent.insertBefore(testElement,testElementParent.firstChild);div.style.cssText="position: absolute; left: 10.7432222px;";offsetLeft=$(div).offset().left;$.support.offsetFractions=offsetLeft>10&&offsetLeft<11;testElement.innerHTML="";testElementParent.removeChild(testElement)})()}(jQuery))};exports();module.resolveWith(exports)};FD40.module("ui/position",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var callbackId=$.callback(function(){if(!window.google&&!window.google.maps){module.reject("Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true.")}
var GMaps=(function(global){"use strict";var doc=document;var getElementById=function(id,context){return $("#"+id.replace('#',''),context)[0]};var GMaps=function(options){var self=this;var events_that_hide_context_menu=['bounds_changed','center_changed','click','dblclick','drag','dragend','dragstart','idle','maptypeid_changed','projection_changed','resize','tilesloaded','zoom_changed'];var events_that_doesnt_hide_context_menu=['mousemove','mouseout','mouseover'];window.context_menu={};if(typeof(options.el)==='string'||typeof(options.div)==='string'){this.el=getElementById(options.el||options.div,options.context)}else{this.el=options.el||options.div};if(typeof(this.el)==='undefined'||this.el===null){throw 'No element defined.'}
this.el.style.width=options.width||this.el.scrollWidth||this.el.offsetWidth;this.el.style.height=options.height||this.el.scrollHeight||this.el.offsetHeight;this.controls=[];this.overlays=[];this.layers=[];this.singleLayers={};this.markers=[];this.polylines=[];this.routes=[];this.polygons=[];this.infoWindow=null;this.overlay_el=null;this.zoom=options.zoom||15;this.registered_events={};var markerClusterer=options.markerClusterer;var mapType;if(options.mapType){mapType=google.maps.MapTypeId[options.mapType.toUpperCase()]}
else{mapType=google.maps.MapTypeId.ROADMAP}
var map_center=new google.maps.LatLng(options.lat,options.lng);delete options.el;delete options.lat;delete options.lng;delete options.mapType;delete options.width;delete options.height;delete options.markerClusterer;var zoomControlOpt=options.zoomControlOpt||{style:'DEFAULT',position:'TOP_LEFT'};var zoomControl=options.zoomControl||!0,zoomControlStyle=zoomControlOpt.style||'DEFAULT',zoomControlPosition=zoomControlOpt.position||'TOP_LEFT',panControl=options.panControl||!0,mapTypeControl=options.mapTypeControl||!0,scaleControl=options.scaleControl||!0,streetViewControl=options.streetViewControl||!0,overviewMapControl=overviewMapControl||!0;var map_options={};var map_base_options={zoom:this.zoom,center:map_center,mapTypeId:mapType};var map_controls_options={panControl:panControl,zoomControl:zoomControl,zoomControlOptions:{style:google.maps.ZoomControlStyle[zoomControlStyle],position:google.maps.ControlPosition[zoomControlPosition]},mapTypeControl:mapTypeControl,scaleControl:scaleControl,streetViewControl:streetViewControl,overviewMapControl:overviewMapControl}
if(options.disableDefaultUI!=!0)
map_base_options=extend_object(map_base_options,map_controls_options);map_options=extend_object(map_base_options,options);for(var i=0;i<events_that_hide_context_menu.length;i++){delete map_options[events_that_hide_context_menu[i]]}
for(var i=0;i<events_that_doesnt_hide_context_menu.length;i++){delete map_options[events_that_doesnt_hide_context_menu[i]]}
this.map=new google.maps.Map(this.el,map_options);if(markerClusterer){this.markerClusterer=markerClusterer.apply(this,[this.map])}
var findAbsolutePosition=function(obj){var curleft=0;var curtop=0;if(obj.offsetParent){do{curleft+=obj.offsetLeft;curtop+=obj.offsetTop}while(obj=obj.offsetParent)}
return[curleft,curtop]}
var buildContextMenuHTML=function(control,e){var html='';var options=window.context_menu[control];for(var i in options){if(options.hasOwnProperty(i)){var option=options[i];html+='<li><a id="'+control+'_'+i+'" href="#">'+option.title+'</a></li>'}}
if(!getElementById('gmaps_context_menu'))return;var context_menu_element=getElementById('gmaps_context_menu');context_menu_element.innerHTML=html;var context_menu_items=context_menu_element.getElementsByTagName('a');var context_menu_items_count=context_menu_items.length;for(var i=0;i<context_menu_items_count;i++){var context_menu_item=context_menu_items[i];var assign_menu_item_action=function(ev){ev.preventDefault();options[this.id.replace(control+'_','')].action.apply(self,[e]);self.hideContextMenu()};google.maps.event.clearListeners(context_menu_item,'click');google.maps.event.addDomListenerOnce(context_menu_item,'click',assign_menu_item_action,!1)}
var position=findAbsolutePosition.apply(this,[self.el]);var left=position[0]+e.pixel.x-15;var top=position[1]+e.pixel.y-15;context_menu_element.style.left=left+"px";context_menu_element.style.top=top+"px";context_menu_element.style.display='block'};var buildContextMenu=function(control,e){if(control==='marker'){e.pixel={};var overlay=new google.maps.OverlayView();overlay.setMap(self.map);overlay.draw=function(){var projection=overlay.getProjection();var position=e.marker.getPosition();e.pixel=projection.fromLatLngToContainerPixel(position);buildContextMenuHTML(control,e)}}
else{buildContextMenuHTML(control,e)}};this.setContextMenu=function(options){window.context_menu[options.control]={};for(var i in options.options){if(options.options.hasOwnProperty(i)){var option=options.options[i];window.context_menu[options.control][option.name]={title:option.title,action:option.action}}}
var ul=doc.createElement('ul');ul.id='gmaps_context_menu';ul.style.display='none';ul.style.position='absolute';ul.style.minWidth='100px';ul.style.background='white';ul.style.listStyle='none';ul.style.padding='8px';ul.style.boxShadow='2px 2px 6px #ccc';doc.body.appendChild(ul);var context_menu_element=getElementById('gmaps_context_menu');google.maps.event.addDomListener(context_menu_element,'mouseout',function(ev){if(!ev.relatedTarget||!this.contains(ev.relatedTarget)){window.setTimeout(function(){context_menu_element.style.display='none'},400)}},!1)};this.hideContextMenu=function(){var context_menu_element=getElementById('gmaps_context_menu');if(context_menu_element)
context_menu_element.style.display='none'};var setupListener=function(object,name){google.maps.event.addListener(object,name,function(e){if(e==undefined){e=this}
options[name].apply(this,[e]);self.hideContextMenu()})}
for(var ev=0;ev<events_that_hide_context_menu.length;ev++){var name=events_that_hide_context_menu[ev];if(name in options){setupListener(this.map,name)}}
for(var ev=0;ev<events_that_doesnt_hide_context_menu.length;ev++){var name=events_that_doesnt_hide_context_menu[ev];if(name in options){setupListener(this.map,name)}}
google.maps.event.addListener(this.map,'rightclick',function(e){if(options.rightclick){options.rightclick.apply(this,[e])}
if(window.context_menu.map!=undefined){buildContextMenu('map',e)}});this.refresh=function(){google.maps.event.trigger(this.map,'resize')};this.fitZoom=function(){var latLngs=[];var markers_length=this.markers.length;for(var i=0;i<markers_length;i++){latLngs.push(this.markers[i].getPosition())}
this.fitLatLngBounds(latLngs)};this.fitLatLngBounds=function(latLngs){var total=latLngs.length;var bounds=new google.maps.LatLngBounds();for(var i=0;i<total;i++){bounds.extend(latLngs[i])}
this.map.fitBounds(bounds)};this.setCenter=function(lat,lng,callback){this.map.panTo(new google.maps.LatLng(lat,lng));if(callback){callback()}};this.getElement=function(){return this.el};this.zoomIn=function(value){value=value||1;this.zoom=this.map.getZoom()+value;this.map.setZoom(this.zoom)};this.zoomOut=function(value){value=value||1;this.zoom=this.map.getZoom()-value;this.map.setZoom(this.zoom)};var native_methods=[];for(var method in this.map){if(typeof(this.map[method])=='function'&&!this[method]){native_methods.push(method)}}
for(var i=0;i<native_methods.length;i++){(function(gmaps,scope,method_name){gmaps[method_name]=function(){return scope[method_name].apply(scope,arguments)}})(this,this.map,native_methods[i])}
this.createControl=function(options){var control=doc.createElement('div');control.style.cursor='pointer';control.style.fontFamily='Arial, sans-serif';control.style.fontSize='13px';control.style.boxShadow='rgba(0, 0, 0, 0.398438) 0px 2px 4px';for(var option in options.style)
control.style[option]=options.style[option];if(options.id){control.id=options.id}
if(options.classes){control.className=options.classes}
if(options.content){control.innerHTML=options.content}
for(var ev in options.events){(function(object,name){google.maps.event.addDomListener(object,name,function(){options.events[name].apply(this,[this])})})(control,ev)}
control.index=1;return control};this.addControl=function(options){var position=google.maps.ControlPosition[options.position.toUpperCase()];delete options.position;var control=this.createControl(options);this.controls.push(control);this.map.controls[position].push(control);return control};this.createMarker=function(options){if((options.hasOwnProperty('lat')&&options.hasOwnProperty('lng'))||options.position){var self=this;var details=options.details;var fences=options.fences;var outside=options.outside;var base_options={position:new google.maps.LatLng(options.lat,options.lng),map:null};delete options.lat;delete options.lng;delete options.fences;delete options.outside;var marker_options=extend_object(base_options,options);var marker=new google.maps.Marker(marker_options);marker.fences=fences;if(options.infoWindow){marker.infoWindow=new google.maps.InfoWindow(options.infoWindow);var info_window_events=['closeclick','content_changed','domready','position_changed','zindex_changed'];for(var ev=0;ev<info_window_events.length;ev++){(function(object,name){if(options.infoWindow[name]){google.maps.event.addListener(object,name,function(e){options.infoWindow[name].apply(this,[e])})}})(marker.infoWindow,info_window_events[ev])}}
var marker_events=['animation_changed','clickable_changed','cursor_changed','draggable_changed','flat_changed','icon_changed','position_changed','shadow_changed','shape_changed','title_changed','visible_changed','zindex_changed'];var marker_events_with_mouse=['dblclick','drag','dragend','dragstart','mousedown','mouseout','mouseover','mouseup'];for(var ev=0;ev<marker_events.length;ev++){(function(object,name){if(options[name]){google.maps.event.addListener(object,name,function(){options[name].apply(this,[this])})}})(marker,marker_events[ev])}
for(var ev=0;ev<marker_events_with_mouse.length;ev++){(function(map,object,name){if(options[name]){google.maps.event.addListener(object,name,function(me){if(!me.pixel){me.pixel=map.getProjection().fromLatLngToPoint(me.latLng)}
options[name].apply(this,[me])})}})(this.map,marker,marker_events_with_mouse[ev])}
google.maps.event.addListener(marker,'click',function(){this.details=details;if(options.click){options.click.apply(this,[this])}
if(marker.infoWindow){self.hideInfoWindows();marker.infoWindow.open(self.map,marker)}});google.maps.event.addListener(marker,'rightclick',function(e){e.marker=this;if(options.rightclick){options.rightclick.apply(this,[e])}
if(window.context_menu.marker!=undefined){buildContextMenu('marker',e)}});if(marker.fences){google.maps.event.addListener(marker,'dragend',function(){self.checkMarkerGeofence(marker,function(m,f){outside(m,f)})})}
return marker}
else{throw 'No latitude or longitude defined.'}};this.addMarker=function(options){var marker;if(options.hasOwnProperty('gm_accessors_')){marker=options}
else{if((options.hasOwnProperty('lat')&&options.hasOwnProperty('lng'))||options.position){marker=this.createMarker(options)}
else{throw 'No latitude or longitude defined.'}}
marker.setMap(this.map);if(this.markerClusterer){this.markerClusterer.addMarker(marker)}
this.markers.push(marker);GMaps.fire('marker_added',marker,this);return marker};this.addMarkers=function(array){for(var i=0,marker;marker=array[i];i++){this.addMarker(marker)}
return this.markers};this.hideInfoWindows=function(){for(var i=0,marker;marker=this.markers[i];i++){if(marker.infoWindow){marker.infoWindow.close()}}};this.removeMarker=function(marker){for(var i=0;i<this.markers.length;i++){if(this.markers[i]===marker){this.markers[i].setMap(null);this.markers.splice(i,1);GMaps.fire('marker_removed',marker,this);break}}
return marker};this.removeMarkers=function(collection){var collection=(collection||this.markers);for(var i=0;i<this.markers.length;i++){if(this.markers[i]===collection[i])
this.markers[i].setMap(null)}
var new_markers=[];for(var i=0;i<this.markers.length;i++){if(this.markers[i].getMap()!=null)
new_markers.push(this.markers[i])}
this.markers=new_markers};this.drawOverlay=function(options){var overlay=new google.maps.OverlayView();overlay.setMap(self.map);var auto_show=!0;if(options.auto_show!=null)
auto_show=options.auto_show;overlay.onAdd=function(){var el=doc.createElement('div');el.style.borderStyle="none";el.style.borderWidth="0px";el.style.position="absolute";el.style.zIndex=100;el.innerHTML=options.content;overlay.el=el;var panes=this.getPanes();if(!options.layer){options.layer='overlayLayer'}
var overlayLayer=panes[options.layer];overlayLayer.appendChild(el);var stop_overlay_events=['contextmenu','DOMMouseScroll','dblclick','mousedown'];for(var ev=0;ev<stop_overlay_events.length;ev++){(function(object,name){google.maps.event.addDomListener(object,name,function(e){if(navigator.userAgent.toLowerCase().indexOf('msie')!=-1&&document.all){e.cancelBubble=!0;e.returnValue=!1}
else{e.stopPropagation()}})})(el,stop_overlay_events[ev])}
google.maps.event.trigger(this,'ready')};overlay.draw=function(){var projection=this.getProjection();var pixel=projection.fromLatLngToDivPixel(new google.maps.LatLng(options.lat,options.lng));options.horizontalOffset=options.horizontalOffset||0;options.verticalOffset=options.verticalOffset||0;var el=overlay.el;var content=el.children[0];var content_height=content.clientHeight;var content_width=content.clientWidth;switch(options.verticalAlign){case 'top':el.style.top=(pixel.y-content_height+options.verticalOffset)+'px';break;default:case 'middle':el.style.top=(pixel.y-(content_height/2)+options.verticalOffset)+'px';break;case 'bottom':el.style.top=(pixel.y+options.verticalOffset)+'px';break}
switch(options.horizontalAlign){case 'left':el.style.left=(pixel.x-content_width+options.horizontalOffset)+'px';break;default:case 'center':el.style.left=(pixel.x-(content_width/2)+options.horizontalOffset)+'px';break;case 'right':el.style.left=(pixel.x+options.horizontalOffset)+'px';break}
el.style.display=auto_show?'block':'none';if(!auto_show){options.show.apply(this,[el])}};overlay.onRemove=function(){var el=overlay.el;if(options.remove){options.remove.apply(this,[el])}
else{overlay.el.parentNode.removeChild(overlay.el);overlay.el=null}};self.overlays.push(overlay);return overlay};this.removeOverlay=function(overlay){for(var i=0;i<this.overlays.length;i++){if(this.overlays[i]===overlay){this.overlays[i].setMap(null);this.overlays.splice(i,1);break}}};this.removeOverlays=function(){for(var i=0,item;item=self.overlays[i];i++){item.setMap(null)}
self.overlays=[]};this.drawPolyline=function(options){var path=[];var points=options.path;if(points.length){if(points[0][0]===undefined){path=points}
else{for(var i=0,latlng;latlng=points[i];i++){path.push(new google.maps.LatLng(latlng[0],latlng[1]))}}}
var polyline_options={map:this.map,path:path,strokeColor:options.strokeColor,strokeOpacity:options.strokeOpacity,strokeWeight:options.strokeWeight,geodesic:options.geodesic,clickable:!0,editable:!1,visible:!0};if(options.hasOwnProperty("clickable"))
polyline_options.clickable=options.clickable;if(options.hasOwnProperty("editable"))
polyline_options.editable=options.editable;if(options.hasOwnProperty("icons"))
polyline_options.icons=options.icons;if(options.hasOwnProperty("zIndex"))
polyline_options.zIndex=options.zIndex;var polyline=new google.maps.Polyline(polyline_options);var polyline_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var ev=0;ev<polyline_events.length;ev++){(function(object,name){if(options[name]){google.maps.event.addListener(object,name,function(e){options[name].apply(this,[e])})}})(polyline,polyline_events[ev])}
this.polylines.push(polyline);GMaps.fire('polyline_added',polyline,this);return polyline};this.removePolyline=function(polyline){for(var i=0;i<this.polylines.length;i++){if(this.polylines[i]===polyline){this.polylines[i].setMap(null);this.polylines.splice(i,1);GMaps.fire('polyline_removed',polyline,this);break}}};this.removePolylines=function(){for(var i=0,item;item=self.polylines[i];i++){item.setMap(null)}
self.polylines=[]};this.drawCircle=function(options){options=extend_object({map:this.map,center:new google.maps.LatLng(options.lat,options.lng)},options);delete options.lat;delete options.lng;var polygon=new google.maps.Circle(options);var polygon_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var ev=0;ev<polygon_events.length;ev++){(function(object,name){if(options[name]){google.maps.event.addListener(object,name,function(e){options[name].apply(this,[e])})}})(polygon,polygon_events[ev])}
this.polygons.push(polygon);return polygon};this.drawRectangle=function(options){options=extend_object({map:this.map},options);var latLngBounds=new google.maps.LatLngBounds(new google.maps.LatLng(options.bounds[0][0],options.bounds[0][1]),new google.maps.LatLng(options.bounds[1][0],options.bounds[1][1]));options.bounds=latLngBounds;var polygon=new google.maps.Rectangle(options);var polygon_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var ev=0;ev<polygon_events.length;ev++){(function(object,name){if(options[name]){google.maps.event.addListener(object,name,function(e){options[name].apply(this,[e])})}})(polygon,polygon_events[ev])}
this.polygons.push(polygon);return polygon};this.drawPolygon=function(options){var useGeoJSON=!1;if(options.hasOwnProperty("useGeoJSON"))
useGeoJSON=options.useGeoJSON;delete options.useGeoJSON;options=extend_object({map:this.map},options);if(useGeoJSON==!1)
options.paths=[options.paths.slice(0)];if(options.paths.length>0){if(options.paths[0].length>0){options.paths=array_flat(array_map(options.paths,arrayToLatLng,useGeoJSON))}}
var polygon=new google.maps.Polygon(options);var polygon_events=['click','dblclick','mousedown','mousemove','mouseout','mouseover','mouseup','rightclick'];for(var ev=0;ev<polygon_events.length;ev++){(function(object,name){if(options[name]){google.maps.event.addListener(object,name,function(e){options[name].apply(this,[e])})}})(polygon,polygon_events[ev])}
this.polygons.push(polygon);GMaps.fire('polygon_added',polygon,this);return polygon};this.removePolygon=function(polygon){for(var i=0;i<this.polygons.length;i++){if(this.polygons[i]===polygon){this.polygons[i].setMap(null);this.polygons.splice(i,1);GMaps.fire('polygon_removed',polygon,this);break}}};this.removePolygons=function(){for(var i=0,item;item=self.polygons[i];i++){item.setMap(null)}
self.polygons=[]};this.getFromFusionTables=function(options){var events=options.events;delete options.events;var fusion_tables_options=options;var layer=new google.maps.FusionTablesLayer(fusion_tables_options);for(var ev in events){(function(object,name){google.maps.event.addListener(object,name,function(e){events[name].apply(this,[e])})})(layer,ev)}
this.layers.push(layer);return layer};this.loadFromFusionTables=function(options){var layer=this.getFromFusionTables(options);layer.setMap(this.map);return layer};this.getFromKML=function(options){var url=options.url;var events=options.events;delete options.url;delete options.events;var kml_options=options;var layer=new google.maps.KmlLayer(url,kml_options);for(var ev in events){(function(object,name){google.maps.event.addListener(object,name,function(e){events[name].apply(this,[e])})})(layer,ev)}
this.layers.push(layer);return layer};this.loadFromKML=function(options){var layer=this.getFromKML(options);layer.setMap(this.map);return layer};var travelMode,unitSystem;this.getRoutes=function(options){switch(options.travelMode){case 'bicycling':travelMode=google.maps.TravelMode.BICYCLING;break;case 'transit':travelMode=google.maps.TravelMode.TRANSIT;break;case 'driving':travelMode=google.maps.TravelMode.DRIVING;break;default:travelMode=google.maps.TravelMode.WALKING;break}
if(options.unitSystem==='imperial'){unitSystem=google.maps.UnitSystem.IMPERIAL}
else{unitSystem=google.maps.UnitSystem.METRIC}
var base_options={avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]};var request_options=extend_object(base_options,options);request_options.origin=/string/.test(typeof options.origin)?options.origin:new google.maps.LatLng(options.origin[0],options.origin[1]);request_options.destination=new google.maps.LatLng(options.destination[0],options.destination[1]);request_options.travelMode=travelMode;request_options.unitSystem=unitSystem;delete request_options.callback;var self=this;var service=new google.maps.DirectionsService();service.route(request_options,function(result,status){if(status===google.maps.DirectionsStatus.OK){for(var r in result.routes){if(result.routes.hasOwnProperty(r)){self.routes.push(result.routes[r])}}}
if(options.callback){options.callback(self.routes)}})};this.removeRoutes=function(){this.routes=[]};this.getElevations=function(options){options=extend_object({locations:[],path:!1,samples:256},options);if(options.locations.length>0){if(options.locations[0].length>0){options.locations=array_flat(array_map([options.locations],arrayToLatLng,!1))}}
var callback=options.callback;delete options.callback;var service=new google.maps.ElevationService();if(!options.path){delete options.path;delete options.samples;service.getElevationForLocations(options,function(result,status){if(callback&&typeof(callback)==="function"){callback(result,status)}})}else{var pathRequest={path:options.locations,samples:options.samples};service.getElevationAlongPath(pathRequest,function(result,status){if(callback&&typeof(callback)==="function"){callback(result,status)}})}};this.cleanRoute=this.removePolylines;this.drawRoute=function(options){var self=this;this.getRoutes({origin:options.origin,destination:options.destination,travelMode:options.travelMode,waypoints:options.waypoints,unitSystem:options.unitSystem,callback:function(e){if(e.length>0){self.drawPolyline({path:e[e.length-1].overview_path,strokeColor:options.strokeColor,strokeOpacity:options.strokeOpacity,strokeWeight:options.strokeWeight});if(options.callback){options.callback(e[e.length-1])}}}})};this.travelRoute=function(options){if(options.origin&&options.destination){this.getRoutes({origin:options.origin,destination:options.destination,travelMode:options.travelMode,waypoints:options.waypoints,callback:function(e){if(e.length>0&&options.start){options.start(e[e.length-1])}
if(e.length>0&&options.step){var route=e[e.length-1];if(route.legs.length>0){var steps=route.legs[0].steps;for(var i=0,step;step=steps[i];i++){step.step_number=i;options.step(step,(route.legs[0].steps.length-1))}}}
if(e.length>0&&options.end){options.end(e[e.length-1])}}})}
else if(options.route){if(options.route.legs.length>0){var steps=options.route.legs[0].steps;for(var i=0,step;step=steps[i];i++){step.step_number=i;options.step(step)}}}};this.drawSteppedRoute=function(options){if(options.origin&&options.destination){this.getRoutes({origin:options.origin,destination:options.destination,travelMode:options.travelMode,waypoints:options.waypoints,callback:function(e){if(e.length>0&&options.start){options.start(e[e.length-1])}
if(e.length>0&&options.step){var route=e[e.length-1];if(route.legs.length>0){var steps=route.legs[0].steps;for(var i=0,step;step=steps[i];i++){step.step_number=i;self.drawPolyline({path:step.path,strokeColor:options.strokeColor,strokeOpacity:options.strokeOpacity,strokeWeight:options.strokeWeight});options.step(step,(route.legs[0].steps.length-1))}}}
if(e.length>0&&options.end){options.end(e[e.length-1])}}})}
else if(options.route){if(options.route.legs.length>0){var steps=options.route.legs[0].steps;for(var i=0,step;step=steps[i];i++){step.step_number=i;self.drawPolyline({path:step.path,strokeColor:options.strokeColor,strokeOpacity:options.strokeOpacity,strokeWeight:options.strokeWeight});options.step(step)}}}};this.checkGeofence=function(lat,lng,fence){return fence.containsLatLng(new google.maps.LatLng(lat,lng))};this.checkMarkerGeofence=function(marker,outside_callback){if(marker.fences){for(var i=0,fence;fence=marker.fences[i];i++){var pos=marker.getPosition();if(!self.checkGeofence(pos.lat(),pos.lng(),fence)){outside_callback(marker,fence)}}}};this.addLayer=function(layerName,options){options=options||{};var layer;switch(layerName){case 'weather':this.singleLayers.weather=layer=new google.maps.weather.WeatherLayer();break;case 'clouds':this.singleLayers.clouds=layer=new google.maps.weather.CloudLayer();break;case 'traffic':this.singleLayers.traffic=layer=new google.maps.TrafficLayer();break;case 'transit':this.singleLayers.transit=layer=new google.maps.TransitLayer();break;case 'bicycling':this.singleLayers.bicycling=layer=new google.maps.BicyclingLayer();break;case 'panoramio':this.singleLayers.panoramio=layer=new google.maps.panoramio.PanoramioLayer();layer.setTag(options.filter);delete options.filter;if(options.click){google.maps.event.addListener(layer,'click',function(event){options.click(event);delete options.click})}
break;case 'places':this.singleLayers.places=layer=new google.maps.places.PlacesService(this.map);if(options.search||options.nearbySearch){var placeSearchRequest={bounds:options.bounds||null,keyword:options.keyword||null,location:options.location||null,name:options.name||null,radius:options.radius||null,rankBy:options.rankBy||null,types:options.types||null};if(options.search){layer.search(placeSearchRequest,options.search)}
if(options.nearbySearch){layer.nearbySearch(placeSearchRequest,options.nearbySearch)}}
if(options.textSearch){var textSearchRequest={bounds:options.bounds||null,location:options.location||null,query:options.query||null,radius:options.radius||null};layer.textSearch(textSearchRequest,options.textSearch)}
break}
if(layer!==undefined){if(typeof layer.setOptions=='function'){layer.setOptions(options)}
if(typeof layer.setMap=='function'){layer.setMap(this.map)}
return layer}};this.removeLayer=function(layerName){if(this.singleLayers[layerName]!==undefined){this.singleLayers[layerName].setMap(null);delete this.singleLayers[layerName]}};this.toImage=function(options){var options=options||{};var static_map_options={};static_map_options.size=options.size||[this.el.clientWidth,this.el.clientHeight];static_map_options.lat=this.getCenter().lat();static_map_options.lng=this.getCenter().lng();if(this.markers.length>0){static_map_options.markers=[];for(var i=0;i<this.markers.length;i++){static_map_options.markers.push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()})}}
if(this.polylines.length>0){var polyline=this.polylines[0];static_map_options.polyline={};static_map_options.polyline.path=google.maps.geometry.encoding.encodePath(polyline.getPath());static_map_options.polyline.strokeColor=polyline.strokeColor
static_map_options.polyline.strokeOpacity=polyline.strokeOpacity
static_map_options.polyline.strokeWeight=polyline.strokeWeight}
return GMaps.staticMapURL(static_map_options)};this.addMapType=function(mapTypeId,options){if(options.hasOwnProperty("getTileUrl")&&typeof(options.getTileUrl)=="function"){options.tileSize=options.tileSize||new google.maps.Size(256,256);var mapType=new google.maps.ImageMapType(options);this.map.mapTypes.set(mapTypeId,mapType)}
else{throw "'getTileUrl' function required."}};this.addOverlayMapType=function(options){if(options.hasOwnProperty("getTile")&&typeof(options.getTile)=="function"){var overlayMapTypeIndex=options.index;delete options.index;this.map.overlayMapTypes.insertAt(overlayMapTypeIndex,options)}
else{throw "'getTile' function required."}};this.removeOverlayMapType=function(overlayMapTypeIndex){this.map.overlayMapTypes.removeAt(overlayMapTypeIndex)};this.addStyle=function(options){var styledMapType=new google.maps.StyledMapType(options.styles,options.styledMapName);this.map.mapTypes.set(options.mapTypeId,styledMapType)};this.setStyle=function(mapTypeId){this.map.setMapTypeId(mapTypeId)};this.createPanorama=function(streetview_options){if(!streetview_options.hasOwnProperty('lat')||!streetview_options.hasOwnProperty('lng')){streetview_options.lat=this.getCenter().lat();streetview_options.lng=this.getCenter().lng()}
this.panorama=GMaps.createPanorama(streetview_options);this.map.setStreetView(this.panorama);return this.panorama};this.on=function(event_name,handler){return GMaps.on(event_name,this,handler)};this.off=function(event_name){GMaps.off(event_name,this)}};GMaps.createPanorama=function(options){var el=getElementById(options.el,options.context);options.position=new google.maps.LatLng(options.lat,options.lng);delete options.el;delete options.context;delete options.lat;delete options.lng;var streetview_events=['closeclick','links_changed','pano_changed','position_changed','pov_changed','resize','visible_changed'];var streetview_options=extend_object({visible:!0},options);for(var i=0;i<streetview_events.length;i++){delete streetview_options[streetview_events[i]]}
var panorama=new google.maps.StreetViewPanorama(el,streetview_options);for(var i=0;i<streetview_events.length;i++){(function(object,name){if(options[name]){google.maps.event.addListener(object,name,function(){options[name].apply(this)})}})(panorama,streetview_events[i])}
return panorama};GMaps.Route=function(options){this.map=options.map;this.route=options.route;this.step_count=0;this.steps=this.route.legs[0].steps;this.steps_length=this.steps.length;this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray(),strokeColor:options.strokeColor,strokeOpacity:options.strokeOpacity,strokeWeight:options.strokeWeight}).getPath();this.back=function(){if(this.step_count>0){this.step_count--;var path=this.route.legs[0].steps[this.step_count].path;for(var p in path){if(path.hasOwnProperty(p)){this.polyline.pop()}}}};this.forward=function(){if(this.step_count<this.steps_length){var path=this.route.legs[0].steps[this.step_count].path;for(var p in path){if(path.hasOwnProperty(p)){this.polyline.push(path[p])}}
this.step_count++}}};GMaps.geolocate=function(options){var complete_callback=options.always||options.complete;if(navigator.geolocation){navigator.geolocation.getCurrentPosition(function(position){options.success(position);if(complete_callback){complete_callback()}},function(error){options.error(error);if(complete_callback){complete_callback()}},options.options)}
else{options.not_supported();if(complete_callback){complete_callback()}}};GMaps.geocode=function(options){this.geocoder=new google.maps.Geocoder();var callback=options.callback;if(options.hasOwnProperty('lat')&&options.hasOwnProperty('lng')){options.latLng=new google.maps.LatLng(options.lat,options.lng)}
delete options.lat;delete options.lng;delete options.callback;this.geocoder.geocode(options,function(results,status){callback(results,status)})};GMaps.staticMapURL=function(options){var parameters=[];var data;var static_root='http://maps.googleapis.com/maps/api/staticmap';if(options.url){static_root=options.url;delete options.url}
static_root+='?';var markers=options.markers;delete options.markers;if(!markers&&options.marker){markers=[options.marker];delete options.marker}
var polyline=options.polyline;delete options.polyline;if(options.center){parameters.push('center='+options.center);delete options.center}
else if(options.address){parameters.push('center='+options.address);delete options.address}
else if(options.lat){parameters.push(['center=',options.lat,',',options.lng].join(''));delete options.lat;delete options.lng}
else if(options.visible){var visible=encodeURI(options.visible.join('|'));parameters.push('visible='+visible)}
var size=options.size;if(size){if(size.join){size=size.join('x')}
delete options.size}
else{size='630x300'}
parameters.push('size='+size);if(!options.zoom){options.zoom=15}
var sensor=options.hasOwnProperty('sensor')?!!options.sensor:!0;delete options.sensor;parameters.push('sensor='+sensor);for(var param in options){if(options.hasOwnProperty(param)){parameters.push(param+'='+options[param])}}
if(markers){var marker,loc;for(var i=0;data=markers[i];i++){marker=[];if(data.size&&data.size!=='normal'){marker.push('size:'+data.size)}
else if(data.icon){marker.push('icon:'+encodeURI(data.icon))}
if(data.color){marker.push('color:'+data.color.replace('#','0x'))}
if(data.label){marker.push('label:'+data.label[0].toUpperCase())}
loc=(data.address?data.address:data.lat+','+data.lng);if(marker.length||i===0){marker.push(loc);marker=marker.join('|');parameters.push('markers='+encodeURI(marker))}
else{marker=parameters.pop()+encodeURI('|'+loc);parameters.push(marker)}}}
function parseColor(color,opacity){if(color[0]==='#'){color=color.replace('#','0x');if(opacity){opacity=parseFloat(opacity);opacity=Math.min(1,Math.max(opacity,0));if(opacity===0){return '0x00000000'}
opacity=(opacity*255).toString(16);if(opacity.length===1){opacity+=opacity}
color=color.slice(0,8)+opacity}}
return color}
if(polyline){data=polyline;polyline=[];if(data.strokeWeight){polyline.push('weight:'+parseInt(data.strokeWeight,10))}
if(data.strokeColor){var color=parseColor(data.strokeColor,data.strokeOpacity);polyline.push('color:'+color)}
if(data.fillColor){var fillcolor=parseColor(data.fillColor,data.fillOpacity);polyline.push('fillcolor:'+fillcolor)}
var path=data.path;if(path.join){for(var j=0,pos;pos=path[j];j++){polyline.push(pos.join(','))}}
else{polyline.push('enc:'+path)}
polyline=polyline.join('|');parameters.push('path='+encodeURI(polyline))}
parameters=parameters.join('&');return static_root+parameters};GMaps.custom_events=['marker_added','marker_removed','polyline_added','polyline_removed','polygon_added','polygon_removed','geolocated','geolocation_failed'];GMaps.on=function(event_name,object,handler){if(GMaps.custom_events.indexOf(event_name)==-1){return google.maps.event.addListener(object,event_name,handler)}
else{var registered_event={handler:handler,eventName:event_name};object.registered_events[event_name]=object.registered_events[event_name]||[];object.registered_events[event_name].push(registered_event);return registered_event}};GMaps.off=function(event_name,object){if(GMaps.custom_events.indexOf(event_name)==-1){google.maps.event.clearListeners(object,event_name)}
else{object.registered_events[event_name]=[]}};GMaps.fire=function(event_name,object,scope){if(GMaps.custom_events.indexOf(event_name)==-1){google.maps.event.trigger(object,event_name,Array.prototype.slice.apply(arguments).slice(2))}
else{if(event_name in scope.registered_events){var firing_events=scope.registered_events[event_name];for(var i=0;i<firing_events.length;i++){(function(handler,scope,object){handler.apply(scope,[object])})(firing_events[i].handler,scope,object)}}}};if(!google.maps.Polygon.prototype.getBounds){google.maps.Polygon.prototype.getBounds=function(latLng){var bounds=new google.maps.LatLngBounds();var paths=this.getPaths();var path;for(var p=0;p<paths.getLength();p++){path=paths.getAt(p);for(var i=0;i<path.getLength();i++){bounds.extend(path.getAt(i))}}
return bounds}}
if(!google.maps.Polygon.prototype.containsLatLng){google.maps.Polygon.prototype.containsLatLng=function(latLng){var bounds=this.getBounds();if(bounds!==null&&!bounds.contains(latLng)){return!1}
var inPoly=!1;var numPaths=this.getPaths().getLength();for(var p=0;p<numPaths;p++){var path=this.getPaths().getAt(p);var numPoints=path.getLength();var j=numPoints-1;for(var i=0;i<numPoints;i++){var vertex1=path.getAt(i);var vertex2=path.getAt(j);if(vertex1.lng()<latLng.lng()&&vertex2.lng()>=latLng.lng()||vertex2.lng()<latLng.lng()&&vertex1.lng()>=latLng.lng()){if(vertex1.lat()+(latLng.lng()-vertex1.lng())/(vertex2.lng()-vertex1.lng())*(vertex2.lat()-vertex1.lat())<latLng.lat()){inPoly=!inPoly}}
j=i}}
return inPoly}}
google.maps.LatLngBounds.prototype.containsLatLng=function(latLng){return this.contains(latLng)};google.maps.Marker.prototype.setFences=function(fences){this.fences=fences};google.maps.Marker.prototype.addFence=function(fence){this.fences.push(fence)};return GMaps}(this));var coordsToLatLngs=function(coords,useGeoJSON){var first_coord=coords[0];var second_coord=coords[1];if(useGeoJSON){first_coord=coords[1];second_coord=coords[0]}
return new google.maps.LatLng(first_coord,second_coord)};var arrayToLatLng=function(coords,useGeoJSON){for(var i=0;i<coords.length;i++){if(coords[i].length>0&&typeof(coords[i][0])!="number"){coords[i]=arrayToLatLng(coords[i],useGeoJSON)}
else{coords[i]=coordsToLatLngs(coords[i],useGeoJSON)}}
return coords};var extend_object=function(obj,new_obj){if(obj===new_obj)return obj;for(var name in new_obj){obj[name]=new_obj[name]}
return obj};var replace_object=function(obj,replace){if(obj===replace)return obj;for(var name in replace){if(obj[name]!=undefined)
obj[name]=replace[name]}
return obj};var array_map=function(array,callback){var original_callback_params=Array.prototype.slice.call(arguments,2);if(Array.prototype.map&&array.map===Array.prototype.map){return Array.prototype.map.call(array,function(item){callback_params=original_callback_params;callback_params.splice(0,0,item);return callback.apply(this,callback_params)})}
else{var array_return=[];var array_length=array.length;for(var i=0;i<array_length;i++){callback_params=original_callback_params;callback_params=callback_params.splice(0,0,array[i]);array_return.push(callback.apply(this,callback_params))}
return array_return}};var array_flat=function(array){new_array=[];for(var i=0;i<array.length;i++){new_array=new_array.concat(array[i])}
return new_array};$.GMaps=GMaps;$.GMaps.mapEvents=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","heading_changed","idle","maptypeid_changed","mousemove","mouseout","mouseover","projection_changed","resize","rightclick","tilesloaded","tilt_changed","zoom_changed"];$.fn.gmaps=function(options){if(this.length<1)return;var el=$(this[0]),map=el.data("gmaps"),newInstance=(map===undefined),autodetect=(options===undefined);if($.isString(options)){options={address:options}}
if(newInstance){var id=$.uid("gmaps-"),defaultOptions={lat:0,lng:0};if($.isPlainObject(options)){options=$.extend({},defaultOptions,options)}
el.attr("id",id);options.div='#'+id;$.each($.GMaps.mapEvents,function(i,eventName){var originalEvent=($.isFunction(options[eventName]))?options[eventName]:$.noop;options[eventName]=function(){var args=$.makeArray(arguments);originalEvent.apply(map,arguments);el.trigger.apply(el,["map_"+eventName].concat(args))}});map=new GMaps(options);el.data("gmaps",map);map.go=function(lat,lng){map.setCenter(lat,lng);map.addMarker({lat:lat,lng:lng})}
if(autodetect){GMaps.geolocate({success:function(position){map.go(position.coords.latitude,position.coords.longitude)}})}
return map}else{var lat=options.lat,lng=options.lng;if($.isNumber(lat)||$.isNumber(lng)){map.go(lat,lng)}
return map}
if(options.address){GMaps.geocode({address:options.address,callback:function(results,status){if(status=="OK"){var coords=results[0].geometry.location;map.go(coords.lat(),coords.lng())}}});return map}};module.resolveWith(GMaps)});var language=$('meta[name="foundry:location:language"]').attr("content")||'en';if(window.google&&window.google.maps){window[callbackId]()}else{$.require().script($.uri(window.location).protocol()+"://maps.google.com/maps/api/js?sensor=true&callback="+callbackId+"&language="+language).done()}};FD40.module("gmaps",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){;(function(window,document,$){var isInputSupported='placeholder' in document.createElement('input'),isTextareaSupported='placeholder' in document.createElement('textarea'),prototype=$.fn,valHooks=$.valHooks,hooks,placeholder;if(isInputSupported&&isTextareaSupported){placeholder=prototype.placeholder=function(){return this};placeholder.input=placeholder.textarea=!0}else{placeholder=prototype.placeholder=function(){var $this=this;$this.filter((isInputSupported?'textarea':':input')+'[placeholder]').not('.placeholder').bind({'focus.placeholder':clearPlaceholder,'blur.placeholder':setPlaceholder}).data('placeholder-enabled',!0).trigger('blur.placeholder');return $this};placeholder.input=isInputSupported;placeholder.textarea=isTextareaSupported;hooks={'get':function(element){var $element=$(element);return $element.data('placeholder-enabled')&&$element.hasClass('placeholder')?'':element.value},'set':function(element,value){var $element=$(element);if(!$element.data('placeholder-enabled')){return element.value=value}
if(value==''){element.value=value;if(element!=document.activeElement){setPlaceholder.call(element)}}else if($element.hasClass('placeholder')){clearPlaceholder.call(element,!0,value)||(element.value=value)}else{element.value=value}
return $element}};isInputSupported||(valHooks.input=hooks);isTextareaSupported||(valHooks.textarea=hooks);$(function(){$(document).delegate('form','submit.placeholder',function(){var $inputs=$('.placeholder',this).each(clearPlaceholder);setTimeout(function(){$inputs.each(setPlaceholder)},10)})});$(window).bind('beforeunload.placeholder',function(){$('.placeholder').each(function(){this.value=''})})}
function args(elem){var newAttrs={},rinlinejQuery=/^jQuery\d+$/;$.each(elem.attributes,function(i,attr){if(attr.specified&&!rinlinejQuery.test(attr.name)){newAttrs[attr.name]=attr.value}});return newAttrs}
function clearPlaceholder(event,value){var input=this,$input=$(input);if(input.value==$input.attr('placeholder')&&$input.hasClass('placeholder')){if($input.data('placeholder-password')){$input=$input.hide().next().show().attr('id',$input.removeAttr('id').data('placeholder-id'));if(event===!0){return $input[0].value=value}
$input.focus()}else{input.value='';$input.removeClass('placeholder');input==document.activeElement&&input.select()}}}
function setPlaceholder(){var $replacement,input=this,$input=$(input),$origInput=$input,id=this.id;if(input.value==''){if(input.type=='password'){if(!$input.data('placeholder-textinput')){try{$replacement=$input.clone().attr({'type':'text'})}catch(e){$replacement=$('<input>').attr($.extend(args(this),{'type':'text'}))}
$replacement.removeAttr('name').data({'placeholder-password':!0,'placeholder-id':id}).bind('focus.placeholder',clearPlaceholder);$input.data({'placeholder-textinput':$replacement,'placeholder-id':id}).before($replacement)}
$input=$input.removeAttr('id').hide().prev().attr('id',id).show()}
$input.addClass('placeholder');$input[0].value=$input.attr('placeholder')}else{$input.removeClass('placeholder')}}}(window,document,jQuery))};exports();module.resolveWith(exports)};FD40.module("placeholder",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){$.fn.image=function(method){var method=$.Image[method];return method&&method.apply(this[0],$.makeArray(arguments).slice(1))}
$.Image={get:function(url){var existingImage=this.nodeName==="IMG";var image=$(existingImage?this:new Image()),imageLoader=$.Deferred();image.load(function(){var w,h,r,o;if(!existingImage){image.appendTo("body")}
var data={width:w=image.width(),height:h=image.height(),aspectRatio:r=w/h,orientation:o=(r===1)?"square":(r<1)?"tall":"wide"}
image.css({position:"absolute",left:"-99999px"}).data(data).addClass("orientation-"+o).removeAttr("style");if(!existingImage){image.detach()}
imageLoader.resolve(image,data)}).error(function(){imageLoader.reject()}).attr("src",url);return imageLoader},aspectRatio:function(width,height){if($.isPlainObject(width)){width=width.width;height=width.height}
return width/height},orientation:function(width,height){if($.isPlainObject(width)){width=width.width;height=width.height}
if(width===height)return "square";if(width>height)return "wide";return "tall"},resizeProportionate:function(sourceWidth,sourceHeight,maxWidth,maxHeight,mode){var targetWidth=sourceWidth,targetHeight=sourceHeight;var ratio=maxWidth/sourceWidth;targetWidth=sourceWidth*ratio;targetHeight=sourceHeight*ratio;var condition=targetHeight>maxHeight;if(mode=="outer"){condition=targetHeight<maxHeight}
if(condition){ratio=maxHeight/sourceHeight;targetWidth=sourceWidth*ratio;targetHeight=sourceHeight*ratio}
return{top:(maxHeight-targetHeight)/2,left:(maxWidth-targetWidth)/2,width:targetWidth,height:targetHeight}},resizeWithin:function(sourceWidth,sourceHeight,maxWidth,maxHeight){return $.Image.resizeProportionate(sourceWidth,sourceHeight,maxWidth,maxHeight,"inner")},resizeToFill:function(sourceWidth,sourceHeight,maxWidth,maxHeight){return $.Image.resizeProportionate(sourceWidth,sourceHeight,maxWidth,maxHeight,"outer")}}};exports();module.resolveWith(exports)};FD40.module("image",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function($){var abs=Math.abs,max=Math.max,min=Math.min,round=Math.round;function div(){return $('<div/>')}
$.imgAreaSelect=function(img,options){var
$img=$(img),imgLoaded,$box=div(),$area=div(),$border=div().add(div()).add(div()).add(div()),$outer=div().add(div()).add(div()).add(div()),$handles=$([]),$areaOpera,left,top,imgOfs={left:0,top:0},imgWidth,imgHeight,$parent,parOfs={left:0,top:0},zIndex=0,position='absolute',startX,startY,scaleX,scaleY,resize,minWidth,minHeight,maxWidth,maxHeight,aspectRatio,shown,x1,y1,x2,y2,selection={x1:0,y1:0,x2:0,y2:0,width:0,height:0},docElem=document.documentElement,$p,d,i,o,w,h,adjusted;function viewX(x){return x+imgOfs.left-parOfs.left}
function viewY(y){return y+imgOfs.top-parOfs.top}
function selX(x){return x-imgOfs.left+parOfs.left}
function selY(y){return y-imgOfs.top+parOfs.top}
function evX(event){return event.pageX-parOfs.left}
function evY(event){return event.pageY-parOfs.top}
function getSelection(noScale){var sx=noScale||scaleX,sy=noScale||scaleY;return{x1:round(selection.x1*sx),y1:round(selection.y1*sy),x2:round(selection.x2*sx),y2:round(selection.y2*sy),width:round(selection.x2*sx)-round(selection.x1*sx),height:round(selection.y2*sy)-round(selection.y1*sy)}}
function setSelection(x1,y1,x2,y2,noScale){var sx=noScale||scaleX,sy=noScale||scaleY;selection={x1:round(x1/sx||0),y1:round(y1/sy||0),x2:round(x2/sx||0),y2:round(y2/sy||0)};selection.width=selection.x2-selection.x1;selection.height=selection.y2-selection.y1}
function adjust(){if(!$img.width())
return;imgOfs={left:round($img.offset().left),top:round($img.offset().top)};imgWidth=$img.innerWidth();imgHeight=$img.innerHeight();imgOfs.top+=($img.outerHeight()-imgHeight)>>1;imgOfs.left+=($img.outerWidth()-imgWidth)>>1;minWidth=round(options.minWidth/scaleX)||0;minHeight=round(options.minHeight/scaleY)||0;maxWidth=round(min(options.maxWidth/scaleX||1<<24,imgWidth));maxHeight=round(min(options.maxHeight/scaleY||1<<24,imgHeight));if($().jquery=='1.3.2'&&position=='fixed'&&!docElem.getBoundingClientRect)
{imgOfs.top+=max(document.body.scrollTop,docElem.scrollTop);imgOfs.left+=max(document.body.scrollLeft,docElem.scrollLeft)}
parOfs=/absolute|relative/.test($parent.css('position'))?{left:round($parent.offset().left)-$parent.scrollLeft(),top:round($parent.offset().top)-$parent.scrollTop()}:position=='fixed'?{left:$(document).scrollLeft(),top:$(document).scrollTop()}:{left:0,top:0};left=viewX(0);top=viewY(0);if(selection.x2>imgWidth||selection.y2>imgHeight)
doResize()}
function update(resetKeyPress){if(!shown)return;$box.css({left:viewX(selection.x1),top:viewY(selection.y1)}).add($area).width(w=selection.width).height(h=selection.height);$area.add($border).add($handles).css({left:0,top:0});$border.width(max(w-$border.outerWidth()+$border.innerWidth(),0)).height(max(h-$border.outerHeight()+$border.innerHeight(),0));$($outer[0]).css({left:left,top:top,width:selection.x1,height:imgHeight});$($outer[1]).css({left:left+selection.x1,top:top,width:w,height:selection.y1});$($outer[2]).css({left:left+selection.x2,top:top,width:imgWidth-selection.x2,height:imgHeight});$($outer[3]).css({left:left+selection.x1,top:top+selection.y2,width:w,height:imgHeight-selection.y2});w-=$handles.outerWidth();h-=$handles.outerHeight();switch($handles.length){case 8:$($handles[4]).css({left:w>>1});$($handles[5]).css({left:w,top:h>>1});$($handles[6]).css({left:w>>1,top:h});$($handles[7]).css({top:h>>1});case 4:$handles.slice(1,3).css({left:w});$handles.slice(2,4).css({top:h})}
if(resetKeyPress!==!1){if($.imgAreaSelect.keyPress!=docKeyPress)
$(document).unbind($.imgAreaSelect.keyPress,$.imgAreaSelect.onKeyPress);if(options.keys)
$(document)[$.imgAreaSelect.keyPress]($.imgAreaSelect.onKeyPress=docKeyPress)}
if($.browser.msie&&$border.outerWidth()-$border.innerWidth()==2){$border.css('margin',0);setTimeout(function(){$border.css('margin','auto')},0)}}
function doUpdate(resetKeyPress){adjust();update(resetKeyPress);x1=viewX(selection.x1);y1=viewY(selection.y1);x2=viewX(selection.x2);y2=viewY(selection.y2)}
function hide($elem,fn){options.fadeSpeed?$elem.fadeOut(options.fadeSpeed,fn):$elem.hide()}
function areaMouseMove(event){var x=selX(evX(event))-selection.x1,y=selY(evY(event))-selection.y1;if(!adjusted){adjust();adjusted=!0;$box.one('mouseout',function(){adjusted=!1})}
resize='';if(options.resizable){if(y<=options.resizeMargin)
resize='n';else if(y>=selection.height-options.resizeMargin)
resize='s';if(x<=options.resizeMargin)
resize+='w';else if(x>=selection.width-options.resizeMargin)
resize+='e'}
$box.css('cursor',resize?resize+'-resize':options.movable?'move':'');if($areaOpera)
$areaOpera.toggle()}
function docMouseUp(event){$('body').css('cursor','');if(options.autoHide||selection.width*selection.height==0)
hide($box.add($outer),function(){$(this).hide()});$(document).unbind('mousemove',selectingMouseMove);$box.mousemove(areaMouseMove);options.onSelectEnd(img,getSelection())}
function areaMouseDown(event){if(event.which!=1)return!1;adjust();if(resize){$('body').css('cursor',resize+'-resize');x1=viewX(selection[/w/.test(resize)?'x2':'x1']);y1=viewY(selection[/n/.test(resize)?'y2':'y1']);$(document).mousemove(selectingMouseMove).one('mouseup',docMouseUp);$box.unbind('mousemove',areaMouseMove)}
else if(options.movable){startX=left+selection.x1-evX(event);startY=top+selection.y1-evY(event);$box.unbind('mousemove',areaMouseMove);$(document).mousemove(movingMouseMove).one('mouseup',function(){options.onSelectEnd(img,getSelection());$(document).unbind('mousemove',movingMouseMove);$box.mousemove(areaMouseMove)})}
else $img.mousedown(event);return!1}
function fixAspectRatio(xFirst){if(aspectRatio)
if(xFirst){x2=max(left,min(left+imgWidth,x1+abs(y2-y1)*aspectRatio*(x2>x1||-1)));y2=round(max(top,min(top+imgHeight,y1+abs(x2-x1)/aspectRatio*(y2>y1||-1))));x2=round(x2)}
else{y2=max(top,min(top+imgHeight,y1+abs(x2-x1)/aspectRatio*(y2>y1||-1)));x2=round(max(left,min(left+imgWidth,x1+abs(y2-y1)*aspectRatio*(x2>x1||-1))));y2=round(y2)}}
function doResize(){x1=min(x1,left+imgWidth);y1=min(y1,top+imgHeight);if(abs(x2-x1)<minWidth){x2=x1-minWidth*(x2<x1||-1);if(x2<left)
x1=left+minWidth;else if(x2>left+imgWidth)
x1=left+imgWidth-minWidth}
if(abs(y2-y1)<minHeight){y2=y1-minHeight*(y2<y1||-1);if(y2<top)
y1=top+minHeight;else if(y2>top+imgHeight)
y1=top+imgHeight-minHeight}
x2=max(left,min(x2,left+imgWidth));y2=max(top,min(y2,top+imgHeight));fixAspectRatio(abs(x2-x1)<abs(y2-y1)*aspectRatio);if(abs(x2-x1)>maxWidth){x2=x1-maxWidth*(x2<x1||-1);fixAspectRatio()}
if(abs(y2-y1)>maxHeight){y2=y1-maxHeight*(y2<y1||-1);fixAspectRatio(!0)}
selection={x1:selX(min(x1,x2)),x2:selX(max(x1,x2)),y1:selY(min(y1,y2)),y2:selY(max(y1,y2)),width:abs(x2-x1),height:abs(y2-y1)};update();options.onSelectChange(img,getSelection())}
function selectingMouseMove(event){x2=/w|e|^$/.test(resize)||aspectRatio?evX(event):viewX(selection.x2);y2=/n|s|^$/.test(resize)||aspectRatio?evY(event):viewY(selection.y2);doResize();return!1}
function doMove(newX1,newY1){x2=(x1=newX1)+selection.width;y2=(y1=newY1)+selection.height;$.extend(selection,{x1:selX(x1),y1:selY(y1),x2:selX(x2),y2:selY(y2)});update();options.onSelectChange(img,getSelection())}
function movingMouseMove(event){x1=max(left,min(startX+evX(event),left+imgWidth-selection.width));y1=max(top,min(startY+evY(event),top+imgHeight-selection.height));doMove(x1,y1);event.preventDefault();return!1}
function startSelection(){$(document).unbind('mousemove',startSelection);adjust();x2=x1;y2=y1;doResize();resize='';if(!$outer.is(':visible'))
$box.add($outer).hide().fadeIn(options.fadeSpeed||0);shown=!0;$(document).unbind('mouseup',cancelSelection).mousemove(selectingMouseMove).one('mouseup',docMouseUp);$box.unbind('mousemove',areaMouseMove);options.onSelectStart(img,getSelection())}
function cancelSelection(){$(document).unbind('mousemove',startSelection).unbind('mouseup',cancelSelection);hide($box.add($outer));setSelection(selX(x1),selY(y1),selX(x1),selY(y1));if(!(this instanceof $.imgAreaSelect)){options.onSelectChange(img,getSelection());options.onSelectEnd(img,getSelection())}}
function imgMouseDown(event){if(event.which!=1||$outer.is(':animated'))return!1;adjust();startX=x1=evX(event);startY=y1=evY(event);$(document).mousemove(startSelection).mouseup(cancelSelection);return!1}
function windowResize(){doUpdate(!1)}
function imgLoad(){imgLoaded=!0;setOptions(options=$.extend({classPrefix:'imgareaselect',movable:!0,parent:'body',resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},options));$box.add($outer).css({visibility:''});if(options.show){shown=!0;adjust();update();$box.add($outer).hide().fadeIn(options.fadeSpeed||0)}
setTimeout(function(){options.onInit(img,getSelection())},0)}
var docKeyPress=function(event){var k=options.keys,d,t,key=event.keyCode;d=!isNaN(k.alt)&&(event.altKey||event.originalEvent.altKey)?k.alt:!isNaN(k.ctrl)&&event.ctrlKey?k.ctrl:!isNaN(k.shift)&&event.shiftKey?k.shift:!isNaN(k.arrows)?k.arrows:10;if(k.arrows=='resize'||(k.shift=='resize'&&event.shiftKey)||(k.ctrl=='resize'&&event.ctrlKey)||(k.alt=='resize'&&(event.altKey||event.originalEvent.altKey)))
{switch(key){case 37:d=-d;case 39:t=max(x1,x2);x1=min(x1,x2);x2=max(t+d,x1);fixAspectRatio();break;case 38:d=-d;case 40:t=max(y1,y2);y1=min(y1,y2);y2=max(t+d,y1);fixAspectRatio(!0);break;default:return}
doResize()}
else{x1=min(x1,x2);y1=min(y1,y2);switch(key){case 37:doMove(max(x1-d,left),y1);break;case 38:doMove(x1,max(y1-d,top));break;case 39:doMove(x1+min(d,imgWidth-selX(x2)),y1);break;case 40:doMove(x1,y1+min(d,imgHeight-selY(y2)));break;default:return}}
return!1};function styleOptions($elem,props){for(var option in props)
if(options[option]!==undefined)
$elem.css(props[option],options[option]);}
function setOptions(newOptions){if(newOptions.parent)($parent=$(newOptions.parent)).append($box.add($outer));$.extend(options,newOptions);adjust();if(newOptions.handles!=null){$handles.remove();$handles=$([]);i=newOptions.handles?newOptions.handles=='corners'?4:8:0;while(i--)
$handles=$handles.add(div());$handles.addClass(options.classPrefix+'-handle').css({position:'absolute',fontSize:0,zIndex:zIndex+1||1});if(!parseInt($handles.css('width'))>=0)
$handles.width(5).height(5);if(o=options.borderWidth)
$handles.css({borderWidth:o,borderStyle:'solid'});styleOptions($handles,{borderColor1:'border-color',borderColor2:'background-color',borderOpacity:'opacity'})}
scaleX=options.imageWidth/imgWidth||1;scaleY=options.imageHeight/imgHeight||1;if(newOptions.x1!=null){setSelection(newOptions.x1,newOptions.y1,newOptions.x2,newOptions.y2);newOptions.show=!newOptions.hide}
if(newOptions.keys)
options.keys=$.extend({shift:1,ctrl:'resize'},newOptions.keys);$outer.addClass(options.classPrefix+'-outer');$area.addClass(options.classPrefix+'-selection');for(i=0;i++<4;)
$($border[i-1]).addClass(options.classPrefix+'-border'+i);styleOptions($area,{selectionColor:'background-color',selectionOpacity:'opacity'});styleOptions($border,{borderOpacity:'opacity',borderWidth:'border-width'});styleOptions($outer,{outerColor:'background-color',outerOpacity:'opacity'});if(o=options.borderColor1)
$($border[0]).css({borderStyle:'solid',borderColor:o});if(o=options.borderColor2)
$($border[1]).css({borderStyle:'dashed',borderColor:o});$box.append($area.add($border).add($areaOpera).add($handles));if($.browser.msie){if(o=($outer.css('filter')||"").match(/opacity=(\d+)/))
$outer.css('opacity',o[1]/100);if(o=($border.css('filter')||"").match(/opacity=(\d+)/))
$border.css('opacity',o[1]/100)}
if(newOptions.hide)
hide($box.add($outer));else if(newOptions.show&&imgLoaded){shown=!0;$box.add($outer).fadeIn(options.fadeSpeed||0);doUpdate()}
aspectRatio=(d=(options.aspectRatio||'').split(/:/))[0]/d[1];$img.add($outer).unbind('mousedown',imgMouseDown);if(options.disable||options.enable===!1){$box.unbind('mousemove',areaMouseMove).unbind('mousedown',areaMouseDown);$(window).unbind('resize',windowResize)}
else{if(options.enable||options.disable===!1){if(options.resizable||options.movable)
$box.mousemove(areaMouseMove).mousedown(areaMouseDown);$(window).resize(windowResize)}
if(!options.persistent)
$img.add($outer).mousedown(imgMouseDown)}
options.enable=options.disable=undefined}
this.remove=function(){setOptions({disable:!0});$box.add($outer).remove()};this.getOptions=function(){return options};this.setOptions=setOptions;this.getSelection=getSelection;this.setSelection=setSelection;this.cancelSelection=cancelSelection;this.update=doUpdate;$p=$img;while($p.length){zIndex=max(zIndex,!isNaN($p.css('z-index'))?$p.css('z-index'):zIndex);if($p.css('position')=='fixed')
position='fixed';$p=$p.parent(':not(body)')}
zIndex=options.zIndex||zIndex;if($.browser.msie)
$img.attr('unselectable','on');$.imgAreaSelect.keyPress=$.browser.msie||$.browser.safari?'keydown':'keypress';if($.browser.opera)
$areaOpera=div().css({width:'100%',height:'100%',position:'absolute',zIndex:zIndex+2||2});$box.add($outer).css({visibility:'hidden',position:position,overflow:'hidden',zIndex:zIndex||'0'});$box.css({zIndex:zIndex+2||2});$area.add($border).css({position:'absolute',fontSize:0});img.complete||img.readyState=='complete'||!$img.is('img')?imgLoad():$img.one('load',imgLoad);if(!imgLoaded&&$.browser.msie&&$.browser.version>=7)
img.src=img.src};$.fn.imgAreaSelect=function(options){options=options||{};this.each(function(){if($(this).data('imgAreaSelect')){if(options.remove){$(this).data('imgAreaSelect').remove();$(this).removeData('imgAreaSelect')}
else $(this).data('imgAreaSelect').setOptions(options)}
else if(!options.remove){if(options.enable===undefined&&options.disable===undefined)
options.enable=!0;$(this).data('imgAreaSelect',new $.imgAreaSelect(this,options))}});if(options.instance)
return $(this).data('imgAreaSelect');return this}})(jQuery)};exports();module.resolveWith(exports)};FD40.module("imgareaselect",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){var passwordStrength=new function()
{this.countRegexp=function(val,rex)
{var match=val.match(rex);return match?match.length:0};this.getStrength=function(val,minLength)
{var len=val.length;if(len<minLength)
{return 0}
var nums=this.countRegexp(val,/\d/g),lowers=this.countRegexp(val,/[a-z]/g),uppers=this.countRegexp(val,/[A-Z]/g),specials=len-nums-lowers-uppers;if(nums==len||lowers==len||uppers==len||specials==len)
{return 1}
var strength=0;if(nums){strength+=2}
if(lowers){strength+=uppers?4:3}
if(uppers){strength+=lowers?4:3}
if(specials){strength+=5}
if(len>10){strength+=1}
return strength};this.getStrengthLevel=function(val,minLength)
{var strength=this.getStrength(val,minLength),val=1;if(strength<=0){val=1}else if(strength>0&&strength<=4){val=2}else if(strength>4&&strength<=8){val=3}else if(strength>8&&strength<=12){val=4}else if(strength>12){val=5}
return val}};$.fn.password_strength=function(options)
{var settings=$.extend({'container':null,'minLength':6,'texts':{1:'Too weak',2:'Weak password',3:'Normal strength',4:'Strong password',5:'Very strong password'},'onCheck':null},options);return this.each(function()
{var container=null;if(settings.container)
{container=$(settings.container)}
else{container=$('<span/>').attr('class','password_strength');$(this).after(container)}
$(this).keyup(function()
{var val=$(this).val(),level=passwordStrength.getStrengthLevel(val,settings.minLength);if(val.length>0)
{var _class='password_strength_'+level;if(!container.hasClass(_class)&&level in settings.texts)
{container.text(settings.texts[level]).attr('class','password_strength '+_class)}}
else{container.text('').attr('class','password_strength')}
if(settings.onCheck){settings.onCheck.call(this,level)}})})}};exports();module.resolveWith(exports)};FD40.module("passwordstrength",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var exports=function(){var _backspace="",_space=" ",_nbsp="\u00a0",_newline="\n",_typeAttr="data-type",_valueAttr="data-value",KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};$.fn.caret=function(start,end){if(this.length==0)return;if(typeof start=='number')
{end=(typeof end=='number')?end:start;return this.each(function()
{if(this.setSelectionRange)
{this.setSelectionRange(start,end)}else if(this.createTextRange)
{var range=this.createTextRange();range.collapse(!0);range.moveEnd('character',end);range.moveStart('character',start);try{range.select()}catch(ex){}}})}else{if(this[0].setSelectionRange)
{start=this[0].selectionStart;end=this[0].selectionEnd}else if(document.selection&&document.selection.createRange)
{var range=document.selection.createRange();start=0-range.duplicate().moveStart('character',-100000);end=start+range.text.length}
return{start:start,end:end}}};var Marker=function(options){$.extend(this,options)}
$.extend(Marker.prototype,{val:function(str){var marker=this;if(str===undefined){return marker.text.nodeValue}
marker.text.nodeValue=str;marker.end=marker.start+(marker.length=str.length);return marker},nextSibling:function(node){var next=node.nextSibling;while(next&&next.nodeType===1&&next.hasAttribute("data-ignore")){next=next.nextSibling}
return next},insert:function(str,start,end){var marker=this,block=marker.block,text=marker.text,parent=marker.parent,br=marker.br,val=marker.val(),length=marker.length,newline=str==_newline,space=str==_space,backspace=str==_backspace,trigger=marker.trigger||{},finalize=trigger.finalize,finalized=marker.finalized,trailingSpace=val.charCodeAt(start-1)==32,allowSpace=trigger.allowSpace||marker.allowSpace,spawnSpace=space&&(!allowSpace||(allowSpace&&trailingSpace));if(start===undefined)start=length;if(end===undefined)end=start;if(block&&allowSpace&&trailingSpace&&!finalized){if(space){var $textarea=$(marker.textarea),wholeText=$textarea.val(),pos=$textarea.caret().end-1,offset=marker.start+start;$textarea.val(wholeText.substring(0,offset)+wholeText.slice(offset+1)).caret(pos)}
marker.toTextMarker();if(space){$(parent).trigger("markerInsert",[marker,nodes,str,start,end]);return marker}else{return marker.insert(str,start,end)}}
if(block&&end==length&&!backspace&&(spawnSpace||newline||br||finalized)){var spawn=marker.spawn().insert(str,0);$(parent).trigger("markerExit",[marker,nodes,spawn,str,start,end]);return spawn}
if(block&&marker.index===0&&end===0&&str.length===1){var textnode=document.createTextNode(str);parent.insertBefore(textnode,block);var newMarker=new Marker({index:0,start:0,end:str.length,text:textnode,parent:parent,textarea:marker.textarea,allowSpace:!0,});$(parent).trigger("markerInsert",[newMarker,nodes,str,start,end]);return newMarker}
var next=block?block.nextSibling:text.nextSibling,prefix=val.substring(0,start),suffix=val.slice(end),chunks=str.replace(/  /g," "+_nbsp).split(_newline),nodes=[],node=block||text,i=chunks.length;chunks[0]=prefix+chunks[0];chunks[i-1]+=suffix;while(--i){var node=document.createTextNode(chunks[i]),br=document.createElement("BR");nodes.push(parent.insertBefore(node,next));nodes.push(parent.insertBefore(br,node));next=br}
marker.val(chunks[i]);$(parent).trigger("markerInsert",[marker,nodes,str,start,end]);return marker},remove:function(){var marker=this,parent=marker.parent,block=marker.block,text=marker.text;if(block)$(block).trigger("triggerDestroy",[marker]);parent.removeChild(block||text);marker.removed=!0;$(parent).trigger("markerRemove",[marker]);return marker},toTextMarker:function(){var marker=this,block=marker.block,parent=marker.parent;if(!block)return marker;var old=marker.clone();if(block)$(block).trigger("triggerDestroy",[marker]);parent.insertBefore(marker.text,block.nextSibling);parent.removeChild(block);delete marker.block;delete marker.trigger;$(marker.parent).trigger("markerConvert",[marker,old,"text"]);return marker},toBlockMarker:function(normalize){var marker=this;if(marker.block)return;var old=marker.clone(),parent=marker.parent,block=marker.block=document.createElement("SPAN"),text=marker.text;parent.insertBefore(block,text.nextSibling);block.appendChild(text);$(block).data("marker",{});$(marker.parent).trigger("markerConvert",[marker,old,"block"]);return marker},spawn:function(start,end){var marker=this,text=marker.text,parent=marker.parent,block=marker.block,next=block?block.nextSibling:text.nextSibling;if(start===undefined){start=end=marker.length}
if(end<marker.length){next=parent.insertBefore(text.splitText(end),next)}
text=parent.insertBefore(text.splitText(start),next);var spawn=new Marker({index:marker.index+1,start:(start=marker.start+start),end:(end=marker.start+end),length:end-start,text:text,parent:parent,textarea:marker.textarea,before:marker,after:marker.after,br:!1,allowSpace:!0,finalized:!1});marker.end=start,marker.length=marker.end-marker.start;marker.after=spawn;return spawn},clone:function(){return new Marker($.pick(this,"index,start,end,length,text,parent,textarea,before,after,br,allowSpace,trigger,value,finalized".split(",")))},finalize:function(value){var marker=this,block=marker.block;if(!block)return;var data=$(block).data("marker");data.value=value;data.finalized=!0;$.extend(marker,data)}});$.Controller("Mentions",{pluginName:"mentions",hostname:"mentions",defaultOptions:{cssCloneProps:['lineHeight','textDecoration','letterSpacing','fontSize','fontFamily','fontStyle','fontWeight','textTransform','textAlign','direction','wordSpacing','fontSizeAdjust'],triggers:{},inspector:!1,"{textarea}":"[data-mentions-textarea]","{overlay}":"[data-mentions-overlay]","{block}":"[data-mentions-overlay] > span"}},function(self){return{init:function(){self._overlay=self.overlay()[0];self._textarea=self.textarea()[0];setTimeout(function(){self.cloneLayout()},15);if(self.options.inspector){self.inspect()}
self.addPlugin("autocomplete");self.initialCaret=self.textarea().data("initial")||0},inspect:function(){self.inspector=self.addPlugin("inspector");self.inspector.showInspector()},setLayout:function(){self.normalize()},cloneLayout:function(){var $overlay=self.overlay(),overlay=$overlay.detach()[0],textarea=self.textarea(),props=self.options.cssCloneProps,i=0;while(prop=props[i++]){overlay.style[prop]=textarea.css(prop)}
overlay.style.opacity=1;$overlay.insertBefore(textarea);self.setLayout()},reset:function(){var overlay=self.overlay(),overlayDefault=overlay.data("default");if(overlayDefault!==undefined){overlay.html($('<div>').html(overlayDefault).html())}else{overlay.empty()}
var textarea=self.textarea(),textareaDefault=textarea.data("default");if(textareaDefault!==undefined){textarea.val($('<div>').html(textareaDefault).text())}else{textarea.val("")}
self.caretBefore=self.caretAfter={start:0,end:0};self.previousMarker=null;self.normalize();self.initialFocus=!0;self.trigger("triggerClear")},getTrigger:function(key){var triggers=self.options.triggers;if(triggers.hasOwnProperty(key)){var trigger=triggers[key];trigger.key=key;return trigger}},getTriggerFromType:function(type){var triggers=self.options.triggers,found;$.each(triggers,function(key,trigger){if(trigger.type===type){found=trigger;return!1}});return found},getStopIndex:function(str,stop){var i=stop.length,idx=str.length;while(i--){var chr=stop.substr(i,1),pos=str.indexOf(chr);idx=(pos<0)?idx:Math.min(idx,pos)}
return idx},getMarkers:function(callback){var textarea=self._textarea,overlay=self._overlay,nodes=$.makeArray(overlay.childNodes),node,i=0,start=0,before=null,skip=!1,results=[],iterator=function(marker){var ret;if(callback)ret=callback.apply(marker,[marker]);if(ret!==null&&ret!==!1)results.push(ret!==undefined?ret:marker);return ret};$.remove(nodes,function(node){return node.nodeType===1&&node.hasAttribute('data-ignore')});while(node=nodes[i++]){var nodeType=node.nodeType,nodeName=node.nodeName,text,block=null,end,length,br=!1,allowSpace=!1;if(nodeType==3){text=node;allowSpace=!0}else if((block=node)&&nodeName=="BR"){text=document.createTextNode(_newline);br=!0}else if(nodeType!==1||nodeName!=="SPAN"||!(text=node.childNodes[0])||text.nodeType!==3){overlay.removeChild(node);continue}
var props={index:i-1,start:start,end:(end=start+(length=text.length)),length:length,text:text,block:block,parent:overlay,textarea:textarea,before:before,br:br,allowSpace:allowSpace,finalized:!1};if(block){var $node=$(node),data=$node.data("marker");if(!data)(data={})&&$node.data("marker",data);if(node.hasAttribute(_typeAttr)){var type=$node.attr(_typeAttr),trigger=self.getTriggerFromType(type);if(trigger)data.trigger=trigger;$node.removeAttr(_typeAttr)}
if(node.hasAttribute(_valueAttr)){data.value=$node.attr(_valueAttr);data.finalized=!0;$node.removeAttr(_valueAttr)}
$.extend(props,data)}
var marker=new Marker(props);if(i>1){before.after=marker;if(skip=(iterator(before)===!1))break}
start=end;before=marker}
if(!skip)iterator(before);return results},getMarkerAt:function(pos){if(pos===undefined)return;var marker;self.getMarkers(function(){if(pos>=this.start&&pos<=this.end){marker=this;return!1}});return marker},getMarkersBetween:function(start,end){if(start===undefined)return;return self.getMarkers(function(){return(this.start>end)?!1:(this.end<start)?null:this})},toArray:function(stringify,asc){var results=self.getMarkers(function(){var marker=this;if(!marker.block||marker.br)return null;if(!marker.trigger){var wholeText=marker.text.nodeValue,key=wholeText.slice(0,1),trigger=self.getTrigger(key);if(!trigger)return null;marker.trigger=trigger;marker.value=wholeText.slice(1)}
var data={start:marker.start,length:marker.length,type:marker.trigger.type,value:marker.value};return(stringify)?JSON.stringify(data):data});return(asc)?results:results.reverse()},insert:function(str,start,end){var marker,offset;if(start===end||end===undefined){marker=self.getMarkerAt(start);offset=marker.start;marker.insert(str,start-offset,end-offset)}else{var markers=self.getMarkersBetween(start,end),length=markers.length;if(length<1)return;if(length==1){marker=markers[0];offset=marker.start;marker.insert(str,start-offset,end-offset)}else{var i=length-1,marker=markers[i];if(marker.block&&end>marker.start)marker.toTextMarker();if((end-marker.start)>0){marker.insert("",0,end-marker.start)}
while((marker=markers[--i])&&i>0){marker.remove()}
if(marker.block&&marker.index===0&&start===0)marker.toTextMarker();marker.insert(str,start-marker.start,marker.length);if(start===0&&marker.br){marker.remove()}}}
self.normalize();return marker},textareaInsert:function(str,start,end){var textarea=self._textarea,val=textarea.value;return textarea.value=val.substring(0,start)+str+val.slice(end)},normalize:function(){var overlay=self._overlay,textarea=self._textarea;overlay.normalize();var first=overlay.firstChild,last=overlay.lastChild,textNode=document.createTextNode("");if(!last||last.nodeName==="BR"){overlay.appendChild(textNode)}
if(last&&last==first&&last.nodeType===1&&last.hasAttribute("data-ignore")){overlay.insertBefore(textNode,last)}
overlay.style.height="auto";overlay.style.height=textarea.scrollHeight+"px";textarea.scrollTop=0;self.lengthBefore=textarea.value.length},lengthBefore:0,caretBefore:{start:0,end:0},caretAfter:{start:0,end:0},skipKeydown:!1,previousMarker:null,initialFocus:!0,"{textarea} focus":function(){if(self.initialFocus){self.textarea().caret(self.initialCaret||0)}},"{textarea} keydown":function(textarea,event){self.initialFocus=!1;if(self.skipKeydown)return;var caret=self.caretBefore=textarea.caret();if(event.keyCode===8&&$.IE<10){self.overlay().css('opacity',0)}
self.skipKeydown=!0},"{textarea} keypress":function(textarea,event){self.caretBefore=textarea.caret();if(event.keyCode===8)return},"{textarea} input":function(textarea){self.reflect();if(textarea.val().length<1){self.reset()}},"{textarea} keyup":function(textarea,event){self.skipKeydown=!1;if(event.keyCode===8&&$.IE<10){var caretBefore=self.caretBefore,caretAfter=self.caretAfter=self.textarea().caret();self.insert("",caretAfter.end,caretBefore.end);self.caretBefore=caretAfter;self.overlay().css('opacity',1)}},reflect:function(){var textarea=self._textarea,wholeText=textarea.value,caretBefore=self.caretBefore,caretAfter=self.caretAfter=$(textarea).caret(),operaCandidateWindow=($.browser.opera&&caretAfter.end>caretAfter.start),marker=self.getMarkerAt(caretBefore.start),diff=self.lengthBefore-wholeText.length,replace=!1;if(operaCandidateWindow){if(caretBefore.start!==caretBefore.end){caretBefore.end+=diff}}
if(!marker)return;var previousMarker=self.previousMarker,block=marker.block;if(previousMarker){var previousBlock=previousMarker.block,finalize=(previousMarker.trigger||{}).finalize;if(previousBlock&&finalize&&!previousMarker.finalized&&previousBlock!==block){try{previousMarker.toTextMarker()}catch(e){self.previousMarker=null}}}
if(!marker.br&&(diff===0||caretAfter.end<caretBefore.start)){var textStart=marker.start,textEnd=marker.end-diff,rangeStart=caretAfter.end,rangeEnd=caretBefore.start,replace=textStart!==textEnd}else{var rangeStart=textStart=Math.min(caretBefore.start,caretAfter.start),rangeEnd=caretBefore.end,textEnd=caretAfter.end}
var text=wholeText.substring(textStart,textEnd);if(replace){if(marker.val()!==text&&marker.finalized){marker.toTextMarker()}
marker.val(text);self.overlay().trigger("markerInsert",marker,[],text,textStart,textEnd);self.normalize()}else{self.insert(text,rangeStart,rangeEnd)}
if(operaCandidateWindow){caretAfter.start=caretAfter.end}
self.caretBefore=self.caretAfter},"{overlay} markerInsert":function(overlay,event,marker,nodes,str,start,end){var text=marker.text,wholeText=text.nodeValue,trigger;self.previousMarker=null;if(trigger=self.getTrigger(str)){var charBefore=wholeText.charCodeAt(start-1),brBefore=marker.before&&marker.before.br;if(marker.index===0||(charBefore===32||brBefore)){var remainingText=wholeText.slice(start),content=remainingText.slice(1);if(trigger.wrap&&remainingText.length>1){end=self.getStopIndex(content,trigger.stop)+start+1}else{end=start+1}
var spawn=marker.spawn(start,end).toBlockMarker(),content=spawn.val().slice(1);var data=$(spawn.block).data("marker");data.value=content;data.trigger=trigger;self.previousMarker=spawn;self.trigger("triggerCreate",[spawn,trigger,content])}}
if(marker.block&&!marker.br){if(marker.finalized){var length=marker.length;if(end<length-1)marker.toTextMarker()}else{var key=wholeText.slice(0,1),trigger=self.getTrigger(key);if(!trigger)return;var content=wholeText.slice(1),start=self.getStopIndex(content,trigger.stop)+1,end=wholeText.length,spawn=!1;if(start<end){spawn=marker.spawn(start,end)}
content=marker.val().slice(1);var data=$(marker.block).data("marker");data.value=content;data.trigger=trigger;self.previousMarker=marker;self.trigger("triggerChange",[marker,spawn,trigger,content])}}},"{overlay} markerExit":function(overlay,event,marker,nodes,spawn,str,start,end){var trigger=marker.trigger;if(!trigger)return;var allowSpace=trigger.allowSpace||marker.allowSpace,content=marker.val();if(!allowSpace&&marker.val()===trigger.key){marker.toTextMarker()}
self.trigger("triggerExit",[marker,spawn,trigger,content])}}});$.template("mentions/menu",'<div class="mentions-autocomplete" data-mentions-autocomplete><b><b></b></b><div class="mentions-autocomplete-inner" data-mentions-autocomplete-viewport><div class="mentions-autocomplete-loading" data-mentions-autocomplete-loading data-mentions-autocomplete-close></div><div class="mentions-autocomplete-empty" data-mentions-autocomplete-empty></div><div class="mentions-autocomplete-search" data-mentions-autocomplete-search></div><ul class="mentions-menu" data-mentions-menu></ul></div></div>');$.template("mentions/menuItem",'<li class="mentions-menuItem" data-mentions-menuItem>[%== html %]</li>');$.template("mentions/loadingHint",'<i class="mentions-autocomplete-loading-indicator"></i>');$.template("mentions/searchHint",'<span class="mentions-autocomplete-search-hint">Type a keyword to begin.</span>');$.template("mentions/emptyHint",'<span class="mentions-autocomplete-empty-text">No items found.</span>');$.Controller("Mentions.Autocomplete",{defaultOptions:{view:{menu:"mentions/menu",menuItem:"mentions/menuItem",searchHint:"mentions/searchHint",loadingHint:"mentions/loadingHint",emptyHint:"mentions/emptyHint"},id:"",component:"",modifier:"",shadow:!1,sticky:!1,animation:!1,query:{data:null,cache:!0,minLength:1,limit:10,highlight:!0,caseSensitive:!1,exclusive:!1,searchHint:!1,loadingHint:!1,emptyHint:!1},position:{my:'left top',at:'left bottom',collision:'none'},size:{width:"auto",height:"auto"},"{menu}":"[data-mentions-menu]","{menuItem}":"[data-mentions-menuItem]","{viewport}":"[data-mentions-autocomplete-viewport]","{loadingHint}":"[data-mentions-autocomplete-loading]","{emptyHint}":"[data-mentions-autocomplete-empty]","{searchHint}":"[data-mentions-autocomplete-search]","{closeButton}":"[data-mentions-autocomplete-close]"}},function(self,opts,base){return{init:function(){setTimeout(function(){if(!self.element.data(self.Class.fullName)){self.destroy();var menu=self.view.menu().attr("id",opts.id).addClass(opts.component).addClass(opts.modifier).addClass(opts.shadow?'has-shadow':'').addClass(opts.animation?'has-animation':'').addClass(opts.sticky?'is-sticky':'').appendTo("body").data(self.Class.fullName,!0).addController(self.Class,opts);return}
var mentions=self.mentions;self.uid=$.uid();mentions.autocomplete=self;mentions.pluginInstances.autocomplete=self;if(!opts.position.of){opts.position.of=self.mentions.element}
self.defaultSearchHint=self.view.searchHint().toHTML();self.defaultEmptyHint=self.view.emptyHint().toHTML();self.defaultLoadingHint=self.view.loadingHint().toHTML();self.element.detach()},50)},setLayout:function(){if(!self.hidden){var options=self.options,size=options.size,width=self.mentions.element.outerWidth(),height="auto";if($.isFunction(size.width)){width=size.width(width)}
if($.isFunction(size.height)){height=size.height(height)}
self.element.css({opacity:1,width:width}).position(self.options.position);setTimeout(function(){self.viewport().addClass("active")},1)}},"{window} resize":$.debounce(function(){self.element.css("opacity",0);self.setLayout()},250),"{window} scroll":$.debounce(function(){self.element.css("opacity",0);self.setLayout()},250),"{window} dialogTransitionStart":function(){self.hidden=!0;self.element.css("opacity",0)},"{window} dialogTransitionEnd":function(){self.hidden=!1;self.setLayout()},currentMarker:null,"{mentions} triggerCreate":function(el,event,marker,trigger,content){self.populate(marker,trigger,content);self.currentMarker=marker},"{mentions} triggerChange":function(el,event,marker,spawn,trigger,content){self.populate(marker,trigger,content);self.currentMarker=marker},"{mentions} triggerExit":function(el,event,marker,spawn,trigger,content){var query=self.activeQuery;if(query){query.aborted=!0}
self.hide()},"{mentions.block} triggerDestroy":function(el,event,marker){self.hide()},"{mentions} triggerClear":function(){self.hide()},hidden:!0,show:function(duration){clearTimeout(self.sleep);self.element.appendTo("body").show();self.hidden=!1;self.viewport().removeClass("active");self.setLayout();var doc=$(document),hideOnClick="click.mentions."+self.uid;doc.off(hideOnClick).on(hideOnClick,function(event){var targets=$(event.target).parents().andSelf();if(targets.filter(base).length>0)return;doc.off(hideOnClick);self.hide()});if(duration){self.sleep=setTimeout(function(){self.hide()},duration)}},hide:function(){self.element.hide();var menuItem=self.menuItem(),activeMenuItem=menuItem.filter(".active");if(activeMenuItem.length>0){self.lastItem={keyword:"",item:activeMenuItem.data("item")}}
self.viewport().removeClass("active");menuItem.removeClass("active");self.render.reset();self.hidden=!0;clearTimeout(self.sleep);self.sleep=setTimeout(function(){self.element.detach()},3000)},query:function(options){if(!options)return;var query=$.extend({},self.options.query,($.isPlainObject(options)?options:{data:options})),data=query.data;if(!data)return;if($.isUrl(data)){var url=data;query.lookup=function(){return $.ajax(url+query.keyword)}}
if($.isFunction(data)){var func=data;query.lookup=function(){return func.call(self,query.keyword)}}
if($.isArray(data)){var dataset=data;query.lookup=function(){var task=$.Deferred(),keyword=query.keyword.toLowerCase();setTimeout(function(){var result=$.grep(dataset,function(item){return item.title.toLowerCase().indexOf(keyword)>-1});task.resolve(result)},0);return task}}
return query},tasks:{},delayTask:null,activeQuery:null,populate:function(marker,trigger,keyword){var query=self.activeQuery;if(query){query.aborted=!0}
var query=self.query(trigger.query);if(!query)return;self.activeQuery=query;query.keyword=keyword;query.trigger=trigger;query.marker=marker;self.trigger("queryPrepare",[query]);var keyword=query.keyword;if(keyword===""||(keyword.length<query.minLength)){var searchHint=query.searchHint;if(searchHint){self.searchHint().html($.isString(searchHint)?searchHint:self.defaultSearchHint);self.element.addClass("search");self.show()}else{self.hide()}
return}
var id=query.id=trigger.key+"|"+(query.caseSensitive)?keyword:keyword.toLowerCase(),tasks=self.tasks,task=query.task=tasks[id],newTask=!$.isDeferred(task)||!query.cache,runTask=function(){var event=self.trigger("queryBeforeStart",[query]);if(event.isDefaultPrevented())return;if(newTask||(!newTask&&task.state()=="rejected")){task=tasks[id]=query.task=query.lookup()}
task.done(self.render(function(items){return[items,query]}));self.trigger("queryStart",[query])};if(newTask){clearTimeout(self.delayTask);self.delayTask=setTimeout(runTask,250)}else{runTask()}},"{self} queryPrepare":function(el,event,query){el.removeClass("loading empty search");if(query.loadingHint){self.hide()}},"{self} queryBeforeStart":function(el,event,query){var loadingHint=query.loadingHint;if(loadingHint){self.loadingHint().html($.isString(loadingHint)?loadingHint:self.defaultLoadingHint);el.addClass("loading");self.show()}},"{self} queryStart":function(el,event,query){query.task.fail(function(){self.hide()}).always(function(){el.removeClass("loading")})},render:$.Enqueue(function(items,query){if(query.aborted){self.hide();return}
if(!$.isArray(items)){items=[]};var mentions=self.mentions,autocomplete=self,element=self.element,menu=self.menu(),keyword=query.keyword;if(items.length<1){var emptyHint=query.emptyHint;if(emptyHint){self.emptyHint().html($.isString(emptyHint)?emptyHint:self.defaultEmptyHint);menu.empty();element.addClass("empty");self.show(2000)}else{self.hide()}
mentions.trigger("menuRender",[menu,query,autocomplete,mentions]);return}
element.removeClass("empty");if(!query.cache||menu.data("keyword")!==keyword){menu.empty();$.each(items,function(i,item){mentions.trigger("menuCreateItem",[item,query,autocomplete,mentions]);if(!$.isPlainObject(item)||item.discard)return;var html=item.menuHtml||item.title;self.view.menuItem({html:html}).data("item",item).appendTo(menu)});menu.data("keyword",keyword)}
var menuItems=self.menuItem();mentions.trigger("menuCreate",[menu,menuItems,query,autocomplete,mentions]);if(menuItems.filter(":not(.hidden)").length<1){element.addClass("empty");if(!query.emptyHint){return self.hide()}}
if(query.exclusive){self.menuItem(":not(.hidden):first").addClass("active")}
mentions.trigger("renderMenu",[menu,query,autocomplete,mentions]);self.show()}),"{mentions.textarea} keydown":function(textarea,event){clearTimeout(self.sleep);var activeMenuItem=self.menuItem(".active:not(.hidden)");if(activeMenuItem.length<1){activeMenuItem=!1}
switch(event.keyCode){case KEYCODE.UP:self.menuItem().removeClass("active");if(!activeMenuItem){self.menuItem(":not(.hidden):last").addClass("active")}else{activeMenuItem.prev(self.menuItem.selector+':not(.hidden)').addClass("active")}
if(!self.hidden){event.preventDefault()}
break;case KEYCODE.DOWN:self.menuItem().removeClass("active");if(!activeMenuItem){self.menuItem(":not(.hidden):first").addClass("active")}else{activeMenuItem.next(self.menuItem.selector+':not(.hidden)').addClass("active")}
if(!self.hidden){event.preventDefault()}
break;case KEYCODE.ESCAPE:self.hide();break;case KEYCODE.ENTER:if(!self.hidden&&activeMenuItem){var item=activeMenuItem.data("item");self.use(item);event.preventDefault()}
break}
var activeMenuItem=self.menuItem(".active:not(.hidden)");if(!self.hidden){self.viewport().scrollIntoView(activeMenuItem)}},"{menuItem} mouseup":function(menuItem){self.hide();var item=menuItem.data("item");self.use(item);setTimeout(function(){self.mentions.textarea().focus()},150)},use:function(item){var query=self.activeQuery;if(!query)return;var marker=query.marker,title=item.title;marker.text.nodeValue=title;delete item.menuHtml;var value=item;if(query.use){value=query.use(item)}
marker.finalize(value);self.mentions.textareaInsert(title,marker.start,marker.end);self.mentions.textarea().caret(marker.start+title.length);self.mentions.normalize();self.hidden=!0;self.hide()},"{menuItem} mouseover":function(menuItem){self.menuItem().removeClass("active");menuItem.addClass("active")},"{menuItem} mouseout":function(menuItem){self.menuItem().removeClass("active")},"{closeButton} click":function(){self.hide()},"{mentions} destroyed":function(){self.element.remove()}}});$.template("mentions/inspector",'<div class="mentions-inspector" data-mentions-inspector><fieldset><b>Selection</b><hr/><label>Start</label><input type="text" data-mentions-selection-start/><hr/><label>End</label><input type="text" data-mentions-selection-end/><hr/><label>Length</label><input type="text" data-mentions-selection-length/><hr/></fieldset><fieldset><b>Trigger</b><hr/><label>Key</label><input type="text" data-mentions-trigger-key/><hr/><label>Type</label><input type="text" data-mentions-trigger-type/><hr/><label>Buffer</label><input type="text" data-mentions-trigger-buffer/><hr/></fieldset><hr/> <fieldset><b>Marker</b><hr/><label>Index</label><input type="text" data-mentions-marker-index/><hr/><label>Start</label><input type="text" data-mentions-marker-start/><hr/><label>End</label><input type="text" data-mentions-marker-end/><hr/><label>Length</label><input type="text" data-mentions-marker-length/><hr/><label>Text</label><input type="text" data-mentions-marker-text/><hr/></fieldset><fieldset><b>Block</b><hr/><label>Html</label><input type="text" data-mentions-block-html/><hr/><label>Text</label><input type="text" data-mentions-block-text/><hr/><label>Type</label><input type="text" data-mentions-block-type/><hr/><label>Value</label><input type="text" data-mentions-block-value/><hr/></fieldset></div>');$.Controller("Mentions.Inspector",{defaultOptions:{view:{item:"mentions/item",inspector:"mentions/inspector"},"{inspector}":"[data-mentions-inspector]","{selectionStart}":"[data-mentions-selection-start]","{selectionEnd}":"[data-mentions-selection-end]","{selectionLength}":"[data-mentions-selection-length]","{markerIndex}":"[data-mentions-marker-index]","{markerStart}":"[data-mentions-marker-start]","{markerEnd}":"[data-mentions-marker-end]","{markerLength}":"[data-mentions-marker-length]","{markerText}":"[data-mentions-marker-text]","{blockText}":"[data-mentions-block-text]","{blockHtml}":"[data-mentions-block-html]","{blockType}":"[data-mentions-block-type]","{blockValue}":"[data-mentions-block-value]","{triggerKey}":"[data-mentions-trigger-key]","{triggerType}":"[data-mentions-trigger-type]","{triggerBuffer}":"[data-mentions-trigger-buffer]"}},function(self){return{init:function(){},showInspector:function(){if(self.inspector().length<1){self.view.inspector().appendTo(self.element)}
self.inspector().show();self.mentions.overlay().css("color","green")},hideInspector:function(){self.inspector().hide();self.mentions.overlay().css("color","transparent")},"{mentions.textarea} keyup":function(){self.inspect()},"{inspector} dblclick":function(){self.textarea().toggle()},inspect:$.debounce(function(){var caret=self.mentions.textarea().caret();self.selectionStart().val(caret.start);self.selectionEnd().val(caret.end);self.selectionLength().val(caret.end-caret.start);var triggerKey=self.triggered;if(triggerKey){var trigger=self.getTrigger(triggerKey);self.triggerKey().val(triggerKey);self.triggerType().val(trigger.type);self.triggerBuffer().val(self.buffer)}else{self.triggerKey().val('');self.triggerType().val('');self.triggerBuffer().val('')}
var marker=self.mentions.getMarkerAt(caret.start);if(marker){self.markerIndex().val(marker.index).data('marker',marker);self.markerStart().val(marker.start);self.markerEnd().val(marker.end);self.markerLength().val(marker.length);self.markerText().val(marker.text.nodeValue)}else{self.markerIndex().val('').data('marker',null);self.markerStart().val('');self.markerEnd().val('');self.markerLength().val('');self.markerText().val('')}
var block=(marker||{}).block;if(block){self.blockText().val(marker.text.nodeValue);self.blockHtml().val($(block).clone().toHTML())}else{self.blockText().val('');self.blockHtml().val('')}},25),"{markerIndex} click":function(el){console.dir(el.data("marker"))}}})};exports();module.resolveWith(exports)};FD40.module("mentions",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;$.require().script("ui/position","easing").done(function(){var exports=function(){$.template('dialog/default','<div class="foundryDialog global"><div class="dialog-wrap"><div class="in"><div class="dialog-loader"><div class="loader-img"></div></div><div class="dialog-head"><span class="dialog-title"></span><a class="dialog-closeButton">Close</a></div><div class="dialog-body dialog-content"></div><div class="dialog-footer"><div class="dialog-loading"></div><div class="dialog-buttons"></div></div></div></div></div>');$.Controller('Dialog',{pluginName:"dialog",defaultOptions:{title:'',content:undefined,buttons:{},customClass:"",width:'auto',height:'auto',css:{position:'absolute',width:'auto',height:'auto',zIndex:10001},position:{my:'center center',at:'center center',of:window},offset:100,showOverlay:!0,overlay:{css:{background:'#000',opacity:'0.4',position:'fixed',top:0,left:0,zIndex:10000,width:'100%',height:'100%',display:'none'}},body:{css:{minWidth:0,minHeight:0,overflow:'auto'}},loader:{width:300,height:100,},loading:"",iframe:{css:{width:'100%',height:'100%',border:'none'}},transition:{show:'zoom',hide:'zoom'},escapeKey:!0,beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},dialogHead:'.dialog-head',dialogBody:'.dialog-body',dialogFooter:'.dialog-footer',dialogTitle:'.dialog-title',dialogContent:'.dialog-content',dialogButtons:'.dialog-buttons',dialogLoader:'.dialog-loader',dialogLoading:'.dialog-loading',"{closeButton}":'.dialog-closeButton'}},function(self){return{ready:!1,contentReady:!1,init:function()
{self.setInitOptions(self.options);self.initElement=self.element.clone();self.element.finalizeContent=function(){return self.finalizeContent.apply(self,arguments)};$.each(['dialogHead','dialogBody','dialogFooter','dialogTitle','dialogContent','dialogButtons','dialogLoader','dialogLoading'],function(i,name)
{self[name]=self.find(self.options[name])});if(self.options.content===undefined){return}
self.display()},"{self} destroyed":function(){$(document).off("keydown.foundry.dialog")},setInitOptions:function(options)
{self.initOptions=$.extend(!0,{},options);$.each(['beforeShow','afterShow','beforeHide','afterHide'],function(i,name){self.initOptions[name]=function(){}});$.each(['title','content','buttons','loading','selectors','bindings'],function(i,name){self.initOptions[name]=null})},update:function(options)
{if(options)
{if(options.hasOwnProperty("{binder}"))return;var options=$.extend(!0,{},self.initOptions,options);self.setInitOptions(options);self.display(options)}
return self},determineContentType:function(content){if(/<dialog>(.*?)/.test(content)){return 'dialog'}
if($.isUrl(content)){return 'iframe'}
if($.isDeferred(content)){return 'deferred'}
return 'html'},displayQueue:[],display:function(options)
{if(self.resizing){return self.displayQueue.push(options)}
if($.isPlainObject(options)){self.options=$.extend(!0,{},self.Class.defaults,options)}
if(!self.ready)
{if(self.options.showOverlay)
self.createOverlay()}
var options=self.options,content=options.content;self.contentReady=content===null;self.contentType=self.determineContentType(content);var transition=options.transition;if($.isString(transition)){options.transition={show:transition,hide:transition}}
switch(self.contentType)
{case 'html':self.hideLoader();self.show();break;case 'iframe':var iframe=$(document.createElement('iframe')),iframeUrl=content,iframeCss=options.iframe.css,iframeButtons=options.buttons,dialogContent=self.dialogContent,iframeOptions=$.extend(!0,{},options,{content:iframe,buttons:iframeButtons});self.showLoader(function()
{onIframeLoaded=(function()
{return function(event)
{try{iframe[0].contentWindow.parentDialog=self}catch(err){};self.update(iframeOptions)}})();self.dialogBody.addClass('type-iframe');iframe.appendTo(dialogContent).css(iframeCss).css({position:'absolute',visibility:'hidden'}).one('load',onIframeLoaded).attr('src',iframeUrl)});break;case 'deferred':var ajax=content;self.showLoader(function(){ajax.done(function(html){if(!html)return;var newOptions=($.isString(html))?{content:html}:html;if(!newOptions.content)return;self.update($.extend(!0,{},options,newOptions))}).fail(function(message,type){var title=$.isString(type)?$.String.capitalize(type):"Error",content=$.isString(message)?message:"There was an error loading content.";self.update({title:title,content:content})})});break;case 'dialog':var xmlOptions=$.buildHTML(content),newOptions={};$.each(xmlOptions.children(),function(i,node){var node=$(node),key=$.String.camelize(this.nodeName.toLowerCase()),val=node.html(),type=node.attr("type");switch(type){case "json":try{val=$.parseJSON(val)}catch(e){};break;case "javascript":try{val=eval('(function($){ return '+$.trim(val)+' })('+$.globalNamespace+')')}catch(e){};break;case "text":val=node.text();break}
if($.isNumeric(val))val=parseFloat(val);newOptions[key]=val});self.update($.extend(!0,{},options,newOptions));break}},loading:function(flag){var el=self.element;if(flag===undefined){return el.hasClass("loading")}
if(flag===!1){el.removeClass("loading");return}
if(flag===!0){flag=self.options.loading||""}
if($.isString(flag)){el.addClass("loading");self.dialogLoading.html(flag)}},showLoader:function(callback)
{var originalWidth=self.options.width,originalHeight=self.options.height;var showLoaderOverlay=function()
{self.dialogLoader.show().css({width:self.dialogBody.outerWidth(!0),height:self.dialogBody.outerHeight(!0)}).position({my:'top left',at:'top left',of:self.options.dialogContent});self.options.width=originalWidth;self.options.height=originalHeight;return callback&&callback()};return(self.ready)?showLoaderOverlay():self.update($.extend({title:self.options.title,content:'',width:self.initOptions.body.css.minWidth,height:self.initOptions.body.css.minHeight,afterShow:showLoaderOverlay},self.options.loader))},hideLoader:function()
{self.element.removeClass("loading");self.dialogLoader.hide()},autoSize:function()
{return self.initOptions.css.width=='auto'||self.initOptions.css.height=='auto'},finalizeContent:function(finale)
{var options=self.options,content=options.content;self.element.css(options.css);self.dialogContent.css(options.body.css);if(self.refreshing)return;if(options.title!==null)
self.dialogTitle.html(options.title);if(content!==null)
{var isIframe=!$.isString(content)&&$(content).is('iframe');self.dialogBody.toggleClass('type-iframe',isIframe);if(isIframe)
{var parent=content.parent()[0];var i=0;while(parent.childNodes.length>1)
{var node=parent.childNodes[i];if(node!==content[0])
parent.removeChild(node);i++}
content.css({position:'relative',visibility:'visible'})}else{var finalContent;if(finale){finalContent=content;options.content=self.stripScript(finalContent)}else{finalContent=self.stripScript(content)}
self.dialogContent.html(finalContent)}}
if(!self.contentReady)
self.finalizeButtons();return self.element},stripScript:function(html){if(!$.isString(html))return html;var content=$($.parseHTML(html));content.find("script").remove();return content},finalizeSize:function(fast)
{var refElement=self.refElement,options=self.options,body=options.body,content=options.content,css=options.css,bodyCss=body.css;if(refElement===undefined){refElement=self.refElement=self.initElement.clone().removeClass('global').insertAfter(self.element)}else{refElement.insertAfter(self.element)}
if(!fast)
{refTitle=refElement.find(options.dialogTitle);refBody=refElement.find(options.dialogBody);refFooter=refElement.find(options.dialogFooter);refButtons=refElement.find(options.dialogButtons);refElement.css(self.initOptions.css).css({display:'block'});refTitle.html(options.title);if(!$.isEmptyObject(options.buttons))
{refFooter.show();refButtons.append('<button>test</button>')}else{refFooter.hide()}
var isIframe=!$.isString(content)&&$(content).is('iframe');var refContent=(isIframe)?document.createElement('div'):self.stripScript(content);bodyCss.width=(isIframe&&options.width=='auto')?content.contents().width():options.width;bodyCss.height=(isIframe&&options.height=='auto')?content.contents().height():options.height;refBody.css(bodyCss).toggleClass('type-iframe',isIframe).html(refContent);var refBodyWidth=refBody.width(),refBodyHeight=refBody.height();if(refBody.css("boxSizing")!=="border-box"){bodyCss.width=refBodyWidth;bodyCss.height=refBodyHeight}
if(bodyCss.width<bodyCss.minWidth){bodyCss.width=bodyCss.minWidth}
if(bodyCss.height<bodyCss.minHeight){bodyCss.height=bodyCss.minHeight}
var offset=options.offset,width=refElement.width(),height=refElement.height(),maxWidth=$(window).width()-offset,maxHeight=$(window).height()-offset,widthExceeded=width>maxWidth,heightExceeded=height>maxHeight;css.width=(widthExceeded)?maxWidth:width;css.height=(heightExceeded)?maxHeight:height;if(bodyCss.width!=="auto")bodyCss.width-=(width-css.width);if(bodyCss.width<=0)bodyCss.width="auto";if(bodyCss.height!=="auto")bodyCss.height-=(height-css.height);if(bodyCss.height<=0)bodyCss.height="auto";bodyCss.minWidth=bodyCss.minHeight='auto';refBody.css(bodyCss);bodyCss.overflowX=(!widthExceeded||isIframe||refBody[0].scrollWidth<=bodyCss.width)?'auto':'scroll';bodyCss.overflowY=(!heightExceeded||isIframe||refBody[0].scrollHeight<=bodyCss.height)?'auto':'scroll';refBody.html('')}
refElement.css(css).css('visibility','hidden').position(options.position);css.top=refElement.css('top');css.left=refElement.css('left')},finalizeButtons:function()
{var dialogFooter=self.dialogFooter,dialogButtons=self.dialogButtons;dialogButtons.empty();var buttons=self.options.buttons;if($.isEmptyObject(buttons)){dialogFooter.hide();return}
if($.isString(buttons)){dialogButtons.html(buttons)}
if($.isArray(buttons)){$.each(buttons,function(i,button){var events=$.extend({},button),classNames=button.classNames?button.classNames:'';delete events.name;delete events.classNames;$(document.createElement('button')).attr('type','button').addClass(classNames).html(button.name).bind(events).appendTo(dialogButtons)})}
dialogFooter.show()},show:function(callback)
{if(self.ready&&self.resizing)return;var options=self.options;if(self.refElement){self.refElement.remove()}
if(!self.contentReady){options.beforeShow.apply(self)}
$(document).off("keydown.foundry.dialog");if(options.escapeKey){$(document).on("keydown.foundry.dialog",function(event){if(event.keyCode==27){self.close()}})}
self.resizing=!0;self.finalizeSize();self.element.addClass('resizing');$(window).trigger("dialogTransitionStart");self.transition[options.transition.show].show.apply(self,[function()
{if(!self.ready)
{self.on("resize.dialog scroll.dialog",window,$._.debounce(function(){self.refresh()},150));self.ready=!0}
if(!self.contentReady)
{if(callback)callback.apply(self);options.afterShow.apply(self)}
self.refElement.detach();self.element.removeClass('resizing');self.contentReady=!0;self.element.css({width:'auto',height:'auto'});self.removePlugin("binder");var selectors=options.selectors,bindings=options.bindings;if(selectors&&bindings){var binder=$.Controller($.uid("dialogBinder"),{defaultOptions:selectors},function(self){return bindings});self.addPlugin("binder",binder)}
if(self.displayQueue.length>0)
{setTimeout(function(){self.resizing=!1;self.display(self.displayQueue.shift())},500)}else{self.resizing=!1;$(window).trigger("dialogTransitionEnd")}}])},"{self} removePlugin":function(el,event,name,plugin){if(plugin===undefined)return;delete $.Controller[plugin.Class.fullName]},hide:function(callback)
{if(!self.contentReady)
self.options.beforeHide.apply(self);$(window).trigger("dialogTransitionStart");self.transition[self.options.transition.hide].hide.apply(self,[function()
{if(callback)callback.apply(self);self.options.afterHide.apply(self);$(window).trigger("dialogTransitionEnd")}])},refresh:function()
{if(self.closing)return;if(self.resizing)return;self.finalizeSize(!0);self.resizing=!0;self.refreshing=!0;$(window).trigger("dialogTransitionStart");self.transition[self.options.transition.show].show.apply(self,[function()
{$(window).trigger("dialogTransitionEnd");self.resizing=!1;self.refreshing=!1;self.element.css({width:'auto',height:'auto'})}])},transition:{none:{show:function(callback)
{if(!self.ready)
self.overlay.show();self.element.finalizeContent().show(0,callback)},hide:function(callback)
{self.overlay.hide();self.element.hide(0,callback)}},fade:{show:function(callback)
{if(!self.ready)
self.overlay.fadeOut(0).fadeIn('normal');if(!self.contentReady)
{self.element.fadeOut((!self.contentReady)?0:'fast',function()
{self.element.finalizeContent().fadeIn('normal','easeInCubic',callback)})}else{self.element.finalizeContent();return callback&&callback()}},hide:function(callback)
{self.overlay.fadeOut('normal','easeOutCubic');self.element.fadeOut('normal','easeOutCubic',callback)}},zoom:{show:function(callback)
{var dialogBody=self.dialogBody,dialogFooter=self.dialogFooter,css=self.options.css;if(!self.ready)
{self.overlay.fadeIn('fast');self.element.finalizeContent().css({top:parseInt(css.top)+(parseInt(css.height)/2),left:parseInt(css.left)+(parseInt(css.width)/2),width:0,height:0})}
if(!self.contentReady)
{dialogBody.css({opacity:0});dialogFooter.css({opacity:0})}
self.element.animate({top:css.top,left:css.left,width:css.width,height:css.height},'normal','easeInCubic',function()
{self.element.finalizeContent(!0);dialogBody.css({opacity:1});dialogFooter.css({opacity:1});return callback&&callback()})},hide:function(callback)
{var css=self.options.css;self.element.animate({top:parseInt(css.top)+(parseInt(css.height)/2),left:parseInt(css.left)+(parseInt(css.width)/2),width:0,height:0},'normal','easeOutCubic',function()
{self.overlay.fadeOut('fast');return callback&&callback()})}}},overlay:$('<div></div>'),createOverlay:function()
{self.overlay.css(self.options.overlay.css).click(function()
{self.close()}).appendTo('body')},closing:!1,close:function()
{if(self.closing)return;self.closing=!0;$(document).off("keydown.foundry.dialog");self.hide(function()
{self.removePlugin("binder");self.element.remove();self.refElement&&self.refElement.remove()});return self},"{closeButton} click":function()
{self.close()},content:function()
{var dialogContent=self.dialogContent;var iframe=dialogContent.find("> iframe");return(iframe.length>0)?iframe.contents():dialogContent},messageGroup:function(){var dialogBody=self.dialogBody,messageGroup=dialogBody.find("> [data-message-group]");if(messageGroup.length<1){messageGroup=$("<div data-message-group></div>").prependTo(dialogBody)}
return messageGroup}}});$.dialog=function(options){if(window.parentDialog){return window.parentDialog.update(options)}
var dialog=$('.foundryDialog.global'),controller=dialog.controllers("dialog")[0];if(arguments.length<1&&controller){return controller}
if(dialog.length<1){dialog=$($.View('dialog/default')).addClass('global').addClass(options.customClass).appendTo('body')}
if(typeof options==="string"||$.isDeferred(options)){var afterShow=arguments[1];options={content:options,afterShow:($.isFunction(afterShow))?afterShow:$.noop}}
if(controller){controller.update(options)}else{controller=dialog.addController('Dialog',options)}
return controller}};exports();module.resolveWith(exports)})};FD40.module("dialog",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){jQuery.easing.jswing=jQuery.easing.swing;jQuery.extend(jQuery.easing,{def:'easeOutQuad',swing:function(x,t,b,c,d){return jQuery.easing[jQuery.easing.def](x,t,b,c,d)},easeInQuad:function(x,t,b,c,d){return c*(t/=d)*t+b},easeOutQuad:function(x,t,b,c,d){return-c*(t/=d)*(t-2)+b},easeInOutQuad:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t+b;return-c/2*((--t)*(t-2)-1)+b},easeInCubic:function(x,t,b,c,d){return c*(t/=d)*t*t+b},easeOutCubic:function(x,t,b,c,d){return c*((t=t/d-1)*t*t+1)+b},easeInOutCubic:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t+b;return c/2*((t-=2)*t*t+2)+b},easeInQuart:function(x,t,b,c,d){return c*(t/=d)*t*t*t+b},easeOutQuart:function(x,t,b,c,d){return-c*((t=t/d-1)*t*t*t-1)+b},easeInOutQuart:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t+b;return-c/2*((t-=2)*t*t*t-2)+b},easeInQuint:function(x,t,b,c,d){return c*(t/=d)*t*t*t*t+b},easeOutQuint:function(x,t,b,c,d){return c*((t=t/d-1)*t*t*t*t+1)+b},easeInOutQuint:function(x,t,b,c,d){if((t/=d/2)<1)return c/2*t*t*t*t*t+b;return c/2*((t-=2)*t*t*t*t+2)+b},easeInSine:function(x,t,b,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+b},easeOutSine:function(x,t,b,c,d){return c*Math.sin(t/d*(Math.PI/2))+b},easeInOutSine:function(x,t,b,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+b},easeInExpo:function(x,t,b,c,d){return(t==0)?b:c*Math.pow(2,10*(t/d-1))+b},easeOutExpo:function(x,t,b,c,d){return(t==d)?b+c:c*(-Math.pow(2,-10*t/d)+1)+b},easeInOutExpo:function(x,t,b,c,d){if(t==0)return b;if(t==d)return b+c;if((t/=d/2)<1)return c/2*Math.pow(2,10*(t-1))+b;return c/2*(-Math.pow(2,-10*--t)+2)+b},easeInCirc:function(x,t,b,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+b},easeOutCirc:function(x,t,b,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+b},easeInOutCirc:function(x,t,b,c,d){if((t/=d/2)<1)return-c/2*(Math.sqrt(1-t*t)-1)+b;return c/2*(Math.sqrt(1-(t-=2)*t)+1)+b},easeInElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}
else var s=p/(2*Math.PI)*Math.asin(c/a);return-(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b},easeOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d)==1)return b+c;if(!p)p=d*.3;if(a<Math.abs(c)){a=c;var s=p/4}
else var s=p/(2*Math.PI)*Math.asin(c/a);return a*Math.pow(2,-10*t)*Math.sin((t*d-s)*(2*Math.PI)/p)+c+b},easeInOutElastic:function(x,t,b,c,d){var s=1.70158;var p=0;var a=c;if(t==0)return b;if((t/=d/2)==2)return b+c;if(!p)p=d*(.3*1.5);if(a<Math.abs(c)){a=c;var s=p/4}
else var s=p/(2*Math.PI)*Math.asin(c/a);if(t<1)return-.5*(a*Math.pow(2,10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p))+b;return a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-s)*(2*Math.PI)/p)*.5+c+b},easeInBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*(t/=d)*t*((s+1)*t-s)+b},easeOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;return c*((t=t/d-1)*t*((s+1)*t+s)+1)+b},easeInOutBack:function(x,t,b,c,d,s){if(s==undefined)s=1.70158;if((t/=d/2)<1)return c/2*(t*t*(((s*=(1.525))+1)*t-s))+b;return c/2*((t-=2)*t*(((s*=(1.525))+1)*t+s)+2)+b},easeInBounce:function(x,t,b,c,d){return c-jQuery.easing.easeOutBounce(x,d-t,0,c,d)+b},easeOutBounce:function(x,t,b,c,d){if((t/=d)<(1/2.75)){return c*(7.5625*t*t)+b}else if(t<(2/2.75)){return c*(7.5625*(t-=(1.5/2.75))*t+.75)+b}else if(t<(2.5/2.75)){return c*(7.5625*(t-=(2.25/2.75))*t+.9375)+b}else{return c*(7.5625*(t-=(2.625/2.75))*t+.984375)+b}},easeInOutBounce:function(x,t,b,c,d){if(t<d/2)return jQuery.easing.easeInBounce(x,t*2,0,c,d)*.5+b;return jQuery.easing.easeOutBounce(x,t*2-d,0,c,d)*.5+c*.5+b}})};exports();module.resolveWith(exports)};FD40.module("easing",moduleFactory)}());(function(){var moduleFactory=function($){var module=this;var jQuery=$;var exports=function(){(function($){$.gritter={};$.gritter.options={position:'',class_name:'',fade_in_speed:'medium',fade_out_speed:1000,time:6000}
$.gritter.add=function(params){try{return Gritter.add(params||{})}catch(e){var err='Gritter Error: '+e;(typeof(console)!='undefined'&&console.error)?console.error(err,params):alert(err)}}
$.gritter.remove=function(id,params){Gritter.removeSpecific(id,params||{})}
$.gritter.removeAll=function(params){Gritter.stop(params||{})}
var Gritter={position:'',fade_in_speed:'',fade_out_speed:'',time:'',_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<a class="gritter-close" href="#" tabindex="1">Close Notification</a>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none" role="alert"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(params){if(typeof(params)=='string'){params={text:params}}
if(params.text===null){throw 'You must supply "text" parameter.'}
if(!this._is_setup){this._runSetup()}
var title=params.title,text=params.text,image=params.image||'',sticky=params.sticky||!1,item_class=params.class_name||$.gritter.options.class_name,position=$.gritter.options.position,time_alive=params.time||'';this._verifyWrapper();this._item_count++;var number=this._item_count,tmp=this._tpl_item;$(['before_open','after_open','before_close','after_close']).each(function(i,val){Gritter['_'+val+'_'+number]=($.isFunction(params[val]))?params[val]:function(){}});this._custom_timer=0;if(time_alive){this._custom_timer=time_alive}
var image_str=(image!='')?'<img src="'+image+'" class="gritter-image" />':'',class_name=(image!='')?'gritter-with-image':'gritter-without-image';if(title){title=this._str_replace('[[title]]',title,this._tpl_title)}else{title=''}
tmp=this._str_replace(['[[title]]','[[text]]','[[close]]','[[image]]','[[number]]','[[class_name]]','[[item_class]]'],[title,text,this._tpl_close,image_str,this._item_count,class_name,item_class],tmp);if(this['_before_open_'+number]()===!1){return!1}
$('#gritter-notice-wrapper').addClass(position).append(tmp);var item=$('#gritter-item-'+this._item_count);item.fadeIn(this.fade_in_speed,function(){Gritter['_after_open_'+number]($(this))});if(!sticky){this._setFadeTimer(item,number)}
$(item).bind('mouseenter mouseleave',function(event){if(event.type=='mouseenter'){if(!sticky){Gritter._restoreItemIfFading($(this),number)}}
else{if(!sticky){Gritter._setFadeTimer($(this),number)}}
Gritter._hoverState($(this),event.type)});$(item).find('.gritter-close').click(function(){Gritter.removeSpecific(number,{},null,!0);return!1});return number},_countRemoveWrapper:function(unique_id,e,manual_close){e.remove();this['_after_close_'+unique_id](e,manual_close);if($('.gritter-item-wrapper').length==0){$('#gritter-notice-wrapper').remove()}},_fade:function(e,unique_id,params,unbind_events){var params=params||{},fade=(typeof(params.fade)!='undefined')?params.fade:!0,fade_out_speed=params.speed||this.fade_out_speed,manual_close=unbind_events;this['_before_close_'+unique_id](e,manual_close);if(unbind_events){e.unbind('mouseenter mouseleave')}
if(fade){e.animate({opacity:0},fade_out_speed,function(){e.animate({height:0},300,function(){Gritter._countRemoveWrapper(unique_id,e,manual_close)})})}
else{this._countRemoveWrapper(unique_id,e)}},_hoverState:function(e,type){if(type=='mouseenter'){e.addClass('hover');e.find('.gritter-close').show()}
else{e.removeClass('hover');e.find('.gritter-close').hide()}},removeSpecific:function(unique_id,params,e,unbind_events){if(!e){var e=$('#gritter-item-'+unique_id)}
this._fade(e,unique_id,params||{},unbind_events)},_restoreItemIfFading:function(e,unique_id){clearTimeout(this['_int_id_'+unique_id]);e.stop().css({opacity:'',height:''})},_runSetup:function(){for(opt in $.gritter.options){this[opt]=$.gritter.options[opt]}
this._is_setup=1},_setFadeTimer:function(e,unique_id){var timer_str=(this._custom_timer)?this._custom_timer:this.time;this['_int_id_'+unique_id]=setTimeout(function(){Gritter._fade(e,unique_id)},timer_str)},stop:function(params){var before_close=($.isFunction(params.before_close))?params.before_close:function(){};var after_close=($.isFunction(params.after_close))?params.after_close:function(){};var wrap=$('#gritter-notice-wrapper');before_close(wrap);wrap.fadeOut(function(){$(this).remove();after_close()})},_str_replace:function(search,replace,subject,count){var i=0,j=0,temp='',repl='',sl=0,fl=0,f=[].concat(search),r=[].concat(replace),s=subject,ra=r instanceof Array,sa=s instanceof Array;s=[].concat(s);if(count){this.window[count]=0}
for(i=0,sl=s.length;i<sl;i++){if(s[i]===''){continue}
for(j=0,fl=f.length;j<fl;j++){temp=s[i]+'';repl=ra?(r[j]!==undefined?r[j]:''):r[0];s[i]=(temp).split(f[j]).join(repl);if(count&&s[i]!==temp){this.window[count]+=(temp.length-s[i].length)/f[j].length}}}
return sa?s:s[0]},_verifyWrapper:function(){if($("body > [id=fd].gritter").length<1){$(document.createElement("div")).attr("id","fd").addClass("gritter").css({position:"absolute",top:0,left:0,overflow:"visible",width:0,height:0,zIndex:10003}).appendTo("body")}
if($('#gritter-notice-wrapper').length==0){$("[id=fd].gritter").append(this._tpl_wrap)}}}})(jQuery)};exports();module.resolveWith(exports)};FD40.module("gritter",moduleFactory)}())});FD40.installer("EasySocial","definitions",function($){$.module(["easysocial/admin","easysocial/admin/sidebar/sidebar","easysocial/admin/access/discover","easysocial/progress/progress","easysocial/admin/alerts/discover","easysocial/admin/badges/discover","easysocial/admin/events/users","easysocial/admin/grid/grid","easysocial/admin/grid/sort","easysocial/admin/grid/publishing","easysocial/admin/grid/ordering","easysocial/admin/groups/groups","easysocial/admin/groups/users","easysocial/admin/indexer/indexer","easysocial/admin/mailer/mailer","easysocial/admin/maintenance/database","easysocial/admin/maintenance/maintenance","easysocial/admin/migrators/migrator","easysocial/admin/points/discover","easysocial/admin/privacy/discover","easysocial/admin/profiles/avatar","easysocial/uploader/uploader","easysocial/uploader/queue","easysocial/admin/profiles/fields","easysocial/field","easysocial/admin/profiles/members","easysocial/admin/profiles/profile","easysocial/utilities/alias","easysocial/admin/profiles/profiles","easysocial/admin/regions/form","easysocial/admin/regions/init","easysocial/admin/reports/reporters","easysocial/admin/reports/reports","easysocial/admin/themes/compiler","easysocial/admin/users/form","easysocial/admin/users/privacy","easysocial/admin/users/users","easysocial/admin/widgets/news","easysocial/albums/album","easysocial/albums/browser","easysocial/albums/editor","easysocial/albums/editor/sortable","easysocial/albums/editor/uploader","easysocial/albums/uploader","easysocial/albums/uploader.item","easysocial/albums/item","easysocial/apps/event/discussions","easysocial/apps/event/guests","easysocial/apps/event/tasks","easysocial/apps/fields/event/permalink/content","easysocial/apps/fields/event/permalink/sample_content","easysocial/apps/fields/event/recurring/content","easysocial/apps/fields/event/startend/content","easysocial/apps/fields/event/startend/display","easysocial/apps/fields/group/permalink/content","easysocial/apps/fields/group/permalink/sample_content","easysocial/apps/fields/user/address/content","easysocial/apps/fields/user/address/display_content","easysocial/apps/fields/user/address/maps","easysocial/apps/fields/user/avatar/content","easysocial/apps/fields/user/avatar/sample_content","easysocial/apps/fields/user/checkbox/content","easysocial/apps/fields/user/checkbox/sample_content","easysocial/apps/fields/user/country/content","easysocial/apps/fields/user/country/sample_content","easysocial/apps/fields/user/cover/content","easysocial/apps/fields/user/currency/sample_content","easysocial/apps/fields/user/datetime/content","easysocial/apps/fields/user/datetime/display_content","easysocial/apps/fields/user/datetime/dropdown","easysocial/apps/fields/user/datetime/sample_content","easysocial/apps/fields/user/dropdown/content","easysocial/apps/fields/user/email/content","easysocial/apps/fields/user/file/content","easysocial/apps/fields/user/file/sample_content","easysocial/apps/fields/user/gender/content","easysocial/apps/fields/user/joomla_email/content","easysocial/apps/fields/user/joomla_email/registermini_content","easysocial/apps/fields/user/joomla_email/sample_content","easysocial/apps/fields/user/joomla_fullname/content","easysocial/apps/fields/user/joomla_fullname/sample_content","easysocial/apps/fields/user/joomla_password/content","easysocial/apps/fields/user/joomla_password/registermini_content","easysocial/apps/fields/user/joomla_password/sample_content","easysocial/apps/fields/user/joomla_timezone/content","easysocial/apps/fields/user/joomla_username/content","easysocial/apps/fields/user/joomla_username/registermini_content","easysocial/apps/fields/user/joomla_username/sample_content","easysocial/apps/fields/user/multidropdown/content","easysocial/apps/fields/user/multilist/content","easysocial/apps/fields/user/multitextbox/content","easysocial/apps/fields/user/permalink/content","easysocial/apps/fields/user/permalink/sample_content","easysocial/apps/fields/user/relationship/content","easysocial/site/friends/suggest","easysocial/apps/fields/user/separator/sample","easysocial/apps/fields/user/terms/content","easysocial/apps/fields/user/textarea/content","easysocial/apps/fields/user/textbox/content","easysocial/apps/fields/user/textbox/sample_content","easysocial/apps/fields/user/url/content","easysocial/apps/fields/user/url/sample_content","easysocial/apps/group/feeds","easysocial/apps/group/tasks","easysocial/avatar","easysocial/cover","easysocial/easysocial","easysocial/site/likes/likes","easysocial/site/reports/reports","easysocial/site/blocks/blocks","easysocial/site/repost/repost","easysocial/site/share/share","easysocial/site/layout/dialog","easysocial/site/layout/responsive","easysocial/site/layout/elements","easysocial/site/photos/photos","easysocial/site/photos/popup","easysocial/site/photos/dialog","easysocial/site/photos/avatar","easysocial/site/users/login","easysocial/site/dashboard/dashboard.guest.login","easysocial/validate","easysocial/site/profile/popbox","easysocial/site/conversations/composer","easysocial/site/privacy/privacy","easysocial/site/locations/popbox","easysocial/site/sidebar/sidebar","easysocial/site/friends/api","easysocial/site/popbox/popbox","easysocial/site/conversations/api","easysocial/site/followers/api","easysocial/site/stream/video","easysocial/oauth/facebook","easysocial/locations","easysocial/pagination","easysocial/photos/avatar","easysocial/photos/browser","easysocial/photos/editor","easysocial/photos/item","easysocial/photos/tags","easysocial/photos/tagger","easysocial/photos/navigation","easysocial/prism","easysocial/privacy","easysocial/sharing","easysocial/site/activities/activities","easysocial/site/activities/sidebar","easysocial/site/activities/sidebar.item","easysocial/site/activities/apps","easysocial/site/activities/item","easysocial/site/activities/list","easysocial/site/albums/all","easysocial/site/apps/apps","easysocial/site/badges/badge","easysocial/site/comments/control","easysocial/site/comments/frame","easysocial/site/comments/item","easysocial/site/conversations/conversations","easysocial/site/conversations/mailbox","easysocial/site/conversations/item","easysocial/site/conversations/filter","easysocial/site/conversations/read","easysocial/site/dashboard/apps","easysocial/site/dashboard/dashboard","easysocial/site/dashboard/feeds","easysocial/site/dashboard/sidebar","easysocial/site/stream/filter","easysocial/site/stream/sidebar","easysocial/site/dashboard/groups","easysocial/site/dashboard/events","easysocial/site/events/browser","easysocial/site/events/guestState","easysocial/site/events/create","easysocial/site/events/edit","easysocial/site/events/item","easysocial/site/explorer","easysocial/site/explorer/uploader","easysocial/site/explorer/popup","easysocial/site/followers/followers","easysocial/site/friends/friends","easysocial/site/friends/list","easysocial/site/friends/item","easysocial/site/groups/groups","easysocial/site/groups/item","easysocial/site/notifications/list","easysocial/site/points/history","easysocial/site/profile/about","easysocial/site/profile/edit","easysocial/site/profile/friends","easysocial/site/profile/header","easysocial/site/profile/subscriptions","easysocial/site/profile/miniheader","easysocial/site/profile/notifications","easysocial/site/profile/privacy","easysocial/site/profile/profile","easysocial/site/registrations/registrations","easysocial/site/search/advanced.criteria","easysocial/site/search/map","easysocial/site/search/advanced","easysocial/site/search/advanced.list","easysocial/site/search/item","easysocial/site/search/dating","easysocial/site/search/list","easysocial/site/search/search","easysocial/site/search/sidebar","easysocial/site/search/toolbar","easysocial/site/stream/item","easysocial/site/stream/stream","easysocial/site/subscriptions/follow","easysocial/site/system/broadcast","easysocial/site/toolbar/conversations","easysocial/site/toolbar/friends","easysocial/site/toolbar/login","easysocial/site/toolbar/notifications","easysocial/site/toolbar/story","easysocial/site/toolbar/system","easysocial/site/toolbar/profile","easysocial/site/users/popbox","easysocial/site/users/users","easysocial/story","easysocial/story/broadcast","easysocial/story/event","easysocial/story/files","easysocial/story/friends","easysocial/story/links","easysocial/story/locations","easysocial/story/mood","easysocial/story/photos","easysocial/story/tasks","easysocial/stream","easysocial/comment","easysocial/tab","easysocial/toggle","easysocial/uploader/item"]);$.require.template.loader(["easysocial/site/loading/small","easysocial/site/uploader/queue.item","easysocial/admin/profiles/form.fields.editorItem","easysocial/admin/profiles/form.fields.stepItem","easysocial/admin/profiles/form.fields.editorPage","easysocial/admin/profiles/form.fields.config","easysocial/admin/profiles/dialog.move.field","easysocial/admin/profiles/dialog.delete.profileavatar","easysocial/site/albums/browser.list.item","easysocial/site/albums/upload.item","easysocial/fields/user/checkbox/item","easysocial/site/friends/suggest.item","easysocial/site/friends/suggest.hint.search","easysocial/site/friends/suggest.hint.empty","easysocial/site/hashtags/suggest.item","easysocial/site/hashtags/suggest.hint.search","easysocial/site/hashtags/suggest.hint.empty","easysocial/site/dialog/default","easysocial/site/photos/popup","easysocial/site/location/story.suggestion","easysocial/site/photos/tags.item","easysocial/site/photos/tags.menu.item","easysocial/admin/profiles/form.privacy.custom.item","easysocial/site/activities/loadbutton","easysocial/site/explorer/popup","easysocial/site/friends/default.empty","easysocial/site/friends/list.assign","easysocial/site/registration/dialog.error","easysocial/site/advancedsearch/noresult","easysocial/site/search/loadbutton","easysocial/site/stream/loadbutton","easysocial/site/notifications/system.empty","easysocial/site/users/button.following","easysocial/apps/user/links/story/attachment.item","easysocial/apps/user/files/story/attachment.item","easysocial/apps/user/files/story/progress","easysocial/apps/group/tasks/story/attachment.item","easysocial/site/likes/item","easysocial/site/uploader/preview"]);$.require.language.loader(["COM_EASYSOCIAL_SCAN_COMPLETED","JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST","COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING","COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED","COM_EASYSOCIAL_INDEXER_REINDEX_RESTART","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_PAGE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_FIELD","COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS","COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES","COM_EASYSOCIAL_FIELDS_INVALID_VALUES","COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_ASSIGN_BUTTON","COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR","COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE","COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE","COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE","FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH","FIELDS_EVENT_PERMALINK_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED","FIELDS_USER_DATETIME_LOCAL_TIMEZONE","FIELDS_USER_DATETIME_TIMEZONE_CHECKING","PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_GROUP_PERMALINK_REQUIRED","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS1","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS2","PLG_FIELDS_ADDRESS_PLEASE_ENTER_CITY","PLG_FIELDS_ADDRESS_PLEASE_ENTER_STATE","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ZIP","PLG_FIELDS_ADDRESS_PLEASE_ENTER_COUNTRY","COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT","PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE","PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM","PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED","PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR","PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR","PLG_FIELDS_COVER_VALIDATION_REQUIRED","PLG_FIELDS_DATETIME_VALIDATION_INVALID_DATETIME_FORMAT","PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME","PLG_FIELDS_DATETIME_DAY","PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE","PLG_FIELDS_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT","PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED","COM_EASYSOCIAL_WORKING","PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING","PLG_FIELDS_JOOMLA_EMAIL_CHECKING","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT","PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT","PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG","PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE","PLG_FIELDS_JOOMLA_USERNAME_CHECKING","PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME","PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD","PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE","PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD","PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_PERMALINK_REQUIRED","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT","PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM","PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE","PLG_FIELDS_TERMS_VALIDATION_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT","PLG_FIELDS_URL_VALIDATION_EMPTY_URL","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_PUBLIC","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_MEMBER","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIENDS_OF_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_ONLY_ME","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_CUSTOM","COM_EASYSOCIAL_AT_LOCATION","COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_LOG_LOAD_PREVIOUS_STREAM_ITEMS","COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_LOADING","COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_DELETING","COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR","COM_EASYSOCIAL_LIKES_LIKE","COM_EASYSOCIAL_LIKES_UNLIKE","COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL","COM_EASYSOCIAL_COMMENTS_STATUS_SAVING","COM_EASYSOCIAL_COMMENTS_STATUS_SAVED","COM_EASYSOCIAL_NO_BUTTON","COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY","COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY","COM_EASYSOCIAL_EVENTS_GUEST_PENDING","COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION","COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME","COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL","COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE","COM_EASYSOCIAL_FRIENDS_CANCEL_REQUEST_DIALOG_CANCELLED","COM_EASYSOCIAL_FRIENDS_DIALOG_CANCEL_REQUEST","COM_EASYSOCIAL_YES_CANCEL_MY_REQUEST_BUTTON","COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE","COM_EASYSOCIAL_ADVANCED_SEARCH_ADDRESS_DISTANCE_NOTICE","COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE","COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS","COM_EASYSOCIAL_SUBSCRIPTION_INFO","COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED","COM_EASYSOCIAL_STREAM_META_JOINER","COM_EASYSOCIAL_STORY_SUBMIT_ERROR","COM_EASYSOCIAL_STORY_CONTENT_EMPTY","COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER","COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA","COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME","COM_EASYSOCIAL_STREAM_STORY_WITH","COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER","COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER","COM_EASYSOCIAL_AND","COM_EASYSOCIAL_MOOD_FEELING_CUSTOM","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBSCRIBE","COM_EASYSOCIAL_STREAM_DIALOG_FEED","COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"]);(function(){var stylesheetNames=["easysocial/imgareaselect/default"];var state=($.stylesheet({"content":""}))?"resolve":"reject";$.each(stylesheetNames,function(i,stylesheet){$.require.stylesheet.loader(stylesheet)[state]()})})()});FD40.installer("EasySocial","scripts",function($){EasySocial.module("admin",function($){var module=this;EasySocial.require().library("uniform","chosen","flot").script("admin/sidebar/sidebar").done(function($){$(".uniform, .check :checkbox, .radio :radio, input:file[data-uniform], .usergroups :checkbox").uniform();$('[data-chosen]').chosen({disable_search:!0});$('[data-chosen-search]').chosen({disable_search:!1});$('[data-sidebar]').implement(EasySocial.Controller.Sidebar.Sidebar);$('[data-sidebar-menu-toggle]').on('click',function()
{var parent=$(this).parent('li'),child=parent.find('ul'),isActive=$(this).parent('li').hasClass('active');if(isActive)
{parent.removeClass('active');child.removeClass('in')}
else{parent.addClass('active');child.addClass('in')}});module.resolve()})});EasySocial.module('admin/sidebar/sidebar',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Sidebar.Sidebar',{defaultOptions:{intervalPendingUsers:5000,"{versionNotice}":"[data-easysocial-version]","{usersBadge}":".menu-user > a .badge","{pendingUsersBadge}":".menu-user .menu-ies-vcard > .badge",}},function(self)
{return{init:function()
{self.versionChecks();self.checkPendingUsers()},versionChecks:function()
{EasySocial.ajax('admin/controllers/easysocial/versionChecks').done(function(contents,outdated,local,latest)
{if(outdated)
{$('[data-es-version-header]').removeClass('latest').addClass('outdated');$('[data-es-version-header]').find('[data-es-outdated]').data('local-version',local).data('online-version',latest)}
self.versionNotice().html(contents).show()})},monitorPendingUsers:function()
{if(EasySocial.debug)
{var seconds=self.options.intervalVersionChecks/100;console.info('Start monitoring pending users with interval of '+self.options.intervalPendingUsers+' seconds.')}
self.options.state=setTimeout(self.checkPendingUsers,self.options.intervalPendingUsers)},checkPendingUsers:function()
{self.stopMonitorPendingUsers();setTimeout(function(){EasySocial.ajax('admin/controllers/users/getTotalPending').done(function(total)
{if(total>0)
{self.usersBadge().html(total);self.pendingUsersBadge().html(total)}
else{self.usersBadge().html('')}
self.monitorPendingUsers()})},self.options.intervalPendingUsers)},stopMonitorPendingUsers:function()
{if(EasySocial.debug)
{}
clearTimeout(self.options.state)},}});module.resolve()})});EasySocial.module('admin/access/discover',function($){var module=this;EasySocial.require().script('progress/progress').language('COM_EASYSOCIAL_SCAN_COMPLETED').done(function($){EasySocial.Controller('Access.Discover',{defaultOptions:{files:[],progressController:null,'{startButton}':'[data-access-discovery-start]','{progressBar}':'.discoverProgress','{results}':'[data-access-discovery-result]'}},function(self){return{init:function(){self.options.progressController=self.progressBar().addController(EasySocial.Controller.Progress)},reset:function(){self.results().html('');self.options.progressController.reset()},addLog:function(msg){$('<tr></tr>').append($('<td></td>').html(msg)).appendTo(self.results())},'{startButton} click':function(element){self.reset();self.startButton().attr('disabled','disabled');EasySocial.ajax('admin/controllers/access/scanFiles').done(function(files,message){self.reset();self.options.files=files;if(self.options.files.length>0){self.options.progressController.begin(self.options.files.length);self.addLog(message);self.startIterating()}else{self.options.progressController.begin(1);self.options.progressController.completed('Discover Completed');self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})},startIterating:function(){var file=self.options.files.shift();EasySocial.ajax('admin/controllers/access/installFile',{"file":file}).always(function(message){if(self.options.files.length>0){self.options.progressController.touch('...');self.addLog(message);self.startIterating()}else{self.options.progressController.touch('...');self.addLog(message);self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})}}});module.resolve()})});EasySocial.module('progress/progress',function($){var module=this;EasySocial.Controller('Progress',{defaultOptions:{current:0,eachWidth:null,total:null,progressClass:"progress progress-info progress-striped","{progressBar}":".bar","{progressResult}":".progress-result",view:{}}},function(self){return{init:function()
{},reset:function()
{self.options.current=0;self.eachWidth=null;self.total=null;self.progressBar().css('width','0%').html('')},begin:function(total)
{self.options.total=total;self.options.eachWidth=100/total;if(total>0)
{self.element.addClass(self.options.progressClass).show()}},touch:function(message)
{self.options.current+=self.options.eachWidth;if(self.options.current>100)
{self.options.current=100}
self.progressBar().css('width',self.options.current+'%');self.progressResult().html(Math.round(self.options.current)+'%')},completed:function(message)
{self.options.current=100;self.progressBar().css('width',self.options.current+'%');self.progressResult().html(Math.round(self.options.current)+'%')}}});module.resolve()});EasySocial.module('admin/alerts/discover',function($){var module=this;EasySocial.require().script('progress/progress').language('COM_EASYSOCIAL_SCAN_COMPLETED').done(function($){EasySocial.Controller('Alerts.Discover',{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-alerts-discovery-start]","{progressBar}":"[data-alerts-discovery-progress]","{results}":"[data-alerts-discovery-result]"}},function(self){return{init:function()
{self.initProgressBar()},reset:function()
{self.results().html('');self.options.progressController.reset()},initProgressBar:function()
{self.progressBar().implement(EasySocial.Controller.Progress);self.options.progressController=self.progressBar().controller()},addLog:function(message)
{$('<tr>').append($('<td>').html(message)).appendTo(self.results())},startIterating:function()
{var file=self.options.files.shift();EasySocial.ajax('admin/controllers/alerts/scan',{"file":file}).always(function(data,message,completeMessage){if(self.options.files.length>0)
{self.options.progressController.touch('...');self.addLog(message);self.startIterating()}
else{self.options.progressController.touch('...');self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})},"{startButton} click":function(element)
{self.reset();self.startButton().attr('disabled','disabled');EasySocial.ajax('admin/controllers/alerts/discoverFiles',{}).done(function(files,message)
{self.reset();self.options.files=files;if(self.options.files.length>0)
{self.options.progressController.begin(self.options.files.length);self.addLog(message);self.startIterating()}})}}});module.resolve()})});EasySocial.module('admin/badges/discover',function($){var module=this;EasySocial.require().script('progress/progress').language('COM_EASYSOCIAL_SCAN_COMPLETED').done(function($){EasySocial.Controller('Badges.Discover',{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-badgesDiscover-start]","{progressBar}":"[data-badgesDiscover-progress]","{results}":"[data-badgesDiscover-result]","{viewLog}":"[data-badgesDiscover-viewLog]"}},function(self){return{init:function()
{self.initProgressBar();self.initLogging()},reset:function()
{self.results().html('');self.initLogging();self.options.progressController.reset()},initLogging:function()
{self.viewLog().hide()},initProgressBar:function()
{self.progressBar().implement(EasySocial.Controller.Progress);self.options.progressController=self.progressBar().controller()},addLog:function(message)
{$('<tr>').append($('<td>').html(message)).appendTo(self.results())},startIterating:function()
{var file=self.options.files.shift();EasySocial.ajax('admin/controllers/badges/scan',{"file":file}).always(function(data,message)
{if(self.options.files.length>0)
{self.options.progressController.touch('...');self.addLog(message);self.startIterating()}
else{self.options.progressController.touch('...');self.addLog(message);self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.viewLog().show();self.startButton().removeAttr('disabled')}})},"{startButton} click":function(element)
{self.reset();self.startButton().attr('disabled','disabled');EasySocial.ajax('admin/controllers/badges/discoverFiles',{}).done(function(files,message)
{self.options.files=files;if(self.options.files.length>0)
{self.options.progressController.begin(self.options.files.length);self.addLog(message);self.startIterating()}
else{self.options.progressController.begin(1);self.options.progressController.completed('Discover Completed');self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})},"{viewLog} click":function()
{self.results().toggle()}}});module.resolve()})});EasySocial.module('admin/events/users',function($){var module=this;EasySocial.require().language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST').done(function($){EasySocial.Controller('Events.Users',{defaultOptions:{eventid:null,'{inviteGuest}':'[data-event-invite-guest]','{removeGuest}':'[data-event-remove-guest]','{approveGuest}':'[data-event-approve-guest]','{promoteGuest}':'[data-event-promote-guest]','{demoteGuest}':'[data-event-demote-guest]'}},function(self){return{init:function(){},'{inviteGuest} click':function(el,ev){var guests={};window.inviteGuests=function(guest){if(guest.state){guests[guest.id]=guest}else{delete guests[guest.id]}};var confirmInviteGuests=function(){EasySocial.dialog({content:EasySocial.ajax('admin/views/events/confirmInviteGuests',{guests:guests,eventid:self.options.eventid}),bindings:{'{submitButton} click':function(){this.inviteGuestsForm().submit()}}})};EasySocial.dialog({content:EasySocial.ajax('admin/views/events/inviteGuests'),bindings:{'{submitButton} click':function(){confirmInviteGuests()}}})},'{removeGuest} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['removeGuests'])}},'{approveGuest} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['approveGuests'])}},'{promoteGuest} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['promoteGuests'])}},'{demoteGuest} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['demoteGuests'])}}}});module.resolve()})});EasySocial.module('admin/grid/grid',function($){var module=this;EasySocial.require().script('admin/grid/sort','admin/grid/publishing').done(function($)
{EasySocial.Controller('Grid',{defaultOptions:{"{sortColumns}":"[data-table-grid-sort]","{ordering}":"[data-table-grid-ordering]","{direction}":"[data-table-grid-direction]","{task}":"[data-table-grid-task]","{searchInput}":"[data-table-grid-search-input]","{search}":"[data-table-grid-search]","{resetSearch}":"[data-table-grid-search-reset]","{checkAll}":"[data-table-grid-checkall]","{checkboxes}":"[data-table-grid-id]","{publishItems}":"[data-table-grid-publishing]","{itemRow}":"tr","{boxChecked}":"[data-table-grid-box-checked]","{filters}":"[data-table-grid-filter]"}},function(self)
{return{init:function()
{self.implementSortable();self.implementPublishing()},"{filters} change":function()
{self.setTask('');self.submitForm()},"{search} click":function()
{self.submitForm()},"{resetSearch} click":function()
{self.searchInput().val('');self.submitForm()},submitForm:function()
{self.element.submit()},setTask:function(task)
{self.task().val(task)},setOrdering:function(ordering)
{self.ordering().val(ordering)},setDirection:function(direction)
{self.direction().val(direction)},setTotalChecked:function(total)
{self.boxChecked().val(total)},toggleSelectRow:function(row)
{var checkbox=row.find('input[name=cid\\[\\]]');if($(checkbox).prop('checked')==!0)
{$(checkbox).prop('checked',!1)}
else{$(checkbox).prop('checked',!0)}},selectRow:function(row)
{var checkbox=row.find('input[name=cid\\[\\]]');$(checkbox).prop('checked',!0)},implementSortable:function()
{self.sortColumns().implement(EasySocial.Controller.Grid.Sort,{"{parent}":self})},implementPublishing:function()
{self.publishItems().implement(EasySocial.Controller.Grid.Publishing,{"{parent}":self})},"{checkAll} change":function(element,event)
{self.checkboxes().prop('checked',$(element).is(':checked'));var total=$(element).is(':checked')?self.checkboxes().length:0;self.setTotalChecked(total)}}});module.resolve()})});EasySocial.module('admin/grid/sort',function($){var module=this;EasySocial.Controller('Grid.Sort',{defaultOptions:{items:"[data-grid-sort-item]"}},function(self)
{return{init:function()
{},"{self} click":function()
{var direction=self.element.data('direction'),column=self.element.data('sort');self.parent.setOrdering(column);self.parent.setDirection(direction);self.parent.setTask('');self.parent.submitForm()}}});module.resolve()});EasySocial.module('admin/grid/publishing',function($){var module=this;EasySocial.Controller('Grid.Publishing',{defaultOptions:{}},function(self)
{return{init:function()
{},"{self} click":function(el)
{var row=self.element.parents('tr'),task=self.element.data('task');self.parent.selectRow(row);self.parent.setTask(task);self.parent.submitForm()}}});module.resolve()});EasySocial.module('admin/grid/ordering',function($){var module=this;EasySocial.Controller('Grid.Ordering',{defaultOptions:{"{moveUp}":"[data-grid-order-up]","{moveDown}":"[data-grid-order-down]",row:null}},function(self)
{return{init:function()
{self.options.row=self.element.parents('tr')},selectRow:function()
{var checkbox=self.options.row.find('input[name=cid\\[\\]]');$(checkbox).prop('checked',!0)},"{moveUp} click":function()
{self.selectRow();$.Joomla('submitform',['moveUp'])},"{moveDown} click":function()
{self.selectRow();$.Joomla('submitform',['moveDown'])}}});module.resolve()});EasySocial.module('admin/groups/groups',function($){var module=this;EasySocial.require().library('expanding').done(function($)
{EasySocial.Controller('Groups.Pending.Item',{defaultOptions:{"{approve}":"[data-pending-approve]","{reject}":"[data-pending-reject]"}},function(self){return{init:function()
{self.options.id=self.element.data('id')},"{approve} click":function()
{EasySocial.dialog({content:EasySocial.ajax('admin/views/groups/approveGroup',{"ids":self.options.id})})},"{reject} click":function()
{EasySocial.dialog({content:EasySocial.ajax('admin/views/groups/rejectGroup',{"ids":self.options.id})})}}});module.resolve()})});EasySocial.module('admin/groups/users',function($){var module=this;EasySocial.require().language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST').done(function($){EasySocial.Controller('Groups.Users',{defaultOptions:{groupid:null,'{addMember}':'[data-group-add-member]','{removeMember}':'[data-group-remove-member]','{approveMember}':'[data-group-approve-member]','{promoteMember}':'[data-group-promote-member]','{demoteMember}':'[data-group-demote-member]'}},function(self){return{init:function(){},'{addMember} click':function(el,ev){var members={};window.addMembers=function(obj){if(obj.state){members[obj.id]=obj}else{delete members[obj.id]}};var confirmAddMembers=function(){EasySocial.dialog({content:EasySocial.ajax('admin/views/groups/confirmAddMembers',{members:members,groupid:self.options.groupid}),bindings:{'{submitButton} click':function(){this.addMembersForm().submit()}}})};EasySocial.dialog({content:EasySocial.ajax('admin/views/groups/addMembers'),bindings:{'{submitButton} click':function(){confirmAddMembers()}}})},'{removeMember} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['removeMembers'])}},'{approveMember} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['publishUser'])}},'{promoteMember} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['promoteMembers'])}},'{demoteMember} click':function(el,ev){if(document.adminForm.boxchecked.value==0){alert($.language('JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST'))}else{$.Joomla('submitform',['demoteMembers'])}}}});module.resolve()})});EasySocial.module('admin/indexer/indexer',function($){var module=this;EasySocial.require().language('COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING','COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED','COM_EASYSOCIAL_INDEXER_REINDEX_RESTART').view('site/loading/small').done(function($){EasySocial.Controller('Indexer',{defaultOptions:{"{startButton}":"[data-start-button]","{indexerBar}":"[data-indexer-bar]","{indexerResult}":"[data-indexer-result]","{indexerMessage}":"[data-indexer-message]","{resultsButton}":"[data-results-button]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function(){},"{startButton} click":function()
{self.runIndex(0);self.indexerMessage().html($.language('COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING'));self.indexerMessage().show();self.startButton().hide()},runIndex:function(max){EasySocial.ajax('admin/controllers/indexer/indexing',{"max":max,},{beforeSend:function()
{}}).done(function(max,progress)
{if(max<0)
{progress='100'}
self.updateProgress(progress);if(max>=0)
{self.runIndex(max)}}).fail(function(message){self.setMessage(message)}).always(function(){})},updateProgress:function(progress)
{self.indexerBar().css('width',progress+'%')
self.indexerResult().html(progress+'%');if(progress==100)
{self.indexerMessage().html($.language('COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED'));self.startButton().html($.language('COM_EASYSOCIAL_INDEXER_REINDEX_RESTART'));self.startButton().show();self.resultsButton().removeClass('hide')}},}});module.resolve()})});EasySocial.module('admin/mailer/mailer',function($){var module=this;EasySocial.Controller('Mailer',{defaultOptions:{"{item}":"[data-mailer-item]"}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.Mailer.Item)}}});EasySocial.Controller('Mailer.Item',{defaultOptions:{"{preview}":"[data-mailer-item-preview]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{preview} click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('admin/views/mailer/preview',{'id':self.options.id})})}}});module.resolve()});EasySocial.module('admin/maintenance/database',function($){var module=this;EasySocial.Controller('Maintenance.Database',{defaultOptions:{'{start}':'[data-start]','{progress}':'[data-progress]','{progressBox}':'[data-progress-box]','{progressBar}':'[data-progress-bar]','{progressPercentage}':'[data-progress-percentage]'}},function(self){return{init:function(){},'{start} click':function(el){el.hide();self.progress().show();self.process()},counter:0,versions:[],process:function(){self.getStats().done(function(versions){self.versions=versions;self.execute()})},getStats:function(){return EasySocial.ajax('admin/controllers/maintenance/getDatabaseStats')},execute:function(){if(self.versions[self.counter]===undefined){return self.completed()}
EasySocial.ajax('admin/controllers/maintenance/synchronizeDatabase',{version:self.versions[self.counter]}).done(function(){self.counter++;var percentage=Math.floor((self.counter/self.versions.length)*100)+'%';self.progressBar().css('width',percentage);self.progressPercentage().text(percentage);self.execute()})},completed:function(){self.progressBar().css('width','100%');self.progressPercentage().text('100%');self.progressBox().removeClass('progress-info').addClass('progress-success')}}});$('[data-base]').addController('EasySocial.Controller.Maintenance.Database');module.resolve()});EasySocial.module('admin/maintenance/maintenance',function($){var module=this;EasySocial.Controller('Maintenance.Execute',{defaultOptions:{'{row}':'[data-row]'}},function(self){return{init:function(){self.runscript()},counter:0,success:0,fail:0,runscript:function(){var row=self.row().eq(self.counter);if(row.length===0){return self.completed()}
var key=row.data('key');EasySocial.ajax('admin/controllers/maintenance/runscript',{key:key}).done(function(){self.setStatus(row,1);self.success++}).fail(function(){self.setStatus(row,0);self.fail++}).always(function(){self.counter++;self.runscript()})},completed:function(){if(self.fail<1){window.location='index.php?option=com_easysocial&view=maintenance&success='+self.success}},setStatus:function(row,state){var status=row.find('[data-status]'),icon=row.find('[data-icon]'),statuses=['label-danger','label-success','label-warning'],icons=['ies-warning-2','ies-checkmark','ies-wrench-3'];for(i=0;i<3;i++){status.toggleClass(statuses[i],state==i);icon.toggleClass(icons[i],state==i)}}}});module.resolve()});EasySocial.module('admin/migrators/migrator',function($){var module=this;EasySocial.require().script('progress/progress').done(function($){EasySocial.Controller('Migrators.Migrator',{defaultOptions:{component:null,processState:0,progressController:null,mapping:null,updateconfig:0,"{initiateButton}":"[data-initiate-migration]","{progressBar}":".discoverProgress","{results}":".scannedResult","{viewLog}":".viewLog","{customFieldsMap}":"[data-custom-fields-map]","{resultForm}":"[data-migration-result]","{startWidget}":"[data-start-widget]","{fieldItem}":"[data-field-item]","{startMigrationButton}":"[data-start-migration]","{rows}":"[data-row-item]","{selection}":"[data-field-item]","{jomsocialBackButton}":"[data-jomsocial-back-button]"}},function(self){return{init:function()
{self.initProgressBar();self.initLogging()},showCustomFields:function()
{self.startWidget().slideUp();self.customFieldsMap().slideDown()},showResultForm:function()
{self.customFieldsMap().slideUp();if(self.options.component!='com_community')
{self.startWidget().slideUp()}
self.resultForm().slideDown()},startMigration:function()
{self.showResultForm();if(self.options.processState==1)
{return}
else{self.options.processState=1}
self.reset();EasySocial.ajax('admin/controllers/migrators/check',{'component':self.options.component}).done(function(data)
{if(data.isvalid)
{self.options.progressController.begin(data.count);self.startIterating('')}
else{self.results().show();self.addLog('Error: '+data.message);self.options.processState=0}})},reset:function()
{self.results().html('');self.initLogging();self.options.progressController.reset()},initLogging:function()
{self.viewLog().hide()},initProgressBar:function()
{self.progressBar().implement(EasySocial.Controller.Progress);self.options.progressController=self.progressBar().controller()},addLog:function(message)
{$('<li>').html(message).appendTo(self.results())},startIterating:function(item)
{if(self.options.mapping==null)
{if(self.selection().length>0)
{self.options.mapping=$('#adminForm').serializeArray()}}
EasySocial.ajax('admin/controllers/migrators/process',{"component":self.options.component,"item":item,"mapping":self.options.mapping,"updateconfig":self.options.updateconfig,}).always(function(data,updateConfig)
{self.options.updateconfig=updateConfig;if(data["continue"])
{self.options.progressController.touch('Discovering...');self.addLog(data.message);self.startIterating(data.item)}
else{self.options.progressController.touch('Discover Completed');self.addLog(data.message);self.addLog('migration process completed.');self.viewLog().show();self.jomsocialBackButton().show();self.options.processState=0}})},"{fieldItem} change":function(el)
{var value=$(el).val();if(value=='')
{$(el).parents('[data-row-item]').removeClass('success').addClass('error')}
else{$(el).parents('[data-row-item]').removeClass('error').addClass('success')}},"{startMigrationButton} click":function()
{if(self.selection().length>0)
{self.selection().each(function(i,el){if($(el).val()=="")
{$(el).parents('[data-row-item]').removeClass('success').addClass('error')}
else{$(el).parents('[data-row-item]').removeClass('error').addClass('success')}})}
var hasError=self.rows().hasClass('error');if(hasError)
{EasySocial.dialog({content:EasySocial.ajax('admin/views/migrators/confirmMigration'),bindings:{"{submitButton} click":function()
{self.startMigration();EasySocial.dialog().close()}}})}
else{self.startMigration()}},"{initiateButton} click":function(element)
{self.showCustomFields()},"{viewLog} click":function()
{self.results().toggle()}}});module.resolve()})});EasySocial.module('admin/points/discover',function($){var module=this;EasySocial.require().script('progress/progress').language('COM_EASYSOCIAL_SCAN_COMPLETED').done(function($){EasySocial.Controller('Points.Discover',{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-points-discovery-start]","{progressBar}":".discoverProgress","{results}":"[data-points-discovery-result]"}},function(self){return{init:function()
{self.initProgressBar()},reset:function()
{self.results().html('');self.options.progressController.reset()},initProgressBar:function()
{self.progressBar().implement(EasySocial.Controller.Progress);self.options.progressController=self.progressBar().controller()},addLog:function(message)
{$('<tr>').append($('<td>').html(message)).appendTo(self.results())},startIterating:function()
{var file=self.options.files.shift();EasySocial.ajax('admin/controllers/points/scan',{"file":file}).always(function(data,message,completeMessage){if(self.options.files.length>0)
{self.options.progressController.touch('...');self.addLog(message);self.startIterating()}
else{self.options.progressController.touch('...');self.addLog(message);self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})},"{startButton} click":function(element)
{self.reset();self.startButton().attr('disabled','disabled');EasySocial.ajax('admin/controllers/points/discoverFiles',{}).done(function(files,message)
{self.reset();self.options.files=files;if(self.options.files.length>0)
{self.options.progressController.begin(self.options.files.length);self.addLog(message);self.startIterating()}
else{self.options.progressController.begin(1);self.options.progressController.completed('Discover Completed');self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})}}});module.resolve()})});EasySocial.module('admin/privacy/discover',function($){var module=this;EasySocial.require().script('progress/progress').done(function($){EasySocial.Controller('Privacy.Discover',{defaultOptions:{files:[],progressController:null,"{startButton}":".scanRules","{progressBar}":".discoverProgress","{results}":".scannedResult","{viewLog}":".viewLog",view:{}}},function(self){return{init:function()
{self.initProgressBar();self.initLogging()},reset:function()
{self.results().html('');self.initLogging();self.options.progressController.reset()},initLogging:function()
{self.viewLog().hide()},initProgressBar:function()
{self.progressBar().implement(EasySocial.Controller.Progress);self.options.progressController=self.progressBar().controller()},addLog:function(message)
{$('<li>').html(message).appendTo(self.results())},startIterating:function()
{var file=self.options.files.shift();EasySocial.ajax('admin/controllers/privacy/scan',{"file":file}).always(function(data){if(self.options.files.length>0)
{self.options.progressController.touch('Discovering...');self.addLog('Scanned '+data.file+' : '+data.rules.length+' rules installed.');self.startIterating()}
else{self.options.progressController.touch('Discover Completed');self.addLog('Scanned '+data.file+' : '+data.rules.length+' rules installed.');self.addLog('Scanning completed.');self.viewLog().show();self.startButton().removeAttr('disabled')}})},"{startButton} click":function(element)
{self.reset();self.startButton().attr('disabled','disabled');EasySocial.ajax('admin/controllers/privacy/discoverFiles',{}).done(function(files){self.options.files=files;if(self.options.files.length>0)
{self.options.progressController.begin(self.options.files.length);self.results().hide();self.addLog('Found a total of '+files.length+' rules file in the site.');self.startIterating()}
else{self.options.progressController.begin(1);self.options.progressController.completed('Discover Completed');self.addLog($.language('COM_EASYSOCIAL_SCAN_COMPLETED'));self.startButton().removeAttr('disabled')}})},"{viewLog} click":function()
{self.results().toggle()}}});module.resolve()})});EasySocial.module('admin/profiles/avatar',function($){var module=this;EasySocial.require().script('uploader/uploader').done(function(){EasySocial.Controller('Profiles.Avatar',{defaultOptions:{token:null,"{fileUploader}":"[data-profile-avatars-uploader]","{startUploadButton}":"[data-profile-avatars-startupload]","{avatarList}":"[data-profile-avatars-list]","{avatarEmpty}":"[data-profile-avatars-empty]","{avatarItem}":"[data-profile-avatars-item]","{messagePlaceholder}":"[data-profile-avatars-message]","{removeFile}":".removeFile","{clearUploadedItems}":"[data-uploader-clear]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.initUploader();self.initAvatar()},initUploader:function()
{self.fileUploader().implement(EasySocial.Controller.Uploader,{url:$.indexUrl+'?option=com_easysocial&namespace=admin/controllers/profiles/uploadDefaultAvatars&'+self.options.token+'=1&tmpl=component&format=ajax&uid='+self.options.id})},initAvatar:function()
{self.avatarItem().implement('EasySocial.Controller.Profiles.Avatar.Item',{"{parent}":self,items:self.avatarItem})},addMessage:function(message)
{self.clearMessage();self.setMessage(message)},"{removeFile} click":function(el,event)
{var id=$(el).parents('li').attr('id');self.fileUploader().controller().removeItem(id)},"{startUploadButton} click":function()
{var controller=self.fileUploader().controller();controller.startUpload()},"{fileUploader} UploadProgress":function(el,event,file)
{var progress=file.percent,elementId='#'+file.id,progressBar=$(elementId).find('.progressBar');progressBar.show();progressBar.find('.bar').css('width',progress+'%')},"{fileUploader} FileUploaded":function(el,event,file,response)
{if(response[0]!=undefined)
{var contents=response[0].data[0];self.avatarEmpty().hide();self.avatarList().prepend(contents);self.clearUploadedItems().show();self.initAvatar()}},"{clearUploadedItems} click":function()
{var controller=self.fileUploader().controller();controller.reset();self.clearUploadedItems().hide()}}});EasySocial.Controller('Profiles.Avatar.Item',{defaultOptions:{id:null,"{deleteLink}":"[data-avatar-delete]","{setDefaultAvatar}":"[data-avatar-default]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{setDefaultAvatar} click":function(el,event)
{EasySocial.ajax('admin/controllers/avatars/setDefault',{"id":self.options.id}).done(function(message)
{self.parent.avatarItem().removeClass('default');self.element.addClass('default');self.parent.addMessage(message)})},"{deleteLink} click":function()
{EasySocial.dialog({content:EasySocial.ajax('admin/views/profiles/confirmDeleteAvatar'),bindings:{"{deleteButton} click":function(el,event)
{$(el).addClass('btn-loading');EasySocial.ajax('admin/controllers/avatars/delete',{"id":self.options.id}).done(function(message)
{self.element.remove();if(self.parent.avatarList().children().length==0)
{self.parent.avatarEmpty().show()}
self.parent.addMessage(message);EasySocial.dialog().close()})}}})}}});module.resolve()})});EasySocial.module('uploader/uploader',function($){var module=this;EasySocial.require().library('plupload').view('site/uploader/queue.item').script('uploader/queue').done(function(){EasySocial.Controller('Uploader',{defaults:{url:$.indexUrl+'?option=com_easysocial&controller=uploader&task=uploadTemporary&format=json&tmpl=component&'+EasySocial.token()+'=1',uploaded:[],query:"",plupload:'',dropArea:'uploaderDragDrop',extensionsAllowed:'jpg,jpeg,png,gif',temporaryUpload:!1,files:[],'{uploaderForm}':'[data-uploader-form]','{uploadButton}':'[data-uploader-browse]','{uploadArea}':'.uploadArea','{queue}':'[data-uploaderQueue]','{queueItem}':'[data-uploaderQueue-item]','{emptyFiles}':'[data-uploader-empty]','{removeFile}':'[data-uploaderQueue-remove]','{uploadCounter}':'.uploadCounter',view:{queueItem:"site/uploader/queue.item"}}},function(self){return{init:function(){self.queue().implement(EasySocial.Controller.Uploader.Queue);if(self.options.temporaryUpload)
{self.options.url=$.indexUrl+'?option=com_easysocial&controller=uploader&task=uploadTemporary&format=json&tmpl=component&'+EasySocial.token()+'=1'}
if(self.options.query!='')
{self.options.url=self.options.url+'&'+self.options.query}
self.uploaderForm().implement('plupload',{settings:{url:self.options.url,drop_element:self.options.dropArea,filters:[{title:'Allowed File Type',extensions:self.options.extensionsAllowed}]},'{uploader}':'[data-uploader-form]','{uploadButton}':'[data-uploader-browse]'},function()
{self.options.plupload=this.plupload})},"{uploaderForm} FilesAdded":function(el,event,uploader,files)
{self.addFiles(files);if(self.options.temporaryUpload)
{self.startUpload()}},"{uploaderForm} UploadProgress":function(el,event,uploader,file){self.queueItem('#'+file.id).trigger('UploadProgress',file)},'{uploaderForm} FileUploaded':function(el,event,uploader,file,response){self.queueItem('#'+file.id).trigger('FileUploaded',[file,response])},"{uploaderForm} UploadComplete":function(el,event,uploader,files)
{self.options.uploading=!1},'{uploaderForm} Error':function(el,event,uploader,error)
{self.clearMessage();var obj={'message':error.message,'type':'error'};self.setMessage(obj)},'{uploaderForm} FileError':function(el,event,uploader,file,response)
{var obj={'message':response.message,'type':'error'};self.setMessage(obj);self.queueItem('#'+file.id).trigger('FileError',[file,response])},addFiles:function(files)
{$.each(files,function(index,file)
{file.size=self.formatSize(file.size);var content=self.view.queueItem({"file":file,"temporaryUpload":self.options.temporaryUpload});$(content).implement(EasySocial.Controller.Uploader.Queue.Item,{"{uploader}":self});self.options.files.push(file);self.emptyFiles().hide();self.queue().append(content)})},formatSize:function(bytes)
{var val=parseInt(bytes/1024);return val},reset:function()
{self.queueItem().remove()},removeItem:function(id)
{var element=$('#'+id);var uploaderId=$(element).find('input[name=upload-id\\[\\]]').val();EasySocial.ajax('site/controllers/uploader/delete',{"id":uploaderId}).done(function()
{$('#'+id).remove();self.options.plupload.removeFile(self.options.plupload.getFile(id))})},startUpload:function()
{self.upload()},upload:function()
{if(self.options.plupload.files.length>0)
{self.options.uploading=!0;self.options.plupload.start()}},hasFiles:function(){return self.options.files.length>0}}});module.resolve()})});EasySocial.module('uploader/queue',function($){var module=this;EasySocial.require().view('site/uploader/queue.item').done(function($){EasySocial.Controller('Uploader.Queue',{defaults:{"{item}":"[data-uploaderQueue-item]"}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Uploader.Queue.Item)}}});EasySocial.Controller('Uploader.Queue.Item',{defaultOptions:{"{delete}":"[data-uploaderQueue-remove]","{progress}":"[data-uploaderQueue-progress]","{progressBar}":"[data-uploaderQueue-progressBar]","{status}":"[data-uploaderQueue-status]","{id}":"[data-uploaderQueue-id]"}},function(self){return{init:function()
{if(self.uploader.options.temporaryUpload)
{self.idTemplate=self.id().toHTML();self.id().remove()}},"{delete} click":function()
{self.uploader.removeItem(self.element.attr('id'))},"{self} FileUploaded":function(el,event,file,response)
{if(self.uploader.options.temporaryUpload)
{$.buildHTML(self.idTemplate).val(response.id).appendTo(self.element)}
if(file.status==5)
{self.element.addClass('is-done');self.status().html('Done')}},"{self} UploadProgress":function(el,event,progress)
{self.status().html(progress.percent+'%');self.progressBar().css('width',progress.percent+'%')},"{self} FileError":function()
{self.element.removeClass("is-done is-queue").addClass("is-error");self.progress().removeClass("progress-danger progress-success progress-info progress-warning").addClass("progress-danger");self.status().html('Error')}}});module.resolve()})});EasySocial.module('admin/profiles/fields',function($){var module=this;EasySocial.require().library('ui/draggable','ui/sortable','ui/droppable').script('field').view('admin/profiles/form.fields.editorItem','admin/profiles/form.fields.stepItem','admin/profiles/form.fields.editorPage','admin/profiles/form.fields.config','admin/profiles/dialog.move.field').language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRM','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_PAGE','COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_FIELD','COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS','COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES','COM_EASYSOCIAL_FIELDS_INVALID_VALUES').done(function(){var $Parent,$Browser,$Editor,$Steps,$Config;var $Apps={},$Core={},$Check={},$Fields={},$Pages={};var $Deleted={pages:[],fields:[]}
EasySocial.Controller('Fields',{defaultOptions:{id:0,group:null,'{wrap}':'[data-fields-wrap]','{browser}':'[data-fields-browser]','{editor}':'[data-fields-editor]','{steps}':'[data-fields-steps]','{config}':'[data-fields-config]','{saveForm}':'[data-fields-save]',view:{config:'admin/profiles/form.fields.config'}}},function(self){return{init:function()
{$Parent=self;self.options.id=self.element.data('id');$Browser=self.addPlugin('browser');$Editor=self.addPlugin('editor');$Steps=self.addPlugin('steps');var controllers=[$Browser.state,$Editor.state,$Steps.state];$.when.apply(null,controllers).done(function(){$Parent.trigger('controllersReady')});$('.profileForm').on('save',function(ev,task,result){var data=self.save(task);result.push(data)})},changed:!1,customFieldChanged:function(){self.changed=!0},'{window} beforeunload':function(el,ev){if(self.changed){return $.language('COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES')}},'{saveForm} click':function()
{self.save()},save:function(task)
{var dfd=$.Deferred();self.element.find('input,select').not(self.saveForm()).prop('disabled',!0);self.saveForm().val('');if(task==='savecopy')
{self.changed=!0}
if(!self.changed)
{dfd.resolve();return dfd}
$Parent.trigger('saving');if($Config&&$Config.state){if(!$Config.checkConfig()){EasySocial.dialog({content:$.language('COM_EASYSOCIAL_FIELDS_INVALID_VALUES')});dfd.reject();return dfd}}
$Check=$.extend(!0,{},$Core);var data=[];$.each($Steps.step(),function(i,step){step=$(step);var page=$Editor.getPage(step.data('id'));data.push(page._export())});if($._.keys($Check).length>0){$Parent.trigger('saved',[!1]);EasySocial.dialog({content:$.language('COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS')});dfd.reject();return dfd}
$Parent.changed=!1;var saveData={data:data,deleted:$Deleted};self.injectSaveData(saveData);dfd.resolve();return dfd},injectSaveData:function(data){data=JSON.stringify(data);self.saveForm().val(data)},updateResult:function(data)
{$.each(data,function(i,dataStep){var step=$Steps.step().eq(i);var stepid=step.data('id');var page=$Editor.getPage(stepid);$Steps.updateResult(i,dataStep.id);page.updateResult(stepid,dataStep)})},'{self} doneConfiguring':function(){self.element.removeClass('editting')},loadConfiguration:function(item,type){self.element.addClass('editting');var config=$(self.view.config());$Config=config.addController('EasySocial.Controller.Fields.Config',{controller:{item:item}});if(type==='page')
{item.pageHeader().append(config)}
else{item.element.append(config)}
self.element.trigger('loadingConfig',[type])}}});EasySocial.Controller('Fields.Browser',{defaultOptions:{'{browser}':'[data-fields-browser]','{mandatory}':'[data-fields-browser-group-mandatory]','{unique}':'[data-fields-browser-group-unique]','{standard}':'[data-fields-browser-group-standard]','{list}':'[data-fields-browser-list]','{item}':'[data-fields-browser-item]','affixClass':'es-browser-affix'}},function(self){return{state:$.Deferred(),init:function(){self.registerApps();self.ready();self.affixHandler();self.initAffix()},ready:function(){self.state.resolve()},'{parent} controllersReady':function(){var id=$Steps.getCurrentStep().data('id');self.initDraggable(id)},'{parent} pageChanged':function(el,ev,page,uid){self.item().draggable('destroy');self.initDraggable(uid)},'{parent} pageAdded':function(el,ev,page,uid){self.item().draggable('destroy');self.initDraggable(uid)},initDraggable:function(id){self.item().draggable({revert:'invalid',helper:'clone',connectToSortable:'[data-fields-editor-page-items-'+id+']'})},affixHandler:function(){var parent=$(window),wrap=self.parent.wrap(),height=wrap.offset().top,scroll=parent.scrollTop();if(scroll>height&&!self.browser().hasClass(self.options.affixClass)){self.browser().addClass(self.options.affixClass)}
if(scroll<=height&&self.browser().hasClass(self.options.affixClass)){self.browser().removeClass(self.options.affixClass)}},initAffix:function(){$(window).scroll(self.affixHandler)},registerApps:function(){$.each(self.item(),function(index,item){item=$(item);var id=item.data('id');$Apps[id]={id:id,element:item.data('element'),title:item.data('title'),params:item.data('params'),core:item.data('core'),unique:item.data('unique'),item:item};if(item.data('core')){$Core[id]=$Apps[id]}})},checkout:function(id){if($Check[id]!==undefined){delete $Check[id]}},'{item} click':function(el){var currentPage=$Editor.currentPage();var appid=el.data('id');currentPage.addNewField(appid)},'{parent} fieldAdded':function(el,event,appid){var app=$Apps[appid];if(app&&app.core){app.item.hide();var items=self.mandatory().find(self.item.selector).filter(':visible');self.mandatory().toggle((items.length>0))}
if(app&&app.unique){app.item.hide();var items=self.unique().find(self.item.selector).filter(':visible');self.unique().toggle((items.length>0))}},'{parent} fieldDeleted':function(el,event,appid,fieldid){var app=$Apps[appid];if(app&&app.core){app.item.show();self.mandatory().show();return}
if(app&&app.unique){app.item.show();self.unique().show();return}}}});EasySocial.Controller('Fields.Config',{defaultOptions:{'{config}':'[data-fields-config]','{header}':'[data-fields-config-header]','{close}':'[data-fields-config-close]','{form}':'[data-fields-config-form]','{param}':'[data-fields-config-param]','{tabnav}':'[data-fields-config-tab-nav]','{tabcontent}':'[data-fields-config-tab-content]','{done}':'[data-fields-config-done]'}},function(self){return{init:function(){},state:!1,load:function(config){self.state=!0;config.find('[data-fields-config-param-choices]').addController('EasySocial.Controller.Config.Choices',{controller:{item:self.item}});config.find('h4').hide();self.header().html(config.find('h4').html());self.form().html(config);if(self.item.options.newfield){self.param('[data-fields-config-param-field-unique_key]').attr('disabled',!0).val($.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST'))}
if(self.tabnav().length>0){var coreTab=self.tabnav().find('a[data-tabname="core"]');if(coreTab.length>0){coreTab.tab('show')}else{self.tabnav().find('a:first').tab('show')}}
self.populateConfig();var configHeight=self.element.height();$Parent.wrap().css('padding-bottom',configHeight+'px');$Parent.trigger('configLoaded')},'{close} click':function(el,ev){self.closeConfig()},'{done} click':function(el,ev){self.closeConfig()},closeConfig:function(){var values=self.populateConfig();var state=self.checkConfig(values);if(state){self.item.updateHtml(self.form().html());self.item.content().trigger('onConfigSave',[values]);self.element.remove();$Config=null;$Parent.trigger('doneConfiguring')}else{EasySocial.dialog({content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES'),width:400,height:100})}},'{parent} loadingConfig':function(el,ev,header){if(header!==undefined&&header!='field')
{var headerText=$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_'+header.toUpperCase());self.header().html(headerText)}
self.config().show();self.close().hide();self.form().html($.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING'))},'{parent} configLoaded':function(el,ev){self.close().show()},'{param} change':function(el){self.paramChanged(el)},'{param} keyup':function(el){self.paramChanged(el)},paramChanged:function(el){var name=el.data('name'),value=self.getConfigValue(name);var field=self.item.appParams[name];if(field.type==='boolean'){value=!!value}
self.item.fieldItem().trigger('onConfigChange',[name,value]);$Parent.customFieldChanged()},getConfigValue:function(name){var field=self.item.appParams[name],element=self.param().filterBy('name',name);if(element.length===0){return undefined}
var values='';switch(field.type){case 'choices':values=[];$.each(element.find('li'),function(i,choice){choice=$(choice);var titleField=choice.find('[data-fields-config-param-choice-title]'),valueField=choice.find('[data-fields-config-param-choice-value]'),defaultField=choice.find('[data-fields-config-param-choice-default]');values.push({'id':choice.data('id'),'title':titleField.val(),'value':valueField.val(),'default':defaultField.val()});titleField.attr('value',titleField.val());valueField.attr('value',valueField.val());defaultField.attr('value',defaultField.val())});break;case 'boolean':var tmp=element.val();values=(tmp==='true'||tmp==='1'||tmp===1)?1:0;element.attr('value',values);break;case 'checkbox':values=[];$.each(field.option,function(k,option){var checkbox=element.filter('[data-fields-config-param-option-'+option.value+']');if(checkbox.length>0&&checkbox.is(':checked')){values.push(option.value);checkbox.attr('checked','checked')}else{checkbox.removeAttr('checked')}});break;case 'list':case 'select':case 'dropdown':values=element.length>0?element.val():field["default"]||'';element.find('option').prop('selected',!1);element.find('option[value="'+values+'"]').prop('selected',!0);break;case 'input':case 'text':default:values=element.length>0?element.val():field["default"]||'';element.attr('value',values);break}
return values},populateConfig:function(){var data={};$.each(self.item.appParams,function(name,field){var value=self.getConfigValue(name);if(value===undefined){return!1}
data[name]=value});self.item.trigger('onPopulateConfig',[data]);return data},checkConfig:function(values){if(values===undefined){values=self.populateConfig()}
var state=!0;$.each(values,function(name,value){var field=self.item.appParams[name];switch(field.type){case 'choices':var choiceValues=[];$.each(value,function(i,choice){if($.isEmpty(choice.value)&&!$.isEmpty(choice.title)){choice.value=choice.title.toLowerCase().replace(' ','')}
if(!$.isEmpty(choice.value)&&$.inArray(choice.value,choiceValues)>-1){state=!1;return!1}
choiceValues.push(choice.value)});break}
if(state===!1){return!1}});return state},'{parent} fieldDeleted':function(){if(self.state){$Parent.trigger('doneConfiguring')}},'{parent} pageDeleted':function(){if(self.state){$Parent.trigger('doneConfiguring')}},'{parent} pageAdded':function(){if(self.state){$Parent.trigger('doneConfiguring')}},'{parent} pageChanged':function(){if(self.state){$Parent.trigger('doneConfiguring')}}}});EasySocial.Controller('Fields.Steps',{defaultOptions:{'{steps}':'[data-fields-step]','{step}':'[data-fields-step-item]','{stepLink}':'[data-fields-step-item-link]','{add}':'[data-fields-step-add]',view:{stepItem:'admin/profiles/form.fields.stepItem'}}},function(self){return{state:$.Deferred(),init:function(){self.ready()},ready:function(){self.state.resolve()},'{parent} controllersReady':function(){self.initSort()},initSort:function(){self.steps().sortable({items:self.step.selector,placeholder:'ui-state-highlight',cursor:'move',helper:'clone',forceHelperSize:!0,stop:function(){$('.tooltip-es').remove();$Parent.customFieldChanged()}})},'{parent} pageDeleted':function(el,event,uid){self.deleteStep(uid);if($Steps.step().length>0){$Steps.stepLink(':first').tab('show')}},'{step} click':function(el,ev){if(!el.hasClass('active')){var id=el.data('id');$Parent.trigger('pageChanged',[$Editor.getPage(id),id])}},'{add} click':function(){var stepuid=$.uid('step');self.addStep(stepuid);$Editor.addPage(stepuid);self.stepLink(':last').tab('show')},addStep:function(uid){self.add().before(self.view.stepItem({uid:uid}))},getStep:function(uid){return self.step().filterBy('id',uid)},getStepLink:function(uid){return self.stepLink().filterBy('id',uid)},deleteStep:function(uid){self.getStep(uid).remove()},getCurrentStep:function(){return self.step('.active')},currentStepIndex:function(){return self.step().index(self.step('.active'))+1},updateResult:function(sequence,newid){var step=self.step(':eq('+sequence+')');if(step.data('id')!=newid){var oldid=step.data('id');step.removeAttr('data-fields-step-item-'+oldid);step.attr('data-fields-step-item-'+newid,!0);step.data('id',newid);step.attr('data-id',newid);var stepLink=self.stepLink().eq(sequence);stepLink.removeAttr('data-fields-step-item-link-'+oldid);stepLink.attr('data-fields-step-item-link-'+newid,!0);stepLink.attr('href','#formStep_'+newid)}},toObject:function(){var data=[];$.each(self.stepLink(),function(i,step){step=$(step);data.push({uid:step.data('id'),title:step.text(),description:step.attr('data-original-title')})});return data}}});EasySocial.Controller('Fields.Editor',{defaultOptions:{'{editor}':'[data-fields-editor]','{page}':'[data-fields-editor-page]','{items}':'[data-fields-editor-page-items]','{item}':'[data-fields-editor-page-item]',view:{editorPage:'admin/profiles/form.fields.editorPage'}}},function(self){return{state:$.Deferred(),init:function(){self.ready()},ready:function(){self.state.resolve()},'{parent} controllersReady':function(){self.page().addController('EasySocial.Controller.Fields.Editor.Page')},currentPage:function(){return self.page('.active').controller()},addPage:function(uid){var newPage=self.view.editorPage({uid:uid});newPage.addController('EasySocial.Controller.Fields.Editor.Page',{uid:uid,newpage:!0,});self.editor().append(newPage);self.page().trigger('pageAdded',[newPage,uid]);$Parent.customFieldChanged()},getPage:function(uid){return self.page().filterBy('id',uid).controller()},'{parent} saving':function(el,event){self.element.addClass('saving')},'{parent} saved':function(el,event,state){if(state===!1){}
self.element.removeClass('saving')}}});EasySocial.Controller('Fields.Editor.Page',{defaultOptions:{pageid:0,uid:0,newpage:!1,'{items}':'[data-fields-editor-page-items]','{item}':'[data-fields-editor-page-item]','{pageHeader}':'[data-fields-editor-page-header]','{content}':'[data-fields-editor-page-header]','{fieldItem}':'[data-fields-editor-page-header]','{pageTitle}':'[data-fields-editor-page-title]','{pageDescription}':'[data-fields-editor-page-description]','{inputTitle}':'[data-fields-editor-page-title-input]','{inputDescription}':'[data-fields-editor-page-description-input]','{pageVisibleRegistration}':'[data-fields-editor-page-visible-registration]','{pageVisibleEdit}':'[data-fields-editor-page-visible-edit]','{pageVisibleView}':'[data-fields-editor-page-visible-view]','{pageDelete}':'[data-fields-editor-page-delete]','{pageEdit}':'[data-fields-editor-page-edit]','{pageInfo}':'[data-fields-editor-page-info]','{pageInfoDone}':'[data-fields-editor-page-done]',view:{editorItem:'admin/profiles/form.fields.editorItem'}}},function(self){return{init:function(){if(!self.options.newpage)
{self.options.uid=self.options.pageid=self.element.data('id')}
self.registerPage();self.item().addController('EasySocial.Controller.Fields.Editor.Item',{pageid:self.options.uid});self.checkPageDeleteButton();self.initSort()},fields:{},getStep:function(){return $Steps.getStep(self.options.uid)},registerPage:function(){$Pages[self.options.uid]=self},initSort:function(){self.items().sortable({items:self.item.selector,handle:'[data-fields-editor-page-item-handle]',placeholder:'ui-state-highlight',cursor:'move',helper:'clone',forceHelperSize:!0,stop:function(event,ui){if(ui.item.is($Browser.item.selector)){var appid=ui.item.data('id');var placeholder=self.createPlaceholder();ui.item.replaceWith(placeholder);self.createNewField(appid,placeholder)}
$Parent.customFieldChanged()}})},addNewField:function(appid){var placeholder=self.createPlaceholder();self.items().append(placeholder);$.scrollTo(placeholder,200);self.createNewField(appid,placeholder);$Parent.customFieldChanged()},createPlaceholder:function(){var uid=$.uid('newfield');var placeholder=self.view.editorItem({uid:uid});return placeholder},createNewField:function(appid,placeholder){$Parent.trigger('fieldAdded',[appid]);self.getFieldHtml(appid).done(function(html){html=$.parseHTML(html,document,!0);html=$(html);placeholder.replaceWith(html);var div=html.filter('[data-appid="'+appid+'"]');div.addController('EasySocial.Controller.Fields.Editor.Item',{controller:{page:self},appid:appid,pageid:self.options.uid,newfield:!0,})}).fail(function(msg){placeholder.html(msg)})},getFieldHtml:function(appid){var state=$.Deferred();if($Apps[appid].html===undefined){EasySocial.ajax('admin/controllers/fields/renderSample',{appid:appid,profileid:$Parent.options.id,group:$Parent.options.group}).done(function(html){$Apps[appid].html=html;state.resolve(html)}).fail(function(msg){state.reject(msg)})}else{state.resolve($Apps[appid].html)}
return state},'{pageHeader} click':function(el,event){var clickedTarget=$(event.target);if(clickedTarget.not('[data-fields-editor-page-delete]')&&!el.hasClass('editting')){if($Config&&$Config.state){var state=$Config.checkConfig();if(state){$Config.closeConfig()}else{EasySocial.dialog({content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES'),width:400,height:100});return}}
self.loadConfiguration()}},loadConfiguration:function(){$Parent.loadConfiguration(self,'page');self.pageHeader().addClass('editting');self.getPageConfig().done(function(){var pageConfig=$(self.html);$Config.load(pageConfig)}).fail(function(msg){$Config.load(msg)})},updateHtml:function(html){self.html=html},getPageConfig:function(){var state=$.Deferred();if(!$.isEmptyObject(self.params)){state.resolve()}else{EasySocial.ajax('admin/controllers/profiles/getPageConfig',{pageid:self.options.pageid}).done(function(params,values,html){self.params=params;self.values=values;self.html=html;self.appParams=params;state.resolve()}).fail(function(msg){state.reject(msg)})}
return state},getConfigValues:function(){return self.values},'{fieldItem} onConfigChange':function(el,ev,name,value){self.values[name]=value;var step=$Steps.getStepLink(self.options.uid);if(name==='title'){step.text(value);self.pageTitle().html(value)}
if(name==='description'){step.attr('data-original-title',value);self.pageDescription().html(value)}
$Parent.customFieldChanged()},'{pageDelete} click':function(el){if(el.enabled()){el.disabled(!0);if($Editor.page().length==1){el.enabled(!0);return!1}
EasySocial.dialog({width:400,height:150,title:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE'),content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION'),showOverlay:!1,buttons:[{name:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL'),classNames:'btn btn-es',click:function(){el.enabled(!0);EasySocial.dialog().close()}},{name:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM'),classNames:'btn btn-es-danger',click:function(){EasySocial.dialog().update({content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING')});self.deletePage();EasySocial.dialog().close()}}]})}},deletePage:function(){self.item().trigger('pageDeleted');$Parent.trigger('pageDeleted',[self.options.uid]);delete $Pages[self.options.uid];if(!self.options.newpage){$Deleted.pages.push(self.options.uid)}
self.element.remove();$.each($Editor.page(),function(i,page){$(page).controller().checkPageDeleteButton()});$Parent.customFieldChanged()},_export:function(){var fields=[];$.each(self.item(),function(j,item){item=$(item).controller();if(item!==undefined)
{fields.push(item._export())}});var data={fields:fields,newpage:self.options.newpage,id:self.options.uid}
if(self.values!==undefined){var data=$.extend(data,self.values)}
return data},updateResult:function(oldid,data){if(self.options.newpage){self.element.attr('id','formStep_'+data.id);self.element.removeAttr('data-fields-editor-page-'+oldid);self.element.attr('data-fields-editor-page-'+data.id,!0);self.options.pageid=self.options.uid=data.id;$Pages[data.id]=$.extend(!0,{},$Pages[oldid]);delete $Pages[oldid];self.options.newpage=!1}
if(data.fields!==undefined){$.each(data.fields,function(i,field){var item=self.item().eq(i).controller();item.updateResult(field)})}},'{self} pageAdded':function(el,event,page){self.checkPageDeleteButton();$Parent.customFieldChanged()},checkPageDeleteButton:function(){if($Editor.page().length>1){self.pageDelete().show()}else{self.pageDelete().hide()}},'{parent} loadingConfig':function(){self.pageHeader().removeClass('editting');self.item().removeClass('editting')},'{parent} doneConfiguring':function(){self.pageHeader().removeClass('editting');self.item().removeClass('editting')}}});EasySocial.Controller('Fields.Editor.Item',{defaultOptions:{appid:0,fieldid:0,pageid:0,newfield:!1,'{edit}':'[data-fields-editor-page-item-edit]','{deleteButton}':'[data-fields-editor-page-item-delete]','{moveButton}':'[data-fields-editor-page-item-move]','{content}':'[data-fields-editor-page-item-content]','{fieldItem}':'[data-field]','{config}':'[data-fields-config]','{closeConfig}':'[data-fields-config-close]',view:{moveDialog:'admin/profiles/dialog.move.field'}}},function(self){return{app:{},field:{id:0,appid:0,params:{}},state:$.Deferred(),appParams:{},init:function(){if(self.options.appid==0&&self.element.data('appid')!==undefined){self.options.appid=self.element.data('appid')}
if($Apps[self.options.appid]!==undefined){self.app=$Apps[self.options.appid]}
if(self.options.fieldid==0&&self.element.data('id')!==undefined){self.options.fieldid=self.element.data('id')}
self.registerFields();self.uniqueid=$.uid(self.app.id+'_');self.loadedInit()},registerFields:function(){if(self.options.fieldid!=0){$Fields[self.options.fieldid]={id:self.options.fieldid,appid:self.options.appid,params:self.field.params||{}}
self.field=$Fields[self.options.fieldid]}},loadedInit:function(){self.element.addController('EasySocial.Controller.Field.Base',{mode:'sample',element:self.app.element});self.content().addController('EasySocial.Controller.Fields.Editor.Item.Config')},_export:function(){$Browser.checkout(self.options.appid);var exportData={"fieldid":self.options.fieldid,"appid":self.options.appid,"newfield":self.options.newfield};exportData=$.extend(exportData,self.expandConfig(self.field.params));return exportData},'{self} click':function(el,event){var clickedElement=$(event.target);if(!clickedElement.is(self.deleteButton.selector)&&!clickedElement.is(self.moveButton.selector)&&!clickedElement.is(self.config.selector)&&!clickedElement.is(self.closeConfig.selector)&&!el.hasClass('editting')){if($Config&&$Config.state){var state=$Config.checkConfig();if(state){$Config.closeConfig()}else{EasySocial.dialog({content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES'),width:400,height:100});return}}
self.loadConfiguration()}},loadConfiguration:function(){$Parent.loadConfiguration(self,'field');self.element.addClass('editting');self.getAppParams().done(function(){var html=$(self.field.html);$Config.load(html)}).fail(function(){})},updateHtml:function(html){self.field.html=html},getAppParams:function(){var state=$.Deferred();if(self.field.html){state.resolve()}else{EasySocial.ajax('admin/controllers/fields/renderConfiguration',{appid:self.options.appid,fieldid:self.options.fieldid}).done(function(params,values,html){self.app.params=params;self.field.params=values;self.field.html=html;self.populateAppParams();state.resolve()}).fail(function(msg){state.reject(msg)})}
return state},populateAppParams:function(){$.each(self.app.params,function(i,paramProperties){$.each(paramProperties.fields,function(name,field){if(field.subfields){$.each(field.subfields,function(subname,subfield){self.appParams[name+'_'+subname]=subfield})}else{self.appParams[name]=field}})})},getConfigValues:function(){return self.field.params},expandConfig:function(){var newData={params:{},choices:{}};$.each(self.field.params,function(name,value){var field=self.appParams[name];if(!field){return!1}
var type=field.type=='choices'?'choices':'params';newData[type][name]=value});if(self.options.newfield){newData.params.unique_key=''}
return newData},'{moveButton} click':function(el){var pages=$Steps.toObject(),currentPageId=el.parents($Editor.page.selector).data('id'),newPages=[];$.each(pages,function(i,page){if(page.uid!=currentPageId){newPages.push(page)}});EasySocial.dialog({content:self.view.moveDialog(!0,{pages:newPages}),selectors:{"{selection}":"[data-move-selection]","{confirmButton}":"[data-move-confirm]","{cancelButton}":"[data-move-cancel]"},bindings:{"{cancelButton} click":function()
{EasySocial.dialog().close()},"{confirmButton} click":function(){var id=this.selection().val(),page=$Editor.getPage(id);page.items().append(self.element);$Parent.customFieldChanged();EasySocial.dialog().close()}}})},'{deleteButton} click':function(el){if(el.enabled()){el.disabled(!0);EasySocial.dialog({width:400,height:150,title:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE'),content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION'),showOverlay:!1,buttons:[{name:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL'),classNames:'btn btn-es btn-sm',click:function(){el.enabled(!0);EasySocial.dialog().close()}},{name:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM'),classNames:'btn btn-es-danger btn-sm',click:function(){EasySocial.dialog().update({content:$.language('COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING')});self.deleteField();EasySocial.dialog().close()}}]})}},deleteField:function(){$Parent.trigger('fieldDeleted',[self.options.appid,self.options.fieldid]);if(!self.options.newfield){delete $Fields[self.options.fieldid];$Deleted.fields.push(self.options.fieldid)}
self.element.remove();$Parent.customFieldChanged()},'{self} pageDeleted':function(){self.deleteField()},'{content} onConfigChange':function(el,event,name,value){self.field.params[name]=value},'{self} onPopulateConfig':function(el,event,values){self.field.params=values},updateResult:function(data){self.field.params.unique_key=data.unique_key;self.itemParam('[data-fields-config-param-field-unique_key]').val(data.unique_key);if(self.options.newfield){self.options.newfield=!1;self.options.fieldid=data.fieldid;self.element.data('id',data.fieldid);self.itemParam('[data-fields-editor-page-item-param-field-unique_key]').removeAttr('disabled');self.registerFields()}
if(data.choices!==undefined){$.each(data.choices,function(name,choices){var element=self.itemParam('[data-fields-config-param-field-'+name+']');$.each(choices,function(i,choice){var item=element.find('li').eq(i);if(!item.data('id')){item.attr('data-id',choice.id);item.data('id',choice.id)}})})}}}});EasySocial.Controller('Config.Choices',{defaultOptions:{'{choiceItems}':'[data-fields-config-param-choice]',unique:1}},function(self){return{init:function(){self.options.unique=self.element.data('unique')!==undefined?self.element.data('unique'):1;self.choiceItems().implement(EasySocial.Controller.Config.Choices.Choice,{controller:{'item':self.item,'choices':self}});self.initSortable()},initSortable:function(){self.element.sortable({items:self.choiceItems.selector,placeholder:'ui-state-highlight',cursor:'move',forceHelperSize:!0,handle:'[data-fields-config-param-choice-drag]',stop:function(){$('.tooltip-es').remove();$Parent.customFieldChanged()}})}}});EasySocial.Controller('Config.Choices.Choice',{defaultOptions:{'{choiceValue}':'[data-fields-config-param-choice-value]','{choiceTitle}':'[data-fields-config-param-choice-title]','{choiceDefault}':'[data-fields-config-param-choice-default]','{addChoice}':'[data-fields-config-param-choice-add]','{removeChoice}':'[data-fields-config-param-choice-remove]','{setDefault}':'[data-fields-config-param-choice-setdefault]','{defaultIcon}':'[data-fields-config-param-choice-defaulticon]'}},function(self){return{init:function(){},'{choiceTitle} keyup':$._.debounce(function(el,event){var index=self.element.index();self.item.fieldItem().trigger('onChoiceTitleChanged',[index,el.val()]);$Parent.customFieldChanged()},500),'{choiceValue} keyup':$._.debounce(function(el,event){var index=self.element.index();self.item.fieldItem().trigger('onChoiceValueChanged',[index,el.val()]);$Parent.customFieldChanged()},500),'{addChoice} click':function(){var newItem=self.element.clone();var inputElement=newItem.find('input[type="text"]');inputElement.attr('value','');inputElement.val('');var inputDefault=newItem.find('input[type="hidden"]');inputDefault.attr('value',0);inputDefault.val(0);var defaultLabel=newItem.find('[data-fields-config-param-choice-defaulticon]');defaultLabel.removeClass('es-state-featured').addClass('es-state-default');newItem.attr('data-id',0);newItem.data('id',0);newItem.implement(EasySocial.Controller.Config.Choices.Choice,{controller:{'item':self.item,'choices':self.choices}});self.element.after(newItem);var index=newItem.index();self.item.fieldItem().trigger('onChoiceAdded',[index]);$Parent.customFieldChanged()},'{removeChoice} click':function(){var remaining=self.choices.choiceItems().length-1;if(remaining>=1){var index=self.element.index();self.item.fieldItem().trigger('onChoiceRemoved',[index]);self.element.remove();$('.tooltip-es').remove()}
$Parent.customFieldChanged()},'{setDefault} click':function(){var index=self.element.index(),title=self.choiceTitle().val(),value=self.choiceValue().val();self.choices.choiceItems().trigger('toggleDefault',[index]);self.item.fieldItem().trigger('onChoiceToggleDefault',[index,parseInt(self.choiceDefault().val())]);$Parent.customFieldChanged()},'{self} toggleDefault':function(el,ev,i){var index=self.element.index(),value=parseInt(self.choiceDefault().val());if(index===i){if(value){self.defaultIcon().removeClass('es-state-featured').addClass('es-state-default');self.choiceDefault().val(0)}else{self.defaultIcon().removeClass('es-state-default').addClass('es-state-featured');self.choiceDefault().val(1)}}else{if(self.choices.options.unique){self.defaultIcon().removeClass('es-state-featured').addClass('es-state-default');self.choiceDefault().val(0)}}}}});EasySocial.Controller('Fields.Editor.Item.Config',{defaultOptions:{'{required}':'[data-required]','{title}':'[data-title]','{description}':'[data-description]','{displayTitle}':'[data-display-title]','{displayDescription}':'[data-display-description]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'display_title':self.displayTitle().toggle(!!value);break;case 'title':self.title().text(value);break;case 'display_description':self.displayDescription().toggle(!!value);break;case 'description':self.description().text(value);break;case 'required':self.required().toggle(!!value);break}}}});module.resolve()})});EasySocial.module('field',function($){var module=this;EasySocial.Controller('Field.Base',{defaultOptions:{regPrefix:'easysocial/',modPrefix:'field.',ctrlPrefix:'EasySocial.Controller.Field.',fieldname:'',element:null,id:null,required:!1,mode:'edit','{field}':'[data-field]','{content}':'[data-content]','{notice}':'[data-check-notice]'}},function(self){return{init:function(){self.options.fieldname=self.element.data('fieldname');self.options.element=self.options.element||self.element.data('element');self.options.id=self.element.data('id');self.options.required=!!self.element.data('required');self.initMode();if(self.notice().text().trim().length>0){self.content().popover({animation:!1,content:self.notice().text().trim(),html:!0,placement:'left-top',trigger:'manual',container:'body',template:'<div id="fd" class="fd-popover es es-field-error"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'});self.content().popover('show')}},initMode:function(){switch(self.options.mode)
{case 'registermini':self.field().trigger('onRegisterMini');break;case 'register':self.field().trigger('onRegister');break;case 'edit':self.field().trigger('onEdit');break;case 'adminedit':self.field().trigger('onAdminEdit');break;case 'sample':self.field().trigger('onSample');break;case 'display':self.field().trigger('onDisplay');break}},'{field} error':function(el,ev,state,msg){state=state!==undefined?state:!0;if($.isString(state)){msg=state;state=!0}
if($.isBoolean(state)){self.field().toggleClass('has-error',state)}
if(msg!==undefined){self.content().popover({animation:!1,content:msg,html:!0,placement:'left-top',trigger:'manual',container:'body',template:'<div id="fd" class="fd-popover es es-field-error"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'});self.content().popover('show')}},'{field} clear':function(el,ev){self.field().removeClass('has-error');self.field().removeClass('is-loading');self.content().popover('destroy')},'{self} show':function(){self.field().trigger('onShow')},'{field} loading':function(el,ev,msg){self.field().addClass('is-loading');self.notice().html(msg)},'{field} loaded':function(el,ev){self.field().removeClass('is-loading')}}});module.resolve()});EasySocial.module('admin/profiles/members',function($){var module=this;EasySocial.require().language('COM_EASYSOCIAL_CANCEL_BUTTON','COM_EASYSOCIAL_ASSIGN_BUTTON','COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE').done(function($)
{EasySocial.Controller('Profiles.Members',{defaultOptions:{"{addUser}":"[data-profiles-addUser]","{row}":"[data-profiles-members-row]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{memberList} userSelected":function(el,event,id,name)
{EasySocial.ajax('admin/controllers/profiles/insertMember',{"id":id,"profile_id":self.options.id}).done(function(row)
{self.row().append(row);EasySocial.dialog().close()})},"{addUser} click":function()
{var callbackId=$.callback(function(memberList){self.addPlugin('memberList',memberList)});var url=$.indexUrl+"?option=com_easysocial&view=users&tmpl=component&callback="+callbackId;EasySocial.dialog({title:$.language('COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE'),content:url,showOverlay:!1,width:700,height:600,buttons:[{"name":$.language("COM_EASYSOCIAL_CANCEL_BUTTON"),"classNames":"btn btn-es","click":function()
{EasySocial.dialog().close()}}]})}}});module.resolve()})});EasySocial.module('admin/profiles/profile',function($){var module=this;EasySocial.require().script('utilities/alias').view('admin/profiles/dialog.delete.profileavatar').language('COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR').done(function($){EasySocial.Controller('Profiles.Profile',{defaultOptions:{id:null,hasAvatar:!1,defaultAvatar:null,'{profileAvatar}':'[data-profile-avatar]','{profileAvatarImage}':'[data-profile-avatar-image]','{profileAvatarRemoveWrap}':'[data-profile-avatar-remove-wrap]','{profileAvatarRemoveButton}':'[data-profile-avatar-remove-button]','{profileAvatarUpload}':'[data-profile-avatar-upload]',view:{deleteProfileAvatar:'admin/profiles/dialog.delete.profileavatar'}}},function(self){return{init:function(){self.element.addController('EasySocial.Controller.Utilities.Alias',{"{source}":"#title","{target}":"#alias"});self.options.hasAvatar=self.profileAvatar().data('hasavatar');self.options.defaultAvatar=self.profileAvatar().data('defaultavatar')},'{profileAvatarUpload} change':function(el){var value=el.val();if(!$.isEmpty(value)){self.profileAvatarRemoveWrap().show()}else{if(!self.options.hasAvatar){self.profileAvatarRemoveWrap().hide()}}},'{profileAvatarRemoveButton} click':function(el){if(self.options.hasAvatar){EasySocial.dialog({content:self.view.deleteProfileAvatar(!0),bindings:{'{deleteButton} click':function(){var dialog=this.parent;dialog.loading(!0);EasySocial.ajax('admin/controllers/profiles/deleteProfileAvatar',{id:self.options.id}).done(function(){dialog.loading(!1);dialog.close();self.profileAvatarImage().attr('src',self.options.defaultAvatar);self.profileAvatarRemoveWrap().hide();self.profileAvatarRemoveButton().text($.language('COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR'));self.options.hasAvatar=!1})}}})}else{self.profileAvatarUpload().val('').trigger('change')}}}});module.resolve()})});EasySocial.module('utilities/alias',function($){var module=this;EasySocial.Controller('Utilities.Alias',{defaultOptions:{"{target}":"","{source}":""}},function(self){return{init:function()
{},convertToPermalink:function(title)
{return title.replace(/\s/g,'-').replace(/[^\w/-]/g,'').toLowerCase()},"{source} keyup":function()
{self.target().val(self.convertToPermalink(self.source().val()))},"{target} keyup":function()
{self.target().val(self.convertToPermalink(self.target().val()))}}});module.resolve()});EasySocial.module('admin/profiles/profiles',function($){var module=this;EasySocial.require().done(function($)
{EasySocial.Controller('Profiles',{defaultOptions:{"{updateOrdering}":"[data-profiles-update-ordering]","{item}":"[data-profiles-item]",view:{deleteConfirmation:'admin/profiles/dialog.delete.confirm'}}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.Profiles.Item)},"{updateOrdering} click":function()
{$('[data-table-checkall]').prop('checked',!0).trigger('change');$.Joomla('submitform',['updateOrdering'])}}});EasySocial.Controller('Profiles.Item',{defaultOptions:{"{insertLink}":"[data-profile-insert]"}},function(self)
{return{init:function()
{self.options.title=self.element.data('title');self.options.id=self.element.data('id')},"{insertLink} click":function()
{self.trigger('profileSelected',[self.options.id,self.options.title])}}});module.resolve()})});EasySocial.module('admin/regions/form',function($){var module=this;EasySocial.require().language('COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE').done(function(){$.template('easysocial/parents.select','<select name="parent_uid" data-parent-uid></select>');$.template('easysocial/parents.option','<option value="[%= uid %]">[%= name %]</option>');EasySocial.Controller('Regions.Form',{defaultOptions:{'{type}':'[data-type]','{parentBase}':'[data-parent-base]','{parentContent}':'[data-parent-content]','{parentUid}':'[data-parent-uid]','{parentType}':'[data-parent-type]',view:{parentsSelect:'parents.select',parentsOption:'parents.option'}}},function(self){return{init:function(){self.element.find('input[type="text"]').prop('disabled',!self.type().val());self.element.find('[data-bs-toggle="radio-buttons"]').toggleClass('disabled',!self.type().val());$.Joomla('submitbutton',function(task){if(task=='cancel'){window.location='index.php?option=com_easysocial&view=regions';return!1}
if(self.validate()){$.Joomla('submitform',[task])}else{alert($.language('COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE'))}})},'{type} change':function(el){var parentType=el.find(':selected').data('parent');self.parentType().val(parentType);self.element.find('input[type="text"]').prop('disabled',!el.val());self.element.find('[data-bs-toggle="radio-buttons"]').toggleClass('disabled',!el.val());if(parentType){self.parentBase().show();!self.parentContent().data('loaded')&&self.getParents(parentType).done(function(parents){var base=$(self.view.parentsSelect());$.each(parents,function(i,parent){self.view.parentsOption({uid:parent.uid,name:parent.name}).appendTo(base)});self.parentContent().html(base)})}else{self.parentBase().hide()}},getParents:$.memoize(function(key){return EasySocial.ajax('admin/controllers/regions/getParents',{type:key})}),validate:function(){return self.type().val()&&self.element.find('input[name="name"]').val()&&self.element.find('input[name="code"]').val()}}});module.resolve()})});EasySocial.module('admin/regions/init',function($){var module=this;EasySocial.Controller('Region.Init',{defaultOptions:{callback:function(){},'{startButton}':'[data-start]','{table}':'[data-table]','{tableBody}':'[data-table-body]','{row}':'[data-table-row]'}},function(self){return{init:function(){self.row().addController('EasySocial.Controller.Region.Init.Row')},'{startButton} click':function(el,ev){el.hide();self.table().show();self.counter=0;self.progress=$.Deferred().done(function(){self.options.callback()});self.process()},process:function(){var row=self.row().eq(self.counter);if(row.length===0){return self.progress.resolve()}
row.show();EasySocial.ajax('admin/controllers/regions/initialise',{key:row.data('key')}).done(function(){row.trigger('updateStatus',[1]);self.counter++;self.process()})}}});EasySocial.Controller('Region.Init.Row',{defaultOptions:{'{title}':'[data-row-title]','{status}':'[data-row-status]','{icon}':'[data-row-icon]'}},function(self){return{init:function(){},statuses:['label-danger','label-success','label-warning'],icons:['ies-warning-2','ies-checkmark','ies-wrench-3'],'{self} updateStatus':function(el,ev,state){var status=self.status(),icon=self.icon();for(i=0;i<3;i++){status.toggleClass(self.statuses[i],state==i);icon.toggleClass(self.icons[i],state==i)}}}});module.resolve()});EasySocial.module('admin/reports/reporters',function($){var module=this;EasySocial.Controller('Reports.Reporters',{defaultOptions:{"{item}":"[data-reporters-item]"}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.Reports.Reporters.Item,{"{parent}":self})}}});EasySocial.Controller('Reports.Reporters.Item',{defaultOptions:{"{removeItem}":"[data-remove-item]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{removeItem} click":function()
{self.parent.clearMessage();EasySocial.ajax('admin/controllers/reports/removeItem',{"id":self.options.id}).done(function(result)
{self.parent.setMessage(result.message,result.type);self.element.remove()})}}});module.resolve()});EasySocial.module('admin/reports/reports',function($){var module=this;EasySocial.require().language('COM_EASYSOCIAL_CANCEL_BUTTON','COM_EASYSOCIAL_CLOSE_BUTTON','COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE','COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE').done(function($)
{EasySocial.Controller('Reports',{defaultOptions:{"{item}":"[data-reports-item]"}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.Reports.Item)}}});EasySocial.Controller('Reports.Item',{defaultOptions:{"{action}":"[data-reports-item-view-actions]","{viewReports}":"[data-reports-item-view-reports]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.extension=self.element.data('extension');self.options.uid=self.element.data('uid');self.options.type=self.element.data('type')},"{viewReports} click":function()
{EasySocial.dialog({title:$.language('COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE'),content:EasySocial.ajax('admin/controllers/reports/getReporters',{id:self.options.id}),width:600,height:450})},"{action} click":function()
{EasySocial.dialog({title:$.language('COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE'),content:'<div>Perform some actions on the item</div>',width:500,height:250,buttons:[{name:$.language('COM_EASYSOCIAL_CLOSE_BUTTON'),classNames:"btn btn-es",click:function()
{EasySocial.dialog().close()}}]})}}})
module.resolve()})});EasySocial.module("admin/themes/compiler",function($){var module=this;$.fn.at=function(key){return this.find("[data-"+key.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase()+"]")}
$.template("easysocial/compiler/detail",'<tr class="[%= type %]"><td>[%= timestamp %]</td><td width="100%">[%= message %]</td></tr>');EasySocial.Controller("Themes.Compiler",{defaultOptions:{view:{detail:"compiler/detail"},"{section}":"[data-section]","{compileButton}":"[data-compile-button]","{minifyButton}":"[data-minify-button]","{buildButton}":"[data-build-button]","{filesButton}":"[data-files-button]","{purgeButton}":"[data-purge-button]","{resetButton}":"[data-reset-button]","{forceCompileButton}":"[data-force-compile-button]","{clearLogButton}":"[data-clear-log-button]","{toggleLogButton}":"[data-toggle-log-button]","{refreshButton}":"[data-refresh-button]","{refreshSectionButton}":"[data-refresh-section-button]","{buildWithoutMinifyButton}":"[data-build-without-minify-button]","{log}":"[data-log]","{details}":"[data-details]","{status}":"[data-status]","{imports}":"[data-imports]","{progress}":"[data-progress]","{progressBar}":"[data-progress-bar]","{progressStatus}":"[data-progress-status]","{tabItem}":".tab-item"}},function(self,opts,base){return{init:function(){self.location=base.data("location");self.name=base.data("name");self.override=base.data("override")},sections:function(){var sections=$.map(self.section(),function(section){var name=$(section).data("sectionName"),id=self.sectionId(name);return{id:id,name:name}});return sections},sectionId:function(sectionName){return self.location+'-'+self.name+'-'+sectionName},sectionTab:function(sectionName){return self.tabItem({"sectionId":self.sectionId(sectionName)}).find("> a")},sectionNameOf:function(el){var section=self.section.of(el),sectionName=section.data("sectionName");return sectionName},getLog:function(sectionName){if(sectionName)return self.section({"sectionName":sectionName}).at("log");return self.log(":first")},addLog:function(detail,sectionName){var log=self.getLog(sectionName),body=log.find("tbody");if($.isString(detail)){detail={timestamp:new Date(),message:detail,type:"info"}}
var type=detail.type;if(/warning|warn/.test(type))type='warning';if(/danger|error|failed|fail/.test(type))type='danger';if(/pending|default|primary/.test(type))type='';var timestamp=detail.timestamp,date=(timestamp instanceof Date)?timestamp:new Date(parseFloat(timestamp));timestamp=date.getHours()+':'+date.getMinutes()+":"+date.getSeconds();var message=detail.message;self.view.detail({type:type,timestamp:timestamp,message:message}).appendTo(body);body[0].scrollTop=body[0].scrollHeight},appendLog:function(details,sectionName){$.each(details,function(key,detail){self.addLog(detail,sectionName)})},clearLog:function(sectionName){var log=self.getLog(sectionName),body=log.find("tbody");body.empty();log.at("timeTotal").data("value",0).html("0s");log.at("memoryUsage").data("value",0).html("0mb")},generateLog:function(task,sectionName){self.clearLog(sectionName);self.appendLog(task.details,sectionName);var log=self.getLog(sectionName),timeTotalValue=parseFloat(task.time_total),timeTotalText=timeTotalValue.toFixed(2)+'s',memoryUsageValue=parseInt(task.mem_peak),memoryUsageText=(memoryUsageValue/^(?:input|select|textarea|keygen)/i1024).toFixed(2)+'mb';log.at("timeTotal").data("value",timeTotalValue).html(timeTotalText);log.at("memoryUsage").data("value",memoryUsageValue).html(memoryUsageText);self.addLog({type:(task.failed)?"danger":"success",timestamp:task.time_end,message:(task.failed)?"Task failed.":"Task completed.",},sectionName)},updateLog:function(task,sectionName){var log=self.getLog(sectionName),timeTotal=log.at("timeTotal"),memoryUsage=log.at("memoryUsage");self.appendLog(task.details,sectionName);var timeTotalValue=timeTotal.data("value")+parseFloat(task.time_total),timeTotalText=timeTotalValue.toFixed(2)+'s',memoryUsageValue=Math.max(memoryUsage.data("value"),parseInt(task.mem_peak)),memoryUsageText=(memoryUsageValue/^(?:input|select|textarea|keygen)/i1024).toFixed(2)+'mb';timeTotal.data("value",timeTotalValue).html(timeTotalText);memoryUsage.data("value",memoryUsageValue).html(memoryUsageText)},perform:function(task,options){return EasySocial.ajax("admin/controllers/themes/"+task,$.extend({location:self.location,name:self.name,override:self.override},options))},build:function(preset){var sections=self.sections(),preset=preset||'cache',minify=(preset=='cache'),i=0,length=sections.length-1,current=i+1,total=((length+1)*(minify?2:1))+1,max=100,failed=!1,log=self.log(":first"),progress=self.progress(":first"),progressBar=self.progressBar(":first"),progressStatus=self.progressStatus(":first"),updateProgress=function(){progressValue=(current++)/total*max;progressBar.show().width(progressValue+"%")},run=function(){var section=sections[i],sectionId=section.id,sectionName=section.name,sectionTab=self.sectionTab(sectionName);var message="Compiling section '"+sectionName+"'.";updateProgress();progressStatus.html(message);sectionTab.tab("show");self.compile(sectionName,{force:!0}).done(function(data){self.updateLog(data.task)}).fail(function(data){self.updateLog(data.task);failed=!0}).always(function(){if(!minify){nextSection()}else{var message="Minifying section '"+sectionName+"'.";updateProgress();progressStatus.html(message);self.minify(sectionName).done(function(data){self.updateLog(data.task)}).fail(function(data){self.updateLog(data.task);failed=!0}).always(function(){nextSection()})}})},nextSection=function(){if(length>i++)return run();build()},build=function(){progressStatus.html("Building stylesheets.");updateProgress();var task;self.perform("build",{preset:preset}).done(function(data){self.status(":first").replaceWith(data.status);task=data.task}).fail(function(data){task=data.task}).always(function(){if(!task){task={failed:!0,details:[],time_end:new Date()}}
self.updateLog(task);self.addLog({type:(task.failed)?"danger":"success",timestamp:task.time_end,message:(task.failed)?"Build failed.":"Build completed.",});progressStatus.html("Build completed!");progressBar.width("100%");base.removeClass("is-busy")})};progressBar.hide().width("0%");base.addClass("is-busy");self.clearLog();if(sections.length>0){self.addLog("Compiling all sections.");run()}else{build()}},minify:function(sectionName,options){var task=self.perform("minify",$.extend({section:sectionName},options));self.trigger("minify",[sectionName,task]);return task},"{self} minify":function(base,event,sectionName,task){var section=self.section({"sectionName":sectionName}),progressStatus=section.at("progressStatus"),progressBar=section.at("progressBar"),message="Minifying section '"+sectionName+"'.";section.addClass("is-busy");progressStatus.html(message);progressBar.hide().width("0%").show().width("100%");task.done(function(data){section.at("imports").replaceWith(data.imports);section.at("status").replaceWith(data.status);self.appendLog(data.task.details,sectionName);self.addLog({type:(task.failed)?"danger":"success",timestamp:data.task.time_end,message:(task.failed)?"Task failed.":"Task completed.",},sectionName)}).always(function(){section.removeClass("is-busy")})},compile:function(sectionName,options){var task=self.perform("compile",$.extend({section:sectionName},options));self.trigger("compile",[sectionName,task]);return task},"{self} compile":function(base,event,sectionName,task){var section=self.section({"sectionName":sectionName}),progressStatus=section.at("progressStatus"),progressBar=section.at("progressBar"),message="Compiling section '"+sectionName+"'.";section.addClass("is-busy");progressStatus.html(message);progressBar.hide().width("0%").show().width("100%");self.clearLog(sectionName);self.addLog(message,sectionName);task.done(function(data){section.at("imports").replaceWith(data.imports);section.at("status").replaceWith(data.status);self.generateLog(data.task,sectionName)}).fail(function(data){self.generateLog(data.task,sectionName)}).always(function(){section.removeClass("is-busy")})},purge:function(){var progress=self.progress(":first"),progressBar=self.progressBar(":first"),progressStatus=self.progressStatus(":first");base.addClass("is-busy");self.clearLog();progressBar.hide().width("0%").show().width("100%");progressStatus.html("Purging cache and log files.");self.perform("purge").done(function(task){self.generateLog(task)}).fail(function(task){}).always(function(){base.removeClass("is-busy")})},"{buildButton} click":function(buildButton){self.build('cache')},"{buildWithoutMinifyButton} click":function(){self.build('development')},"{compileAllButton} click":function(compilceAllButton){},"{compileButton} click":function(compileButton){var sectionName=self.sectionNameOf(compileButton);return self.compile(sectionName)},"{forceCompileButton} click":function(forceCompileButton){var sectionName=self.sectionNameOf(forceCompileButton);return self.compile(sectionName,{force:!0})},"{minifyButton} click":function(minifyButton){var sectionName=self.sectionNameOf(minifyButton);return self.minify(sectionName)},"{refreshButton} click":function(){base.addClass("is-busy");self.progressBar(":first").show().width("100%");self.progressStatus(":first").html("Refreshing");EasySocial.ajax("admin/views/themes/compiler",{location:self.location,name:self.name,override:self.override}).done(function(html){base.replaceWith(html)}).fail(function(){alert("Unable to refresh section.")}).always(function(){base.removeClass("is-busy")})},"{refreshSectionButton} click":function(refreshSectionButton){var sectionName=self.sectionNameOf(refreshSectionButton),section=self.section({"sectionName":sectionName});section.addClass("is-busy");section.at("progressStatus").html("Refreshing");EasySocial.ajax("admin/views/themes/section",{location:self.location,name:self.name,override:self.override,section:sectionName}).done(function(html){section.html(html)}).fail(function(){alert("Unable to refresh section.")}).always(function(){section.removeClass("is-busy")})},"{resetButton} click":function(){alert("TODO: Restore to factory default.")},"{purgeButton} click":function(){self.purge()}}});module.resolve()});EasySocial.module('admin/users/form',function($){var module=this;EasySocial.require().script('field').done(function($)
{EasySocial.Controller('Users.Form',{defaultOptions:{userid:null,mode:'adminedit',"{selectProfile}":"[data-user-select-profile]","{content}":"[data-user-new-content]","{profileTitle}":"[data-profile-title]","{fieldItem}":"[data-profile-adminedit-fields-item]","{tabnav}":"[data-tabnav]","{tabcontent}":"[data-tabcontent]","{stepnav}":"[data-stepnav]","{stepcontent}":"[data-stepcontent]",view:{loading:"site/loading/large"}}},function(self)
{return{init:function()
{window.selectedProfile=self.selectedProfile;self.fieldItem().addController('EasySocial.Controller.Field.Base',{userid:self.options.userid,mode:self.options.mode})},selectedProfile:function(profileId)
{EasySocial.dialog().close();window.location.href='index.php?option=com_easysocial&view=users&layout=form&profileId='+profileId},"{selectProfile} click":function()
{EasySocial.dialog({content:EasySocial.ajax('admin/views/profiles/browse')})},errorFields:[],'{fieldItem} error':function(el,ev){var id=el.data('id');if($.inArray(id,self.errorFields)<0){self.errorFields.push(id)}
var stepid=el.parents(self.stepcontent.selector).data('for');self.stepnav().filterBy('for',stepid).trigger('error');var tabid=el.parents(self.tabcontent.selector).data('for');self.tabnav().filterBy('for',tabid).trigger('error')},'{fieldItem} clear':function(el,ev){var fieldid=el.data('id');self.errorFields=$.without(self.errorFields,fieldid);var stepid=el.parents(self.stepcontent.selector).data('for');self.stepnav().filterBy('for',stepid).trigger('clear');var tabid=el.parents(self.tabcontent.selector).data('for');self.tabnav().filterBy('for',tabid).trigger('clear')},'{stepnav} error':function(el){el.addClass('error')},'{tabnav} error':function(el){el.addClass('error')},'{stepnav} clear':function(el){if(self.errorFields.length<1){el.removeClass('error')}},'{tabnav} clear':function(el){if(self.errorFields.length<1){el.removeClass('error')}},'{stepnav} click':function(el){var id=el.data('for');self.stepcontent().filterBy('for',id).find(self.fieldItem.selector).trigger('show')}}});module.resolve()})});EasySocial.module('admin/users/privacy',function($){var module=this;EasySocial.require().library('textboxlist').view('site/loading/small').done(function($){EasySocial.Controller('Profile.Privacy',{defaultOptions:{userId:'',"{privacyItem}":"[data-privacy-item]","{privacyForm}":"[data-profile-privacy-form]",view:{loading:"site/loading/small"}}},function(self)
{return{init:function()
{self.privacyItem().implement(EasySocial.Controller.Profile.Privacy.Item,{"{parent}":self})}}});EasySocial.Controller('Profile.Privacy.Item',{defaultOptions:{"{selection}":"[data-privacy-select]","{hiddenCustom}":"[data-hidden-custom]","{customForm}":"[data-privacy-custom-form]","{customTextInput}":"[data-textfield]","{customItems}":"input[]","{customHideBtn}":"[data-privacy-custom-hide-button]","{customInputItem}":"[data-textboxlist-item]","{customEditBtn}":"[data-privacy-custom-edit-button]"}},function(self)
{return{init:function()
{self.customTextInput().textboxlist({component:'es',unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:2,cache:!1,query:function(keyword){var users=self.getTaggedUsers();var ajax=EasySocial.ajax("site/views/privacy/getfriends",{q:keyword,userid:self.parent.options.userId,exclude:users});return ajax}}}});self.textboxlistLib=self.customTextInput().textboxlist("controller")},getTaggedUsers:function()
{var users=[];var items=self.customInputItem();if(items.length>0)
{$.each(items,function(idx,element){users.push($(element).data('id'))})}
return users},"{customTextInput} addItem":function(el,event,data){var ids=self.hiddenCustom().val();var values='';if(ids=='')
{values=data.id}
else{var idsArr=ids.split(',');idsArr.push(data.id);values=idsArr.join(',')}
self.hiddenCustom().val(values)},"{customTextInput} removeItem":function(el,event,data){var ids=self.hiddenCustom().val();var values='';var newIds=[];var idsArr=ids.split(',');for(var i=0;i<idsArr.length;i++)
{if(idsArr[i]!=data.id)
{newIds.push(idsArr[i])}}
if(newIds.length<=0)
{values=''}
else{values=newIds.join(',')}
self.hiddenCustom().val(values)},"{customEditBtn} click":function(el)
{self.customForm().toggle()},"{selection} change":function(el)
{var selected=el.val();if(selected=='custom')
{self.customForm().show();self.customEditBtn().show()}
else{self.customForm().hide();self.customEditBtn().hide()}
return},"{customHideBtn} click":function()
{self.customForm().hide();self.customEditBtn().show();self.textboxlistLib.autocomplete.hide();return}}});module.resolve()})});EasySocial.module('admin/users/users',function($){var module=this;EasySocial.require().library('expanding').done(function($)
{EasySocial.Controller('Users',{defaultOptions:{"{item}":"[data-user-item]"}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.Users.Item)}}});EasySocial.Controller('Users.Item',{defaultOptions:{"{insertLink}":"[data-user-item-insertLink]"}},function(self)
{return{init:function()
{self.options.name=self.element.data('name');self.options.avatar=self.element.data('avatar');self.options.email=self.element.data('email');self.options.id=self.element.data('id')},"{insertLink} click":function()
{self.trigger('userSelected',[self.options.id,self.options.name,self.options.avatar,self.options.email])}}});EasySocial.Controller('Users.Pending',{defaultOptions:{"{item}":"[data-pending-item]"}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.Users.Pending.Item)}}});EasySocial.Controller('Users.Pending.Item',{defaultOptions:{"{approve}":"[data-pending-approve]","{reject}":"[data-pending-reject]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{approve} click":function()
{EasySocial.dialog({content:EasySocial.ajax('admin/views/users/confirmApprove',{"id":self.options.id}),bindings:{"{approveButton} click":function()
{$('[data-users-approve-form]').submit()}}})},"{reject} click":function()
{EasySocial.dialog({content:EasySocial.ajax('admin/views/users/confirmReject',{"id":self.options.id})})}}})
module.resolve()})});EasySocial.module('admin/widgets/news',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('News',{defaultOptions:{loadOnInit:!0,"{news}":"[data-widget-news] > [data-widget-news-items]","{appNews}":"[data-widget-app-news] > [data-widget-news-items]","{placeholder}":"[data-widget-news-placeholder]"}},function(self){return{init:function()
{if(self.options.loadOnInit)
{self.getNews()}},getNews:function()
{EasySocial.ajax('admin/controllers/news/getnews').done(function(content,appsContent)
{self.news().append(content);self.appNews().append(appsContent);self.placeholder().remove()})}}});module.resolve()})});EasySocial.module("albums/album",function($){var module=this;EasySocial.require().library("tinyscrollbar").done(function(){EasySocial.Controller("Albums.Album",{defaultOptions:{"{title}":"[data-album-title]","{count}":"[data-album-count]","{privacy}":"[data-album-privacy]","{cover}":"[data-album-cover]","{coverImage}":"[data-album-cover-image]","{link}":"[data-album-link]","{menu}":"[data-album-menu]","{menuActions}":"[data-album-menu-actions]","{shareButton}":"[data-album-share-button]","{shareContent}":"[data-sharing]","{followButton}":"[data-album-follow-button]","{reportButton}":"[data-album-report-button]","{deleteButton}":"[data-album-delete-button]","{likeButton}":"[data-album-like-button]","{commentButton}":"[data-album-comment-button]","{countsButton}":"[data-album-counts-button]","{commentCount}":"[data-album-comment-count]","{likeCount}":"[data-album-like-count]","{actions}":"[data-item-actions]","{actionContent}":"[data-item-action-content]","{actionCloseButton}":"[data-item-action-close-button]","{actionsMenu}":"[data-item-actions-menu]","{likesHolder}":"[data-album-likes-holder]","{commentsHolder}":"[data-album-comments-holder]","{responseHolder}":"[data-album-response-holder]","{comments}":"[data-comments]"}},function(self){return{init:function()
{self.id=self.element.data("album-id");self.actionContent().tinyscrollbar();if(self.actions().hasClass("open")){self.loadResponse();self.element.addClass("show-all")}},remove:function()
{self.element.remove()},"{coverImage} click":function(){window.location=self.link().attr("href")},"{shareButton} click":function()
{self.shareContent().show()},"{deleteButton} click":function()
{EasySocial.dialog({content:EasySocial.ajax("site/views/albums/confirmDelete",{id:self.id})})},like:function(){EasySocial.ajax("site/controllers/albums/like",{id:self.id}).done(function(like){self.likeCount().html(like.count);if(like.state)
{self.likeButton().addClass("liked")}
else{self.likeButton().removeClass("liked")}
self.likesHolder().html(like.html)})},loadResponse:function(){var loader=self.loadResponse.loader;if(!loader||loader.state()=="rejected"){self.loadResponse.loader=EasySocial.ajax("site/views/albums/response",{id:self.id}).done(function(html){self.responseHolder().html(html);self.actionContent().removeClass("loading").tinyscrollbar_update()})}},getButton:function(toggle){var toggle=$(toggle),countsButton=self.countsButton(),commentButton=self.commentButton();if(toggle.is(countsButton)||toggle.parents().filter(countsButton).length>0){return countsButton}
if(toggle.is(commentButton)||toggle.parents().filter(commentButton).length>0)
return commentButton;return $()},lastButton:$(),"{actions} shown.bs.dropdown":function(actions,event,toggle){self.loadResponse();self.element.addClass("show-all");var actionContent=self.actionContent(),button=self.lastButton=self.getButton(toggle),offset=(button.position().left+(button.width()/2))-(actionContent.width()/2);actionContent.css("margin-left",offset).tinyscrollbar_update()},"{actions} hide.bs.dropdown":function(actions,event,toggle){self.element.removeClass("show-all");var button=self.getButton(toggle),lastButton=self.lastButton;if(!button.is(lastButton)){setTimeout(function(){button.trigger("click")},0)}},"{actionCloseButton} click":function(el){self.hideActionContent()},"{likeButton} click":function(){self.like()},"{comments} newCommentSaved":function(){var stat=self.comments().controller("EasySocial.Controller.Comments.Stat");self.commentCount().html(stat.total());self.actionContent().tinyscrollbar_update("bottom")},"{comments} commentDeleted":function(){var stat=self.comments().controller("EasySocial.Controller.Comments.Stat");self.commentCount().html(stat.total());self.actionContent().tinyscrollbar_update()},"{actionsMenu} shown.bs.dropdown":function(){self.element.addClass("show-all")},"{actionsMenu} hidden.bs.dropdown":function(){self.element.removeClass("show-all")}}});module.resolve()})});EasySocial.module("albums/browser",function($){var module=this;EasySocial.require().library("history").view("site/albums/browser.list.item").done(function(){EasySocial.Controller("Albums.Browser",{hostname:"browser",defaultOptions:{view:{listItem:"site/albums/browser.list.item"},itemRenderOptions:{},"{sidebar}":"[data-album-browser-sidebar]","{content}":"[data-album-browser-content]","{createAlbumButton}":"[data-album-create-button]","{createAlbumButtonLink}":"[data-album-create-button] > a","{listItemGroup}":"[data-album-list-item-group]","{listItemRegularGroup}":"[data-album-list-item-group=regular]","{listItemCoreGroup}":"[data-album-list-item-group=core]","{listItem}":"[data-album-list-item]","{listItemLink}":"[data-album-list-item] > a","{listItemTitle}":"[data-album-list-item-title]","{listItemCover}":"[data-album-list-item-cover]","{listItemCount}":"[data-album-list-item-count]","{albumItem}":"[data-album-item]","{photoBrowser}":"[data-photo-browser]"}},function(self){return{init:function(){self.albumItem().each(function(){self.addSubscriber($(this).controller("EasySocial.Controller.Albums.Item"))})},setLayout:function(layout){if(self.element.hasClass("layout-dialog"))return;self.element.data("layout",layout).switchClass("layout-"+layout)},open:function(view){var args=$.makeArray(arguments);self.trigger("contentload",args);var method="view"+$.String.capitalize(view),loader=self[method].apply(self,args.slice(1));loader.done(self.displayContent(function(){self.trigger("contentdisplay",args);return arguments})).fail(function(){self.trigger("contentfail",args)}).always(function(){self.trigger("contentcomplete",args)});return loader},"{self} contentdisplay":function(el,event,view){if(/album|albumform/gi.test(view)){self.setLayout("album")}
if(/photo/gi.test(view)){self.setLayout("photo")}},displayContent:$.Enqueue(function(html){var scripts=[],content=$($.buildFragment([html],document,scripts));self.content().html(content);$(scripts).remove()}),viewAlbum:function(albumId){self.listItem().removeClass("active loading");var listItem=self.getListItem(albumId).addClass("active loading");if(self.element.data("layout")!=="dialog"){listItem.find("> a").route()}
var loader=EasySocial.ajax("site/views/albums/item",{id:albumId,renderOptions:self.options.itemRenderOptions}).fail(function(){}).always(function(){listItem.removeClass("loading")});return loader},viewAlbumForm:function()
{var listItems=self.listItem().removeClass("active loading"),listItem=self.view.listItem({}).addClass("active loading new").prependTo(self.listItemRegularGroup());var loader=EasySocial.ajax("site/views/albums/form",{"uid":self.options.uid,"type":self.options.type}).fail(function(){}).always(function(){listItem.removeClass("loading")});return loader},viewPhoto:function(photoId){var loader=EasySocial.ajax("site/views/photos/item",{id:photoId,browser:1}).fail(function(){}).always(function(){});return loader},"{listItem} click":function(listItem){if(listItem.hasClass("new"))return;var albumId=listItem.data("albumId");self.open("Album",albumId)},"{listItemLink} click":function(listItemLink,event){event.preventDefault();listItemLink.blur()},"{createAlbumButton} click":function(){self.open("AlbumForm");if(self.element.data("layout")!=="dialog"){self.createAlbumButtonLink().route()}},"{createAlbumButtonLink} click":function(el,event){event.preventDefault()},"{albumItem} init.albums.item":function(el,event,albumItem){self.addSubscriber(albumItem)},getListItem:function(albumId,context){var listItem=(!albumId)?self.listItem(".new"):self.listItem().filterBy("albumId",albumId);if(!context)return listItem;return listItem.find(self["listItem"+$.String.capitalize(context)].selector)},updateListItemCount:function(albumId,val,append){var stat=self.getListItem(albumId,"count");if(stat.length<0)return;var statCount;if(append){statCount=(parseInt(stat.text())||0)+(parseInt(val)||0)}else{statCount=val}
if(statCount<0)statCount=0;stat.text(statCount)},"{albumItem} albumSave":function(el,event,task)
{task.done(function(album)
{self.getListItem().attr("data-album-id",album.id).removeClass("new")
self.getListItem(album.id).find("> a").attr({href:album.permalink,title:album.title}).route();self.getListItem(album.id,"title").html(album.title)})},"{albumItem} titleChange":function(el,event,title,album){self.getListItem(album.id,"title").html($.trim(title)||"&nbsp;")},"{albumItem} coverChange":function(el,event,photo,album){self.getListItem(album.id,"cover").css("backgroundImage",$.cssUrl(photo.sizes.thumbnail.url))},"{albumItem} coverRemove":function(el,event,album){self.getListItem(album.id,"cover").css("backgroundImage","")},"{albumItem} photoAdd":function(el,event,photoItem,photoData,album){self.updateListItemCount(album.id,1,!0)},"{albumItem} photoMove":function(el,event,task,photo){task.done(function(){self.updateListItemCount(photo.album.id,-1,!0)})},"{albumItem} photoDelete":function(el,event,task,photo){task.done(function(){self.updateListItemCount(photo.album.id,-1,!0)})},"{photoBrowser} init.photos.browser":function(el,event,photoBrowser){self.addSubscriber(photoBrowser)},"{self} contentload":function(){self.listItem(".new").remove()}}});module.resolve()})});EasySocial.module("albums/editor",function($){var module=this;var photoEditorController="EasySocial.Controller.Photos.Editor"
EasySocial.require().script("albums/editor/sortable","albums/editor/uploader").done();var Controller=EasySocial.Controller("Albums.Editor",{hostname:"editor",defaultOptions:{view:{uploadItem:"site/albums/upload.item"},canReorder:!1,canUpload:!0,"{titleField}":"[data-album-title-field]","{captionField}":"[data-album-caption-field]","{coverField}":"[data-album-cover-field]","{type}":"[data-album-type]","{uid}":"[data-album-uid]","{location}":"[data-album-location]","{locationCaption}":"[data-album-location-caption]","{addLocationButton}":"[data-album-addLocation-button]","{date}":"[data-album-date]","{dateCaption}":"[data-album-date-caption]","{addDateCaption}":"[data-album-addDate-button]","{privacy}":"[data-album-privacy]","{uploadButton}":"[data-album-upload-button]","{deleteButton}":"[data-album-delete-button]","{moreButton}":"[data-album-more-button]","{privacy}":"[data-privacy-hidden]","{privacycustom}":"[data-privacy-custom-hidden]","{uploadItem}":"[data-photo-upload-item]","{dateDay}":"[data-date-day]","{dateMonth}":"[data-date-month]","{dateYear}":"[data-date-year]","{editButton}":"[data-album-edit-button]","{editButtonLink}":"[data-album-edit-button] > a","{doneButton}":"[data-album-done-button]","{doneButtonLink}":"[data-album-done-button] > a","{cancelButton}":"[data-album-cancel-button]","{cancelButtonLink}":"[data-album-cancel-button] > a","{locationWidget}":".es-album-location-form .es-location","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]"}},function(self){return{init:function(){self.id=self.element.data("album-id");var options=self.options;if(options.canReorder){EasySocial.module("albums/sortable").done(function(SortableController){self.addPlugin("sortable",SortableController)})}
if(options.canUpload){EasySocial.module("albums/editor/uploader").done(function(UploaderController){self.uploader=self.addPlugin("uploader",UploaderController)})}
if(self.id){self.createAlbum.task=$.Deferred().resolve();self.createStream=0}else{self.createStream=1}},data:function(){var title=self.titleField().val(),caption=self.captionField().val(),date=self.formatDate(),address=self.locationCaption().html(),latitude=self.latitude().val(),longitude=self.longitude().val(),privacy=self.privacy().val(),privacycustom=self.privacycustom().val();uid=self.element.data('album-uid');type=self.element.data('album-type');return{id:self.id,uid:uid,type:type,title:title,caption:caption,date:date,address:address,latitude:latitude,longitude:longitude,privacy:privacy,privacycustom:privacycustom,createStream:self.createStream}},createAlbum:function(){var task=self.createAlbum.task;if(!task){task=self.createAlbum.task=self.save({createStream:0}).done(function(album){self.deleteButton().disabled(!1);self.element.attr("data-album-id",self.id=album.id)}).fail(function(message,type){self.setMessage(message,type)})}
return task},save:function(options){self.trigger("beforeAlbumSave",[self]);var data=$.extend(self.data(),options);data.photos=$.map(self.album.photoItem(),function(photoItem,i){var editor=$(photoItem).controller("EasySocial.Controller.Photos.Editor");return(editor)?editor.data():null});self.clearMessage();var task=EasySocial.ajax("site/controllers/albums/store",data);self.trigger("albumSave",[task,self]);return task},"{self} photoAdd":function(el,event,photoItem,photoData){if(self.album.photoItem().length<=1){self.changeCover(photoData)}},setCover:function(photoId){var task=EasySocial.ajax("site/controllers/albums/setCover",{albumId:self.id,coverId:photoId}).done(function(photo){self.changeCover(photo)}).fail(function(){});return task},removeCover:function(){self.trigger("coverRemove",[self.album])},changeCover:function(photo){self.trigger("coverChange",[photo,self])},"{self} coverChange":function(el,event,photo){self.coverField().removeClass("no-cover").css("backgroundImage",$.cssUrl(photo.sizes.thumbnail.url))},"{self} coverRemove":function(){self.coverField().addClass("no-cover").css("backgroundImage","")},"{editButton} click":function(){self.album.setLayout("form");self.editButtonLink().route()},"{editButtonLink} click":function(editButtonLink,event){event.preventDefault()},"{cancelButton} click":function(){self.album.setLayout("item");self.cancelButtonLink().route()},"{cancelButtonLink} click":function(editButtonLink,event){event.preventDefault()},"{doneButton} click":function(el,event){self.doneButtonLink().addClass('btn-loading');self.save().done(function(album,html){self.doneButtonLink().removeClass('btn-loading');$.buildHTML(html).replaceAll(self.element)}).progress(function(message,type){self.setMessage(message,type)})},"{doneButtonLink} click":function(doneButtonLink,event){event.preventDefault()},"{deleteButton} click":function(deleteButton){if(deleteButton.disabled())return;EasySocial.dialog({content:EasySocial.ajax("site/views/albums/confirmDelete",{id:self.id})})},formatDate:function(){var day=self.dateDay().val()||self.dateDay().data('date-default'),month=self.dateMonth().val()||self.dateMonth().data('date-default'),year=self.dateYear().val()||self.dateYear().data('date-default');return year+'-'+month+'-'+day},updateDate:function(){self.date().addClass("has-data");var dateCaption=self.dateDay().val()+' '+$.trim(self.dateMonth().find(":selected").html())+' '+self.dateYear().val();self.dateCaption().html(dateCaption)},"{dateDay} keyup":function(){self.updateDate()},"{dateMonth} change":function(){self.updateDate()},"{dateYear} keyup":function(){self.updateDate()},"{titleField} keyup":function(titleField){self.trigger("titleChange",[titleField.val(),self])},"{locationWidget} locationChange":function(el,event,location){var address=location.formatted_address;self.locationCaption().html(address);self.location().addClass("has-data")}}});module.resolve(Controller)});EasySocial.module("albums/editor/sortable",function($){var module=this;EasySocial.require().library("ui/sortable").done(function(){var Controller=EasySocial.Controller("Albums.Editor.Sortable",{defaultOptions:{}},function(self){return{init:function(){return;self.photoItemGroup().sortable({forcePlaceholderSize:!0,items:self.photoItem.selector,placeholder:'es-photo-item placeholder',tolerance:'pointer',delay:150})},getPhotoOrdering:function(){var ordering={};self.photoItem().each(function(i){var id=$(this).data("photoId");ordering[id]=i});return ordering},"{parent.photoItemGroup} sortstart":function(el,event,ui){ui.item.addClass("dragging");el.addClass("ordering");self.setLayout()},"{parent.photoItemGroup} sortchange":function(el,event,ui){self.setLayout()},"{parent.photoItemGroup} sortstop":function(el,event,ui){ui.item.removeClass("dragging");el.removeClass("ordering");self.setLayout();EasySocial.ajax("site/controllers/photos/reorder",{id:ui.item.controller().id,order:ui.item.index()})}}});module.resolve(Controller)})});EasySocial.module("albums/editor/uploader",function($){var module=this;EasySocial.require().script("albums/uploader").view("site/albums/upload.item").done(function(){var Controller=EasySocial.Controller("Albums.Editor.Uploader",{defaultOptions:{}},function(self){return{init:function(){self.album=self.editor.album;var settings=self.album.options.uploader;self.uploader=self.addPlugin("uploader",EasySocial.Controller.Albums.Uploader,{settings:settings,"{uploadButton}":self.editor.uploadButton.selector,"{uploadItemGroup}":self.album.photoItemGroup.selector,"{uploadDropsite}":self.album.content.selector})},setLayout:function(){self.album.setLayout_()},"{self} beforeAlbumSave":function(){self.uploader.stop()},"{self} albumSave":function(el,event,task){task.done(function(album){var url=$.uri(self.uploader.settings("url")).replaceQueryParam("albumId",album.id).toString();self.uploader.settings("url",url)})},"{self} layoutChange":function(el,event,layoutName){self.uploader.stop();self.uploader.clear();var url=$.uri(self.uploader.settings("url")).replaceQueryParam("createStream",layoutName=="form"?0:1).replaceQueryParam("layout",layoutName).toString();self.uploader.settings("url",url)},"{self} QueueCreated":function(el,event,uploadItem){if(self.album.currentLayout()=="form"){uploadItem.element.addClass("layout-form")}
self.setLayout()},startUpload:$.Enqueue(),"{uploader} FilesAdded":function(el,event,uploader,files){if(!self.id){self.editor.createAlbum().done(self.startUpload(function(){self.uploader.start()}))}else{self.uploader.start()}
self.setLayout()},"{uploader} FilesRemoved":function(){self.setLayout()},"{uploader} FileUploaded":function(el,event,uploader,file,response){var uploadItem=self.uploader.getItem(file),photoItem=$.buildHTML(response.html),photoData=response.data;photoItem.addClass("new-item").insertAfter(uploadItem.element);setTimeout(function(){photoItem.removeClass("new-item")},1);self.uploader.removeItem(file.id);self.trigger("photoAdd",[photoItem,photoData,self.album]);self.setLayout()}}});module.resolve(Controller)})});EasySocial.module("albums/uploader",function($){var module=this;EasySocial.require().library("plupload").script("albums/uploader.item").view("site/albums/upload.item").done(function(){EasySocial.Controller("Albums.Uploader",{defaultOptions:{view:{uploadItem:"site/albums/upload.item"},direction:'prepend',"{uploadButton}":"[data-upload-button]","{uploadItemGroup}":"[data-upload-item-group]","{uploadItem}":"[data-upload-item]","{uploadDropsite}":"[data-upload-dropsite]"}},function(self,opts,base){return{init:function(){var uploader=self.element;self.pluploadController=self.element.addController("plupload",$.extend({"{uploadButton}":self.uploadButton.selector,"{uploadDropsite}":self.uploadDropsite.selector},self.options.settings));self.plupload=self.pluploadController.plupload;if(!$.IE&&self.plupload.runtime=="html5"){uploader.addClass("can-drop-file")}
uploader.addClass("can-upload")},setLayout:function(){self.uploadItemGroup().toggleClass("no-upload-items",self.uploadItem().length<1)},items:{},getItem:function(file){var id;if($.isString(file))id=file;if(file&&file.id)id=file.id;return self.items[id]},createItem:function(file){var item=self.view.uploadItem({file:file}).addController("EasySocial.Controller.Albums.Uploader.Item",{"{uploader}":self,file:file});item.element[opts.direction=='append'?'appendTo':'prependTo'](self.uploadItemGroup());self.items[file.id]=item;self.setLayout();self.trigger("QueueCreated",[item]);return item},settings:function(key,val){var settings=self.plupload.settings;if(val!==undefined){settings[key]=val}
return(key)?settings[key]:settings},start:function(){return self.plupload.start()},stop:function(){return self.plupload.stop()},"{self} FilesAdded":function(el,event,uploader,files){try{files.reverse();$.each(files,function(i,file){if(self.getItem(file))return;self.createItem(file)})}catch(e){console.error(e)}},"{self} BeforeUpload":function(el,event,uploader,file){var item=self.getItem(file);if(!item)return;item.setState("preparing")},"{self} UploadFile":function(el,event,uploader,file){var item=self.getItem(file);if(!item)return;item.setState("uploading")},"{self} UploadProgress":function(el,event,uploader,file){var item=self.getItem(file);if(!item)return;item.setState("uploading");item.setProgress()},"{self} FileUploaded":function(el,event,uploader,file,response){var item=self.getItem(file);if(!item)return;if(!$.isPlainObject(response)){item.setState("failed");return}
item.setState("done")},"{self} FileError":function(el,event,uploader,file,response){var item=self.getItem(file);if(!item)item=self.createItem(file);item.setState("failed");item.setMessage(response.message)},"{self} Error":function(el,event,uploader,error){if(error.file){var file=error.file,item=self.getItem(file);if(!item)item=self.createItem(file);item.setState("failed");item.setMessage(error.message)}},removeItem:function(id){var item=self.getItem(id);if(!item)return;self.plupload.removeFile(item.file());item.element.remove();delete self.items[id];self.setLayout()},clear:function(id){$.each(self.items,function(id,item){self.plupload.removeFile(item.file());item.element.remove();delete self.items[id]});self.items={}}}});module.resolve()})});EasySocial.module("albums/uploader.item",function($){var module=this;EasySocial.Controller("Albums.Uploader.Item",{defaultOptions:{"{status}":".upload-status","{filename}":".upload-filename","{progressBar}":".upload-progress-bar","{percentage}":".upload-percentage","{filesizeTotal}":".upload-filesize-total","{filesizeLeft}":".upload-filesize-left","{details}":".upload-details","{detailsButton}":".upload-details-button","{removeButton}":".upload-remove-button","{message}":".upload-message"}},function(self){return{init:function(){self.id=self.element.attr("id");var file=self.file();self.filename().html(file.name);self.setState("pending");self.setProgress();var html4=self.uploader.plupload.runtime=="html4";if($.IE<10||html4){self.element.addClass("indefinite-progress")}
if(html4){self.element.addClass("no-filesize")}},file:function(){var file=self.uploader.plupload.getFile(self.id)||self.options.file;if(file){var noFilesize=(file.size===undefined||file.size=="N/A");file.percentage=file.percent+"%";file.filesize=(noFilesize)?"":$.plupload.formatSize(file.size);file.remaining=(noFilesize)?"":$.plupload.formatSize(file.size-(file.loaded||0))}
return file},setProgress:function(){var file=self.file(),percentage=file.percentage;if(percentage=="100%")percentage="99%";if(percentage=="0%")percentage="1%";self.progressBar().width(percentage);self.percentage().html(percentage);self.filesizeTotal().html(file.filesize);self.filesizeLeft().html(file.remaining)},setState:function(state){self.element.removeClass("pending preparing uploading failed done").addClass(state);self.state=state},setMessage:function(message){self.detailsButton().attr("data-popbox",message)},"{removeButton} click":function(el,event){self.uploader.removeItem(self.id)}}});module.resolve()});EasySocial.module("albums/item",function($){var module=this;EasySocial.require().script("albums/editor").done();EasySocial.require().library("masonry").done(function(){EasySocial.Controller("Albums.Item",{hostname:"album",defaultOptions:{tilesPerRow:4,editable:!1,multipleSelection:!1,"{header}":"[data-album-header]","{content}":"[data-album-content]","{footer}":"[data-album-footer]","{info}":"[data-album-info]","{title}":"[data-album-title]","{caption}":"[data-album-caption]","{location}":"[data-album-location]","{date}":"[data-album-date]","{cover}":"[data-album-cover]","{photoItemGroup}":"[data-photo-item-group]","{photoItem}":"[data-photo-item]","{photoImage}":"[data-photo-image]","{photoImageCss}":"[data-photo-image-css]","{featuredItem}":"[data-photo-item].featured","{featuredImage}":"[data-photo-item].featured [data-photo-image]","{featuredImageCss}":"[data-photo-item].featured [data-photo-image-css]","{uploadItem}":"[data-photo-upload-item]","{moreButton}":"[data-album-more-button]","{viewButton}":"[data-album-view-button]","{share}":"[data-repost-action]","{likes}":"[data-likes-action]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{counterBar}":"[data-stream-counter]"}},function(self){return{init:function()
{self.id=self.element.data("album-id");self.nextStart=self.element.data("album-nextstart")||-1;if(self.options.editable)
{EasySocial.module("albums/editor").done(function(EditorController)
{self.editor=self.addPlugin("editor",EditorController)})}
self.setLayout();setTimeout(function(){self.content().addClass("ready")},1);self.addSubscriber(self.photoItem().controllers("EasySocial.Controller.Photos.Item"))},"{window} resize":$.debounce(function(){self.setLayout()},250),currentLayout:function(){return self.element.data("albumLayout")},setLayout_:$.debounce(function(){self.setLayout()},100),setLayout:function(layoutName){var photoItemGroup=self.photoItemGroup(),currentLayout=self.currentLayout(),layoutName=layoutName||currentLayout,seed=self.setLayout.seed,intact=(seed==photoItemGroup.width()&&currentLayout==layoutName)
hasPhotoItem=self.photoItem().length>0,hasUploadItem=self.uploadItem().length>0,hasItem=hasPhotoItem||hasUploadItem,masonry=photoItemGroup.data("masonry"),layout={currentLayout:currentLayout,seed:seed,intact:intact,hasPhotoItem:hasPhotoItem,hasUploadItem:hasUploadItem,hasItem:hasItem,masonry:masonry};if(!intact){self.element.data("albumLayout",layoutName).switchClass("layout-"+layoutName);self.photoItem().switchClass("layout-"+layoutName);self.setLayout.seed=layout.seed=null;self.trigger("layoutChange",[layoutName,layout])}
self.element.toggleClass("has-photos",hasItem);if(!hasItem){photoItemGroup.css("opacity",1)}
var layoutHandler="set"+$.String.capitalize(layoutName)+"Layout";self[layoutHandler](layout);self.setLayout.seed=photoItemGroup.width()},setItemLayout:function(layout){self.photoItem().attr("data-es-photo-disabled",0);if(layout.intact){layout.masonry&&layout.masonry.reload()}else{var tilesPerRow=4;if($(".es-main").hasClass("w600")){tilesPerRow=2}
if($(".es-main").hasClass("w320")){tilesPerRow=1}
var photoItemGroup=self.photoItemGroup(),photoItem=self.photoItem(),tilesPerRow=tilesPerRow,viewportWidth=photoItemGroup.width(),containerWidth=Math.floor(viewportWidth/tilesPerRow)*tilesPerRow,tileWidth=containerWidth/tilesPerRow,tileHeight=tileWidth,itemWidth=tileWidth,itemHeight=tileHeight,imageWidth=itemWidth,imageHeight=itemHeight;if(tilesPerRow>=4){var featuredItemWidth=tileWidth*2;var featuredItemHeight=tileHeight*2}else{var featuredItemWidth=itemWidth;var featuredItemHeight=itemHeight}
var featuredImageWidth=featuredItemWidth;var featuredImageHeight=featuredItemHeight;self.photoItem.css({width:itemWidth,height:itemHeight});self.featuredItem.css({width:featuredItemWidth,height:featuredItemHeight});self.uploadItem.css({width:itemWidth,height:itemHeight});photoItemGroup.masonry({columnWidth:tileWidth,isRTL:self.options.rtl});setTimeout(function(){photoItemGroup.addTransitionClass("no-transition").masonry("reload")},1)}},setFormLayout:function(layout){self.photoItem().attr("data-es-photo-disabled",1);layout.masonry&&layout.masonry.destroy();self.clearLayout()},setDialogLayout:function(){self.photoItem().attr("data-es-photo-disabled",1);layout.masonry&&layout.masonry.destroy();self.clearLayout()},setThumbnailLayout:function(){},setRowLayout:function(){self.photoItem().attr("data-es-photo-disabled",0);self.clearLayout()},clearLayout:function(){self.photoItemGroup().addClass("no-transition");self.photoItem.css().remove();self.photoImage.css().remove();self.photoImageCss.css().remove();self.featuredItem.css().remove();self.featuredImage.css().remove();self.featuredImageCss.css().remove();self.uploadItem.css().remove();self.setLayout.seed=null},getSelectedItems:function(){var selectedPhotos=self.photoItem(".selected");var data=[];selectedPhotos.each(function(i,photo){data.push($(photo).controller("EasySocial.Controller.Photos.Item").data())});return data},"{photoItem} init.photos.item":function(el,event,photoItem){self.addSubscriber(photoItem)},"{photoItem} destroyed":function(){self.setLayout()},"{photoItem} activate":function(photoItem,event,photo){if(!photo)return;var currentLayout=self.currentLayout();switch(currentLayout){case "item":case "row":photoItem.addClass("loading");if(self.browser){self.browser.open("photo",photo.id).always(function(){photoItem.removeClass("loading")});photo.imageLink().route()}else{window.location=photo.imageLink().attr("href")}
break;case "form":break;case "dialog":var selectedPhotos=self.photoItem(".selected");if(!self.options.multipleSelection){var selected=photoItem.hasClass("selected");selectedPhotos.removeClass("selected");photoItem.toggleClass("selected",!selected)}else{photoItem.toggleClass("selected")}
break}},"{photoItem} photoFeature":function(el,event,task,photo,featured){self.setLayout();task.fail(function(){self.setLayout()})},"{photoItem} photoMove":function(el,event,task,photo,targetAlbumId){self.clearMessage();task.done(function(){photo.element.remove();self.setLayout();if(self.photoItem().length<1){self.trigger("coverRemove",[self])}}).fail(function(message,type){self.setMessage(message,type)})},"{photoItem} photoDelete":function(el,event,task,photo){self.clearMessage();task.done(function(){photo.element.remove();self.setLayout();if(self.photoItem().length<1){self.trigger("coverRemove",[self])}}).fail(function(message,type){self.setMessage(message,type)})},"{self} albumSave":function(el,event,task){task.done(function(album){self.id=album.id})},"{self} coverChange":function(el,event,photo,album){self.cover().css("backgroundImage",$.cssUrl(photo.sizes.thumbnail.url))},"{self} coverRemove":function(){self.cover().css("backgroundImage","")},"{viewButton} click":function(viewButton,event){if(self.browser)
{event.preventDefault();self.element.addClass("loading");self.browser.open("Album",self.id)}},"{moreButton} click":function(moreButton){if(self.nextStart==-1){return}
if(moreButton.disabled())return;moreButton.disabled(!0);EasySocial.ajax("site/controllers/albums/loadMore",{albumId:self.id,start:self.nextStart,layout:self.currentLayout()}).done(function(htmls,nextStart){self.nextStart=nextStart;var photoItemGroup=self.photoItemGroup();$.each(htmls,function(i,html){$.buildHTML(html).appendTo(photoItemGroup)});if(nextStart<0)moreButton.hide();self.setLayout()}).always(function(){moreButton.disabled(!1)})},"{share} create":function(el,event,itemHTML){self.counterBar().removeClass('hide')},"{likes} onLiked":function(el,event,data){self.counterBar().removeClass('hide')},"{likes} onUnliked":function(el,event,data){var isLikeHide=self.likeContent().hasClass('hide');var isRepostHide=self.repostContent().hasClass('hide');if(isLikeHide&&isRepostHide)
{self.counterBar().addClass('hide')}}}});module.resolve()})});EasySocial.module('apps/event/discussions',function($){var module=this;EasySocial.Controller('Events.Item.Discussions',{defaultOptions:{"{filter}":"[data-event-discussions-filter]","{contents}":"[data-event-discussion-contents]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},setContent:function(html)
{self.contents().removeClass('is-loading');self.contents().html(html)},setActiveFilter:function(el)
{self.filter().removeClass('active');el.addClass('active')},"{filter} click":function(el,event)
{var filter=el.data('filter');self.contents().html('&nbsp;').addClass('is-loading');self.setActiveFilter(el);EasySocial.ajax('apps/event/discussions/controllers/discussion/getDiscussions',{"id":self.options.id,"filter":filter}).done(function(contents,empty)
{if(empty)
{self.contents().addClass('is-empty')}
else{self.contents().removeClass('is-empty')}
self.setContent(contents)})}}});EasySocial.Controller('Events.Item.Discussion',{defaultOptions:{"{form}":"[data-reply-form]","{list}":"[data-reply-list]","{replies}":"[data-reply-item]","{repliesWrap}":"[data-replies-wrapper]","{replyCounter}":"[data-reply-count]","{lock}":"[data-discussion-lock]","{unlock}":"[data-discussion-unlock]","{delete}":"[data-discussion-delete]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.eventId=self.element.data('eventid');self.implementReply(self.replies());self.form().implement(EasySocial.Controller.Events.Item.Discussion.Form,{"{parent}":self})},implementReply:function()
{self.replies().implement(EasySocial.Controller.Events.Item.Discussion.Reply,{"{parent}":self})},insertReply:function(html)
{self.element.removeClass('is-unanswered');self.repliesWrap().removeClass('is-empty');self.list().append(html);self.implementReply()},updateReplyCounter:function(total)
{if(total==0)
{self.repliesWrap().addClass('is-empty')}
self.replyCounter().html(total)},setResolved:function()
{self.element.addClass('is-resolved')},"{unlock} click":function(el,event)
{EasySocial.ajax('apps/event/discussions/controllers/discussion/unlock',{"id":self.options.id}).done(function(){self.element.removeClass('is-locked')})},"{delete} click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('apps/event/discussions/controllers/discussion/confirmDelete',{"id":self.options.id,"eventId":self.options.eventId})})},"{lock} click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('apps/event/discussions/controllers/discussion/confirmLock'),bindings:{"{lockButton} click":function()
{EasySocial.ajax('apps/event/discussions/controllers/discussion/lock',{"id":self.options.id}).done(function()
{EasySocial.dialog().close();self.element.addClass('is-locked')})}}})}}});EasySocial.Controller('Events.Item.Discussion.Reply',{defaultOptions:{"{acceptAnswer}":"[data-reply-accept-answer]","{delete}":"[data-reply-delete]","{edit}":"[data-reply-edit]","{cancelEdit}":"[data-reply-edit-cancel]","{update}":"[data-reply-edit-update]","{textarea}":"[data-reply-content]","{content}":"[data-reply-display-content]","{alertDiv}":"div.alert-error"}},function(self)
{return{init:function()
{console.log(self.element)
self.options.id=self.element.data('id')},"{acceptAnswer} click":function()
{EasySocial.ajax('apps/event/discussions/controllers/reply/accept',{"id":self.options.id}).done(function(){self.parent.setResolved()})},cancelEditing:function()
{self.element.removeClass('is-editing')},"{cancelEdit} click":function()
{self.cancelEditing()},"{edit} click":function()
{self.element.addClass('is-editing')},"{update} click":function()
{var content=self.textarea().val();if(content==''){self.element.addClass('is-empty');self.alertDiv().show();return!1}
EasySocial.ajax('apps/event/discussions/controllers/reply/update',{"id":self.options.id,"eventId":self.parent.options.eventId,"content":content}).done(function(content){self.content().html(content);self.element.removeClass('is-empty');self.alertDiv().hide();self.cancelEditing()})},"{delete} click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/event/discussions/controllers/reply/confirmDelete',{"id":self.options.id}),bindings:{"{deleteButton} click":function()
{EasySocial.ajax('apps/event/discussions/controllers/reply/delete',{"id":self.options.id}).done(function(discussion){self.parent.updateReplyCounter(discussion.total_replies);EasySocial.dialog().close();self.element.remove()})}}})}}});EasySocial.Controller('Events.Item.Discussion.Form',{defaultOptions:{"{textarea}":"[data-reply-content]","{submitReply}":"[data-reply-submit]"}},function(self)
{return{init:function()
{},"{submitReply} click":function(el,event)
{var content=self.textarea().val();if(content==''){self.element.addClass('is-empty');return!1}
EasySocial.ajax('apps/event/discussions/controllers/reply/submit',{"id":self.parent.options.id,"eventId":self.parent.options.eventId,"content":content}).done(function(html){self.parent.insertReply(html);self.textarea().val('')})}}});module.resolve()});EasySocial.module('apps/event/guests',function($){var module=this;EasySocial.Controller('Events.Item.Guests',{defaultOptions:{'{filters}':'[data-event-guests-filter]','{content}':'[data-event-guests-content]'}},function(self){return{init:function()
{self.options.id=self.element.data('id');self.items=self.addPlugin('Item')},'{filters} click':function(el,event)
{event.preventDefault();el.route();self.filters().removeClass('active');el.addClass('active');var filter=el.data('filter');self.content().html('&nbsp;');self.content().addClass('is-loading');EasySocial.ajax('apps/event/guests/controllers/events/filterGuests',{'id':self.options.id,'filter':filter}).done(function(contents,total){self.content().removeClass('is-loading');if(total==0){self.content().addClass('is-empty')}else{self.content().removeClass('is-empty')}
self.content().html(contents)})},'{self} emptyGuest':function(){self.content().addClass('is-empty')}}});EasySocial.Controller('Events.Item.Guests.Item',{defaultOptions:{'{item}':'[data-event-guest-item]','{promote}':'[data-guest-promote]','{demote}':'[data-guest-demote]','{approve}':'[data-guest-approve]','{reject}':'[data-guest-reject]','{remove}':'[data-guest-remove]'}},function(self)
{return{init:function()
{},getItem:function(el)
{var item=self.item.of(el);return item},'{approve} click':function(el)
{console.log('here');var item=self.getItem(el),guestId=item.data('guestId');EasySocial.dialog({content:EasySocial.ajax('site/views/events/confirmApproveGuest',{'id':guestId}),bindings:{'{approveButton} click':function(){EasySocial.ajax('site/controllers/events/approveGuest',{'id':guestId}).done(function(){EasySocial.dialog().close();item.remove();self.item().length===0&&self.element.trigger('emptyGuest')})}}})},'{reject} click':function(el)
{var item=self.getItem(el),guestId=item.data('guestId');EasySocial.dialog({content:EasySocial.ajax('site/views/events/confirmRejectGuest',{'id':guestId}),bindings:{'{rejectButton} click':function(){EasySocial.ajax('site/controllers/events/rejectGuest',{'id':guestId}).done(function(){EasySocial.dialog().close();item.remove();self.item().length===0&&self.element.trigger('emptyGuest')})}}})},'{promote} click':function(el)
{var item=self.getItem(el),guestId=item.data('guestId');EasySocial.dialog({content:EasySocial.ajax('site/views/events/confirmPromoteGuest',{'id':guestId}),bindings:{'{promoteButton} click':function(){EasySocial.ajax('site/controllers/events/promoteGuest',{'id':guestId}).done(function(){EasySocial.dialog().close();item.removeClass('is-member').addClass('is-admin')})}}})},'{demote} click':function(el)
{var item=self.getItem(el),guestId=item.data('guestId');EasySocial.dialog({content:EasySocial.ajax('site/views/events/confirmDemoteGuest',{'id':guestId}),bindings:{'{demoteButton} click':function(){EasySocial.ajax('site/controllers/events/demoteGuest',{'id':guestId}).done(function(){EasySocial.dialog().close();if(self.parent.filters('.active').data('filter')=='admin'){item.remove();self.item().length===0&&self.element.trigger('emptyGuest')}else{item.removeClass('is-admin').addClass('is-member')}})}}})},'{remove} click':function(el,event)
{var item=self.getItem(el),guestId=item.data('guestId');EasySocial.dialog({content:EasySocial.ajax('site/views/events/confirmRemoveGuest',{'id':guestId}),bindings:{'{removeButton} click':function(){EasySocial.ajax('site/controllers.events/removeGuest',{'id':guestId}).done(function(){EasySocial.dialog().close();item.remove();self.item().length===0&&self.element.trigger('emptyGuest')})}}})}}});module.resolve()});EasySocial.module('apps/event/tasks',function($)
{var module=this;EasySocial.Controller('Events.Apps.Tasks.Milestones.Browse',{defaultOptions:{eventId:null,"{milestone}":"[data-tasks-milestone-item]"}},function(self){return{init:function()
{self.options.eventId=self.element.data('eventid');self.milestone().addController(EasySocial.Controller.Events.Apps.Tasks.Milestones.Item,{"{parent}":self})}}});EasySocial.Controller('Events.Apps.Tasks.Milestones.Item',{defaultOptions:{"{complete}":"[data-milestone-mark-complete]","{incomplete}":"[data-milestone-mark-incomplete]","{delete}":"[data-milestone-delete]","{milestone}":"[data-event-tasks-milestone-item]"}},function(self){return{init:function()
{self.options.id=self.element.data('id')},"{incomplete} click":function(el)
{EasySocial.ajax('apps/event/tasks/controllers/milestone/unresolve',{id:self.options.id,eventId:self.parent.options.eventId}).done(function(){self.element.removeClass('is-due').removeClass('is-completed');el.hide();self.complete().show()})},"{complete} click":function(el)
{EasySocial.ajax('apps/event/tasks/controllers/milestone/resolve',{id:self.options.id,eventId:self.parent.options.eventId}).done(function(){self.element.removeClass('is-due').addClass('is-completed');el.hide();self.incomplete().show()})},"{delete} click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/event/tasks/controllers/milestone/confirmDelete',{id:self.options.id,eventId:self.parent.options.eventId}),bindings:{'{deleteButton} click':function(){EasySocial.ajax('apps/event/tasks/controllers/milestone/delete',{id:self.options.id,eventId:self.parent.options.eventId}).done(function(){EasySocial.dialog().close();self.element.remove()})}}})}}});EasySocial.Controller('Events.Apps.Tasks',{defaultOptions:{'{form}':'[data-tasks-form]','{formWrapper}':'[data-tasks-form-wrapper]','{taskList}':'[data-tasks-list]','{item}':'[data-tasks-list-item]','{completedList}':'[data-tasks-completed]','{openCounter}':'[data-tasks-open-counter]','{closedCounter}':'[data-tasks-closed-counter]',"{completeMilestone}":"[data-milestone-mark-complete]","{incompleteMilestone}":"[data-milestone-mark-incomplete]","{deleteMilestone}":"[data-milestone-delete]","{wrapper}":"[data-tasks-wrapper]"}},function(self){return{init:function()
{self.options.id=self.element.data('id');self.options.eventId=self.element.data('eventid');self.options.milestoneId=self.element.data('milestoneid');self.form().addController(EasySocial.Controller.Events.Apps.Tasks.Form,{"{parent}":self});self.implementItemController()},implementItemController:function()
{self.item().addController(EasySocial.Controller.Events.Apps.Tasks.Item,{"{parent}":self})},updateOpenCounter:function(total)
{self.openCounter().html(total)},updateClosedCounter:function(total)
{self.closedCounter().html(total)},insertCompleted:function(taskItem)
{$(taskItem).appendTo(self.completedList())},insertTask:function(taskItem)
{self.formWrapper().after(taskItem);self.implementItemController()},"{uncompleteMilestone} click":function()
{EasySocial.ajax('apps/event/tasks/controllers/milestone/unresolve',{id:self.options.milestoneId,eventId:self.options.eventId}).done(function()
{self.wrapper().removeClass('is-due').removeClass('is-completed')})},"{completeMilestone} click":function()
{EasySocial.ajax('apps/event/tasks/controllers/milestone/resolve',{id:self.options.milestoneId,eventId:self.options.eventId}).done(function(){self.wrapper().removeClass('is-due').addClass('is-completed')})},"{deleteMilestone} click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/event/tasks/controllers/milestone/confirmDelete',{id:self.options.milestoneId,eventId:self.options.eventId}),bindings:{'{deleteButton} click':function(){EasySocial.ajax('apps/event/tasks/controllers/milestone/delete',{id:self.options.id,eventId:self.options.eventId}).done(function(){EasySocial.dialog().close();window.location=self.options.redirect})}}})}}});EasySocial.Controller('Events.Apps.Tasks.Item',{defaultOptions:{'{checkbox}':'[data-item-checkbox]','{delete}':'[data-tasks-item-remove]'}},function(self){return{init:function()
{self.options.id=self.element.data('id')},'{delete} click':function()
{EasySocial.dialog({content:EasySocial.ajax('apps/event/tasks/controllers/tasks/confirmDelete',{'eventId':self.parent.options.eventId}),bindings:{'{deleteButton} click':function(){EasySocial.ajax('apps/event/tasks/controllers/tasks/delete',{id:self.options.id,eventId:self.parent.options.eventId}).done(function(){EasySocial.dialog().close();var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total-1);self.element.remove()})}}})},'{checkbox} change':function(el,event)
{var checked=$(el).is(':checked');if(checked){EasySocial.ajax('apps/event/tasks/controllers/tasks/resolve',{id:self.options.id,eventId:self.parent.options.eventId}).done(function(){var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total-1);var total=parseInt(self.parent.closedCounter().html());self.parent.updateClosedCounter(total+1);self.parent.insertCompleted(self.element)})}else{EasySocial.ajax('apps/event/tasks/controllers/tasks/unresolve',{id:self.options.id,eventId:self.parent.options.eventId}).done(function($){var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total+1);var total=parseInt(self.parent.closedCounter().html());self.parent.updateClosedCounter(total-1);self.parent.insertTask(self.element)})}}}});EasySocial.Controller('Events.Apps.Tasks.Form',{defaultOptions:{'{title}':"[data-form-tasks-title]",'{create}':"[data-form-tasks-create]",'{assignee}':"[data-form-tasks-assignee]",'{due}':"[data-form-tasks-due]",'{error}':"[data-tasks-form-error]"}},function(self){return{init:function()
{},resetForm:function()
{self.element[0].reset()},"{title} keyup":function(el,event)
{if(event.keyCode==13){self.create().click()}},"{create} click":function()
{if(self.title().val()==''){self.error().removeClass('hide');return!1}
self.error().addClass('hide');EasySocial.ajax('apps/event/tasks/controllers/tasks/save',{title:self.title().val(),assignee:self.assignee().val(),due:self.due().val(),eventId:self.parent.options.eventId,milestoneId:self.parent.options.milestoneId}).done(function(content){self.resetForm();var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total+1);self.parent.insertTask(content)})}}});module.resolve()});EasySocial.module('apps/fields/event/permalink/content',function($){var module=this;EasySocial.require().language('FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH','FIELDS_EVENT_PERMALINK_REQUIRED').done(function($){EasySocial.Controller('Field.Event.Permalink',{defaultOptions:{required:!1,max:0,id:null,clusterid:null,userid:null,'{field}':'[data-field-permalink]','{checkButton}':'[data-permalink-check]','{input}':'[data-permalink-input]','{available}':'[data-permalink-available]'}},function(self)
{return{state:!1,init:function()
{self.options.max=self.field().data('max')},"{checkButton} click":function()
{self.delayedCheck()},"{input} change":function()
{self.delayedCheck()},"{input} keyup":function()
{self.delayedCheck()},delayedCheck:$.debounce(function()
{self.checkPermalink()},250),checkPermalink:function()
{self.clearError();var permalink=self.input().val();self.available().hide();if(self.options.max>0&&permalink.length>self.options.max){self.raiseError($.language('FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH'));return!1}
if(!$.isEmpty(permalink)){self.checkButton().addClass('btn-loading');var state=$.Deferred();EasySocial.ajax('fields/event/permalink/isValid',{"id":self.options.id,"clusterid":self.options.clusterid,"permalink":permalink}).done(function(msg){self.clearError();self.checkButton().removeClass('btn-loading');self.available().show();state.resolve()}).fail(function(msg){self.raiseError(msg);self.checkButton().removeClass('btn-loading');self.available().hide();state.reject()});return state}
if(self.options.required&&$.isEmpty(permalink)){self.available().hide();self.raiseError($.language('FIELDS_EVENT_PERMALINK_REQUIRED'));return!1}
return!0},raiseError:function(msg)
{self.trigger('error',[msg])},clearError:function()
{self.trigger('clear')},'{self} onSubmit':function(el,ev,register)
{register.push(self.checkPermalink())}}});module.resolve()})});EasySocial.module('apps/fields/event/permalink/sample_content',function($){var module=this;EasySocial.Controller('Field.Permalink.Sample',{defaultOptions:{'{checkPermalink}':'[data-check-permalink]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'check_permalink':self.checkPermalink().toggle(!!value);break}}}});module.resolve()});EasySocial.module('apps/fields/event/recurring/content',function($){var module=this;EasySocial.require().library('datetimepicker').done(function(){EasySocial.Controller('Field.Event.Recurring',{defaultOptions:{'{type}':'[data-recurring-type]','{endBlock}':'[data-recurring-end-block]','{picker}':'[data-recurring-end-picker]','{toggle}':'[data-recurring-end-toggle]','{result}':'[data-recurring-end-result]'}},function(self){return{init:function(){self.picker()._datetimepicker({pickTime:!1,component:"es",useCurrent:!1});var value=self.result().val();if(!$.isEmpty(value)){var dateObj=$.moment(value);self.datetimepicker('setDate',dateObj)}},'{toggle} click':function(){self.picker().focus()},'{picker} dp.change':function(el,ev){self.setDateValue(ev.date.toDate())},'{type} change':function(el,ev){var value=el.val();self.endBlock()[value==='none'?'hide':'show']()},datetimepicker:function(name,value){return self.picker().data('DateTimePicker')[name](value)},setDateValue:function(date){self.result().val(date.getFullYear()+'-'+('00'+(date.getMonth()+1)).slice(-2)+'-'+('00'+date.getDate()).slice(-2)+' '+('00'+date.getHours()).slice(-2)+':'+('00'+date.getMinutes()).slice(-2)+':'+('00'+date.getSeconds()).slice(-2))},'{self} onSubmit':function(el,ev,register){register.push(!0)}}});module.resolve()})});EasySocial.module('apps/fields/event/startend/content',function($){var module=this;var lang=EasySocial.options.momentLang;EasySocial.require().library('datetimepicker','moment/'+lang).language('FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED','FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED').done(function($){EasySocial.Controller('Field.Event.Startend',{defaultOptions:{dateFormat:'',allowTime:!0,allowTimezone:!0,disallowPast:!1,minuteStepping:15,yearfrom:'',yearto:'',requiredEnd:!1,allday:!1,'{startForm}':'[data-event-start]','{endForm}':'[data-event-end]','{timezone}':'[data-event-timezone]'}},function(self){return{init:function(){if(!$.isEmpty(self.options.yearto)){self.options.yearto=parseInt(self.options.yearto)+1}else{self.options.yearto=new Date().getFullYear()+100}
self.options.yearfrom=self.options.yearfrom||1930;self.startDatetime=self.startForm().addController('EasySocial.Controller.Field.Event.Startend.Form',{'{parent}':self,type:'start'});self.endDatetime=self.endForm().addController('EasySocial.Controller.Field.Event.Startend.Form',{'{parent}':self,type:'end'})},'{self} onSubmit':function(el,ev,register){register.push(self.validateInput())},validateInput:function(){self.clearError();if($.isEmpty(self.startDatetime.datetime().val())){self.raiseError($.language('FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED'));return!1}
if(self.options.requireEnd&&$.isEmpty(self.endDatetime.datetime().val())){self.raiseError($.language('FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED'));return!1}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')}}});EasySocial.Controller('Field.Event.Startend.Form',{defaultOptions:{type:null,'{picker}':'[data-picker]','{toggle}':'[data-picker-toggle]','{datetime}':'[data-datetime]'}},function(self){return{init:function(){self.load()},'{window} easysocial.fields.allday.change':function(el,ev,value){self.datetimepicker('destroy');self.parent.options.allday=value==1?!0:!1;self.load()},load:function(){var minDate=new $.moment();if(self.parent.options.disallowPast){minDate.date(minDate.date()-1)}else{minDate.year(self.parent.options.yearfrom)}
var allowTime=self.parent.options.allowTime&&!self.parent.options.allday;var dateFormat=self.parent.options.dateFormat;if(!allowTime){dateFormat=dateFormat.substr(0,10)}
self.picker()._datetimepicker({component:"es",useCurrent:!1,format:dateFormat,minDate:minDate,maxDate:new $.moment({y:self.parent.options.yearto}),icons:{time:'glyphicon glyphicon-time',date:'glyphicon glyphicon-calendar',up:'glyphicon glyphicon-chevron-up',down:'glyphicon glyphicon-chevron-down'},sideBySide:!1,pickTime:allowTime,minuteStepping:parseInt(self.parent.options.minuteStepping),language:lang});var date=self.datetime().val();if(!$.isEmpty(date)){var dateObj=$.moment(date);self.datetimepicker('setDate',dateObj)}},datetimepicker:function(name,value){return self.picker().data('DateTimePicker')[name](value)},'{toggle} click':function(){self.picker().focus()},'{picker} dp.change':function(el,ev){self.setDateValue(ev.date.toDate());self.parent.element.trigger('event'+$.String.capitalize(self.options.type),[ev.date])},'{picker} change':function(el,ev){if($.isEmpty(el.val())){self.datetime().val('')}},setDateValue:function(date){self.datetime().val(date.getFullYear()+'-'+('00'+(date.getMonth()+1)).slice(-2)+'-'+('00'+date.getDate()).slice(-2)+' '+('00'+date.getHours()).slice(-2)+':'+('00'+date.getMinutes()).slice(-2)+':'+('00'+date.getSeconds()).slice(-2))},'{parent} eventStart':function(el,ev,date){if(self.options.type==='start'){return}},'{parent} eventEnd':function(el,ev,date){if(self.options.type==='end'){return}}}});module.resolve()})});EasySocial.module('apps/fields/event/startend/display',function($){var module=this;EasySocial.require().library('chosen','popbox').language('FIELDS_USER_DATETIME_LOCAL_TIMEZONE','FIELDS_USER_DATETIME_TIMEZONE_CHECKING').done(function($){EasySocial.Controller('Field.Event.Startend.Display',{defaultOptions:{id:null,userid:null,'{box}':'[data-startend-box]'}},function(self){return{init:function(){self.box().addController('EasySocial.Controller.Field.Event.Startend.Display.Box',{'{parent}':self})}}});EasySocial.Controller('Field.Event.Startend.Display.Box',{defaultOptions:{date:null,timezone:null,local:null,'{toggle}':'[data-popbox]','{content}':'[data-popbox-content]','{date}':'[data-date]','{timezone}':'[data-timezone]','{loading}':'[data-loading]'}},function(self){return{init:function(){self.options.timezone=self.timezone().data('timezone');self.options.date=self.date().data('date-utc');self.options.local=-new Date().getTimezoneOffset()/60;var content=self.content().html(),position=self.toggle().data('popbox-position');self.toggle().popbox({content:content,id:'fd',component:'es',type:'timezone',toggle:'click',position:position}).attr('data-popbox','')},'{toggle} popboxActivate':function(el,event,popbox){popbox.tooltip.addController('EasySocial.Controller.Field.Event.Startend.Display.Timezone',{'{parent}':self})},datetime:$.memoize(function(tz){return EasySocial.ajax('fields/event/startend/getDatetime',{id:self.parent.options.id,userid:self.parent.options.userid,tz:tz,local:self.options.local,datetime:self.options.date})})}});EasySocial.Controller('Field.Event.Startend.Display.Timezone',{defaultOptions:{'{timezones}':'[data-timezone-select]','{reset}':'[data-timezone-reset]','{local}':'[data-timezone-local]'}},function(self){return{init:function(){self.timezones().chosen({search_contains:!0})},'{timezones} change':function(el,event){var key=el.val();self.parent.date().html($.language('FIELDS_USER_DATETIME_TIMEZONE_CHECKING'));self.parent.timezone().html(key==='local'?$.language('FIELDS_USER_DATETIME_LOCAL_TIMEZONE'):key);self.parent.datetime(key).done(function(value){self.parent.date().html(value)})},'{reset} click':function(){self.setTimezone(self.parent.options.timezone)},'{local} click':function(){self.setTimezone('local')},setTimezone:function(tz){self.timezones().val(tz).trigger('liszt:updated').trigger('change')}}});module.resolve()})});EasySocial.module('apps/fields/group/permalink/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH','PLG_FIELDS_GROUP_PERMALINK_REQUIRED').done(function($){EasySocial.Controller('Field.Group.Permalink',{defaultOptions:{required:!1,max:0,id:null,groupid:null,userid:null,'{field}':'[data-field-permalink]','{checkButton}':'[data-permalink-check]','{input}':'[data-permalink-input]','{available}':'[data-permalink-available]'}},function(self)
{return{state:!1,init:function()
{self.options.max=self.field().data('max')},"{checkButton} click":function()
{self.delayedCheck()},"{input} change":function()
{self.delayedCheck()},"{input} keyup":function()
{self.delayedCheck()},delayedCheck:$.debounce(function()
{self.checkPermalink()},250),checkPermalink:function()
{self.clearError();var permalink=self.input().val();self.available().hide();if(self.options.max>0&&permalink.length>self.options.max){self.raiseError($.language('PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH'));return!1}
if(!$.isEmpty(permalink)){self.checkButton().addClass('btn-loading');var state=$.Deferred();EasySocial.ajax('fields/group/permalink/isValid',{"id":self.options.id,"groupid":self.options.groupid,"permalink":permalink}).done(function(msg){self.clearError();self.checkButton().removeClass('btn-loading');self.available().show();state.resolve()}).fail(function(msg){self.raiseError(msg);self.checkButton().removeClass('btn-loading');self.available().hide();state.reject()});return state}
if(self.options.required&&$.isEmpty(permalink)){self.available().hide();self.raiseError($.language('PLG_FIELDS_GROUP_PERMALINK_REQUIRED'));return!1}
return!0},raiseError:function(msg)
{self.trigger('error',[msg])},clearError:function()
{self.trigger('clear')},'{self} onSubmit':function(el,ev,register)
{register.push(self.checkPermalink())}}});module.resolve()})});EasySocial.module('apps/fields/group/permalink/sample_content',function($){var module=this;EasySocial.Controller('Field.Permalink.Sample',{defaultOptions:{'{checkPermalink}':'[data-check-permalink]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'check_permalink':self.checkPermalink().toggle(!!value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/address/content',function($){var module=this;EasySocial.require().library('gmaps').language('PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS1','PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS2','PLG_FIELDS_ADDRESS_PLEASE_ENTER_CITY','PLG_FIELDS_ADDRESS_PLEASE_ENTER_STATE','PLG_FIELDS_ADDRESS_PLEASE_ENTER_ZIP','PLG_FIELDS_ADDRESS_PLEASE_ENTER_COUNTRY').done(function(){EasySocial.Controller('Field.Address',{defaultOptions:{required:{},show:{},"{field}":"[data-field-address]","{address1}":"[data-field-address-address1]","{address2}":"[data-field-address-address2]","{city}":"[data-field-address-city]","{state}":"[data-field-address-state]","{country}":"[data-field-address-country]","{zip}":"[data-field-address-zip]",'{required}':'[data-required]','{notice}':'[data-check-notice]'}},function(self){return{init:function(){},fields:['address1','address2','city','state','zip','country'],validateInput:function(){self.clearError();var errorRaised=!1;self.clearError();$.each(self.fields,function(i,field){var el=self[field]();el.removeClass('has-error');var val=el.val();if($.isEmpty(val)&&self.options.required[field]&&self.options.show[field])
{el.addClass('has-error');if(!errorRaised){self.raiseError($.language('PLG_FIELDS_ADDRESS_PLEASE_ENTER_'+field.toUpperCase()));errorRaised=!0}}});return!0},'{address1}, {address2}, {zip}, {city}, {state} blur':function(){self.validateInput()},'{country} change':function(el){self.validateInput();if(self.state().is('select')){EasySocial.ajax('fields/user/address/getStates',{id:self.options.id,country:el.val()}).done(function(states){self.state().html('');$.each(states,function(code,name){var option=$('<option></option>').html(name).val(name).appendTo(self.state())})})}},raiseError:function(msg){self.notice().css('color','#a94442').text(msg).parent('.controls-error').show()},clearError:function(){self.notice().parent('.controls-error').hide()},"{self} onSubmit":function(el,event,register){register.push(self.validateInput())},"{self} onConfigChange":function(el,event,name,value){var requires=['address1','address2','city','zip','state','country'];if($.inArray(name,requires)>=0){self.options.required[name]=!!value}
self.required().hide();$.each(requires,function(i,t){if(self.options[t]){self.required().show();return!1}})}}});module.resolve()})});EasySocial.module('apps/fields/user/address/display_content',function($){var module=this;EasySocial.require().library('gmaps').done(function(){EasySocial.Controller('Field.Address.Display',{defaultOptions:{latitude:null,longitude:null,ratio:1,'{base}':'[data-location-base]','{map}':'[data-location-map]','{mapImage}':'[data-location-map-image]'}},function(self){return{init:function(){var map=self.map();self.options.latitude=map.data('latitude');self.options.longitude=map.data('longitude');self.setLayout()},'{window} resize':$.debounce(function(){self.setLayout()},250),navigate:function(lat,lng){var mapImage=self.mapImage(),width=Math.floor(mapImage.width()),height=Math.floor(mapImage.height()),url=$.GMaps.staticMapURL({size:[width,height],lat:lat,lng:lng,markers:[{lat:lat,lng:lng}]});mapImage.attr("src",url).data({width:width,height:height});self.base().addClass("has-location")},setLayout:function(){setTimeout(function(){if(self.options.latitude&&self.options.longitude){self.navigate(self.options.latitude,self.options.longitude)}},1)},'{self} onShow':function(){self.setLayout()}}});module.resolve()})});EasySocial.module('apps/fields/user/address/maps',function($){var module=this;$.template('easysocial/maps.suggestion','<div class="es-story-location-suggestion" data-location-suggestion><span class="formatted_address">[%= location.formatted_address %]</span></div>');EasySocial.require().library('gmaps','placeholder').language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT").done(function(){var KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller('Field.Address.Maps',{defaultOptions:{required:null,zoom:2,latitude:null,longitude:null,address:null,singleLocation:!0,required:!1,ratio:3,'{field}':'[data-field-address]','{base}':'[data-location-base]','{map}':'[data-location-map]','{mapImage}':'[data-location-map-image]','{detectButton}':'[data-location-detect]','{removeButton}':'[data-location-remove]','{form}':'[data-location-form]','{textbox}':'[data-location-textbox]','{textField}':'[data-location-textfield]','{autocomplete}':'[data-location-autocomplete]','{suggestions}':'[data-location-suggestions]','{suggestion}':'[data-location-suggestion]','{source}':'[data-location-source]',view:{suggestion:'maps.suggestion'}}},function(self){return{init:function(){if(navigator.geolocation){self.base().addClass("is-detectable")}
self.textField().placeholder();self.textField().removeAttr("disabled");if(!$.isEmpty(self.source().val())){var data=JSON.parse(self.source().val());if(data.latitude&&data.longitude){self.navigate(data.latitude,data.longitude);self.base().addClass("has-location")}}},"{window} resize":$.debounce(function(){var data=JSON.parse(self.source().val());if(!data.latitude||!data.longitude){return}
var mapImage=self.mapImage();if(mapImage.data("width")!==mapImage.width()){self.navigate(data.latitude,data.longitude)}},250),'{self} onShow':function(){var data=JSON.parse(self.source().val());if(!data.latitude||!data.longitude){return}
var mapImage=self.mapImage();if(mapImage.data("width")!==mapImage.width()){self.navigate(data.latitude,data.longitude)}},navigate:function(lat,lng){self.field().css({"max-width":"none"});var mapImage=self.mapImage(),width=Math.floor(mapImage.width()),height=Math.floor(mapImage.height()),url=$.GMaps.staticMapURL({size:[1280,1280],lat:lat,lng:lng,sensor:!0,scale:2,markers:[{lat:lat,lng:lng}]});$.Image.get(url).done(function(){mapImage.css({"backgroundImage":$.cssUrl(url),"backgroundSize":"cover","backgroundPosition":"center center"});self.base().addClass("has-location")}).always(function(){base.removeClass("is-loading")})},locations:{},lastQueryAddress:null,results:[],result:null,"{textField} keypress":function(textField,event){switch(event.keyCode)
{case KEYCODE.UP:var prevSuggestion=$(self.suggestion(".active").prev(self.suggestion.selector)[0]||self.suggestion(":last")[0]);self.suggestion().removeClass("active");prevSuggestion.addClass("active").trigger("activate");self.suggestions().scrollTo(prevSuggestion,{offset:prevSuggestion.height()*-1});event.preventDefault();break;case KEYCODE.DOWN:var nextSuggestion=$(self.suggestion(".active").next(self.suggestion.selector)[0]||self.suggestion(":first")[0]);self.suggestion().removeClass("active");nextSuggestion.addClass("active").trigger("activate");self.suggestions().scrollTo(nextSuggestion,{offset:nextSuggestion.height()*-1});event.preventDefault();break;case KEYCODE.ENTER:var activeSuggestion=self.suggestion(".active"),location=activeSuggestion.data("location");self.set(location);self.hideSuggestions();break;case KEYCODE.ESCAPE:self.hideSuggestions();break}},"{textField} keyup":function(textField,event){switch(event.keyCode){case KEYCODE.UP:case KEYCODE.DOWN:case KEYCODE.LEFT:case KEYCODE.RIGHT:case KEYCODE.ENTER:case KEYCODE.ESCAPE:break;default:var address=$.trim(textField.val());if(address===""){self.base().removeClass("has-location");self.hideSuggestions()}
var locations=self.locations[address];if(locations){self.lastQueryAddress=address;self.suggest(locations)}else{self.lookup(address)}
break}},lookup:$.debounce(function(address){self.base().addClass("is-busy");$.GMaps.geocode({address:address,callback:function(locations,status){self.base().removeClass("is-busy");if(status=="OK"){self.locations[address]=locations;self.suggest(locations);self.lastQueryAddress=address}}})},250),suggest:function(locations){var suggestions=self.suggestions();suggestions.empty();if(locations.length<0)return;self.results=locations;$.each(locations,function(i,location){self.view.suggestion({location:location}).data("location",location).appendTo(suggestions)});self.showSuggestions()},showSuggestions:function(){self.focusSuggestion=!0;self.element.find(".es-story-footer").addClass("swap-zindex");setTimeout(function(){self.autocomplete().addClass("active");var doc=$(document),hideOnClick="click.es.story.location";doc.off(hideOnClick).on(hideOnClick,function(event){var targets=$(event.target).parents().andSelf();if(targets.filter(self.element).length>0)return;doc.off(hideOnClick);self.hideSuggestions()})},500)},hideSuggestions:function(){self.focusSuggestion=!1;self.autocomplete().removeClass("active");$(document).off("click.es.story.location");setTimeout(function(){if(self.focusSuggestion)return;self.element.find(".es-story-footer").removeClass("swap-zindex")},500)},"{suggestion} activate":function(suggestion,event){var location=suggestion.data("location");self.navigate(location.geometry.location.lat(),location.geometry.location.lng())},"{suggestion} mouseover":function(suggestion){self.suggestion().removeClass("active");suggestion.addClass("active").trigger("activate")},"{suggestion} click":function(suggestion,event){var location=suggestion.data("location");self.set(location);self.hideSuggestions()},set:function(location){self.currentLocation=location;var lat=location.geometry.location.lat(),lng=location.geometry.location.lng();self.navigate(lat,lng);var address=location.formatted_address;self.textField().val(address);self.lastQueryAddress=address;self.base().addClass("has-location");self.result=location;var data=self.getResult('source');self.source().val(JSON.stringify(data))},unset:function(){self.currentLocation=null;self.textField().val('');self.mapImage().attr("src","");self.base().removeClass("has-location");self.source().val('')},detectTimer:null,"{detectButton} click":function(){var textbox=self.textbox();self.base().addClass("is-busy");clearTimeout(self.detectTimer);self.detectTimer=setTimeout(function(){self.base().removeClass("is-busy")},8000);$.GMaps.geolocate({success:function(position){$.GMaps.geocode({lat:position.coords.latitude,lng:position.coords.longitude,callback:function(locations,status){if(status=="OK"){self.suggest(locations);self.textField().focus()}}})},error:function(error){var message="";switch(error.code){case 1:message=$.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:message=$.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:message=$.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR");break}},always:function(){clearTimeout(self.detectTimer);self.base().removeClass("is-busy")}})},"{removeButton} click":function(){self.unset();self.hideSuggestions()},getResult:function(type){if(!self.result){if(self.results.length===0){return!1}
self.result=self.results[0]}
var r=self.result;if(type===undefined){return r}
switch(type){case 'coords':return{lat:r.geometry.location.lat(),lng:r.geometry.location.lng()}
break;case 'lat':case 'latitude':return r.geometry.location.lat();break;case 'lng':case 'longitude':return r.geometry.location.lng();break;case 'address':return r.formatted_address;break;case 'viewport':return r.geometry.viewport;break;case 'bounds':return r.geometry.bounds||r.geometry.viewport;break;case 'source':var components={};$.each(r.address_components,function(index,component){if(component.types[0]){components[component.types[0]]=component.long_name}});var mapping={'address1':['street_address','route'],'address2':['intersection','colloquial_area','neighborhood','premise','subpremise'],'city':['locality','sublocality','sublocality_level_1','sublocality_level_2','sublocality_level_3','sublocality_level_4','sublocality_level_5'],'state':['administrative_area_level_1','administrative_area_level_2','administrative_area_level_3'],'zip':'postal_code','country':'country'};var legacy={};$.each(mapping,function(key,value){legacy[key]='';if($.isArray(value)){$.each(value,function(i,v){if(components[v]!==undefined){legacy[key]=components[v];return!1}else{return!0}});return!0}
if(components[value]!==undefined){legacy[key]=components[value]}});var data=$.extend(legacy,{components:components,address:r.formatted_address,latitude:r.geometry.location.lat(),longitude:r.geometry.location.lng()});return data;break}}}});module.resolve()})});EasySocial.module('apps/fields/user/avatar/content',function($){var module=this;EasySocial.require().library('image','imgareaselect').stylesheet('imgareaselect/default').language('PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE').done(function(){EasySocial.Controller('Field.Avatar',{defaultOptions:{required:!1,id:0,group:null,origSource:null,defaultAvatar:null,hasAvatar:null,'{field}':'[data-field-avatar]','{gallery}':'[data-field-avatar-gallery]','{galleryList}':'[data-field-avatar-gallery-items]','{galleryItem}':'[data-field-avatar-gallery-item]','{frame}':'[data-field-avatar-frame]','{viewport}':'[data-field-avatar-viewport]','{avatarSource}':'[data-field-avatar-source]','{avatarData}':'[data-field-avatar-data]','{avatarPath}':'[data-field-avatar-path]','{avatarType}':'[data-field-avatar-type]','{avatarName}':'[data-field-avatar-name]','{file}':'[data-field-avatar-file]','{image}':'[data-field-avatar-selected]','{note}':'[data-field-avatar-note]','{actions}':'[data-field-avatar-actions]','{cancel}':'[data-field-avatar-actions-cancel]','{crop}':'[data-field-avatar-actions-crop]','{removeFrame}':'[data-field-avatar-remove]','{remove}':'[data-field-avatar-remove-button]','{revertFrame}':'[data-field-avatar-revert]','{revert}':'[data-field-avatar-revert-button]','{loader}':'[data-field-avatar-loader]'}},function(self){return{init:function(){self.state=!!self.options.hasAvatar},state:!0,"{file} change":function(el,event){if($.isEmpty(el.val())){return}
var label=el.val().replace(/\\/g,'/');el.parents('.input-group').find(':text').val(label);self.state=!1;self.loader().show();self.frame().hide();self.file().hide();self.clearError();EasySocial.ajax('fields/'+self.options.group+'/avatar/upload',{id:self.options.id,files:el},{type:"iframe"}).done(function(raw,uri,path){self.avatarName().val(raw.name);self.avatarSource().val(uri);self.avatarPath().val(path);self.avatarType().val('upload');self.setLayout(uri);self.galleryItem().removeClass('active');self.removeFrame().hide();self.revertFrame().hide();self.state=!0}).fail(function(msg){self.loader().hide();self.raiseError(msg);self.file().show().val('');self.frame().show()})},setLayout:function(img){var loader=$.Image.get(img),frame=self.frame();loader.done(function(el,image){frame.css('background-image',$.cssUrl(img));frame.addClass('avatar-frame-crop');frame.show();self.loader().hide();self.actions().show();self.note().show();self.viewport().imgAreaSelect({remove:!0});self.viewport().show();var size=$.Image.resizeWithin(image.width,image.height,frame.width(),frame.height()),min=Math.min(size.width,size.height),x1=Math.floor((size.width-min)/2),y1=Math.floor((size.height-min)/2),x2=x1+min,y2=y1+min;self.viewport().css(size).imgAreaSelect({handles:!0,aspectRatio:'1:1',parent:frame,x1:x1,y1:y1,x2:x2,y2:y2,onSelectEnd:function(viewport,selection){var hasSelection=!(selection.width=="0"&&selection.height=="0");if(hasSelection){var string=JSON.stringify(self.data());self.avatarData().val(string)}}})})},'{cancel} click':function(){self.actions().hide();self.note().hide();self.frame().hide();self.file().show();self.file().val('');self.file().parents('.input-group').find(':text').val('');self.avatarSource().val('');self.avatarPath().val('');self.avatarData().val('');self.avatarType().val('');self.viewport().hide().imgAreaSelect({remove:!0});if(!$.isEmpty(self.options.origSource)){self.frame().css('background-image',$.cssUrl(self.options.origSource)).removeClass('avatar-frame-crop').show()}
if(self.options.hasAvatar){self.removeFrame().show()}},data:function(){var viewport=self.viewport(),width=viewport.width(),height=viewport.height(),selection=viewport.imgAreaSelect({instance:!0}).getSelection(),data={top:selection.y1/height,left:selection.x1/width,width:selection.width/width,height:selection.height/height};return data},'{gallery} click':function(){self.galleryList().toggle()},'{galleryItem} click':function(el,event){if(!el.hasClass('active')){var id=el.data('id');self.galleryItem().removeClass('active');el.addClass('active');self.state=!1;self.loader().show();self.frame().hide();self.file().hide();self.file().val('');self.file().parents('.input-group').find(':text').val('');self.clearError();self.avatarType().val('gallery');self.avatarSource().val(id);EasySocial.ajax('fields/user/avatar/loadDefault',{"avatarId":id}).done(function(uri){self.frame().css('background-image','url('+uri+')');self.frame().show();self.frame().removeClass('avatar-frame-crop');self.loader().hide();self.viewport().hide();self.viewport().imgAreaSelect({remove:!0});self.actions().hide();self.note().hide();self.file().show();self.revertFrame().show();self.removeFrame().hide();self.state=!0})}},'{remove} click':function(){self.avatarType().val('remove');self.frame().css('background-image',$.cssUrl(self.options.defaultAvatar));self.removeFrame().hide();if(self.options.hasAvatar){self.revertFrame().show()}
self.state=!1},'{revert} click':function(){self.avatarType().val('');self.frame().css('background-image',$.cssUrl(self.options.origSource));if(self.options.hasAvatar){self.removeFrame().show()}
self.revertFrame().hide();self.galleryItem().removeClass('active');self.state=!0},'{self} onSubmit':function(el,event,register){if(self.options.required){if(!self.state){self.raiseError($.language('PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE'))}
register.push(self.state)}},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')}}});module.resolve()})});EasySocial.module('apps/fields/user/avatar/sample_content',function($){var module=this;EasySocial.Controller('Field.Avatar.Sample',{defaultOptions:{'{upload}':'[data-avatar-upload]','{gallery}':'[data-avatar-gallery]','{galleryTitle}':'[data-avatar-gallery-title]','{galleryButton}':'[data-avatar-gallery-button]','{gallerySelection}':'[data-avatar-gallery-selection]'}},function(self){return{'{self} onConfigChange':function(el,event,name,value){switch(name){case 'upload':self.upload().toggle(value);break;case 'gallery':self.gallery().toggle(value);break;case 'use_gallery_button':self.galleryButton().toggle(value);self.gallerySelection().toggle(!value);self.galleryTitle().toggle(!value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/checkbox/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM').done(function(){EasySocial.Controller('Field.Checkbox',{defaultOptions:{required:!1,"{item}":"[data-field-checkbox-item]"}},function(self)
{return{init:function(){},validateInput:function(){self.clearError();if(self.options.required&&self.item(':checked').length==0){self.raiseError();return!1}
return!0},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM')])},clearError:function(){self.trigger('clear')},"{self} onSubmit":function(el,event,register){register.push(self.validateInput());return}}});module.resolve()})});EasySocial.module('apps/fields/user/checkbox/sample_content',function($){var module=this;EasySocial.require().view('fields/user/checkbox/item').done(function($){EasySocial.Controller('Field.Checkbox.Sample',{defaultOptions:{'{checkboxes}':'[data-checkboxes]','{checkbox}':'[data-checkbox]','{checkboxInput}':'[data-checkbox-input]','{checkboxTitle}':'[data-checkbox-title]',view:{sample:'fields/user/checkbox/item'}}},function(self){return{init:function(){},'{self} onChoiceTitleChanged':function(el,event,index,data){self.checkboxTitle().eq(index).text(data)},'{self} onChoiceValueChanged':function(el,event,index,data){self.checkboxInput().eq(index).val(data)},'{self} onChoiceAdded':function(el,event,index,data){if(self.checkbox().eq(index).length>0){self.checkbox().eq(index).before(self.view.sample())}else{self.checkboxes().append(self.view.sample())}},'{self} onChoiceRemoved':function(el,event,index){self.checkbox().eq(index).remove()},'{self} onChoiceToggleDefault':function(el,event,index,value){var element=self.checkboxInput().eq(index);if(value){element.prop('checked',!0)}else{element.prop('checked',!1)}}}});module.resolve()})});EasySocial.module('apps/fields/user/country/content',function($){var module=this;EasySocial.require().library('textboxlist').language('PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED','PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR','PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR').done(function(){EasySocial.Controller('Field.Country',{defaultOptions:{fieldname:'',required:!1,id:null,min:null,max:null,selecttype:'textboxlist','{field}':'[data-field-country]','{inputTextboxlist}':'[data-country-select-textboxlist]','{inputMultilist}':'[data-country-select-multilist]','{inputCheckbox}':'[data-country-select-checkbox]','{inputCheckboxes}':'[data-country-select-checkbox] input','{inputDropdown}':'[data-country-select-dropdown]'}},function(self){return{init:function(){self.options.max=self.field().data('max');self.options.min=self.field().data('min');self.options.selecttype=self.field().data('select-type');if(self.options.selecttype==='textboxlist'){EasySocial.module('field.country/'+self.options.id).done(function(data){self.inputTextboxlist().textboxlist({component:'es',name:self.options.fieldname+'[]',max:self.options.max<1?null:self.options.max,plugin:{autocomplete:{exclusive:!0,query:data}}})})}},'{inputMultilist} change':function(el,ev){if(self.options.max>0&&el.val().length>self.options.max){el.val(self.lastValidSelection?self.lastValidSelection:'');return!1}
self.lastValidSelection=el.val()},'{inputCheckboxes} change':function(el,ev){var count=self.inputCheckboxes(':checked').length;if(self.options.max>0&&count>self.options.max){el.removeAttr('checked');return!1}},validateInput:function(){var items=null;if(self.options.selecttype==='textboxlist'){items=self.inputTextboxlist().controller('textboxlist').getAddedItems()}
if(self.options.selecttype==='multilist'){items=self.inputMultilist().val()}
if(self.options.selecttype==='checkbox'){items=self.inputCheckboxes(':checked')}
if(self.options.selecttype==='dropdown'){var value=self.inputDropdown().val();if(!$.isEmpty(value)){items=[value]}}
var count=items?items.length:0;if(!self.options.required&&count===0){return!0}
if(self.options.required&&count<1){self.raiseError($.language('PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED'));return!1}
if(self.options.min>0&&count<self.options.min){self.raiseError($.language('PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR'));return!1}
if(self.options.max>0&&count>self.options.max){self.raiseError($.language('PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR'));return!1}
return!0},raiseError:function(msg){self.trigger('error',[msg])},'{self} onSubmit':function(el,ev,register){register.push(self.validateInput())}}});module.resolve()})});EasySocial.module('apps/fields/user/country/sample_content',function($){var module=this;EasySocial.Controller('Field.Country.Sample',{defaultOptions:{'{inputGeneral}':'[data-country-select]','{inputTextboxlist}':'[data-country-select-textboxlist]','{inputMultilist}':'[data-country-select-multilist]','{inputCheckbox}':'[data-country-select-checkbox]','{inputDropdown}':'[data-country-select-dropdown]','{maxMessage}':'[data-country-max-message]','{maxCount}':'[data-country-max-count]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,ev,name,value){switch(name){case 'select_type':self.inputGeneral().hide();if(value==='textboxlist'){self.inputTextboxlist().show()}
if(value==='multilist'){self.inputMultilist().show()}
if(value==='checkbox'){self.inputCheckbox().show()}
if(value==='dropdown'){self.inputDropdown().show()}
break;case 'multilist_size':self.inputMultilist().attr('size',value);break;case 'show_max_message':self.maxMessage().toggle(!!value);break;case 'max':self.maxCount().text(value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/cover/content',function($){var module=this;EasySocial.require().library('image').language('PLG_FIELDS_COVER_VALIDATION_REQUIRED').done(function(){EasySocial.Controller('Field.Cover',{defaultOptions:{id:0,group:null,required:!1,hasCover:!0,defaultCover:null,ratio:3,'{image}':'[data-field-cover-image]','{data}':'[data-field-cover-data]','{position}':'[data-field-cover-position]','{file}':'[data-field-cover-file]','{note}':'[data-field-cover-note]','{loader}':'[data-field-cover-loader]','{error}':'[data-field-cover-error]','{removeButton}':'[data-field-cover-remove-button]','{revertFrame}':'[data-field-cover-revert]','{revertButton}':'[data-field-cover-revert-button]'}},function(self){return{init:function(){self.setFrame();self.setLayout();self.origCover=self.options.hasCover?$.uri(self.image().css('backgroundImage')).extract(0):null;self.origPosition=self.options.hasCover?self.image().css('backgroundPosition'):null},'{self} onShow':function(){setTimeout(function(){self.setLayout()},1)},setFrame:function(){var frameWidth=self.image().width(),frameHeight=frameWidth/self.options.ratio;self.image().css('height',frameHeight)},'{window} resize':$.debounce(function(){self.setFrame()},250),imageLoaders:{},'{file} change':function(el,event){if($.isEmpty(el.val())){return}
var label=el.val().replace(/\\/g,'/');el.parents('.input-group').find(':text').val(label);self.loader().show();self.error().hide();self.image().hide();self.note().hide();self.file().hide();EasySocial.ajax('fields/'+self.options.group+'/cover/upload',{id:self.options.id,files:el},{type:'iframe'}).done(function(result){var resultString=JSON.stringify(result);self.data().val(resultString);var positionString=JSON.stringify({x:0.5,y:0.5});self.position().val(positionString);self.position().val()
var url=result.large.uri,imageLoaders=self.imageLoaders,imageLoader=(imageLoaders[url]||(imageLoaders[url]=$.Image.get(url))).done(function(image){self.setLayout.image=image;self.file().show();self.image().show();self.note().show();self.loader().hide();self.revertFrame().hide();self.removeButton().show();self.setCover(result.large.uri)})}).fail(function(msg){self.loader().hide();self.file().show();self.error().show().html(msg)})},setLayout:function(){var cover=self.image(),image=self.setLayout.image;if(!image){var url=$.uri(cover.css('backgroundImage')).extract(0);if(!url)return;var imageLoaders=self.imageLoaders,imageLoader=(imageLoaders[url]||(imageLoaders[url]=$.Image.get(url))).done(function(image){self.setLayout.image=image;self.setLayout()});return}
var imageWidth=image.data("width"),imageHeight=image.data("height"),coverWidth=cover.width(),coverHeight=cover.height(),size=$.Image.resizeProportionate(imageWidth,imageHeight,coverWidth,coverHeight,"outer");self.availableWidth=coverWidth-size.width;self.availableHeight=coverHeight-size.height;self.setFrame()},setCover:function(url,position){position=position||'50% 50%';self.image().css({backgroundImage:$.cssUrl(url),backgroundPosition:position});self.setLayout();self.image().addClass('cover-move');self.note().show()},x:0.5,y:0.5,moveCover:function(dx,dy,image){if(!image){image=self.image()}
var w=self.availableWidth,h=self.availableHeight,x=(w==0)?0:self.x+((dx/w)||0),y=(h==0)?0:self.y+((dy/h)||0);if(x<0)x=0;if(x>1)x=1;if(y<0)y=0;if(y>1)y=1;image.css("backgroundPosition",((self.x=x)*100)+"% "+((self.y=y)*100)+"% ");var position={x:self.x,y:self.y}
self.position().val(JSON.stringify(position))},'{image} mousedown':function(selection,event){if(event.target===self.image()[0]){event.preventDefault()}
var image=self.image(),position=image.css("backgroundPosition").split(" ");self.x=parseInt(position[0])/100;self.y=parseInt(position[1])/100;var x=event.pageX,y=event.pageY;$(document).on("mousemove.movingCover mouseup.movingCover",function(event){self.moveCover((x-(x=event.pageX))*-1,(y-(y=event.pageY))*-1,image)}).on("mouseup.movingCover",function(){$(document).off("mousemove.movingCover mouseup.movingCover")})},'{removeButton} click':function(el){var data=self.data().val();if($.isEmpty(data)){if(self.options.hasCover){self.setCover(self.options.defaultCover);self.data().val('delete');el.hide();self.revertFrame().show()}}else{self.origData=data;self.origPosition=self.position().val();self.data().val('');self.position().val('');self.file().val('');self.file().parents('.input-group').find(':text').val('');if(self.options.hasCover){self.setCover(self.origCover)}else{self.setCover(self.options.defaultCover);self.data().val('delete');el.hide()}}},'{revertButton} click':function(){self.setCover(self.origCover,self.origPosition);self.revertFrame().hide();self.removeButton().show();self.data().val('');self.position().val('');self.file().val('');self.file().parents('.input-group').find(':text').val('')},'{self} onSubmit':function(el,ev,register){if(self.options.required&&!self.options.hasCover&&$.isEmpty(self.data().val()))
{self.raiseError($.language('PLG_FIELDS_COVER_VALIDATION_REQUIRED'));register.push(!1)}},raiseError:function(msg){self.trigger('error',[msg])}}});module.resolve()})});EasySocial.module('apps/fields/user/currency/sample_content',function($){var module=this;EasySocial.Controller('Field.Currency.Sample',{defaultOptions:{}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'format':break}}}});module.resolve()});EasySocial.module('apps/fields/user/datetime/content',function($){var module=this;EasySocial.require().library('datetimepicker','chosen').language('PLG_FIELDS_DATETIME_VALIDATION_INVALID_DATETIME_FORMAT','PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME').done(function($){EasySocial.Controller('Field.Datetime',{defaultOptions:{required:!1,calendarDateFormat:null,yearfrom:null,yearto:null,date:null,lang:null,allowTime:!1,allowTimezone:!1,'{field}':'[data-field-datetime]','{date}':'[data-field-datetime-select]','{dateValue}':'[data-field-datetime-value]','{timezone}':'[date-field-datetime-timezone]','{form}':'[data-field-datetime-form]','{icon}':'[data-field-datetime-icon]','{clearButton}':'[data-clear]',}},function(self)
{return{init:function(){self.options.yearfrom=self.options.yearfrom||1930;if(!$.isEmpty(self.options.yearto)){self.options.yearto=parseInt(self.options.yearto)+1}else{self.options.yearto=new Date().getFullYear()+100}
self.date()._datetimepicker({component:"es",format:self.options.calendarDateFormat,minDate:self.options.yearfrom+'-01-01',maxDate:self.options.yearto+'-12-31',icons:{time:'glyphicon glyphicon-time',date:'glyphicon glyphicon-calendar',up:'glyphicon glyphicon-chevron-up',down:'glyphicon glyphicon-chevron-down'},sideBySide:!0,pickTime:self.options.allowTime,useCurrent:!1});self.options.date=self.dateValue().val();if(!$.isEmpty(self.options.date)){var dateObj=$.moment(self.options.date);self.datetimepicker('setDate',dateObj)}
if(self.options.allowTimezone){self.timezone().chosen({search_contains:!0})}},'{icon} click':function(){self.datetimepicker('show')},'{date} dp.change':function(el,ev){self.setDateValue(ev.date.toDate());self.form().addClass('has-datetime');if(!self.options.allowTime){self.date().blur()}},datetimepicker:function(method,value){return self.date().data('DateTimePicker')[method](value)},setDateValue:function(date){self.dateValue().val(date.getFullYear()+'-'+('00'+(date.getMonth()+1)).slice(-2)+'-'+('00'+date.getDate()).slice(-2)+' '+('00'+date.getHours()).slice(-2)+':'+('00'+date.getMinutes()).slice(-2)+':'+('00'+date.getSeconds()).slice(-2))},'{date} blur':function(){self.validateCalendar()},validateCalendar:function(){self.clearError();if(self.options.required&&$.isEmpty(self.dateValue().val())){self.raiseError($.language('PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME'));return!1}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},"{self} onSubmit":function(el,event,register){register.push(self.validateCalendar());return},'{clearButton} click':function(el,ev){self.form().removeClass('has-datetime');self.datetimepicker('setValue',new $.moment());self.date().val('');self.dateValue().val('')}}});module.resolve()})});EasySocial.module('apps/fields/user/datetime/display_content',function($){var module=this;EasySocial.require().library('popbox','chosen').language('FIELDS_USER_DATETIME_LOCAL_TIMEZONE').done(function($){EasySocial.Controller('Field.Datetime.Display',{defaultOptions:{userid:null,date:null,timezone:null,local:null,'{toggle}':'[data-popbox]','{content}':'[data-popbox-content]','{date}':'[data-date]','{timezone}':'[data-timezone]','{loading}':'[data-loading]'}},function(self){return{init:function(){self.options.timezone=self.timezone().data('timezone');self.options.date=self.date().data('date-utc');self.datetime(self.options.timezone,self.date().html());self.options.local=-new Date().getTimezoneOffset()/60;var content=self.content().html(),position=self.toggle().data('popbox-position');self.toggle().popbox({content:content,id:'fd',component:'es',type:'timezone',toggle:'click',position:position}).attr('data-popbox','')},'{toggle} popboxActivate':function(el,event,popbox){$(popbox.tooltip).addController('EasySocial.Controller.Field.Datetime.Display.Timezone',{'{parent}':self})},data:{},datetime:function(tz,value){if(value===undefined){var dfd=$.Deferred();if(self.data[tz]===undefined){self.loading().show();EasySocial.ajax('fields/user/datetime/getDatetime',{id:self.options.id,userid:self.options.userid,tz:tz,local:self.options.local,datetime:self.options.date}).done(function(datetime){self.loading().hide();dfd.resolve(self.datetime(tz,datetime))})}else{dfd.resolve(self.data[tz])}
return dfd}
self.data[tz]=value;return value},showDatetime:function(tz,datetime){if(tz==='local'){tz=$.language('FIELDS_USER_DATETIME_LOCAL_TIMEZONE')}
self.timezone().html(tz);self.date().html(datetime)}}});EasySocial.Controller('Field.Datetime.Display.Timezone',{defaultOptions:{'{timezones}':'[data-timezone-select]','{reset}':'[data-timezone-reset]','{local}':'[data-timezone-local]'}},function(self){return{init:function(){self.timezones().chosen({search_contains:!0})},'{timezones} change':function(el,event){var key=el.val();self.parent.date().hide();self.parent.timezone().hide();self.parent.datetime(key).done(function(value){self.parent.showDatetime(key,value);self.parent.date().show();self.parent.timezone().show()})},'{reset} click':function(){self.setTimezone(self.parent.options.timezone)},'{local} click':function(){self.setTimezone('local')},setTimezone:function(tz){self.timezones().val(tz).trigger('liszt:updated').trigger('change')}}});module.resolve()})});EasySocial.module('apps/fields/user/datetime/dropdown',function($){var module=this;EasySocial.require().language('PLG_FIELDS_DATETIME_DAY').done(function(){EasySocial.Controller('Field.Datetime.Dropdown',{defaultOptions:{required:!1,allowTime:!1,allowTimezone:!1,yearfrom:null,yearto:null,'{dateValue}':'[data-field-datetime-value]','{year}':'[data-field-datetime-year]','{month}':'[data-field-datetime-month]','{day}':'[data-field-datetime-day]','{hour}':'[data-field-datetime-hour]','{minute}':'[data-field-datetime-minute]','{ampm}':'[data-field-datetime-ampm]'}},function(self){return{init:function()
{},'{year} change':function(el,ev)
{self.setValue()},'{month} change':function(el,ev)
{var year=self.year().val(),month=self.month().val();if(year!==''&&month!==''){var maxDay=new Date(year,month,0).getDate();var day=self.day().val();if(day!==''){day=Math.min(day,maxDay)}
self.day().empty();self.day().append($('<option value="">'+$.language('PLG_FIELDS_DATETIME_DAY')+'</option>'));for(i=1;i<=maxDay;i++){$('<option value="'+i+'">'+i+'</option>').appendTo(self.day())}
if(day!==''){self.day().val(day)}}
self.setValue()},'{day} change':function(el,ev)
{self.setValue()},'{hour} change':function(el,ev)
{self.setValue()},'{minute} change':function(el,ev)
{self.setValue()},'{ampm} change':function(el,ev)
{self.setValue()},setValue:function()
{var string;var year=self.year().val(),month=self.month().val(),day=self.day().val();if(year!==''&&month!==''&&day!==''){string=year+'-'+month+'-'+day;if(self.options.allowTime){var hour=self.hour().val(),minute=self.minute().val();if(hour!==''&&self.ampm().length>0&&self.ampm().val()=='pm'){hour=(parseInt(hour)+12).toString();if(hour==='24'){hour='0'}}
if(minute===''){minute='00'}
string+=' '+('00'+hour).slice(-2)+':'+('00'+minute).slice(-2)+':00'}
self.dateValue().val(string)}}}});module.resolve()})});EasySocial.module('apps/fields/user/datetime/sample_content',function($){var module=this;EasySocial.require().library('ui/datepicker').done(function(){EasySocial.Controller('Field.Datetime.Sample',{defaultOptions:{'{yearPrivacy}':'[data-yearprivacy]','{input}':'[data-field-datetime-select]','{timezone}':'[data-field-datetime-timezone]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'year_privacy':self.yearPrivacy().toggle(value);break;case 'allow_timezone':self.timezone().toggle(value);break;case 'placeholder':self.input().attr('placeholder',value);break}}}});module.resolve()})});EasySocial.module('apps/fields/user/dropdown/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE').done(function($){EasySocial.Controller('Field.Dropdown',{defaultOptions:{required:null,"{field}":"[data-field-dropdown]","{item}":"[data-field-dropdown-item]","{option}":"[data-field-dropdown-item] option"}},function(self)
{return{init:function()
{},validateInput:function()
{self.clearError();if(self.options.required&&$.isEmpty(self.item().val())){self.raiseError();return!1}
return!0},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE')])},clearError:function(){self.trigger('clear')},"{self} onSubmit":function(el,event,register){if(!self.options.required)
{register.push(!0);return}
register.push(self.validateInput());return},'{self} onSample':function(){if(self.option().length<1){self.item().append($('<option></option>'))}},'{self} onChoiceAdded':function(el,event,index){if(self.option().eq(index).length>0){self.option().eq(index).before($('<option></option>'))}else{self.item().append($('<option></option>'))}},'{self} onChoiceValueChanged':function(el,event,index,value){self.option().eq(index).val(value)},'{self} onChoiceTitleChanged':function(el,event,index,value){self.option().eq(index).text(value)},'{self} onChoiceRemoved':function(el,event,index){self.option().eq(index).remove()},'{self} onChoiceToggleDefault':function(el,event,index,value){self.option().removeAttr('selected');if(value){self.option().eq(index).attr('selected','selected')}}}});module.resolve()})});EasySocial.module('apps/fields/user/email/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_EMAIL_VALIDATION_REQUIRED','PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT').done(function($){EasySocial.Controller('Field.Email',{defaultOptions:{required:!1,regex:0,regexFormat:'',regexModifier:'',"{field}":"[data-field-email]","{input}":"[data-field-email-input]"}},function(self)
{return{init:function(){},validateInput:function(){var value=self.input().val();if(self.options.required&&$.isEmpty(value)){self.raiseError($.language('PLG_FIELDS_EMAIL_VALIDATION_REQUIRED'));return!1}
if(!$.isEmpty(value)&&self.options.regex){var regex=new RegExp(self.options.regexFormat,self.options.regexModifier);if(!regex.test(value)){self.raiseError($.language('PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT'));return!1}}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},"{self} onSubmit":function(el,event,register){register.push(self.validateInput());return}}});module.resolve()})});EasySocial.module('apps/fields/user/file/content',function($){var module=this;EasySocial.require().library('ui/sortable').language('PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED','COM_EASYSOCIAL_WORKING').done(function($){EasySocial.Controller('Field.File',{defaultOptions:{required:!1,id:null,inputName:'',maxFile:0,'{field}':'[data-field-file]','{list}':'[data-field-file-list]','{item}':'[data-field-file-item]','{add}':'[data-field-file-add]','{dragPlaceholder}':'.data-field-file-item-drag','{moveHandle}':'[data-field-file-move]'}},function(self){return{init:function(){self.options.maxFile=self.field().data('maxfile');self.item().addController('EasySocial.Controller.Field.File.Item',{controller:{parent:self}});self.initSortable()},initSortable:function(){self.list().sortable({items:self.item.selector,placeholder:'data-field-file-item-drag',handle:self.moveHandle.selector,forcePlaceholderSize:!0,start:function(event,ui){self.dragPlaceholder().width(ui.item.find('.file-wrap').width())}})},'{add} click':function(el,ev){if(self.options.maxFile<1||(self.item().length<self.options.maxFile)){var key=self.item().length;var item=$('<div class="data-field-file-item" data-field-file-item></div>');item.data('key',key);item.html($.language('COM_EASYSOCIAL_WORKING'));item.addController('EasySocial.Controller.Field.File.Item',{controller:{parent:self}});self.list().append(item);EasySocial.ajax('fields/user/file/getUploadHtml',{id:self.options.id,key:key}).done(function(html){item.html(html)});if(self.options.maxFile>1&&self.item().length>=self.options.maxFile){el.hide()}}},'{item} uploadDone':function(){self.add().click()}}});EasySocial.Controller('Field.File.Item',{defaultOptions:{required:!1,key:null,'{upload}':'[data-field-file-upload]','{progress}':'[data-field-file-progress]','{delete}':'[data-field-file-delete]','{clear}':'[data-field-file-clear]','{id}':'[data-field-file-id]','{tmp}':'[data-field-file-tmp]'}},function(self){return{init:function(){self.options.key=self.element.data('key')},'{upload} change':function(el,ev){self.element.html($.language('COM_EASYSOCIAL_WORKING'));EasySocial.ajax('fields/user/file/upload',{id:self.parent.options.id,files:el,key:self.options.key},{type:'iframe'}).done(function(html){self.element.html(html);self.trigger('uploadDone')}).fail(function(msg){self.element.html(msg||self.getErrorMsg())})},'{delete} click':function(el,ev){var tmp=self.tmp().val();var id=self.id().val();self.element.html($.language('COM_EASYSOCIAL_WORKING'));EasySocial.ajax('fields/user/file/delete',{id:self.parent.options.id,key:self.options.key,tmp:tmp,fileid:id}).done(function(html){self.element.html(html);self.trigger('fileDeleted')}).fail(function(msg){self.element.html(msg||self.getErrorMsg())})},'{clear} click':function(el,ev){self.element.html($.language('COM_EASYSOCIAL_WORKING'));EasySocial.ajax('fields/user/file/getUploadHtml',{id:self.parent.options.id,key:self.options.key}).done(function(html){self.element.html(html)})},getErrorMsg:function(){msg=$('<span class="alert field-file-error">'+$.language('PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED')+'<button class="close" type="button" data-field-file-clear></button></span>');return msg}}});module.resolve()})});EasySocial.module('apps/fields/user/file/sample_content',function($){var module=this;EasySocial.Controller('Field.File',{defaultOptions:{'{sizeText}':'[data-field-file-size-text]','{size}':'[data-field-file-size]','{add}':'[data-field-file-add]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,ev,name,value){switch(name){case 'size_limit':self.size().text(value);break;case 'show_size_limit':self.sizeText().toggle(!!value);break;case 'file_limit':self.add().toggle((value<1||value>1));break}}}});module.resolve()});EasySocial.module('apps/fields/user/gender/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED').done(function($){EasySocial.Controller('Field.Gender',{defaultOptions:{required:!1,'{field}':'[data-field-gender]','{selection}':'[data-field-gender-select]'}},function(self)
{return{init:function()
{},validateInput:function(){if(!self.options.required){return!0}
self.clearError();var value=self.selection(':checked').val();if($.isEmpty(value))
{self.raiseError();return!1}
return!0},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED')])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,event,register){register.push(self.validateInput())},'{selection} click':function(){self.validateInput()}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_email/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED','PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED','PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING').done(function($){EasySocial.Controller('Field.Joomla_email',{defaultOptions:{required:!0,id:null,userid:null,reconfirm:!1,event:null,'{input}':'[data-field-email-input]','{confirm}':'[data-field-email-reconfirm-input]','{confirmFrame}':'[data-field-email-reconfirm-frame]'}},function(self){return{init:function(){self.origEmail=self.input().val()},'{input} blur':function(el,ev){var value=self.input().val();if(self.options.reconfirm&&value!==self.origEmail)
{self.confirmFrame().show()}
if(self.options.reconfirm&&value===self.origEmail&&(self.options.event==='onEdit'||self.options.event==='onAdminEdit'))
{self.confirmFrame().hide()}
self.validateInput()},'{confirm} blur':function(el,ev){self.validateInput()},validateInput:function(){self.clearError();var value=self.input().val();if($.isEmpty(value)){if(!self.options.required){return!0}
self.raiseError($.language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED'));return!1}
if(self.options.reconfirm)
{var reconfirm=self.confirm().val();if(value!==self.origEmail&&$.isEmpty(reconfirm))
{self.raiseError($.language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED'));return!1}
if(!$.isEmpty(reconfirm)&&value!==reconfirm)
{self.raiseError($.language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING'));return!1}}
return self.checkInput().done(function(){self.clearError()}).fail(function(msg){self.raiseError(msg)})},checkInput:function(){return EasySocial.ajax('fields/user/joomla_email/isValid',{id:self.options.id,userid:self.options.userid,email:self.input().val()})},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,ev,register,mode){if(mode==='onRegisterMini'){return}
register.push(self.validateInput())}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_email/registermini_content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED','PLG_FIELDS_JOOMLA_EMAIL_CHECKING','PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT').done(function(){EasySocial.Controller('Field.Joomla_email.Mini',{defaultOptions:{require:!0,id:null,'{input}':'#email'}},function(self){return{init:function(){},'{input} keyup':function(el){if(el.val().length>0){self.delayedCheck()}},state:!1,delayedCheck:$.debounce(function(){self.checkEmail()},250),checkEmail:function(){self.clearError();var email=self.input().val();if(self.options.required&&email.length==0){self.raiseError($.language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED'));return!1}
if(!$.isEmpty(email)&&self.options.regex){var regex=new RegExp(self.options.regexFormat,self.options.regexModifier);if(!regex.test(email)){self.raiseError($.language('PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT'));return!1}}
if(email.length>0){var state=$.Deferred();self.setLoading($.language('PLG_FIELDS_JOOMLA_EMAIL_CHECKING'));var email=self.input().val();EasySocial.ajax('fields/user/joomla_email/isValid',{id:self.options.id,userid:0,email:email}).done(function(msg){self.setLoaded();state.resolve()}).fail(function(msg){self.setLoaded();self.raiseError(msg);state.reject()});return state}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,ev,register,mode){if(mode!=='onRegisterMini'){return}
if(self.options.required||self.input().val().length>0){register.push(self.checkEmail())}},setLoading:function(msg){self.trigger('loading',[msg])},setLoaded:function(){self.trigger('loaded')}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_email/sample_content',function($){var module=this;EasySocial.Controller('Field.Joomla_email.Sample',{defaultOptions:{'{confirmEmail}':'[data-field-email-reconfirm-frame]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'reconfirm_email':self.confirmEmail().toggle(value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/joomla_fullname/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME').done(function($){EasySocial.Controller('Field.Joomla_fullname',{defaultOptions:{nameFormat:1,max:0,required:!0,'{field}':'[data-field-joomla_fullname]','{firstName}':'[data-field-jname-first]','{middleName}':'[data-field-jname-middle]','{lastName}':'[data-field-jname-last]','{name}':'[data-field-jname-name]'}},function(self){return{init:function()
{self.options.nameFormat=self.field().data('name-format');self.options.max=self.field().data('max')},validateInput:function()
{self.clearError();if(!self.options.required){return!0}
if(self.options.nameFormat==3){if($.isEmpty(self.name().val())){self.raiseError();return!1}
return!0}
if($.isEmpty(self.firstName().val())){self.raiseError();return!1}
return!0},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME')])},clearError:function(){self.trigger('clear')},"{firstName} blur":function(el,event){self.validateInput()},"{name} blur":function(el,event){self.validateInput()},"{self} onError":function(el,event,type,field){self.raiseError()},"{self} onSubmit":function(el,event,register){register.push(self.validateInput());return}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_fullname/sample_content',function($){var module=this;EasySocial.Controller('Field.Joomla_fullname.Sample',{defaultOptions:{'{fullnameFormat}':'[data-fullname-format]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'format':self.switchFormat(value);break}},switchFormat:function(value){self.fullnameFormat().hide();self.fullnameFormat().eq(value-1).show()}}});module.resolve()});EasySocial.module('apps/fields/user/joomla_password/content',function($){var module=this;EasySocial.require().library('passwordstrength').language('PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD','PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD','PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING','PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR','PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR','PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK','PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK','PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL','PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG','PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG','PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD').done(function(){EasySocial.Controller('Field.Joomla_password',{defaultOptions:{event:null,required:!1,passwordStrength:!1,reconfirmPassword:!1,requireOriginal:!1,min:4,max:0,'{field}':'[data-field-joomla_password]','{original}':'[data-field-password-orig]','{input}':'[data-field-password-input]','{reconfirm}':'[data-field-password-confirm]','{strength}':'[data-field-password-strength]','{reconfirmNotice}':'[data-reconfirmPassword-failed]'}},function(self)
{return{init:function()
{if(self.options.passwordStrength){self.initPasswordStrength()}},'{input} keyup':function(){self.validatePassword()},'{input} blur':function(){self.validatePassword()},'{reconfirm} keyup':function(){self.validatePassword()},'{reconfirm} blur':function(){self.validatePassword()},validatePassword:function()
{self.clearError();var input=self.input().val(),reconfirm=self.reconfirm().val();if(self.options.event==='onRegister'&&!self.validatePasswordInput()){return!1}
if(self.options.event==='onEdit'&&!self.validatePasswordEdit()){return!1}
if(self.options.reconfirmPassword&&!self.validatePasswordConfirm()){return!1}
return!0},validatePasswordInput:function(){var input=self.input().val();if($.isEmpty(input)){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD'));return!1}
if(self.options.min>0&&input.length<self.options.min){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR',self.options.min));return!1}
if(self.options.max>0&&input.length>self.options.max){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR',self.options.max));return!1}
return!0},validatePasswordEdit:function(){var orig=self.original().val(),input=self.input().val();if($.isEmpty(input)&&$.isEmpty(orig)){return!0}
if($.isEmpty(orig)&&self.options.requireOriginal){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD'));return!1}
return self.validatePasswordInput()},validatePasswordConfirm:function(){var input=self.input().val(),reconfirm=self.reconfirm().val();if(!$.isEmpty(input)||!$.isEmpty(reconfirm)){if($.isEmpty(input)){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD'));return!1}
if($.isEmpty(reconfirm)){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD'));return!1}
if(input!==reconfirm){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING'));return!1}}
return!0},initPasswordStrength:function(){self.input().password_strength({container:self.strength.selector,minLength:self.options.min,texts:{1:$.language('PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK'),2:$.language('PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK'),3:$.language('PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL'),4:$.language('PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG'),5:$.language('PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG')},onCheck:function(level){if(level<=1){self.strength().removeClass('text-warning').removeClass('text-success').addClass('text-error small help-inline')}
if(level>1&&level<=3){self.strength().removeClass('text-error').removeClass('text-success').addClass('text-warning small help-inline')}
if(level>=4){self.strength().removeClass('text-error').removeClass('text-warning').addClass('text-success small help-inline')}}})},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},"{self} onSubmit":function(el,event,register,mode){if(mode==='onRegisterMini'){return}
register.push(self.validatePassword())}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_password/registermini_content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT','PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG','PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD').done(function(){EasySocial.Controller('Field.Joomla_password.Mini',{defaultOptions:{required:!1,min:4,max:0,'{input}':'[data-password]'}},function(self){return{init:function(){},'{input} keyup':function(){self.checkPassword()},checkPassword:function(){self.clearError();var value=self.input().val();if(self.options.min>0&&value.length<self.options.min){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT'));return!1}
if(self.options.max>0&&value.length>self.options.max){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG'));return!1}
if(self.options.required&&value.length==0){self.raiseError($.language('PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD'));return!1}
return!0},'{self} onSubmit':function(el,event,register,mode){if(mode!=='onRegisterMini'){return}
register.push(self.checkPassword())},clearError:function(){self.trigger('clear')},raiseError:function(msg){self.trigger('error',[msg])}}});module.resolve()})})
EasySocial.module('apps/fields/user/joomla_password/sample_content',function($){var module=this;EasySocial.Controller('Field.Joomla_password.Sample',{defaultOptions:{'{confirmPassword}':'[data-password-confirm]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'reconfirm_password':self.confirmPassword().toggle(value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/joomla_timezone/content',function($){var module=this;EasySocial.require().library('chosen').language('PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE').done(function($){EasySocial.Controller('Field.Joomla_timezone',{defaultOptions:{required:!1,'{field}':'[data-field-joomla_timezone]','{input}':'[data-field-joomla_timezone-input]'}},function(self){return{init:function(){self.input().chosen({allow_single_deselect:!0,search_contains:!0})},validateInput:function(){if(!self.options.required){return!0}
self.clearError();var value=self.input().val();if(value==='null'||$.isEmpty(value)){self.raiseError();return!1}
return!0},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE')])},clearError:function(){self.trigger('clear')},'{input} change':function(){self.validateInput()},"{self} onSubmit":function(el,event,register){register.push(self.validateInput())}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_username/content',function($){var module=this;EasySocial.Controller('Field.Joomla_username',{defaultOptions:{event:null,id:null,userid:null,'{checkUsernameButton}':'[data-username-check]','{input}':'[data-username-input]','{available}':'[data-username-available]'}},function(self){return{state:!1,init:function(){},'{checkUsernameButton} click':function(){self.delayedCheck()},'{input} blur':function(){self.delayedCheck()},'{input} keyup':function(){self.delayedCheck()},delayedCheck:$.debounce(function(){self.checkUsername()},250),checkUsername:function(){self.clearError();var state=$.Deferred();self.checkUsernameButton().addClass('btn-loading');var username=self.input().val();EasySocial.ajax('fields/user/joomla_username/isValid',{id:self.options.id,userid:self.options.userid,username:username,event:self.options.event}).done(function(msg){self.checkUsernameButton().removeClass('btn-loading');self.available().show();state.resolve()}).fail(function(msg){self.raiseError(msg);self.checkUsernameButton().removeClass('btn-loading');self.available().hide();state.reject()});return state},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,ev,register,mode){if(mode==='onRegisterMini'){return}
register.push(self.checkUsername())}}});module.resolve()});EasySocial.module('apps/fields/user/joomla_username/registermini_content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_JOOMLA_USERNAME_CHECKING','PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME').done(function(){EasySocial.Controller('Field.Joomla_username.Mini',{defaultOptions:{id:null,required:!1,'{input}':'#joomla_username'}},function(self){return{init:function(){},'{input} keyup':function(el){if(el.val().length>0){self.delayedCheck()}},state:!1,delayedCheck:$.debounce(function(){self.checkUsername()},250),checkUsername:function(){var username=self.input().val();if(self.options.required&&username.length==0){self.raiseError($.language('PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME'));return!1}
if(username.length>0){var state=$.Deferred();self.clearError();self.setLoading($.language('PLG_FIELDS_JOOMLA_USERNAME_CHECKING'));EasySocial.ajax('fields/user/joomla_username/isValid',{id:self.options.id,userid:0,username:username}).done(function(msg){self.setLoaded();state.resolve()}).fail(function(msg){self.setLoaded();self.raiseError(msg);state.reject()});return state}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,ev,register,mode){if(mode!=='onRegisterMini'){return}
if(self.options.required||self.input().val().length>0){register.push(self.checkUsername())}},setLoading:function(msg){self.trigger('loading',[msg])},setLoaded:function(){self.trigger('loaded')}}});module.resolve()})});EasySocial.module('apps/fields/user/joomla_username/sample_content',function($){var module=this;EasySocial.Controller('Field.Joomla_username.Sample',{defaultOptions:{'{checkUsername}':'[data-check-username]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'check_username':self.checkUsername().toggle(!!value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/multidropdown/content',function($){var module=this;EasySocial.require().library('ui/sortable').language('PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD').done(function(){EasySocial.Controller('Field.Multidropdown',{defaultOptions:{required:!1,id:null,inputName:'',max:0,'{field}':'[data-field-multidropdown]','{list}':'[data-field-multidropdown-list]','{item}':'[data-field-multidropdown-item]','{input}':'[data-field-multidropdown-input]','{add}':'[data-field-multidropdown-add]','{delete}':'[data-field-multidropdown-delete]','{move}':'[data-field-multidropdown-move]'}},function(self){return{init:function(){self.options.max=self.field().data('max');self.initSortable()},initSortable:function(){self.list().sortable({items:self.item.selector,handle:self.move.selector})},'{add} click':function(el){if(self.options.max<1||self.item().length<self.options.max)
{var item=self.item().eq(0).clone();item.find(self.input.selector).attr('value','').val('');self.list().append(item)}
if(self.options.max>0&&self.item().length>=self.options.max)
{el.hide()}},'{delete} click':function(el){var item=el.parents(self.item.selector);if(self.item().length>1){item.remove()}else{item.find(self.input.selector).val('')}
if(self.options.max>0&&self.item().length<self.options.max){self.add().show()}},'{self} onConfigChange':function(el,ev,name,value){switch(name){case 'add_button_text':self.add().text(value);break}},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD')])},'{self} onSubmit':function(el,ev,register){if(!self.options.required){register.push(!0);return}
var state=!1;$.each(self.input(),function(i,element){if(!$.isEmpty($(element).val())){state=!0;return!1}});if(!state){self.raiseError()}
register.push(state)}}});module.resolve()})});EasySocial.module('apps/fields/user/multilist/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE').done(function($){EasySocial.Controller('Field.Multilist',{defaultOptions:{required:null,multiple:null,"{field}":"[data-field-multilist]","{item}":"[data-field-multilist-item]","{option}":"[data-field-multilist-item] option"}},function(self)
{return{init:function()
{},validateInput:function()
{self.clearError();if(self.options.multiple&&self.item().children(':selected').length<=0){self.raiseError();return!1}
if(self.item().children(':selected').val()==''){self.raiseError();return!1}
return!0},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE')])},clearError:function(){self.trigger('clear')},"{self} onSubmit":function(el,event,register){if(!self.options.required)
{register.push(!0);return}
register.push(self.validateInput());return},'{self} onSample':function(){if(self.option().length<1){self.item().append($('<option></option>'))}},'{self} onChoiceAdded':function(el,event,index){if(self.option().eq(index).length>0){self.option().eq(index).before($('<option></option>'))}else{self.item().append($('<option></option>'))}},'{self} onChoiceValueChanged':function(el,event,index,value){self.option().eq(index).val(value)},'{self} onChoiceTitleChanged':function(el,event,index,value){self.option().eq(index).text(value)},'{self} onChoiceRemoved':function(el,event,index){self.option().eq(index).remove()},'{self} onChoiceToggleDefault':function(el,event,index,value){if(value){self.option().eq(index).attr('selected','selected')}else{self.option().eq(index).removeAttr('selected')}}}});module.resolve()})});EasySocial.module('apps/fields/user/multitextbox/content',function($){var module=this;EasySocial.require().library('ui/sortable').language('PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD').done(function(){EasySocial.Controller('Field.Multitextbox',{defaultOptions:{required:!1,id:null,inputName:'',max:0,'{field}':'[data-field-multitextbox]','{list}':'[data-field-multitextbox-list]','{item}':'[data-field-multitextbox-item]','{input}':'[data-field-multitextbox-input]','{add}':'[data-field-multitextbox-add]','{delete}':'[data-field-multitextbox-delete]','{move}':'[data-field-multitextbox-move]'}},function(self){return{init:function(){self.options.max=self.field().data('max');self.initSortable()},initSortable:function(){self.list().sortable({items:self.item.selector,handle:self.move.selector})},'{add} click':function(el){if(self.options.max<1||self.item().length<self.options.max)
{var item=self.item().eq(0).clone();item.find(self.input.selector).attr('value','').val('');self.list().append(item)}
if(self.options.max>0&&self.item().length>=self.options.max)
{el.hide()}},'{delete} click':function(el){var item=el.parents(self.item.selector);if(self.item().length>1){item.remove()}else{item.find(self.input.selector).val('')}
if(self.options.max>0&&self.item().length<self.options.max){self.add().show()}},'{self} onConfigChange':function(el,ev,name,value){switch(name){case 'add_button_text':self.add().text(value);break}},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD')])},'{self} onSubmit':function(el,ev,register){if(!self.options.required){register.push(!0);return}
var state=!1;$.each(self.input(),function(i,element){if(!$.isEmpty($(element).val())){state=!0;return!1}});if(!state){self.raiseError()}
register.push(state)}}});module.resolve()})});EasySocial.module('apps/fields/user/permalink/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH','PLG_FIELDS_PERMALINK_REQUIRED').done(function($){EasySocial.Controller('Field.Permalink',{defaultOptions:{required:!1,max:0,id:null,userid:null,'{field}':'[data-field-permalink]','{checkButton}':'[data-permalink-check]','{input}':'[data-permalink-input]','{available}':'[data-permalink-available]'}},function(self)
{return{state:!1,init:function()
{self.options.max=self.field().data('max')},"{checkButton} click":function()
{self.delayedCheck()},"{input} blur":function()
{self.delayedCheck()},"{input} keyup":function()
{self.delayedCheck()},delayedCheck:$.debounce(function(){self.checkPermalink()},250),checkPermalink:function()
{self.clearError();var permalink=self.input().val();self.available().hide();if(self.options.max>0&&permalink.length>self.options.max){self.raiseError($.language('PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH'));return!1}
if(!$.isEmpty(permalink))
{self.checkButton().addClass('btn-loading');var state=$.Deferred();EasySocial.ajax('fields/user/permalink/isValid',{"id":self.options.id,"userid":self.options.userid,"permalink":permalink}).done(function(msg)
{self.checkButton().removeClass('btn-loading');self.available().show();state.resolve()}).fail(function(msg)
{self.raiseError(msg);self.checkButton().removeClass('btn-loading');self.available().hide();state.reject()});return state}
if(self.options.required&&$.isEmpty(permalink))
{self.available().hide();self.raiseError($.language('PLG_FIELDS_PERMALINK_REQUIRED'));return!1}
return!0},raiseError:function(msg)
{self.trigger('error',[msg])},clearError:function()
{self.trigger('clear')},'{self} onSubmit':function(el,ev,register)
{register.push(self.checkPermalink())}}});module.resolve()})});EasySocial.module('apps/fields/user/permalink/sample_content',function($){var module=this;EasySocial.Controller('Field.Permalink.Sample',{defaultOptions:{'{checkPermalink}':'[data-check-permalink]'}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'check_permalink':self.checkPermalink().toggle(!!value);break}}}});module.resolve()});EasySocial.module('apps/fields/user/relationship/content',function($){var module=this;EasySocial.require().script('site/friends/suggest').language('PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM','PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE','COM_EASYSOCIAL_CANCEL_BUTTON').done(function($){EasySocial.Controller('Field.Relationship',{defaultOptions:{required:!1,id:null,types:null,fieldname:null,actor:null,target:null,'{field}':'[data-field-relationship]','{display}':'[data-relationship-display]','{form}':'[data-relationship-form]','{confirm}':'[data-relationship-display-confirm]','{pending}':'[data-relationship-display-pending]','{actions}':'[data-relationship-display-actions]','{pendingTitle}':'[data-relationship-pending-title]'}},function(self){return{init:function(){EasySocial.module('field.relationship/'+self.options.id).done(function(types){self.options.types=types});self.display().addController('EasySocial.Controller.Field.Relationship.Display',{controller:{parent:self}});self.addPlugin('form')},'{self} relationshipDeleted':function(){self.confirm().hide();self.form().show()}}});EasySocial.Controller('Field.Relationship.Form',{defaultOptions:{origType:null,origTarget:null,origApproved:null,'{form}':'[data-relationship-form]','{type}':'[data-relationship-form-type]','{connectWord}':'[data-relationship-form-connectwords]','{connectWords}':'[data-relationship-form-connectwords] span','{input}':'[data-relationship-form-input]','{target}':'[data-relationship-form-target]','{targetAvatar}':'[data-relationship-form-target-avatar]','{targetName}':'[data-relationship-form-target-name]','{targetPending}':'[data-relationship-form-target-pending]','{targetDelete}':'[data-relationship-form-target-delete]','{textboxlistDelete}':'[data-textboxlist-itemRemoveButton]'}},function(self){return{init:function(){self.input().addController(EasySocial.Controller.Friends.Suggest,{max:1,name:self.parent.options.fieldname+'[target][]'});self.options.origType=self.form().data('orig-type');self.options.origTarget=self.form().data('orig-target');self.options.origApproved=self.form().data('orig-approved')},'{type} change':function(el){var name=el.val();var isConnect=self.parent.options.types[name].connect;var items=self.input().controller('Textboxlist').getAddedItems();var isSelected=items.length>0;var element=isSelected?self.target():self.input();var selected=isSelected?items[0]:!1;if(isConnect){element.show();if(isSelected&&self.options.origApproved&&selected.id==self.options.origTarget&&name==self.options.origType){self.targetPending().hide()}else{self.targetPending().show()}}else{element.hide()}
self.connectWords().hide();self.connectWords().filterBy('relationship-form-connectword',name).show()},'{input} addItem':function(el,ev,item){if(item.avatar){self.targetAvatar().attr('src',item.avatar)}
if(item.screenName){self.targetName().text(item.screenName)}
if(item.id){self.targetDelete().data('id',item.id)}
self.input().hide();self.target().show();if(self.options.origApproved&&item.id==self.options.origTarget&&self.type().val()==self.options.origType){self.targetPending().hide()}else{self.targetPending().show()}},'{targetDelete} click':function(el,ev){var id=el.data('id');self.input().controller('Textboxlist').removeItem(id);self.input().show();self.target().hide()},'{parent} relationshipApproved':function(el,ev,target){self.type().val(target.type);var item={avatar:target.avatar,html:target.name+'<input type="hidden" name="'+self.parent.options.fieldname+'[target][]" value="'+target.id+'"/>',id:target.id,key:target.name,menuHtml:undefined,name:self.parent.options.fieldname+'[target]',screenName:target.name,title:target.name}
self.input().controller('Textboxlist').addItem(item);self.connectWords().hide();self.connectWords().filterBy('relationshipFormConnectword',target.type)}}});EasySocial.Controller('Field.Relationship.Display',{defaultOptions:{id:null,'{pendingFrame}':'[data-relationship-display-pending-text]','{loadingFrame}':'[data-relationship-display-loading]','{errorFrame}':'[data-relationship-display-error]','{actionsFrame}':'[data-relationship-display-actions]','{deleteButton}':'[data-relationship-display-actions-delete]','{approveButton}':'[data-relationship-display-actions-approve]','{rejectButton}':'[data-relationship-display-actions-reject]'}},function(self){return{init:function(){self.options.id=self.element.data('id')},'{deleteButton} click':function(){self.parent.trigger('relationshipDeleted');self.element.hide()},'{approveButton} click':function(){EasySocial.dialog({width:500,content:$.language('PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM'),selectors:{'{approveButton}':'[data-approve-button]','{cancelButton}':'[data-cancel-button]'},bindings:{'{approveButton} click':function(){this.parent.close();self.approveRelationship()},'{cancelButton} click':function(){this.parent.close()}},buttons:'<button data-cancel-button type="button" class="btn btn-es">'+$.language('COM_EASYSOCIAL_CANCEL_BUTTON')+'</button><button data-approve-button type="button" class="btn btn-es-primary">'+$.language('PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE')+'</button>'})},approveRelationship:function(){self.actionsFrame().hide();self.loadingFrame().show();EasySocial.ajax('fields/user/relationship/approve',{id:self.parent.options.id,relid:self.options.id}).done(function(target){self.parent.display().hide();self.element.show();self.element.removeAttr('data-relationship-display-pending');self.element.attr('data-relationship-display-confirm','');self.parent.form().before(self.element);self.parent.form().hide();if(self.parent.pending().length<1){self.parent.pendingTitle().hide()}
self.loadingFrame().remove();self.pendingFrame().remove();self.approveButton().remove();self.rejectButton().remove();self.actionsFrame().show();self.deleteButton().show();self.parent.trigger('relationshipApproved',[target])}).fail(function(msg){self.loadingFrame().hide();self.errorFrame().show().find('span').text(msg)})},'{rejectButton} click':function(){self.actionsFrame().hide();self.loadingFrame().show();EasySocial.ajax('fields/user/relationship/reject',{id:self.parent.options.id,relid:self.options.id}).done(function(){self.element.remove();if(self.parent.pending().length<1){self.parent.pendingTitle().hide()}}).fail(function(msg){self.parent.trigger('relationshipActionError',[msg])})}}});module.resolve()})});EasySocial.module('site/friends/suggest',function($){var module=this;EasySocial.require().view('site/friends/suggest.item').library('textboxlist').language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT').done(function($){EasySocial.Controller('Friends.Suggest.User',{defaultOptions:{"{addButton}":"[data-friend-suggest-add]","{button}":"[data-friend-suggest-button]"}},function(self)
{return{init:function()
{},"{addButton} click":function(el){EasySocial.ajax('site/controllers/friends/request',{"id":self.element.data('uid')}).done(function(friendId){self.button().html($.language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT'))}).fail(function(obj){EasySocial.dialog({width:450,height:180,content:obj.message})})}}});EasySocial.Controller('Friends.Suggest',{defaultOptions:{max:null,exclusive:!0,exclusion:[],minLength:1,highlight:!0,name:"uid[]",type:"",friendList:!1,friendListName:"",view:{suggestItem:"site/friends/suggest.item"}}},function(self)
{return{init:function()
{var options=self.options;self.element.textboxlist({component:'es',name:options.name,max:options.max,plugin:{autocomplete:{exclusive:options.exclusive,minLength:options.minLength,highlight:options.highlight,showLoadingHint:!0,showEmptyHint:!0,query:function(keyword)
{if(!options.friendList)
{return EasySocial.ajax("site/controllers/friends/suggest",{search:keyword,type:options.type})}
return EasySocial.ajax("site/controllers/friends/suggestWithList",{search:keyword,"inputName":options.name,"friendListName":options.friendListName})}}}}).textboxlist("enable")},"{self} filterItem":function(el,event,item)
{if(self.options.friendList)
{return}
var html=self.view.suggestItem(!0,{item:item,name:self.options.name});item.title=item.screenName;item.menuHtml=html;item.html=html;return item},"{self} filterMenu":function(el,event,menu,menuItems,autocomplete,textboxlist)
{if(self.options.friendList)
{return}
var items=textboxlist.getAddedItems(),users=$.pluck(items,"id"),users=users.concat(self.options.exclusion);menuItems.each(function(){var menuItem=$(this),item=menuItem.data("item");menuItem.toggleClass("hidden",$.inArray(item.id.toString(),users)>-1)})}}});module.resolve()})});EasySocial.module('apps/fields/user/separator/sample',function($){var module=this;EasySocial.Controller('Field.Separator.Sample',{defaultOptions:{"{items}":"[data-separator-type]"}},function(self)
{return{"{self} onConfigChange":function(el,event,name,value)
{if(name=='type')
{var itemToShow=$('[data-separator-'+value+']');self.items().hide();itemToShow.show()}}}});module.resolve()});EasySocial.module('apps/fields/user/terms/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_TERMS_VALIDATION_REQUIRED').done(function($){EasySocial.Controller('Field.Terms',{defaultOptions:{event:null,required:!1,'{textbox}':'[data-field-terms-textbox]','{checkbox}':'[data-field-terms-checkbox]'}},function(self)
{return{init:function(){},validateInput:function(){self.clearError();if(self.options.event=='onAdminEdit'){return!0}
if(self.options.required&&!self.checkbox().is(':checked'))
{self.raiseError();return!1}
return!0},'{checkbox} change':function(){self.validateInput()},raiseError:function(){self.trigger('error',[$.language('PLG_FIELDS_TERMS_VALIDATION_REQUIRED')])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,event,register){register.push(self.validateInput())},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'message':self.textbox().val(value);break}}}});module.resolve()})});EasySocial.module('apps/fields/user/textarea/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED','PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT','PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG').done(function($){EasySocial.Controller('Field.Textarea',{defaultOptions:{required:!1,min:0,max:0,'{field}':'[data-field-textarea]','{input}':'[data-field-textarea-input]'}},function(self){return{init:function(){self.options.min=self.field().data('min');self.options.max=self.field().data('max')},validateInput:function()
{self.clearError();var val=self.input().val();if(self.options.required&&$.isEmpty(val)){self.raiseError($.language('PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED'));return!1}
if(!$.isEmpty(val)&&self.options.min>0&&val.length<self.options.min){self.raiseError($.language('PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT'));return!1}
if(self.options.max>0&&val.length>self.options.max){self.raiseError($.language('PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG'));return!1}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onSubmit':function(el,event,register){register.push(self.validateInput())},'{self} onError':function(el,ev,type){if(type==='required'){self.raiseError($.language('PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED'))}},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'default':self.input().val(value);break;case 'placeholder':self.input().attr('placeholder',value);break;case 'readonly':if(value){self.input().attr('readonly','readonly')}else{self.input().removeAttr('readonly')}
break}}}});module.resolve()})});EasySocial.module('apps/fields/user/textbox/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED','PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT','PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG','PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT').done(function($){EasySocial.Controller('Field.Textbox',{defaultOptions:{required:!1,min:0,max:0,'{field}':'[data-field-textbox]','{input}':'[data-field-textbox-input]','{notice}':'[data-check-notice]'}},function(self){return{init:function(){self.options.min=self.field().data('min');self.options.max=self.field().data('max')},'{input} keyup':function()
{self.validateInput()},'{input} blur':function()
{self.validateInput()},validateInput:function()
{self.clearError();var value=self.input().val();if(self.options.required&&$.isEmpty(value)){self.raiseError($.language('PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED'));return!1}
if(!$.isEmpty(value)&&self.options.min>0&&value.length<self.options.min){self.raiseError($.language('PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT'));return!1}
if(self.options.max>0&&value.length>self.options.max){self.raiseError($.language('PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG'));return!1}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onError':function(el,ev,type){if(type==='required'){self.raiseError($.language('PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED'))}
if(type==='validate'){self.raiseError($.language('PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT'))}},'{self} onSubmit':function(el,ev,register){register.push(self.validateInput())}}});module.resolve()})});EasySocial.module('apps/fields/user/textbox/sample_content',function($){var module=this;EasySocial.Controller('Field.Textbox.Sample',{defaultOptions:{'{input}':'[data-input]','min':'','max':'','regex_validate':!1,'regex_format':'','regex_modifier':''}},function(self){return{init:function(){},'{self} onConfigChange':function(el,event,name,value){switch(name){case 'placeholder':self.input().attr('placeholder',value);break;case 'default':self.input().val(value);break;case 'readonly':if(value){self.input().attr('disabled','disabled')}else{self.input().removeAttr('disabled')}
break;break}}}});module.resolve()});EasySocial.module('apps/fields/user/url/content',function($){var module=this;EasySocial.require().language('PLG_FIELDS_URL_VALIDATION_EMPTY_URL').done(function($){EasySocial.Controller('Field.Url',{defaultOptions:{required:!1,'{input}':'[data-field-url-input]'}},function(self){return{init:function(){},'{input} blur':function(){self.validateInput()},validateInput:function(){self.clearError();var value=self.input().val();if(self.options.required&&$.isEmpty(value)){self.raiseError($.language('PLG_FIELDS_URL_VALIDATION_EMPTY_URL'));return!1}
return!0},raiseError:function(msg){self.trigger('error',[msg])},clearError:function(){self.trigger('clear')},'{self} onError':function(el,event,type,field){self.raiseError($.language('PLG_FIELDS_URL_VALIDATION_EMPTY_URL'))}}});module.resolve()})});EasySocial.module('apps/fields/user/url/sample_content',function($){var module=this;EasySocial.Controller('Field.Url.Sample',{defaultOptions:{'{urlInput}':'[data-url-input]'}},function(self){return{'{self} onConfigChange':function(el,event,name,value){switch(name){case 'placeholder':self.urlInput().attr('placeholder',value);break;case 'default':self.urlInput().val(value);break}}}});module.resolve()});EasySocial.module('apps/group/feeds',function($){var module=this;EasySocial.Controller('Groups.Apps.Feeds',{defaultOptions:{"{browser}":"[data-feeds-browser]","{sources}":"[data-feeds-sources]","{item}":"[data-feeds-list-item]","{create}":"[data-feeds-create]","{list}":"[data-feeds-list]","{remove}":"[data-feeds-remove]"}},function(self){return{init:function()
{self.options.id=self.element.data('groupid');self.options.appId=self.element.data('appid');self.list().implement(EasySocial.Controller.Groups.Apps.Feeds.List)},"{remove} click":function(el)
{var feedId=$(el).data('id'),item=self.item.of(el);EasySocial.dialog({content:EasySocial.ajax('apps/group/feeds/controllers/feeds/confirmDelete',{"groupId":self.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax('apps/group/feeds/controllers/feeds/delete',{"appId":self.options.appId,"feedId":feedId,"groupId":self.options.id}).done(function(){item.remove();if(self.sources().children().length==0){self.browser().addClass('is-empty')}
EasySocial.dialog().close()})}}})},"{create} click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/group/feeds/controllers/feeds/create',{"id":self.options.id}),bindings:{"{saveButton} click":function(){var title=this.title().val(),url=this.url().val();var notice=$('[data-feeds-form-notice]');notice.removeClass('alert alert-error');notice.addClass('hide');if(title.trim().length==0){notice.text($.language('Please enter title.'));notice.addClass('alert alert-error');notice.removeClass('hide');return}
if(url.trim().length==0){notice.text($.language('Please enter URL.'));notice.addClass('alert alert-error');notice.removeClass('hide');return}
EasySocial.ajax('apps/group/feeds/controllers/feeds/save',{"title":this.title().val(),"url":this.url().val(),"appId":self.options.appId,"groupId":self.options.id}).done(function(output){self.browser().removeClass('is-empty');self.sources().append(output);EasySocial.dialog().close()})}}})}}});EasySocial.Controller('Groups.Apps.Feeds.List',{defaultOptions:{"{item}":"[data-feed-item]","{openPreview}":"[data-feed-open]","{preview}":"[data-feed-preview]"}},function(self){return{init:function()
{},"{openPreview} click":function(el)
{var item=self.item.of(el),preview=item.find(self.preview.selector);if(!preview.hasClass('hide')){preview.addClass('hide')}else{self.preview().addClass('hide');preview.removeClass('hide')}}}});module.resolve()});EasySocial.module('apps/group/tasks',function($)
{var module=this;EasySocial.Controller('Groups.Apps.Tasks.Milestones.Browse',{defaultOptions:{"{milestone}":"[data-group-tasks-milestone-item]"}},function(self)
{return{init:function()
{self.options.groupId=self.element.data('groupid');self.milestone().implement(EasySocial.Controller.Groups.Apps.Tasks.Milestones.Item,{"{parent}":self})}}});EasySocial.Controller('Groups.Apps.Tasks.Milestones.Item',{defaultOptions:{"{complete}":"[data-milestone-mark-complete]","{uncomplete}":"[data-milestone-mark-uncomplete]","{delete}":"[data-milestone-delete]","{milestone}":"[data-group-tasks-milestone-item]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{uncomplete} click":function()
{EasySocial.ajax('apps/group/tasks/controllers/milestone/unresolve',{id:self.options.id,groupId:self.parent.options.groupId}).done(function()
{self.element.removeClass('is-due').removeClass('is-completed')})},"{complete} click":function()
{EasySocial.ajax('apps/group/tasks/controllers/milestone/resolve',{id:self.options.id,groupId:self.parent.options.groupId}).done(function()
{self.element.removeClass('is-due').addClass('is-completed')})},"{delete} click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/group/tasks/controllers/milestone/confirmDelete',{id:self.options.id,groupId:self.parent.options.groupId}),bindings:{'{deleteButton} click':function()
{EasySocial.ajax('apps/group/tasks/controllers/milestone/delete',{id:self.options.id,groupId:self.parent.options.groupId}).done(function()
{EasySocial.dialog().close();self.element.remove()})}}})}}});EasySocial.Controller('Groups.Apps.Tasks',{defaultOptions:{'{form}':'[data-group-tasks-form]','{formWrapper}':'[data-group-tasks-form-wrapper]','{taskList}':'[data-group-tasks-list]','{item}':'[data-group-tasks-list-item]','{completedList}':'[data-group-tasks-completed]','{openCounter}':'[data-tasks-open-counter]','{closedCounter}':'[data-tasks-closed-counter]',"{completeMilestone}":"[data-milestone-mark-complete]","{uncompleteMilestone}":"[data-milestone-mark-uncomplete]","{deleteMilestone}":"[data-milestone-delete]","{wrapper}":"[data-group-tasks-wrapper]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.groupId=self.element.data('groupid');self.options.milestoneId=self.element.data('milestoneid');self.form().implement(EasySocial.Controller.Groups.Apps.Tasks.Form,{"{parent}":self});self.implementItemController()},implementItemController:function()
{self.item().implement(EasySocial.Controller.Groups.Apps.Tasks.Item,{"{parent}":self})},updateOpenCounter:function(total)
{self.openCounter().html(total)},updateClosedCounter:function(total)
{self.closedCounter().html(total)},insertCompleted:function(taskItem)
{$(taskItem).appendTo(self.completedList())},insertTask:function(taskItem)
{self.formWrapper().after(taskItem);self.implementItemController()},"{uncompleteMilestone} click":function()
{EasySocial.ajax('apps/group/tasks/controllers/milestone/unresolve',{id:self.options.milestoneId,groupId:self.options.groupId}).done(function()
{self.wrapper().removeClass('is-due').removeClass('is-completed')})},"{completeMilestone} click":function()
{EasySocial.ajax('apps/group/tasks/controllers/milestone/resolve',{id:self.options.milestoneId,groupId:self.options.groupId}).done(function()
{self.wrapper().removeClass('is-due').addClass('is-completed')})},"{deleteMilestone} click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/group/tasks/controllers/milestone/confirmDelete',{id:self.options.milestoneId,groupId:self.options.groupId}),bindings:{'{deleteButton} click':function()
{EasySocial.ajax('apps/group/tasks/controllers/milestone/delete',{id:self.options.id,groupId:self.options.groupId}).done(function()
{EasySocial.dialog().close();window.location=self.options.redirect})}}})}}});EasySocial.Controller('Groups.Apps.Tasks.Item',{defaultOptions:{'{checkbox}':'[data-item-checkbox]','{delete}':'[data-tasks-item-remove]'}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},'{delete} click':function()
{EasySocial.dialog({content:EasySocial.ajax('apps/group/tasks/controllers/tasks/confirmDelete',{'groupId':self.parent.options.groupId}),bindings:{'{deleteButton} click':function()
{EasySocial.ajax('apps/group/tasks/controllers/tasks/delete',{id:self.options.id,groupId:self.parent.options.groupId}).done(function()
{EasySocial.dialog().close();var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total-1);self.element.remove()})}}})},'{checkbox} change':function(el,event)
{var checked=$(el).is(':checked');if(checked)
{EasySocial.ajax('apps/group/tasks/controllers/tasks/resolve',{id:self.options.id,groupId:self.parent.options.groupId}).done(function()
{var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total-1);var total=parseInt(self.parent.closedCounter().html());self.parent.updateClosedCounter(total+1);self.parent.insertCompleted(self.element)})}
else{EasySocial.ajax('apps/group/tasks/controllers/tasks/unresolve',{id:self.options.id,groupId:self.parent.options.groupId}).done(function($)
{var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total+1);var total=parseInt(self.parent.closedCounter().html());self.parent.updateClosedCounter(total-1);self.parent.insertTask(self.element)})}}}});EasySocial.Controller('Groups.Apps.Tasks.Form',{defaultOptions:{'{title}':"[data-form-tasks-title]",'{create}':"[data-form-tasks-create]",'{assignee}':"[data-form-tasks-assignee]",'{due}':"[data-form-tasks-due]",'{error}':"[data-group-tasks-form-error]"}},function(self)
{return{init:function()
{},resetForm:function()
{self.element[0].reset()},"{title} keyup":function(el,event)
{if(event.keyCode==13)
{self.create().click()}},"{create} click":function()
{if(self.title().val()=='')
{self.error().removeClass('hide');return!1}
self.error().addClass('hide');EasySocial.ajax('apps/group/tasks/controllers/tasks/save',{title:self.title().val(),assignee:self.assignee().val(),due:self.due().val(),groupId:self.parent.options.groupId,milestoneId:self.parent.options.id}).done(function(content)
{self.resetForm();var total=parseInt(self.parent.openCounter().html());self.parent.updateOpenCounter(total+1);self.parent.insertTask(content)})}}});module.resolve()});EasySocial.module('avatar',function($){var module=this;EasySocial.Controller('Avatar',{defaultOptions:{uid:null,type:null,redirectUrl:null,"{menu}":"[data-avatar-menu]","{uploadButton}":"[data-avatar-upload-button]","{selectButton}":"[data-avatar-select-button]","{removeButton}":"[data-avatar-remove-button]"}},function(self)
{return{init:function()
{},"{uploadButton} click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/avatar/upload',{'uid':self.options.uid,'type':self.options.type})})},"{selectButton} click":function()
{EasySocial.photos.selectPhoto({uid:self.options.uid,type:self.options.type,bindings:{"{self} photoSelected":function(el,event,photos)
{var photo=photos[0];if(!photo)
{return}
EasySocial.photos.createAvatar(photo.id,{"uid":self.options.uid,"type":self.options.type,"redirectUrl":self.options.redirectUrl})},"{cancelButton} click":function(){this.parent.close()}}})},"{menu} shown.bs.dropdown":function()
{self.element.addClass("show-all")},"{menu} hidden.bs.dropdown":function()
{self.element.removeClass("show-all")},"{removeButton} click":function()
{}}});module.resolve()});EasySocial.module('cover',function($){var module=this;EasySocial.require().library("image").done(function(){EasySocial.Controller('Cover',{defaultOptions:{uid:null,type:null,"{image}":"[data-cover-image]","{editButton}":"[data-cover-edit-button]","{doneButton}":"[data-cover-done-button]","{cancelButton}":"[data-cover-cancel-button]","{uploadButton}":"[data-cover-upload-button]","{selectButton}":"[data-cover-select-button]","{removeButton}":"[data-cover-remove-button]","{menu}":"[data-cover-menu]","{flyout}":".es-flyout-content"}},function(self,opts,base){return{init:function(){self.setLayout();if(self.element.hasClass("editing")){self.enable()}},"{editButton} click":function(){self.enable();self.reposition=!0;self.image().css('backgroundPosition',self.element.css('backgroundPosition'))},"{cancelButton} click":function(el,ev){self.disable()},reposition:!1,ready:!1,disabled:!0,toggle:function(){self[(self.disabled)?"enable":"disable"]()},enable:function(){self.setLayout();self.disabled=!1;self.element.addClass("editing");base.attr("data-es-photo-disabled",1)},disable:function(){self.reposition=!1;self.disabled=!0;self.element.removeClass("editing");setTimeout(function(){base.attr("data-es-photo-disabled",0)},1);var profileUrl=$.uri(window.location.href).deleteQueryParam("cover_id").toString();History.pushState({state:0},window.title,profileUrl)},imageLoaders:{},setLayout:function(){var cover=self.image(),image=self.setLayout.image;if(!image){var url=$.uri(cover.css("backgroundImage")).extract(0);if(!url)return;var imageLoaders=self.imageLoaders,imageLoader=(imageLoaders[url]||(imageLoaders[url]=$.Image.get(url))).done(function(image){self.setLayout.image=image;self.setLayout()});return}
var imageWidth=image.data("width"),imageHeight=image.data("height"),coverWidth=cover.width(),coverHeight=cover.height(),size=$.Image.resizeProportionate(imageWidth,imageHeight,coverWidth,coverHeight,"outer");self.availableWidth=coverWidth-size.width;self.availableHeight=coverHeight-size.height},setCover:function(id,url){self.element.addClass("loading");$.Image.get(url).done(function(){self.image().data("photoId",id).css({backgroundImage:$.cssUrl(url),backgroundPosition:"50% 50%"});self.x=0.5;self.y=0.5;self.enable()}).fail(function(){self.disable()}).always(function(){self.element.removeClass("loading")})},drawing:!1,moveCover:function(dx,dy,image){if(!image){image=self.image()}
var w=self.availableWidth,h=self.availableHeight,x=(w==0)?0:self.x+((dx/w)||0),y=(h==0)?0:self.y+((dy/h)||0);if(x<0)x=0;if(x>1)x=1;if(y<0)y=0;if(y>1)y=1;image.css("backgroundPosition",((self.x=x)*100)+"% "+((self.y=y)*100)+"% ")},x:0.5,y:0.5,"{image} click":function(el,event){if(!self.disabled){event.stopPropagation()}},"{image} mousedown":function(selection,event){if(self.disabled||self.drawing)return;if(event.target===self.image()[0]){event.preventDefault()}
self.drawing=!0;base.addClass("active");var image=self.image(),position=self.image().css("backgroundPosition").split(" ");self.x=parseInt(position[0])/100;self.y=parseInt(position[1])/100;var x=event.pageX,y=event.pageY;$(document).on("mousemove.movingCover mouseup.movingCover",function(event){if(!self.drawing)return;self.moveCover((x-(x=event.pageX))*-1,(y-(y=event.pageY))*-1,image)}).on("mouseup.movingCover",function(event){$(document).off("mousemove.movingCover mouseup.movingCover");base.removeClass("active");self.drawing=!1})},"{image} touchstart":function(selection,event){if(self.disabled||self.drawing)return;self.drawing=!0;base.addClass("active");var image=self.image(),position=self.image().css("backgroundPosition").split(" ");self.x=parseInt(position[0])/100;self.y=parseInt(position[1])/100;var touch=event.originalEvent.targetTouches[0],x=event.pageX,y=event.pageY;$(document).on("touchmove.movingCover",function(event){if(!self.drawing)return;var touch=event.originalEvent.targetTouches[0];self.moveCover((x-(x=touch.pageX))*-1,(y-(y=touch.pageY))*-1,image);event.preventDefault()}).on("touchend.movingCover",function(){$(document).off("touchstart.movingCover touchend.movingCover");base.removeClass("active");self.drawing=!1})},save:function(){var photoId=self.image().data("photoId");var task=EasySocial.ajax("site/controllers/cover/create",{uid:self.options.uid,type:self.options.type,id:photoId,x:self.x,y:self.y,reposition:self.reposition?1:0}).done(function(cover)
{base.attr("data-es-photo",photoId).css({backgroundImage:$.cssUrl(cover.url),backgroundPosition:cover.position}).removeClass("no-cover");self.disable()});return task},"{doneButton} click":function(el,event){self.save()},"{menu} shown.bs.dropdown":function(){self.element.addClass("show-all")},"{menu} hidden.bs.dropdown":function(){self.element.removeClass("show-all")},"{selectButton} click":function(){base.attr('data-es-photo-disabled',1);EasySocial.photos.selectPhoto({uid:self.options.uid,type:self.options.type,bindings:{"{self} photoSelected":function(el,event,photos){var photo=photos[0];if(!photo)return;self.setCover(photo.id,photo.sizes.large);this.parent.close();base.attr('data-es-photo-disabled',0)},"{cancelButton} click":function(el,event){this.parent.close();base.attr('data-es-photo-disabled',0)}}})},"{uploadButton} click":function(){base.attr('data-es-photo-disabled',1);EasySocial.dialog({content:EasySocial.ajax("site/views/cover/uploadDialog",{"uid":self.options.uid,"type":self.options.type}),bindings:{"{self} upload":function(el,event,task,filename){task.done(function(photo){self.setCover(photo.id,photo.sizes.large.url)})},"{cancelButton} click":function(){this.parent.close();base.attr('data-es-photo-disabled',0)}}})},"{removeButton} click":function(){EasySocial.ajax("site/controllers/cover/remove",{"uid":self.options.uid,"type":self.options.type}).done(function(defaultCoverUrl)
{base.css({backgroundImage:$.cssUrl(defaultCoverUrl),backgroundPosition:"50% 50%"}).addClass("no-cover").removeAttr("data-es-photo");self.disable()})},"{flyout} click":function(el,ev){if(el.is($(ev.target))){ev.stopPropagation()}}}});module.resolve()})});EasySocial.require().script("site/likes/likes","site/reports/reports","site/blocks/blocks","site/repost/repost","site/share/share","site/layout/dialog","site/layout/responsive","site/layout/elements","site/photos/photos","site/users/login","site/profile/popbox","site/privacy/privacy","site/locations/popbox","site/sidebar/sidebar","site/friends/api","site/popbox/popbox","site/conversations/api","site/followers/api","site/stream/video","oauth/facebook").library("history").done();EasySocial.module('site/likes/likes',function($){var module=this;$(document).on("click.es.likes.action","[data-likes-action]",function(){var button=$(this),data={id:button.data("id"),type:button.data("type"),group:button.data("group"),verb:button.data("verb"),streamid:button.data("streamid")},key=data.type+"-"+data.group+"-"+data.id;EasySocial.ajax("site/controllers/likes/toggle",data).done(function(content,label,showOrHide,actionVerb,count){button.text(label);id=button.data("streamid");$("[data-likes-"+key+"]").html(content).toggleClass("hide",showOrHide).toggle(!showOrHide);data.uid=data.id;data.count=count;button.trigger((actionVerb=="like")?"onLiked":"onUnliked",[data]);if(actionVerb=='like'&&id!="")
{ids=$('[data-streams-wrapper]').data('excludeids');newIds='';if(ids!=''&&ids!=undefined)
{newIds=ids+','+id}
else{newIds=id}
$('[data-streams-wrapper]').data('excludeids',newIds)}}).fail(function(message){console.log(message)})}).on("click.es.likes.others","[data-likes-others]",function(){var button=$(this),content=button.parents("[data-likes-content]"),data={uid:content.data("id"),type:content.data("type"),verb:content.data('verb'),group:content.data('group'),exclude:button.data("authors")};EasySocial.dialog({content:EasySocial.ajax("site/controllers/likes/showOthers",data)})});module.resolve()});EasySocial.module("site/reports/reports",function($){$(document).on("click.es.reports.link","[data-reports-link]",function(){var button=$(this),props="url,extension,uid,type,object,title,description".split(","),data={};$.each(props,function(i,prop){data[prop]=button.data(prop)});EasySocial.dialog({content:EasySocial.ajax("site/views/reports/confirmReport",{title:data.title,description:data.description}),selectors:{"{message}":"[data-reports-message]","{reportButton}":"[data-report-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{reportButton} click":function(){var message=this.message().val();EasySocial.dialog({content:EasySocial.ajax("site/controllers/reports/store",{url:data.url,extension:data.extension,uid:data.uid,type:data.type,title:data.object,message:message})})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})});this.resolve()});EasySocial.module("site/blocks/blocks",function($){$(document).on("click.es.blocks.link","[data-blocks-link]",function(){var target=$(this).data('target');EasySocial.dialog({content:EasySocial.ajax("site/views/blocks/confirmBlock",{"target":target}),selectors:{"{reason}":"[data-block-reason]","{blockButton}":"[data-block-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{blockButton} click":function(){var reason=this.reason().val();EasySocial.dialog({content:EasySocial.ajax("site/controllers/blocks/store",{"target":target,"reason":reason})})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})});$(document).on("click.es.unblock.link","[data-unblock-link]",function(){var target=$(this).data('target');EasySocial.dialog({content:EasySocial.ajax("site/views/blocks/confirmUnblock",{"target":target}),selectors:{"{unblockButton}":"[data-unblock-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{unblockButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/controllers/blocks/unblock",{"target":target}).done(function(){$('[data-blocked-user-'+target+']').remove()}),selectors:{"{cancelButton}":"[data-cancel-button]"},bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()}}})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})});this.resolve()});EasySocial.module("site/repost/repost",function($){var module=this;EasySocial.require().view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").library('mentions').done(function()
{$(document).on("click.es.repost.action","[data-repost-action]",function(){var button=$(this),data={id:button.data('id'),element:button.data('element'),group:button.data('group'),clusterId:button.data('clusterid'),clusterType:button.data('clustertype'),},key=data.element+'-'+data.group+'-'+data.id;EasySocial.dialog({content:EasySocial.ajax('site/views/repost/form',data),bindings:{init:function()
{this.setMentionsLayout()},setMentionsLayout:function()
{var textbox=this.textbox(),mentions=textbox.controller("mentions");if(mentions)
{mentions.cloneLayout();return}
var header=this.header();textbox.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:$.View("easysocial/site/friends/suggest.hint.search"),emptyHint:$.View("easysocial/site/friends/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/friends/suggest",{search:keyword}).done(function(items){if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title=item.screenName;item.type="user";item.menuHtml=$.View('easysocial/site/friends/suggest.item',!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task},use:function(item){return item.type+":"+item.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:$.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:$.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/hashtags/suggest",{search:keyword}).done(function(items){if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title="#"+item.title;item.type="hashtag";item.menuHtml=$.View('easysocial/site/hashtags/suggest.item',!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:'left top',at:'left bottom',of:header,collision:'none'},size:{width:function(){return header.outerWidth(!0)}}}}})},"{sendButton} click":function(sendButton)
{var dialog=this.parent,content=$.trim(this.repostContent().val());data.content=content;var mentions=this.textbox().mentions("controller").toArray();data.mentions=$.map(mentions,function(mention){if(mention.type==="hashtag"&&$.isPlainObject(mention.value)){mention.value=mention.value.title.slice(1)}
return JSON.stringify(mention)});dialog.loading(!0);EasySocial.ajax("site/controllers/repost/share",data).done(function(content,isHidden,count,streamHTML)
{var content=$.buildHTML(content);actionContent=$('[data-repost-'+key+']').toggleClass("hide",isHidden).toggle(!isHidden);actionContent.find("span.repost-counter").html(content);button.trigger("create",[streamHTML])}).fail(function(message)
{dialog.clearMessage();dialog.setMessage(message)}).always(function()
{dialog.loading(!1);dialog.close()})}}})});EasySocial.module("repost/authors",function(){this.resolve(function(popbox){var repost=popbox.button.parents("[data-repost-content]")
data={id:repost.data("id"),element:repost.data("element")};return{content:EasySocial.ajax('site/controllers/repost/getSharers',data),id:"fd",component:"es",type:"repost",position:"bottom-right"}})});module.resolve()})});EasySocial.module("site/share/share",function($){$(document).on("click.es.share.button","[data-es-share-button]",function(){var button=$(this);EasySocial.dialog({title:button.text(),width:500,content:EasySocial.ajax("site/views/sharing/shareDialog",{url:button.data("url"),title:button.data("title")})})});this.resolve()});EasySocial.module('site/layout/dialog',function($){var module=this;EasySocial.require().library('dialog').view('site/dialog/default').done(function($){EasySocial.dialog=function(options){if(window.parentDialog){return window.parentDialog.update(options)}
if(typeof options==="string"||$.isDeferred(options)){var afterShow=arguments[1];options={content:options,afterShow:($.isFunction(afterShow))?afterShow:$.noop}}
var dialogElement=$('[id=fd].es-dialog.global');if(dialogElement.length<1){dialogElement=$(EasySocial.View('site/dialog/default')).addClass('global').appendTo('body')};var defaultOptions={showOverlay:!1},options=$.extend(defaultOptions,options);var dialogController=dialogElement.controller("Dialog");if(!dialogController){dialogController=dialogElement.addController("Dialog",options)}else{dialogController.update(options)}
return dialogController}
module.resolve()})});EasySocial.module('site/layout/responsive',function($){var module=this;$(function(){$.responsive(".es-responsive",[{at:1200,switchTo:'wide'},{at:960,switchTo:'wide w960'},{at:818,switchTo:'wide w960 w768'},{at:600,switchTo:'wide w960 w768 w600'},{at:560,switchTo:'wide w960 w768 w600 w480'},{at:480,switchTo:'wide w960 w768 w600 w480 w320'}]);$(document).on("responsive",$.debounce(function(){ESImageRefresh()},500))});module.resolve()});EasySocial.module('site/layout/elements',function($){var module=this;$(document).on('click.button.data-bs-api','[data-bs-toggle-value]',function(){var button=$(this),siblings=button.siblings("[data-bs-toggle-value]"),parent=button.parents('[data-bs-toggle="radio-buttons"]');if(parent.hasClass('disabled')){return}
if(parent.length>0){var value=$(this).data('bs-toggle-value');button.addClass("active");siblings.removeClass("active");parent.find('input[type=hidden]').val(value).trigger('change');return}});$(document).on('mouseover.tooltip.data-es-api','[data-es-provide=tooltip]',function(){$(this).tooltip({delay:{show:200,hide:100},animation:!1,template:'<div id="fd" class="es tooltip tooltip-es"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:'body'}).tooltip("show")});$(document).on('mouseover.popover.data-es-api','[data-es-provide=popover]',function(){$(this).popover({delay:{show:200,hide:100},animation:!1,trigger:'hover',container:'body'}).popover("show")});var ly=function(yr){return(yr%400)?((yr%100)?((yr%4)?false:!0):!1):!0};$(document).on("keyup","[data-date-form] [data-date-day]",function(){if(!$.trim($(this).val()))return;var year=parseInt($(this).siblings("[data-date-year]").val()||$(this).siblings("[data-date-year]").data("dateDefault")),month=parseInt($(this).siblings("[data-date-month]").val()||$(this).siblings("[data-date-month]").data("dateDefault")),day=parseInt($(this).val()||$(this).data("dateDefault")),maxDay=/1|3|5|7|8|10|12/.test(month)?31:30;if(month==2)maxDay=ly(year)?29:28;if(day<1)day=1;if(day>maxDay)day=maxDay;if($.isNumeric(day)){$(this).val(day)}else{$(this).val("")}});$(document).on("keyup","[data-date-form] [data-date-year]",function(){if(!$.trim($(this).val()))return;var year=parseInt($(this).val());if(year<1)year=1;if($.isNumeric(year)){$(this).val(year)}else{$(this).val("")}});module.resolve()});EasySocial.module("site/photos/photos",function($){var module=this;EasySocial.require().script("site/photos/popup","site/photos/dialog","site/photos/avatar").done();EasySocial.Controller("Photos",{defaultOptions:{}},function(self){return{init:function(){EasySocial.photos=self;EasySocial.module("site/photos/popup").done(function(PopupController){self.popup=self.addPlugin("popup",PopupController)});EasySocial.module("site/photos/dialog").done(function(DialogController){self.dialog=self.addPlugin("dialog",DialogController)});EasySocial.module("site/photos/avatar").done(function(AvatarController){self.avatar=self.addPlugin("avatar",AvatarController)})}}});$(function(){$("body").addController("EasySocial.Controller.Photos")});module.resolve()});EasySocial.module("site/photos/popup",function($){var module=this;$.fn.at=function(key){return this.find("[data-"+key.replace(/([a-z])([A-Z])/g,'$1-$2').toLowerCase()+"]")}
EasySocial.require().view("site/photos/popup").done(function(){var controller=EasySocial.Controller("Photos.Popup",{defaultOptions:{view:{popup:"site/photos/popup"},"{popup}":"[data-photo-popup]","{viewport}":"[data-popup-viewport]","{handle}":"[data-popup-handle]","{photoGroup}":"[data-es-photo-group]","{photo}":"[data-es-photo]","{photoHeader}":"[data-photo-popup] [data-photo-header]","{photoContent}":"[data-photo-popup] [data-photo-content]","{navButton}":".es-photo-nav-button","{closeButton}":"[data-popup-close-button]","{photoItem}":"[data-photo-popup] [data-photo-item]",'{desTagItem}':'[data-photo-des-tag-item]'}},function(self,opts,base,body){return{init:function(){body=$("body");self.bodyOverflow={overflow:body.css("overflow"),overflowX:body.css("overflowX"),overflowY:body.css("overflowY")}},setLayout:function(){var popup=self.popup();if(popup.is(":visible")){var image=self.viewport().find("img[data-photo-image]")[0];if(image)ESImage(image);body.css({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"});var photoItem=self.photoItem();var tags=photoItem.controller("EasySocial.Controller.Photos.Tags");tags&&tags.setLayout();var navigation=photoItem.controller("EasySocial.Controller.Photos.Navigation"),tagger=photoItem.controller("EasySocial.Controller.Photos.Tagger");navigation&&navigation[(tagger&&!tagger.disabled)||(self.playlist.length<2)?"disable":"enable"]()}else{body.css(self.bodyOverflow)}},'{desTagItem} mouseover':function(el,ev){var tags=self.photoItem().controller("EasySocial.Controller.Photos.Tags");tags&&tags.getTagItem(el.data('photoDesTagId')).addClass('focus')},'{desTagItem} mouseout':function(el,ev){var tags=self.photoItem().controller("EasySocial.Controller.Photos.Tags");tags&&tags.getTagItem(el.data('photoDesTagId')).removeClass('focus')},"{window} resize":$.debounce(function(){self.setLayout()},250),"{self} responsive":function(){self.setLayout()},playlist:[],show:function(){var popup,node=self.popup.node;if(!node){popup=self.view.popup();node=self.popup.node=popup[0]}
if(!$.contains(base,node)){popup=$(node).addClass("is-loading").appendTo(base)}
if(!popup.is(":visible")){popup.show();$(window).trigger("resize.responsive");popup.trigger("show")}},hide:function(){self.popup().hide().trigger("hide").detach();body.css(self.bodyOverflow)},open:function(){var args=arguments,albumId,photoId,playlist=[];if(args.length===1){photoId=args[0];playlist=[photoId]}
if($.isArray(args[0])){playlist=args[0];photoId=args[1]||playlist[0]}else if(args.length===2){var type=args[0],autoplay=!0,albumId;if($.isNumeric(type)){type="album";autoplay=!1;albumId=args[0];photoId=args[1];playlist=[photoId]}
if(type=="photo"){photoId=args[1];playlist=[photoId]}
if(type=="album"){EasySocial.ajax("site/controllers/albums/playlist",{albumId:albumId||args[1]}).done(function(photos){self.playlist=$.map(photos,function(photo){return photo.id});if(autoplay){self.display(playlist[0])}
self.setLayout()}).fail(function(){alert("Error. Could not get album playlist.");self.hide()})}}
self.playlist=playlist;self.show();self.display(photoId)},handles:{},display:function(photoId){if(!photoId)return;var previousId=self.currentPhotoId;self.currentPhotoId=photoId;var handle=self.handles[photoId];self.handle().detach();if(!handle){var popup=self.popup();popup.addClass("is-loading");EasySocial.ajax("site/views/photos/item",{id:photoId,browser:0,popup:1,}).done(function(html){var handle=$.buildHTML('<div class="es-popup-handle" data-popup-handle>'+html+"</div>");self.handles[photoId]=handle;self.display(photoId)}).fail(function(){alert("There was a problem loading this photo.");self.display(previousId)}).always(function(){popup.removeClass("is-loading")});return}else{self.popup().removeClass("is-loading")}
self.viewport().empty().append(handle);if(handle instanceof $){self.handles[photoId]=handle.filter("[data-popup-handle]")[0]}
self.setLayout()},current:function(){var id=self.currentPhotoId,playlist=self.playlist,i=$.indexOf(playlist,id);if(i<0)i=0;return i},next:function(){var playlist=self.playlist;if(playlist.length<2)return;var i=self.current()+1;if(i>playlist.length-1)i=0;self.display(playlist[i])},prev:function(){var playlist=self.playlist;if(playlist.length<2)return;var i=self.current()-1;if(i<0)i=playlist.length-1;self.display(playlist[i])},"{self} click":function(el,event){if(event.target===self.popup()[0]){self.hide()}},"{photo} click":function(photo,event){if(photo.attr("data-es-photo-disabled")=="1")return;var target=$(event.target),targetTree=target.parents().andSelf();if(target.filter("[data-es-photo]").length<1&&targetTree.filter("[data-photo-menu], [data-cover-menu]").length>0)return;var photoId=photo.attr("data-es-photo"),photoGroup=self.photoGroup.of(photo);if(photoGroup.length<0)return;event.preventDefault();var data=(photoGroup.attr("data-es-photo-group")||"element").split(":"),type=data[0];switch(type){case "album":var albumId=data[1];self.open(albumId,photoId);break;case "photos":var list=data[1].split(",");self.open(list,photoId);break;case "element":var list=[];photoGroup.at("esPhoto").each(function(){list.push($(this).attr("data-es-photo"))});self.open(list,photoId);break}},"{photoItem} directionmove":function(photoItem,event,offset,direction){if(self.playlist.length<2){self.navButton().removeClass("active")}},"{photoItem} directionstop":function(){},"{photoItem} photoNext":function(){self.next()},"{photoItem} photoPrev":function(){self.prev()},"{photoItem} photoDelete":function(el,event,photoItem){if(self.playlist.length<2){self.hide()}else{self.next()}
self.playlist=$.without(self.playlist,photoItem.id)},"{closeButton} click":function(){self.hide()}}});module.resolve(controller)})});EasySocial.module("site/photos/dialog",function($){var module=this;var controller=EasySocial.Controller("Photos.Dialog",{defaultOptions:{}},function(self){return{init:function(){EasySocial.photos.selectPhoto=self.show},show:function(options){var task=$.Deferred(),dialog=EasySocial.ajax("site/views/albums/dialog",{"uid":options.uid,"type":options.type}),browser=EasySocial.require().script("albums/browser").done();EasySocial.dialog($.extend({content:task},options));$.when(browser,dialog).done(function(){dialog.done(function(html){task.resolve(html)})})}}});module.resolve(controller)});EasySocial.module("site/photos/avatar",function($){var module=this;var controller=EasySocial.Controller("Photos.Avatar",{defaultOptions:{}},function(self){return{init:function(){EasySocial.photos.createAvatar=self.crop},crop:function(id,options){if(id==undefined)
{return}
if(!options)
{options={}}
var avatarOptions={"id":id};if(options.uid)
{avatarOptions.uid=options.uid;delete options.uid}
if(options.type)
{avatarOptions.type=options.type;delete options.type}
if(options.redirect)
{avatarOptions.redirect=options.redirect;delete options.redirect}
EasySocial.dialog($.extend({content:EasySocial.ajax('site/views/avatar/crop',avatarOptions)},options))}}});module.resolve(controller)});EasySocial.module('site/users/login',function($){var module=this;EasySocial.require().library('dialog').script('site/dashboard/dashboard.guest.login').view('site/loading/small').done(function(){EasySocial.login=function(){EasySocial.ajax('site/views/login/form').done(function(content){var dialog=EasySocial.dialog({content:content,afterShow:function(){this.element.find('[data-guest-login]').addController('EasySocial.Controller.Dashboard.Guest.Login')}})})}
module.resolve()})});EasySocial.module('site/dashboard/dashboard.guest.login',function($){var module=this;EasySocial.require().script('field','validate').done(function(){EasySocial.Controller('Dashboard.Guest.Login',{defaultOptions:{'{fieldItem}':'[data-registermini-fields-item]','{submit}':'[data-registermini-submit]','{form}':'[data-registermini-form]'}},function(self){return{init:function(){self.fieldItem().addController('EasySocial.Controller.Field.Base',{userid:0,mode:'registermini'})},'{submit} click':function(el){if(el.enabled()){el.disabled(!0);self.form().validate({mode:'onRegisterMini'}).done(function(){el.enabled(!0);self.form().submit()}).fail(function(){el.enabled(!0)})}}}});module.resolve()})});EasySocial.module('validate',function($){var module=this;if(!$.isController('EasySocial.Controller.Validator')){EasySocial.Controller('Validator',{defaultOptions:{mode:null,checks:['required','validate'],typeAttr:'data-check-type',formatAttr:'data-check-format',modifierAttr:'data-check-modifier',errorTrigger:'onError',submitTrigger:'onSubmit','{container}':'[data-check]','{notice}':'[data-check-notice]','{required}':'[data-check-required]','{validate}':'[data-check-validate]',}},function(self){return{vars:{},register:[],deferreds:[],errors:[],state:$.Deferred(),init:function(){},reset:function(){self.vars={};self.register=[];self.deferreds=[];self.errors=[];self.state=$.Deferred();self.container().removeClass('error')},start:function(){self.reset();$.each(self.container(),function(i,container){self.vars.container=container=$(container);container.trigger(self.options.submitTrigger,[self.register,self.options.mode]);$.each(self.getFields(),function(j,field){self.vars.field=field=$(field);$.each(self.options.checks,function(i,check){self.vars.check=check;self[check+'Check']()})})});$.each(self.register,function(i,result){if($.isDeferred(result)){self.deferreds.push(result)}else if($.isPlainObject(result)){$.each(result,function(key,value){if(value===!1){self.errors.push(i);return!0}})}else{if(result===!1){self.errors.push(i);return!0}}});if(self.errors.length>0){self.state.reject()}else{if(self.deferreds.length>0){$.when.apply(null,self.deferreds).done(function(){self.state.resolve()}).fail(function(){self.state.reject()})}else{self.state.resolve()}}
return self.state},getFields:function(){return $.merge(self.vars.container.find(self.required.selector),self.vars.container.find(self.validate.selector))},requiredCheck:function(){if(self.vars.field.is(self.required.selector)){var fieldType=self.vars.field.attr(self.options.typeAttr)||self.vars.field.attr('type')||'text';if(fieldType==='text'&&$.trim(self.vars.field.val())==''){self.raiseError()}
if(fieldType==='checkbox'&&self.vars.field.find('input[type="checkbox"]').filter(':checked').length<1){self.raiseError()}}},validateCheck:function(){if(self.vars.field.attr(self.options.formatAttr)!==undefined){var value=self.vars.field.val();if($.isEmpty(value)){return}
var format=self.vars.field.attr(self.options.formatAttr)||'';var modifier=self.vars.field.attr(self.options.modifierAttr)||'';var regex=new RegExp(format,modifier);if(!regex.test(value)){self.raiseError()}}},raiseError:function(){self.vars.container.addClass('has-error');self.vars.container.trigger(self.options.errorTrigger,[self.vars.check,self.vars.field]);self.register.push(!1)}}})}
$.fn.validate=function(options){var element=this;if(element.length>0){var controller=this.addController("EasySocial.Controller.Validator",options);return controller.start()}
return!1};module.resolve()});EasySocial.module("site/profile/popbox",function($){var module=this;EasySocial.require().library("popbox").done(function(){EasySocial.module("profile/popbox",function($){this.resolve(function(popbox){var id=popbox.button.data("userId"),position=popbox.button.attr("data-popbox-position")||"top-left";return{content:EasySocial.ajax("site/views/profile/popbox",{id:id}),id:"fd",component:"es",type:"profile",position:position}})})});EasySocial.require().script("site/conversations/composer").done();EasySocial.Controller("Profile.Popbox",{defaultOptions:{id:null,"{addButton}":"[data-popbox-friends-add]","{friendsButton}":"[data-popbox-friends-friends]","{respondButton}":"[data-popbox-friends-respond]","{requestedButton}":"[data-popbox-friends-requested]","{messageButton}":"[data-popbox-message]","{friendsSubmenu}":"[data-friends-submenu]","{cancelFriend}":"[data-popbox-friends-friends-cancel]","{cancelFriendRequest}":"[data-popbox-friends-requested-cancel]","{approveFriend}":"[data-popbox-friends-respond-approve]","{rejectFriend}":"[data-popbox-friends-respond-reject]"}},function(self){return{init:function(){self.options.id=self.element.find("[data-user-id]").data("userId");EasySocial.module("site/conversations/composer").done(function(){self.messageButton().implement(EasySocial.Controller.Conversations.Composer.Dialog,{"recipient":{"id":self.options.id}})})},"{self} popboxActivate":function(){self.friendsSubmenu().parent().removeClass("open")},"{addButton} click":function(){EasySocial.ajax("site/controllers/friends/request",{"id":self.options.id}).done(function()
{EasySocial.ajax('site/views/profile/getButton',{"button":"button.requested","id":self.options.id}).done(function(button)
{self.addButton().replaceWith(button)}).fail(function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/exceeded')})})})},"{cancelFriend} click":function(el,event){var friendId=$(el).data('friendid');EasySocial.dialog({content:EasySocial.ajax('site/views/profile/confirmRemoveFriend',{"id":self.options.id}),bindings:{"{confirmButton} click":function()
{EasySocial.ajax('site/controllers/friends/unfriend',{"id":friendId}).done(function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/profile/friendRemoved',{"id":self.options.id})});EasySocial.ajax('site/views/profile/getButton',{"button":"button.add"}).done(function(button)
{self.friendsSubmenu().remove();self.friendsButton().replaceWith(button)})})}}})},"{cancelFriendRequest} click":function(el,event){var friendId=$(el).data('friendid');EasySocial.dialog({content:EasySocial.ajax('site/views/profile/confirmCancelRequest',{"id":friendId}),bindings:{"{confirmButton} click":function()
{EasySocial.dialog().close();EasySocial.ajax('site/controllers/friends/cancelRequest',{"id":friendId}).done(function()
{EasySocial.ajax('site/views/profile/getButton',{"button":"button.add"}).done(function(button)
{self.friendsSubmenu().remove();self.requestedButton().replaceWith(button)})})}}})},"{approveFriend} click":function(el,event){var friendId=$(el).data('friendid');EasySocial.ajax('site/controllers/friends/approve',{"id":friendId}).done(function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/profile/confirmFriends',{"id":self.options.id})});EasySocial.ajax('site/views/profile/getButton',{"button":"button.friends"}).done(function(button)
{self.friendsSubmenu().remove();self.respondButton().replaceWith(button)})})},"{rejectFriend} click":function(el,event){var friendId=$(el).data('friendid');EasySocial.ajax("site/controllers/friends/reject",{id:friendId}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/rejected",{"id":self.options.id})});EasySocial.ajax("site/views/profile/getButton",{"button":"button.add"}).done(function(button){self.friendsSubmenu().remove();self.respondButton().replaceWith(button)})})}}});$(document).on("mouseover.es.profile.popbox","[data-popbox-tooltip=profile]",function(){$(this).addController("EasySocial.Controller.Profile.Popbox")});module.resolve()});EasySocial.module('site/conversations/composer',function($){var module=this;EasySocial.require().library('mentions').script('site/friends/suggest','uploader/uploader').view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language('COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS','COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE').done(function($){EasySocial.Controller('Conversations.Composer',{defaultOptions:{attachments:!0,location:!0,extensionsAllowed:"","{uploader}":"[data-composer-attachment]","{location}":"[data-composer-location]","{editorHeader}":"[data-composer-editor-header]","{editorArea}":"[data-composer-editor-area]","{editor}":"[data-composer-editor]","{friendSuggest}":"[data-friends-suggest]","{recipients}":"input[name=uid\\[\\]],input[name=list_id\\[\\]]","{recipientRow}":"[data-composer-recipients]","{messageRow}":"[data-composer-message]","{submit}":"[data-composer-submit]",view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(self){return{init:function()
{self.initSuggest();if(self.options.attachments)
{self.initUploader()}
self.setMentionsLayout()},resetForm:function()
{self.editor().val('')},setMentionsLayout:function()
{var editor=self.editorArea(),mentions=editor.controller("mentions");if(mentions)
{mentions.cloneLayout();return}
var header=self.editorHeader();editor.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:$.View("easysocial/site/friends/suggest.hint.search"),emptyHint:$.View("easysocial/site/friends/suggest.hint.empty"),data:function(keyword)
{var task=$.Deferred();EasySocial.ajax("site/controllers/friends/suggest",{search:keyword}).done(function(items)
{if(!$.isArray(items))task.reject();var items=$.map(items,function(item)
{item.title=item.screenName;item.type="user";item.menuHtml=self.view.suggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task},use:function(item){return item.type+":"+item.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!1,searchHint:$.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:$.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(keyword)
{var task=$.Deferred();EasySocial.ajax("site/controllers/hashtags/suggest",{search:keyword}).done(function(items)
{if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title="#"+item.title;item.type="hashtag";item.menuHtml=self.view.tagSuggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:'left top',at:'left bottom',of:header,collision:'none'},size:{width:function()
{return header.width()}}}}})},initUploader:function()
{self.uploader().implement(EasySocial.Controller.Uploader,{temporaryUpload:!0,query:"type=conversations",type:'conversations',extensionsAllowed:self.options.extensionsAllowed});if(EasySocial.environment=='development')
{console.log('Extensions Allowed: '+self.options.extensionsAllowed);console.log('Maximum individual file size: '+self.options.maxSize)}},initSuggest:function()
{self.friendSuggest().addController(EasySocial.Controller.Friends.Suggest,{friendList:!0,friendListName:"list_id[]"})},initEditor:function()
{self.editor().expandingTextarea()},checkErrors:function()
{if(self.recipients().length<=0)
{self.recipientRow().addClass('error');self.clearMessage();self.setMessage($.language('COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS'),'error');return!0}
else{self.recipientRow().removeClass('error')}
if(self.editor().val()=='')
{self.messageRow().addClass('error');self.clearMessage();self.setMessage($.language('COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE'),'error');return!0}
else{self.messageRow().removeClass('error')}
return!1},"{submit} click":function(el,event)
{event.preventDefault();if(self.checkErrors())
{return!1}
if(self.options.attachments)
{var uploaderController=self.uploader().controller();if(uploaderController.options.uploading&&uploaderController.hasFiles())
{return!1}}
var mentions=self.editorArea().mentions("controller").toArray();$(mentions).each(function(i,item)
{$('<input>').attr('type','hidden').attr('name','tags[]').attr('value',JSON.stringify(item)).appendTo(self.element)});self.element.submit()}}});EasySocial.Controller('Conversations.Composer.Dialog',{defaultOptions:{recipient:{},}},function(self){return{init:function()
{},"{self} click":function()
{EasySocial.dialog({"content":EasySocial.ajax('site/views/conversations/composer',{"id":self.options.recipient.id}),"bindings":{"{sendButton} click":function(el)
{var dialog=this.parent,recipient=$('[data-composer-recipient]').val(),message=$('[data-composer-message]').val();el.disabled(!0);EasySocial.ajax('site/controllers/conversations/store',{"uid":recipient,"message":message}).done(function(link)
{EasySocial.dialog({"content":EasySocial.ajax('site/views/conversations/sent',{"id":self.options.recipient.id}),"bindings":{"{viewButton} click":function()
{document.location=link}}})}).fail(function(message)
{dialog.setMessage(message);el.disabled(!1)})}}})}}});module.resolve()})});EasySocial.module("site/privacy/privacy",function($){var module=this;EasySocial.require().library("textboxlist").language('COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_PUBLIC','COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_MEMBER','COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIENDS_OF_FRIEND','COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIEND','COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_ONLY_ME','COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_CUSTOM').done(function($){EasySocial.Controller("Privacy",{defaultOptions:{"{menu}":"[data-privacy-menu]","{item}":"[data-privacy-item]","{icon}":"[data-privacy-icon]","{button}":"[data-privacy-toggle]","{tooltip}":"[data-original-title]","{key}":"[data-privacy-hidden]"}},function(self){return{init:function(){self.instanceId=$.uid();self.addPlugin("custom")},getData:function(item){return $._.pick(item.data(),"uid","utype","value","pid","privacyicon","streamid")},"{self} click":function(el,event){var target=$(event.target),button=self.button();if(target.parents().andSelf().filter(button).length>0){self.toggle()}},"{item} click":function(item){var data=self.getData(item);self.trigger("privacyChange",[data]);if(!data.preventSave){self.save(data);self.deactivate()}},"{self} privacyChange":function(el,event,data){self.item().removeClass("active").filter("[data-value="+data.value+"]").addClass("active")},toggle:function(){var isActive=self.element.hasClass("active");self[(isActive)?"deactivate":"activate"]()},activate:function(){self.element.addClass("active");self.trigger("activate",[self]);$(window).trigger("activatePrivacy",[self]);var windowClick="click.privacy."+self.instanceId;$(document).on(windowClick,function(event){var clickedTarget=$(event.target);if(clickedTarget.parents().andSelf().filter(self.element).length>0||clickedTarget.parents('[data-textboxlist-autocomplete]').length>0||clickedTarget.parents('[data-textboxlist-item]').length>0)
{return}
$(document).off(windowClick);self.deactivate()})},deactivate:function(){self.element.removeClass("active");self.trigger("deactivate",[self]);$(window).trigger("deactivatePrivacy",[self])},"{window} activatePrivacy":function(el,event,instance){if(instance!==self){self.deactivate()}},save:function(data){self.key().val(data.value);self.icon().attr("class",data.privacyicon);self.trigger("privacySave",[data]);self.element.attr('data-original-title',$.language('COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_'+data.value.toUpperCase()));if(self.element.data("privacyMode")=="ajax"){EasySocial.ajax("site/controllers/privacy/update",{uid:data.uid,utype:data.utype,value:data.value,pid:data.pid,custom:data.custom,streamid:data.streamid}).done(function(){}).fail(function(){})}}}});EasySocial.Controller("Privacy.Custom",{defaultOptions:{"{textField}":"[data-textfield]","{saveButton}":"[data-save-button]","{cancelButton}":"[data-cancel-button]","{customItem}":"[data-privacy-item][data-value=custom]","{customKey}":"[data-privacy-custom-hidden]"}},function(self){return{init:function(){self.textField().textboxlist({component:'es',unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:1,cache:!1,query:function(keyword){var users=self.getIds();var ajax=EasySocial.ajax("site/views/privacy/getfriends",{q:keyword,exclude:users});return ajax}}}});self.textboxlist=self.textField().controller("TextboxList")},getIds:function(){var items=self.textField().textboxlist("controller").getAddedItems();return $.map(items,function(item,idx){return item.id})},updateIds:function(){var ids=self.getIds();self.customKey().val(ids.join(","))},"{parent} privacyChange":function(el,event,data){var isCustomPrivacy=(data.value=="custom");self.element.toggleClass("custom-privacy",isCustomPrivacy);if(!isCustomPrivacy){self.textField().textboxlist("controller").clearItems()}else{data.preventSave=!0}},"{parent} privacySave":function(el,event,data){},"{parent} deactivate":function(){self.textboxlist.autocomplete.hide()},"{cancelButton} click":function(){self.element.removeClass("custom-privacy");self.textboxlist.autocomplete.hide()},"{saveButton} click":function(){var parent=self.parent,customItem=self.customItem();var data=parent.getData(customItem);data.custom=self.customKey().val();self.parent.save(data);self.parent.deactivate()},"{textField} addItem":function(){self.updateIds()},"{textField} removeItem":function(){self.updateIds()}}});$(document).on('click.es.privacy','[data-es-privacy-container]',function(){var privacyButton=$(this),privacyController="EasySocial.Controller.Privacy";if(privacyButton.hasController(privacyController))return;privacyButton.addController(privacyController).toggle()});module.resolve()})});EasySocial.module('site/locations/popbox',function($){EasySocial.module("locations/popbox",function($){this.resolve(function(popbox){var button=popbox.button,lat=button.data("lat"),lng=button.data("lng"),link="//maps.google.com/?q="+lat+","+lng,language=$('meta[property="foundry:location:language"]').attr("content")||'en',url="//maps.googleapis.com/maps/api/staticmap?size=400x200&sensor=true&zoom=15&center="+lat+","+lng+"&markers="+lat+","+lng+"&language="+language;return{id:"fd",component:"es",type:"location",content:'<a href="'+link+'" target="_blank"><img src="'+url+'" width="400" height="200" /></a>'}})});this.resolve()});EasySocial.module('site/sidebar/sidebar',function($){var module=this;$(document).on("click.es.sidebar","[data-sidebar-toggle]",function(){var button=$(this),selector="[data-sidebar]",sidebar=button.siblings(selector);if(sidebar.length<1){sidebar=button.closest(selector)}
if(sidebar.length<1){sidebar=$(selector)}
sidebar.toggleClass("sidebar-open").trigger("sidebarToggle")});module.resolve()});EasySocial.module('site/friends/api',function($){var module=this;EasySocial.require().library('dialog','popbox').done(function(){$(document).on('click.es.friends.cancel','[data-es-friends-cancel]',function()
{var element=$(this),friendId=element.data('es-friends-id');EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmCancel'),bindings:{"{confirmButton} click":function()
{EasySocial.ajax('site/controllers/friends/cancelRequest',{"id":friendId}).done(function()
{EasySocial.dialog().close()})}}})});$(document).on('click.es.friends.add','[data-es-friends-add]',function(){var element=$(this),userId=element.data('es-friends-id'),popboxContent=$.Deferred();element.popbox({content:popboxContent,id:"fd",component:"es",type:"friends",toggle:"click"});element.popbox('show');EasySocial.ajax('site/controllers/friends/request',{"viewCallback":"popboxRequest","id":userId}).done(function(content)
{popboxContent.resolve(content)})})
module.resolve()})});EasySocial.module('site/popbox/popbox',function($){var module=this;EasySocial.module("notifications/popbox",function($){this.resolve(function(popbox)
{return{content:EasySocial.ajax("site/controllers/notifications/getSystemItems",{layout:"popbox.notifications"}),id:"fd",component:"es",type:"notifications",cache:!1}})});EasySocial.module("conversations/popbox",function($){this.resolve(function(popbox)
{return{content:EasySocial.ajax("site/controllers/notifications/getConversationItems",{usemax:"1",layout:"popbox.conversations"}),id:"fd",component:"es",type:"notifications",cache:!1}})});EasySocial.module("friends/popbox",function($){this.resolve(function(popbox){return{content:EasySocial.ajax("site/controllers/notifications/friendsRequests",{layout:"popbox.friends"}),id:"fd",component:"es",type:"notifications",cache:!1}})});module.resolve()});EasySocial.module('site/conversations/api',function($){var module=this;EasySocial.require().library('dialog').done(function(){$(document).on('click.es.conversations.compose','[data-es-conversations-compose]',function(){var element=$(this),userId=element.data('es-conversations-id'),listId=element.data('es-conversations-listid');EasySocial.dialog({"content":EasySocial.ajax('site/views/conversations/composer',{"id":userId,"listId":listId}),"bindings":{"{sendButton} click":function()
{var recipients=$('input[name=recipient\\[\\]]'),message=$('[data-composer-message]').val(),uids=new Array,dialog=this.parent;$(recipients).each(function()
{uids.push($(this).val())});EasySocial.ajax('site/controllers/conversations/store',{"uid":uids,"message":message}).done(function(link)
{if(userId)
{EasySocial.dialog({"content":EasySocial.ajax('site/views/conversations/sent',{"id":userId}),"bindings":{"{viewButton} click":function()
{document.location=link}}})}
if(listId)
{EasySocial.dialog({"content":EasySocial.ajax('site/views/conversations/sentList',{"id":listId}),"bindings":{"{viewButton} click":function()
{document.location=link}}})}}).fail(function(message){dialog.setMessage(message)})}}})});module.resolve()})});EasySocial.module('site/followers/api',function($){var module=this;EasySocial.require().library('dialog','popbox').done(function(){$(document).on('click.es.followers.follow','[data-es-followers-follow]',function(){var element=$(this),userId=element.data('es-followers-id'),popboxContent=$.Deferred(),showPopbox=element.data('es-show-popbox')==undefined||element.data('es-show-popbox')=="true"?!0:!1;if(showPopbox){element.popbox({content:popboxContent,id:"fd",component:"es",type:"followers",toggle:"click"});element.popbox('show')}
EasySocial.ajax('site/controllers/profile/follow',{"id":userId,"type":'user'}).done(function(button)
{$(element).trigger('following',button);if(showPopbox){EasySocial.ajax('site/views/profile/popboxFollow',{"id":userId}).done(function(content)
{popboxContent.resolve(content)})}})})
$(document).on('click.es.followers.unfollow','[data-es-followers-unfollow]',function(){var element=$(this),userId=element.data('es-followers-id'),popboxContent=$.Deferred();element.popbox({content:popboxContent,id:"fd",component:"es",type:"followers",toggle:"click"});element.popbox('show');EasySocial.ajax('site/controllers/profile/unfollow',{"id":userId,"type":'user'}).done(function(button)
{EasySocial.ajax('site/views/profile/popboxUnfollow',{"id":userId}).done(function(content)
{popboxContent.resolve(content)})})});module.resolve()})});EasySocial.module("site/stream/video",function($){$(document).on("click","[data-es-links-embed-item]",function()
{var button=$(this),player=$('<div>').html(button.data('es-stream-embed-player'));var embedCode='<div class="video-container">'+player.html()+'</div>';button.replaceWith(embedCode)});this.resolve()});EasySocial.module('oauth/facebook',function($){var module=this;$(document).on("click","[data-oauth-facebook-login]",function(){var button=$(this),parent=button.parents("[data-oauth-facebook]"),controller="EasySocial.Controller.OAuth.Facebook";if(parent.length<1)return;if(parent.hasController(controller))return;parent.addController(controller,{url:button.data("oauth-facebook-url"),appId:button.data("oauth-facebook-appid")}).openDialog()});EasySocial.Controller('OAuth.Facebook',{defaultOptions:{appId:null,url:"","{login}":"[data-oauth-facebook-login]","{revoke}":"[data-oauth-facebook-revoke]","{pushInput}":"[data-oauth-facebook-push]"}},function(self)
{return{init:function()
{},openDialog:function()
{var url=self.options.url,left=(screen.width/2)-(300/2),top=(screen.height/2)-(300/2);window.open(url,"",'scrollbars=no,resizable=no,width=300,height=300,left='+left+',top='+top)},"{pushInput} change":function(el)
{var enabled=$(el).val();if(enabled==1&&self.options.requestPush)
{self.openDialog(self.options.addPublishURL)}
if(enabled==0)
{self.openDialog(self.options.revokePublishURL)}},"{login} click":function()
{self.openDialog()},"{revoke} click":function()
{var callback=self.element.data('callback');EasySocial.dialog({content:EasySocial.ajax('site/views/oauth/confirmRevoke',{"client":'facebook',"callbackUrl":callback})})}}});module.resolve()});EasySocial.module("locations",function($){var module=this;EasySocial.require().library("gmaps").done();EasySocial.require().library("scrollTo").view("site/location/story.suggestion").language("COM_EASYSOCIAL_AT_LOCATION").done(function(){var KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller("Locations",{defaultOptions:{view:{suggestion:"site/location/story.suggestion"},map:{lat:0,lng:0},"{textField}":"[data-location-textField]","{detectLocationButton}":"[data-detect-location-button]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-story-location-suggestion]","{mapPreview}":"[data-location-map]","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]"}},function(self){return{init:function(){if(navigator.geolocation){self.detectLocationButton().show()}
EasySocial.require().library("gmaps").done(function(){self.textField().removeAttr("disabled")})},navigate:function(lat,lng){var mapPreview=self.mapPreview(),map=self.map;if(map===undefined){map=self.map=mapPreview.show().gmaps(self.options.map)}
map.setCenter(lat,lng);map.removeMarkers();map.addMarker({lat:lat,lng:lng})},locations:{},lastQueryAddress:null,"{textField} keypress":function(textField,event){switch(event.keyCode){case KEYCODE.UP:var prevSuggestion=$(self.suggestion(".active").prev(self.suggestion.selector)[0]||self.suggestion(":last")[0]);self.suggestion().removeClass("active");prevSuggestion.addClass("active").trigger("activate");self.suggestions().scrollTo(prevSuggestion,{offset:prevSuggestion.height()*-1});event.preventDefault();break;case KEYCODE.DOWN:var nextSuggestion=$(self.suggestion(".active").next(self.suggestion.selector)[0]||self.suggestion(":first")[0]);self.suggestion().removeClass("active");nextSuggestion.addClass("active").trigger("activate");self.suggestions().scrollTo(nextSuggestion,{offset:nextSuggestion.height()*-1});event.preventDefault();break;case KEYCODE.ENTER:var activeSuggestion=self.suggestion(".active"),location=activeSuggestion.data("location");self.set(location);self.suggestions().hide();break;case KEYCODE.ESCAPE:break}},"{textField} keyup":function(textField,event){switch(event.keyCode){case KEYCODE.UP:case KEYCODE.DOWN:case KEYCODE.ENTER:case KEYCODE.ESCAPE:break;default:var address=$.trim(textField.val());if(address===""){self.suggestions().hide()}
if(address==self.lastQueryAddress)return;var locations=self.locations[address];if(locations){self.suggest(locations);self.lastQueryAddress=address}else{self.lookup(address)}
break}},lookup:$._.debounce(function(address){$.GMaps.geocode({address:address,callback:function(locations,status){if(status=="OK"){self.locations[address]=locations;self.suggest(locations);self.lastQueryAddress=address}}})},250),suggest:function(locations){var suggestions=self.suggestions();suggestions.hide().empty();$.each(locations,function(i,location){self.view.suggestion({location:location}).data("location",location).appendTo(suggestions)});suggestions.show()},"{suggestion} activate":function(suggestion,event){var location=suggestion.data("location");self.navigate(location.geometry.location.lat(),location.geometry.location.lng())},"{suggestion} mouseover":function(suggestion){self.suggestion().removeClass("active");suggestion.addClass("active").trigger("activate")},"{suggestion} click":function(suggestion,event){var location=suggestion.data("location");self.set(location);self.suggestions().hide()},set:function(location){self.currentLocation=location;var address=location.formatted_address;self.textField().val(address);self.latitude().val(location.geometry.location.lat());self.longitude().val(location.geometry.location.lng());self.trigger("locationChange",[location])},"{detectLocationButton} click":function(){var map=self.map;$.GMaps.geolocate({success:function(position){$.GMaps.geocode({lat:position.coords.latitude,lng:position.coords.longitude,callback:function(locations,status){if(status=="OK"){self.suggest(locations);self.textField().focus()}}})},error:function(error){},always:function(){}})},"{story} save":function(el,element,save){var currentLocation=self.currentLocation;if(!currentLocation)return;save.addData(self,{short_address:currentLocation.address_components[0].long_name,formatted_address:currentLocation.formatted_address,lat:currentLocation.geometry.location.lat(),lng:currentLocation.geometry.location.lng()})},"{story} clear":function(){self.unset()}}});module.resolve()})});EasySocial.module('pagination',function(){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Pagination',{defaultOptions:{"{pages}":".pageItem","{limitstart}":"#limitstart","{previousItem}":".previousItem","{nextItem}":".nextItem"}},function(self)
{return{init:function()
{self.pages().implement(EasySocial.Controller.Pagination.Page,{pagination:self})},"{previousItem} click":function(elem)
{var limitstart=$(elem).data('limitstart');if($(elem).hasClass('disabled'))
{return}
self.submitForm(limitstart)},"{nextItem} click":function(elem)
{var limitstart=$(elem).data('limitstart');if($(elem).hasClass('disabled'))
{return}
self.submitForm(limitstart)},submitForm:function(limitstart)
{self.limitstart().val(limitstart);$.Joomla('submitform',[])}}});EasySocial.Controller('Pagination.Page',{defaultOptions:{pagination:null,limitstart:0}},function(self)
{return{init:function()
{self.options.limitstart=self.element.data('limitstart')},"{self} click":function()
{if(self.element.hasClass('active'))
{return!1}
self.options.pagination.submitForm(self.options.limitstart)}}});module.resolve()})});EasySocial.module("photos/avatar",function($){var module=this;EasySocial.require().library("imgareaselect").stylesheet("imgareaselect/default").done(function(){EasySocial.Controller("Photos.Avatar",{defaultOptions:{view:{selection:"site/photos/avatar.selection"},uid:null,type:null,redirect:!0,redirectUrl:"","{image}":"[data-photo-image]","{viewport}":"[data-photo-avatar-viewport]","{photoId}":"[data-photo-id]","{userId}":"[data-user-id]","{createButton}":"[data-create-button]","{selection}":"[data-selection-box]","{loadingIndicator}":"[data-photos-avatar-loading]"}},function(self){return{init:function(){self.setLayout()},data:function()
{var viewport=self.viewport(),width=viewport.width(),height=viewport.height(),selection=viewport.imgAreaSelect({instance:!0}).getSelection(),data={id:self.photoId().val(),uid:self.options.uid,type:self.options.type,top:selection.y1/height,left:selection.x1/width,width:selection.width/width,height:selection.height/height};return data},imageLoaders:{},setLayout:function(){var imageHolder=self.image(),imageUrl=imageHolder.css("backgroundImage").replace(/^url\(['"]?/,'').replace(/['"]?\)$/,''),imageLoaders=self.imageLoaders,imageLoader=imageLoaders[imageUrl]||(self.imageLoaders[imageUrl]=$.Image.get(imageUrl));imageLoader.done(function(imageEl,image){var size=$.Image.resizeWithin(image.width,image.height,imageHolder.width(),imageHolder.height()),min=Math.min(size.width,size.height),x1=Math.floor((size.width-min)/2),y1=Math.floor((size.height-min)/2),x2=x1+min,y2=y1+min;self.createButton().enabled(!0);self.viewport().css(size).imgAreaSelect({handles:!0,aspectRatio:"1:1",parent:self.image(),x1:x1,y1:y1,x2:x2,y2:y2,onSelectEnd:function(viewport,selection){var hasSelection=!(selection.width=="0"&&selection.height=="0");self.createButton().enabled(hasSelection)}})})},"{createButton} click":function(createButton)
{var data=self.data(),task=EasySocial.ajax("site/controllers/photos/createAvatar",data).done(function(photo,user)
{if(self.options.redirect)
{window.location=self.options.redirectUrl}}).fail(function(message,type)
{self.setMessage(message,type)});self.trigger("avatarCreate",[task,data,self])}}});module.resolve()})});EasySocial.module("photos/browser",function($){var module=this;EasySocial.require().library("masonry").done();EasySocial.require().library("history").done(function(){EasySocial.Controller("Photos.Browser",{defaultOptions:{tilesPerRow:4,"{sidebar}":"[data-photo-browser-sidebar]","{content}":"[data-photo-browser-content]","{backButton}":"[data-photo-back-button]","{backButtonLink}":"[data-photo-back-button-link]","{listItemGroup}":"[data-photo-list-item-group]","{listItem}":"[data-photo-list-item]","{listItemLink}":"[data-photo-list-item] > a","{listItemTitle}":"[data-photo-list-item-title]","{listItemCover}":"[data-photo-list-item-cover]","{listItemImage}":"[data-photo-list-item-image]","{featuredListItem}":"[data-photo-list-item].featured","{featuredListItemImage}":"[data-photo-list-item].featured [data-photo-list-item-image]","{photoItem}":"[data-photo-item]"}},function(self){return{init:function(){$.module("masonry").done(function(){self.setLayout()})},setLayout:function(){var listItemGroup=self.listItemGroup().addClass("masonry"),seed=self.setLayout.seed,intact=seed==listItemGroup.width()
hasPhotoItem=self.listItem().length>0,masonry=listItemGroup.data("masonry");if(intact){masonry&&masonry.reload()}else{var listItemGroup=self.listItemGroup(),listItem=self.listItem(),tilesPerRow=self.options.tilesPerRow,viewportWidth=listItemGroup.width(),containerWidth=Math.floor(viewportWidth/tilesPerRow)*tilesPerRow,tileWidth=containerWidth/tilesPerRow,tileWidthOffset=listItem.outerWidth(!0)-listItem.width(),tileHeight=tileWidth,tileHeightOffset=listItem.outerHeight(!0)-listItem.height(),itemWidth=tileWidth-tileWidthOffset,itemHeight=tileHeight-tileHeightOffset,imageWidth=itemWidth,imageHeight=itemHeight,featuredItemWidth=(tileWidth*2)-tileWidthOffset,featuredItemHeight=(tileHeight*2)-tileHeightOffset,featuredImageWidth=featuredItemWidth,featuredImageHeight=featuredItemHeight;self.listItem.css({width:itemWidth,height:itemHeight});self.listItemImage.css({width:imageWidth,height:imageHeight});self.featuredListItem.css({width:featuredItemWidth,height:featuredItemHeight});self.featuredListItemImage.css({width:featuredImageWidth,height:featuredImageHeight});listItemGroup.masonry({columnWidth:tileWidth}).masonry("reload")}
self.setLayout.seed=listItemGroup.width()},open:function(view){var args=$.makeArray(arguments);self.trigger("contentLoad",args);var method="view"+$.String.capitalize(view),loader=self[method].apply(self,args.slice(1));loader.done(self.displayContent(function(){self.trigger("contentDisplay",args);return arguments})).fail(function(){self.trigger("contentFail",args)}).always(function(){self.trigger("contentComplete",args)});return loader},displayContent:$.Enqueue(function(html){var scripts=[],content=$($.buildFragment([html],document,scripts));self.content().html(content);$(scripts).remove()}),viewPhoto:function(photoId){var state="active loading",listItem=self.listItem().removeClass(state).filterBy("photoId",photoId).addClass(state),loader=EasySocial.ajax("site/views/photos/item",{id:photoId,browser:!1}).fail(function(){}).always(function(){listItem.removeClass("loading")});return loader},"{listItem} click":function(listItem){var photoId=listItem.data("photoId");self.open("Photo",photoId);listItem.find("> a").route()},"{listItemLink} click":function(listItemLink,event){event.preventDefault();listItemLink.blur()},"{backButtonLink} click":function(albumsButtonLink,event){var browser=self.browser;if(browser){var albumId=self.element.data("albumId");browser.open("album",albumId);event.preventDefault();albumsButtonLink.route();browser.setLayout("album");self.element.remove()}},getListItem:function(photoId,context){var listItem=(!photoId)?self.listItem(".new"):self.listItem().filterBy("photoId",photoId);if(!context)return listItem;return listItem.find(self["listItem"+$.String.capitalize(context)].selector)},getNextListItem:function(photoId){var listItem=self.getListItem(photoId).next(self.listItem.selector);if(listItem.length<1){listItem=self.listItem(":first")}
return listItem},getPrevListItem:function(photoId){var listItem=self.getListItem(photoId).prev(self.listItem.selector);if(listItem.length<1){listItem=self.listItem(":last")}
return listItem},removeListItem:function(photoId,loadPreviousItem){var listItem=self.getListItem(photoId),prevListItem=self.getPrevListItem(photoId);listItem.remove();self.setLayout();if(self.listItem().length<1){self.element.addClass("loading");return window.location=self.backButtonLink().attr("href")}
if(loadPreviousItem){prevListItem.click()}},"{photoItem} init.photos.item":function(el,event,photoItem){self.addSubscriber(photoItem)},"{photoItem} photoSave":function(el,event,task){task.done(function(photo,html){self.getListItem(photo.id,"title").html(photo.title)})},"{photoItem} photoNext":function(el,event,photo){var listItem=self.getNextListItem(photo.id);listItem.click()},"{photoItem} photoPrev":function(el,event,photo){var listItem=self.getPrevListItem(photo.id);listItem.click()},"{photoItem} photoMove":function(el,event,task,photo,targetAlbumId){task.done(function(){self.removeListItem(photo.id,!0)})},"{photoItem} photoDelete":function(el,event,task,photo){task.done(function(){self.removeListItem(photo.id,!0)})},"{photoItem} photoFeature":function(el,event,task,photo,featured){var item=self.getListItem(photo.id);item.toggleClass("featured",featured);self.setLayout();task.fail(function(){item.toggleClass("featured",!featured);self.setLayout()})},"{sidebar} sidebarToggle":function(){self.setLayout()}}});module.resolve()})});EasySocial.module("photos/editor",function($){var module=this;EasySocial.require().done(function(){var Controller=EasySocial.Controller("Photos.Editor",{defaultOptions:{view:{uploadItem:"upload.item",photoForm:"site/albums/photo.form"},"{titleField}":"[data-photo-title-field]","{captionField}":"[data-photo-caption-field]","{location}":"[data-photo-location]","{locationCaption}":"[data-photo-location-caption]","{addLocationButton}":"[data-photo-addLocation-button]","{date}":"[data-photo-date]","{dateCaption}":"[data-photo-date-caption]","{addDateCaption}":"[data-photo-adddate-button]","{locationWidget}":".es-photo-location-form .es-location","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]","{dateDay}":"[name=date-day]","{dateMonth}":"[name=date-month]","{dateYear}":"[name=date-year]","{actionsMenu}":"[data-item-actions-menu]","{featureButton}":"[data-photo-feature-button]","{coverButton}":"[data-photo-cover-button]","{editButton}":"[data-photo-edit-button]","{editButtonLink}":"[data-photo-edit-button] > a","{cancelButton}":"[data-photo-cancel-button]","{doneButton}":"[data-photo-done-button]","{doneButtonLink}":"[data-photo-done-button] > a","{moveButton}":"[data-photo-move-button]","{deleteButton}":"[data-photo-delete-button]","{rotateLeftButton}":"[data-photo-rotateLeft-button]","{rotateRightButton}":"[data-photo-rotateRight-button]","{profileAvatarButton}":"[data-photo-profileAvatar-button]","{profileCoverButton}":"[data-photo-profileCover-button]"}},function(self){return{init:function(){},data:function(){return{id:self.photo.id,title:self.titleField().val(),caption:self.captionField().val(),date:self.formatDate(),address:self.locationCaption().html(),latitude:self.latitude().val(),longitude:self.longitude().val()}},save:function(){var data=self.data();self.clearMessage();var task=EasySocial.ajax("site/controllers/photos/update",data).done(function(photo){self.photo.setLayout("item")}).fail(function(){self.setMessage(message,"error")}).progress(function(message,type){if(type=="success"){self.setMessage(message)}});self.trigger("photoSave",[task,self]);return task},enable:function(){self.photo.setLayout("form");var album=self.photo.album;if(album){self.element.addClass("active")}
self.trigger("enabled",[self])},disable:function(){self.photo.setLayout("item");var album=self.photo.album;if(album){self.element.removeClass("active")}
self.trigger("disabled",[self])},imageLoader:{},setImage:function(type){var image=self.photo.image(),imageCss=self.photo.imageCss(),imageSource=image.data(type+"Src"),imageLoader=self.imageLoader[imageSource];if(!imageLoader){imageLoader=$.Image.get(imageSource);self.imageLoader[imageSource]=imageLoader}
imageLoader.done(function(){image.attr("src",imageSource);imageCss.css({backgroundImage:$.cssUrl(imageSource)})});return imageLoader},"{featureButton} click":function(featureButton,event){event.stopPropagation();var isPopup=self.photo.element.parents("[data-photo-popup]").length>0||self.photo.element.parents("[data-photo-browser-content]").length>0;var isFeatured=self.element.hasClass("featured");self.element.addTransitionClass("featuring",800).toggleClass("featured",!isFeatured);if(!isPopup){setTimeout(function(){self.setImage((isFeatured)?"thumbnail":"featured")},1000)}
var task=EasySocial.ajax("site/controllers/photos/feature",{id:self.photo.id}).done(function(message,isFeatured){featureButton.toggleClass('btn-es-primary',isFeatured)}).fail(function(){self.element.addTransitionClass("featuring",800).toggleClass("featured",isFeatured);if(!isPopup){setTimeout(function(){self.setImage((!isFeatured)?"thumbnail":"featured")},1000)}});self.trigger("photoFeature",[task,self.photo,!isFeatured])},"{coverButton} click":function(){var album=self.photo.album;if(!album)return;album.editor&&album.editor.setCover(self.photo.id)},"{dateDay} keyup":function(){self.updateDate()},"{dateMonth} change":function(){self.updateDate()},"{dateYear} keyup":function(){self.updateDate()},updateDate:function(){setTimeout(function(){self.date().addClass("has-data");var dateCaption=self.dateDay().val()+' '+$.trim(self.dateMonth().find(":selected").text()+' '+self.dateYear().val());self.dateCaption().html(dateCaption)},1)},formatDate:function(){var day=self.dateDay().val()||self.dateDay().data('date-default'),month=self.dateMonth().val()||self.dateMonth().data('date-default'),year=self.dateYear().val()||self.dateYear().data('date-default');return year+'-'+month+'-'+day},"{locationWidget} locationChange":function(el,event,location){var address=location.formatted_address;self.locationCaption().html(address);self.location().addClass("has-data")},rotate:function(angle){var photo=self.photo;self.rotateLeftButton().disabled(!0);self.rotateRightButton().disabled(!0);photo.content().addClass("loading");var task=EasySocial.ajax("site/controllers/photos/rotate",{id:photo.id,angle:angle}).done(function(photoObj){var url;if(self.photo.album){url=photoObj.sizes.thumbnail.url}else{url=photoObj.sizes.large.url}
url+="?"+$.uid();photo.image().attr("src",url);photo.imageCss().css({backgroundImage:$.cssUrl(url)});self.element.addTransitionClass("rotating-ready",150).removeClass("rotating-right rotating-left")}).fail(function(message,type){self.setMessage(message,type)}).always(function(){photo.content().removeClass("loading");self.rotateLeftButton().disabled(!1);self.rotateRightButton().disabled(!1)});self.trigger("photoRotate",[task,angle,photo])},"{rotateRightButton} click":function(){self.element.addClass("rotating-right");self.rotate(90)},"{rotateLeftButton} click":function(){self.element.addClass("rotating-left");self.rotate(-90)},"{moveButton} click":function(){var photo=self.photo;var dialog=EasySocial.dialog({content:EasySocial.ajax("site/views/photos/moveToAnotherAlbum",{id:photo.id}),bindings:{"{moveButton} click":function(){var targetAlbumId=this.albumSelection().val();var task=EasySocial.ajax("site/controllers/photos/move",{id:photo.id,albumId:targetAlbumId}).always(function(){dialog.close()});self.trigger("photoMove",[task,photo,targetAlbumId])}}})},"{deleteButton} click":function(){var photo=self.photo;EasySocial.dialog({content:EasySocial.ajax("site/views/photos/confirmDelete",{id:photo.id}),bindings:{"{deleteButton} click":function(deleteButton){var dialog=this.parent;deleteButton.disabled(!0);var task=EasySocial.ajax("site/controllers/photos/delete",{id:photo.id}).always(function(){dialog.close()});self.trigger("photoDelete",[task,photo])}}})},"{editButton} click":function(){self.photo.setLayout("form");self.editButtonLink().route()},"{editButtonLink} click":function(editButtonLink,event){event.preventDefault()},"{cancelButton} click":function()
{self.photo.setLayout("item");self.doneButtonLink().route()},"{doneButton} click":function(){self.save().done(function(){self.photo.setLayout("item");self.doneButtonLink().route()}).fail(function(){})},"{doneButtonLink} click":function(doneButtonLink,event){event.preventDefault()},"{profileAvatarButton} click":function(){EasySocial.photos.createAvatar(self.photo.id)}}});module.resolve(Controller)})});EasySocial.module("photos/item",function($){var module=this;EasySocial.require().script("photos/tags","photos/editor","photos/tagger","photos/navigation").done();EasySocial.require().library("image").done(function(){var Controller=EasySocial.Controller("Photos.Item",{hostname:"photo",defaultOptions:{editable:!1,taggable:!1,navigation:!1,"{header}":"[data-photo-header]","{content}":"[data-photo-content]","{footer}":"[data-photo-footer]","{viewport}":"[data-photo-viewport]","{info}":"[data-photo-info]","{title}":"[data-photo-title]","{titleLink}":"[data-photo-title-link]","{caption}":"[data-photo-caption]","{image}":"[data-photo-image]","{imageCss}":"[data-photo-image-css]","{imageLink}":"[data-photo-image-link]","{menu}":"[data-photo-menu]","{actions}":"[data-item-actions]","{actionsMenu}":"[data-item-actions-menu]","{comments}":"[data-comments]","{share}":"[data-repost-action]","{likes}":"[data-likes-action]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{counterBar}":"[data-stream-counter]","{privacy}":"[data-es-privacy-container]","{likeCount}":"[data-photo-like-count]","{commentCount}":"[data-photo-comment-count]","{tagCount}":"[data-photo-tag-count]"}},function(self){return{init:function(){self.id=self.element.data("photoId");EasySocial.module("photos/tags").done(function(TagsController){self.tags=self.addPlugin("tags",TagsController)});if(self.options.editable){EasySocial.module("photos/editor").done(function(EditorController){self.editor=self.addPlugin("editor",EditorController)})}
if(self.options.taggable){EasySocial.module("photos/tagger").done(function(TaggerController){self.tagger=self.addPlugin("tagger",TaggerController)})}
if(self.options.navigation){EasySocial.module("photos/navigation").done(function(NavigationController){self.navigation=self.addPlugin("navigation",NavigationController)})}},data:function(){var image=self.image();return{id:self.id,title:$.trim(self.title().text()),caption:$.trim(self.caption().text()),sizes:{thumbnail:image.data("thumbnailSrc"),featured:image.data("featuredSrc"),large:image.data("largeSrc")}}},setLayout:function(layoutName){self.element.data("photoLayout",layoutName).switchClass("layout-"+layoutName);self.trigger("layoutChange",[layoutName,self])},"{self} click":function(el,event){if(!el.data("esPhotoDisabled"))return;var target=$(event.target),menu=self.menu();if(target.parents().andSelf().filter(menu).length>0)return;self.trigger("activate",[self])},"{self} photoSave":function(el,event,task){task.done(function(photo,html){self.info().replaceWith(html)})},"{self} photoDelete":function(el,event,task){task.done(function(){}).fail(function(message,type){self.setMessage(message,type)})},"{imageLink} click":function(imageLink,event){event.preventDefault()},"{titleLink} click":function(titleLink,event){},"{self} shown.bs.dropdown":function(){self.element.addClass("show-all")},"{self} hidden.bs.dropdown":function(){self.element.removeClass("show-all")},"{share} create":function(el,event,itemHTML){self.counterBar().removeClass('hide')},"{likes} onLiked":function(el,event,data){self.counterBar().removeClass('hide');self.count("like",1,!0)},"{likes} onUnliked":function(el,event,data){var isLikeHide=self.likeContent().hasClass('hide');var isRepostHide=self.repostContent().hasClass('hide');if(isLikeHide&&isRepostHide)
{self.counterBar().addClass('hide')}
self.count("like",-1,!0)},"{self} tagAdd":function(){self.count("tag",1,!0)},"{self} tagRemove":function(){self.count("tag",-1,!0)},"{comments} newCommentSaved":function(){self.count("comment",1,!0)},"{comments} commentDeleted":function(){self.count("comment",-1,!0)},"{privacy} activate":function(){setTimeout(function(){self.element.addClass("show-all")},0)},"{privacy} deactivate":function(){self.element.removeClass("show-all")},count:function(subject,val,append){var statSelector=self[subject+"Count"];if(!$.isFunction(statSelector))return;var stat=statSelector();if(stat.length<0)return;var statCount;if(append){statCount=(parseInt(stat.text())||0)+(parseInt(val)||0)}else{statCount=val}
if(statCount<0)statCount=0;stat.text(statCount)}}});module.resolve(Controller)})});EasySocial.module("photos/tags",function($){var module=this;EasySocial.require().library("scrollTo").done();EasySocial.require().done(function(){var Controller=EasySocial.Controller("Photos.Tags",{hostname:"tags",defaultOptions:{"{viewport}":"[data-photo-tag-viewport]","{tagItem}":"[data-photo-tag-item]","{tagButton}":"[data-photo-tag-button]","{tagLink}":"[data-photo-tag-link]","{infoTagListItemGroup}":"[data-photoinfo-tag-list-item-group]","{infoTagListItem}":"[data-photo-tags-user]","{tagListItemGroup}":"[data-photo-tag-list-item-group]","{tagListItem}":"[data-photo-tag-list-item]","{descTagItem}":"[data-photo-tags-user]"}},function(self){return{init:function(){self.setLayout()},imageLoaders:{},setLayout:function(callback){var viewport=self.photo.viewport(),image=self.photo.image(),imageUrl=image.attr("src"),imageLoaders=self.imageLoaders,imageLoader=imageLoaders[imageUrl]||(self.imageLoaders[imageUrl]=$.Image.get(imageUrl));imageLoader.done(function(){var imageOffset=image.offset(),viewportOffset=viewport.offset();self.viewport().css({top:imageOffset.top-viewportOffset.top,left:imageOffset.left-viewportOffset.left,width:image.width(),height:image.height()});callback&&callback()})},"{window} resize":$.debounce(function(){self.setLayout()},1000),getTagItem:function(tagId){return self.tagItem().filterBy("photoTagId",tagId)},getTagListItem:function(tagId){return self.tagListItem().filterBy("photoTagId",tagId)},getInfoTagListItem:function(tagId){return self.infoTagListItem().filterBy("photoTagId",tagId)},getTaggedUsers:function(){var users=[];self.tagListItem("[data-photo-tag-uid]").each(function(){users.push($(this).data("photoTagUid"))});return $.uniq(users)},activateTag:function(tagId){self.getTagItem(tagId).addClass("active");self.getTagListItem(tagId).addClass("active")},deactivateTag:function(tagId){self.getTagItem(tagId).removeClass("active");self.getTagListItem(tagId).removeClass("active")},"{tagLink} click":function(el,event){event.stopPropagation()},"{tagListItem} click":function(el){var method=(el.hasClass('active')?"deactivate":"activate")+"Tag",tagId=el.data("photoTagId");self[method](tagId)},"{tagListItem} mouseover":function(el){self.getTagItem(el.data("photoTagId")).addClass("focus")},"{tagListItem} mouseout":function(el){self.getTagItem(el.data("photoTagId")).removeClass("focus")},"{descTagItem} mouseover":function(el){self.getTagItem(el.data("photoTagId")).addClass("focus")},"{descTagItem} mouseout":function(el){self.getTagItem(el.data("photoTagId")).removeClass("focus")},"{self} tagCreate":function(el,event,task){task.done(function(){}).always(function(){setTimeout(function(){self.tagListItemGroup().toggleClass("empty-tags",self.tagListItem().length<1)},1)})},"{self} tagRemove":function(el,event,task,tagId){task.done(function(){self.getTagItem(tagId).remove();self.getTagListItem(tagId).remove();self.getInfoTagListItem(tagId).remove();var taglen=self.infoTagListItemGroup().children().length;if(taglen==0){self.infoTagListItemGroup().html('')}
if(taglen==1){var tag=self.infoTagListItemGroup().children().first();var tagcontent=tag.text();tagcontent=tagcontent.replace(',','');console.log(tagcontent);tag.text(tagcontent)}}).always(function(){self.tagListItemGroup().toggleClass("empty-tags",self.tagListItem().length<1)})},"{self} photoRotate":function(el,event,task,angle,photo){task.done(function(photoObj,tags){setTimeout(function(){self.setLayout(function(){var tagItems=self.tagItem();$.each(tags,function(i,tag){var tagItem=tagItems.filterBy("photoTagId",tag.id);tagItem.css({width:(tag.width*100)+"%",height:(tag.height*100)+"%",top:(tag.top*100)+"%",left:(tag.left*100)+"%"})})})},1)})}}});module.resolve(Controller)})});EasySocial.module("photos/tagger",function($){var module=this;var KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.require().library("scrollTo").done();EasySocial.require().view("site/photos/tags.item","site/photos/tags.menu.item").done(function(){var Controller=EasySocial.Controller("Photos.Tagger",{hostname:"tagger",defaultOptions:{view:{tagItem:"site/photos/tags.item"},width:100,height:100,drawTolerance:30,"{viewport}":"[data-photo-tag-viewport]","{tagItem}":"[data-photo-tag-item]","{tagSelection}":"[data-photo-tag-item].new","{tagButton}":"[data-photo-tag-button]","{infoTagListItemGroup}":"[data-photoinfo-tag-list-item-group]","{tagListItemGroup}":"[data-photo-tag-list-item-group]","{tagListItem}":"[data-photo-tag-list-item]","{tagRemoveButton}":"[data-photo-tag-remove-button]"}},function(self){return{init:function(){},newTagItem:function(){var viewport=self.viewport(),newTagItem=self.tagItem(".new");if(newTagItem.length<1){newTagItem=self.view.tagItem().addClass("new").appendTo(viewport);self.addSubscriber(newTagItem.addController("EasySocial.Controller.Photos.Tag"))}
return newTagItem},"{tagButton} click":function(tagButton){self[tagButton.data("photoTagButton")||"toggle"]()},disabled:!0,enable:function(){self.photo.imageLink().on("click.tagger",function(event){event.preventDefault()});self.disabled=!1;self.element.addClass("tagging");if($.scrollTo){$.scrollTo(self.photo.content(),250,{offset:{top:-100}})}
self.trigger("tagEnter")},disable:function(){self.photo.imageLink().off("click.tagger");self.tagSelection().remove();self.tagItem(".focus").removeClass("focus");self.disabled=!0;self.element.removeClass("tagging");self.trigger("tagLeave")},toggle:function(){self[(self.disabled)?"enable":"disable"]()},area:{},calculateArea:function(collision,offset){if(!collision){collision="clip"};if(!offset){offset={x:0,y:0}};var viewportEl=self.viewport(),viewport=viewportEl.offset();viewport.width=viewportEl.width();viewport.height=viewportEl.height();viewport.right=viewport.width+viewport.left;viewport.bottom=viewport.height+viewport.top;var area=self.area;area.top=((area.startY<=area.endY)?area.startY:area.endY)+offset.y;area.left=((area.startX<=area.endX)?area.startX:area.endX)+offset.x;area.width=Math.abs(area.endX-area.startX);area.height=Math.abs(area.endY-area.startY);area.right=area.width+area.left;area.bottom=area.height+area.top;if(collision=="clip"){if(area.top<=viewport.top){area.top=viewport.top}
if(area.bottom>=viewport.bottom){area.bottom=viewport.bottom}
if(area.left<=viewport.left){area.left=viewport.left}
if(area.right>=viewport.right){area.right=viewport.right}
area.width=area.right-area.left;area.height=area.bottom-area.top}
if(collision=="flip"){if(area.top<=viewport.top){area.top=viewport.top}
if(area.left<=viewport.left){area.left=viewport.left}
if(area.right>=viewport.right){area.right=viewport.right;area.left=area.right-area.width}
if(area.bottom>=viewport.bottom){area.bottom=viewport.bottom;area.top=area.bottom-area.height}}
area.pixel={top:area.top-viewport.top,left:area.left-viewport.left,width:area.width,height:area.height};area.decimal={top:area.pixel.top/viewport.height,left:area.pixel.left/viewport.width,width:area.width/viewport.width,height:area.height/viewport.height}
area.percentage={top:(area.decimal.top*100)+"%",left:(area.decimal.left*100)+"%",width:(area.decimal.width*100)+"%",height:(area.decimal.height*100)+"%"};var tolerance=self.options.drawTolerance;self.autodraw=(area.width<tolerance&&area.height<tolerance);return area},setPivot:function(type,x,y){var area=self.area;area[type+"X"]=x;area[type+"Y"]=y},drawing:!1,autodraw:!1,drawTag:function(){var area=self.calculateArea();options=self.options;if(self.autodraw){area.endX=area.startX+options.width;area.endY=area.startY+options.height;self.calculateArea("flip",{x:options.width/-2,y:options.height/-2})}
self.newTagItem().css(area.percentage).trigger("focusInput")},"{viewport} mousedown":function(viewport,event){if(self.disabled)return;if(event.target!==viewport[0])return;event.preventDefault();self.tagItem(".focus").removeClass("focus");self.drawing=!0;self.setPivot("start",event.pageX,event.pageY);$(document).on("mousemove.tagger",function(event){if(!self.drawing)return;self.setPivot("end",event.pageX,event.pageY);self.drawTag()}).on("mouseup.tagger",function(event){self.setPivot("end",event.pageX,event.pageY);self.drawTag();$(document).off("mousemove.tagger mouseup.tagger")})},createTag:function(data){var data=$.extend({photo_id:self.photo.id},data,self.area.decimal);var task=EasySocial.ajax("site/controllers/photos/createTag",data);self.trigger("tagCreate",[task,data,self]);return task},removeTag:function(id){var task=EasySocial.ajax("site/controllers/photos/removeTag",{id:id});self.trigger("tagRemove",[task,id,self]);return task},addTag:function(data,tagItemHtml,tagListItemHtml,infoTagListItemHtml){var tagItem=$.buildHTML(tagItemHtml).addClass("focus").appendTo(self.viewport());var tagListItem=$.buildHTML(tagListItemHtml).appendTo(self.tagListItemGroup());var taglen=self.infoTagListItemGroup().children().length;if(taglen==0){self.infoTagListItemGroup().append(' - ')}
var infoTagListItem=$.buildHTML(infoTagListItemHtml).appendTo(self.infoTagListItemGroup());self.trigger("tagAdd",[data,tagItem,tagListItem,self])},"{self} avatarEnter":function(){self.tagItem().hide();self.disable()},"{self} avatarLeave":function(){self.tagItem().show()},"{tagRemoveButton} click":function(button,event){var tagId=button.data("photoTagId");self.removeTag(tagId);event.stopPropagation()},"{tagRemoveButton} mouseover":function(){self.viewport().addClass("active")},"{tagRemoveButton} mouseout":function(){self.viewport().removeClass("active")}}});EasySocial.Controller("Photos.Tag",{defaultOptions:{view:{menuItem:"site/photos/tags.menu.item"},"{form}":"[data-photo-tag-form]","{title}":"[data-photo-tag-title]","{removeButton}":"[data-photo-tag-remove-button]","{textField}":"[data-photo-tag-input]","{menu}":"[data-photo-tag-menu]","{menuItem}":"[data-photo-tag-menu-item]"}},function(self){return{init:function(){self.data=self.options.data},"{self} focusInput":function(){self.textField().focus()},"{textField} keyup":$._.debounce(function(el,event){var keyword=$.trim(self.textField().val());switch(event.keyCode){case KEYCODE.UP:case KEYCODE.DOWN:case KEYCODE.ENTER:case KEYCODE.ESCAPE:break;default:var users=self.tagger.photo.tags.getTaggedUsers();EasySocial.ajax("site/controllers/friends/suggestPhotoTagging",{search:keyword,exclude:users,includeme:'1'}).done(self.render());break}},250),"{textField} keypress":function(textField,event){var keyword=$.trim(self.textField().val());var activeMenuItem=self.menuItem(".active");switch(event.keyCode){case KEYCODE.UP:self.menuItem().removeClass("active");if(activeMenuItem.length<1){self.menuItem(":last").addClass("active")}else{activeMenuItem.prev(self.menuItem.selector).addClass("active")}
event.preventDefault();break;case KEYCODE.DOWN:self.menuItem().removeClass("active");if(activeMenuItem.length<1){self.menuItem(":first").addClass("active")}else{activeMenuItem.next(self.menuItem.selector).addClass("active")}
event.preventDefault();break;case KEYCODE.ENTER:if(activeMenuItem.length>0){activeMenuItem.trigger("click")}else{self.create({type:"label",label:keyword})};self.menu().hide();break;case KEYCODE.ESCAPE:self.menu().hide();break}},"{menuItem} mouseover":function(menuItem){self.menuItem().removeClass("active");menuItem.addClass("active")},"{menuItem} mouseout":function(menuItem){self.menuItem().removeClass("active")},render:$.Enqueue(function(items){var menu=self.menu();if(!items||items.length<1){menu.hide();return}
menu.empty();$.each(items,function(i,item){self.view.menuItem({item:item}).data("item",item).appendTo(menu);menu.show()})}),create:function(data){var tag=self.element;self.data=data;self.title().html(data.label);if($.trim(data.label)==="")return;self.tagger.createTag(data).done(function(tag,tagItemHtml,tagListItemHtml,infoTagListItemHtml){self.tagger.addTag(tag,tagItemHtml,tagListItemHtml,infoTagListItemHtml);self.element.remove()}).fail(function(message){alert(message.message);tag.remove()})},remove:function(){var tag=self.element,tagId=(self.data||{}).id;if(!tagId)return tag.remove();self.tagger.removeTag(tagId).done(function(){tag.remove()})},"{menuItem} click":function(menuItem){var item=menuItem.data("item");self.create({uid:item.id,type:"person",label:item.screenName,})},"{removeButton} click":function(){self.remove()}}});module.resolve(Controller)})});EasySocial.module("photos/navigation",function($){$.fn.intersectsWith=function(top,left,width,height){var offset=this.offset(),reference={top:offset.top,left:offset.left,bottom:offset.top+(sourceHeight=this.height()),right:offset.left+(sourceWidth=this.width()),width:sourceWidth,height:sourceHeight},subject={top:top,left:left,bottom:top+(height||(height=0)),right:left+(width||(width=0)),width:width,height:height},intersects=(reference.left<=subject.right&&subject.left<=reference.right&&reference.top<=subject.bottom&&subject.top<=reference.bottom);return(intersects)?{reference:reference,subject:subject}:!1};var module=this;var Controller=EasySocial.Controller("Photos.Navigation",{hostname:"navigation",defaultOptions:{"{navButton}":".es-photo-nav-button","{nextButton}":"[data-photo-next-button]","{prevButton}":"[data-photo-prev-button]"}},function(self,opts,base){return{init:function(){self.setDirection(window.esPhotosNavigationLastDirection)},disabled:!1,disable:function(){self.disabled=!0;self.navButton().addClass("disabled")},enable:function(){self.disabled=!1;self.navButton().removeClass("disabled")},setDirection:function(direction){self.navButton().removeClass("active");window.esPhotosNavigationLastDirection=self.currentDirection=direction;if(direction){self[direction+"Button"]().addClass("active")}},"{window} mousemove":function(el,event){if(self.disabled)return;self.setDirection(null);self.photo.trigger("directionstop");if($(event.target).parents().filter(self.photo.content.selector).length<1)return;var offset=self.photo.content().intersectsWith(event.pageY,event.pageX);if(offset){var direction=(offset.subject.left<(offset.reference.right-(offset.reference.width/2)))?"prev":"next";self.setDirection(direction);self.photo.trigger("directionmove",[offset,direction])}},"{self} tagEnter":function(){self.disable()},"{self} tagLeave":function(){self.enable()},"{self} click":function(el,event){if(self.disabled)return;if($(event.target).parents().filter(self.photo.content.selector).length<1)return;var direction=self.currentDirection;if(!direction)return;self.trigger("photo"+$.String.capitalize(direction),[self.photo])},"{self} photoNext":function(){},"{self} photoPrev":function(){}}});module.resolve(Controller)});EasySocial.module("prism",function($){var module=this;(function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){var n=t.util.type(e);switch(n){case"Object":var r={};for(var i in e)e.hasOwnProperty(i)&&(r[i]=t.util.clone(e[i]));return r;case"Array":return e.slice()}return e}},languages:{extend:function(e,n){var r=t.util.clone(t.languages[e]);for(var i in n)r[i]=n[i];return r},insertBefore:function(e,n,r,i){i=i||t.languages;var s=i[e],o={};for(var u in s)if(s.hasOwnProperty(u)){if(u==n)for(var a in r)r.hasOwnProperty(a)&&(o[a]=r[a]);o[u]=s[u]}return i[e]=o},DFS:function(e,n){for(var r in e){n.call(e,r,e[r]);t.util.type(e)==="Object"&&t.languages.DFS(e[r],n)}}},highlightAll:function(e,n){var r=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code');for(var i=0,s;s=r[i++];)t.highlightElement(s,e===!0,n)},highlightElement:function(r,i,s){var o,u,a=r;while(a&&!e.test(a.className))a=a.parentNode;if(a){o=(a.className.match(e)||[,""])[1];u=t.languages[o]}if(!u)return;r.className=r.className.replace(e,"").replace(/\s+/g," ")+" language-"+o;a=r.parentNode;/pre/i.test(a.nodeName)&&(a.className=a.className.replace(e,"").replace(/\s+/g," ")+" language-"+o);var f=r.textContent;if(!f)return;f=f.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ");var l={element:r,language:o,grammar:u,code:f};t.hooks.run("before-highlight",l);if(i&&self.Worker){var c=new Worker(t.filename);c.onmessage=function(e){l.highlightedCode=n.stringify(JSON.parse(e.data),o);t.hooks.run("before-insert",l);l.element.innerHTML=l.highlightedCode;s&&s.call(l.element);t.hooks.run("after-highlight",l)};c.postMessage(JSON.stringify({language:l.language,code:l.code}))}else{l.highlightedCode=t.highlight(l.code,l.grammar,l.language);t.hooks.run("before-insert",l);l.element.innerHTML=l.highlightedCode;s&&s.call(r);t.hooks.run("after-highlight",l)}},highlight:function(e,r,i){return n.stringify(t.tokenize(e,r),i)},tokenize:function(e,n,r){var i=t.Token,s=[e],o=n.rest;if(o){for(var u in o)n[u]=o[u];delete n.rest}e:for(var u in n){if(!n.hasOwnProperty(u)||!n[u])continue;var a=n[u],f=a.inside,l=!!a.lookbehind,c=0;a=a.pattern||a;for(var h=0;h<s.length;h++){var p=s[h];if(s.length>e.length)break e;if(p instanceof i)continue;a.lastIndex=0;var d=a.exec(p);if(d){l&&(c=d[1].length);var v=d.index-1+c,d=d[0].slice(c),m=d.length,g=v+m,y=p.slice(0,v+1),b=p.slice(g+1),w=[h,1];y&&w.push(y);var E=new i(u,f?t.tokenize(d,f):d);w.push(E);b&&w.push(b);Array.prototype.splice.apply(s,w)}}}return s},hooks:{all:{},add:function(e,n){var r=t.hooks.all;r[e]=r[e]||[];r[e].push(n)},run:function(e,n){var r=t.hooks.all[e];if(!r||!r.length)return;for(var i=0,s;s=r[i++];)s(n)}}},n=t.Token=function(e,t){this.type=e;this.content=t};n.stringify=function(e,r,i){if(typeof e=="string")return e;if(Object.prototype.toString.call(e)=="[object Array]")return e.map(function(t){return n.stringify(t,r,e)}).join("");var s={type:e.type,content:n.stringify(e.content,r,i),tag:"span",classes:["token",e.type],attributes:{},language:r,parent:i};s.type=="comment"&&(s.attributes.spellcheck="true");t.hooks.run("wrap",s);var o="";for(var u in s.attributes)o+=u+'="'+(s.attributes[u]||"")+'"';return"<"+s.tag+' class="'+s.classes.join(" ")+'" '+o+">"+s.content+"</"+s.tag+">"};if(!self.document){self.addEventListener("message",function(e){var n=JSON.parse(e.data),r=n.language,i=n.code;self.postMessage(JSON.stringify(t.tokenize(i,t.languages[r])));self.close()},!1);return}var r=document.getElementsByTagName("script");r=r[r.length-1];if(r){t.filename=r.src;document.addEventListener&&!r.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll)}})();Prism.languages.markup={comment:/&lt;!--[\w\W]*?-->/g,prolog:/&lt;\?.+?\?>/,doctype:/&lt;!DOCTYPE.+?>/,cdata:/&lt;!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?>/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|>|"/g}},punctuation:/\/?>/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi};Prism.hooks.add("wrap",function(e){e.type==="entity"&&(e.attributes.title=e.content.replace(/&amp;/,"&"))});Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*{))/gi,inside:{punctuation:/[;:]/g}},url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\};]*(?=\s*\{)/g,property:/(\b|\B)[\w-]+(?=\s*:)/ig,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g};Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}});Prism.languages.css.selector={pattern:/[^\{\}\s][^\{\}]*(?=\s*\{)/g,inside:{"pseudo-element":/:(?:after|before|first-letter|first-line|selection)|::[-\w]+/g,"pseudo-class":/:[-\w]+(?:\(.*\))?/g,"class":/\.[-:\.\w]+/g,id:/#[-:\.\w]+/g}};Prism.languages.insertBefore("css","ignore",{hexcode:/#[\da-f]{3,6}/gi,entity:/\\[\da-f]{1,8}/gi,number:/[\d%\.]+/g,"function":/(attr|calc|cross-fade|cycle|element|hsla?|image|lang|linear-gradient|matrix3d|matrix|perspective|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|rgba?|rotatex|rotatey|rotatez|rotate3d|rotate|scalex|scaley|scalez|scale3d|scale|skewx|skewy|skew|steps|translatex|translatey|translatez|translate3d|translate|url|var)/ig});Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|(^|[^:])\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/ig,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,"boolean":/\b(true|false)\b/g,"function":{pattern:/[a-z0-9_]+\(/ig,inside:{punctuation:/\(/}},number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,operator:/[-+]{1,2}|!|&lt;=?|>=?|={1,3}|(&amp;){1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g};Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|throw|catch|finally|null|break|continue)\b/g,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g});Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}});Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/ig,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/ig,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}});Prism.languages.php=Prism.languages.extend("clike",{keyword:/\b(and|or|xor|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|return|static|switch|use|require|require_once|var|while|abstract|interface|public|implements|extends|private|protected|parent|static|throw|null|echo|print|trait|namespace|use|final|yield|goto|instanceof|finally|try|catch)\b/ig,constant:/\b[A-Z0-9_]{2,}\b/g});Prism.languages.insertBefore("php","keyword",{delimiter:/(\?>|&lt;\?php|&lt;\?)/ig,variable:/(\$\w+)\b/ig,"package":{pattern:/(\\|namespace\s+|use\s+)[\w\\]+/g,lookbehind:!0,inside:{punctuation:/\\/}}});Prism.languages.insertBefore("php","operator",{property:{pattern:/(->)[\w]+/g,lookbehind:!0}});Prism.languages.markup&&(Prism.hooks.add("before-highlight",function(a){"php"===a.language&&(a.tokenStack=[],a.code=a.code.replace(/(?:&lt;\?php|&lt;\?|<\?php|<\?)[\w\W]*?(?:\?&gt;|\?>)/ig,function(b){a.tokenStack.push(b);return"{{{PHP"+a.tokenStack.length+"}}}"}))}),Prism.hooks.add("after-highlight",function(a){if("php"===a.language){for(var b=0,c;c=a.tokenStack[b];b++)a.highlightedCode=a.highlightedCode.replace("{{{PHP"+(b+1)+"}}}",Prism.highlight(c,a.grammar,"php"));a.element.innerHTML=a.highlightedCode}}),Prism.hooks.add("wrap",function(a){"php"===a.language&&"markup"===a.type&&(a.content=a.content.replace(/(\{\{\{PHP[0-9]+\}\}\})/g,'<span class="token php">$1</span>'))}),Prism.languages.insertBefore("php","comment",{markup:{pattern:/(&lt;|<)[^?]\/?(.*?)(>|&gt;)/g,inside:Prism.languages.markup},php:/\{\{\{PHP[0-9]+\}\}\}/g}));Prism.languages.insertBefore("php","variable",{"this":/\$this/g,global:/\$_?(GLOBALS|SERVER|GET|POST|FILES|REQUEST|SESSION|ENV|COOKIE|HTTP_RAW_POST_DATA|argc|argv|php_errormsg|http_response_header)/g,scope:{pattern:/\b[\w\\]+::/g,inside:{keyword:/(static|self|parent)/,punctuation:/(::|\\)/}}});Prism.languages.coffeescript=Prism.languages.extend("javascript",{"block-comment":/([#]{3}\s*\r?\n(.*\s*\r*\n*)\s*?\r?\n[#]{3})/g,comment:/(\s|^)([#]{1}[^#^\r^\n]{2,}?(\r?\n|$))/g,keyword:/\b(this|window|delete|class|extends|namespace|extend|ar|let|if|else|while|do|for|each|of|return|in|instanceof|new|with|typeof|try|catch|finally|null|undefined|break|continue)\b/g});Prism.languages.insertBefore("coffeescript","keyword",{"function":{pattern:/[a-z|A-z]+\s*[:|=]\s*(\([.|a-z\s|,|:|{|}|\"|\'|=]*\))?\s*-&gt;/gi,inside:{"function-name":/[_?a-z-|A-Z-]+(\s*[:|=])| @[_?$?a-z-|A-Z-]+(\s*)| /g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g}},"attr-name":/[_?a-z-|A-Z-]+(\s*:)| @[_?$?a-z-|A-Z-]+(\s*)| /g});Prism.languages.scss=Prism.languages.extend("css",{comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},atrule:/@[\w-]+(?=\s+(\(|\{|;))/gi,url:/([-a-z]+-)*url(?=\()/gi,selector:/([^@;\{\}\(\)]?([^@;\{\}\(\)]|&amp;|\#\{\$[-_\w]+\})+)(?=\s*\{(\}|\s|[^\}]+(:|\{)[^\}]+))/gm});Prism.languages.insertBefore("scss","atrule",{keyword:/@(if|else if|else|for|each|while|import|extend|debug|warn|mixin|include|function|return)|(?=@for\s+\$[-_\w]+\s)+from/i});Prism.languages.insertBefore("scss","property",{variable:/((\$[-_\w]+)|(#\{\$[-_\w]+\}))/i});Prism.languages.insertBefore("scss","ignore",{placeholder:/%[-_\w]+/i,statement:/\B!(default|optional)\b/gi,"boolean":/\b(true|false)\b/g,"null":/\b(null)\b/g,operator:/\s+([-+]{1,2}|={1,2}|!=|\|?\||\?|\*|\/|\%)\s+/g});Prism.languages.bash=Prism.languages.extend("clike",{comment:{pattern:/(^|[^"{\\])(#.*?(\r?\n|$))/g,lookbehind:!0},string:{pattern:/("|')(\\?[\s\S])*?\1/g,inside:{property:/\$([a-zA-Z0-9_#\?\-\*!@]+|\{[^\}]+\})/g}},keyword:/\b(if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)\b/g});Prism.languages.insertBefore("bash","keyword",{property:/\$([a-zA-Z0-9_#\?\-\*!@]+|\{[^}]+\})/g});Prism.languages.insertBefore("bash","comment",{important:/(^#!\s*\/bin\/bash)|(^#!\s*\/bin\/sh)/g});Prism.languages.c=Prism.languages.extend("clike",{keyword:/\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/g,operator:/[-+]{1,2}|!=?|&lt;{1,2}=?|&gt;{1,2}=?|\-&gt;|={1,2}|\^|~|%|(&amp;){1,2}|\|?\||\?|\*|\//g});Prism.languages.insertBefore("c","keyword",{property:/#\s*[a-zA-Z]+/g});Prism.languages.cpp=Prism.languages.extend("c",{keyword:/\b(alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|delete\[\]|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|new\[\]|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/g,operator:/[-+]{1,2}|!=?|&lt;{1,2}=?|&gt;{1,2}=?|\-&gt;|:{1,2}|={1,2}|\^|~|%|(&amp;){1,2}|\|?\||\?|\*|\/|\b(and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/g});Prism.languages.sql={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|((--)|(\/\/)).*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,keyword:/\b(ACTION|ADD|AFTER|ALGORITHM|ALTER|ANALYZE|APPLY|AS|AS|ASC|AUTHORIZATION|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADE|CASCADED|CASE|CHAIN|CHAR VARYING|CHARACTER VARYING|CHECK|CHECKPOINT|CLOSE|CLUSTERED|COALESCE|COLUMN|COLUMNS|COMMENT|COMMIT|COMMITTED|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS|CONTAINSTABLE|CONTINUE|CONVERT|CREATE|CROSS|CURRENT|CURRENT_DATE|CURRENT_TIME|CURRENT_TIMESTAMP|CURRENT_USER|CURSOR|DATA|DATABASE|DATABASES|DATETIME|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DOUBLE PRECISION|DROP|DUMMY|DUMP|DUMPFILE|DUPLICATE KEY|ELSE|ENABLE|ENCLOSED BY|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPE|ESCAPED BY|EXCEPT|EXEC|EXECUTE|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR|FOR EACH ROW|FORCE|FOREIGN|FREETEXT|FREETEXTTABLE|FROM|FULL|FUNCTION|GEOMETRY|GEOMETRYCOLLECTION|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|IDENTITY|IDENTITY_INSERT|IDENTITYCOL|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTO|INVOKER|ISOLATION LEVEL|JOIN|KEY|KEYS|KILL|LANGUAGE SQL|LAST|LEFT|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONGBLOB|LONGTEXT|MATCH|MATCHED|MEDIUMBLOB|MEDIUMINT|MEDIUMTEXT|MERGE|MIDDLEINT|MODIFIES SQL DATA|MODIFY|MULTILINESTRING|MULTIPOINT|MULTIPOLYGON|NATIONAL|NATIONAL CHAR VARYING|NATIONAL CHARACTER|NATIONAL CHARACTER VARYING|NATIONAL VARCHAR|NATURAL|NCHAR|NCHAR VARCHAR|NEXT|NO|NO SQL|NOCHECK|NOCYCLE|NONCLUSTERED|NULLIF|NUMERIC|OF|OFF|OFFSETS|ON|OPEN|OPENDATASOURCE|OPENQUERY|OPENROWSET|OPTIMIZE|OPTION|OPTIONALLY|ORDER|OUT|OUTER|OUTFILE|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREV|PRIMARY|PRINT|PRIVILEGES|PROC|PROCEDURE|PUBLIC|PURGE|QUICK|RAISERROR|READ|READS SQL DATA|READTEXT|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEATABLE|REPLICATION|REQUIRE|RESTORE|RESTRICT|RETURN|RETURNS|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROWCOUNT|ROWGUIDCOL|ROWS?|RTREE|RULE|SAVE|SAVEPOINT|SCHEMA|SELECT|SERIAL|SERIALIZABLE|SESSION|SESSION_USER|SET|SETUSER|SHARE MODE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|START|STARTING BY|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLE|TABLES|TABLESPACE|TEMPORARY|TEMPTABLE|TERMINATED BY|TEXT|TEXTSIZE|THEN|TIMESTAMP|TINYBLOB|TINYINT|TINYTEXT|TO|TOP|TRAN|TRANSACTION|TRANSACTIONS|TRIGGER|TRUNCATE|TSEQUAL|TYPE|TYPES|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNPIVOT|UPDATE|UPDATETEXT|USAGE|USE|USER|USING|VALUE|VALUES|VARBINARY|VARCHAR|VARCHARACTER|VARYING|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH|WITH ROLLUP|WITHIN|WORK|WRITE|WRITETEXT)\b/gi,boolean:/\b(TRUE|FALSE|NULL)\b/gi,number:/\b-?(0x)?\d*\.?[\da-f]+\b/g,operator:/\b(ALL|AND|ANY|BETWEEN|EXISTS|IN|LIKE|NOT|OR|IS|UNIQUE|CHARACTER SET|COLLATE|DIV|OFFSET|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b|[-+]{1}|!|=?&lt;|=?&gt;|={1}|(&amp;){1,2}|\|?\||\?|\*|\//gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[;[\]()`,.]/g};Prism.languages.http={"request-line":{pattern:/^(POST|GET|PUT|DELETE|OPTIONS|PATCH|TRACE|CONNECT)\b\shttps?:\/\/\S+\sHTTP\/[0-9.]+/g,inside:{property:/^\b(POST|GET|PUT|DELETE|OPTIONS|PATCH|TRACE|CONNECT)\b/g,"attr-name":/:\w+/g}},"response-status":{pattern:/^HTTP\/1.[01] [0-9]+.*/g,inside:{property:/[0-9]+[A-Z\s-]+$/g}},keyword:/^[\w-]+:(?=.+)/gm};var httpLanguages={"application/json":Prism.languages.javascript,"application/xml":Prism.languages.markup,"text/xml":Prism.languages.markup,"text/html":Prism.languages.markup};for(var contentType in httpLanguages){if(httpLanguages[contentType]){var options={};options[contentType]={pattern:new RegExp("(content-type:\\s*"+contentType+"[\\w\\W]*?)\\n\\n[\\w\\W]*","gi"),lookbehind:!0,inside:{rest:httpLanguages[contentType]}};Prism.languages.insertBefore("http","keyword",options)}};Prism.languages.ruby=Prism.languages.extend("clike",{comment:/#[^\r\n]*(\r?\n|$)/g,keyword:/\b(alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/g,builtin:/\b(Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|File|Fixnum|Fload|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/,constant:/\b[A-Z][a-zA-Z_0-9]*[?!]?\b/g});Prism.languages.insertBefore("ruby","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0},variable:/[@$&]+\b[a-zA-Z_][a-zA-Z_0-9]*[?!]?\b/g,symbol:/:\b[a-zA-Z_][a-zA-Z_0-9]*[?!]?\b/g});Prism.languages.csharp=Prism.languages.extend("clike",{keyword:/\b(abstract|as|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|virtual|void|volatile|while|add|alias|ascending|async|await|descending|dynamic|from|get|global|group|into|join|let|orderby|partial|remove|select|set|value|var|where|yield)\b/g,string:/@?("|')(\\?.)*?\1/g,preprocessor:/^\s*#.*/gm,number:/\b-?(0x)?\d*\.?\d+\b/g});Prism.highlightAll();module.resolve()});EasySocial.module('privacy',function($){var module=this;EasySocial.require().library('dialog').view('admin/profiles/form.privacy.custom.item').done(function($){EasySocial.Controller('Profiles.Form.Privacy',{defaultOptions:{path:'admin',"{selection}":".privacySelection","{browseButton}":".browseButton","{userDeleteButton}":".userDeleteButton","{customContainer}":".customContainer",view:{customItem:'admin/profiles/form.privacy.custom.item'}}},function(self){return{init:function()
{},"{selection}change":function(el,event){var selected=$(el).val();var eleName=$(el).attr('name');if(selected=='custom')
{self.customContainer().show()}
else{self.customContainer().hide()}},"{userDeleteButton}click":function(el,event){$(el).parents('li').remove()},"{browseButton}click":function(el,event){var eleId=$(el).attr('id');var eleIndex=$(el).data('index');var userlistingpath=$.rootPath+'administrator/index.php?option=com_easysocial&view=users&layout=listing&show=iframe';if(self.options.path=='site')
userlistingpath=$.rootPath+'index.php?option=com_easysocial&view=friends&layout=listing&show=iframe';$.dialog({title:'Browse Users&Groups',content:userlistingpath,body:{css:{width:400,height:300}},buttons:[{name:'Assign',click:function(){var users=$('.foundryDialog').find('iframe').contents().find('input:checked');if(users.length>0)
{for(var i=0;i<users.length;i++)
{var eleName=$(users[i]).attr('name');if(eleName=='toggle')
continue;var userId=$(users[i]).val();var userName=$('.foundryDialog').find('iframe').contents().find('input[name="user_'+userId+'"]').val();var addedUsers=$('ul#privacy_ul'+eleIndex+' input:hidden');var doAdd=!0;if(addedUsers.length>0)
{for(var j=0;j<addedUsers.length;j++)
{if($(addedUsers[j]).val()==userId)
{doAdd=!1;break}}}
if(doAdd)
{html=self.view.customItem({userName:userName,eleName:eleId,userId:userId});$('ul#privacy_ul'+eleIndex).append(html)}}}
$.dialog().close()}},{name:'Close',click:function(){$.dialog().close()}}]})}}});module.resolve()})});EasySocial.module('sharing',function($){var module=this;EasySocial.require().library('textboxlist').done(function(){EasySocial.Controller('Sharing',{defaultOptions:{'{vendors}':'[data-sharing-vendor]','{emailForm}':'[data-sharing-email]'}},function(self){return{init:function(){self.initLinks();self.initEmail()},initLinks:function(){$.each(self.vendors(),function(i,vendor){vendor=$(vendor);if(!vendor.data('loaded')){var link=vendor.attr('href');vendor.data('href',link);vendor.attr('href','javascript:void(0);');vendor.attr('loaded',!0)}})},initEmail:function(){$.each(self.emailForm(),function(i,form){form=$(form);if(!form.data('loaded')){self.addPlugin('email');form.attr('loaded',!0)}})},'{vendors}click':function(el,ev){var optionString=el.data('options')||'';window.open(el.data('href'),'',optionString)}}});$.template('sharing/recipientContent','[%=title%]<input type="hidden" name="items" value="[%=title%]"/>');EasySocial.Controller('Sharing.Email',{defaultOptions:{token:'','{container}':'[data-sharing-email]','{frames}':'[data-sharing-email-frame]','{recipients}':'[data-sharing-email-recipients]','{input}':'[data-sharing-email-input]','{content}':'[data-sharing-email-content]','{send}':'[data-sharing-email-send]','{frames}':'[data-sharing-email-frame]','{frameForm}':'[data-sharing-email-form]','{frameSending}':'[data-sharing-email-sending]','{frameDone}':'[data-sharing-email-done]','{frameFail}':'[data-sharing-email-fail]','{failMsg}':'[data-sharing-email-fail-msg]'}},function(self){return{init:function(){self.options.token=self.container().data('token');var test=self.recipients().textboxlist({component:'es',view:{itemContent:'sharing/recipientContent'}});self.originalPosition=self.container().css('position')},getRecipients:function(){var items=self.recipients().controller('textboxlist').getAddedItems();var recipients=[];$.each(items,function(i,item){recipients.push(item.title)});var input=self.input().val();if(recipients.length<1&&!$.isEmpty(input)){recipients.push(input)}
return recipients},getContent:function(){return self.content().val()},'{send}click':function(el,ev){if(el.enabled()){el.disabled(!0);self.frames().hide();self.frameSending().show();var token=self.options.token,recipients=self.getRecipients(),content=self.getContent();self.submitForm(token,recipients,content).done(function(){self.frames().hide();self.frameDone().show();setTimeout(function(){self.recipients().controller('textboxlist').clearItems();self.content().val('');self.frameDone().hide();self.frameForm().show()},1000)}).fail(function(msg){self.frames().hide();self.frameFail().show();self.frameForm().show();if(msg!==undefined){self.failMsg().html(msg)}}).always(function(){el.enabled(!0)})}},'{input}keypress':function(el,ev){if(ev.which===44){self.recipients().controller('textboxlist').addItem(el.val());el.val('');return!1}},submitForm:function(token,recipients,content){return EasySocial.ajax('site/controllers/sharing/send',{token:token,recipients:recipients,content:content})}}});module.resolve()})});EasySocial.module('site/activities/activities',function($){var module=this;EasySocial.require().script('site/activities/sidebar','site/activities/sidebar.item').view('site/loading/small').done(function($){EasySocial.Controller('Activities',{defaultOptions:{items:null,"{container}":"[data-activities]","{contentTitle}":"[data-activities-content-title]","{content}":"[data-activities-content]","{sidebar}":"[data-activities-sidebar]","{sidebarItem}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.sidebar().implement(EasySocial.Controller.Activities.Sidebar,{"{parent}":self});self.sidebarItem().implement(EasySocial.Controller.Activities.Sidebar.Item,{"{parent}":self})},updatingContents:function()
{self.content().html(self.view.loadingContent())},updateContent:function(content,title)
{self.content().html(content);self.contentTitle().html(title)}}});module.resolve()})});EasySocial.module('site/activities/sidebar',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Activities.Sidebar',{defaultOptions:{"{menuItem}":"[data-sidebar-menu]"}},function(self){return{init:function()
{},"{menuItem}click":function(el,event)
{self.menuItem().removeClass('active');$(el).addClass('active')}}});module.resolve()})});EasySocial.module('site/activities/sidebar.item',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Activities.Sidebar.Item',{defaultOptions:{}},function(self){return{init:function()
{},"{self}click":function(el,event)
{var type=self.element.data('type'),url=self.element.data('url'),title=self.element.data('title'),desc=self.element.data('description');History.pushState({state:1},title,url);self.parent.updatingContents();EasySocial.ajax('site/controllers/activities/getActivities',{"type":type}).done(function(html)
{self.parent.updateContent(html,title)}).fail(function(message){console.log(message)});self.parent.updateContent()}}});module.resolve()})});EasySocial.module('site/activities/apps',function($){var module=this;EasySocial.require().view('site/loading/small').language('COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY','COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY').done(function($){EasySocial.Controller('Activities.Apps.List',{defaultOptions:{"{item}":"[data-hidden-app-item]","{actorItem}":"[data-hidden-actor-item]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Activities.Apps.Item);self.actorItem().implement(EasySocial.Controller.Activities.Actors.Item)}}});EasySocial.Controller('Activities.Actors.Item',{defaultOptions:{id:"",actor:"","{unhideLink}":"[data-hidden-actor-unhide]","{content}":"[data-hidden-actor-content]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.options.id=self.element.data('id');self.options.actor=self.element.data('actor')},"{unhideLink}click":function(){EasySocial.ajax('site/controllers/activities/unhideactor',{"actor":self.options.actor,"id":self.options.id}).done(function()
{self.content().html($.language('COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY'))}).fail(function(message){console.log(message)})}}});EasySocial.Controller('Activities.Apps.Item',{defaultOptions:{id:"",context:"","{unhideLink}":"[data-hidden-app-unhide]","{content}":"[data-hidden-app-content]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.options.id=self.element.data('id');self.options.context=self.element.data('context')},"{unhideLink}click":function(){EasySocial.ajax('site/controllers/activities/unhideapp',{"context":self.options.context,"id":self.options.id}).done(function()
{self.content().html($.language('COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY'))}).fail(function(message){console.log(message)})}}});module.resolve()})});EasySocial.module('site/activities/item',function($){var module=this;EasySocial.require().script().done(function($){EasySocial.Controller('Activities.Item',{defaultOptions:{"{toggle}":"[data-activity-toggle]","{deleteBtn}":"[data-activity-delete]"}},function(self){return{init:function()
{},"{toggle}click":function(el,event)
{EasySocial.ajax('site/controllers/activities/toggle',{"id":self.element.data('id'),"curState":self.element.data('current-state')}).done(function(lbl,isHidden)
{$(el).text(lbl);self.element.data('current-state',isHidden);if(isHidden)
{self.element.children("div.es-stream").addClass('isHidden')}
else{self.element.children("div.es-stream").removeClass('isHidden')}}).fail(function(message){console.log(message)})},"{deleteBtn}click":function()
{var uid=self.element.data('id');EasySocial.dialog({content:EasySocial.ajax('site/views/activities/confirmDelete'),bindings:{"{deleteButton}click":function()
{EasySocial.ajax('site/controllers/activities/delete',{"id":uid,}).done(function(html)
{self.element.fadeOut();EasySocial.dialog().close()})}}})}}});module.resolve()})});EasySocial.module('site/activities/list',function($){var module=this;EasySocial.require().view('site/loading/small','site/activities/loadbutton').language('COM_EASYSOCIAL_ACTIVITY_LOG_LOAD_PREVIOUS_STREAM_ITEMS').script('site/activities/item').done(function($){EasySocial.Controller('Activities.List',{defaultOptions:{"{item}":"[data-activity-item]","{pagination}":"[data-activity-pagination]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/activities/loadbutton"}}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Activities.Item);self.on("scroll.activities",window,$._.debounce(function(){if(self.loading)return;if(self.pagination().visible()){self.loadMore()}},250))},"{pagination}click":function(){self.loadMore()},loadMore:function(){var type=$("[data-sidebar-menu].active").data('type');var startlimit=self.pagination().data('startlimit');if(startlimit=='')
{return}
self.loading=!0;self.pagination().html(self.view.loadingContent({content:""}));EasySocial.ajax('site/controllers/activities/getActivities',{"limitstart":startlimit,"loadmore":'1',"type":type}).done(function(contents,startlimit){self.pagination().data('startlimit',startlimit);self.pagination().before(contents);self.item().implement(EasySocial.Controller.Activities.Item);if(startlimit==""){self.pagination().html('')}else{self.pagination().html(self.view.loadmoreContent())}}).fail(function(messageObj){return messageObj}).always(function(){self.loading=!1})}}});module.resolve()})});EasySocial.module('site/albums/all',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Albums.All.Browser',{defaultOptions:{"{sort}":"[data-albums-sort]","{contents}":"[data-albums-content]"}},function(self)
{return{init:function()
{},setActiveSort:function(el)
{self.sort().removeClass('active');$(el).addClass('active')},"{sort}click":function(el,event)
{event.preventDefault();self.setActiveSort(el);$(el).route();self.contents().addClass('is-loading');self.contents().html('&nbsp;');EasySocial.ajax('site/controllers/albums/getAlbums').done(function(contents)
{self.contents().html(contents)})}}});module.resolve()})});EasySocial.module('site/apps/apps',function($){var module=this;EasySocial.require().library('history').view('site/loading/small').done(function($){EasySocial.Controller('Apps',{defaultOptions:{requireTerms:!0,"{content}":"[data-apps-listing]","{sort}":"[data-apps-sort]","{filter}":"[data-apps-filter]","{filterLink}":"[data-apps-filter-link]","{item}":"[data-apps-item]","{sorting}":"[data-apps-sorting]","{title}":"[data-page-apps-title]",view:{loading:'site/loading/small'}}},function(self)
{return{init:function()
{self.initAppItem()},initAppItem:function()
{self.item().implement(EasySocial.Controller.Apps.Item,{requireTerms:self.options.requireTerms})},"{filterLink}click":function(el,event)
{event.preventDefault()},"{filter}click":function(el,event)
{self.sort().removeClass('active');self.filter().removeClass('active');el.addClass('active');el.find('a').route();var filter=el.data('apps-filter-type');var group=el.data('apps-filter-group');var title=el.find('a').attr('title');self.title().html(title);self.options.filter=filter;if(filter=='mine'){self.sorting().hide()}else{self.sorting().show()}
EasySocial.ajax('site/controllers/apps/getApps',{"filter":filter,"group":group},{beforeSend:function(){self.sort('.alphabetical').addClass('active');self.content().html(self.view.loading())}}).done(function(output){self.content().toggleClass("is-empty",$(output).hasClass("empty"));self.content().html(output);self.initAppItem()})},"{sort}click":function(el,event)
{var type=el.data('apps-sort-type'),url=el.data('apps-sort-url'),group=el.data('apps-sort-group');History.pushState({state:1},'',url);self.sort().removeClass('active');el.addClass('active');EasySocial.ajax('site/controllers/apps/getApps',{"sort":type,"filter":self.options.filter,"group":group},{beforeSend:function()
{self.content().html(self.view.loading())}}).done(function(output)
{self.content().html(output);self.initAppItem()})}}});EasySocial.Controller('Apps.Item',{defaultOptions:{id:null,requireTerms:!0,"{install}":"[data-apps-item-install]","{installed}":"[data-apps-item-installed]","{settings}":"[data-apps-item-settings]",view:{installAppForm:"site/apps/dialog.install",uninstallAppForm:"site/apps/dialog.uninstall"}}},function(self){return{init:function(){if(self.element.data('id')){self.options.id=self.element.data('id')}},"{install}click":function(el)
{EasySocial.dialog({content:EasySocial.ajax('site/views/apps/getTnc'),bindings:{'{cancelButton}click':function(){EasySocial.dialog().close()},'{installButton}click':function(el)
{var agreed=!self.options.requireTerms||this.agreeCheckbox().is(':checked');if(agreed)
{this.termsError().hide();self.installApp()}
else{this.termsError().show()}}}})},installApp:function()
{var installing=EasySocial.ajax('site/controllers/apps/installApp',{id:self.options.id});EasySocial.dialog({content:installing,bindings:{"{closeButton}click":function(){EasySocial.dialog().close()}}});installing.done(function()
{self.install().enabled(!0);self.install().hide();self.installed().show();self.settings().hide()})},"{settings}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax("site/views/apps/settings",{"id":self.options.id}),bindings:{}})},'{installed}click':function(el){if(el.enabled()){el.disabled(!0);EasySocial.dialog({content:EasySocial.ajax('site/views/apps/confirmUninstall'),bindings:{'{parent.closeButton}click':function(){self.installed().enabled(!0)},'{cancelButton}click':function(){self.installed().enabled(!0);EasySocial.dialog().close()},'{uninstallButton}click':function()
{self.uninstallApp()}}})}},uninstallApp:function(){var uninstalling=EasySocial.ajax('site/controllers/apps/uninstallApp',{id:self.options.id});EasySocial.dialog({content:uninstalling,bindings:{'{closeButton}click':function()
{EasySocial.dialog().close()}}});uninstalling.done(function()
{self.installed().enabled(!0);self.installed().hide();self.settings().hide();self.install().show()})}}});module.resolve()})});EasySocial.module('site/badges/badge',function($){var module=this;EasySocial.Controller('Badges.Badge',{defaultOptions:{id:0,total:0,'{achieversList}':'[data-badge-achievers-list]','{achiever}':'[data-badge-achievers-achiever]','{loadIndicator}':'[data-badge-achievers-loading]','{loadButton}':'[data-badge-achievers-load]',}},function(self){return{init:function(){self.options.id=self.element.data('id');self.options.total=self.element.data('total-achievers')},'{loadButton}click':function(el){var current=self.achiever().length;if(el.enabled()&&current<self.options.total){el.disabled(!0);el.hide();self.loadIndicator().show();EasySocial.ajax('site/controllers/badges/loadAchievers',{id:self.options.id,start:current}).done(function(html){self.achieversList().append(html);el.enabled(!0);self.loadIndicator().hide();if(self.achiever().length<self.options.total){el.show()}}).fail(function(msg){})}},loadAchievers:function(){}}});module.resolve()});EasySocial.module('site/comments/control',function($){var module=this;EasySocial.Controller('CommentsControl',{defaultOptions:{interval:30}},function(self){return{init:function(){self.startUpdate()},$Blocks:{},startUpdate:function(){self.options.monitoring=!0;self.updateBlocks()},stopUpdate:function(){self.options.monitoring=!1},updateBlocks:function(){(self.updateBlocks=$._.debounce(function(){var data=self.populate();if(!self.options.monitoring)
{return!1}
EasySocial.ajax('site/controllers/comments/getUpdates',{data:data}).done(function(result){$.each(result,function(element,block){$.each(block,function(uid,comments){var comment=self.$Blocks[element][uid];if(comment._destroyed)return;comment.updateComment(comments)})})}).always(function(){self.updateBlocks()})},self.options.interval*1000))()},register:function(instance){var group=instance.options.group,element=instance.options.element,streamid=instance.options.streamid,uid=instance.options.uid,verb=instance.options.verb;if(streamid==''){streamid='0'}
var key=element+'.'+group+'.'+verb;if(self.$Blocks[key]===undefined){self.$Blocks[key]={}}
var blockkey=streamid+'.'+uid;self.$Blocks[key][blockkey]=instance;instance.trigger('commentBlockRegistered')},populate:function(){var data={};$.each(self.$Blocks,function(key,block){data[key]={};$.each(block,function(blockkey,comments){data[key][blockkey]=comments._export()})});return data}}});EasySocial.ready(function(){EasySocial.Comments=$('body').addController('EasySocial.Controller.CommentsControl');module.resolve()})});EasySocial.module('site/comments/frame',function($){var module=this;EasySocial.require().library('mentions').script('site/comments/item').view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language('COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL','COM_EASYSOCIAL_COMMENTS_STATUS_SAVING','COM_EASYSOCIAL_COMMENTS_STATUS_SAVED').done(function(){EasySocial.Controller('Comments',{defaultOptions:{'group':'user','element':'stream','verb':'null','uid':0,'enterkey':'submit','url':'','streamid':'','{actionContent}':'[data-action-contents-comments]','{actionLink}':'[data-stream-action-comments]','{stat}':'[data-comments-stat]','{load}':'[data-comments-load]','{list}':'[data-comments-list]','{item}':'[data-comments-item]','{form}':'[data-comments-form]'}},function(self){return{init:function(){self.options.uid=self.element.data('uid')||self.options.uid;self.options.element=self.element.data('element')||self.options.element;self.options.group=self.element.data('group')||self.options.group;self.options.verb=self.element.data('verb')||self.options.verb;self.options.url=self.element.data('url')||self.options.url;self.options.streamid=self.element.data('streamid')||self.options.streamid;self.$Stat=self.addPlugin('stat');self.$Load=self.addPlugin('load');self.$List=self.addPlugin('list');self.$Form=self.addPlugin('form');EasySocial.require().script('site/comments/control').done(function(){EasySocial.Comments.register(self)});self.trigger('commentInit',[self])},$Comments:{},registerComment:function(instance){var id=instance.options.id;self.$Comments[id]=instance},'{actionLink}click':function(){self.actionContent().toggle()},_export:function(){var data={total:self.$Stat.total(),count:self.$Stat.count(),ids:$._.keys(self.$Comments)};return data},updateComment:function(comments){var newComments=[];$.each(comments['ids'],function(commentid,state){if(state!==!0){if(state===!1){self.trigger('commentDeleted',[commentid])}else{var appended=!1;$.each(self.$Comments,function(id,comment){if(id>commentid){self.$List.addToList(state,id,!1);appended=!0;return!1}});if(!appended){self.$List.addToList(state,'append',!1)}
newComments.push(state)}}});self.$Stat.total(comments['total']);self.trigger('oldCommentsLoaded',[newComments])},'{self}show':function(){self.element.show();self.$Form.input().focus()}}});EasySocial.Controller('Comments.List',{defaultOptions:{'{list}':'[data-comments-list]','{item}':'[data-comments-item]'}},function(self){return{init:function(){self.initItemController(self.item(),!1)},initItemController:function(item,isNew){item.addController('EasySocial.Controller.Comments.Item',{controller:{parent:self.parent},isNew:isNew});return item},'{parent}newCommentSaved':function(el,event,comment){self.addToList(comment)},addToList:function(comment,type,isNew){type=type===undefined?'append':type;isNew=isNew===undefined?!0:isNew;comment=$(comment);self.initItemController(comment,isNew);if(type=='append'||type=='prepend'){var filter=type=='append'?':last':':first',action=type=='append'?'after':'before';if(self.item().length===0){self.list().html(comment)}else{self.item(filter)[action](comment)}}else{var item=self.parent.$Comments[type];if(item!==undefined){item.element.before(comment)}}
self.parent.actionContent().show()},'{parent}commentDeleted':function(el,event,id){if(self.parent.$Comments[id]!==undefined){self.parent.$Comments[id].element.remove();delete self.parent.$Comments[id]}}}});EasySocial.Controller('Comments.Stat',{defaultOptions:{'{stats}':'[data-comments-stats]',count:0,total:0,limit:10}},function(self){return{init:function(){self.options.count=self.element.data('count');self.options.total=self.element.data('total')},total:function(count){if(count!==undefined){self.options.total=parseInt(count);self.stats().text($.language('COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL',self.count(),self.total()))}
return self.options.total},count:function(count){if(count!==undefined){self.options.count=parseInt(count);self.stats().text($.language('COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL',self.count(),self.total()))}
return self.options.count},getNextCycle:function(){var start=Math.max(self.total()-self.count()-self.options.limit,0);var limit=self.total()-self.count()-start;return{start:start,limit:limit}},'{parent}oldCommentsLoaded':function(el,event,comments){var count=comments.length;self.count(self.count()+count)},'{parent}newCommentSaved':function(){self.total(self.total()+1);self.count(self.count()+1)},'{parent}commentDeleted':function(){self.total(self.total()-1);self.count(self.count()-1)}}});EasySocial.Controller('Comments.Load',{defaultOptions:{'{load}':'[data-comments-load]','{loadMore}':'[data-comments-load-loadMore]'}},function(self){return{init:function(){},'{loadMore}click':function(el,event){if(el.enabled()){el.disabled(!0);var cycle=self.parent.$Stat.getNextCycle();if(cycle.limit==0){return!1}
self.loadComments(cycle.start,cycle.limit).done(function(comments){var reversedComments=comments.slice().reverse();$.each(reversedComments,function(index,comment){self.parent.$List.addToList(comment,'prepend',!1)});self.parent.trigger('oldCommentsLoaded',[comments]);el.enabled(!0);cycle.start==0&&self.load().hide()}).fail(function(msg){self.parent.trigger('oldCommentsLoadError',[msg])})}},loadComments:function(start,limit){limit=limit||10;return EasySocial.ajax('site/controllers/comments/load',{uid:self.parent.options.uid,element:self.parent.options.element,group:self.parent.options.group,verb:self.parent.options.verb,start:start,length:limit})}}});EasySocial.Controller('Comments.Form',{defaultOptions:{'{editorHeader}':'[data-comment-form-header]','{editorArea}':'[data-comment-form-editor-area]','{input}':'[data-comments-form-input]','{submit}':'[data-comments-form-submit]','{status}':'[data-comments-form-status]',view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(self){return{init:function()
{self.setMentionsLayout()},'{input}keypress':function(el,event)
{if(event.keyCode==13){if(self.parent.options.enterkey==='submit'&&!(event.shiftKey||event.altKey||event.ctrlKey||event.metaKey)){self.submitComment()}
if(self.parent.options.enterkey==='newline'&&(event.shiftKey||event.altKey||event.ctrlKey||event.metaKey)){self.submitComment()}}},'{submit}click':function(el,event)
{if(el.enabled()){self.submitComment()}},setMentionsLayout:function()
{var loader=$.Deferred();var editor=self.editorArea(),mentions=editor.controller("mentions");if(mentions){mentions.cloneLayout();return}
var header=self.editorHeader();editor.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:$.View("easysocial/site/friends/suggest.hint.search"),emptyHint:$.View("easysocial/site/friends/suggest.hint.empty"),data:function(keyword)
{var task=$.Deferred();EasySocial.ajax("site/controllers/friends/suggest",{search:keyword}).done(function(items)
{if(!$.isArray(items))task.reject();var items=$.map(items,function(item)
{item.title=item.screenName;item.type="user";item.menuHtml=self.view.suggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task},use:function(item){return item.type+":"+item.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:$.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:$.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/hashtags/suggest",{search:keyword}).done(function(items){if(!$.isArray(items)){task.reject()}
var items=$.map(items,function(item){item.title="#"+item.title;item.type="hashtag";item.menuHtml=self.view.tagSuggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:'left top',at:'left bottom',of:header,collision:'none'},size:{width:function()
{return header.width()}}}}})},submitComment:function()
{var comment=self.input().val();if($.trim(comment)=='')
{return!1}
self.parent.trigger('newCommentSaving');self.save().done(function(comment){self.parent.trigger('newCommentSaved',[comment]);self.submit().enabled(!0);var editor=self.editorArea(),mentions=editor.controller("mentions");mentions&&mentions.reset();if(self.parent.options.streamid!='')
{self.updateStreamExcludeIds(self.parent.options.streamid)}}).fail(function(msg){self.parent.trigger('newCommentSaveError',[msg.message])})},save:function()
{var mentions=self.editorArea().controller("mentions");var data={url:self.parent.options.url,mentions:mentions?mentions.toArray():[]};data.mentions=$.map(data.mentions,function(mention){if(mention.type==="hashtag"&&$.isPlainObject(mention.value)){mention.value=mention.value.title.slice(1)}
return JSON.stringify(mention)});return EasySocial.ajax('site/controllers/comments/save',{uid:self.parent.options.uid,element:self.parent.options.element,group:self.parent.options.group,verb:self.parent.options.verb,streamid:self.parent.options.streamid,input:self.input().val(),data:data})},updateStreamExcludeIds:function(id)
{ids=$('[data-streams-wrapper]').data('excludeids');newIds='';if(ids!=''&&ids!=undefined)
{newIds=ids+','+id}
else{newIds=id}
$('[data-streams-wrapper]').data('excludeids',newIds)},disableForm:function(){self.input().attr('disabled',!0);self.submit().disabled(!0)},enableForm:function()
{self.input().removeAttr('disabled');self.submit().enabled(!0)},'{parent}newCommentSaving':function()
{self.status().show();self.status().removeClass('label-important label-success label-info');self.status().addClass('label-info');self.status().text($.language('COM_EASYSOCIAL_COMMENTS_STATUS_SAVING'));self.disableForm()},'{parent}newCommentSaved':function(){self.status().show();self.status().text($.language('COM_EASYSOCIAL_COMMENTS_STATUS_SAVED'));self.status().removeClass('label-important label-success label-info');self.status().addClass('label-success');setTimeout(function(){self.status().fadeOut('fast')},2000);self.enableForm();self.input().val('')},'{parent}newCommentSaveError':function(el,event,msg){self.status().show();self.status().removeClass('label-important label-success label-info');self.status().addClass('label-important');self.status().text(msg);self.enableForm()}}});module.resolve()})})
EasySocial.module('site/comments/item',function($){var module=this;EasySocial.require().library('mentions').view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language('COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR','COM_EASYSOCIAL_COMMENTS_STATUS_LOADING','COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR','COM_EASYSOCIAL_COMMENTS_STATUS_DELETING','COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR','COM_EASYSOCIAL_LIKES_LIKE','COM_EASYSOCIAL_LIKES_UNLIKE').done(function(){EasySocial.Controller('Comments.Item',{defaultOptions:{'id':0,'child':0,'loadedChild':0,'limit':10,'isNew':!1,'{frame}':'[data-comments-item-frame]','{avatar}':'[data-comments-item-avatar]','{commentFrame}':'[data-comments-item-commentFrame]','{author}':'[data-comments-item-author]','{action}':'[data-comments-item-actions]','{edit}':'[data-comments-item-actions-edit]','{delete}':'[data-comments-item-actions-delete]','{spam}':'[data-comments-item-actions-spam]','{comment}':'[data-comments-item-comment]','{meta}':'[data-comments-item-meta]','{date}':'[data-comments-item-date]a','{like}':'[data-comments-item-like]','{likeCount}':'[data-comments-item-likeCount]','{editFrame}':'[data-comments-item-editFrame]','{editInput}':'[data-comments-item-edit-input]','{editCancel}':'[data-comments-item-edit-cancel]','{editSubmit}':'[data-comments-item-edit-submit]','{editStatus}':'[data-comments-item-edit-status]','{statusFrame}':'[data-comments-item-statusFrame]','{loadReplies}':'[data-comments-item-loadReplies]','{readMore}':'[data-es-comment-readmore]','{fullContent}':'[data-es-comment-full]',view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(self){return{init:function(){self.options.id=self.element.data('id');self.options.child=self.element.data('child');self.parent.registerComment(self);self.status=self.element.addController('EasySocial.Controller.Comments.Item.Status',{controller:{parent:self.parent,item:self}})},'{like}click':function(el){if(el.enabled()){el.disabled(!0);self.likeComment().done(function(liked,count,string){el.enabled(!0);self.likeCount().text(count);string=$('<div></div>').html(string).text();self.likeCount().attr('data-original-title',string);self.like().find('a').text($.language(liked?'COM_EASYSOCIAL_LIKES_UNLIKE':'COM_EASYSOCIAL_LIKES_LIKE'))}).fail(function(){})}},likeComment:function(){return EasySocial.ajax('site/controllers/comments/like',{id:self.options.id})},'{likeCount}click':function(){EasySocial.dialog({content:self.getLikedUsers()})},getLikedUsers:function(){return EasySocial.ajax('site/controllers/comments/likedUsers',{id:self.options.id})},'{edit}click':function(el){if(el.enabled()){var editor=self.editFrame(),mentions=editor.controller("mentions");editor.html('');if(mentions){mentions.destroy()}
el.disabled(!0);self.trigger('commentEditLoading',[self.options.id]);self.getEditComment().done(function(html){self.trigger('commentEditLoaded',[self.options.id,html]);self.editFrame().html(html).show();self.setMentionsLayout()}).fail(function(msg){self.trigger('commentEditLoadError',[self.options.id,msg])})}},setMentionsLayout:function()
{var editor=self.editFrame(),mentions=editor.controller("mentions");if(mentions)
{mentions.cloneLayout();return}
var header=self.editFrame();editor.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:$.View("easysocial/site/friends/suggest.hint.search"),emptyHint:$.View("easysocial/site/friends/suggest.hint.empty"),data:function(keyword)
{var task=$.Deferred();EasySocial.ajax("site/controllers/friends/suggest",{search:keyword}).done(function(items)
{if(!$.isArray(items))task.reject();var items=$.map(items,function(item)
{item.title=item.screenName;item.type="user";item.menuHtml=self.view.suggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task},use:function(item){return item.type+":"+item.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!1,searchHint:$.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:$.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(keyword)
{var task=$.Deferred();EasySocial.ajax("site/controllers/hashtags/suggest",{search:keyword}).done(function(items)
{if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title="#"+item.title;item.type="hashtag";item.menuHtml=self.view.tagSuggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:'left top',at:'left bottom',of:header,collision:'none'},size:{width:function()
{return header.width()}}}}})},getRawComment:function(){return EasySocial.ajax('site/controllers/comments/getRawComment',{id:self.options.id})},getEditComment:function(){return EasySocial.ajax('site/controllers/comments/getEditComment',{id:self.options.id})},'{editCancel}click':function(){self.trigger('commentEditCancel',[self.options.id]);self.edit().enabled(!0)},'{editSubmit}click':function(){self.submitEdit()},submitEdit:function(){var input=self.editInput().val();if(input==''){return!1}
self.trigger('commentEditSaving',[self.options.id,input]);self.saveEdit().done(function(comment){self.trigger('commentEditSaved',[self.options.id,comment]);self.comment().html(comment);self.edit().enabled(!0)}).fail(function(msg){self.trigger('commentEditSaveError',[self.options.id,msg])})},saveEdit:function(){var mentions=self.editFrame().mentions("controller");return EasySocial.ajax('site/controllers/comments/update',{id:self.options.id,input:self.editInput().val(),mentions:mentions?mentions.toArray():[]})},'{delete}click':function(el){self.frame().hide();self.commentFrame().show();EasySocial.dialog({content:EasySocial.ajax('site/views/comments/confirmDelete',{id:self.options.id}),selectors:{"{deleteButton}":"[data-delete-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{deleteButton}click":function(){EasySocial.dialog().close();self.parent.trigger('commentDeleting',[self.options.id]);self.trigger('commentDeleting');self.deleteComment().done(function(){self.parent.trigger('commentDeleted',[self.options.id])}).fail(function(msg){self.parent.trigger('commentDeleteError',[self.options.id,msg]);self.trigger('commentDeleteError',[self.options.id,msg])})},"{cancelButton}click":function(){EasySocial.dialog().close()}}})},deleteComment:function(){return EasySocial.ajax('site/controllers/comments/delete',{id:self.options.id})},'{loadReplies}click':function(el){el.hide();var start=Math.max(self.options.child-self.options.loadedChild-self.options.limit,0);EasySocial.ajax().done(function(comments){$.each(comments,function(index,comment){self.parent.$List.addToList(comment,'child',!1)});self.parent.trigger('oldCommentsLoaded',[comments]);start>0&&self.loadMoreReplies().show()})},'{readMore}click':function(el,ev){self.comment().html(self.fullContent().html())}}});EasySocial.Controller('Comments.Item.Status',{defaultOptions:{'{frame}':'[data-comments-item-frame]','{statusFrame}':'[data-comments-item-statusFrame]','{statusContent}':'[data-comments-item-statusFrame]div','{commentFrame}':'[data-comments-item-commentFrame]','{editFrame}':'[data-comments-item-editFrame]'}},function(self){return{init:function(){},setStatus:function(html){self.frame().hide();if($.isPlainObject(html)&&html.message!==undefined){html=html.message}
self.statusContent().html(html);self.statusFrame().show()},'{self}commentEditLoading':function(){self.setStatus($.language('COM_EASYSOCIAL_COMMENTS_STATUS_LOADING'))},'{self}commentEditLoaded':function(){self.frame().hide();self.editFrame().show()},'{self}commentEditLoadError':function(){self.setStatus($.language('COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR'))},'{self}commentEditCancel':function(){self.frame().hide();self.commentFrame().show()},'{self}commentEditSaving':function(){self.setStatus($.language('COM_EASYSOCIAL_COMMENTS_STATUS_SAVING'))},'{self}commentEditSaved':function(){self.frame().hide();self.commentFrame().show()},'{self}commentEditSaveError':function(){self.setStatus($.language('COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR'))},'{self}commentDeleting':function(){self.setStatus($.language('COM_EASYSOCIAL_COMMENTS_STATUS_DELETING'))},'{self}commentDeleteError':function(el,event,id,msg){msg=msg||$.language('COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR');self.setStatus(msg)}}});module.resolve()})});EasySocial.module('site/conversations/conversations',function($){var module=this;EasySocial.require().script('site/conversations/mailbox','site/conversations/item','site/conversations/filter').language('COM_EASYSOCIAL_NO_BUTTON').done(function($){EasySocial.Controller('Conversations',{defaultOptions:{"{mailbox}":"[data-conversations-mailbox]","{list}":"[data-conversations-list]","{content}":"[data-conversations-content]","{item}":"[data-conversations-item]","{actions}":"[data-conversations-actions]","{filterItem}":"[data-conversations-filter]","{checkAll}":"[data-conversations-checkAll]","{checkbox}":"[data-conversationItem-checkbox]","{delete}":"[data-conversations-delete]","{archive}":"[data-conversations-archive]","{unarchive}":"[data-conversations-unarchive]","{unread}":"[data-conversations-unread]","{read}":"[data-conversations-read]"}},function(self){return{init:function()
{self.mailbox().implement(EasySocial.Controller.Conversations.Mailbox,{"{parent}":self});self.item().implement(EasySocial.Controller.Conversations.Item,{"{parent}":self});self.filterItem().implement(EasySocial.Controller.Conversations.Filter,{"{parent}":self})},"{filterItem}click":function(el)
{self.filterItem().removeClass('active');$(el).addClass('active')},"{checkbox}change":function(el)
{if(self.checkbox(':checked').length<=0&&!el.is(':checked'))
{return self.actions().removeClass('is-checked')}
self.actions().addClass('is-checked')},"{checkAll}click":function(el)
{if(self.checkbox().length<=0)
{$(el).prop('checked',!1);return!1}
if(el.is(':checked'))
{self.checkbox(':not(:checked)').click()}
else{self.checkbox(':checked').click()}},showEmpty:function()
{self.content().addClass('is-empty')},hideEmpty:function()
{self.content().removeClass('is-empty')},toggleLoading:function()
{self.content().removeClass('is-empty').toggleClass('is-loading')},updateContent:function(content,mailbox)
{if(mailbox!=undefined)
{self.content().addClass('layout-'+mailbox)}
else{self.content().removeClass('layout-archives')}
self.actions().removeClass('is-checked');self.checkAll().removeAttr('checked');self.list().html(content)},getSelectedConversations:function()
{if(self.checkbox(':checked').length<=0)
{return!1}
var selected=new Array;self.checkbox(':checked').each(function(i,checkedItem){selected.push($(checkedItem).val())});return selected},"{archive}click":function()
{var selected=self.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/confirmArchive',{"ids":selected}),bindings:{"{confirmButton}click":function()
{$('[data-conversation-archive-form]').submit()}}})},"{unarchive}click":function()
{var selected=self.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/confirmUnarchive',{"ids":selected}),bindings:{"{confirmButton}click":function()
{$('[data-conversation-archive-form]').submit()}}})},"{delete}click":function()
{var selected=self.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/confirmDelete',{"ids":selected}),bindings:{"{deleteButton}click":function()
{$('[data-conversation-delete-form]').submit()}}})},"{read}click":function()
{if(self.checkbox(':checked').length<=0)
{return!1}
var ids=new Array();self.checkbox(':checked').each(function(i,checkedItem){ids.push($(checkedItem).val())});EasySocial.ajax('site/controllers/conversations/markRead',{"ids":ids}).done(function(){self.checkbox().parents('[data-conversations-item]').removeClass('unread').addClass('read');self.mailbox().controller().updateCounters()}).fail(function(message)
{self.setMessage(message)})},"{unread}click":function()
{if(self.checkbox(':checked').length<=0)
{return!1}
var ids=new Array();self.checkbox(':checked').each(function(i,checkedItem){ids.push($(checkedItem).val())});EasySocial.ajax('site/controllers/conversations/markUnread',{"ids":ids}).done(function(){self.checkbox().parents('[data-conversations-item]').removeClass('read').addClass('unread');self.mailbox().controller().updateCounters()}).fail(function(message){console.log(message)})}}});module.resolve()})});EasySocial.module('site/conversations/mailbox',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Conversations.Mailbox',{defaultOptions:{"{item}":"[data-mailboxItem]"}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Conversations.Mailbox.Item,{"{parent}":self})},updateCounters:function()
{self.item('.active').controller().updateCounter()},updateContent:function(items,mailbox)
{self.parent.updateContent(items,mailbox)},showEmpty:function()
{self.parent.showEmpty()},hideEmpty:function()
{self.parent.hideEmpty()},toggleLoading:function()
{self.parent.toggleLoading()}}});EasySocial.Controller('Conversations.Mailbox.Item',{defaultOptions:{"{counter}":"[data-mailboxItem-counter]",view:{emptyTemplate:"site/conversations/default.item.empty"}}},function(self){return{init:function()
{},updateCounter:function()
{EasySocial.ajax('site/controllers/conversations/getCount',{"mailbox":self.element.data('mailbox')}).done(function(total){if(total<=0)
{self.counter().html('');return}
self.counter().html('('+total+')')})},toggleLoading:function()
{self.element.toggleClass('loading')},"{self}click":function()
{var url=self.element.data('url'),title=self.element.data('title'),mailbox=self.element.data('mailbox');self.parent.item().removeClass('active');self.element.addClass('active');History.pushState({state:1},title,url);EasySocial.ajax('site/views/conversations/getItems',{"mailbox":mailbox,"limitstart":0},{beforeSend:function()
{self.toggleLoading();self.parent.toggleLoading()}}).done(function(content,empty){self.toggleLoading();self.parent.toggleLoading();if(content.length<=0)
{self.parent.updateContent('');return self.parent.showEmpty()}
self.parent.hideEmpty();self.parent.updateContent(content,self.element.data('mailbox'))})}}});module.resolve()})});EasySocial.module('site/conversations/item',function($){var module=this;EasySocial.require().script('site/conversations/mailbox').done(function($){EasySocial.Controller('Conversations.Item',{defaultOptions:{"{checkbox}":"[data-conversationItem-checkbox]"}},function(self){return{init:function()
{},"{checkbox}change":function(el){var checked=$(el).is(':checked');if(checked)
{return self.element.addClass('selected')}
return self.element.removeClass('selected')}}});module.resolve()})});EasySocial.module('site/conversations/filter',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Conversations.Filter',{defaultOptions:{}},function(self){return{init:function()
{},"{self}click":function()
{var type=self.element.data('filter'),selector='.'+type,total=self.parent.item(selector).length;if($("[data-mailboxitem]").filter(".active").length==1)
{var curActiveMenu=$("[data-mailboxitem]").filter(".active");var url=curActiveMenu.data('url'),title=curActiveMenu.data('title'),mailbox=curActiveMenu.data('mailbox');History.pushState({state:1},title,url);EasySocial.ajax('site/views/conversations/getItems',{"mailbox":mailbox,"filter":type,"limitstart":0},{beforeSend:function()
{self.parent.toggleLoading()}}).done(function(content,empty){self.parent.toggleLoading();if(content.length<=0)
{self.parent.updateContent('');return self.parent.showEmpty()}
self.parent.hideEmpty();self.parent.updateContent(content,mailbox)})}}}});module.resolve()})});EasySocial.module('site/conversations/read',function($){var module=this;EasySocial.require().library('dialog').script('site/conversations/composer','site/friends/suggest').language('COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY','COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY').done(function($){EasySocial.Controller('Conversations.Read',{defaultOptions:{id:"",attachments:!0,location:!1,maxSize:"3mb",extensionsAllowed:"",attachmentController:null,composerController:null,"{item}":"[data-readConversation-item]","{items}":"[data-readConversation-items]","{composer}":"[data-readConversation-composer]","{replyButton}":"[data-readConversation-replyButton]","{addParticipant}":"[data-readConversation-addParticipant]","{leaveConversation}":"[data-readConversation-leaveConversation]","{delete}":"[data-readConversation-delete]","{attachments}":"[data-uploaderQueue-id]","{replyNotice}":"[data-readConversation-replyNotice]","{readLoadMore}":"[data-readconversation-load-more]",view:{messageItem:'site/conversations/read.message'}}},function(self){return{init:function()
{self.composer().implement(EasySocial.Controller.Conversations.Composer,{"{uploader}":"[data-readConversation-attachment]","{location}":"[data-readConversation-location]",maxSize:self.options.maxSize,extensionsAllowed:self.options.extensionsAllowed});self.options.composerController=self.composer().controller();if(self.options.attachments)
{self.options.attachmentController=self.options.composerController.uploader().controller()}
if(self.options.location)
{self.options.locationController=self.options.composerController.location().controller()}
self.item().implement(EasySocial.Controller.Conversations.Read.Item);self.options.id=self.element.data('id')},resetForm:function()
{self.options.composerController.resetForm();var mentions=self.composer().controller().editorArea().mentions('controller');mentions.reset();if(self.options.location)
{self.options.locationController.removeLocation()}
if(self.options.attachments)
{self.options.attachmentController.reset()}},"{readLoadMore}click":function(el)
{var id=$(el).data('id'),limitstart=$(el).data('limitstart');self.readLoadMore().hide();$('.loading-indicator').show();var options={"id":id,"limitstart":limitstart};EasySocial.ajax('site/controllers/conversations/loadPrevious',options).done(function(html,nextlimit)
{$.buildHTML(html).prependTo(self.items()).addController("EasySocial.Controller.Conversations.Read.Item");if(nextlimit==0)
{self.readLoadMore().hide()}
else{self.readLoadMore().show();$(el).data('limitstart',nextlimit)}}).always(function()
{$('.loading-indicator').hide()})},"{replyButton}click":function(el,event)
{event.preventDefault();var content=self.options.composerController.editor().val(),files=new Array;if(content.length<=0)
{self.replyNotice().html($.language('COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY')).addClass('alert alert-error').removeClass('alert-success');return!1}
if(self.options.attachments)
{self.attachments().each(function(i,attachment){files.push($(attachment).val())})}
var options={"id":self.options.id,"message":content};if(self.options.attachments)
{options['upload-id']=files}
if(self.options.location)
{options.address=self.options.locationController.locationInput().val();options.latitude=self.options.locationController.locationLatitude().val();options.longitude=self.options.locationController.locationLongitude().val()}
options['tags']=self.composer().controller().editorArea().mentions('controller').toArray();self.replyButton().attr('disabled',!0);EasySocial.ajax('site/controllers/conversations/reply',options).done(function(html)
{self.replyNotice().html($.language('COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY')).addClass('alert alert-success').removeClass('alert-error');var item=$(html);item.implement(EasySocial.Controller.Conversations.Read.Item);self.items().append(item);self.resetForm()}).always(function()
{self.replyButton().attr('disabled',!1)});return!1},"{leaveConversation}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/confirmLeave',{id:self.options.id})})},"{addParticipant}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/addParticipantsForm',{"id":self.options.id})})},"{delete}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/confirmDelete',{"ids":[self.options.id]}),bindings:{"{deleteButton}click":function()
{$('[data-conversation-delete-form]').submit()}}})},addItem:function(obj){self.messageList().append(self.view.messageItem({item:obj}));self.textMessage().val('').focus()}}});EasySocial.Controller('Conversations.Read.Item',{defaultOptions:{id:null,"{attachmentsWrapper}":"[data-conversation-attachment-wrapper]","{attachments}":"[data-conversation-attachment]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.attachments().implement(EasySocial.Controller.Conversations.Read.Item.Attachment,{"{parent}":self})},removeAttachment:function(el,event)
{$(el).remove();if(self.attachments().length==0)
{self.attachmentsWrapper().hide()}}}});EasySocial.Controller('Conversations.Read.Item.Attachment',{defaultOptions:{"{deleteAttachment}":"[data-attachment-delete]"}},function(self)
{return{init:function()
{},"{deleteAttachment}click":function(el,event)
{var attachmentId=$(el).data('id');EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/confirmDeleteAttachment',{"id":attachmentId}),bindings:{"{deleteButton}click":function()
{EasySocial.ajax('site/controllers/conversations/deleteAttachment',{id:attachmentId}).done(function()
{self.parent.removeAttachment(self.element);EasySocial.dialog({content:EasySocial.ajax('site/views/conversations/attachmentDeleted',{})})}).fail(function(message)
{self.setMessage(message)})}}})}}})
module.resolve()})});EasySocial.module('site/dashboard/apps',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Dashboard.Apps',{defaultOptions:{parent:null,pageTitle:null,"{item}":"[data-dashboardApps-item]"}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Dashboard.Apps.Item,{"{parent}":self,"{dashboard}":self.parent,pageTitle:self.options.pageTitle})}}});EasySocial.Controller('Dashboard.Apps.Item',{defaultOptions:{}},function(self){return{init:function()
{},"{self}click":function(el,event)
{event.preventDefault();var layout=self.element.data('layout'),url=self.element.data(layout+'-url'),title=self.element.data('title'),desc=self.element.data('description'),appId=self.element.data('id');if(layout=='canvas')
{window.location=url;return}
title=$._.isEmpty(self.options.pageTitle)?title:self.options.pageTitle;History.pushState({state:1},title,url);self.dashboard.content().html("");self.dashboard.updatingContents();self.element.addClass('loading');EasySocial.ajax('site/controllers/dashboard/getAppContents',{"appId":appId}).done(function(contents)
{self.dashboard.updateHeading(title,desc);self.dashboard.updateContents(contents)}).fail(function(messageObj){return messageObj}).always(function(){self.element.removeClass('loading')})}}});module.resolve()})});EasySocial.module('site/dashboard/dashboard',function($){var module=this;EasySocial.require().script('site/dashboard/apps','site/dashboard/feeds','site/dashboard/sidebar','site/stream/filter','site/dashboard/groups','site/dashboard/events').done(function($){EasySocial.Controller('Dashboard',{defaultOptions:{currentTitle:null,pageTitle:null,"{heading}":"[data-dashboard-heading]","{sidebar}":"[data-dashboard-sidebar]","{content}":"[data-dashboard-real-content]","{feeds}":"[data-dashboard-feeds]","{groups}":"[data-dashboard-groups]","{events}":"[data-dashboard-events]","{groupItems}":"[data-dashboard-group-item]","{eventItems}":"[data-dashboard-event-item]","{showAllFilters}":"[data-app-filters-showall]","{showAllGroups}":"[data-groups-filters-showall]","{showAllEvents}":"[data-events-filters-showall]","{appFilters}":"[data-sidebar-app-filter]","{apps}":"[data-dashboard-apps]","{saveHashTag}":"[data-hashtag-filter-save]"}},function(self){return{init:function()
{self.sidebar().implement(EasySocial.Controller.Dashboard.Sidebar,{"{parent}":self});self.feedsController=self.feeds().addController(EasySocial.Controller.Dashboard.Feeds,{"{parent}":self});self.apps().implement(EasySocial.Controller.Dashboard.Apps,{"{parent}":self,pageTitle:self.options.pageTitle});self.groups().implement(EasySocial.Controller.Dashboard.Groups,{"{parent}":self});self.events().implement(EasySocial.Controller.Dashboard.Events,{"{parent}":self})},"{showAllGroups}click":function(el,event){$(el).hide();self.groupItems().removeClass('hide')},"{showAllEvents}click":function(el,event){$(el).hide();self.eventItems().removeClass('hide')},"{showAllFilters}click":function(el,event)
{$(el).hide();self.appFilters().removeClass('hide')},updateHeading:function(title,description)
{self.heading().find('[data-heading-title]').html(title);self.heading().find('[data-heading-desc]').html(description)},updatingContents:function()
{self.element.addClass("loading")},updateContents:function(contents)
{self.element.removeClass("loading");$.buildHTML(contents).appendTo(self.content())},"{saveHashTag}click":function(el)
{var hashtag=el.data('tag');EasySocial.dialog({content:EasySocial.ajax('site/views/stream/confirmSaveFilter',{"tag":hashtag}),bindings:{"{saveButton}click":function()
{this.inputWarning().hide();filterName=this.inputTitle().val();if(filterName=='')
{this.inputWarning().show();return}
EasySocial.ajax('site/controllers/stream/addFilter',{"title":filterName,"tag":hashtag,}).done(function(html,msg)
{var item=$.buildHTML(html);self.feedsController.addFilterItem(item);EasySocial.dialog(msg);setTimeout(function(){EasySocial.dialog().close()},2000)})}}})}}});module.resolve()})});EasySocial.module('site/dashboard/feeds',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Dashboard.Feeds',{defaultOptions:{"{item}":"[data-dashboardFeeds-item]","{filter}":"[data-dashboardFeeds-Filter-edit]"}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Dashboard.Feeds.Item,{"{parent}":self,"{dashboard}":self.parent})},addFilterItem:function(feed)
{feed.find('[data-dashboardFeeds-item]').implement(EasySocial.Controller.Dashboard.Feeds.Item,{"{parent}":self,"{dashboard}":self.parent});feed.appendTo(self.element)}}});EasySocial.Controller('Dashboard.Feeds.Item',{defaultOptions:{}},function(self){return{clicked:!1,init:function()
{},"{self}click":function()
{$('.es-streams').removeClass('no-stream');var type=self.element.data('type'),id=self.element.data('id'),url=self.element.data('url'),title=self.element.data('title'),desc=self.element.data('description');if(self.clicked){return}
self.clicked=!0;var key='[data-stream-counter-';if(type=='list'){key=key+type+'-'+id}else{key=key+type}
key=key+']';$(key).html('0');self.element.removeClass('has-notice');History.pushState({state:1},title,url);self.dashboard.content().html("");self.dashboard.updatingContents();self.element.addClass('loading');EasySocial.ajax('site/controllers/dashboard/getStream',{"type":type,"id":id,"view":'dashboard',}).done(function(contents,count){self.dashboard.updateHeading(title,desc);if(count==0){$('.es-streams').addClass('no-stream')}
self.trigger('onStreamUpdate',[type]);window.streamFilter=type;self.dashboard.updateContents(contents);try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(err){}}).fail(function(messageObj){return messageObj}).always(function(){self.clicked=!1;self.element.removeClass('loading')})}}});module.resolve()})});EasySocial.module('site/dashboard/sidebar',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Dashboard.Sidebar',{defaultOptions:{"{menuItem}":"[data-dashboardSidebar-menu]","{filterBtn}":"[data-stream-filter-button]","{editIcon}":"[data-dashboardFeeds-Filter-edit]"}},function(self){return{init:function()
{},"{menuItem}click":function(el,event)
{self.menuItem().removeClass('active');$(el).addClass('active')},"{editIcon}click":function(el,event)
{event.preventDefault();$(el).route();var id=el.data('id');self.parent.content().html("");self.parent.updatingContents();EasySocial.ajax('site/controllers/stream/getFilter',{"id":id}).done(function(contents){self.parent.updateContents(contents)}).fail(function(messageObj){return messageObj})},"{filterBtn}click":function(el,event)
{event.preventDefault();$(el).route();self.parent.content().html("");self.parent.updatingContents();EasySocial.ajax('site/controllers/stream/getFilter',{"id":0}).done(function(contents)
{self.parent.updateContents(contents)}).fail(function(messageObj){return messageObj}).always(function(){})}}});module.resolve()})});EasySocial.module('site/stream/filter',function($){var module=this;EasySocial.require().script('site/stream/sidebar').language('COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY','COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY').done(function($){EasySocial.Controller('Stream.Filter',{defaultOptions:{"{heading}":"[data-filter-heading]","{sidebar}":"[data-sidebar-item]","{content}":"[data-filter-real-content]"}},function(self){return{init:function()
{self.sidebar().implement(EasySocial.Controller.Stream.Filter.Sidebar,{"{parent}":self})},updateHeading:function(title,description)
{self.heading().find('[data-heading-title]').html(title);self.heading().find('[data-heading-desc]').html(description)},updatingContents:function()
{self.element.addClass("loading")},updateContents:function(contents)
{self.element.removeClass("loading");self.content().html(contents)}}});EasySocial.Controller('Stream.Filter.Item',{defaultOptions:{"{title}":"[data-filter-name]","{hashtag}":"[data-filter-hashtag]","{saveBtn}":"[data-stream-filter-save]","{deleteBtn}":"[data-stream-filter-delete]","{form}":"[data-filter-inputForm]","{notice}":"[filter-form-notice]"}},function(self){return{init:function()
{},"{deleteBtn}click":function(el)
{var fid=el.data('id');var uid=el.data('uid');var utype=el.data('utype');var controllerPath='site/controllers/stream/deleteFilter';if(uid)
{var controllerPath='site/controllers/'+utype+'s/deleteFilter'}
EasySocial.dialog({content:EasySocial.ajax('site/views/stream/confirmFilterDelete'),bindings:{"{deleteButton}click":function()
{EasySocial.ajax(controllerPath,{"id":fid,"uid":uid,"utype":utype}).done(function(html)
{self.element.fadeOut();EasySocial.dialog().close()})}}})},"{saveBtn}click":function()
{$('div.control-group').removeClass('error');self.notice().html();self.notice().hide();if(self.title().val()=='')
{self.title().parents('div.control-group').addClass('error');self.notice().html($.language('COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY'));self.notice().show();return!1}
if(self.hashtag().val()=='')
{self.hashtag().parents('div.control-group').addClass('error');self.notice().html($.language('COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY'));self.notice().show();return!1}
self.form().submit()}}});module.resolve()})});EasySocial.module('site/stream/sidebar',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Stream.Filter.Sidebar',{defaultOptions:{}},function(self){return{init:function()
{},"{self}click":function()
{$('[data-sidebar-item]').removeClass('active loading');self.element.addClass('active');var id=self.element.data('id'),url=self.element.data('url'),title=self.element.data('title');History.pushState({state:1},title,url);self.parent.content().html("");self.parent.updatingContents();self.element.addClass('loading');EasySocial.ajax('site/controllers/stream/getFilter',{"id":id}).done(function(contents){self.parent.updateContents(contents)}).fail(function(messageObj){return messageObj}).always(function(){self.element.removeClass('loading')})}}});module.resolve()})});EasySocial.module('site/dashboard/groups',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Dashboard.Groups',{defaultOptions:{"{item}":"[data-dashboard-group-item]","{itemLink}":"[data-dashboard-group-item]>a"}},function(self)
{return{init:function()
{},"{item}click":function(el,event)
{event.preventDefault();$('.es-streams').removeClass('no-stream');var type=$(el).data('type'),id=$(el).data('id'),desc=$(el).data('description');self.element.removeClass('has-notice');$(el).find('a').route();self.parent.content().html("");self.parent.updatingContents();self.element.addClass('loading');EasySocial.ajax('site/controllers/dashboard/getStream',{"type":type,"id":id,"view":"dashboard"}).done(function(contents)
{self.parent.updateContents(contents)})}}});module.resolve()})});EasySocial.module('site/dashboard/events',function($){var module=this;EasySocial.require().library('history').done(function($){EasySocial.Controller('Dashboard.Events',{defaultOptions:{"{item}":"[data-dashboard-event-item]","{itemLink}":"[data-dashboard-event-item]>a"}},function(self)
{return{init:function()
{},"{item}click":function(el,event)
{event.preventDefault();$('.es-streams').removeClass('no-stream');var type=$(el).data('type'),id=$(el).data('id'),desc=$(el).data('description');self.element.removeClass('has-notice');$(el).find('a').route();self.parent.content().html("");self.parent.updatingContents();self.element.addClass('loading');EasySocial.ajax('site/controllers/dashboard/getStream',{"type":type,"id":id,"view":"dashboard"}).done(function(contents){self.parent.updateContents(contents)})}}});module.resolve()})});EasySocial.module('site/events/browser',function($){var module=this;EasySocial.require().library('popbox').script('site/events/guestState').language('COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION').view('site/loading/small').done(function(){EasySocial.Controller('Events.Browser',{defaultOptions:{'{filters}':'[data-events-filters]>li','{content}':'[data-events-content]','{list}':'[data-events-list]','{items}':'[data-events-item]','{sort}':'[data-events-sorting]a','{calendar}':'[data-events-calendar]','{pastFilter}':'[data-events-past]','{pastLink}':'[data-events-past-link]','{prevDate}':'[data-events-nav-prevdate]','{nextDate}':'[data-events-nav-nextdate]','{radius}':'[data-events-radius]','{nearbyTitle}':'[data-events-nearby-title]',filter:null,categoryid:0,delayed:!1,includePast:!1,ordering:'start',hasLocation:!1,userLatitude:'',userLongitude:'',distance:10,view:{loadingContent:'site/loading/small'}}},function(self){return{init:function(){self.options.filter=self.element.data('filter');self.options.categoryid=self.element.data('categoryid');self.renderCalendar();self.initItems();if(self.options.delayed){self.delayedInit()}},delayedInit:function(){if(self.options.filter==='nearby'){var getEvents=function(){EasySocial.ajax('site/controllers/events/getEvents',{filter:self.options.filter,latitude:self.options.userLatitude,longitude:self.options.userLongitude,distance:self.options.distance,ordering:self.options.ordering,includePast:self.options.includePast}).done(function(contents){self.element.removeClass('loading');self.content().html(contents);self.initItems()})}
if(self.options.hasLocation&&self.options.userLatitude&&self.options.userLongitude){return getEvents()}
EasySocial.require().library('gmaps').done(function(){$.GMaps.geolocate({success:function(position){self.options.userLatitude=position.coords.latitude;self.options.userLongitude=position.coords.longitude;return getEvents()}})})}},renderCalendar:function(){EasySocial.ajax('site/views/events/renderCalendar',{}).done(function(html){self.calendar().html(html).addController('EasySocial.Controller.Events.Browser.Calendar',{'{parent}':self});self.calendar().trigger('calendarLoaded')})},initItems:function(){self.items().addController('EasySocial.Controller.Events.Browser.Item',{'{parent}':self})},'{filters}click':function(el,event){event.preventDefault();self.filters().removeClass('active');el.addClass('active');self.content().html('&nbsp;');el.find('a').route();self.options.filter=el.data('events-filters-type'),self.options.categoryid=el.data('events-filters-categoryid');if(self.options.filter=='nearby'){return self.filterByNearby()}
self.element.addClass('loading');EasySocial.ajax('site/controllers/events/getEvents',{filter:self.options.filter,categoryid:self.options.categoryid}).done(function(contents){self.element.removeClass('loading');self.content().html(contents);self.initItems()})},filterByNearby:function(){var getEvents=function(){EasySocial.ajax('site/controllers/events/getEvents',{filter:self.options.filter,latitude:self.options.userLatitude,longitude:self.options.userLongitude}).done(function(contents){self.element.removeClass('loading');self.content().html(contents);self.initItems()})}
if(self.options.hasLocation&&self.options.userLatitude&&self.options.userLongitude){self.element.addClass('loading');return getEvents()}
self.content().html('<div class="es-detecting-location"><i class="ies-earth es-muted"></i>'+$.language('COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION')+'<i class="icon-loader"></i></div>');EasySocial.require().library('gmaps').done(function(){$.GMaps.geolocate({success:function(position){self.options.userLatitude=position.coords.latitude;self.options.userLongitude=position.coords.longitude;self.options.hasLocation=!0;return getEvents()}})})},'{sort}click':function(el,event){event.preventDefault();self.sort().removeClass('active');el.addClass('active');self.list().html(self.view.loadingContent());var ordering=el.data('ordering'),filter=el.data('filter'),categoryid=el.data('categoryid'),includePast=self.pastFilter().is(':checked')?1:0;self.setPastLink();self.setSortLink();el.route();if(filter==='nearby'){EasySocial.ajax('site/controllers/events/getEvents',{filter:self.options.filter,latitude:self.options.userLatitude,longitude:self.options.userLongitude,distance:self.options.distance,ordering:ordering,sort:1,includePast:includePast}).done(function(contents){self.list().html(contents);self.initItems()});return}
EasySocial.ajax('site/controllers/events/getEvents',{filter:filter,categoryid:categoryid,ordering:ordering,sort:1,includePast:includePast}).done(function(contents){self.list().html(contents);self.initItems()})},'{pastFilter}change':function(el){var activeSort=self.sort('.active'),includePast=el.is(':checked')?1:0,ordering=activeSort.data('ordering'),filter=activeSort.data('filter'),categoryid=activeSort.data('categoryid');self.list().html(self.view.loadingContent());self.pastLink().route();self.setPastLink();self.setSortLink();if(filter==='nearby'){EasySocial.ajax('site/controllers/events/getEvents',{filter:self.options.filter,latitude:self.options.userLatitude,longitude:self.options.userLongitude,distance:self.options.distance,ordering:ordering,sort:1,includePast:includePast}).done(function(contents){self.list().html(contents);self.initItems()});return}
EasySocial.ajax('site/controllers/events/getEvents',{filter:filter,categoryid:categoryid,ordering:ordering,sort:1,includePast:includePast}).done(function(contents){self.list().html(contents);self.initItems()})},'{pastLink}click':function(el,ev){ev.preventDefault();self.pastFilter().trigger('click')},setPastLink:function(){var pastLink=self.pastLink(),includePast=self.pastFilter().is(':checked')?1:0,ordering=self.sort('.active').data('ordering');var link=pastLink.data(ordering+'-'+(includePast?'nopast':'past'));pastLink.attr('href',link)},setSortLink:function(){var includePast=self.pastFilter().is(':checked')?1:0;$.each(self.sort(),function(i,el){var el=$(el);el.attr('href',self.pastLink().data(el.data('ordering')+'-'+(includePast?'past':'nopast')))})},'{prevDate}click':function(el,ev){ev.preventDefault();el.route();self.filters().removeClass('active');self.element.addClass('loading');self.content().html('&nbsp;');EasySocial.ajax('site/controllers/events/getEvents',{filter:'date',date:el.data('events-nav-prevdate')}).done(function(contents,options){self.element.removeClass('loading');self.content().html(contents);self.initItems();if(options.isToday){self.filters().removeClass('active');self.filters('[data-events-filters-type="date"]').addClass('active')}
if(options.isTomorrow){self.filters().removeClass('active');self.filters('[data-events-filters-type="tomorrow"]').addClass('active')}
if(options.isCurrentMonth){self.filters().removeClass('active');self.filters('[data-events-filters-type="month"]').addClass('active')}
if(options.isCurrentYear){self.filters().removeClass('active');self.filters('[data-events-filters-type="year"]').addClass('active')}})},'{nextDate}click':function(el,ev){ev.preventDefault();el.route();self.filters().removeClass('active');self.element.addClass('loading');self.content().html('&nbsp;');EasySocial.ajax('site/controllers/events/getEvents',{filter:'date',date:el.data('events-nav-nextdate')}).done(function(contents,options){self.element.removeClass('loading');self.content().html(contents);self.initItems();if(options.isToday){self.filters().removeClass('active');self.filters('[data-events-filters-type="date"]').addClass('active')}
if(options.isTomorrow){self.filters().removeClass('active');self.filters('[data-events-filters-type="tomorrow"]').addClass('active')}
if(options.isCurrentMonth){self.filters().removeClass('active');self.filters('[data-events-filters-type="month"]').addClass('active')}
if(options.isCurrentYear){self.filters().removeClass('active');self.filters('[data-events-filters-type="year"]').addClass('active')}})},'{radius}change':function(el,ev){var activeSort=self.sort('.active'),includePast=self.pastFilter().is(':checked')?1:0,ordering=activeSort.data('ordering'),filter=activeSort.data('filter'),categoryid=activeSort.data('categoryid'),distance=el.val();self.options.distance=distance;self.list().html(self.view.loadingContent());EasySocial.ajax('site/controllers/events/getEvents',{filter:'nearby',latitude:self.options.userLatitude,longitude:self.options.userLongitude,distance:self.options.distance,ordering:ordering,includePast:includePast,sort:1}).done(function(contents,options){self.list().html(contents);self.initItems();History.pushState({state:1},document.title,options.hrefs[ordering][includePast?'past':'nopast']);self.pastLink().attr('href',options.hrefs[ordering][includePast?'nopast':'past']);$.each(self.sort(),function(i,el){var el=$(el);el.attr('href',options.hrefs[el.data('ordering')][includePast?'past':'nopast']);self.pastLink().attr('data-'+el.data('ordering')+'-past',options.hrefs[el.data('ordering')]['past']);self.pastLink().attr('data-'+el.data('ordering')+'-nopast',options.hrefs[el.data('ordering')]['nopast'])});self.nearbyTitle().text(options.title)})}}});EasySocial.Controller('Events.Browser.Item',{defaultOptions:{id:null,'{action}':'[data-item-action]','{unfeature}':'[data-item-unfeature]','{feature}':'[data-item-feature]','{unpublish}':'[data-item-unpublish]','{delete}':'[data-item-delete]','{guestStateWrap}':'[data-guest-state-wrap]'}},function(self){return{init:function(){self.options.id=self.element.data('id');self.initGuestStates()},initGuestStates:function(){self.guestStateWrap().addController('EasySocial.Controller.Events.GuestState')},'{action}click':function(el){EasySocial.dialog({content:EasySocial.ajax('site/views/events/itemActionDialog',{id:self.options.id,action:el.data('item-action'),from:'list'})})}}});EasySocial.Controller('Events.Browser.Calendar',{defaultOptions:{'{nav}':'[data-calendar-nav]','{day}':'.day','{month}':'[data-month]',view:{loading:'site/loading/small'}}},function(self){return{init:function(){},'{self}calendarLoaded':function(){self.day('.has-events').each(function(index,el){el=$(el);var content=el.find('.event-details').html();el.popbox({content:content,id:'fd',component:'es',type:'events-calendar-filter',position:'bottom-left',toggle:'hover'})});var month=self.month('.has-events');if(month.length>0){var content=month.find('.event-details').html();month.popbox({content:content,id:'fd',component:'es',type:'events-calendar-filter',position:'bottom-left',toggle:'hover'})}},'{nav}click':function(el,ev){var date=el.data('calendar-nav');self.element.html(self.view.loading());EasySocial.ajax('site/views/events/renderCalendar',{date:date}).done(function(html){self.element.html(html).trigger('calendarLoaded')})},'{day}click':function(el,ev){ev.preventDefault();el.find('a[data-route]:first').route();self.loadEvents(el.data('date'))},'{day}popboxActivate':function(el,ev,popbox){popbox.tooltip.find('a[data-route]').on('click',function(event){event.preventDefault();$(this).route();self.loadEvents($(this).data('date'))})},'{month}click':function(el,ev){ev.preventDefault();el.find('a[data-route]:first').route();self.loadEvents(el.data('month'))},'{month}popboxActivate':function(el,ev,popbox){popbox.tooltip.find('a[data-route]').on('click',function(event){event.preventDefault();$(this).route();self.loadEvents($(this).data('month'))})},loadEvents:function(date){self.parent.filters().removeClass('active');self.parent.element.addClass('loading');self.parent.content().html('&nbsp;');EasySocial.ajax('site/controllers/events/getEvents',{filter:'date',date:date}).done(function(contents,options){self.parent.element.removeClass('loading');self.parent.content().html(contents);self.parent.initItems();if(options.isToday){self.parent.filters().removeClass('active');self.parent.filters('[data-events-filters-type="date"]').addClass('active')}
if(options.isTomorrow){self.parent.filters().removeClass('active');self.parent.filters('[data-events-filters-type="tomorrow"]').addClass('active')}
if(options.isCurrentMonth){self.parent.filters().removeClass('active');self.parent.filters('[data-events-filters-type="month"]').addClass('active')}
if(options.isCurrentYear){self.parent.filters().removeClass('active');self.parent.filters('[data-events-filters-type="year"]').addClass('active')}})}}});module.resolve()})});EasySocial.module('site/events/guestState',function($){var module=this;EasySocial.require().language('COM_EASYSOCIAL_EVENTS_GUEST_PENDING').done(function($){EasySocial.Controller('Events.GuestState',{defaultOptions:{id:null,allowMaybe:1,allowNotGoingGuest:1,hidetext:1,refresh:!1,'{guestAction}':'[data-guest-action]','{guestState}':'[data-guest-state]','{request}':'[data-guest-request]','{withdraw}':'[data-guest-withdraw]','{respond}':'[data-guest-respond]'}},function(self){return{init:function(){self.options.id=self.element.data('id');self.options.allowMaybe=self.element.data('allowmaybe');self.options.allowNotGoingGuest=self.element.data('allownotgoingguest');self.options.hidetext=self.element.data('hidetext');self.options.refresh=self.element.is('[data-refresh]')},showError:function(msg){EasySocial.dialog({content:msg})},stateClasses:{'going':'btn-es-success','maybe':'btn-es-info','notgoing':'btn-es-danger'},'{guestAction}click':function(el){var action=el.data('guestAction');if(action==='state'){var state=el.data('guestState');self.guestAction().removeClass('btn-es-success btn-es-info btn-es-danger');el.addClass(self.stateClasses[state]);if(state==='notgoing'&&!self.options.allowNotGoingGuest){EasySocial.dialog({content:EasySocial.ajax('site/views/events/notGoingDialog',{id:self.options.id}),bindings:{'{closeButton}click':function(){EasySocial.ajax('site/views/events/refreshGuestState',{id:self.options.id,hidetext:self.options.hidetext}).done(function(html){self.element.html(html);EasySocial.dialog().close()})},'{submitButton}click':function(){self.response('notgoing').done(function(){if(self.options.refresh){return location.reload()}
EasySocial.ajax('site/views/events/refreshGuestState',{id:self.options.id,hidetext:self.options.hidetext}).done(function(html){self.element.html(html);EasySocial.dialog().close()})})}}})}else{self.response(state).done(function(){if(self.options.refresh){return location.reload()}}).fail(function(msg){el.removeClass(self.stateClasses[action]);self.showError(msg)})}}
if(action==='request'){EasySocial.dialog({content:EasySocial.ajax('site/views/events/requestDialog',{id:self.options.id}),bindings:{'{submitButton}click':function(){el.attr('data-guest-action','withdraw').data('guestAction','withdraw').removeAttr('data-guest-request').attr('data-guest-withdraw','').text($.language('COM_EASYSOCIAL_EVENTS_GUEST_PENDING'));self.response(action);EasySocial.dialog().close()}}})}
if(action==='withdraw'){EasySocial.dialog({content:EasySocial.ajax('site/views/events/withdrawDialog',{id:self.options.id}),bindings:{'{submitButton}click':function(){self.response('withdraw').done(function(){EasySocial.ajax('site/views/events/refreshGuestState',{id:self.options.id,hidetext:self.options.hidetext}).done(function(html){self.element.html(html);EasySocial.dialog().close()})})}}})}
if(action==='attend'){self.response('going').done(function(){EasySocial.ajax('site/views/events/refreshGuestState',{id:self.options.id,hidetext:self.options.hidetext}).done(function(html){if(self.options.refresh){return location.reload()}
if(html!==undefined){self.element.html(html);EasySocial.dialog().close()}})})}},response:function(action){return EasySocial.ajax('site/controllers/events/guestResponse',{id:self.options.id,state:action})}}});module.resolve()})});EasySocial.module('site/events/create',function($){var module=this;EasySocial.require().script('validate','field').done(function(){EasySocial.Controller('Events.Create',{defaultOptions:{'previousLink':null,'{fields}':'[data-create-field]','{previous}':'[data-create-previous]','{next}':'[data-create-submit]'}},function(self){return{init:function(){self.fields().addController('EasySocial.Controller.Field.Base')},'{previous}click':function(){window.location=self.options.previousLink},'{next}click':function(el){if(el.enabled()){el.disabled(!0);el.addClass('btn-loading');self.element.validate().done(function(){el.removeClass('btn-loading');el.enabled(!0);self.element.submit()}).fail(function(){el.removeClass('btn-loading');el.enabled(!0);EasySocial.dialog({content:EasySocial.ajax('site/views/profile/showFormError')})})}}}});module.resolve()})});EasySocial.module('site/events/edit',function($){var module=this;EasySocial.require().script('validate','field').done(function(){EasySocial.Controller('Events.Edit',{defaultOptions:{id:null,'{form}':'[data-form]','{nav}':'[data-step-nav]','{content}':'[data-step-content]','{fields}':'[data-edit-field]','{saveButton}':'[data-edit-save]'}},function(self){return{init:function(){self.fields().addController('EasySocial.Controller.Field.Base',{mode:'edit'})},errorFields:[],'{nav}click':function(el,ev){var id=$(el).data('for');self.content().hide();self.nav().removeClass('active');el.addClass('active');self.content().filterBy('id',id).show().find(self.fields.selector).trigger('show')},'{nav}error':function(el){el.addClass('error')},'{nav}clear':function(el){if(self.errorFields.length<1){el.removeClass('error')}},'{fields}error':function(el,ev){self.triggerStepError(el)},'{fields}clear':function(el,ev){self.clearStepError(el)},'{fieldItem}onError':function(el,ev){self.triggerStepError(el)},triggerStepError:function(el){var fieldid=el.data('id'),stepid=el.parents(self.content.selector).data('id');if($.inArray(fieldid,self.errorFields)<0){self.errorFields.push(fieldid)}
self.nav().filterBy('for',stepid).trigger('error')},clearStepError:function(el){var fieldid=el.data('id'),stepid=el.parents(self.content.selector).data('id');self.errorFields=$.without(self.errorFields,fieldid);self.nav().filterBy('for',stepid).trigger('clear')},'{saveButton}click':function(el,ev){ev.preventDefault();el.addClass('btn-loading');self.form().validate().done(function(){self.form().submit()}).fail(function(){el.removeClass('btn-loading');EasySocial.dialog({content:EasySocial.ajax('site/views/profile/showFormError')})})}}});module.resolve()})});EasySocial.module('site/events/item',function($){var module=this;EasySocial.template('info/item','<li data-sidebar-item><a class="ml-20" href="[%=url%]" title="[%=title%]" data-info-item data-info-index="[%=index%]"><i class="ies-info ies-small mr-5"></i>[%=title%]</a></li>');EasySocial.require().script('site/friends/suggest','site/events/guestState').view('site/loading/small').library('history').done(function($){EasySocial.Controller('Events.Item',{defaultOptions:{id:null,'{filterStreamList}':'[data-filter-stream-list]','{sidebarItem}':'[data-sidebar-item]','{addFilter}':'[data-filter-add]','{editFilter}':'[data-filter-edit]','{filterStream}':'[data-filter-stream]','{filterApp}':'[data-filter-app]','{showAllFilters}':'[data-filter-showall]','{apps}':'[data-app-item]','{content}':'[data-content]','{saveHashtag}':'[data-hashtag-filter-save]','{invite}':'[data-action-invite]','{unpublish}':'[data-action-unpublish]','{delete}':'[data-action-delete]','{guestStateWrap}':'[data-guest-state-wrap]','{info}':'[data-info]','{infoItem}':'[data-info-item]',"{menuItem}":"[data-dashboardSidebar-menu]",view:{infoItem:'info/item',loading:'site/loading/small'}}},function(self){return{init:function(){self.initGuestStates()},initGuestStates:function(){self.guestStateWrap().addController('EasySocial.Controller.Events.GuestState')},setActive:function(el){self.sidebarItem().removeClass('active');el.parents(self.sidebarItem.selector).addClass('active')},setLoading:function(el){self.content().html('');self.element.addClass('loading')},updateContents:function(html){self.element.removeClass('loading');self.content().html(html)},'{showAllFilters}click':function(el,ev){el.hide();self.sidebarItem().show()},'{editFilter}click':function(el,ev){ev.preventDefault();el.route();self.setLoading();self.getFilter(el.data('id'));self.setActive(el.parents('[data-sidebar-item]'))},'{addFilter}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();self.getFilter(0)},getFilter:function(id){EasySocial.ajax('site/controllers/events/getFilter',{filterId:id,eventId:self.options.id}).always(function(contents){self.updateContents(contents)})},'{filterApp}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();self.getStream(el.data('id'),'apps')},'{filterStream}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();self.getStream(el.data('id'),el.data('type'))},"{menuItem}click":function(el,event)
{self.menuItem().removeClass('active');$(el).addClass('active')},getStream:function(id,type){EasySocial.ajax('site/controllers/events/getStream',{id:id,type:type,view:"events",eventId:self.options.id}).always(function(contents){self.updateContents(contents)})},'{saveHashtag}click':function(el){var tag=el.data('tag');EasySocial.dialog({content:EasySocial.ajax('site/views/stream/confirmSaveFilter',{tag:tag}),bindings:{'{saveButton}click':function(){this.inputWarning().hide();var filterName=this.inputTitle().val();if(filterName==''){this.inputWarning().show();return}
EasySocial.ajax('site/controllers/events/addFilter',{title:filterName,tag:tag,id:self.options.id}).done(function(html,msg){var item=$.buildHTML(html);self.filterStreamList().append(item);EasySocial.dialog(msg);setTimeout(function(){EasySocial.dialog().close()},2000)})}}})},'{apps}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();EasySocial.ajax('site/controllers/events/getAppContents',{appId:el.data('app-id'),eventId:self.options.id}).always(function(contents){self.updateContents(contents)})},'{info}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();var loaded=el.data('loaded');if(loaded){self.infoItem().eq(0).trigger('click');return}
if(el.enabled()){el.disabled(!0);EasySocial.ajax('site/controllers/events/initInfo',{eventId:self.options.id}).done(function(steps){el.data('loaded',1);var parent=el.parent('[data-sidebar-item]');$.each(steps.reverse(),function(index,step){if(!step.hide){parent.after(self.view.infoItem({url:step.url,title:step.title,index:step.index}))}
if(step.html){self.updateContents(step.html);self.content().find('[data-field]').trigger('onShow')}});var item=self.infoItem().eq(0);self.setActive(item);$(document).prop('title',item.attr('title'));el.enabled(!0)}).fail(function(error){el.enabled(!0);self.updateContents(error.message)})}},'{infoItem}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();var index=el.data('info-index');EasySocial.ajax('site/controllers/events/getInfo',{eventId:self.options.id,index:index}).done(function(contents){self.updateContents(contents);self.content().find('[data-field]').trigger('onShow')}).fail(function(error){self.updateContents(error.message)})},'{invite}click':function(el,ev){EasySocial.dialog({content:self.view.loading(),width:400,heigth:150});EasySocial.ajax('site/views/events/inviteFriendsDialog',{'id':self.options.id}).done(function(content){EasySocial.dialog({content:content})})},'{unpublish}click':function(el,ev){EasySocial.dialog({content:EasySocial.ajax('site/views/events/unpublishEventDialog',{id:self.options.id})})},'{delete}click':function(el,ev){EasySocial.dialog({content:EasySocial.ajax('site/views/events/deleteEventDialog',{id:self.options.id})})}}});module.resolve()})});EasySocial.module("site/explorer",function($){var module=this;var CLASS_SELECTED="is-selected",STATE_SELECTED=".is-selected",CLASS_CHECKED="is-checked",STATE_CHECKED=".is-checked",STATE_NOT_SELECTED=":not(.is-selected)",CLASS_ACTIVE="is-active",STATE_ACTIVE=".is-active",EVENT_FILE_SELECT="fileSelect",EVENT_FILE_DESELECT="fileDeselect",EVENT_FOLDER_ACTIVATE="folderActivate",EVENT_FOLDER_DEACTIVATE="folderDeactivate",EVENT_FILE_INSERT="fileInsert",EVENT_FOLDER_INSERT="folderInsert",EVENT_FILE_REMOVE="fileRemove",EVENT_FOLDER_REMOVE="folderRemove",EVENT_FILE_USE="fileUse",EVENT_SERVICE_REQUEST="serviceRequest";$.template("explorer/folder",'<div class="fd-explorer-folder" data-id="[%==data.id%]">[%==data.name%]<a href="javascript:void(0);" class="fd-folder-remove-button" data-fd-explorer-delete-folder-button><i class="ies-cancel-2"></i></a></div>');$.template("explorer/fileGroup",'<div class="fd-explorer-file-group" data-folder="[%==data.id%]" data-plupload-dropsite></div>');$.template("explorer/file",'<div class="fd-explorer-file" data-id="[%==data.id%]">[%==data.name%]</div>');EasySocial.require().script("site/explorer/uploader").done();$.Controller("Explorer",{pluginName:"explorer",hostname:"explorer",defaultOptions:{view:{folder:"explorer/folder",fileGroup:"explorer/fileGroup",file:"explorer/file"},layout:{fileItemHeight:52},uid:null,type:null,disableValidation:!1,mockError:!1,controllerName:null,"{browser}":".fd-explorer-browser","{viewport}":".fd-explorer-viewport","{folderGroup}":".fd-explorer-folder-group","{folder}":".fd-explorer-folder","{fileGroup}":".fd-explorer-file-group","{file}":".fd-explorer-file","{button}":"[data-fd-explorer-button]","{mockError}":"[name=mock_error]","{disableValidation}":"[name=disable_validation]","{fileInput}":"[name=file]","{logs}":"[data-alertlog]","{togglefunky}":".togglefunky","{funky}":".fd-explorer-funky","{serviceState}":".service-state","{selectAllCheckbox}":"[data-fd-explorer-select-all]","{selectCheckbox}":"[data-fd-explorer-select]","{deleteButton}":"[data-fd-explorer-delete-button]","{deleteFolderButton}":"[data-fd-explorer-delete-folder-button]"}},function(self,opts,base){return{init:function(){self.options.type=self.element.data('type');self.options.uid=self.element.data('uid');self.options.controllerName=self.element.data('controller-name');$.module("easysocial/site/explorer/uploader").done(function(controller){self.addPlugin("uploader",controller)});self.services.getFolders().done(function(data){self.insertFolder(data);self.folder(":first").click()});self.viewport().on("scroll",$.debounce(self.viewportScroll,250))},baseParams:function(){return{uid:base.data("uid"),type:base.data("type")}},exception:function(ex){var logs=self.logs();if(!$.isPlainObject(ex)){ex={message:ex,type:"error"}};switch(ex.type){case "error":logs.switchClass("alert-error").html(ex.message);EasySocial.debug&&console.error(ex.message);break;case "warning":logs.switchClass("alert-warning").html(ex.message);EasySocial.debug&&console.warn(ex.message);break;case "success":logs.switchClass("alert-success").html(ex.message);EasySocial.debug&&console.log(ex.message);break;case "info":default:logs.switchClass("alert-info").html(ex.message);EasySocial.debug&&console.log(ex.message);break}
return ex},library:{file:{},folder:{}},data:function(type,id){return self.library[type][id]},addData:function(type,data){if($.isPlainObject(data))data=[data];if(!$.isArray(data)){return self.exception("Unable to add "+type+" to library due to invalid data given.")}
$.each(data,function(i){if(!$.isPlainObject(this)){self.exception("Skipping invalid "+type+" data at index "+i+".")}
if(this.id===null)this.id=0;self.library[type][this.id]=this})},removeData:function(type,id){delete self.library[type][id]},"{folder}click":function(folder){self.activateFolder(folder.data("id"))},currentFolder:function(){return self.folder(STATE_ACTIVE).data("id")},activateFolder:function(id){var folder=self.folder().filterBy("id",id),data=self.data("folder",id);if(folder.length<1)return;self.deactivateFolder(self.folder(STATE_ACTIVE).data("id"));folder.addClass(CLASS_ACTIVE);self.trigger(EVENT_FOLDER_ACTIVATE,[id,folder,data])},deactivateFolder:function(id){var folder=self.folder().filterBy("id",id),data=folder.data("folder");if(folder.length<1)return;folder.removeClass(CLASS_ACTIVE);self.trigger(EVENT_FOLDER_DEACTIVATE,[id,folder,data])},selectedFolder:function(){return self.currentFolder()},"{file}click":function(file,event){var multiple=event.metaKey||event.ctrlKey;if(!multiple)self.deselectAllFiles();self.toggleFile(file.data("id"))},toggleFile:function(id){var file=self.file().filterBy("id",id),method=file.hasClass(CLASS_SELECTED)?"deselectFile":"selectFile";if(file.length<1)return;self[method](id)},selectFile:function(id){var file=self.file().filterBy("id",id),data=self.data("file",id);if(file.length<1)return;file.addClass(CLASS_SELECTED);self.trigger(EVENT_FILE_SELECT,[id,file,data])},deselectFile:function(id){var file=self.file().filterBy("id",id),data=file.data("file",id);if(file.length<1)return;file.removeClass(CLASS_SELECTED);self.trigger(EVENT_FILE_DESELECT,[id,file,data])},selectAllFiles:function(){self.file(STATE_NOT_SELECTED).each(function(){self.selectFile($(this).data("id"))})},deselectAllFiles:function(){self.file(STATE_SELECTED).each(function(){self.deselectFile($(this).data("id"))})},selectedFile:function(){return self.selectedFiles()[0]},selectedFiles:function(){var files=[],selectedFiles;var selectedFiles=self.file(STATE_CHECKED);if(selectedFiles.length<1){selectedFiles=self.file(STATE_SELECTED)}
selectedFiles.each(function(){var id=$(this).data("id");files.push(id)});return files},insertFolder:function(data){if(!$.isArray(data))data=[data];var sample=data[0];if(!$.isPlainObject(sample)){return self.exception("Invalid folder data given to be inserted into the folder group.")}
var folderGroup=self.folderGroup();if(folderGroup.length<1){return self.exception("Could not locate folder group element.")}
var folders="";$.each(data,function(){if(this.id===null)this.id=0;folders+=self.view.folder(!0,{data:this})});folders=$.buildHTML(folders).appendTo(folderGroup);self.trigger(EVENT_FOLDER_INSERT,[folders,data])},prependFile:function(data){if(!$.isPlainObject(data)){return self.exception("Invalid file data given to be inserted.")}
var fileGroup=self.fileGroup().filterBy("folder",data.folder);if(fileGroup.length<1){return self.exception("Could not locate file group element for folder id "+data.folder+".")}
var html=data.html||self.view.file(!0,{data:data});$.buildHTML(html).data("finalized",!0).prependTo(fileGroup)},insertFile:function(data,id){if(!$.isArray(data))data=[data];if(id===undefined){var sample=data[0];if(!$.isPlainObject(sample)){return self.exception("Invalid file data given to be inserted.")}
id=sample.folder}
var fileGroup=self.fileGroup().filterBy("folder",id);if(fileGroup.length<1){return self.exception("Could not locate file group element for folder id "+data.folder+".")}
var files=[];$.each(data,function(){var filedata=this;self.file().filterBy("id",this.id).each(function(){var file=$(this);if(file.data("finalized"))return;var html=$.buildHTML(filedata.html||self.view.file(!0,{data:filedata})).data("finalized",!0);file.replaceWith(html)})});self.trigger(EVENT_FILE_INSERT,[files,data])},removeFolder:function(id){var folder=self.folder().filterBy("id",id),failed;if(folder.length<1){failed=self.exception("Could not locate to remove folder element for folder id "+id+".")}
folder.remove();var fileGroup=self.fileGroup().filterBy("folder",id);if(fileGroup.length<1){failed=self.exception("Could not locate to remove file group element for folder id "+id+".")}
fileGroup.remove();self.trigger(EVENT_FOLDER_REMOVE,[id,failed])},removeFile:function(id){var file=self.file().filterBy("id",id),failed;if(file.length<1){failed=self.exception("Could not locate to remove file element for file id "+id+".")}
file.remove();self.trigger(EVENT_FILE_REMOVE,[id,failed])},service:function(hook,params,ajaxOptions){self.serviceState().switchClass("state-busy");var task=EasySocial.ajax(base.data("url"),$.extend({hook:hook,error:opts.mockError},params),ajaxOptions).always(function(){self.serviceState().switchClass("state-idle")}).fail(function(ex){self.exception(ex)});self.trigger(EVENT_SERVICE_REQUEST,[hook,task,params]);return task},"{button}click":function(button){var hook=button.attr('data-fd-explorer-button'),method=self.services[hook];method&&method()},services:{getFolders:function(params){var defaultParams={start:0,limit:100};var task=self.service("getFolders",$.extend(self.baseParams(),defaultParams,params)).done(function(data){self.addData("folder",data)});return task},addFolder:function(params){if(!params){params={name:prompt($.language("COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME"))}}
var defaultParams={name:''};params=$.extend(self.baseParams(),defaultParams,params);if(!params.name&&!opts.disableValidation){self.exception({message:$.language("COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME"),type:"error"});return}
var task=self.service("addFolder",params).done(function(data){self.addData("folder",data);self.insertFolder(data)});return task},removeFolder:function(params){var defaultParams={id:self.selectedFolder()};if(!opts.disableValidation&&self.selectedFolder()===undefined){self.exception("No folder selected");return}
var task=self.service("removeFolder",$.extend(self.baseParams(),defaultParams,params)).done(function(id){self.removeFolder(id)});return task},getFiles:function(params){var defaultParams={start:0,limit:100};var task=self.service("getFiles",$.extend(self.baseParams(),defaultParams,params)).done(function(data){self.addData("file",data)});return task},addFile:function(params){var defaultParams={id:self.currentFolder(),files:self.fileInput()};if(!opts.disableValidation&&!self.fileInput().val()){self.exception("No file chosen yet.");return}
var task=self.service("addFile",$.extend(self.baseParams(),defaultParams,params),{type:'iframe'}).done(function(data){console.log("Upload returned data:",data);self.addData("file",data);self.prependFile(data);self.exception({message:"Added file "+data.name,type:"success"})});return task},removeFile:function(params){var defaultParams={id:self.selectedFiles()};var params=$.extend(self.baseParams(),defaultParams,params);if(!opts.disableValidation&&$.isArray(params.id)&&params.length<1){self.exception("No file selected");return}
var task=self.service("removeFile",params).done(function(id){if($.isArray(id)){$.each(id,function(){self.removeFile(this)})}else{self.removeFile(id)}
self.selectAllCheckbox().prop("checked",!1)});return task},useFile:function(){var id=self.selectedFile(),file=self.file().filterBy("id",id),data=self.data("file",id);if(file.length<1)return;self.trigger(EVENT_FILE_USE,[id,file,data])},previewFile:function(){var id=self.selectedFile(),file=self.file().filterBy("id",id),data=self.data("file",id);var url=file.data("previewUri");if(!url)return;window.open(url,"_blank")}},"{self}folderActivate":function(explorer,event,id,folder,data){var fileGroups=self.fileGroup(),fileGroup=fileGroups.filterBy("folder",id);fileGroups.removeClass(CLASS_ACTIVE);if(fileGroup.length<1){if(!data.map)data.map=[];var map='<div class="fd-explorer-file" data-id="'+data.map.join('">&nbsp;</div><div class="fd-explorer-file" data-id="')+'">&nbsp;</div>';fileGroup=self.view.fileGroup({data:data}).html(map).appendTo(self.viewport());self.services.getFiles({id:id}).done(function(data){self.insertFile(data,id)})}
fileGroup.addClass("is-active")},viewportScroll:function(){var viewport=self.viewport()[0],viewportHeight=self.viewport().height(),scrollHeight=viewport.scrollHeight,scrollTop=viewport.scrollTop,top=scrollTop-viewportHeight,itemHeight=self.file(":nth(2)").outerHeight(!0);var index=Math.floor(scrollTop/itemHeight),tolerance=3,fileGroup=self.fileGroup(".is-active"),id=fileGroup.data("folder");self.services.getFiles({id:id,start:index-tolerance}).done(function(data){self.insertFile(data,id)}).always(function(){})},"{togglefunky}click":function(){self.funky().toggle()},"{disableValidation}change":function(input){opts.disableValidation=!!input.prop("checked");self.exception({message:"Client-side validation is "+((!opts.disableValidation)?"ON!":"OFF!"),type:"info"})},"{mockError}change":function(input){opts.mockError=!!input.prop("checked");self.exception({message:"Error mocking is "+((opts.mockError)?"ON!":"OFF!"),type:"info"})},"{selectAllCheckbox}click":function(checkbox){var checked=checkbox.prop("checked");self.fileGroup(STATE_ACTIVE).find(self.selectCheckbox.selector).prop("checked",checked).trigger("change")},"{selectCheckbox}change":function(checkbox){var file=self.file.of(checkbox),id=file.data("id"),checked=checkbox.prop("checked");file.toggleClass("is-checked",checked)},"{deleteButton}click":function(deleteButton){var file=self.file.of(deleteButton),id=file.data("id");EasySocial.dialog({content:EasySocial.ajax('site/views/explorer/confirmDeleteFile',{"id":id}),bindings:{"{deleteButton}click":function()
{EasySocial.dialog().close();self.services.removeFile({id:id})}}})},"{deleteFolderButton}click":function(deleteFolderButton,event){event.preventDefault();var folder=self.folder.of(deleteFolderButton),id=folder.data("id");if(id===0)return;EasySocial.dialog({content:EasySocial.ajax('site/views/explorer/confirmDeleteFolder',{"id":id}),bindings:{"{deleteButton}click":function()
{EasySocial.dialog().close();self.services.removeFolder({id:id})}}})}}});EasySocial.require().language("COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME","COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME").done(function(){module.resolve()})});EasySocial.module('site/explorer/uploader',function($){var module=this;$.require().library("plupload").done(function(){var Controller=$.Controller("Explorer/Uploader",{defaultOptions:{settings:{},"{uploadItemGroup}":"[data-fd-explorer-upload-item-group]","{uploadItem}":"[data-fd-explorer-upload-item]"}},function(self,opts,base){return{init:function(){base.plupload(opts.settings);self.plupload=base.plupload("controller").plupload},settings:function(key,val){var settings=self.plupload.settings;if(val!==undefined){settings[key]=val}
return(key)?settings[key]:settings},"{self}folderActivate":function(explorer,event,id,folder,data){},"{self}BeforeUpload":function(el,event,uploader,file){var url=$.uri(EasySocial.ajaxUrl).addQueryParam("controller",self.explorer.options.controllerName).addQueryParam("task","explorer").addQueryParam("id",self.explorer.currentFolder()).addQueryParam("no_html",1).addQueryParam("format","json").addQueryParam("hook","addFile").addQueryParam("tmpl","component").addQueryParam("uid",base.data("uid")).addQueryParam("type",base.data("type")).addQueryParam(EasySocial.token(),1).toString();self.settings("url",url)},"{self}FilesAdded":function(el,event,uploader,file){self.plupload.start()},"{self}UploadFile":function(){clearTimeout(self.loadTimer);base.addClass("is-loading")},"{self}FileUploaded":function(el,event,uploader,file,data){self.loadTimer=setTimeout(function(){base.removeClass("is-loading")},1000);var explorer=self.explorer;if(!$.isPlainObject(data)){self.setMessage("Server did not return proper data after uploading.","error");return}
explorer.addData("file",data);explorer.prependFile(data)},"{self}FileError":function(el,event,uploader,file,response){base.removeClass("is-loading");if($.isPlainObject(response)){self.setMessage(response.message,"error")}},"{self}Error":function(el,event,uploader,error){base.removeClass("is-loading");self.setMessage(error.message,"error")}}});module.resolve(Controller)})});EasySocial.module('site/explorer/popup',function($){var module=this;EasySocial.require().view("site/explorer/popup").done(function(){$.Controller("Explorer/Popup",{defaultOptions:{view:{popup:"easysocial/site/explorer/popup"},"{popup}":"[data-explorer-popup]","{viewport}":"[data-popup-viewport]","{explorer}":"[data-explorer-popup].fd-explorer","{closeButton}":".fd-explorer.close-button"}},function(self,opts,base){return{init:function(){},"{window}resize":$.debounce(function(){},100),show:function(){var popup,node=self.popup.node;if(!node){popup=self.view.popup();node=self.popup.node=popup[0]}
if(!$.contains(base,node)){popup=$(node).appendTo(base)}
if(!popup.is(":visible")){popup.show().trigger("show")}},hide:function(){self.popup().hide().trigger("hide").detach()},open:function(options){self.show();var task=$.Deferred();var existingExplorer=self.explorer();if(existingExplorer.length>0&&existingExplorer.data("uid")===options.uid&&existingExplorer.data("type")===options.type){return task.resolve(existingExplorer.explorer("controller"),self)}
EasySocial.ajax("site/views/explorer/browser",options).done(function(html){var browser=$.buildHTML(html);self.viewport().empty().append(browser);var explorer=browser.filter(".fd-explorer").explorer("controller");task.resolve(explorer,self)}).fail(function(){task.reject()});return task},"{self}click":function(el,event){if(event.target===self.popup()[0]){self.hide()}},"{closeButton}click":function(){self.hide()}}});var instance=EasySocial.explorer=$("body").addController("Explorer/Popup");module.resolve(instance)})});EasySocial.module('site/followers/followers',function($){var module=this;EasySocial.require().view('site/loading/small').script('site/conversations/composer').done(function($){EasySocial.Controller('Followers',{defaultOptions:{"{content}":"[data-followers-content]","{filter}":"[data-followers-filter]","{items}":"[data-followers-item]","{followingCounter}":"[data-following-count]",view:{loader:"site/loading/small"}}},function(self)
{return{init:function()
{self.initItemController()},initItemController:function()
{self.items().implement(EasySocial.Controller.Followers.Item,{"{parent}":self})},updateFollowingCounter:function(value)
{var current=self.followingCounter().html(),updated=parseInt(current)+value;self.followingCounter().html(updated)},updateContents:function(contents)
{self.content().replaceWith(contents)},"{filter}click":function(filter,event){var type=filter.data('followers-filter-type'),title=filter.data('followers-filter-title'),id=filter.data('followers-filter-id'),url=filter.data('followers-filter-url');self.filter().removeClass("active");filter.addClass("active");History.pushState({state:1},title,url);EasySocial.ajax("site/controllers/followers/filter",{id:id,type:type}).done(function(contents){self.updateContents(contents);self.initItemController()})}}});EasySocial.Controller('Followers.Item',{defaultOptions:{"{unfollowButton}":"[data-followers-item-unfollow]","{composer}":"[data-followers-item-compose]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.initComposer()},initComposer:function()
{self.composer().implement(EasySocial.Controller.Conversations.Composer.Dialog,{"recipient":{"id":self.options.id}})},"{unfollowButton}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/followers/confirmUnfollow',{'id':self.options.id}),bindings:{"{unfollowButton}click":function()
{EasySocial.ajax('site/controllers/followers/unfollow',{"id":self.options.id}).done(function()
{self.parent.updateFollowingCounter(-1);self.element.remove();EasySocial.dialog().close()})}}})}}});module.resolve()})});EasySocial.module('site/friends/friends',function($){var module=this;EasySocial.require().script('site/friends/list','site/friends/item','site/friends/suggest','site/conversations/composer').view('site/loading/small','site/friends/default.empty','site/friends/list.assign').done(function($){EasySocial.Controller('Friends.Birthday',{defaultOptions:{"{messageButton}":"[data-upcoming-birthday-message-button]"}},function(self){return{init:function()
{self.options.id=self.element.data('id'),self.options.name=self.element.data('name'),self.options.avatar=self.element.data('avatar');self.messageButton().implement(EasySocial.Controller.Conversations.Composer.Dialog,{"recipient":{"id":self.options.id,"name":self.options.name,"avatar":self.options.avatar}})}}});EasySocial.Controller('Friends',{defaultOptions:{activeList:null,"{friendList}":"[data-friends-list]","{content}":"[data-friends-content]","{friendItems}":"[data-friends-items]","{friendItem}":"[data-friends-item]","{emptyList}":"[data-friends-emptyItems]","{activeTitle}":"[data-friends-activeTitle]","{filterItem}":"[data-friends-filter]","{friendListActions}":"[data-friendList-actions]","{addFriendToList}":"[data-friends-add]","{friendsCounter}":"[data-total-friends]","{pendingCounter}":"[data-total-friends-pending]","{suggestionCounter}":"[data-total-friends-suggestion]","{requestCount}":"[data-frields-request-sent-count]",view:{loader:"site/loading/small",emptyFriendItems:"site/friends/default.empty",addUserForm:"site/friends/list.assign"}}},function(self){return{init:function()
{self.friendList().implement(EasySocial.Controller.Friends.List,{"{parent}":self});self.initFriendItems()},initFriendItems:function()
{self.friendListActions().implement(EasySocial.Controller.Friends.List.Actions,{"{parent}":self})
self.friendItem().implement(EasySocial.Controller.Friends.Item,{"{parent}":self})},updateFriendsCounter:function()
{EasySocial.ajax('site/controllers/friends/getCounters').done(function(totalFriends,totalPending,totalRequests,totalSuggestion)
{self.friendsCounter().html(totalFriends);self.pendingCounter().html(totalPending);self.requestCount().html(totalRequests);self.suggestionCounter().html(totalSuggestion)})},updateListCounters:function()
{EasySocial.ajax('site/controllers/friends/getListCounts',{}).done(function(lists){$(lists).each(function(i,list){var listController=$('[data-list-'+list.id+']').controller();listController.updateCounter(list.count)})})},insertItem:function(item)
{self.emptyList().hide();self.updateListCounters();$(item).implement(EasySocial.Controller.Friends.Item,{"{parent}":self}).prependTo(self.friendItems())},removeItem:function(id)
{self.friendItem('[data-friendItem-'+id+']').remove();if(self.friendItem().length<=0)
{self.emptyList().show()}
self.updateListCounters()},updateFriendRequestCount:function(value)
{curCount=parseInt(self.requestCount().text(),10);if(curCount!=NaN)
{curCount=curCount+value;self.requestCount().text(curCount)}},updateContent:function(html)
{self.content().replaceWith(html);self.initFriendItems()},removeActiveFilter:function()
{self.filterItem().removeClass('active')},"{filterItem}click":function(filterItem,event)
{var filterType=filterItem.data('filter'),title=filterItem.data('title'),userid=filterItem.data('userid'),url=filterItem.data('url');if(self.friendList().length>0)
{self.friendList().controller().removeActiveList()}
self.filterItem().removeClass("active");filterItem.addClass('active');History.pushState({state:1},title,url);filterItem.addClass('loading');EasySocial.ajax("site/controllers/friends/filter",{"filter":filterType,"userid":userid}).done(function(html){self.updateContent(html)}).always(function(){filterItem.removeClass("loading")})}}});module.resolve()})});EasySocial.module('site/friends/list',function($){var module=this;EasySocial.require().view('site/loading/small').library('history').script('site/friends/suggest').done(function($){EasySocial.Controller('Friends.List',{defaultOptions:{parent:null,"{item}":"[data-friends-listItem]","{items}":"[data-friends-listItems]","{loadMoreButton}":".loadMoreButton","{loadMore}":".loadMore",view:{loader:"site/loading/small",items:"site/friends/default.lists"}}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Friends.List.Item,{"{parent}":self})},removeActiveList:function()
{self.item().removeClass('active')},setDefault:function(id)
{self.item().removeClass('default');self.item('.item-'+id).addClass('default')},"{item}click":function(el)
{var title=$(el).data('title'),url=$(el).data('url');History.pushState({state:1},title,url);self.parent.removeActiveFilter();self.item().removeClass('active');self.item(el).addClass('active');var id=$(el).data('id');self.parent.options.activeList=id;EasySocial.ajax('site/controllers/friends/getListFriends',{"id":id},{beforeSend:function()
{$(el).addClass('loading')}}).done(function(html){$(el).removeClass('loading');self.parent.updateContent(html)})},"{loadMoreButton}click":function(){var limitstart=self.loadMoreButton().data('limitstart');self.loadMore().html(self.view.loader());EasySocial.ajax("site/controllers/friends/getLists",{limitstart:limitstart}).done(function(items){self.loadMore().hide();self.view.items({"items":items}).appendTo(self.items())})}}});EasySocial.Controller('Friends.List.Item',{defaultOptions:{id:null,"{counter}":"[data-list-counter]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},updateCounter:function(total)
{self.counter().html(total)}}});EasySocial.Controller('Friends.List.Actions',{defaultOptions:{"{delete}":"[data-friendListActions-delete]","{add}":"[data-friendListActions-add]","{default}":"[data-friendListActions-default]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.title=self.element.data('title');self.options.userId=self.element.data('userid')},"{default}click":function()
{EasySocial.ajax('site/controllers/friends/setDefault',{"id":self.options.id}).done(function()
{self.parent.friendList().controller().setDefault(self.options.id)})},"{add}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/assignList',{"id":self.options.id}),bindings:{"{insertButton}click":function()
{var items=this.suggest().textboxlist("controller").getAddedItems();EasySocial.ajax('site/controllers/friends/assign',{"uid":$.pluck(items,"id"),"userId":self.options.userId,"listId":self.options.id}).done(function(contents){$('[data-assignFriends-notice]').hide();$(contents).each(function(i,item){self.parent.insertItem(item);EasySocial.dialog().close()})}).fail(function(message){$('[data-assignFriends-notice]').addClass('alert alert-error').html(message.message)})}}})},"{delete}click":function()
{EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmDeleteList",{"id":self.options.id}),bindings:{"{deleteButton}click":function()
{$('[data-friends-list-delete-form]').submit()}}})}}});module.resolve()})});EasySocial.module('site/friends/item',function($){var module=this;EasySocial.require().script('site/conversations/composer').language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL','COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE','COM_EASYSOCIAL_FRIENDS_CANCEL_REQUEST_DIALOG_CANCELLED','COM_EASYSOCIAL_FRIENDS_REQUEST_SENT').done(function($){EasySocial.Controller('Friends.Item',{defaultOptions:{id:null,name:null,friendId:null,"{removeFromList}":"[data-lists-removeFriend]","{unfriend}":"[data-friends-unfriend]","{addfriend}":"[data-friends-addfriend]","{block}":"[data-friends-block]","{message}":"[data-friendItem-message]","{reject}":"[data-friendItem-reject]","{approve}":"[data-friendItem-approve]","{addContainer}":"[data-friendItem-addbutton]","{addButton}":"[data-friendItem-add]","{cancelRequest}":"[data-friendItem-cancel-request]"}},function(self){return{init:function()
{self.options.id=self.element.data('id');self.options.name=self.element.data('name');self.options.friendId=self.element.data('friendid');self.options.avatar=self.element.data('avatar');self.initConversation()},"{addButton}click":function(el)
{EasySocial.ajax('site/controllers/friends/request',{"id":self.options.id}).done(function(friendId){self.addContainer().html($.language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT'));self.addContainer().addClass('btn btn-es-success btn-sm mt-20')}).fail(function(obj){EasySocial.dialog({width:450,height:180,content:obj.message})})},initConversation:function()
{self.message().implement(EasySocial.Controller.Conversations.Composer.Dialog,{"recipient":{"name":self.options.name,"id":self.options.id,"avatar":self.options.avatar}})},"{removeFromList}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmRemoveFromList',{"id":self.options.id}),bindings:{"{removeButton}click":function()
{EasySocial.ajax('site/controllers/friends/removeFromList',{"listId":self.parent.options.activeList,"userId":self.options.id}).done(function(){self.parent.removeItem(self.options.id);EasySocial.dialog({"title":"User removed from list","content":"The user has been removed from the list.","buttons":[{"name":"Done","classNames":"btn btn-es","click":function()
{EasySocial.dialog().close()}}]})}).fail(function(message){console.log(message)})}}})},"{reject}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmReject',{"id":self.options.id}),bindings:{"{rejectButton}click":function()
{EasySocial.ajax('site/controllers/friends/reject',{"id":self.options.friendId}).done(function()
{self.parent.removeItem(self.options.id);self.parent.updateFriendsCounter();EasySocial.dialog({content:EasySocial.ajax('site/views/friends/friendRejected')})})}}})},"{unfriend}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmUnfriend',{"id":self.options.id}),bindings:{"{unfriendButton}click":function()
{EasySocial.ajax('site/controllers/friends/unfriend',{"id":self.options.friendId}).done(function()
{self.parent.removeItem(self.options.id);self.parent.updateFriendsCounter();EasySocial.dialog({content:EasySocial.ajax('site/views/friends/friendRemoved',{"id":self.options.id})})})}}})},"{cancelRequest}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmCancelRequest',{"id":self.options.id}),bindings:{"{cancelRequestButton}click":function()
{EasySocial.ajax('site/controllers/friends/cancelRequest',{"id":self.options.friendId}).done(function()
{self.parent.removeItem(self.options.id);self.parent.updateFriendRequestCount(-1);EasySocial.dialog({content:EasySocial.ajax('site/views/friends/requestCancelled',{"id":self.options.id})})})}}})},"{approve}click":function(el)
{EasySocial.ajax('site/controllers/friends/approve',{"id":self.options.friendId}).done(function()
{self.parent.updateFriendsCounter();self.element.remove()})},"{addfriend}click":function(el)
{EasySocial.ajax('site/controllers/friends/request',{"id":self.options.id}).done(function(friendId)
{self.parent.updateFriendRequestCount(1);EasySocial.dialog({title:$.language('COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE'),content:$.language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL',self.options.name)});self.parent.removeItem(self.options.id)}).fail(function(message)
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/exceeded')})})},"{block}click":function()
{console.log('block')}}});module.resolve()})});EasySocial.module('site/groups/groups',function($)
{var module=this;EasySocial.require().view('site/loading/small').script('validate','field').done(function($)
{EasySocial.Controller('Groups.Browser',{defaultOptions:{"{filters}":"[data-es-groups-filters]>li","{categories}":"[data-es-groups-categories]>li","{content}":"[data-es-groups-content]","{items}":"[data-groups-item]","{featured}":"[data-groups-featured-item]",view:{loader:"site/loading/small"}}},function(self)
{return{init:function()
{self.filters().implement(EasySocial.Controller.Groups.Filter,{"{parent}":self});self.categories().implement(EasySocial.Controller.Groups.Filter.Category,{"{parent}":self});self.featured().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":self});self.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":self})},setActive:function(element)
{self.categories().removeClass('active');self.filters().removeClass('active');$(element).addClass('active');self.content().html('&nbsp;');self.element.addClass('loading')},setContent:function(contents)
{self.element.removeClass('loading');self.content().html(contents);self.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":self})}}});EasySocial.Controller('Groups.Browser.Item',{defaultOptions:{"{joinGroup}":"[data-groups-item-join]","{respond}":"[data-groups-item-respond]","{setFeatured}":"[data-groups-item-set-featured]","{removeFeatured}":"[data-groups-item-remove-featured]","{deleteGroup}":"[data-groups-item-delete]","{unpublishGroup}":"[data-groups-item-unpublish]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('groups-item-id');self.options.type=self.element.data('groups-item-type')},"{deleteGroup}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmDelete',{"id":self.options.id})})},"{unpublishGroup}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmUnpublishGroup',{"id":self.options.id})})},"{respond}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/respondInvitation',{"id":self.options.id})})},"{setFeatured}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/setFeatured',{"id":self.options.id})})},"{removeFeatured}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/removeFeatured',{"id":self.options.id})})},"{joinGroup}click":function(el,event)
{if(self.options.type=='open')
{$(el).hide()}
EasySocial.dialog({content:EasySocial.ajax('site/controllers/groups/joinGroup',{"id":self.options.id})})}}});EasySocial.Controller('Groups.Edit',{defaultOptions:{id:null,"{stepContent}":"[data-group-edit-fields-content]","{stepItem}":"[data-group-edit-fields-step]","{profileForm}":"[data-group-fields-form]","{profileContent}":"[data-group-edit-fields]","{fieldItem}":"[data-group-edit-fields-item]","{save}":"[data-group-fields-save]"}},function(self)
{return{init:function()
{self.fieldItem().addController('EasySocial.Controller.Field.Base',{mode:'edit'})},errorFields:[],'{fieldItem}error':function(el,ev)
{self.triggerStepError(el)},'{fieldItem}clear':function(el,ev)
{self.clearStepError(el)},'{fieldItem}onError':function(el,ev)
{self.triggerStepError(el)},triggerStepError:function(el)
{var fieldid=el.data('id'),stepid=el.parents(self.stepContent.selector).data('id');if($.inArray(fieldid,self.errorFields)<0)
{self.errorFields.push(fieldid)}
self.stepItem().filterBy('for',stepid).trigger('error')},clearStepError:function(el)
{var fieldid=el.data('id'),stepid=el.parents(self.stepContent.selector).data('id');self.errorFields=$.without(self.errorFields,fieldid);self.stepItem().filterBy('for',stepid).trigger('clear')},"{stepItem}click":function(el,event)
{var id=$(el).data('for');self.profileContent().show();self.stepContent().hide();self.stepItem().removeClass('active');el.addClass('active');var stepContent=self.stepContent('.step-'+id);stepContent.show();stepContent.find(self.fieldItem.selector).trigger('show')},"{stepItem}error":function(el)
{el.addClass('error')},"{stepItem}clear":function(el)
{if(self.errorFields.length<1)
{el.removeClass('error')}},"{save}click":function(el,event)
{event.preventDefault();el.addClass('btn-loading');self.profileForm().validate().fail(function()
{el.removeClass('btn-loading');EasySocial.dialog({content:EasySocial.ajax('site/views/profile/showFormError')})}).done(function()
{self.profileForm().submit()});return!1}}});EasySocial.Controller('Groups.Filter',{defaultOptions:{}},function(self)
{return{init:function()
{},"{self}click":function(el,event)
{event.preventDefault();self.parent.setActive(el);$(el).find('a').route();EasySocial.ajax('site/controllers/groups/getGroups',{filter:self.element.data('es-groups-filters-type')}).done(function(contents)
{self.parent.setContent(contents)})}}});EasySocial.Controller('Groups.Filter.Category',{defaultOptions:{id:null}},function(self)
{return{init:function()
{self.options.id=self.element.data('es-groups-category-id')},"{self}click":function(el,event)
{event.preventDefault();self.parent.setActive(el);$(el).find('a').route();EasySocial.ajax('site/controllers/groups/getGroups',{categoryId:self.options.id}).done(function(contents)
{self.parent.setContent(contents)})}}});EasySocial.Controller('Groups.Create',{defaultOptions:{'previousLink':null,'{fieldItem}':'[data-groups-create-fields-item]','{previousButton}':'[data-groups-create-previous]','{nextButton}':'[data-groups-create-submit]'}},function(self){return{init:function(){self.fieldItem().addController('EasySocial.Controller.Field.Base')},'{previousButton}click':function(){window.location=self.options.previousLink},'{nextButton}click':function(el){if(el.enabled()){el.disabled(!0);el.addClass('btn-loading');self.element.validate().done(function(){el.removeClass('btn-loading');el.enabled(!0);self.element.submit()}).fail(function(){el.removeClass('btn-loading');el.enabled(!0);EasySocial.dialog({content:EasySocial.ajax('site/views/profile/showFormError')})})}}}});module.resolve()})});EasySocial.module('site/groups/item',function($)
{var module=this;EasySocial.template('info/item','<li data-es-group-filter><a class="ml-20" href="[%=url%]" title="[%=title%]" data-info-item data-info-index="[%=index%]"><i class="ies-info ies-small mr-5"></i>[%=title%]</a></li>');EasySocial.require().script('site/friends/suggest').library('history').done(function($)
{EasySocial.Controller('Groups.Item',{defaultOptions:{"{content}":"[data-es-group-item-content]","{apps}":"[data-es-group-item-app]","{filters}":"[data-es-group-filter]","{filterStream}":"[data-es-group-stream]","{appFilter}":"[data-es-group-app-filter]","{appFilterShowAll}":"[data-app-filters-showall]","{filterBtn}":"[data-stream-filter-button]","{filterEditBtn}":"[data-dashboardFeeds-Filter-edit]","{saveHashTag}":"[data-hashtag-filter-save]","{filterUL}":"[data-es-group-ul]","{joinGroup}":"[data-es-group-join]","{leaveGroup}":"[data-es-group-leave]","{invite}":"[data-es-group-invite]","{respond}":"[data-es-group-respond]","{withdraw}":"[data-es-group-withdraw]",'{info}':'[data-info]','{infoItem}':'[data-info-item]',view:{infoItem:'info/item'}}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.apps().implement(EasySocial.Controller.Groups.Item.App,{"{parent}":self,"groupId":self.options.id})},setActive:function(el)
{self.filters().removeClass('active');el.parent().addClass('active')},setLoading:function(el)
{self.content().html('');self.element.addClass('loading')},updateContents:function(html)
{self.element.removeClass('loading');self.content().html(html)},"{appFilterShowAll}click":function(el,event)
{el.hide();self.filters().removeClass('hide')},"{filterEditBtn}click":function(el,event)
{event.preventDefault();el.route();self.setLoading();self.setActive(el);EasySocial.ajax('site/controllers/groups/getFilter',{"id":el.data('id'),"clusterId":self.options.id}).done(function(contents)
{self.updateContents(contents)}).fail(function(messageObj){return messageObj}).always(function(){})},"{filterBtn}click":function(el,event)
{event.preventDefault();el.route();self.setActive(el);self.setLoading();EasySocial.ajax('site/controllers/groups/getFilter',{"id":0,"clusterId":self.options.id}).done(function(contents)
{self.updateContents(contents)}).fail(function(messageObj){return messageObj}).always(function(){})},"{appFilter}click":function(el,event)
{event.preventDefault();var url=el.data('url'),title=el.data('title');History.pushState({state:1},title,url);self.setActive(el);self.setLoading();self.setActive(el);var id=el.data('id');EasySocial.ajax('site/controllers/groups/getStream',{"id":self.options.id,"app":id,"view":"groups"}).done(function(contents)
{self.updateContents(contents)})},"{filterStream}click":function(el,event)
{event.preventDefault();self.setActive(el);el.route();var currentSidebarMenu=$("[data-dashboardSidebar-menu].active"),fid=currentSidebarMenu.data('fid');EasySocial.ajax('site/controllers/groups/getStream',{"id":self.options.id,"filterId":fid,"view":'groups'}).done(function(contents)
{self.updateContents(contents)})},"{saveHashTag}click":function(el)
{var hashtag=el.data('tag');var id=el.data('id');EasySocial.dialog({content:EasySocial.ajax('site/views/stream/confirmSaveFilter',{"tag":hashtag}),bindings:{"{saveButton}click":function()
{this.inputWarning().hide();filterName=this.inputTitle().val();if(filterName=='')
{this.inputWarning().show();return}
EasySocial.ajax('site/controllers/groups/addFilter',{"title":filterName,"tag":hashtag,"id":id,}).done(function(html,msg)
{var item=$.buildHTML(html);self.filterUL().append(item);EasySocial.dialog(msg);setTimeout(function(){EasySocial.dialog().close()},2000)})}}})},"{withdraw}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmWithdraw',{"id":self.options.id})})},"{invite}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/inviteFriends',{"id":self.options.id})})},"{respond}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/respondInvitation',{"id":self.options.id})})},"{joinGroup}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/controllers/groups/joinGroup',{"id":self.options.id})})},"{leaveGroup}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmLeaveGroup',{"id":self.options.id})})},'{info}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();var loaded=el.data('loaded');if(loaded){self.infoItem().eq(0).trigger('click');return}
if(el.enabled()){el.disabled(!0);EasySocial.ajax('site/controllers/groups/initInfo',{groupId:self.options.id}).done(function(steps){el.data('loaded',1);var parent=el.parent('[data-es-group-filter]');$.each(steps.reverse(),function(index,step){if(!step.hide){parent.after(self.view.infoItem({url:step.url,title:step.title,index:step.index}))}
if(step.html){self.updateContents(step.html);self.content().find('[data-field]').trigger('onShow')}});var item=self.infoItem().eq(0);self.setActive(item);$(document).prop('title',item.attr('title'));el.enabled(!0)}).fail(function(error){el.enabled(!0);self.updateContents(error.message)})}},'{infoItem}click':function(el,ev){ev.preventDefault();el.route();self.setActive(el);self.setLoading();var index=el.data('info-index');EasySocial.ajax('site/controllers/groups/getInfo',{groupId:self.options.id,index:index}).done(function(contents){self.updateContents(contents);self.content().find('[data-field]').trigger('onShow')}).fail(function(error){self.updateContents(error.message)})}}});EasySocial.Controller('Groups.Item.App',{defaultOptions:{}},function(self)
{return{init:function()
{self.options.id=self.element.data('app-id')},"{self}click":function(el,event)
{event.preventDefault();el.route();self.parent.setActive(el);self.parent.setLoading();EasySocial.ajax('site/controllers/groups/getAppContents',{"appId":self.options.id,"groupId":self.options.groupId}).done(function(contents)
{self.parent.updateContents(contents)}).fail(function(messageObj)
{return messageObj})}}});EasySocial.Controller('Groups.Item.Members',{defaultOptions:{"{items}":"[data-group-members-item]","{filters}":"[data-group-members-filter]","{content}":"[data-group-members-content]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.items().implement(EasySocial.Controller.Groups.Item.Members.Record)},"{filters}click":function(el,event)
{self.filters().removeClass('active');el.addClass('active');var filter=el.data('filter');self.content().html('&nbsp;');self.content().addClass('is-loading');EasySocial.ajax('apps/group/members/controllers/groups/filterMembers',{"id":self.options.id,"filter":filter}).done(function(contents)
{self.content().removeClass('is-loading');self.content().html(contents);self.items().implement(EasySocial.Controller.Groups.Item.Members.Record)})}}});EasySocial.Controller('Groups.Item.Members.Record',{defaultOptions:{"{makeAdmin}":"[data-members-make-admin]","{revokeAdmin}":"[data-members-revoke-admin]","{approve}":"[data-members-approve]","{reject}":"[data-members-reject]","{removeMember}":"[data-members-remove]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.groupId=self.element.data('groupid')},"{approve}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmApprove',{"id":self.options.groupId,"userId":self.options.id})})},"{reject}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmReject',{"id":self.options.groupId,"userId":self.options.id})})},"{revokeAdmin}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmRevokeAdmin',{"id":self.options.groupId,"userId":self.options.id}),bindings:{"{revokeButton}click":function()
{EasySocial.ajax('site/controllers/groups/revokeAdmin',{"id":self.options.groupId,"userId":self.options.id}).done(function()
{EasySocial.dialog().close();self.element.removeClass('is-admin').addClass('is-member')})}}})},"{removeMember}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmRemoveMember',{"id":self.options.groupId,"userId":self.options.id})})},"{makeAdmin}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/groups/confirmMakeAdmin',{"id":self.options.id}),bindings:{"{makeAdminButton}click":function()
{EasySocial.ajax('site/controllers/groups/makeAdmin',{"id":self.options.groupId,"userId":self.options.id}).done(function()
{EasySocial.dialog().close();self.element.removeClass('is-member').addClass('is-admin')})}}})}}});EasySocial.Controller('Groups.Item.Discussions',{defaultOptions:{"{filter}":"[data-group-discussions-filter]","{contents}":"[data-group-discussion-contents]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},setContent:function(html)
{self.contents().removeClass('is-loading');self.contents().html(html)},setActiveFilter:function(el)
{self.filter().removeClass('active');el.addClass('active')},"{filter}click":function(el,event)
{var filter=el.data('filter');self.contents().html('&nbsp;').addClass('is-loading');self.setActiveFilter(el);EasySocial.ajax('apps/group/discussions/controllers/discussion/getDiscussions',{"id":self.options.id,"filter":filter}).done(function(contents,empty)
{if(empty)
{self.contents().addClass('is-empty')}
else{self.contents().removeClass('is-empty')}
self.setContent(contents)})}}});EasySocial.Controller('Groups.Item.Discussion',{defaultOptions:{"{form}":"[data-reply-form]","{list}":"[data-reply-list]","{replies}":"[data-reply-item]","{repliesWrap}":"[data-replies-wrapper]","{replyCounter}":"[data-reply-count]","{lock}":"[data-discussion-lock]","{unlock}":"[data-discussion-unlock]","{delete}":"[data-discussion-delete]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.groupId=self.element.data('groupid');self.implementReply(self.replies());self.form().implement(EasySocial.Controller.Groups.Item.Discussion.Form,{"{parent}":self})},implementReply:function()
{self.replies().implement(EasySocial.Controller.Groups.Item.Discussion.Reply,{"{parent}":self})},insertReply:function(html)
{self.element.removeClass('is-unanswered');self.repliesWrap().removeClass('is-empty');self.list().append(html);self.implementReply()},updateReplyCounter:function(total)
{if(total==0)
{self.repliesWrap().addClass('is-empty')}
self.replyCounter().html(total)},setResolved:function()
{self.element.addClass('is-resolved')},"{unlock}click":function(el,event)
{EasySocial.ajax('apps/group/discussions/controllers/discussion/unlock',{"id":self.options.id}).done(function()
{self.element.removeClass('is-locked')})},"{delete}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('apps/group/discussions/controllers/discussion/confirmDelete',{"id":self.options.id,"groupId":self.options.groupId})})},"{lock}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('apps/group/discussions/controllers/discussion/confirmLock'),bindings:{"{lockButton}click":function()
{EasySocial.ajax('apps/group/discussions/controllers/discussion/lock',{"id":self.options.id}).done(function()
{EasySocial.dialog().close();self.element.addClass('is-locked')})}}})}}});EasySocial.Controller('Groups.Item.Discussion.Reply',{defaultOptions:{"{acceptAnswer}":"[data-reply-accept-answer]","{delete}":"[data-reply-delete]","{edit}":"[data-reply-edit]","{cancelEdit}":"[data-reply-edit-cancel]","{update}":"[data-reply-edit-update]","{textarea}":"[data-reply-content]","{content}":"[data-reply-display-content]","{alertDiv}":"div.alert-error"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{acceptAnswer}click":function()
{EasySocial.ajax('apps/group/discussions/controllers/reply/accept',{"id":self.options.id}).done(function()
{self.parent.setResolved()})},cancelEditing:function()
{self.element.removeClass('is-editing')},"{cancelEdit}click":function()
{self.cancelEditing()},"{edit}click":function()
{self.element.addClass('is-editing')},"{update}click":function()
{var content=self.textarea().val();if(content=='')
{self.element.addClass('is-empty');self.alertDiv().show();return!1}
EasySocial.ajax('apps/group/discussions/controllers/reply/update',{"id":self.options.id,"content":content}).done(function(content)
{self.content().html(content);self.element.removeClass('is-empty');self.alertDiv().hide();self.cancelEditing()})},"{delete}click":function()
{EasySocial.dialog({content:EasySocial.ajax('apps/group/discussions/controllers/reply/confirmDelete',{"id":self.options.id}),bindings:{"{deleteButton}click":function()
{EasySocial.ajax('apps/group/discussions/controllers/reply/delete',{"id":self.options.id}).done(function(discussion)
{self.parent.updateReplyCounter(discussion.total_replies);EasySocial.dialog().close();self.element.remove()})}}})}}});EasySocial.Controller('Groups.Item.Discussion.Form',{defaultOptions:{"{textarea}":"[data-reply-content]","{submitReply}":"[data-reply-submit]"}},function(self)
{return{init:function()
{},"{submitReply}click":function(el,event)
{var content=self.textarea().val();if(content=='')
{self.element.addClass('is-empty');return!1}
EasySocial.ajax('apps/group/discussions/controllers/reply/submit',{"id":self.parent.options.id,"groupId":self.parent.options.groupId,"content":content}).done(function(html)
{self.parent.insertReply(html);self.textarea().val('')})}}});EasySocial.Controller('Groups.Item.News',{defaultOptions:{"{delete}":"[data-news-delete]","{likes}":"[data-likes-action]","{counter}":"[data-news-counter]","{likeContent}":"[data-likes-content]",}},function(self)
{return{init:function()
{self.options.id=self.element.data('id');self.options.groupId=self.element.data('group-id')},"{likes}onLiked":function(el,event,data)
{self.counter().removeClass('hide')},"{likes}onUnliked":function(el,event,data)
{var hideCounter=self.likeContent().hasClass('hide');if(hideCounter)
{self.counter().addClass('hide')}},"{delete}click":function(el,event)
{EasySocial.dialog({content:EasySocial.ajax('apps/group/news/controllers/news/confirmDelete',{"id":self.options.id,"groupId":self.options.groupId})})}}});module.resolve()})});EasySocial.module("site/notifications/list",function($){var module=this;EasySocial.require().done(function($)
{EasySocial.Controller('NotificationsList',{defaultOptions:{"{item}":"[data-notifications-list-item]","{list}":"[data-notifications-list]","{allread}":"[data-notification-all-read]","{allclear}":"[data-notification-all-clear]","{notiLoadMoreBtn}":"[data-notification-loadmore-btn]"}},function(self)
{return{init:function()
{self.item().implement(EasySocial.Controller.NotificationsList.Item,{"{parent}":self})},"{allread}click":function()
{EasySocial.ajax('site/controllers/notifications/setAllState',{"state":"read"}).done(function()
{self.item().removeClass('is-read is-hidden is-unread').addClass('is-read')})},"{allclear}click":function()
{var dialog=EasySocial.dialog({content:EasySocial.ajax("site/views/notifications/clearAllConfirm"),bindings:{"{clearButton}click":function(){EasySocial.ajax('site/controllers/notifications/setAllState',{"state":"clear"}).done(function()
{self.item().removeClass('is-read is-hidden is-unread is-read').addClass('is-remove');EasySocial.dialog().close()})}}})},"{notiLoadMoreBtn}click":function(el,event)
{var startlimit=$(el).data('startlimit');if(startlimit<0)
{return}
EasySocial.ajax('site/controllers/notifications/loadmore',{"startlimit":startlimit}).done(function(contents,nextlimit)
{$(el).data('startlimit',nextlimit);console.log(nextlimit);if(contents.length>0)
{$.buildHTML(contents).insertBefore(self.notiLoadMoreBtn());self.item().implement(EasySocial.Controller.NotificationsList.Item)}
if(nextlimit<0)
{self.notiLoadMoreBtn().hide()}}).fail(function(messageObj){return messageObj}).always(function(){})}}});EasySocial.Controller('NotificationsList.Item',{defaultOptions:{"{unread}":"[data-notifications-list-item-unread]","{read}":"[data-notifications-list-item-read]","{delete}":"[data-notifications-list-item-delete]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{unread}click":function()
{EasySocial.ajax('site/controllers/notifications/setState',{"id":self.options.id,"state":"unread"}).done(function()
{self.element.removeClass('is-read is-hidden is-unread').addClass('is-unread ')})},"{read}click":function()
{EasySocial.ajax('site/controllers/notifications/setState',{"id":self.options.id,"state":"read"}).done(function()
{self.element.removeClass('is-read is-hidden is-unread').addClass('is-read')})},"{delete}click":function()
{var dialog=EasySocial.dialog({content:EasySocial.ajax("site/views/notifications/clearConfirm"),bindings:{"{clearButton}click":function(){EasySocial.ajax('site/controllers/notifications/setState',{"id":self.options.id,"state":"clear"}).done(function()
{self.element.removeClass('is-read is-hidden is-unread is-read').addClass('is-remove');EasySocial.dialog().close()}).fail(function(msg)
{EasySocial.dialog({content:msg.message})})}}})}}});module.resolve()})});EasySocial.module('site/points/history',function(){var module=this;EasySocial.require().done(function($)
{EasySocial.Controller('Points.History',{defaultOptions:{"{loadMore}":"[data-points-history-pagination]","{timeline}":"[data-points-history-timeline]"}},function(self)
{return{init:function()
{},"{loadMore}click":function(el,event)
{var current=$(el).data('current');EasySocial.ajax('site/views/points/getHistory',{"limitstart":current,"id":self.options.id}).done(function(contents,nextLimit,done)
{self.timeline().append(contents);$(el).data('current',nextLimit);if(done)
{$(el).hide()}})}}});module.resolve()})});EasySocial.module('site/profile/about',function($){var module=this;EasySocial.require().script('field').library('history').done(function($){EasySocial.Controller('Profile.About',{defaultOptions:{'{stepItem}':'[data-profile-about-step-item]','{stepContent}':'[data-profile-about-step-content]','{fieldItem}':'[data-field]'}},function(self){return{init:function(){self.fieldItem().addController('EasySocial.Controller.Field.Base',{mode:'display'})},'{stepItem}click':function(el,ev){ev.preventDefault();el.find('a').route();var target=el.data('for');self.stepItem().removeClass('active');el.addClass('active');self.stepContent().filterBy('id',target).trigger('activateTab')},'{stepContent}activateTab':function(el,ev){self.stepContent().removeClass('active');el.addClass('active');el.find(self.fieldItem.selector).trigger('onShow')}}});module.resolve()})});EasySocial.module('site/profile/edit',function($){var module=this;EasySocial.require().script('validate','field','oauth/facebook').done(function($){EasySocial.Controller('Profile.Edit',{defaultOptions:{userid:null,"{stepContent}":"[data-profile-edit-fields-content]","{stepItem}":"[data-profile-edit-fields-step]","{profileForm}":"[data-profile-fields-form]","{profileContent}":"[data-profile-edit-fields]","{fieldItem}":"[data-profile-edit-fields-item]","{save}":"[data-profile-fields-save]","{deleteProfile}":"[data-profile-edit-delete]"}},function(self)
{return{init:function()
{self.fieldItem().addController('EasySocial.Controller.Field.Base',{userid:self.options.userid,mode:'edit'})},errorFields:[],'{fieldItem}error':function(el,ev){self.triggerStepError(el)},'{fieldItem}clear':function(el,ev){self.clearStepError(el)},'{fieldItem}onError':function(el,ev){self.triggerStepError(el)},triggerStepError:function(el){var fieldid=el.data('id'),stepid=el.parents(self.stepContent.selector).data('id');if($.inArray(fieldid,self.errorFields)<0){self.errorFields.push(fieldid)}
self.stepItem().filterBy('for',stepid).trigger('error')},clearStepError:function(el){var fieldid=el.data('id'),stepid=el.parents(self.stepContent.selector).data('id');self.errorFields=$.without(self.errorFields,fieldid);self.stepItem().filterBy('for',stepid).trigger('clear')},"{stepItem}click":function(el,event)
{var id=$(el).data('for');self.profileContent().show();self.stepItem().removeClass('active');el.addClass('active');self.stepContent().removeClass('active');var stepContent=self.stepContent().filterBy('id',id);stepContent.addClass('active');stepContent.find(self.fieldItem.selector).trigger('show')},"{stepItem}error":function(el){el.addClass('error')},"{stepItem}clear":function(el){if(self.errorFields.length<1){el.removeClass('error')}},"{save}click":function(el,event)
{event.preventDefault();$(el).addClass('btn-loading');self.profileForm().validate().fail(function()
{$(el).removeClass('btn-loading');EasySocial.dialog({content:EasySocial.ajax('site/views/profile/showFormError')})}).done(function()
{self.profileForm().submit()});return!1},"{deleteProfile}click":function()
{EasySocial.dialog({content:EasySocial.ajax('site/views/profile/confirmDelete')})}}});module.resolve()})});EasySocial.module('site/profile/friends',function($){var module=this;EasySocial.require().view('site/loading/small').language('COM_EASYSOCIAL_FRIENDS_DIALOG_CANCEL_REQUEST','COM_EASYSOCIAL_CANCEL_BUTTON','COM_EASYSOCIAL_YES_CANCEL_MY_REQUEST_BUTTON').done(function($){EasySocial.Controller('Profile.Friends.Request',{defaultOptions:{id:null,callback:null,"{addButton}":"[data-profileFriends-add]","{manageButton}":"[data-profileFriends-manage]","{pendingButton}":"[data-profileFriends-pending]","{respondButton}":"[data-profileFriends-respond]","{cancelRequest}":"[data-profileFriends-cancelRequest]","{unfriend}":"[data-profile-friends-unfriend]","{approve}":"[data-friends-response-approve]","{reject}":"[data-friends-response-reject]","{button}":"[data-profileFriends-button]","{dropdown}":"[data-profileFriends-dropdown]",view:{loader:"site/loading/small",}}},function(self)
{return{init:function()
{self.options.id=self.element.data('friend');self.options.target=self.element.data('id');self.options.callback=self.element.data('callback')},showDropDown:function()
{self.element.addClass('open')},hideDropDown:function()
{self.element.removeClass('open')},"{addButton}click":function(el){var button=self.button();button.addClass("loading");EasySocial.ajax("site/controllers/friends/request",{id:self.options.target}).done(function(friendId,button){self.dropdown().remove();self.options.id=friendId;self.button().replaceWith(button)}).fail(function(){EasySocial.dialog({content:EasySocial.ajax('site/views/friends/exceeded')});button.removeClass("loading")})},"{cancelRequest}click":function(el,event)
{var friendId=self.options.id;self.hideDropDown();EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmCancel'),bindings:{"{confirmButton}click":function()
{EasySocial.ajax('site/controllers/friends/cancelRequest',{"id":self.options.id}).done(function(button)
{self.dropdown().remove();self.button().replaceWith(button);EasySocial.dialog().close()})}}})},"{unfriend}click":function(el,event)
{var userId=$(el).data('id');EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmUnfriend',{"id":userId}),bindings:{"{unfriendButton}click":function()
{EasySocial.ajax('site/controllers/friends/unfriend',{"id":self.options.id}).done(function(button)
{self.dropdown().remove();self.button().replaceWith(button);EasySocial.dialog().close()})}}})},"{approve}click":function(el,event)
{var friendId=self.options.id;self.hideDropDown();EasySocial.ajax('site/controllers/friends/approve',{"id":friendId}).done(function(button)
{self.button().replaceWith(button)})},"{reject}click":function(el,event)
{var friendId=self.options.id;self.hideDropDown();EasySocial.dialog({content:EasySocial.ajax('site/views/friends/confirmReject'),bindings:{"{rejectButton}click":function()
{EasySocial.ajax('site/controllers/friends/reject',{"id":friendId}).done(function(button)
{self.button().replaceWith(button);EasySocial.dialog({content:EasySocial.ajax('site/views/friends/friendRejected'),})})}}})},"{dropdown}click":function(el,event)
{event.stopPropagation()},"{approveRequest}click":function()
{self.respondForm().find('input[name=task]').val('approve');self.respondForm().find('input[name=id]').val(self.options.friendId);self.respondForm().find('input[name=return]').val(self.options.callback);self.respondForm().submit()}}});module.resolve()})})
EasySocial.module('site/profile/header',function($){var module=this;EasySocial.require().script('site/profile/friends','site/profile/subscriptions','site/conversations/composer').done(function($){EasySocial.Controller('Profile.Header',{defaultOptions:{id:null,"{friendRequest}":"[data-profile-friends]","{subscribe}":"[data-profile-followers]","{conversation}":"[data-profile-conversation]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id'),self.options.name=self.element.data('name'),self.options.avatar=self.element.data('avatar');self.friendRequest().implement(EasySocial.Controller.Profile.Friends.Request,{"{parent}":self});self.subscribe().implement(EasySocial.Controller.Profile.Subscriptions,{"{parent}":self});self.conversation().implement(EasySocial.Controller.Conversations.Composer.Dialog,{"recipient":{"id":self.options.id,"name":self.options.name,"avatar":self.options.avatar}})}}});module.resolve()})});EasySocial.module('site/profile/subscriptions',function($){var module=this;EasySocial.Controller('Profile.Subscriptions',{defaultOptions:{id:null,"{follow}":"[data-subscription-follow]","{unfollow}":"[data-subscription-unfollow]","{message}":"[data-subscription-message]","{button}":"[data-subscription-button]"}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},toggleDropDown:function()
{self.element.toggleClass('open')},"{unfollow}click":function()
{self.toggleDropDown();EasySocial.ajax('site/controllers/profile/unfollow',{"id":self.options.id,"type":'user'}).done(function(button)
{self.button().replaceWith(button)})},"{follow}click":function()
{self.toggleDropDown();EasySocial.ajax('site/controllers/profile/follow',{"id":self.options.id,"type":'user'}).done(function(button)
{self.button().replaceWith(button)})}}});module.resolve()});EasySocial.module('site/profile/miniheader',function($){var module=this;EasySocial.require().library('scrollTo').done(function($){EasySocial.Controller('Profile.MiniHeader',{defaultOptions:{"{viewport}":"[data-appscroll-viewport]","{content}":"[data-appscroll-content]","{apps}":"[data-appscroll-content]li","{buttons}":"[data-appscroll-buttons]","{nextButton}":"[data-appscroll-next-button]","{prevButton}":"[data-appscroll-prev-button]"}},function(self){return{init:function(){self.setLayout();self.viewport().scrollTo(0)},"{window}resize":$.debounce(function(){self.setLayout()},300),setLayout:function(){var viewport=self.viewport(),width=5;if($(".es-main").hasClass("w480")){self.content().css({width:"auto"});self.enabled=!1;return}
self.apps().each(function(){width+=$(this).outerWidth(!0)});if(width>viewport.width()){self.content().css({width:width,float:"none"});self.buttons().css("opacity",1);self.enabled=!0}},enabled:!1,"{nextButton}click":function(){if(!self.enabled)return;var viewport=self.viewport(),width=viewport.width()-80;viewport.scrollTo('+='+width+'px',800,{axis:'x',easing:'easeInOutCubic'})},"{prevButton}click":function(){if(!self.enabled)return;var viewport=self.viewport(),width=viewport.width()-80;viewport.scrollTo('-='+width+'px',800,{axis:'x',easing:'easeInOutCubic'})}}});module.resolve()})});EasySocial.module('site/profile/notifications',function($){var module=this;EasySocial.require().script('site/profile/header').done(function(){EasySocial.Controller('Profile.Notifications',{defaultOptions:{"{sidebarItem}":"[data-notification-item]","{contentItem}":"[data-notification-content]","{notificationForm}":"[data-notifications-form]"},},function(self){return{init:function(){},"{sidebarItem}click":function(el,event){self.sidebarItem().removeClass('active');el.addClass('active');self.contentItem().hide();var element=el.data('alert-element');self.contentItem('[data-alert-element="'+element+'"]').show()}}});module.resolve()})});EasySocial.module('site/profile/privacy',function($){var module=this;EasySocial.require().script('site/profile/header').library('history','textboxlist').view('site/loading/small').done(function($){EasySocial.Controller('Profile.Privacy',{defaultOptions:{"{sidebarItem}":"[data-profile-privacy-item]","{contentItem}":"[data-privacy-content]","{privacyItem}":"[data-privacy-item]","{privacyForm}":"[data-profile-privacy-form]","{formActions}":"[data-form-actions]",view:{loading:"site/loading/small"}}},function(self)
{return{init:function()
{self.sidebarItem().implement(EasySocial.Controller.Profile.Privacy.Sidebar,{"{parent}":self});self.privacyItem().implement(EasySocial.Controller.Profile.Privacy.Item,{"{parent}":self})},updateContent:function(group)
{self.contentItem().hide();$('.privacy-content-'+group).show();if(group=='blocked'){self.formActions().hide()}else{self.formActions().show()}}}});EasySocial.Controller('Profile.Privacy.Sidebar',{defaultOptions:{"{sidebarItem}":"[data-profile-privacy-item]",}},function(self)
{return{init:function()
{},"{self}click":function(el)
{$('[data-profile-privacy-item]').removeClass('active');$(el).addClass('active');var group=self.element.data('group');self.parent.updateContent(group)}}});EasySocial.Controller('Profile.Privacy.Item',{defaultOptions:{"{selection}":"[data-privacy-select]","{hiddenCustom}":"[data-hidden-custom]","{customForm}":"[data-privacy-custom-form]","{customTextInput}":"[data-textfield]","{customItems}":"input[]","{customHideBtn}":"[data-privacy-custom-hide-button]","{customInputItem}":"[data-textboxlist-item]","{customEditBtn}":"[data-privacy-custom-edit-button]"}},function(self)
{return{init:function()
{self.customTextInput().textboxlist({component:'es',unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:2,cache:!1,query:function(keyword){var users=self.getTaggedUsers();var ajax=EasySocial.ajax("site/views/privacy/getfriends",{q:keyword,exclude:users});return ajax}}}});self.textboxlistLib=self.customTextInput().textboxlist("controller")},getTaggedUsers:function()
{var users=[];var items=self.customInputItem();if(items.length>0)
{$.each(items,function(idx,element){users.push($(element).data('id'))})}
return users},"{customTextInput}addItem":function(el,event,data){var ids=self.hiddenCustom().val();var values='';if(ids=='')
{values=data.id}
else{var idsArr=ids.split(',');idsArr.push(data.id);values=idsArr.join(',')}
self.hiddenCustom().val(values)},"{customTextInput}removeItem":function(el,event,data){var ids=self.hiddenCustom().val();var values='';var newIds=[];var idsArr=ids.split(',');for(var i=0;i<idsArr.length;i++)
{if(idsArr[i]!=data.id)
{newIds.push(idsArr[i])}}
if(newIds.length<=0)
{values=''}
else{values=newIds.join(',')}
self.hiddenCustom().val(values)},"{customEditBtn}click":function(el)
{self.customForm().toggle()},"{selection}change":function(el)
{var selected=el.val();if(selected=='custom')
{self.customForm().show();self.customEditBtn().show()}
else{self.customForm().hide();self.customEditBtn().hide()}
return},"{customHideBtn}click":function()
{self.customForm().hide();self.customEditBtn().show();self.textboxlistLib.autocomplete.hide();return}}});module.resolve()})});EasySocial.module('site/profile/profile',function($){var module=this;EasySocial.template('info/item','<li data-profile-apps-item data-layout="custom"><a class="ml-20" href="[%=url%]" title="[%=title%]" data-info-item data-info-index="[%=index%]"><i class="ies-info ies-small mr-5"></i>[%=title%]</a></li>');EasySocial.require().script('site/profile/header').library('history').done(function($){EasySocial.Controller('Profile',{defaultOptions:{id:null,"{header}":"[data-profile-header]","{app}":"[data-profile-apps-item]","{action}":"[data-profile-apps-menu]","{contents}":"[data-profile-real-content]","{sidebar}":"[data-sidebar]","{sidebarToggle}":"[data-sidebar-toggle]",'{info}':'[data-info]','{infoItem}':'[data-info-item]',view:{infoItem:'info/item'}}},function(self){return{init:function(){self.options.id=self.element.data('id');self.header().implement(EasySocial.Controller.Profile.Header,{"{parent}":self});$(function(){self.setLayout()});$(".es-responsive").on("responsive",function(){self.setLayout()})},setLayout:function(){var sidebar=self.sidebar(),sidebarToggle=self.sidebarToggle();if(sidebarToggle.is(":visible")){var container=$('<div class="es-container responsive">').append(sidebar).insertAfter(sidebarToggle)}else{$(".es-profile.es-container:not(.responsive)").prepend(sidebar);$(".es-profile.es-container.responsive").remove()}},"{sidebarToggle}sidebarToggle":function(sidebarToggle){self.setLayout()},"{app}click":function(el,event)
{self.app().removeClass('active');$(el).addClass('active');event.preventDefault();var data=el.data();if(data.layout==='canvas')
{window.location=data[data.layout+'Url'];return}
if(data.layout==='custom'){return}
History.pushState({state:1},data.title,data[data.layout+'Url']);if(self.sidebarToggle().is(':visible'))
{$.scrollTo(self.contents())}
EasySocial.ajax(data.namespace,{id:data.id,view:'profile',appId:data.appId},{beforeSend:function(){self.loading()}}).done(function(contents){self.updateContent(contents)}).fail(function(messageObj){return messageObj})},updateContent:function(content)
{self.element.removeClass("loading");self.contents().html(content)},loading:function()
{self.contents().html("");self.element.addClass("loading")},'{info}click':function(el,ev){ev.preventDefault();el.route();self.loading();var loaded=el.data('loaded');if(loaded){self.infoItem().eq(0).trigger('click');return}
EasySocial.ajax('site/controllers/profile/initInfo',{id:self.options.id}).done(function(steps){el.data('loaded',1);var parent=el.parent('[data-profile-apps-item]');$.each(steps.reverse(),function(index,step){if(!step.hide){parent.after(self.view.infoItem({url:step.url,title:step.title,index:step.index}))}
if(step.html){self.updateContent(step.html);self.contents().find('[data-field]').trigger('onShow')}});var item=self.infoItem().eq(0).parent('[data-profile-apps-item]');self.app().removeClass('active');item.addClass('active');$(document).prop('title',self.infoItem().eq(0).attr('title'))})},'{infoItem}click':function(el,ev){ev.preventDefault();el.route();self.loading();var index=el.data('info-index');EasySocial.ajax('site/controllers/profile/getInfo',{id:self.options.id,index:index}).done(function(contents){self.updateContent(contents);self.contents().find('[data-field]').trigger('onShow');self.app().removeClass('active');el.parent('[data-profile-apps-item]').addClass('active')}).fail(function(error){self.updateContent(error.message)})}}});module.resolve()})});EasySocial.module('site/registrations/registrations',function($){var module=this;EasySocial.require().script('validate','field').view('site/registration/dialog.error').language('COM_EASYSOCIAL_CLOSE_BUTTON','COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE').done(function($){EasySocial.Controller('Registrations.Form',{defaultOptions:{previousLink:null,"{submit}":"[data-registration-submit]","{field}":"[data-registration-fields-item]","{previous}":"[data-registration-previous]",view:{formError:"site/registration/dialog.error"}}},function(self)
{return{init:function()
{self.field().addController('EasySocial.Controller.Field.Base',{mode:'register'})},"{previous}click":function(el,event)
{event.preventDefault();window.location.href=self.options.previousLink;return!1},"{submit}click":function(el,event)
{event.preventDefault();$(el).addClass('btn-loading');$(self.element).validate().fail(function()
{$(el).removeClass('btn-loading');EasySocial.dialog({"title":$.language('COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE'),"content":self.view.formError(!0),"width":400,"height":150,"buttons":[{"name":$.language('COM_EASYSOCIAL_CLOSE_BUTTON'),"classNames":"btn btn-es-primary","click":function()
{EasySocial.dialog().close()}}]})}).done(function()
{self.element.submit()});return!1}}});module.resolve()})});EasySocial.module('site/search/advanced.criteria',function(){var module=this;EasySocial.require().view('site/loading/small').script('site/search/map').language('COM_EASYSOCIAL_ADVANCED_SEARCH_ADDRESS_DISTANCE_NOTICE').done(function($){EasySocial.Controller('Search.Advanced.Criteria',{defaultOptions:{"{addButton}":"[data-criteria-add-button]","{removeButton}":"[data-criteria-remove-button]","{itemConditionDiv}":"[data-itemConditionDiv]","{itemCriteria}":"[data-itemCriteria]","{itemDataKey}":"[data-itemDataKey]","{itemOperator}":"[data-itemOperator]","{itemCondition}":"[data-itemCondition]","{dateStart}":"[data-start]","{dateEnd}":"[data-end]","{dataCondition}":"[data-condition]",'{frmDistance}':'[data-distance]','{frmAddress}':'[data-address]','{frmLatitude}':'[data-latitude]','{frmLongitude}':'[data-longitude]',"{dataNotice}":"[data-criteria-notice]","{locationLabel}":"[data-location-label]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.element.addController(EasySocial.Controller.Search.Map);if(self.frmAddress().val()!=''){self.locationLabel().html(self.frmAddress().val());self.locationLabel().removeClass('hide')}},"{itemOperator}change":function()
{criteria=self.itemCriteria().find('select');datakey=self.itemDataKey().find('select');operator=self.itemOperator().find('select');var data=criteria.val().split('|');var key=data[0];var type=data[1];var opValue=operator.val();var datakey=datakey.val();if(opValue=='blank'||opValue=='notblank')
{self.itemCondition().hide()}
else{if(opValue=='between')
{self.getConditions(type,opValue,datakey)}
else{if(type=='datetime'||type=='birthday')
{if(self.dateStart().length>0)
{self.getConditions(type,opValue,datakey)}}}
if(self.itemCondition().is(":hidden"))
{self.itemCondition().show()}}},getConditions:function(type,opValue,datakey)
{EasySocial.ajax("site/controllers/search/getConditions",{"element":type,"operator":opValue,"datakey":datakey}).done(function(conditions){self.itemCondition().show();self.itemCondition().remove();var contents=$.buildHTML(conditions);contents.insertAfter(self.itemOperator())}).fail(function(messageObj){return messageObj}).always(function(){})},"{frmDistance}change":function(){var distance=self.frmDistance().val();var address=self.frmAddress().val();var lat=self.frmLatitude().val();var lng=self.frmLongitude().val();var computedVal=distance+'|'+lat+'|'+lng+'|'+address;self.dataCondition().val(computedVal)},"{dateStart}change":function(el)
{start=self.dateStart().val();end=self.dateEnd().val();var data=start;if(end.length>0)
{data=data+'|'+end}
self.dataCondition().val(data)},"{dateEnd}change":function()
{start=self.dateStart().val();end=self.dateEnd().val();var data=start;data=data+'|'+end;self.dataCondition().val(data)},"{itemCriteria}change":function()
{select=self.itemCriteria().find('select');if(select.val()!='')
{var data=select.val().split('|');var key=data[0];var type=data[1];self.dataNotice().addClass('hide');EasySocial.ajax("site/controllers/search/getDataKeys",{"key":key,"element":type}).done(function(datakeys,operators,conditions){self.itemDataKey().remove();self.itemOperator().remove();self.itemCondition().remove();var contents=$.buildHTML(operators);contents.insertAfter(self.itemConditionDiv());if(datakeys!=''){var contents=$.buildHTML(datakeys);contents.insertAfter(self.itemConditionDiv())}
var contents=$.buildHTML(conditions);contents.insertAfter(self.itemOperator())}).fail(function(messageObj){return messageObj}).always(function(){})}},"{itemDataKey}change":function()
{select=self.itemCriteria().find('select');if(select.val()!='')
{var data=select.val().split('|');var key=data[0];var type=data[1];var datakeys=self.itemDataKey().find('select');var datakey=datakeys.val();EasySocial.ajax("site/controllers/search/getOperators",{"key":key,"element":type,"datakey":datakey}).done(function(operators,conditions){self.itemOperator().remove();var contents=$.buildHTML(operators);contents.insertAfter(self.itemDataKey());self.itemCondition().remove();var contents=$.buildHTML(conditions);contents.insertAfter(self.itemOperator())}).fail(function(messageObj){return messageObj}).always(function(){})}},"{removeButton}click":function()
{self.element.remove()}}});module.resolve()})});EasySocial.module('site/search/map',function($){var module=this;$.template('easysocial/maps.suggestion','<div class="es-story-location-suggestion" data-location-suggestion><span class="formatted_address">[%=location.formatted_address%]</span></div>');EasySocial.require().library('gmaps').done(function(){EasySocial.Controller('Search.Map',{defaultOptions:{"{icon}":"[data-loaction-icon]","{locationLabel}":"[data-location-label]","{detectButton}":"[data-location-detect]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-location-suggestion]","{autocomplete}":"[data-location-autocomplete]","{dataCondition}":"[data-condition]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]",view:{suggestion:'maps.suggestion'}}},function(self){return{init:function()
{},"{detectButton}click":function(){self.icon().removeClass('ies-power').addClass('btn-loading');clearTimeout(self.detectTimer);self.detectTimer=setTimeout(function(){self.base().removeClass("is-busy")},8000);$.GMaps.geolocate({success:function(position){$.GMaps.geocode({lat:position.coords.latitude,lng:position.coords.longitude,callback:function(locations,status){if(status=="OK"){self.suggest(locations)}}})},error:function(error){var message="";switch(error.code){case 1:message=$.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:message=$.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:message=$.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR");break}
EasySocial.dialog({content:message})},always:function(){clearTimeout(self.detectTimer);self.icon().removeClass('btn-loading').addClass('ies-power')}})},"{suggestion}click":function(suggestion,event){var location=suggestion.data("location");var lat=location.geometry.location.lat(),lng=location.geometry.location.lng(),address=location.formatted_address,distance=self.frmDistance().val();self.frmAddress().val(address);self.frmLatitude().val(lat);self.frmLongitude().val(lng);var computedVal=distance+'|'+lat+'|'+lng+'|'+address;self.dataCondition().val(computedVal);self.locationLabel().html(address);self.locationLabel().removeClass('hide');self.clearSuggestions()},suggest:function(locations){self.clearSuggestions();var suggestions=self.suggestions();if(locations.length<0)return;self.results=locations;$.each(locations,function(i,location){self.view.suggestion({location:location}).data("location",location).appendTo(suggestions)});self.autocomplete().addClass('active')},clearSuggestions:function(){self.autocomplete().removeClass('active');self.suggestions().empty()}}});module.resolve()})});EasySocial.module('site/search/advanced',function(){var module=this;EasySocial.require().script('site/search/advanced.criteria').view('site/loading/small','site/advancedsearch/noresult').language('COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS').done(function($){EasySocial.Controller('Search.Advanced',{defaultOptions:{"{sidebar}":"[data-advsearch-sidebar]","{sidebarItem}":"[data-sidebar-item]","{item}":"[data-adv-search-item]","{list}":"[data-advsearch-list]","{searchForm}":"[data-adv-search-form]","{savefilterBtn}":"[data-advsearch-savefilter]","{deletefilterBtn}":"[data-advsearch-deletefilter]","{content}":"[data-advsearch-content]","{addCriteria}":"[data-adv-search-add-criteria]","{criteriaTemplate}":"[data-adv-search-criteria-template]","{resultlist}":"[data-advsearch-result-list]",view:{loadingContent:"site/loading/small",noresult:"site/advancedsearch/noresult"}}},function(self){return{init:function()
{self.sidebarController=self.sidebar().addController(EasySocial.Controller.Search.Advanced.Sidebar,{"{parent}":self});self.item().addController(EasySocial.Controller.Search.Advanced.Criteria,{"{parent}":self})},updatingContents:function()
{self.element.addClass("loading")},updateContents:function(contents)
{self.element.removeClass("loading");self.content().html(contents)},"{deletefilterBtn}click":function(el){var id=$(el).data("id");EasySocial.dialog({content:EasySocial.ajax('site/views/search/confirmFilterDelete',{"fid":id}),bindings:{"{deleteButton}click":function()
{EasySocial.ajax('site/controllers/search/deleteFilter',{"fid":id}).done(function()
{$('[data-search-filter-'+id+']').remove();$('[data-search-filter-0]').addClass('active');self.content().html("");self.updatingContents();EasySocial.ajax('site/controllers/search/getFilterResults',{"fid":'0',}).done(function(contents)
{var contents=$.buildHTML(contents);contents.addController("EasySocial.Controller.Search.Advanced.Criteria",{"{parent}":self});self.updateContents(contents)}).fail(function(messageObj)
{return messageObj})
EasySocial.dialog().close()})}}})},"{savefilterBtn}click":function()
{var data=self.searchForm().serializeJSON();EasySocial.dialog({content:EasySocial.ajax('site/views/search/confirmSaveFilter'),bindings:{"{saveButton}click":function()
{this.inputWarning().hide();filterName=this.inputTitle().val();filterSitewide=this.inputSitewide().is(':checked')?1:0;if(filterName=='')
{this.inputWarning().show();return}
EasySocial.ajax('site/controllers/search/addFilter',{"title":filterName,"sitewide":filterSitewide,"data":data,}).done(function(html,msg)
{var item=$.buildHTML(html);self.sidebarController.addFilterItem(item);EasySocial.dialog(msg);setTimeout(function(){EasySocial.dialog().close()},2000)})}}})},"{addCriteria}click":function(el,event)
{var tmpl=self.criteriaTemplate().clone();$(tmpl).removeClass('hide').removeAttr('data-adv-search-criteria-template').addController(EasySocial.Controller.Search.Advanced.Criteria,{"{parent}":self});self.list().append(tmpl)}}});EasySocial.Controller('Search.Advanced.Sidebar',{defaultOptions:{"{item}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Search.Advanced.Sidebar.Item,{"{parent}":self,"{root}":self.parent})},"addFilterItem":function(item)
{item.implement(EasySocial.Controller.Search.Advanced.Sidebar.Item,{"{parent}":self,"{root}":self.parent});item.appendTo($('[data-advsearch-sidebar-ul]'))},}});EasySocial.Controller('Search.Advanced.Sidebar.Item',{defaultOptions:{"{filterDeleteBtn}":"[data-search-filter-delete]","{filterItem}":"[data-search-filter-item]","{item}":"[data-adv-search-item]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{},"{filterItem}click":function(el,event)
{event.preventDefault();$('[data-sidebar-item]').removeClass('active loading');self.element.addClass('active');var id=self.element.data('id'),url=self.element.data('url'),title=self.element.data('title');$(el).route();self.root.content().html("");self.root.updatingContents();self.element.addClass('loading');EasySocial.ajax('site/controllers/search/getFilterResults',{"fid":id,}).done(function(contents)
{var contents=$.buildHTML(contents);contents.find(self.item.selector).addController("EasySocial.Controller.Search.Advanced.Criteria",{"{parent}":self.root});self.root.updateContents(contents)}).fail(function(messageObj)
{return messageObj}).always(function()
{self.element.removeClass('loading')})}}});module.resolve()})});EasySocial.module('site/search/advanced.list',function($){var module=this;EasySocial.require().view('site/loading/small','site/search/loadbutton').script('site/search/item').language('COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS').done(function($){EasySocial.Controller('Search.Advanced.List',{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]","{searchForm}":"[data-adv-search-form]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Search.Item);self.on("scroll.advsearch",window,$._.debounce(function(){if(self.loading)return;if(self.pagination().visible()){self.loadMore()}},250))},"{loadmorebutton}click":function(){self.loadMore()},loadMore:function(){var next_limit=self.pagination().data('last-limit');var data=self.searchForm().serializeJSON();if(next_limit=='-1')
{self.loadmorebutton().hide();return}
self.loading=!0;EasySocial.ajax('site/controllers/search/loadmore',{"data":data,"nextlimit":next_limit},{beforeSend:function()
{self.pagination().html(self.view.loadingContent())}}).done(function(contents,next_limit)
{self.pagination().data('last-limit',next_limit);self.pagination().before(contents);self.item().implement(EasySocial.Controller.Search.Item);if(next_limit=='-1'){self.pagination().html('')}else{self.pagination().html(self.view.loadmoreContent())}}).fail(function(messageObj){return messageObj}).always(function(){self.loading=!1})}}});module.resolve()})});EasySocial.module('site/search/item',function($){var module=this;EasySocial.require().view('site/loading/small').language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE').done(function($){EasySocial.Controller('Search.Item',{defaultOptions:{"{toggle}":"[data-activity-toggle]","{deleteBtn}":"[data-activity-delete]","{addFriendButton}":"[data-search-friend-button]","{pendingFriendButton}":"[data-search-friend-pending-button]","{dropdown}":"[data-profileFriends-dropdown]",view:{loader:"site/loading/small"}}},function(self){return{init:function()
{friendid:null},"{pendingFriendButton}click":function(el)
{self.dropdown().html($.language('COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE'))},"{addFriendButton}click":function(el)
{var id=self.element.data('friend-uid');$(el).addClass('btn-loading');EasySocial.ajax('site/controllers/friends/request',{"viewCallback":"usersRequest","id":id}).done(function(button)
{$(el).replaceWith(button);self.dropdown().remove();$(el).removeClass('btn-loading')}).fail(function(message)
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/exceeded')});self.dropdown().html(message)})}}});module.resolve()})});EasySocial.module('site/search/dating',function($){var module=this;EasySocial.require().script('site/search/map').done(function(){EasySocial.Controller('Search.Dating',{defaultOptions:{"{itemCriteria}":"[data-itemCriteria]","{itemDataKey}":"[data-itemDataKey]","{itemOperator}":"[data-itemOperator]","{itemCondition}":"[data-itemCondition]","{dateStart}":"[data-start]","{dateEnd}":"[data-end]","{dataCondition}":"[data-condition]","{dataGender}":"[data-gender-radio]",'{frmDistance}':'[data-distance]','{frmAddress}':'[data-address]','{frmLatitude}':'[data-latitude]','{frmLongitude}':'[data-longitude]',"{locationLabel}":"[data-location-label]",}},function(self){return{init:function()
{self.element.addController(EasySocial.Controller.Search.Map);if(self.frmAddress().val()!=''){self.locationLabel().html(self.frmAddress().val());self.locationLabel().removeClass('hide')}},"{frmDistance}change":function(){var distance=self.frmDistance().val();var address=self.frmAddress().val();var lat=self.frmLatitude().val();var lng=self.frmLongitude().val();var computedVal=distance+'|'+lat+'|'+lng+'|'+address;self.dataCondition().val(computedVal)},"{dataGender}click":function(el){self.dataCondition().val(el.val())},"{dateStart}change":function(){start=self.dateStart().val();end=self.dateEnd().val();var data=start;if(end.length>0)
{data=data+'|'+end}
self.dataCondition().val(data)},"{dateEnd}change":function(){start=self.dateStart().val();end=self.dateEnd().val();var data=end;if(start.length>0)
{data=start+'|'+data}
self.dataCondition().val(data)}}});module.resolve()})});EasySocial.module('site/search/list',function($){var module=this;EasySocial.require().view('site/loading/small','site/search/loadbutton').script('site/search/item').language('COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS').done(function($){EasySocial.Controller('Search.List',{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(self){return{init:function()
{self.item().implement(EasySocial.Controller.Search.Item);self.on("scroll.search",window,$._.debounce(function(){if(self.loading)return;if(self.pagination().visible()){self.loadMore()}},250))},"{loadmorebutton}click":function(){self.loadMore()},loadMore:function(){var query=$("[data-search-query]").val();var type=$("[data-sidebar-menu].active").data('type');var next_limit=self.pagination().data('last-limit');var last_type=self.pagination().data('last-type');if(next_limit=='-1')
{self.loadmorebutton().hide();return}
self.loading=!0;EasySocial.ajax('site/controllers/search/getItems',{"next_limit":next_limit,"last_type":last_type,"type":type,"q":query,"loadmore":'1'},{beforeSend:function()
{self.pagination().html(self.view.loadingContent())}}).done(function(contents,next_type,next_limit)
{self.pagination().data('last-limit',next_limit);self.pagination().data('last-type',next_type);self.pagination().before(contents);self.item().implement(EasySocial.Controller.Search.Item);if(next_limit=='-1'){self.pagination().html('')}else{self.pagination().html(self.view.loadmoreContent())}}).fail(function(messageObj){return messageObj}).always(function(){self.loading=!1})}}});module.resolve()})});EasySocial.module('site/search/search',function($){var module=this;EasySocial.require().library('history').script('site/search/sidebar','site/profile/friends').view('site/loading/small').done(function($){EasySocial.Controller('Search',{defaultOptions:{items:null,"{container}":"[data-search]","{contentTitle}":"[data-search-content-title]","{content}":"[data-search-content]","{sidebar}":"[data-search-sidebar]","{sidebarItem}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(self){return{init:function()
{self.sidebar().implement(EasySocial.Controller.Search.Sidebar,{"{parent}":self});self.sidebarItem().implement(EasySocial.Controller.Search.Sidebar.Item,{"{parent}":self})},updatingContents:function()
{self.content().html(self.view.loadingContent())},updateContent:function(content)
{self.content().html(content)}}});module.resolve()})});EasySocial.module('site/search/sidebar',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Search.Sidebar',{defaultOptions:{"{menuItem}":"[data-sidebar-menu]"}},function(self){return{init:function()
{},"{menuItem}click":function(el,event)
{self.menuItem().removeClass('active');$(el).addClass('active')}}});EasySocial.Controller('Search.Sidebar.Item',{defaultOptions:{}},function(self){return{init:function()
{},"{self}click":function(el,event)
{var type=self.element.data('type'),url=self.element.data('url');var query=$("[data-search-query]").val();History.pushState({state:1},'',url);self.parent.updatingContents();EasySocial.ajax('site/controllers/search/getItems',{"type":type,"q":query}).done(function(html)
{self.parent.updateContent(html)}).fail(function(message){console.log(message)});self.parent.updateContent()}}});module.resolve()})});EasySocial.module("site/search/toolbar",function($){var module=this;EasySocial.Controller("Search.Toolbar",{defaultOptions:{"{textfield}":"[data-nav-search-input]"}},function(self,opts,base){return{init:function(){},cache:{},search:$.debounce(function(keyword){if(self.loading){return}
if(!keyword||!(keyword=$.trim(keyword))||keyword.length<=2){return}
var textfield=self.textfield();textfield.popbox("widget").hide();textfield.popbox("widget").destroy();var task=self.cache[keyword]||EasySocial.ajax("site/controllers/search/getItems",{"q":keyword,"mini":"1"}).done(function(){self.cache[keyword]=task});task.fail(function(message){console.log(message)}).always(function(){self.loading=!1});self.hide();base.popbox({content:task,id:"fd",component:"es",type:"search",toggle:"click",cache:!1,offset:0});var popbox=base.popbox("widget");popbox.show();popbox.keyword=keyword},250),hide:function(){var popbox=base.popbox("widget");if(popbox){popbox.hide()}},"{textfield}keydown":function(){self.hide()},"{textfield}keyup":function(textfield,event){if(event.which===27){return}
var keyword=textfield.val();self.search(keyword)},"{self}popboxLoading":function(el,event,popbox){popbox.loader.width(base.width());popbox.loader.position(popbox.position);base.addClass("is-active")},"{self}popboxActivate":function(el,event,popbox){popbox.tooltip.width(base.width());popbox.tooltip.position(popbox.position);base.addClass("is-active")},"{self}popboxDeactivate":function(el,event,popbox){base.removeClass("is-active")}}});module.resolve()});EasySocial.module('site/stream/item',function(){var module=this;EasySocial.require().library("mentions","placeholder","dialog").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").done(function($){EasySocial.Controller('Stream.Item',{defaultOptions:{view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"},id:"",context:"","{deleteFeed}":"[data-stream-delete]","{editStream}":"[data-stream-edit]","{updateStream}":"[data-stream-edit-update]","{cancelEditStream}":"[data-stream-edit-cancel]","{addBookmark}":"[data-stream-bookmark-add]","{removeBookmark}":"[data-stream-bookmark-remove]","{hideLink}":"[data-stream-hide]","{unHideLink}":"[data-stream-show]","{hideAppLink}":"[data-stream-hide-app]","{unHideAppLink}":"[data-stream-show-app]","{hideActorLink}":"[data-stream-hide-actor]","{unHideActorLink}":"[data-stream-show-actor]","{hideNotice}":"[data-stream-hide-notice]","{actions}":"[data-streamItem-actions]","{contents}":"[data-streamItem-contents]","{streamContent}":"[data-stream-content]","{streamEditor}":"[data-stream-editor]","{streamData}":"[data-stream-item]","{likes}":"[data-likes-action]","{counterBar}":"[data-stream-counter]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{share}":"[data-repost-action]","{streamCommentLink}":"[data-stream-action-comments]","{streamCommentBlock}":"[data-comments]"}},function(self,opts,base){return{init:function(){opts.id=base.data('id');opts.context=base.data('context');opts.ishidden=base.data('ishidden');opts.actor=base.data('actor')},plugins:{},"{addBookmark}click":function(el,event)
{self.element.addClass('is-bookmarked');EasySocial.ajax('site/controllers/stream/bookmark',{"id":self.options.id}).done(function(){}).fail(function(message){self.element.removeClass('is-bookmarked');self.setMessage(message)})},"{removeBookmark}click":function(el,event)
{var filterType=window.streamFilter||!1;if(filterType!='bookmarks'){self.element.removeClass('is-bookmarked')}
EasySocial.ajax('site/controllers/stream/removeBookmark',{"id":self.options.id}).done(function(html){if(filterType=='bookmarks'){self.element.html(html)}})},"{likes}onLiked":function(el,event,data){self.counterBar().removeClass('hide')},"{likes}onUnliked":function(el,event,data){var isLikeHide=self.likeContent().hasClass('hide');var isRepostHide=self.repostContent().hasClass('hide');if(isLikeHide&&isRepostHide)
{self.counterBar().addClass('hide')}},"{share}create":function(el,event,itemHTML){self.counterBar().removeClass('hide')},"{streamCommentLink}click":function()
{self.streamCommentBlock().trigger('show')},"{actions}click":function(el,event)
{self.actions().removeClass('active');$(el).addClass('active')},"{deleteFeed}click":function()
{var uid=self.options.id
EasySocial.dialog({content:EasySocial.ajax('site/views/stream/confirmDelete'),bindings:{"{deleteButton}click":function()
{EasySocial.ajax('site/controllers/stream/delete',{"id":uid,}).done(function(html)
{EasySocial.dialog({content:html});self.element.fadeOut();setTimeout(function(){EasySocial.dialog().close()},2000)}).fail(function(message){EasySocial.dialog({content:message})})}}})},"{cancelEditStream}click":function()
{self.element.removeClass('is-editing');self.streamEditor().html('');self.streamContent().show()},"{editStream}click":function()
{var id=self.options.id;EasySocial.ajax('site/views/stream/edit',{"id":id}).done(function(html)
{self.element.addClass('is-editing');self.streamContent().hide();self.streamEditor().html(html);var textbox=self.streamEditor().find('[data-story-textbox]');var mentions=textbox.controller("mentions");if(mentions){mentions.cloneLayout();return}
textbox.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:$.View("easysocial/site/friends/suggest.hint.search"),emptyHint:$.View("easysocial/site/friends/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/friends/suggest",{search:keyword}).done(function(items){if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title=item.screenName;item.type="user";item.menuHtml=self.view.suggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task},use:function(item){return item.type+":"+item.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:$.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:$.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/hashtags/suggest",{search:keyword}).done(function(items){if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title="#"+item.title;item.type="hashtag";item.menuHtml=self.view.tagSuggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:'left top',at:'left bottom',of:self.streamEditor().find('.es-story-text'),collision:'none'}}}})})},"{updateStream}click":function()
{var textbox=self.streamEditor().find('[data-story-textbox]'),textField=self.streamEditor().find('[data-story-textfield]'),mentions=textbox.mentions("controller").toArray(),hashtags=self.element.data("storyHashtags"),hashtags=(hashtags)?hashtags.split(","):[],nohashtags=!1,data={};if(hashtags.length>0){var tags=$.map(mentions,function(mention)
{if(mention.type==="hashtag"&&$.inArray(mention.value,hashtags)>-1)
{return mention}});nohashtags=tags.length<1}
data.mentions=$.map(mentions,function(mention){if(mention.type==="hashtag"&&$.isPlainObject(mention.value)){mention.value=mention.value.title.slice(1)}
return JSON.stringify(mention)});data.content=textField.val();data.id=self.options.id;EasySocial.ajax('site/controllers/story/update',data).done(function(html,id)
{self.streamContent().html(html);self.cancelEditStream().click()})},"{hideLink}click":function()
{self.streamData().addClass('es-feed-loading');EasySocial.ajax('site/controllers/stream/hide',{"id":self.options.id}).done(function(html)
{self.streamData().removeClass('es-feed-loading');self.streamData().hide();self.element.append(html)}).fail(function(message){})},"{hideActorLink}click":function()
{EasySocial.ajax('site/controllers/stream/hideactor',{"actor":self.options.actor}).done(function(html)
{self.streamData().hide();$('.stream-actor-'+self.options.actor).addClass('hide-stream');self.element.append(html)}).fail(function(message){console.log(message)})},"{unHideActorLink}click":function()
{EasySocial.ajax('site/controllers/stream/unhideactor',{"actor":self.options.actor}).done(function()
{self.hideNotice().remove();self.streamData().show();$('.stream-actor-'+self.options.actor).removeClass('hide-stream')}).fail(function(message){console.log(message)})},"{hideAppLink}click":function()
{EasySocial.ajax('site/controllers/stream/hideapp',{"context":self.options.context}).done(function(html)
{self.streamData().hide();$('.stream-context-'+self.options.context).addClass('hide-stream');self.element.append(html)}).fail(function(message){console.log(message)})},"{unHideLink}click":function()
{EasySocial.ajax('site/controllers/stream/unhide',{"id":self.options.id}).done(function()
{self.hideNotice().remove();self.streamData().show()}).fail(function(message){console.log(message)})},"{unHideAppLink}click":function()
{EasySocial.ajax('site/controllers/stream/unhideapp',{"context":self.options.context}).done(function()
{self.hideNotice().remove();self.streamData().show();$('.stream-context-'+self.options.context).removeClass('hide-stream')}).fail(function(message){console.log(message)})}}});module.resolve()})});EasySocial.module('site/stream/stream',function(){var module=this;EasySocial.require().script('site/stream/item').view('site/loading/small','site/stream/loadbutton').language('COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS').done(function($){EasySocial.Controller('Stream',{defaultOptions:{interval:30,checknew:null,source:null,sourceId:null,autoload:!0,"{story}":"[data-story]","{share}":"[data-repost-action]","{list}":"[data-stream-list]","{newNotiBar}":"[data-stream-notification-bar]","{newNotiButton}":"[data-stream-notification-button]","{item}":"[data-streamItem]","{pagination}":"[data-stream-pagination]","{paginationGuest}":"[data-stream-pagination-guest]","{paginationCluster}":"[data-stream-pagination-cluster]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/stream/loadbutton"}}},function(self){return{init:function()
{self.item().addController(EasySocial.Controller.Stream.Item,{"{parent}":self});if(self.options.source!='stream'&&self.options.source!='unity'){if(self.options.checknew==!0){self.startMonitoring()}}
if(self.options.autoload==!0){self.on("scroll.stream",window,$._.debounce(function(){if(self.loading){return}
if(self.options.source=='unity'){if(self.paginationGuest().visible()){self.loadMoreGuest()}}else{iscluster=(self.options.source=='dashboard'||self.options.source=='profile')?!1:!0;var pagination=(iscluster===!0)?self.paginationCluster():self.pagination();if(pagination.visible()){self.loadMore(iscluster)}}},250))}
self.setLayout()},setLayout:function(){},"{window}resize":$.debounce(function(){self.setLayout()},500),"{story}create":function(el,event,itemHTML,ids){if(ids!=''){self.updateExcludeIds(ids)}
self.updateCurrentDate();$.buildHTML(itemHTML).prependTo(self.list()).addController("EasySocial.Controller.Stream.Item");self.list().children("li.empty").remove()},"{share}create":function(el,event,itemHTML){$.buildHTML(itemHTML).prependTo(self.list()).addController("EasySocial.Controller.Stream.Item");self.list().children("li.empty").remove();self.updateCurrentDate()},updateCurrentDate:function()
{EasySocial.ajax('site/controllers/stream/getCurrentDate',{}).done(function(currentdate)
{self.element.data('currentdate',currentdate)}).fail(function(messageObj){})},updateExcludeIds:function(id)
{ids=self.element.data('excludeids');newIds='';if(ids!=''&&ids!=undefined)
{newIds=ids+','+id}
else{newIds=id}
self.element.data('excludeids',newIds)},clearExcludeIds:function()
{self.element.data('excludeids','')},startMonitoring:function()
{if(self._destroyed)return self.stopMonitoring();var interval=self.options.interval*1000;if(EasySocial.debug)
{}
self.options.state=setTimeout(self.check,interval)},stopMonitoring:function()
{clearTimeout(self.options.state)},"{self}destroyed":function(){self.stopMonitoring()},check:function(){self.stopMonitoring();var interval=self.options.interval*1000;var type=$("[data-dashboardSidebar-menu].active").data('type');var id=$("[data-dashboardSidebar-menu].active").data('id');var currentdate=self.element.data('currentdate');var excludeIds=self.element.data('excludeids');var pageNottiContent=$.trim(self.newNotiBar().html());if(type==undefined&&id==undefined)
{if(self.options.source=='profile')
{type='me';id=self.options.sourceId}}
EasySocial.ajax('site/controllers/stream/checkUpdates',{"type":type,"id":id,"currentdate":currentdate,"exclude":excludeIds,"source":self.options.source,"view":self.options.source}).done(function(data,contents,nextupdate)
{if(self._destroyed){return self.stopMonitoring()}
self.element.data('currentdate',nextupdate);if(data.length>0)
{for(var i=0;i<data.length;i++)
{item=data[i];if(item.cnt>0)
{var key='[data-stream-counter-'+item.type+']';curCount=$(key).text();newCount=(curCount=='')?item.cnt:parseInt(curCount,10)+parseInt(item.cnt,10);$(key).html(newCount);$(key).parents('li').addClass('has-notice')}}
contents=$.trim(contents);curContents=$.trim(self.newNotiBar().text());if(contents.length>0&&curContents.length==0)
{self.newNotiBar().html(contents)}}
self.startMonitoring()})},"{newNotiButton}click":function(el,event){var type=$(el).data('type');var id=$(el).data('uid');var currentdate=$(el).data('since');EasySocial.ajax('site/controllers/stream/getUpdates',{"type":type,"id":id,"currentdate":currentdate,"source":self.options.source,"view":self.options.source}).done(function(contents,nextupdate,streamIds)
{var key='[data-stream-counter-';if(type=='list')
{key=key+type+'-'+id}
else{key=key+type}
key=key+']';$(key).parents('li').removeClass('has-notice');$(key).html('0');$.each(streamIds,function(idx,uid){self.item().where('id',uid).remove()});self.newNotiBar().html('');$.buildHTML(contents).prependTo(self.list()).addController("EasySocial.Controller.Stream.Item");self.clearExcludeIds();self.element.data('currentdate',nextupdate)})},"{paginationGuest}click":function(){self.loadMoreGuest()},loadMoreGuest:function(){var pagination=self.paginationGuest(),startlimit=pagination.data("nextlimit");var view=self.options.source;if(!startlimit)return;self.loading=!0;pagination.html(self.view.loadingContent({content:""}));EasySocial.ajax("site/controllers/stream/loadmoreGuest",{startlimit:startlimit,view:view}).done(function(contents,nextlimit){pagination.data({nextlimit:nextlimit});var contents=$.buildHTML(contents);contents.insertBefore(pagination).filter(self.item.selector).addController("EasySocial.Controller.Stream.Item");try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(err){};if(nextlimit==""){pagination.html('')}else{pagination.html(self.view.loadmoreContent())}}).fail(function(messageObj){return messageObj}).always(function(){self.loading=!1})},"{paginationCluster}click":function(){self.loadMore(!0)},"{pagination}click":function(){self.loadMore()},loadMore:function(iscluster){var currentSidebarMenu=$("[data-dashboardSidebar-menu].active"),type=currentSidebarMenu.data('type'),id=currentSidebarMenu.data('id');tag=currentSidebarMenu.data('tag');fid=currentSidebarMenu.data('fid');var pagination=(iscluster===!0)?self.paginationCluster():self.pagination(),startlimit=pagination.data("nextlimit"),context=pagination.data('context');var view=self.options.source;if(!startlimit)return;if(type==undefined&&id==undefined)
{if(self.options.source=='profile')
{type='me';id=self.options.sourceId}}
self.loading=!0;pagination.html(self.view.loadingContent({content:""}));EasySocial.ajax("site/controllers/stream/loadmore",{"id":id,"type":type,"startlimit":startlimit,"view":view,"tag":tag,"filterId":fid,"context":context,"iscluster":iscluster}).done(function(contents,nextlimit){pagination.data({nextlimit:nextlimit});var contents=$.buildHTML(contents);contents.insertBefore(pagination).filter(self.item.selector).addController("EasySocial.Controller.Stream.Item");self.setLayout();try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(err){};if(nextlimit==""){pagination.html('')}else{pagination.html(self.view.loadmoreContent())}}).fail(function(messageObj){return messageObj}).always(function(){self.loading=!1})}}});module.resolve()})});EasySocial.module('site/subscriptions/follow',function(){var module=this;EasySocial.require().language('COM_EASYSOCIAL_SUBSCRIPTION_INFO').done(function($){EasySocial.Controller('Follow',{defaultOptions:{}},function(self)
{return{init:function()
{},"{self}click":function()
{EasySocial.ajax('site/controllers/subscriptions/toggle',{"uid":self.element.data('id'),"type":self.element.data('type'),"notify":"1"}).done(function(content,label)
{self.element.text(label);EasySocial.dialog({title:$.language('COM_EASYSOCIAL_SUBSCRIPTION_INFO'),content:content})}).fail(function(message){self.setMessage(message,'error')})}}});module.resolve()})});EasySocial.module('site/system/broadcast',function($){var module=this;EasySocial.require().library('gritter').done(function($){EasySocial.Controller('System.Broadcast',{defaultOptions:{interval:30,sticky:!1,period:8}},function(self){return{init:function()
{self.startMonitoring()},startMonitoring:function()
{var interval=self.options.interval*1000;self.options.state=setTimeout(self.check,interval)},stopMonitoring:function()
{clearTimeout(self.options.state)},check:function()
{self.stopMonitoring();var interval=self.options.interval*1000;setTimeout(function(){EasySocial.ajax('site/controllers/notifications/getBroadcasts').done(function(items){if(items){$(items).each(function(i,item){$.gritter.add({title:item.title,text:item.content,image:item.authorAvatar,sticky:self.options.sticky,time:self.options.period*1000,class_name:'es-broadcast'})})}
self.startMonitoring()})},interval)},}});module.resolve()})});EasySocial.module('site/toolbar/conversations',function($){var module=this;EasySocial.require().library('tinyscrollbar').done(function($){EasySocial.Controller('Notifications.Conversations',{defaultOptions:{interval:30,"{counter}":"[data-notificationConversation-counter]"}},function(self){return{init:function()
{self.startMonitoring()},startMonitoring:function()
{var interval=self.options.interval*1000;if(EasySocial.debug)
{}
self.options.state=setTimeout(self.check,interval)},stopMonitoring:function()
{if(EasySocial.debug)
{}
clearTimeout(self.options.state)},check:function()
{self.stopMonitoring();var interval=self.options.interval*1000;setTimeout(function(){EasySocial.ajax('site/controllers/notifications/getConversationCounter').done(function(total){if(total>0)
{self.element.addClass('has-notice');self.counter().html(total)}
else{self.element.removeClass('has-notice')}
self.startMonitoring()})},interval)}}});module.resolve()})});EasySocial.module('site/toolbar/friends',function($){var module=this;EasySocial.require().library('tinyscrollbar').language('COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED').done(function($){EasySocial.Controller('Notifications.Friends',{defaultOptions:{interval:3,returnURL:"","{counter}":"[data-notificationFriends-counter]","{loadRequestsButton}":".loadRequestsButton"}},function(self){return{init:function()
{self.startMonitoring()},startMonitoring:function()
{var interval=self.options.interval*1000;if(EasySocial.debug)
{}
self.options.state=setTimeout(self.check,interval)},stopMonitoring:function()
{if(EasySocial.debug)
{}
clearTimeout(self.options.state)},check:function(){self.stopMonitoring();var interval=self.options.interval*1000;setTimeout(function(){EasySocial.ajax('site/controllers/notifications/friendsCounter').done(function(total)
{if(total>0)
{self.element.addClass('has-notice');self.counter().html(total)}
else{self.element.removeClass('has-notice')}
self.startMonitoring()})},interval)}}});EasySocial.Controller('Notifications.Friends.Item',{defaultOptions:{"{actionsWrapper}":"[data-friend-item-actions]","{acceptFriend}":"[data-friend-item-accept]","{rejectFriend}":"[data-friend-item-reject]","{actions}":"[data-friend-item-action]","{title}":"[data-friend-item-title]","{mutual}":"[data-friend-item-mutual]",view:{loader:'site/loading/small'},}},function(self){return{init:function()
{},"{acceptFriend}click":function(el,event)
{event.stopPropagation();var toolbar=$('[data-notifications-friends]').controller(),counter=!1;self.actionsWrapper().addClass('friend-adding');EasySocial.ajax('site/controllers/friends/approve',{viewCallback:"notificationsApprove",id:$(el).data('id')}).done(function(title,mutualFriendsContent)
{self.actionsWrapper().removeClass('friend-adding').addClass('added-friends');self.title().html(title);self.mutual().html(mutualFriendsContent);if(toolbar){var counter=toolbar.counter().html(),counter=parseInt(counter),counter=counter-1
counter=counter.toString();toolbar.counter().html(counter);if(counter==0){toolbar.element.removeClass('has-notice')}}}).fail(function(message)
{self.element.html(message.message)})},"{rejectFriend}click":function(el,event)
{event.stopPropagation();EasySocial.ajax('site/controllers/friends/reject',{"id":$(el).data('id')}).done(function(button)
{self.actionsWrapper().html($.language('COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED'))}).fail(function(message)
{self.element.html(message.message)})}}});module.resolve()})});EasySocial.module('site/toolbar/login',function($){var module=this;EasySocial.require().library('popbox').done(function($){EasySocial.Controller('Toolbar.Login',{defaultOptions:{"{dropdown}":"[data-toolbar-login-dropdown]"}},function(self){return{init:function()
{var html=self.dropdown().html(),pos=self.dropdown().data('dropdown-position');self.dropdown().remove();self.element.popbox({content:html,id:"fd",component:"es",type:"toolbar",toggle:"click",position:pos,collision:"flip none"}).attr("data-popbox","")},"{self}popboxActivate":function(el,event,popbox)
{$(popbox.tooltip).find('label').on('click',function(event)
{event.stopPropagation()})}}});module.resolve()})});EasySocial.module('site/toolbar/notifications',function($){var module=this;EasySocial.require().script('site/toolbar/friends','site/toolbar/story','site/toolbar/system','site/toolbar/profile','site/toolbar/login','site/toolbar/conversations').done(function($){EasySocial.Controller('Notifications',{defaultOptions:{friendsInterval:30,systemInterval:30,"{friendNotifications}":"[data-notifications-friends]","{conversationNotifications}":"[data-notifications-conversations]","{systemNotifications}":"[data-notifications-system]","{profileItem}":"[data-toolbar-profile]","{storyForm}":"[data-toolbar-story]","{login}":"[data-toolbar-login]","{item}":"[data-toolbar-item]"}},function(self){return{init:function()
{self.login().addController(EasySocial.Controller.Toolbar.Login);self.profileItem().addController(EasySocial.Controller.Toolbar.Profile,{interval:self.options.systemInterval});self.systemNotifications().addController(EasySocial.Controller.Notifications.System,{interval:self.options.systemInterval});self.friendNotifications().addController(EasySocial.Controller.Notifications.Friends,{interval:self.options.friendsInterval});self.conversationNotifications().addController(EasySocial.Controller.Notifications.Conversations,{interval:self.options.friendsInterval});self.storyForm().addController(EasySocial.Controller.Notifications.Story);self.setLayout();$('body').on('click.out-of-dropdown',function(){self.item().removeClass('open')})},"{window}resize":$.debounce(function(){self.setLayout()},250),setLayout:function(){var elem=self.element,toolbarWidth=elem.outerWidth(!0)-80,allItemWidth=0;self.item().each(function(){allItemWidth+=$(this).outerWidth(!0)});var exceeded=(allItemWidth>toolbarWidth);elem.toggleClass("narrow",exceeded).toggleClass("wide",!exceeded)}}});module.resolve()})});EasySocial.module('site/toolbar/story',function($){var module=this;EasySocial.require().done(function($){EasySocial.Controller('Notifications.Story',{defaultOptions:{"{loadFormButton}":".loadFormButton","{dropdown}":".dropdown-menu"}},function(self){return{init:function()
{},"{dropdown}click":function(el,event)
{},"{self}hideDropdown":function()
{},"{dropdown}click":function(el,event)
{event.stopPropagation()}}});module.resolve()})});EasySocial.module('site/toolbar/system',function($){var module=this;EasySocial.require().view('site/notifications/system.empty').library('tinyscrollbar').done(function($){EasySocial.Controller('Notifications.System',{defaultOptions:{pageTitle:null,interval:30,"{counter}":"[data-notificationSystem-counter]"}},function(self){return{init:function()
{self.options.pageTitle=$(document).attr('title');self.startMonitoring()},startMonitoring:function()
{var interval=self.options.interval*1000;if(EasySocial.debug)
{}
self.options.state=setTimeout(self.check,interval)},stopMonitoring:function()
{if(EasySocial.debug)
{}
clearTimeout(self.options.state)},check:function(){self.stopMonitoring();var interval=self.options.interval*1000;setTimeout(function(){EasySocial.ajax('site/controllers/notifications/getSystemCounter').done(function(total){if(total>0)
{$(document).attr('title',self.options.pageTitle+'('+total+')');self.element.addClass('has-notice');self.counter().html(total)}
else{self.element.removeClass('has-notice');$(document).attr('title',self.options.pageTitle)}
self.startMonitoring()})},interval)},'{window}easysocial.clearSystemNotification':function(){self.element.removeClass('has-notice');self.counter().html(0)}}});EasySocial.Controller('Notifications.System.Popbox',{defaultOptions:{"{readall}":"[data-notificationsystem-readall]","{items}":"[data-notificationsystem-items]",view:{empty:"site/notifications/system.empty"}}},function(self){return{init:function(){},"{readall}click":function()
{$('[data-notificationSystem-counter]').parents('li').removeClass('has-notice');$('[data-notificationSystem-counter]').html(0);EasySocial.ajax('site/controllers/notifications/setAllState',{"state":"read"}).done(function()
{self.items().html('');self.items().append(self.view.empty());self.items().addClass('is-empty');$(window).trigger('easysocial.clearSystemNotification')})}}})
module.resolve()})});EasySocial.module('site/toolbar/profile',function($){var module=this;EasySocial.require().library('popbox').done(function($){EasySocial.Controller('Toolbar.Profile',{defaultOptions:{"{dropdown}":"[data-toolbar-profile-dropdown]"}},function(self){return{init:function()
{var html=self.dropdown().html(),pos=self.dropdown().data('dropdown-position'),pos=pos?pos:'bottom-right';self.element.popbox({content:html,id:"fd",component:"es",type:"toolbar",toggle:"click",position:pos,collision:"flip none"}).attr("data-popbox","")},"{self}popboxActivate":function(el,event,popbox)
{$(popbox.tooltip).implement(EasySocial.Controller.Toolbar.Profile.Logout)}}});EasySocial.Controller('Toolbar.Profile.Logout',{defaultOptions:{"{logoutForm}":"[data-toolbar-logout-form]","{logoutButton}":"[data-toolbar-logout-button]"}},function(self)
{return{logout:function()
{self.logoutForm().submit()},"{logoutButton}click":function()
{self.logout()}}});module.resolve()})});EasySocial.module("site/users/popbox",function($){var module=this;EasySocial.require().library("popbox").done(function(){EasySocial.module("users/popbox",function($){this.resolve(function(popbox){var ids=popbox.button.data("ids"),position=popbox.button.attr("data-popbox-position")||"top-left";return{content:EasySocial.ajax("site/views/users/popbox",{ids:ids}),id:"fd",component:"es",type:"users",position:position}})})});module.resolve()});EasySocial.module('site/users/users',function($){var module=this;EasySocial.require().library('history').view('site/loading/small','site/users/button.following').done(function($){EasySocial.Controller('Users',{defaultOptions:{"{content}":"[data-users-content]","{listing}":"[data-users-listing]","{sort}":"[data-users-sort]","{filter}":"[data-users-filter]","{items}":"[data-users-item]","{pagination}":"[data-users-pagination]","{profile}":"[data-users-filter-profile]","{search}":"[data-users-filter-search]",view:{loading:'site/loading/small'}}},function(self)
{return{init:function()
{self.initUserController()},initUserController:function()
{self.items().implement(EasySocial.Controller.Users.Item,{"{parent}":self})},removeActiveFilter:function()
{self.filter().each(function(){$(this).parent().removeClass('active')});self.profile().each(function(){$(this).parent().removeClass('active')})
self.search().each(function(){$(this).parent().removeClass('active')})},"{profile}click":function(el,event)
{event.preventDefault();var id=$(el).data('id');self.removeActiveFilter();$(el).parent().addClass('active');$(el).route();self.listing().html(self.view.loading());EasySocial.ajax('site/controllers/users/getUsersByProfile',{"id":id}).done(function(output){self.content().html(output);self.initUserController()})},"{search}click":function(el,event)
{event.preventDefault();var id=$(el).data('id');self.removeActiveFilter();$(el).parent().addClass('active');$(el).route();self.listing().html(self.view.loading());EasySocial.ajax('site/controllers/users/getUsersByFilter',{"id":id}).done(function(output){self.content().html(output);self.initUserController()})},"{filter}click":function(el,event)
{event.preventDefault();self.sort().removeClass('active');self.removeActiveFilter();$(el).parent().addClass('active');var filter=$(el).data('filter');self.options.filter=filter;$(el).route();self.listing().html(self.view.loading());self.sort(':first').addClass('active');EasySocial.ajax('site/controllers/users/getUsers',{"filter":filter,"showpagination":1}).done(function(output)
{self.content().html(output);self.initUserController()})},"{sort}click":function(el,event)
{event.preventDefault();var type=$(el).data('type');$('<a>').attr({title:document.title,href:$(el).attr('href')}).route();self.sort().removeClass('active');$(el).addClass('active');self.listing().html(self.view.loading());self.pagination().remove();EasySocial.ajax('site/controllers/users/getUsers',{"sort":type,"filter":self.options.filter,"isSort":!0,"showpagination":1}).done(function(contents)
{self.listing().html(contents);self.initUserController()})}}});EasySocial.Controller('Users.Item',{defaultOptions:{id:null,"{followUser}":"[data-es-followers-follow]","{addFriend}":"[data-users-add-friend]","{friendsButton}":"[data-users-friends-button]","{compose}":"[data-users-friends-compose]","{unfriend}":"[data-users-friends-unfriend]",view:{followingButton:'site/users/button.following'}}},function(self)
{return{init:function()
{self.options.id=self.element.data('id')},"{followUser}following":function(el,event)
{$(el).popbox('hide');$(el).replaceWith(self.view.followingButton())},"{addFriend}click":function(el,event)
{$(el).addClass('btn-loading');EasySocial.ajax('site/controllers/friends/request',{"viewCallback":"usersRequest","id":self.options.id}).done(function(pendingButton)
{$(el).replaceWith(pendingButton);$(el).removeClass('btn-loading')}).fail(function(obj)
{EasySocial.dialog({content:EasySocial.ajax('site/views/friends/exceeded')})})}}});module.resolve()})});EasySocial.module("story",function($){var module=this;EasySocial.require().language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_STREAM_META_JOINER").view("apps/user/links/story/attachment.item","site/location/story.suggestion","site/albums/upload.item","site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").done();EasySocial.require().script("story/locations","story/friends","story/mood");EasySocial.require().library("mentions","placeholder").script('site/stream/item').language("COM_EASYSOCIAL_STORY_SUBMIT_ERROR","COM_EASYSOCIAL_STORY_CONTENT_EMPTY","COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER").done(function(){EasySocial.Controller("Story",{defaultOptions:{view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"},plugin:{text:{id:"text",name:"text",selector:"[data-story-plugin-name=photos]",type:"panel"}},sourceView:null,attachment:{limit:1,lifo:!0},enterToSubmit:!1,"{header}":"[data-story-header]","{body}":"[data-story-body]","{footer}":"[data-story-footer]","{form}":"[data-story-form]","{textbox}":"[data-story-textbox]","{textField}":"[data-story-textField]","{target}":"[data-story-target]","{cluster}":"[data-story-cluster]","{clusterType}":"[data-story-clustertype]","{submitButton}":"[data-story-submit]","{resetButton}":"[data-story-reset]","{privacyButton}":"[data-story-privacy]","{panelContents}":"[data-story-panel-contents]","{panelContent}":"[data-story-panel-content]","{panelButton}":"[data-story-panel-button]","{streamContainer}":"[data-streams]","{streamItem}":"[data-streamItem]","{friends}":"[data-story-friends]","{location}":"[data-story-location]","{mood}":"[data-story-mood]","{mentionsOverlay}":"[data-mentions-overlay]","{meta}":"[data-story-meta]","{metaContents}":"[data-story-meta-contents]","{metaContent}":"[data-story-meta-content]","{metaButtons}":"[data-story-meta-buttons]","{metaButton}":"[data-story-meta-button]"},hostname:"story"},function(self,opts,base){return{init:function(){self.id=base.data("story");$.each(self.options.plugin,function(pluginName,pluginOptions){var plugin=self.plugins[pluginName]=pluginOptions;if(plugin.type=="attachment")self.attachments.max++;plugin.selector=self.getPluginSelector(pluginName)});self.setMentionsLayout();if(self.friends().length>0){EasySocial.module("story/friends").done(function(){self.addPlugin("friends")})}
if(self.location().length>0){EasySocial.module("story/locations").done(function(){self.addPlugin("locations")})}
if(self.mood().length>0){EasySocial.module("story/mood").done(function(){self.addPlugin("mood")})}
self.placeholder=self.textField().attr("placeholder");self._setMessage=self.setMessage;self.setMessage=function(){if(base.hasClass("is-collapsed")||base.hasClass("is-resizing")){return}
self._setMessage.apply(this,arguments)};if(navigator.userAgent.match(/MSIE 9.0/i)){base.addClass("is-ie")}
self.checkResetButton();$.module("story-"+self.id).resolve(self)},checkResetButton:function(){var textField=self.textField(),defaultText=textField.attr("data-default");if(defaultText){self.resetButton().toggle(textField.val()!==defaultText)}},"{textField}keyup":$.debounce(function(textField){self.checkResetButton()},250,{leading:!0}),"{self}click":function(element,event){if($(event.target).parents().andSelf().filter(self.resetButton()[0]).length>0)return;self.expand()},"{textField}touchstart":function(){self.expand()},"{textField}keydown":function(textField,event){self.expand()},"{textField}click":function(){self.expand()},"{textField}mousedown":function(textField,event){self.expand()},"{textField}keypress":function(textField,event){if(opts.enterToSubmit&&event.keyCode==13&&!(event.shiftKey||event.altKey||event.ctrlKey||event.metaKey)){self.save();event.preventDefault()}},expand:$.debounce(function(){if(base.hasClass("is-expanded")||base.hasClass("is-resizing")){return}
var transitionEnd=$.support&&$.support.transition&&$.support.transition.end,transitionEvent=(transitionEnd||"transitionend")+".es.story",finalize=$.debounce(function(){base.off(transitionEvent).addClass("is-expanded").removeClass("is-resizing")
self.setMentionsLayout();self.submitButton().removeAttr("data-disabled");self.textField().focus()},1);if(transitionEnd){base.on(transitionEvent,finalize)}else{setTimeout(finalize,600)}
base.removeClass("is-collapsed").addClass("is-resizing")},1),collapse:function(){if(base.hasClass("is-collapsed")||base.hasClass("is-resizing")){return}
base.addClass("is-resizing").removeClass("is-expanded");setTimeout(function(){base.addClass("is-collapsed").removeClass("is-resizing")},1)},reset:function(collapse){self.clear();if(self.textField().val()!==""){return}
if(collapse){self.collapse()}},setMentionsLayout:function(){var textbox=self.textbox(),mentions=textbox.controller("mentions");if(mentions){mentions.cloneLayout();return}
var body=self.body();textbox.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:$.View("easysocial/site/friends/suggest.hint.search"),emptyHint:$.View("easysocial/site/friends/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/friends/suggest",{search:keyword}).done(function(items){if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title=item.screenName;item.type="user";item.menuHtml=self.view.suggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task},use:function(item){return item.type+":"+item.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:$.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:$.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(keyword){var task=$.Deferred();EasySocial.ajax("site/controllers/hashtags/suggest",{search:keyword}).done(function(items){if(!$.isArray(items))task.reject();var items=$.map(items,function(item){item.title="#"+item.title;item.type="hashtag";item.menuHtml=self.view.tagSuggestItem(!0,{item:item,name:"uid[]"});return item});task.resolve(items)}).fail(task.reject);return task}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:'left top',at:'left bottom',of:textbox.parent(),collision:'none'},size:{width:function(){return body.width()}}}}})},plugins:{},getPluginName:function(element){return $(element).data("story-plugin-name")},getPluginSelector:function(pluginName){return "[data-story-plugin-name="+pluginName+"]"},hasPlugin:function(pluginName,pluginType){var plugin=self.plugins[pluginName];if(!plugin)return!1;if(pluginType)return(plugin.type===pluginType);return!0},buildPluginSelectors:function(selectorNames,plugin,pluginControllerType){var selectors={};$.each(selectorNames,function(i,selectorName){var selector=self[selectorName].selector+plugin.selector;if(pluginControllerType=="function"){selectors[selectorName]=function(){return self.find(selector)}}else{selectors["{"+selectorName+"}"]=selector}});return selectors},"{self}addPlugin":function(element,event,pluginName,pluginController,pluginOptions,pluginControllerType){if(!self.hasPlugin(pluginName))
{return}
var plugin=self.plugins[pluginName],extendedOptions={};switch(plugin.type)
{case "panel":var panelSelectors=["panelButton","panelContent"];extendedOptions=self.buildPluginSelectors(panelSelectors,plugin,pluginControllerType);break}
$.extend(pluginOptions,extendedOptions)},"{self}registerPlugin":function(element,event,pluginName,pluginInstance){if(!self.hasPlugin(pluginName))return;var plugin=self.plugins[pluginName];plugin.instance=pluginInstance},panels:{},currentPanel:"text",getPanel:function(pluginName){if(!self.hasPlugin(pluginName,'panel'))return;var plugin=self.plugins[pluginName];return self.panels[plugin.name]||(self.panels[plugin.name]={plugin:plugin,button:self.panelButton(plugin.selector),content:self.panelContent(plugin.selector)})},activatePanel:function(pluginName){var panel=self.getPanel(pluginName);if(!panel)return;self.deactivatePanel(self.currentPanel);self.currentPanel=pluginName;var panelContents=self.panelContents();panelContents.addClass("active");panel.button.addClass("active");panel.content.appendTo(panelContents).addClass("active");base.addClass("plugin-"+pluginName);self.invokePlugin(pluginName,"activatePanel",[panel]);self.trigger("activatePanel",[pluginName]);self.textField().focus()},deactivatePanel:function(pluginName){var panel=self.getPanel(pluginName);if(!panel)return;panel.button.removeClass("active");panel.content.removeClass("active");base.removeClass("plugin-"+pluginName);self.panelContents().removeClass("active");self.invokePlugin(pluginName,"deactivatePanel",[panel]);self.trigger("deactivatePanel",[pluginName])},addPanelCaption:function(pluginName,panelCaption){var panel=self.getPanel(pluginName);if(!panel)return;panel.button.addClass("has-data").find(".with-data").html(panelCaption)},removePanelCaption:function(pluginName){var panel=self.getPanel(pluginName);if(!panel)return;panel.button.removeClass("has-data").find(".with-data").empty()},"{panelButton}click":function(panelButton,event){var pluginName=self.getPluginName(panelButton);self.activatePanel(pluginName)},saving:!1,save:function(){if(self.saving){return}
self.saving=!0;var save=$.Deferred();save.data={};save.tasks=[];save.addData=function(plugin,props){var pluginName=plugin.options.name,pluginType=plugin.options.type;if(pluginName!==self.currentPanel){return}
save.data.attachment=self.currentPanel;if($.isPlainObject(props))
{$.each(props,function(key,val)
{save.data[pluginName+"_"+key]=val})}
else{save.data[pluginName]=props}};save.addTask=function(name){var task=$.Deferred();task.name=name;task.save=save;save.tasks.push(task);return task};save.process=function(){if(save.state()==="pending"){$.when.apply($,save.tasks).done(function(){if(!$.trim(save.data.content)&&!save.data.attachment){save.reject($.language("COM_EASYSOCIAL_STORY_CONTENT_EMPTY"),"warning");return}
save.resolve()}).fail(save.reject)}
return save};save.currentPanel=self.currentPanel;self.trigger("save",[save]);self.element.addClass("saving");save.process().done(function(){var mentions=self.textbox().mentions("controller").toArray(),hashtags=self.element.data("storyHashtags"),hashtags=(hashtags)?hashtags.split(","):[],nohashtags=!1;if(hashtags.length>0){var tags=$.map(mentions,function(mention)
{if(mention.type==="hashtag"&&$.inArray(mention.value,hashtags)>-1)
{return mention}});nohashtags=tags.length<1}
self.trigger("beforeSubmit",[save]);EasySocial.ajax("site/controllers/story/create",save.data).done(function(html,id){if(nohashtags){html=self.setMessage($.language("COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER"))}
self.trigger("create",[html,id]);self.clear();self.reset()}).fail(function(message){self.trigger("fail",arguments);if(!message)return;self.setMessage(message.message,message.type)}).always(function(){self.element.removeClass("saving");self.saving=!1})}).fail(function(message,messageType){if(!message){message=$.language("COM_EASYSOCIAL_STORY_SUBMIT_ERROR");messageType="error"}
self.setMessage(message,messageType);self.element.removeClass("saving");self.saving=!1})},clear:function(){self.textField().val("");self.clearMessage();self.activatePanel("text");self.deactivateMeta(self.currentMeta);self.trigger("clear");var mentions=self.textbox().mentions("controller");mentions.reset();self.checkResetButton();setTimeout(function(){mentions.cloneLayout()},500);self.textField().focus()},"{self}save":function(element,event,save){var content=self.textField().val(),data=save.data;data.view=self.options.sourceView;data.content=content;data.target=self.target().val();data.cluster=self.cluster().val();data.clusterType=self.clusterType().val();data.privacy=self.find("[data-privacy-hidden]").val();data.privacyCustom=self.find("[data-privacy-custom-hidden]").val();var mentions=self.textbox().mentions("controller").toArray();data.mentions=$.map(mentions,function(mention){if(mention.type==="hashtag"&&$.isPlainObject(mention.value)){mention.value=mention.value.title.slice(1)}
return JSON.stringify(mention)})},"{submitButton}click":function(submitButton,event){self.save()},"{resetButton}click":function(){self.reset(!0)},"{privacyButton}click":function(el){setTimeout(function(){var isActive=el.find("[data-es-privacy-container]").hasClass("active")},1)},metas:{friends:"",location:"",mood:""},currentMeta:null,getMeta:function(metaName){var meta={name:metaName,button:self.metaButton().filterBy("storyMetaButton",metaName),content:self.metaContent().filterBy("storyMetaContent",metaName)};if(meta.button.length<1||meta.content.length<1)return null;return meta},activateMeta:function(metaName){var meta=self.getMeta(metaName);if(!meta)return;self.deactivateMeta(self.currentMeta);meta.button.addClass("active");meta.content.appendTo(self.metaContents()).addClass("active");self.currentMeta=metaName;self.trigger("activateMeta",[meta]);base.addClass("has-meta")},deactivateMeta:function(metaName){var meta=self.getMeta(metaName);if(!meta)return;meta.button.removeClass("active");meta.content.removeClass("active");self.currentMeta=null;self.trigger("deactivateMeta",[meta]);base.removeClass("has-meta")},toggleMeta:function(metaName){if(self.currentMeta==metaName){self.deactivateMeta(metaName)}else{self.activateMeta(metaName)}},getMetaText:function(){var metas=self.metas,parts=[],joiner=$.language("COM_EASYSOCIAL_STREAM_META_JOINER");$.each(["friends","location","mood"],function(i,type){var meta=metas[type];if(meta)parts.push(meta)});return parts.join(joiner)},setMeta:function(metaName,content){self.metas[metaName]=content;self.updateMeta()},updateMeta:$.debounce(function(){var metaText=self.getMetaText(),meta=self.meta(),textField=self.textField();$.each(self.metas,function(key,val){var meta=self.getMeta(key);meta&&meta.button.toggleClass("has-content",!!val)});if(!metaText){meta.remove();textField.attr("placeholder",self.placeholder);return}
if(meta.length<1){meta=$('<u class="es-story-meta" data-story-meta data-ignore></u>').appendTo(self.mentionsOverlay())}
meta.html("&mdash;"+metaText);textField.attr("placeholder","");self.setMentionsLayout()},1),refreshMeta:function(){self.trigger("refreshMeta");self.updateMeta()},"{textbox}triggerClear":function(){self.refreshMeta()},"{meta}click":function(meta,event){if($(event.target).is("a"))return;self.textField().focus()},"{metaButton}click":function(metaButton){var metaName=metaButton.attr("data-story-meta-button");self.toggleMeta(metaName)}}});module.resolve()})});EasySocial.module("story/broadcast",function($){var module=this;EasySocial.require().done(function(){EasySocial.Controller("Story.Broadcast",{defaultOptions:{"{profile}":"[data-broadcast-profile]","{title}":"[data-broadcast-title]","{link}":"[data-broadcast-link]","{message}":"[data-broadcast-message]"}},function(self)
{return{init:function()
{},"{story}save":function(element,event,save)
{var profileId=self.profile().val(),title=self.title().val(),link=self.link().val();var data={"broadcast":"1","profileId":profileId,"title":title,"link":link};save.addData(self,data)},"{story}beforeSubmit":function(element,event,save)
{if(save.currentPanel!='broadcast'){return}
save.data.content=self.message().val()}}});module.resolve()})});EasySocial.module('story/event',function($){var module=this;var lang=EasySocial.options.momentLang;EasySocial.require().library('datetimepicker','moment/'+lang).view('site/loading/small').language('COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA','COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME').done(function(){EasySocial.Controller('Story.Event',{defaultOptions:{'{base}':'[data-story-event-base]','{category}':'[data-story-event-category]','{form}':'[data-story-event-form]','{timezone}':'[data-event-timezone]','{datetimeForm}':'[data-event-datetime-form]','{datetime}':'[data-event-datetime]','{title}':'[data-event-title]','{description}':'[data-event-description]',view:{loading:'site/loading/small'}}},function(self){return{init:function(){},'{category}change':function(el,ev){if(el.val()){self.form().show().html(self.view.loading());self.loadStoryForm(el.val()).done(function(html){self.form().html(html);var data=self.datetimeForm().htmlData();var yearto;if(!$.isEmpty(data.yearto)){yearto=parseInt(data.yearto)+1}else{yearto=new Date().getFullYear()+100}
$.extend(self.options,{yearfrom:data.yearfrom||1930,yearto:yearto,allowTime:data.allowtime,allowTimezone:data.allowtimezone,dateFormat:data.dateformat,disallowPast:data.disallowpast,minuteStepping:parseInt(data.minutestepping)});self.datetime().addController('EasySocial.Controller.Story.Events.Datetime',{'{parent}':self})})}else{self.form().hide().html('')}},loadStoryForm:$.memoize(function(id){return EasySocial.ajax('apps/user/events/controllers/events/loadStoryForm',{id:id})}),'{story}save':function(element,event,save){if(save.currentPanel!='event'){return}
var data={title:self.title().val(),description:self.description().val(),category:self.category().val()};if(self.options.allowTimezone){data.timezone=self.timezone().val()}
self.datetime().trigger('datetimeExport',[data]);self.options.name='event';var task=save.addTask('validateEventForm');self.save(task,data)},save:function(task,data){if($.isEmpty(data.title)||$.isEmpty(data.category)||$.isEmpty(data.start)){return task.reject($.language('COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA'))}
if(!$.isEmpty(data.start)&&!$.isEmpty(data.end)&&data.end<data.start){return task.reject($.language('COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME'))}
task.save.addData(self,data);task.resolve()}}});EasySocial.Controller('Story.Events.Datetime',{defaultOptions:{type:null,'{picker}':'[data-picker]','{toggle}':'[data-picker-toggle]','{datetime}':'[data-datetime]'}},function(self){return{init:function(){self.options.type=self.element.data('event-datetime');var minDate=new $.moment();if(self.parent.options.disallowPast){minDate.date(minDate.date()-1)}else{minDate.year(self.parent.options.yearfrom)}
self.picker()._datetimepicker({component:"es",useCurrent:!1,format:self.parent.options.dateFormat,minDate:minDate,maxDate:new $.moment({y:self.parent.options.yearto}),icons:{time:'glyphicon glyphicon-time',date:'glyphicon glyphicon-calendar',up:'glyphicon glyphicon-chevron-up',down:'glyphicon glyphicon-chevron-down'},sideBySide:!1,pickTime:self.parent.options.allowTime==1,minuteStepping:self.parent.options.minuteStepping,language:lang});var dateObj=$.moment();dateObj.minute(0);dateObj.second(0);if(self.options.type=='end'){dateObj.hour(dateObj.hour()+1)}
self.datetimepicker('setDate',dateObj)},datetimepicker:function(name,value){return self.picker().data('DateTimePicker')[name](value)},'{toggle}click':function(){self.picker().focus()},'{picker}dp.change':function(el,ev){self.setDateValue(ev.date.toDate());self.parent.element.trigger('event'+$.String.capitalize(self.options.type),[ev.date])},setDateValue:function(date){self.datetime().val(date.getFullYear()+'-'+('00'+(date.getMonth()+1)).slice(-2)+'-'+('00'+date.getDate()).slice(-2)+' '+('00'+date.getHours()).slice(-2)+':'+('00'+date.getMinutes()).slice(-2)+':'+('00'+date.getSeconds()).slice(-2))},'{parent}eventStart':function(el,ev,date){if(self.options.type==='start'){return}},'{parent}eventEnd':function(el,ev,date){if(self.options.type==='end'){return}},'{self}datetimeExport':function(el,ev,data){data[self.options.type]=self.datetime().val()}}})
module.resolve()})});EasySocial.module("story/files",function($){var module=this;EasySocial.require().library('plupload').view('apps/user/files/story/attachment.item','apps/user/files/story/progress').done(function(){EasySocial.Controller("Story.Files",{defaultOptions:{"{canvas}":"[data-files-canvas]","{dropsite}":"[data-files-dropsite]","{upload}":"[data-files-upload]","{uploadGroup}":"[data-files-items]","{fileItem}":"[data-files-item]","{removeItem}":"[data-files-item-remove]","{uploadItem}":"[data-files-upload-item]",settings:{url:null,max_file_size:null,filters:[]},view:{attachment:"apps/user/files/story/attachment.item",progress:"apps/user/files/story/progress"}}},function(self){return{items:{},init:function(){var options=$.extend({"{uploadButton}":self.upload.selector,"{uploadDropsite}":self.dropsite.selector},{"settings":self.options.settings});self.uploader=self.canvas().addController('plupload',options);self.plupload=self.uploader.plupload;self.addPlugin("uploader",self.uploader);if(!$.IE&&self.plupload.runtime=="html5"){self.canvas().addClass("can-drop-file")}
self.canvas().addClass("can-upload");self.setLayout()},hasItems:function(){var hasItem=self.fileItem().length>0,hasUploadItem=self.uploadItem().length>0;return hasItem||hasUploadItem},setLayout:function(){self.canvas().toggleClass("has-items",self.hasItems())},removeFile:function(id){self.fileItem().where('id',id).remove();self.setLayout()},clearFiles:function(){self.fileItem().remove();self.uploadItem().remove();self.setLayout()},removeFileItem:function(id){var item=self.getItem(id);if(!item){return}
self.plupload.removeFile(item.file());item.element.remove();delete self.items[id];self.setLayout()},getItem:function(file){var id;if($.isString(file)){id=file}
if(file&&file.id){id=file.id}
return self.items[id]},createItem:function(file){var item=self.view.progress({file:file});self.uploadGroup().append(item);self.items[file.id]=item;self.setLayout();self.trigger("QueueCreated",[item]);return item},"{uploader}FilesAdded":function(el,event,uploader,files){try{files.reverse();$.each(files,function(i,file){if(self.getItem(file))return;self.createItem(file)})}catch(e){console.error(e)};self.setLayout();self.uploader.plupload.start()},"{uploader}FileUploaded":function(el,event,uploader,file,response){var progress=self.getItem(file),attachmentItem=self.view.attachment({"file":file,"id":response.id});attachmentItem.data('file-id',response.id).addClass('new-item').insertAfter(progress);progress.remove();self.setLayout();setTimeout(function(){attachmentItem.removeClass("new-item")},1)},"{uploader}UploadProgress":function(el,event,uploader,file){var item=self.getItem(file);if(!item){return}
var noFilesize=(file.size===undefined||file.size=="N/A");file.percentage=file.percent+"%";file.filesize=(noFilesize)?"":$.plupload.formatSize(file.size);file.remaining=(noFilesize)?"":$.plupload.formatSize(file.size-(file.loaded||0));var percentage=file.percentage;if(percentage=="100%"){percentage="99%"}
if(percentage=="0%"){percentage="1%"}
item.find('.upload-progress-bar').width(percentage);item.find('.upload-percentage').html(percentage)},"{uploader}FileError":function(el,event,uploader,file,response){self.story.setMessage(response.message,"error");var uploadingFile=self.uploadingFile;if(uploadingFile){uploadingFile.reject();delete self.uploadingFile}
self.setLayout()},"{uploader}Error":function(el,event,uploader,error){self.story.setMessage(error.message,"error");var uploadingFile=self.uploadingFile;if(uploadingFile){uploadingFile.reject();delete self.uploadingFile}
self.removeItem().click(function(){setTimeout(function(){self.setLayout()},1)});self.setLayout()},"{removeItem}click":function(el){var id=el.parent(self.fileItem.selector).data('id');self.removeFile(id)},"{story}save":function(element,event,save){if(!self.hasItems()){return}
self.uploadingFile=save.addTask('uploadingFile');self.save()},save:function(){var uploadingFile=self.uploadingFile;if(!uploadingFile){return}
var items=self.fileItem();if(items.length){var files=[]
save=uploadingFile.save;items.each(function(){files.push($(this).data('id'))});save.addData(self,files);uploadingFile.resolve();delete self.uploadingFile}},"{story}clear":function(){self.clearFiles()}}});module.resolve()})});EasySocial.module("story/friends",function($){var module=this;EasySocial.require().library("textboxlist").language("COM_EASYSOCIAL_STREAM_STORY_WITH","COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER","COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER","COM_EASYSOCIAL_AND").done(function(){EasySocial.Controller("Story.Friends",{defaultOptions:{"{friendList}":".es-story-friends-textbox","{textField}":".es-story-friends-textbox[data-textboxlist-textfield]"}},function(self){return{init:function(){self.textField().placeholder();self.friendList().textboxlist({component:'es',plugin:{autocomplete:{exclusive:!0,cache:!1,query:self.search,filterItem:self.createMenuItem,component:"es",modifier:"es-story-friends-autocomplete",sticky:!0,shadow:!0}}})},search:function(keyword){var users=self.getTaggedUsers();return EasySocial.ajax("site/controllers/friends/suggest",{"search":keyword,"exclude":users})},getTaggedUsers:function(){var users=[];var items=$("[data-textboxlist-item]");if(items.length>0)
{$.each(items,function(idx,element){users.push($(element).data('id'))})}
return users},createMenuItem:function(item,keyword){item.title=item.screenName;var avatar=$(new Image()).addClass("textboxlist-menu-avatar").attr({src:item.avatar}).toHTML();item.html=avatar+' '+item.title;item.menuHtml=avatar+' '+item.title;return item},mention:function(mode,query,callback){self.search(query).done(function(users){var friends=[];$.each(users,function(i,user)
{friends.push({id:user.id,name:user.screenName,avatar:user.avatar,type:'contact'})});callback(friends)})},updateMeta:function(){var friendList=self.friendList().controller("textboxlist"),friends=friendList.getAddedItems();if(friends.length<1){self.story.setMeta("friends","");return}
var last=friends.length-1,caption=$.language("COM_EASYSOCIAL_STREAM_STORY_WITH")+" ";$.each(friends,function(i,friend){caption+='<a href="'+friend.permalink+'" target="_blank">'+friend.screenName+"</a>";if(i!=last){var joiner=$.language("COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER");if(i==last-1){joiner=$.language("COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER")}
caption+=joiner}});self.story.setMeta("friends",caption)},"{friendList}addItem":function(){self.updateMeta()},"{friendList}removeItem":function(){self.updateMeta()},"{story}activateMeta":function(el,event,meta){if(meta.name==="friends"){setTimeout(function(){self.textField().focus()},1)}},"{story}save":function(el,event,save){var friendList=self.friendList().controller("textboxlist");var tags=friendList.getAddedItems().map(function(friend){return friend.id});save.data['friends_tags']=tags},"{story}clear":function(){var friendList=self.friendList().controller("textboxlist");friendList.clearItems()}}});module.resolve()})});EasySocial.module("story/links",function($){var module=this;EasySocial.require().view("apps/user/links/story/attachment.item").done(function(){EasySocial.Controller("Story.Links",{defaultOptions:{view:{linkItem:"apps/user/links/story/attachment.item"},urlParser:/(^|\s)(https?:\/\/)?(([a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.([a-z]{2,5}))|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))(:[0-9]{1,5})?(\/.*)?/gi,"{linkForm}":"[data-story-link-form]","{linkInput}":"[data-story-link-input]","{linkContent}":"[data-story-link-content]","{linkItem}":"[data-story-link-item]","{linkTitle}":"[data-story-link-title]","{linkDescription}":"[data-story-link-description]","{linkImages}":"[data-story-link-images]","{linkImage}":"[data-story-link-image]","{linkVideo}":"[data-story-link-video]","{titleTextfield}":"[data-story-link-title-textfield]","{descriptionTextfield}":"[data-story-link-description-textfield]","{panelButton}":"[data-story-link-panel-button]","{attachButton}":"[data-story-link-attach-button]","{removeButton}":"[data-story-link-remove-button]","{removeThumbnail}":"[data-story-link-remove-image]"}},function(self)
{return{init:function()
{self.linkInput().placeholder()},activateAttachment:function(){if(self.doNotFocus)return;setTimeout(function(){self.linkInput().focus();self.doNotFocus=!1},500)},links:{},currentLink:null,crawling:!1,extractUrls:function(str){var urlParser=self.options.urlParser,urls=str.match(urlParser);if($.isArray(urls)){return $.map(urls,function(url,i){return $.trim(url)})}else{return[]}},fixUrl:function(url){var url=$.uri(url);if(!/http|https/.test(url.protocol())){url.setProtocol("http")}
return url.toString()},getLink:function(urls){if($.isString(urls)){urls=self.extractUrls(urls)}
if(urls.length<0)return;var url=urls[0];link=self.links[url]||self.createLink(url);return link},createLink:function(url){var link=self.links[url]=$.Deferred();link.url=url;self.crawling=!0;EasySocial.ajax("site/controllers/crawler/fetch",{urls:[url]}).done(function(links)
{var info=links[url];if(!info)
{link.reject()}
link.info=info;var og=info.opengraph||{},oembed=info.oembed||{};var image=[];if(oembed.thumbnail){image.push(oembed.thumbnail)}
if(og.image){image.push(og.image)}
if(info.images){$.merge(image,info.images)}
link.data={title:oembed.title||og.title||info.title,desc:oembed.description||og.desc||info.description,url:url,images:image,video:(og.video)?og.video:info.videos};link.item=self.view.linkItem(link.data).data("link",link)
link.item.addController("EasySocial.Controller.Story.Links.Item");link.resolve(link)}).fail(function(){link.reject()}).always(function(){self.crawling=!1});return link},addLink:function(link){self.linkContent().empty().append(link.item);self.linkForm().hide();self.currentLink=link},removeLink:function(){self.linkItem().detach();self.linkForm().show();self.currentLink=null},"{attachButton}click":function()
{var linkInput=self.linkInput(),linkForm=self.linkForm(),url=$.trim(self.linkInput().val());if(url==="")return;var url=self.fixUrl(url);self.linkInput().val(url);linkForm.addClass("busy");self.getLink(url).done(function(link){self.addLink(link)}).always(function(){linkForm.removeClass("busy")})},"{removeButton}click":function(button){self.currentLink.disabled=!0;self.removeLink()},"{story.textField}input":$._.debounce(function(textField,event)
{if(self.currentLink||self.crawling)return;var content=textField.val(),urls=self.extractUrls(content),url=urls[urls.length-1];if(!url)return;var url=self.fixUrl(url),link=self.links[url];if(link&&link.disabled)return;self.linkInput().val(url);self.doNotFocus=!0;self.panelButton().click();self.attachButton().click()},750),"{story}save":function(element,event,save)
{if(!self.currentLink)
{return}
var data={title:self.titleTextfield().val(),description:self.descriptionTextfield().val(),url:self.currentLink.url,video:self.linkVideo().val()};if(!self.removeThumbnail().is(":checked"))
{data.image=self.linkImage(".active").attr("src")}
save.addData(self,data)},"{story}clear":function(){self.linkInput().val("");self.removeLink()}}});EasySocial.Controller('Story.Links.Item',{defaultOptions:{"{previousImage}":"[data-story-link-image-prev]","{nextImage}":"[data-story-link-image-next]","{image}":"[data-story-link-image]","{imagesWrapper}":"[data-story-link-images]","{imageIndex}":"[data-story-link-image-index]","{removeThumbnail}":"[data-story-link-remove-image]","{title}":"[data-story-link-title]","{description}":"[data-story-link-description]","{titleTextfield}":"[data-story-link-title-textfield]","{descriptionTextfield}":"[data-story-link-description-textfield]"}},function(self){return{init:function()
{},"{removeThumbnail}click":function()
{var isChecked=self.removeThumbnail().is(':checked');if(isChecked)
{self.imagesWrapper().hide()}
else{self.imagesWrapper().show()}
self.element.toggleClass("has-images",!isChecked)},"{previousImage}click":function()
{var prevImage=self.image('.active').prev(),currentImage=self.image('.active'),index=parseInt(self.imageIndex().html()),nextIndex=index-1;if(prevImage.length>0)
{$(currentImage).removeClass('active');$(prevImage).addClass('active');self.imageIndex().html(nextIndex)}
else{}},"{nextImage}click":function()
{var nextImage=self.image('.active').next(),currentImage=self.image('.active'),index=parseInt(self.imageIndex().html()),nextIndex=index+1;if(nextImage.length>0)
{$(currentImage).removeClass('active');$(nextImage).addClass('active');self.imageIndex().html(nextIndex)}
else{}},"{title}click":function(){var editingTitle=self.element.hasClass("editing-title");self.element.toggleClass("editing-title",!editingTitle);if(!editingTitle){self.editTitle()}},editTitleEvent:"click.es.story.editLinkTitle",editTitle:function(){self.element.addClass("editing-title");setTimeout(function(){self.titleTextfield().val(self.title().text()).focus()[0].select();$(document).on(self.editTitleEvent,function(event){if(event.target!==self.titleTextfield()[0]){self.saveTitle("save")}})},1)},saveTitle:function(operation){if(!operation)operation=save;var value=self.titleTextfield().val();switch(operation){case "save":if(value===""){value=self.title().data("default")}
self.title().html(value);break;case "revert":break}
self.element.removeClass("editing-title");$(document).off(self.editTitleEvent)},"{titleTextfield}keyup":function(el,event){if(event.keyCode==27){self.saveTitle("revert")}},"{description}click":function(){var editingDescription=self.element.hasClass("editing-description");self.element.toggleClass("editing-description",!editingDescription);if(!editingDescription){self.editDescription()}},editDescriptionEvent:"click.es.story.editLinkDescription",editDescription:function(){self.element.addClass("editing-description");setTimeout(function(){var descriptionClone=self.description().clone(),noDescription=descriptionClone.hasClass("no-description");descriptionClone.wrapInner(self.descriptionTextfield());if(noDescription){self.descriptionTextfield().val("")}
self.descriptionTextfield().focus()[0].select();$(document).on(self.editDescriptionEvent,function(event){if(event.target!==self.descriptionTextfield()[0]){self.saveDescription("save")}})},1)},saveDescription:function(operation)
{if(!operation)operation=save;var value=self.descriptionTextfield().val().replace(/\n/g,"<br/>");switch(operation){case "save":var noValue=(value==="");self.description().toggleClass("no-description",noValue);if(noValue){value=self.descriptionTextfield().attr("placeholder")}
self.description().html(value);break;case "revert":break}
self.element.find(".textareaClone").remove();self.element.removeClass("editing-description");$(document).off(self.editDescriptionEvent)},"{descriptionTextfield}keyup":function(el,event){if(event.keyCode==27){self.saveDescription("revert")}}}});module.resolve()})});EasySocial.module("story/locations",function($){var module=this;EasySocial.require().library("gmaps","scrollTo").view("site/location/story.suggestion").language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT").done(function(){var KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller("Story.Locations",{defaultOptions:{view:{suggestion:"site/location/story.suggestion"},map:{lat:0,lng:0},"{base}":"[data-story-location]","{form}":"[data-story-location-form]","{textField}":"[data-story-location-textField]","{detectButton}":"[data-story-location-detect-button]","{autocomplete}":"[data-story-location-autocomplete]","{suggestions}":"[data-story-location-suggestions]","{suggestion}":"[data-story-location-suggestion]","{textbox}":"[data-story-location-textbox]","{removeButton}":"[data-story-location-remove-button]","{map}":"[data-story-location-map]","{mapImage}":"[data-story-location-map-image]","{meta}":"[data-story-meta-location]",}},function(self,opts){return{init:function(){if(navigator.geolocation){self.base().addClass("is-detectable")}
self.textField().placeholder();self.textField().removeAttr("disabled")},"{window}resize":$.debounce(function(){var currentLocation=self.currentLocation;if(!currentLocation)return;var mapImage=self.mapImage();if(mapImage.data("width")!==mapImage.width()){var coords=currentLocation.geometry.location,lat=coords.lat(),lng=coords.lng();self.navigate(lat,lng)}},250),navigate:function(lat,lng){var mapImage=self.mapImage(),width=mapImage.width(),height=mapImage.height(),url=$.GMaps.staticMapURL({size:[width,height],lat:lat,lng:lng,markers:[{lat:lat,lng:lng}]});mapImage.attr("src",url).data({width:width,height:height});self.base().addClass("has-location")},locations:{},lastQueryAddress:null,"{textField}keypress":function(textField,event){switch(event.keyCode)
{case KEYCODE.UP:var prevSuggestion=$(self.suggestion(".active").prev(self.suggestion.selector)[0]||self.suggestion(":last")[0]);self.suggestion().removeClass("active");prevSuggestion.addClass("active").trigger("activate");self.suggestions().scrollTo(prevSuggestion,{offset:prevSuggestion.height()*-1});event.preventDefault();break;case KEYCODE.DOWN:var nextSuggestion=$(self.suggestion(".active").next(self.suggestion.selector)[0]||self.suggestion(":first")[0]);self.suggestion().removeClass("active");nextSuggestion.addClass("active").trigger("activate");self.suggestions().scrollTo(nextSuggestion,{offset:nextSuggestion.height()*-1});event.preventDefault();break;case KEYCODE.ENTER:var activeSuggestion=self.suggestion(".active"),location=activeSuggestion.data("location");self.set(location);self.hideSuggestions();break;case KEYCODE.ESCAPE:self.hideSuggestions();break}},"{textField}keyup":function(textField,event){switch(event.keyCode){case KEYCODE.UP:case KEYCODE.DOWN:case KEYCODE.LEFT:case KEYCODE.RIGHT:case KEYCODE.ENTER:case KEYCODE.ESCAPE:break;default:var address=$.trim(textField.val());if(address===""){self.base().removeClass("has-location");self.hideSuggestions()}
var locations=self.locations[address];if(locations){self.lastQueryAddress=address;self.suggest(locations)}else{self.lookup(address)}
break}},lookup:$.debounce(function(address){self.base().addClass("is-busy");$.GMaps.geocode({address:address,callback:function(locations,status){self.base().removeClass("is-busy");if(status=="OK"){self.locations[address]=locations;self.suggest(locations);self.lastQueryAddress=address}}})},250),suggest:function(locations){var suggestions=self.suggestions();suggestions.empty();if(locations.length<0)return;$.each(locations,function(i,location){self.view.suggestion({location:location}).data("location",location).appendTo(suggestions)});self.showSuggestions()},showSuggestions:function(){self.focusSuggestion=!0;self.element.find(".es-story-footer").addClass("swap-zindex");self.story.clearMessage();setTimeout(function(){self.autocomplete().addClass("active");var doc=$(document),hideOnClick="click.es.story.location";doc.off(hideOnClick).on(hideOnClick,function(event){var targets=$(event.target).parents().andSelf();if(targets.filter(self.element).length>0)return;doc.off(hideOnClick);self.hideSuggestions()})},500)},hideSuggestions:function(){self.focusSuggestion=!1;self.autocomplete().removeClass("active");$(document).off("click.es.story.location");setTimeout(function(){if(self.focusSuggestion)return;self.element.find(".es-story-footer").removeClass("swap-zindex")},500)},"{suggestion}activate":function(suggestion,event){var location=suggestion.data("location");self.navigate(location.geometry.location.lat(),location.geometry.location.lng())},"{suggestion}mouseover":function(suggestion){self.suggestion().removeClass("active");suggestion.addClass("active").trigger("activate")},"{suggestion}click":function(suggestion,event){var location=suggestion.data("location");self.set(location);self.hideSuggestions()},set:function(location){self.currentLocation=location;var lat=location.geometry.location.lat(),lng=location.geometry.location.lng();self.navigate(lat,lng);var address=location.formatted_address;self.textField().val(address);self.lastQueryAddress=address;var link=$('<a href="javascript:void(0);" data-story-meta-location>').html(address).toHTML(),caption=$.language("COM_EASYSOCIAL_STREAM_AT")+" "+link;self.story.setMeta("location",caption);self.base().addClass("has-location")},unset:function(){self.currentLocation=null;self.textField().val('');self.story.removePanelCaption("locations");self.mapImage().attr("src","");self.story.setMeta("location","");self.base().removeClass("has-location")},activatePanel:function(){setTimeout(function(){self.textField().focus()},500)},deactivatePanel:function(){var location=self.currentLocation;if(location){self.set(location)}},detectTimer:null,"{detectButton}click":function(){var story=self.story,textbox=self.textbox();self.base().addClass("is-busy");clearTimeout(self.detectTimer);self.detectTimer=setTimeout(function(){story.clearMessage();story.setMessage($.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR"));self.base().removeClass("is-busy")},8000);$.GMaps.geolocate({success:function(position){$.GMaps.geocode({lat:position.coords.latitude,lng:position.coords.longitude,callback:function(locations,status){if(status=="OK"){self.suggest(locations);self.textField().focus()}}})},error:function(error){story.clearMessage();var message="";switch(error.code){case 1:message=$.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:message=$.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:message=$.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR");break}
story.setMessage(message)},always:function(){clearTimeout(self.detectTimer);self.base().removeClass("is-busy")}})},"{removeButton}click":function(){self.unset();self.hideSuggestions()},"{meta}click":function(){self.story.activateMeta("location")},"{story}activateMeta":function(el,event,meta){if(meta.name==="location"){setTimeout(function(){self.textField().focus()},1)}},"{story}save":function(event,element,save){var currentLocation=self.currentLocation;if(!currentLocation)return;save.data['locations_short_address']=currentLocation.address_components[0].long_name;save.data['locations_formatted_address']=currentLocation.formatted_address;save.data['locations_lat']=currentLocation.geometry.location.lat();save.data['locations_lng']=currentLocation.geometry.location.lng();save.data['locations_data']=JSON.stringify(currentLocation)},"{story}clear":function(){self.unset();self.hideSuggestions()}}});module.resolve()})});EasySocial.module("story/mood",function($){var module=this;EasySocial.require().language("COM_EASYSOCIAL_MOOD_FEELING_CUSTOM").done(function(){var KEYCODE={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller("Story.Mood",{defaultOptions:{"{base}":"[data-story-mood]","{presets}":"[data-story-mood-presets]","{preset}":"[data-story-mood-preset]","{verb}":"[data-story-mood-verb]","{verbType}":"[data-story-mood-verb-type]","{textField}":"[data-story-mood-textfield]","{removeButton}":"[data-story-mood-remove-button]"}},function(self,opts){return{init:function(){self.reset();self.textField().placeholder()},setLayout:function(){var base=self.base(),textField=self.textField();base.toggleClass("is-empty",textField.val()==="")},currentMood:{},resetMood:function(){self.currentMood={icon:'',verb:'',subject:'',text:'',custom:!1};self.preset().removeClass("is-disabled");self.story.setMeta("mood","")},setMood:function(type,content){var currentMood=self.currentMood;if($.isPlainObject(type)){$.extend(currentMood,type)}else{currentMood[type]=content}
self.base().toggleClass("using-preset",!currentMood.custom);self.updateMeta();self.setLayout()},getVerb:function(){return self.verbType(".active").data("storyMoodVerbType")||"feeling"},reset:function(){self.selecting=!0;self.resetMood();self.preset().removeClass("is-disabled");self.textField().val("").focus();self.setLayout();self.base().removeClass("using-preset hide-preset");self.selecting=!1},updateMeta:function(){var currentMood=self.currentMood,icon=currentMood.icon?'<i class="es-emoticon '+currentMood.icon+'"></i>':'';self.verbType().removeClass("active").filterBy("storyMoodVerbType",currentMood.verb).addClass("active");self.story.setMeta("mood",icon+currentMood.text)},"{preset}click":function(preset){var mood={icon:preset.data("storyMoodIcon"),verb:preset.data("storyMoodVerb"),subject:preset.data("storyMoodSubject"),text:preset.data("storyMoodText"),subjectText:preset.data("storyMoodSubjectText"),custom:!1,};self.selecting=!0;self.textField().val(mood.subjectText).focus();self.setMood(mood);self.selecting=!1},"{textField}keydown":function(textField,event){self.update()},"{textField}keyup":function(textField,event){self.update()},"{textField}input":function(textField,event){if(self.selecting)return;var text=textField.val();if(!text){self.reset();return}
var currentMood=self.currentMood,presetModified=!currentMood.custom&&(text!==currentMood.subjectText);if(presetModified){self.setMood("custom",!0)}
var candidates=self.preset().filter(function(){var preset=$(this),isDisabled=preset.data("storyMoodSubjectText").indexOf(text)!==0;preset.toggleClass("is-disabled",isDisabled);return!isDisabled});self.base().toggleClass("hide-preset",candidates.length<1);var verb=self.getVerb(),mood={verb:verb,subject:'',custom:!0,text:$.language("COM_EASYSOCIAL_MOOD_"+verb.toUpperCase()+"_CUSTOM",text),};self.setMood(mood)},"{removeButton}click":function(){self.reset()},"{story}activateMeta":function(el,event,meta){if(meta.name==="mood"){setTimeout(function(){self.textField().focus()},1)}},"{story}save":function(event,element,save){var currentMood=self.currentMood;if(!currentMood.verb)return;save.data.mood_icon=currentMood.icon;save.data.mood_verb=currentMood.verb;save.data.mood_subject=currentMood.subject;save.data.mood_custom=currentMood.custom;save.data.mood_text=currentMood.text},"{story}clear":function(){self.reset()}}});module.resolve()})});EasySocial.module("story/photos",function($){var module=this;EasySocial.require().script("albums/uploader").done(function(){EasySocial.Controller("Story.Photos",{defaultOptions:{"{albumView}":"[data-album-view]","{albumContent}":"[data-album-content]","{uploadButton}":"[data-album-upload-button]","{photoItemGroup}":"[data-photo-item-group]","{photoItem}":"[data-photo-item]","{photoImage}":"[data-photo-image]","{photoRemoveButton}":"[data-photo-remove-button]","{uploadItem}":"[data-photo-upload-item]","{uploadRemoveButton}":".upload-remove-button",}},function(self){return{init:function(){self.uploader=self.albumView().addController(EasySocial.Controller.Albums.Uploader,$.extend({"{uploadButton}":self.uploadButton.selector,"{uploadItemGroup}":self.photoItemGroup.selector,"{uploadDropsite}":self.albumContent.selector},{settings:self.options.uploader}));self.photoItemGroup().css("opacity",1);self.addPlugin("uploader",self.uploader);self.setLayout()},hasItems:function(){var hasPhotoItem=self.photoItem().length>0,hasUploadItem=self.uploadItem().length>0;return hasPhotoItem||hasUploadItem},setLayout:function(){self.albumView().toggleClass("has-photos",self.hasItems())},activateAttachment:function(){},removePhoto:function(id){self.photoItem().filterBy('photoId',id).remove();self.setLayout()},clearPhoto:function(){self.photoItem().remove();self.uploadItem().remove();self.setLayout()},"{uploader}FilesAdded":function(){self.setLayout();self.uploader.start()},"{uploader}FileUploaded":function(el,event,uploader,file,response){var uploadItem=self.uploader.getItem(file),photoItem=$($.parseHTML($.trim(response.html)));photoData=response.data;photoItem.data("photo",photoData).addClass("new-item").insertAfter(uploadItem.element);self.uploader.removeItem(file.id);self.setLayout();setTimeout(function(){photoItem.removeClass("new-item")},1);self.save()},"{uploader}FileError":function(el,event,uploader,file,response){self.story.setMessage(response.message,"error");var uploadingPhoto=self.uploadingPhoto;if(uploadingPhoto){uploadingPhoto.reject();delete self.uploadingPhoto}
self.uploader.removeItem(file.id);self.setLayout()},"{uploader}Error":function(el,event,uploader,error){self.story.setMessage(error.message,"error");var uploadingPhoto=self.uploadingPhoto;if(uploadingPhoto){uploadingPhoto.reject();delete self.uploadingPhoto}
self.uploadRemoveButton().click(function(){setTimeout(function(){self.setLayout()},1)});self.setLayout()},"{photoRemoveButton}click":function(photoRemoveButton){var photoId=photoRemoveButton.parent(self.photoItem.selector).data("photoId");self.removePhoto(photoId)},"{story}save":function(element,event,save){if(!self.hasItems())return;self.uploadingPhoto=save.addTask("uploadingPhoto");self.save()},save:function(){var uploadingPhoto=self.uploadingPhoto;if(!uploadingPhoto)return;var uploadItems=self.uploadItem();if(uploadItems.length<1){var photos=[],save=uploadingPhoto.save;self.photoItem().each(function(){photos.push($(this).data("photoId"))});save.addData(self,photos);uploadingPhoto.resolve();delete self.uploadingPhoto}},"{story}clear":function(){self.clearPhoto()}}});module.resolve()})});EasySocial.module('story/tasks',function($)
{var module=this;EasySocial.require().view('apps/group/tasks/story/attachment.item').done(function()
{EasySocial.Controller('Story.Tasks',{defaultOptions:{view:{taskItem:"apps/group/tasks/story/attachment.item"},'{form}':'[data-story-tasks-form]','{input}':'[data-story-tasks-input]','{list}':'[data-story-tasks-list]','{milestone}':'[data-story-tasks-milestone]'}},function(self)
{return{init:function()
{self.implementForm()},implementForm:function()
{self.form().implement(EasySocial.Controller.Story.Tasks.Form,{'{parent}':self})},createInputRow:function(currentElement)
{var item=self.view.taskItem();$(item).implement(EasySocial.Controller.Story.Tasks.Form,{'{parent}':self}).appendTo(self.list());$(item).find('input').focus()},"{story}save":function(element,event,save)
{var values=new Array();$.each(self.input(),function(i,item)
{if($(item).val()!='')
{values.push($(item).val())}});var data={items:values,milestone:self.milestone().val()};save.addData(self,data)},"{story}clear":function()
{}}});EasySocial.Controller('Story.Tasks.Form',{defaultOptions:{'{input}':'[data-story-tasks-input]','{remove}':'[data-story-tasks-remove]'}},function(self)
{return{init:function()
{},'{input}keyup':function(el,event)
{if(event.keyCode==13)
{self.parent.createInputRow(self.element)}},'{remove}click':function(el,event)
{self.element.remove()}}});module.resolve()})});EasySocial.module('stream',function(){var module=this;EasySocial.require().library('dialog').script('comment').view('site/likes/item').language('COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE','COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE','COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK','COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT','COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL','COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE','COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE','COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBSCRIBE','COM_EASYSOCIAL_STREAM_DIALOG_FEED','COM_EASYSOCIAL_STREAM_BUTTON_CLOSE').done(function($){EasySocial.Controller('Stream.Item',{defaultOptions:{id:'','{streamItem}':'.streamItem','{streamData}':'.streamData','{streamResponds}':'.stream-responds','{likeItem}':'.likeItem','{likeItemList}':'.likeItemList','{commentLink}':'.commentLink','{commentFrame}':'.commentFrame','{commentInput}':'.commentInput','{followItem}':'.followItem','{unfollowItem}':'.unfollowItem','{hideItem}':'.hideItem','{unhideItem}':'.unhideItem'}},function(self){return{init:function(){self.commentFrame().implement('EasySocial.Controller.Comments',{uid:self.element.data('id'),pagination:new CommentPagination({total:self.commentFrame().data('total')}),commentlist:new Comment.List()})},"{likeItem}click":function(){EasySocial.ajax('site:/controllers/likes/toggle',{'id':self.element.data('id'),'type':'stream'},{success:function(obj){var content='';if(obj.likeCount>0)
{content=self.view.likeitem({likeCount:obj.likeCount});content.find(".likeText").html(obj.message)}
self.likeItemList().html(content);self.likeItem().text(obj.label)},fail:function(){}})},"{unfollowItem}click":function(){var subId=self.element.data('sid');if(subId)
{$.dialog({title:$.language('COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE'),content:$.language('COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE'),buttons:[{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE'),click:function(){EasySocial.ajax('site:/controllers/subscriptions/remove',{'id':subId},{success:function(obj){$.dialog({title:$.language('COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE'),content:obj.message,buttons:[{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK'),click:function(){self.unfollowItem().removeClass('unfollowItem');$.dialog().close()}}]})},fail:function(){}})}},{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL'),click:function(){$.dialog().close()}}]})}},"{followItem}click":function(){EasySocial.ajax('site:/controllers/subscriptions/form',{'contentId':self.element.data('id'),'contentType':'stream'},{success:function(obj){if(obj.message!='')
{$.dialog({title:$.language('COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE'),content:obj.message,buttons:[{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL'),click:function(){$.dialog().close()}}]});return}
$.dialog({title:$.language('COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE'),content:obj.htmlform,buttons:[{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT'),click:function(){var fullname=$('#esfullname').val();var email=$('#email').val();EasySocial.ajax('site:/controllers/subscriptions/add',{'contentId':self.element.data('id'),'contentType':'stream','esfullname':fullname,'email':email},{success:function(obj){$.dialog({title:$.language('COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE'),content:obj.message,buttons:[{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK'),click:function(){self.followItem().removeClass('followItem');$.dialog().close()}}]})},fail:function(){}})}},{name:$.language('COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL'),click:function(){$.dialog().close()}}]})},fail:function(){}})},"{hideItem}click":function(){EasySocial.ajax('site:/controllers/stream/hide',{'id':self.element.data('id')},{success:function(obj)
{var content='<div>'+obj.message+'</div>';self.streamData().hide();self.element.append(content)},fail:function(obj)
{$.dialog({title:$.language('COM_EASYSOCIAL_STREAM_DIALOG_FEED'),content:obj.message,buttons:[{name:$.language('COM_EASYSOCIAL_STREAM_BUTTON_CLOSE'),click:function(){$.dialog().close()}}]})}})},"{unhideItem}click":function(){EasySocial.ajax('site:/controllers/stream/unhide',{'id':self.element.data('id')},{success:function(obj)
{self.streamData().show();self.element.children().last().remove()},fail:function(obj)
{$.dialog({title:$.language('COM_EASYSOCIAL_STREAM_DIALOG_FEED'),content:obj.message,buttons:[{name:$.language('COM_EASYSOCIAL_STREAM_BUTTON_CLOSE'),click:function(){$.dialog().close()}}]})}})},"{commentLink}click":function(){self.commentInput().focus()}}});module.resolve()})});EasySocial.module('tab',function($){var module=this;EasySocial.Controller('Tab',{defaultOptions:{view:{},"{tabs}":'','{tabsContent}':'','{defaultActive}':''}},function(self){return{init:function()
{console.log('Tabs loaded');self.defaultActive().click()},'{tabs}click':function(element){if($(element).hasClass('inactive'))
{return!1}
self.tabs('.active').removeClass('active');$(element).addClass('active');self.tabsContent().hide();var activeContent='.tab-'+$(element).attr('id');self.tabsContent(activeContent).show()}}});module.resolve()});EasySocial.module('toggle',function($){var module=this;EasySocial.Controller('Toggle',{defaultOptions:{view:{},'{selector}':""}},function(self){return{init:function()
{console.log('Toggle loaded')},'{selector}click':function(element){$(element).next().toggle();$(element).toggleClass('this-closed')}}});module.resolve()});EasySocial.module('uploader/item',function($){var module=this;EasySocial.require().view('site/uploader/preview').done(function($){EasySocial.Controller('Uploader.Item',{defaults:{"{uploadItem}":".uploadItem","{uploadItemPreview}":".uploadItem.preview a.itemLink","{itemLink}":'.itemLink',"{itemDelete}":'.itemDelete',view:{preview:'site/uploader/preview'}}},function(self){return{init:function(){},"{itemDelete}click":function(el){var id=$(el).data('id');EasySocial.ajax('site:/controllers/uploader/delete',{'id':id},function(){$(el).parents('li.uploadItem').remove()})},"{uploadItemPreview}click":function(el){var uri=$(el).data('uri'),title=$(el).data('title');$.dialog({title:title,content:$.Image.get(uri)})}}})});module.resolve()})})
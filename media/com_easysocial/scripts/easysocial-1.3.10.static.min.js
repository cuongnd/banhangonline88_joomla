!function(){function e(e){var t=e.length,i=ie.type(e);return"function"!==i&&!ie.isWindow(e)&&(!(1!==e.nodeType||!t)||("array"===i||0===t||"number"==typeof t&&t>0&&t-1 in e))}function t(e,t,i){if(ie.isFunction(t))return ie.grep(e,function(e,n){return!!t.call(e,n,e)!==i});if(t.nodeType)return ie.grep(e,function(e){return e===t!==i});if("string"==typeof t){if(de.test(t))return ie.filter(t,e,i);t=ie.filter(t,e)}return ie.grep(e,function(e){return ie.inArray(e,t)>=0!==i})}function i(e,t){do{e=e[t]}while(e&&1!==e.nodeType);return e}function n(e){var t=ve[e]={};return ie.each(e.match(ge)||[],function(e,i){t[i]=!0}),t}function o(){pe.addEventListener?(pe.removeEventListener("DOMContentLoaded",a,!1),window.removeEventListener("load",a,!1)):(pe.detachEvent("onreadystatechange",a),window.detachEvent("onload",a))}function a(){(pe.addEventListener||"load"===event.type||"complete"===pe.readyState)&&(o(),ie.ready())}function r(e,t,i){if(void 0===i&&1===e.nodeType){var n="data-"+t.replace(Ce,"-$1").toLowerCase();if("string"==typeof(i=e.getAttribute(n))){try{i="true"===i||"false"!==i&&("null"===i?null:+i+""===i?+i:Se.test(i)?ie.parseJSON(i):i)}catch(e){}ie.data(e,t,i)}else i=void 0}return i}function s(e){var t;for(t in e)if(("data"!==t||!ie.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function l(e,t,i,n){if(ie.acceptData(e)){var o,a,r=ie.expando,s=e.nodeType,l=s?ie.cache:e,c=s?e[r]:e[r]&&r;if(c&&l[c]&&(n||l[c].data)||void 0!==i||"string"!=typeof t)return c||(c=s?e[r]=Y.pop()||ie.guid++:r),l[c]||(l[c]=s?{}:{toJSON:ie.noop}),"object"!=typeof t&&"function"!=typeof t||(n?l[c]=ie.extend(l[c],t):l[c].data=ie.extend(l[c].data,t)),a=l[c],n||(a.data||(a.data={}),a=a.data),void 0!==i&&(a[ie.camelCase(t)]=i),"string"==typeof t?null==(o=a[t])&&(o=a[ie.camelCase(t)]):o=a,o}}function c(e,t,i){if(ie.acceptData(e)){var n,o,a=e.nodeType,r=a?ie.cache:e,l=a?e[ie.expando]:ie.expando;if(r[l]){if(t&&(n=i?r[l]:r[l].data)){o=(t=ie.isArray(t)?t.concat(ie.map(t,ie.camelCase)):t in n?[t]:(t=ie.camelCase(t))in n?[t]:t.split(" ")).length;for(;o--;)delete n[t[o]];if(i?!s(n):!ie.isEmptyObject(n))return}(i||(delete r[l].data,s(r[l])))&&(a?ie.cleanData([e],!0):te.deleteExpando||r!=r.window?delete r[l]:r[l]=null)}}}function d(){return!0}function u(){return!1}function p(){try{return pe.activeElement}catch(e){}}function f(e){var t=Me.split("|"),i=e.createDocumentFragment();if(i.createElement)for(;t.length;)i.createElement(t.pop());return i}function m(e,t){var i,n,o=0,a=typeof e.getElementsByTagName!==be?e.getElementsByTagName(t||"*"):typeof e.querySelectorAll!==be?e.querySelectorAll(t||"*"):void 0;if(!a)for(a=[],i=e.childNodes||e;null!=(n=i[o]);o++)!t||ie.nodeName(n,t)?a.push(n):ie.merge(a,m(n,t));return void 0===t||t&&ie.nodeName(e,t)?ie.merge([e],a):a}function h(e){ke.test(e.type)&&(e.defaultChecked=e.checked)}function g(e,t){return ie.nodeName(e,"table")&&ie.nodeName(11!==t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function v(e){return e.type=(null!==ie.find.attr(e,"type"))+"/"+e.type,e}function y(e){var t=ze.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function E(e,t){for(var i,n=0;null!=(i=e[n]);n++)ie._data(i,"globalEval",!t||ie._data(t[n],"globalEval"))}function b(e,t){if(1===t.nodeType&&ie.hasData(e)){var i,n,o,a=ie._data(e),r=ie._data(t,a),s=a.events;if(s){delete r.handle,r.events={};for(i in s)for(n=0,o=s[i].length;n<o;n++)ie.event.add(t,i,s[i][n])}r.data&&(r.data=ie.extend({},r.data))}}function S(e,t){var i,n,o;if(1===t.nodeType){if(i=t.nodeName.toLowerCase(),!te.noCloneEvent&&t[ie.expando]){o=ie._data(t);for(n in o.events)ie.removeEvent(t,n,o.handle);t.removeAttribute(ie.expando)}"script"===i&&t.text!==e.text?(v(t).text=e.text,y(t)):"object"===i?(t.parentNode&&(t.outerHTML=e.outerHTML),te.html5Clone&&e.innerHTML&&!ie.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===i&&ke.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===i?t.defaultSelected=t.selected=e.defaultSelected:"input"!==i&&"textarea"!==i||(t.defaultValue=e.defaultValue)}}function C(e,t){var i=ie(t.createElement(e)).appendTo(t.body),n=window.getDefaultComputedStyle?window.getDefaultComputedStyle(i[0]).display:ie.css(i[0],"display");return i.detach(),n}function _(e){var t=pe,i=Je[e];return i||("none"!==(i=C(e,t))&&i||((t=((Ve=(Ve||ie("<iframe frameborder='0' width='0' height='0'/>")).appendTo(t.documentElement))[0].contentWindow||Ve[0].contentDocument).document).write(),t.close(),i=C(e,t),Ve.detach()),Je[e]=i),i}function w(e,t){return{get:function(){var i=e();if(null!=i)return i?void delete this.get:(this.get=t).apply(this,arguments)}}}function I(e,t){if(t in e)return t;for(var i=t.charAt(0).toUpperCase()+t.slice(1),n=t,o=lt.length;o--;)if((t=lt[o]+i)in e)return t;return n}function x(e,t){for(var i,n,o,a=[],r=0,s=e.length;r<s;r++)(n=e[r]).style&&(a[r]=ie._data(n,"olddisplay"),i=n.style.display,t?(a[r]||"none"!==i||(n.style.display=""),""===n.style.display&&Ie(n)&&(a[r]=ie._data(n,"olddisplay",_(n.nodeName)))):a[r]||(o=Ie(n),(i&&"none"!==i||!o)&&ie._data(n,"olddisplay",o?i:ie.css(n,"display"))));for(r=0;r<s;r++)(n=e[r]).style&&(t&&"none"!==n.style.display&&""!==n.style.display||(n.style.display=t?a[r]||"":"none"));return e}function k(e,t,i){var n=ot.exec(t);return n?Math.max(0,n[1]-(i||0))+(n[2]||"px"):t}function L(e,t,i,n,o){for(var a=i===(n?"border":"content")?4:"width"===t?1:0,r=0;a<4;a+=2)"margin"===i&&(r+=ie.css(e,i+we[a],!0,o)),n?("content"===i&&(r-=ie.css(e,"padding"+we[a],!0,o)),"margin"!==i&&(r-=ie.css(e,"border"+we[a]+"Width",!0,o))):(r+=ie.css(e,"padding"+we[a],!0,o),"padding"!==i&&(r+=ie.css(e,"border"+we[a]+"Width",!0,o)));return r}function A(e,t,i){var n=!0,o="width"===t?e.offsetWidth:e.offsetHeight,a=Xe(e),r=te.boxSizing()&&"border-box"===ie.css(e,"boxSizing",!1,a);if(o<=0||null==o){if(((o=Qe(e,t,a))<0||null==o)&&(o=e.style[t]),Ze.test(o))return o;n=r&&(te.boxSizingReliable()||o===e.style[t]),o=parseFloat(o)||0}return o+L(e,t,i||(r?"border":"content"),n,a)+"px"}function T(e,t,i,n,o){return new T.prototype.init(e,t,i,n,o)}function O(){return setTimeout(function(){ct=void 0}),ct=ie.now()}function D(e,t){var i,n={height:e},o=0;for(t=t?1:0;o<4;o+=2-t)n["margin"+(i=we[o])]=n["padding"+i]=e;return t&&(n.opacity=n.width=e),n}function M(e,t,i){for(var n,o=(ht[t]||[]).concat(ht["*"]),a=0,r=o.length;a<r;a++)if(n=o[a].call(i,t,e))return n}function R(e,t,i){var n,o,a,r,s,l,c,d,u=this,p={},f=e.style,m=e.nodeType&&Ie(e),h=ie._data(e,"fxshow");i.queue||(null==(s=ie._queueHooks(e,"fx")).unqueued&&(s.unqueued=0,l=s.empty.fire,s.empty.fire=function(){s.unqueued||l()}),s.unqueued++,u.always(function(){u.always(function(){s.unqueued--,ie.queue(e,"fx").length||s.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(i.overflow=[f.overflow,f.overflowX,f.overflowY],c=ie.css(e,"display"),d=_(e.nodeName),"none"===c&&(c=d),"inline"===c&&"none"===ie.css(e,"float")&&(te.inlineBlockNeedsLayout&&"inline"!==d?f.zoom=1:f.display="inline-block")),i.overflow&&(f.overflow="hidden",te.shrinkWrapBlocks()||u.always(function(){f.overflow=i.overflow[0],f.overflowX=i.overflow[1],f.overflowY=i.overflow[2]}));for(n in t)if(o=t[n],ut.exec(o)){if(delete t[n],a=a||"toggle"===o,o===(m?"hide":"show")){if("show"!==o||!h||void 0===h[n])continue;m=!0}p[n]=h&&h[n]||ie.style(e,n)}if(!ie.isEmptyObject(p)){h?"hidden"in h&&(m=h.hidden):h=ie._data(e,"fxshow",{}),a&&(h.hidden=!m),m?ie(e).show():u.done(function(){ie(e).hide()}),u.done(function(){var t;ie._removeData(e,"fxshow");for(t in p)ie.style(e,t,p[t])});for(n in p)r=M(m?h[n]:0,n,u),n in h||(h[n]=r.start,m&&(r.end=r.start,r.start="width"===n||"height"===n?1:0))}}function F(e,t){var i,n,o,a,r;for(i in e)if(n=ie.camelCase(i),o=t[n],a=e[i],ie.isArray(a)&&(o=a[1],a=e[i]=a[0]),i!==n&&(e[n]=a,delete e[i]),(r=ie.cssHooks[n])&&"expand"in r){a=r.expand(a),delete e[n];for(i in a)i in e||(e[i]=a[i],t[i]=o)}else t[n]=o}function N(e,t,i){var n,o,a=0,r=mt.length,s=ie.Deferred().always(function(){delete l.elem}),l=function(){if(o)return!1;for(var t=ct||O(),i=Math.max(0,c.startTime+c.duration-t),n=1-(i/c.duration||0),a=0,r=c.tweens.length;a<r;a++)c.tweens[a].run(n);return s.notifyWith(e,[c,n,i]),n<1&&r?i:(s.resolveWith(e,[c]),!1)},c=s.promise({elem:e,props:ie.extend({},t),opts:ie.extend(!0,{specialEasing:{}},i),originalProperties:t,originalOptions:i,startTime:ct||O(),duration:i.duration,tweens:[],createTween:function(t,i){var n=ie.Tween(e,c.opts,t,i,c.opts.specialEasing[t]||c.opts.easing);return c.tweens.push(n),n},stop:function(t){var i=0,n=t?c.tweens.length:0;if(o)return this;for(o=!0;i<n;i++)c.tweens[i].run(1);return t?s.resolveWith(e,[c,t]):s.rejectWith(e,[c,t]),this}}),d=c.props;for(F(d,c.opts.specialEasing);a<r;a++)if(n=mt[a].call(c,e,d,c.opts))return n;return ie.map(d,M,c),ie.isFunction(c.opts.start)&&c.opts.start.call(e,c),ie.fx.timer(ie.extend(l,{elem:e,anim:c,queue:c.opts.queue})),c.progress(c.opts.progress).done(c.opts.done,c.opts.complete).fail(c.opts.fail).always(c.opts.always)}function P(e){return function(t,i){"string"!=typeof t&&(i=t,t="*");var n,o=0,a=t.toLowerCase().match(ge)||[];if(ie.isFunction(i))for(;n=a[o++];)"+"===n.charAt(0)?(n=n.slice(1)||"*",(e[n]=e[n]||[]).unshift(i)):(e[n]=e[n]||[]).push(i)}}function B(e,t,i,n){function o(s){var l;return a[s]=!0,ie.each(e[s]||[],function(e,s){var c=s(t,i,n);return"string"!=typeof c||r||a[c]?r?!(l=c):void 0:(t.dataTypes.unshift(c),o(c),!1)}),l}var a={},r=e===jt;return o(t.dataTypes[0])||!a["*"]&&o("*")}function j(e,t){var i,n,o=ie.ajaxSettings.flatOptions||{};for(n in t)void 0!==t[n]&&((o[n]?e:i||(i={}))[n]=t[n]);return i&&ie.extend(!0,e,i),e}function U(e,t,i){for(var n,o,a,r,s=e.contents,l=e.dataTypes;"*"===l[0];)l.shift(),void 0===o&&(o=e.mimeType||t.getResponseHeader("Content-Type"));if(o)for(r in s)if(s[r]&&s[r].test(o)){l.unshift(r);break}if(l[0]in i)a=l[0];else{for(r in i){if(!l[0]||e.converters[r+" "+l[0]]){a=r;break}n||(n=r)}a=a||n}if(a)return a!==l[0]&&l.unshift(a),i[a]}function H(e,t,i,n){var o,a,r,s,l,c={},d=e.dataTypes.slice();if(d[1])for(r in e.converters)c[r.toLowerCase()]=e.converters[r];for(a=d.shift();a;)if(e.responseFields[a]&&(i[e.responseFields[a]]=t),!l&&n&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),l=a,a=d.shift())if("*"===a)a=l;else if("*"!==l&&l!==a){if(!(r=c[l+" "+a]||c["* "+a]))for(o in c)if((s=o.split(" "))[1]===a&&(r=c[l+" "+s[0]]||c["* "+s[0]])){!0===r?r=c[o]:!0!==c[o]&&(a=s[0],d.unshift(s[1]));break}if(!0!==r)if(r&&e.throws)t=r(t);else try{t=r(t)}catch(e){return{state:"parsererror",error:r?e:"No conversion from "+l+" to "+a}}}return{state:"success",data:t}}function q(e,t,i,n){var o;if(ie.isArray(t))ie.each(t,function(t,o){i||qt.test(e)?n(e,o):q(e+"["+("object"==typeof o?t:"")+"]",o,i,n)});else if(i||"object"!==ie.type(t))n(e,t);else for(o in t)q(e+"["+o+"]",t[o],i,n)}function G(){try{return new window.XMLHttpRequest}catch(e){}}function z(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch(e){}}function $(e){return ie.isWindow(e)?e:9===e.nodeType&&(e.defaultView||e.parentWindow)}var Y=[],W=Y.slice,V=Y.concat,J=Y.push,X=Y.indexOf,Q={},K=Q.toString,Z=Q.hasOwnProperty,ee="".trim,te={},ie=function(e,t){return new ie.fn.init(e,t)},ne=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,oe=/^-ms-/,ae=/-([\da-z])/gi,re=function(e,t){return t.toUpperCase()};ie.fn=ie.prototype={jquery:"1.11.1pre",constructor:ie,selector:"",length:0,toArray:function(){return W.call(this)},get:function(e){return null!=e?e<0?this[e+this.length]:this[e]:W.call(this)},pushStack:function(e){var t=ie.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return ie.each(this,e,t)},map:function(e){return this.pushStack(ie.map(this,function(t,i){return e.call(t,i,t)}))},slice:function(){return this.pushStack(W.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,i=+e+(e<0?t:0);return this.pushStack(i>=0&&i<t?[this[i]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:J,sort:Y.sort,splice:Y.splice},ie.extend=ie.fn.extend=function(){var e,t,i,n,o,a,r=arguments[0]||{},s=1,l=arguments.length,c=!1;for("boolean"==typeof r&&(c=r,r=arguments[s]||{},s++),"object"==typeof r||ie.isFunction(r)||(r={}),s===l&&(r=this,s--);s<l;s++)if(null!=(o=arguments[s]))for(n in o)e=r[n],r!==(i=o[n])&&(c&&i&&(ie.isPlainObject(i)||(t=ie.isArray(i)))?(t?(t=!1,a=e&&ie.isArray(e)?e:[]):a=e&&ie.isPlainObject(e)?e:{},r[n]=ie.extend(c,a,i)):void 0!==i&&(r[n]=i));return r},ie.extend({expando:"jQuery"+("1.11.1pre"+Math.random()).replace(/\D/g,""),isReady:!0,error:function(e){throw new Error(e)},noop:function(){},isFunction:function(e){return"function"===ie.type(e)},isArray:Array.isArray||function(e){return"array"===ie.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return e-parseFloat(e)>=0},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},isPlainObject:function(e){var t;if(!e||"object"!==ie.type(e)||e.nodeType||ie.isWindow(e))return!1;try{if(e.constructor&&!Z.call(e,"constructor")&&!Z.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(e){return!1}if(te.ownLast)for(t in e)return Z.call(e,t);for(t in e);return void 0===t||Z.call(e,t)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?Q[K.call(e)]||"object":typeof e},globalEval:function(e){e&&ie.trim(e)&&(window.execScript||function(e){window.eval.call(window,e)})(e)},camelCase:function(e){return e.replace(oe,"ms-").replace(ae,re)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(t,i,n){var o=0,a=t.length,r=e(t);if(n){if(r)for(;o<a&&!1!==i.apply(t[o],n);o++);else for(o in t)if(!1===i.apply(t[o],n))break}else if(r)for(;o<a&&!1!==i.call(t[o],o,t[o]);o++);else for(o in t)if(!1===i.call(t[o],o,t[o]))break;return t},trim:ee&&!ee.call("\ufeff ")?function(e){return null==e?"":ee.call(e)}:function(e){return null==e?"":(e+"").replace(ne,"")},makeArray:function(t,i){var n=i||[];return null!=t&&(e(Object(t))?ie.merge(n,"string"==typeof t?[t]:t):J.call(n,t)),n},inArray:function(e,t,i){var n;if(t){if(X)return X.call(t,e,i);for(n=t.length,i=i?i<0?Math.max(0,n+i):i:0;i<n;i++)if(i in t&&t[i]===e)return i}return-1},merge:function(e,t){for(var i=+t.length,n=0,o=e.length;n<i;)e[o++]=t[n++];if(i!==i)for(;void 0!==t[n];)e[o++]=t[n++];return e.length=o,e},grep:function(e,t,i){for(var n=[],o=0,a=e.length,r=!i;o<a;o++)!t(e[o],o)!==r&&n.push(e[o]);return n},map:function(t,i,n){var o,a=0,r=t.length,s=[];if(e(t))for(;a<r;a++)null!=(o=i(t[a],a,n))&&s.push(o);else for(a in t)null!=(o=i(t[a],a,n))&&s.push(o);return V.apply([],s)},guid:1,proxy:function(e,t){var i,n,o;if("string"==typeof t&&(o=e[t],t=e,e=o),ie.isFunction(e))return i=W.call(arguments,2),n=function(){return e.apply(t||this,i.concat(W.call(arguments)))},n.guid=e.guid=e.guid||ie.guid++,n},now:function(){return+new Date},support:te}),ie.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){Q["[object "+t+"]"]=t.toLowerCase()});var se=function(e){function t(e,t,i,n){var o,a,r,s,c,p,f,m,h,g;if((t?t.ownerDocument||t:B)!==T&&A(t),t=t||T,i=i||[],!e||"string"!=typeof e)return i;if(1!==(s=t.nodeType)&&9!==s)return[];if(D&&!n){if(o=ge.exec(e))if(r=o[1]){if(9===s){if(!(a=t.getElementById(r))||!a.parentNode)return i;if(a.id===r)return i.push(a),i}else if(t.ownerDocument&&(a=t.ownerDocument.getElementById(r))&&N(t,a)&&a.id===r)return i.push(a),i}else{if(o[2])return Q.apply(i,t.getElementsByTagName(e)),i;if((r=o[3])&&b.getElementsByClassName&&t.getElementsByClassName)return Q.apply(i,t.getElementsByClassName(r)),i}if(b.qsa&&(!M||!M.test(e))){if(m=f=P,h=t,g=9===s&&e,1===s&&"object"!==t.nodeName.toLowerCase()){for(p=d(e),(f=t.getAttribute("id"))?m=f.replace(ye,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",c=p.length;c--;)p[c]=m+u(p[c]);h=ve.test(e)&&l(t.parentNode)||t,g=p.join(",")}if(g)try{return Q.apply(i,h.querySelectorAll(g)),i}catch(e){}finally{f||t.removeAttribute("id")}}}return I(e.replace(re,"$1"),t,i,n)}function i(){function e(i,n){return t.push(i+" ")>S.cacheLength&&delete e[t.shift()],e[i+" "]=n}var t=[];return e}function n(e){return e[P]=!0,e}function o(e){var t=T.createElement("div");try{return!!e(t)}catch(e){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function a(e,t){for(var i=e.split("|"),n=e.length;n--;)S.attrHandle[i[n]]=t}function r(e,t){var i=t&&e,n=i&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||Y)-(~e.sourceIndex||Y);if(n)return n;if(i)for(;i=i.nextSibling;)if(i===t)return-1;return e?1:-1}function s(e){return n(function(t){return t=+t,n(function(i,n){for(var o,a=e([],i.length,t),r=a.length;r--;)i[o=a[r]]&&(i[o]=!(n[o]=i[o]))})})}function l(e){return e&&typeof e.getElementsByTagName!==$&&e}function c(){}function d(e,i){var n,o,a,r,s,l,c,d=q[e+" "];if(d)return i?0:d.slice(0);for(s=e,l=[],c=S.preFilter;s;){n&&!(o=se.exec(s))||(o&&(s=s.slice(o[0].length)||s),l.push(a=[])),n=!1,(o=le.exec(s))&&(n=o.shift(),a.push({value:n,type:o[0].replace(re," ")}),s=s.slice(n.length));for(r in S.filter)!(o=pe[r].exec(s))||c[r]&&!(o=c[r](o))||(n=o.shift(),a.push({value:n,type:r,matches:o}),s=s.slice(n.length));if(!n)break}return i?s.length:s?t.error(e):q(e,l).slice(0)}function u(e){for(var t=0,i=e.length,n="";t<i;t++)n+=e[t].value;return n}function p(e,t,i){var n=t.dir,o=i&&"parentNode"===n,a=U++;return t.first?function(t,i,a){for(;t=t[n];)if(1===t.nodeType||o)return e(t,i,a)}:function(t,i,r){var s,l,c=[j,a];if(r){for(;t=t[n];)if((1===t.nodeType||o)&&e(t,i,r))return!0}else for(;t=t[n];)if(1===t.nodeType||o){if(l=t[P]||(t[P]={}),(s=l[n])&&s[0]===j&&s[1]===a)return c[2]=s[2];if(l[n]=c,c[2]=e(t,i,r))return!0}}}function f(e){return e.length>1?function(t,i,n){for(var o=e.length;o--;)if(!e[o](t,i,n))return!1;return!0}:e[0]}function m(e,i,n){for(var o=0,a=i.length;o<a;o++)t(e,i[o],n);return n}function h(e,t,i,n,o){for(var a,r=[],s=0,l=e.length,c=null!=t;s<l;s++)(a=e[s])&&(i&&!i(a,n,o)||(r.push(a),c&&t.push(s)));return r}function g(e,t,i,o,a,r){return o&&!o[P]&&(o=g(o)),a&&!a[P]&&(a=g(a,r)),n(function(n,r,s,l){var c,d,u,p=[],f=[],g=r.length,v=n||m(t||"*",s.nodeType?[s]:s,[]),y=!e||!n&&t?v:h(v,p,e,s,l),E=i?a||(n?e:g||o)?[]:r:y;if(i&&i(y,E,s,l),o)for(c=h(E,f),o(c,[],s,l),d=c.length;d--;)(u=c[d])&&(E[f[d]]=!(y[f[d]]=u));if(n){if(a||e){if(a){for(c=[],d=E.length;d--;)(u=E[d])&&c.push(y[d]=u);a(null,E=[],c,l)}for(d=E.length;d--;)(u=E[d])&&(c=a?Z.call(n,u):p[d])>-1&&(n[c]=!(r[c]=u))}}else E=h(E===r?E.splice(g,E.length):E),a?a(null,r,E,l):Q.apply(r,E)})}function v(e){for(var t,i,n,o=e.length,a=S.relative[e[0].type],r=a||S.relative[" "],s=a?1:0,l=p(function(e){return e===t},r,!0),c=p(function(e){return Z.call(t,e)>-1},r,!0),d=[function(e,i,n){return!a&&(n||i!==x)||((t=i).nodeType?l(e,i,n):c(e,i,n))}];s<o;s++)if(i=S.relative[e[s].type])d=[p(f(d),i)];else{if((i=S.filter[e[s].type].apply(null,e[s].matches))[P]){for(n=++s;n<o&&!S.relative[e[n].type];n++);return g(s>1&&f(d),s>1&&u(e.slice(0,s-1).concat({value:" "===e[s-2].type?"*":""})).replace(re,"$1"),i,s<n&&v(e.slice(s,n)),n<o&&v(e=e.slice(n)),n<o&&u(e))}d.push(i)}return f(d)}function y(e,i){var o=i.length>0,a=e.length>0,r=function(n,r,s,l,c){var d,u,p,f=0,m="0",g=n&&[],v=[],y=x,E=n||a&&S.find.TAG("*",c),b=j+=null==y?1:Math.random()||.1,C=E.length;for(c&&(x=r!==T&&r);m!==C&&null!=(d=E[m]);m++){if(a&&d){for(u=0;p=e[u++];)if(p(d,r,s)){l.push(d);break}c&&(j=b)}o&&((d=!p&&d)&&f--,n&&g.push(d))}if(f+=m,o&&m!==f){for(u=0;p=i[u++];)p(g,v,r,s);if(n){if(f>0)for(;m--;)g[m]||v[m]||(v[m]=J.call(l));v=h(v)}Q.apply(l,v),c&&!n&&v.length>0&&f+i.length>1&&t.uniqueSort(l)}return c&&(j=b,x=y),g};return o?n(r):r}var E,b,S,C,_,w,I,x,k,L,A,T,O,D,M,R,F,N,P="sizzle"+-new Date,B=e.document,j=0,U=0,H=i(),q=i(),G=i(),z=function(e,t){return e===t&&(L=!0),0},$="undefined",Y=1<<31,W={}.hasOwnProperty,V=[],J=V.pop,X=V.push,Q=V.push,K=V.slice,Z=V.indexOf||function(e){for(var t=0,i=this.length;t<i;t++)if(this[t]===e)return t;return-1},ee="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",te="[\\x20\\t\\r\\n\\f]",ie="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",ne=ie.replace("w","w#"),oe="\\["+te+"*("+ie+")"+te+"*(?:([*^$|!~]?=)"+te+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ne+")|)|)"+te+"*\\]",ae=":("+ie+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+oe.replace(3,8)+")*)|.*)\\)|)",re=new RegExp("^"+te+"+|((?:^|[^\\\\])(?:\\\\.)*)"+te+"+$","g"),se=new RegExp("^"+te+"*,"+te+"*"),le=new RegExp("^"+te+"*([>+~]|"+te+")"+te+"*"),ce=new RegExp("="+te+"*([^\\]'\"]*?)"+te+"*\\]","g"),de=new RegExp(ae),ue=new RegExp("^"+ne+"$"),pe={ID:new RegExp("^#("+ie+")"),CLASS:new RegExp("^\\.("+ie+")"),TAG:new RegExp("^("+ie.replace("w","w*")+")"),ATTR:new RegExp("^"+oe),PSEUDO:new RegExp("^"+ae),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+te+"*(even|odd|(([+-]|)(\\d*)n|)"+te+"*(?:([+-]|)"+te+"*(\\d+)|))"+te+"*\\)|)","i"),bool:new RegExp("^(?:"+ee+")$","i"),needsContext:new RegExp("^"+te+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+te+"*((?:-\\d)?\\d*)"+te+"*\\)|)(?=[^-]|$)","i")},fe=/^(?:input|select|textarea|button)$/i,me=/^h\d$/i,he=/^[^{]+\{\s*\[native \w/,ge=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,ve=/[+~]/,ye=/'|\\/g,Ee=new RegExp("\\\\([\\da-f]{1,6}"+te+"?|("+te+")|.)","ig"),be=function(e,t,i){var n="0x"+t-65536;return n!==n||i?t:n<0?String.fromCharCode(n+65536):String.fromCharCode(n>>10|55296,1023&n|56320)};try{Q.apply(V=K.call(B.childNodes),B.childNodes),V[B.childNodes.length].nodeType}catch(e){Q={apply:V.length?function(e,t){X.apply(e,K.call(t))}:function(e,t){for(var i=e.length,n=0;e[i++]=t[n++];);e.length=i-1}}}b=t.support={},_=t.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return!!t&&"HTML"!==t.nodeName},A=t.setDocument=function(e){var t,i=e?e.ownerDocument||e:B,n=i.defaultView;return i!==T&&9===i.nodeType&&i.documentElement?(T=i,O=i.documentElement,D=!_(i),n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",function(){A()},!1):n.attachEvent&&n.attachEvent("onunload",function(){A()})),b.attributes=o(function(e){return e.className="i",!e.getAttribute("className")}),b.getElementsByTagName=o(function(e){return e.appendChild(i.createComment("")),!e.getElementsByTagName("*").length}),b.getElementsByClassName=he.test(i.getElementsByClassName)&&o(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),b.getById=o(function(e){return O.appendChild(e).id=P,!i.getElementsByName||!i.getElementsByName(P).length}),b.getById?(S.find.ID=function(e,t){if(typeof t.getElementById!==$&&D){var i=t.getElementById(e);return i&&i.parentNode?[i]:[]}},S.filter.ID=function(e){var t=e.replace(Ee,be);return function(e){return e.getAttribute("id")===t}}):(delete S.find.ID,S.filter.ID=function(e){var t=e.replace(Ee,be);return function(e){var i=typeof e.getAttributeNode!==$&&e.getAttributeNode("id");return i&&i.value===t}}),S.find.TAG=b.getElementsByTagName?function(e,t){if(typeof t.getElementsByTagName!==$)return t.getElementsByTagName(e)}:function(e,t){var i,n=[],o=0,a=t.getElementsByTagName(e);if("*"===e){for(;i=a[o++];)1===i.nodeType&&n.push(i);return n}return a},S.find.CLASS=b.getElementsByClassName&&function(e,t){if(typeof t.getElementsByClassName!==$&&D)return t.getElementsByClassName(e)},R=[],M=[],(b.qsa=he.test(i.querySelectorAll))&&(o(function(e){e.innerHTML="<select t=''><option selected=''></option></select>",e.querySelectorAll("[t^='']").length&&M.push("[*^$]="+te+"*(?:''|\"\")"),e.querySelectorAll("[selected]").length||M.push("\\["+te+"*(?:value|"+ee+")"),e.querySelectorAll(":checked").length||M.push(":checked")}),o(function(e){var t=i.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("name","D"),e.querySelectorAll("[name=d]").length&&M.push("name"+te+"*[*^$|!~]?="),e.querySelectorAll(":enabled").length||M.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),M.push(",.*:")})),(b.matchesSelector=he.test(F=O.webkitMatchesSelector||O.mozMatchesSelector||O.oMatchesSelector||O.msMatchesSelector))&&o(function(e){b.disconnectedMatch=F.call(e,"div"),F.call(e,"[s!='']:x"),R.push("!=",ae)}),M=M.length&&new RegExp(M.join("|")),R=R.length&&new RegExp(R.join("|")),t=he.test(O.compareDocumentPosition),N=t||he.test(O.contains)?function(e,t){var i=9===e.nodeType?e.documentElement:e,n=t&&t.parentNode;return e===n||!(!n||1!==n.nodeType||!(i.contains?i.contains(n):e.compareDocumentPosition&&16&e.compareDocumentPosition(n)))}:function(e,t){if(t)for(;t=t.parentNode;)if(t===e)return!0;return!1},z=t?function(e,t){if(e===t)return L=!0,0;var n=!e.compareDocumentPosition-!t.compareDocumentPosition;return n||(n=(e.ownerDocument||e)===(t.ownerDocument||t)?e.compareDocumentPosition(t):1,1&n||!b.sortDetached&&t.compareDocumentPosition(e)===n?e===i||e.ownerDocument===B&&N(B,e)?-1:t===i||t.ownerDocument===B&&N(B,t)?1:k?Z.call(k,e)-Z.call(k,t):0:4&n?-1:1)}:function(e,t){if(e===t)return L=!0,0;var n,o=0,a=e.parentNode,s=t.parentNode,l=[e],c=[t];if(!a||!s)return e===i?-1:t===i?1:a?-1:s?1:k?Z.call(k,e)-Z.call(k,t):0;if(a===s)return r(e,t);for(n=e;n=n.parentNode;)l.unshift(n);for(n=t;n=n.parentNode;)c.unshift(n);for(;l[o]===c[o];)o++;return o?r(l[o],c[o]):l[o]===B?-1:c[o]===B?1:0},i):T},t.matches=function(e,i){return t(e,null,null,i)},t.matchesSelector=function(e,i){if((e.ownerDocument||e)!==T&&A(e),i=i.replace(ce,"='$1']"),b.matchesSelector&&D&&(!R||!R.test(i))&&(!M||!M.test(i)))try{var n=F.call(e,i);if(n||b.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(e){}return t(i,T,null,[e]).length>0},t.contains=function(e,t){return(e.ownerDocument||e)!==T&&A(e),N(e,t)},t.attr=function(e,t){(e.ownerDocument||e)!==T&&A(e);var i=S.attrHandle[t.toLowerCase()],n=i&&W.call(S.attrHandle,t.toLowerCase())?i(e,t,!D):void 0;return void 0!==n?n:b.attributes||!D?e.getAttribute(t):(n=e.getAttributeNode(t))&&n.specified?n.value:null},t.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)},t.uniqueSort=function(e){var t,i=[],n=0,o=0;if(L=!b.detectDuplicates,k=!b.sortStable&&e.slice(0),e.sort(z),L){for(;t=e[o++];)t===e[o]&&(n=i.push(o));for(;n--;)e.splice(i[n],1)}return k=null,e},C=t.getText=function(e){var t,i="",n=0,o=e.nodeType;if(o){if(1===o||9===o||11===o){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)i+=C(e)}else if(3===o||4===o)return e.nodeValue}else for(;t=e[n++];)i+=C(t);return i},(S=t.selectors={cacheLength:50,createPseudo:n,match:pe,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(Ee,be),e[3]=(e[4]||e[5]||"").replace(Ee,be),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||t.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&t.error(e[0]),e},PSEUDO:function(e){var t,i=!e[5]&&e[2];return pe.CHILD.test(e[0])?null:(e[3]&&void 0!==e[4]?e[2]=e[4]:i&&de.test(i)&&(t=d(i,!0))&&(t=i.indexOf(")",i.length-t)-i.length)&&(e[0]=e[0].slice(0,t),e[2]=i.slice(0,t)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(Ee,be).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=H[e+" "];return t||(t=new RegExp("(^|"+te+")"+e+"("+te+"|$)"))&&H(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==$&&e.getAttribute("class")||"")})},ATTR:function(e,i,n){return function(o){var a=t.attr(o,e);return null==a?"!="===i:!i||(a+="","="===i?a===n:"!="===i?a!==n:"^="===i?n&&0===a.indexOf(n):"*="===i?n&&a.indexOf(n)>-1:"$="===i?n&&a.slice(-n.length)===n:"~="===i?(" "+a+" ").indexOf(n)>-1:"|="===i&&(a===n||a.slice(0,n.length+1)===n+"-"))}},CHILD:function(e,t,i,n,o){var a="nth"!==e.slice(0,3),r="last"!==e.slice(-4),s="of-type"===t;return 1===n&&0===o?function(e){return!!e.parentNode}:function(t,i,l){var c,d,u,p,f,m,h=a!==r?"nextSibling":"previousSibling",g=t.parentNode,v=s&&t.nodeName.toLowerCase(),y=!l&&!s;if(g){if(a){for(;h;){for(u=t;u=u[h];)if(s?u.nodeName.toLowerCase()===v:1===u.nodeType)return!1;m=h="only"===e&&!m&&"nextSibling"}return!0}if(m=[r?g.firstChild:g.lastChild],r&&y){for(f=(c=(d=g[P]||(g[P]={}))[e]||[])[0]===j&&c[1],p=c[0]===j&&c[2],u=f&&g.childNodes[f];u=++f&&u&&u[h]||(p=f=0)||m.pop();)if(1===u.nodeType&&++p&&u===t){d[e]=[j,f,p];break}}else if(y&&(c=(t[P]||(t[P]={}))[e])&&c[0]===j)p=c[1];else for(;(u=++f&&u&&u[h]||(p=f=0)||m.pop())&&((s?u.nodeName.toLowerCase()!==v:1!==u.nodeType)||!++p||(y&&((u[P]||(u[P]={}))[e]=[j,p]),u!==t)););return(p-=o)===n||p%n==0&&p/n>=0}}},PSEUDO:function(e,i){var o,a=S.pseudos[e]||S.setFilters[e.toLowerCase()]||t.error("unsupported pseudo: "+e);return a[P]?a(i):a.length>1?(o=[e,e,"",i],S.setFilters.hasOwnProperty(e.toLowerCase())?n(function(e,t){for(var n,o=a(e,i),r=o.length;r--;)e[n=Z.call(e,o[r])]=!(t[n]=o[r])}):function(e){return a(e,0,o)}):a}},pseudos:{not:n(function(e){var t=[],i=[],o=w(e.replace(re,"$1"));return o[P]?n(function(e,t,i,n){for(var a,r=o(e,null,n,[]),s=e.length;s--;)(a=r[s])&&(e[s]=!(t[s]=a))}):function(e,n,a){return t[0]=e,o(t,null,a,i),!i.pop()}}),has:n(function(e){return function(i){return t(e,i).length>0}}),contains:n(function(e){return function(t){return(t.textContent||t.innerText||C(t)).indexOf(e)>-1}}),lang:n(function(e){return ue.test(e||"")||t.error("unsupported lang: "+e),e=e.replace(Ee,be).toLowerCase(),function(t){var i;do{if(i=D?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return(i=i.toLowerCase())===e||0===i.indexOf(e+"-")}while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var i=e.location&&e.location.hash;return i&&i.slice(1)===t.id},root:function(e){return e===O},focus:function(e){return e===T.activeElement&&(!T.hasFocus||T.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return!1===e.disabled},disabled:function(e){return!0===e.disabled},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,!0===e.selected},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeType<6)return!1;return!0},parent:function(e){return!S.pseudos.empty(e)},header:function(e){return me.test(e.nodeName)},input:function(e){return fe.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||"text"===t.toLowerCase())},first:s(function(){return[0]}),last:s(function(e,t){return[t-1]}),eq:s(function(e,t,i){return[i<0?i+t:i]}),even:s(function(e,t){for(var i=0;i<t;i+=2)e.push(i);return e}),odd:s(function(e,t){for(var i=1;i<t;i+=2)e.push(i);return e}),lt:s(function(e,t,i){for(var n=i<0?i+t:i;--n>=0;)e.push(n);return e}),gt:s(function(e,t,i){for(var n=i<0?i+t:i;++n<t;)e.push(n);return e})}}).pseudos.nth=S.pseudos.eq;for(E in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})S.pseudos[E]=function(e){return function(t){return"input"===t.nodeName.toLowerCase()&&t.type===e}}(E);for(E in{submit:!0,reset:!0})S.pseudos[E]=function(e){return function(t){var i=t.nodeName.toLowerCase();return("input"===i||"button"===i)&&t.type===e}}(E);return c.prototype=S.filters=S.pseudos,S.setFilters=new c,w=t.compile=function(e,t){var i,n=[],o=[],a=G[e+" "];if(!a){for(t||(t=d(e)),i=t.length;i--;)(a=v(t[i]))[P]?n.push(a):o.push(a);(a=G(e,y(o,n))).selector=e}return a},I=t.select=function(e,t,i,n){var o,a,r,s,c,p="function"==typeof e&&e,f=!n&&d(e=p.selector||e);if(i=i||[],1===f.length){if((a=f[0]=f[0].slice(0)).length>2&&"ID"===(r=a[0]).type&&b.getById&&9===t.nodeType&&D&&S.relative[a[1].type]){if(!(t=(S.find.ID(r.matches[0].replace(Ee,be),t)||[])[0]))return i;p&&(t=t.parentNode),e=e.slice(a.shift().value.length)}for(o=pe.needsContext.test(e)?0:a.length;o--&&(r=a[o],!S.relative[s=r.type]);)if((c=S.find[s])&&(n=c(r.matches[0].replace(Ee,be),ve.test(a[0].type)&&l(t.parentNode)||t))){if(a.splice(o,1),!(e=n.length&&u(a)))return Q.apply(i,n),i;break}}return(p||w(e,f))(n,t,!D,i,ve.test(e)&&l(t.parentNode)||t),i},b.sortStable=P.split("").sort(z).join("")===P,b.detectDuplicates=!!L,A(),b.sortDetached=o(function(e){return 1&e.compareDocumentPosition(T.createElement("div"))}),o(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||a("type|href|height|width",function(e,t,i){if(!i)return e.getAttribute(t,"type"===t.toLowerCase()?1:2)}),b.attributes&&o(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||a("value",function(e,t,i){if(!i&&"input"===e.nodeName.toLowerCase())return e.defaultValue}),o(function(e){return null==e.getAttribute("disabled")})||a(ee,function(e,t,i){var n;if(!i)return!0===e[t]?t.toLowerCase():(n=e.getAttributeNode(t))&&n.specified?n.value:null}),t}(window);ie.find=se,ie.expr=se.selectors,ie.expr[":"]=ie.expr.pseudos,ie.unique=se.uniqueSort,ie.text=se.getText,ie.isXMLDoc=se.isXML,ie.contains=se.contains;var le=ie.expr.match.needsContext,ce=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,de=/^.[^:#\[\.,]*$/;ie.filter=function(e,t,i){var n=t[0];return i&&(e=":not("+e+")"),1===t.length&&1===n.nodeType?ie.find.matchesSelector(n,e)?[n]:[]:ie.find.matches(e,ie.grep(t,function(e){return 1===e.nodeType}))},ie.fn.extend({find:function(e){var t,i=[],n=this,o=n.length;if("string"!=typeof e)return this.pushStack(ie(e).filter(function(){for(t=0;t<o;t++)if(ie.contains(n[t],this))return!0}));for(t=0;t<o;t++)ie.find(e,n[t],i);return i=this.pushStack(o>1?ie.unique(i):i),i.selector=this.selector?this.selector+" "+e:e,i},filter:function(e){return this.pushStack(t(this,e||[],!1))},not:function(e){return this.pushStack(t(this,e||[],!0))},is:function(e){return!!t(this,"string"==typeof e&&le.test(e)?ie(e):e||[],!1).length}});var ue,pe=window.document,fe=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/;(ie.fn.init=function(e,t){var i,n;if(!e)return this;if("string"==typeof e){if(!(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:fe.exec(e))||!i[1]&&t)return!t||t.jquery?(t||ue).find(e):this.constructor(t).find(e);if(i[1]){if(t=t instanceof ie?t[0]:t,ie.merge(this,ie.parseHTML(i[1],t&&t.nodeType?t.ownerDocument||t:pe,!0)),ce.test(i[1])&&ie.isPlainObject(t))for(i in t)ie.isFunction(this[i])?this[i](t[i]):this.attr(i,t[i]);return this}if((n=pe.getElementById(i[2]))&&n.parentNode){if(n.id!==i[2])return ue.find(e);this.length=1,this[0]=n}return this.context=pe,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):ie.isFunction(e)?void 0!==ue.ready?ue.ready(e):e(ie):(void 0!==e.selector&&(this.selector=e.selector,this.context=e.context),ie.makeArray(e,this))}).prototype=ie.fn,ue=ie(pe);var me=/^(?:parents|prev(?:Until|All))/,he={children:!0,contents:!0,next:!0,prev:!0};ie.extend({dir:function(e,t,i){for(var n=[],o=e[t];o&&9!==o.nodeType&&(void 0===i||1!==o.nodeType||!ie(o).is(i));)1===o.nodeType&&n.push(o),o=o[t];return n},sibling:function(e,t){for(var i=[];e;e=e.nextSibling)1===e.nodeType&&e!==t&&i.push(e);return i}}),ie.fn.extend({has:function(e){var t,i=ie(e,this),n=i.length;return this.filter(function(){for(t=0;t<n;t++)if(ie.contains(this,i[t]))return!0})},closest:function(e,t){for(var i,n=0,o=this.length,a=[],r=le.test(e)||"string"!=typeof e?ie(e,t||this.context):0;n<o;n++)for(i=this[n];i&&i!==t;i=i.parentNode)if(i.nodeType<11&&(r?r.index(i)>-1:1===i.nodeType&&ie.find.matchesSelector(i,e))){a.push(i);break}return this.pushStack(a.length>1?ie.unique(a):a)},index:function(e){return e?"string"==typeof e?ie.inArray(this[0],ie(e)):ie.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){return this.pushStack(ie.unique(ie.merge(this.get(),ie(e,t))))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),ie.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return ie.dir(e,"parentNode")},parentsUntil:function(e,t,i){return ie.dir(e,"parentNode",i)},next:function(e){return i(e,"nextSibling")},prev:function(e){return i(e,"previousSibling")},nextAll:function(e){return ie.dir(e,"nextSibling")},prevAll:function(e){return ie.dir(e,"previousSibling")},nextUntil:function(e,t,i){return ie.dir(e,"nextSibling",i)},prevUntil:function(e,t,i){return ie.dir(e,"previousSibling",i)},siblings:function(e){return ie.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return ie.sibling(e.firstChild)},contents:function(e){return ie.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:ie.merge([],e.childNodes)}},function(e,t){ie.fn[e]=function(i,n){var o=ie.map(this,t,i);return"Until"!==e.slice(-5)&&(n=i),n&&"string"==typeof n&&(o=ie.filter(n,o)),this.length>1&&(he[e]||(o=ie.unique(o)),me.test(e)&&(o=o.reverse())),this.pushStack(o)}});var ge=/\S+/g,ve={};ie.Callbacks=function(e){var t,i,o,a,r,s,l=[],c=!(e="string"==typeof e?ve[e]||n(e):ie.extend({},e)).once&&[],d=function(n){for(i=e.memory&&n,o=!0,r=s||0,s=0,a=l.length,t=!0;l&&r<a;r++)if(!1===l[r].apply(n[0],n[1])&&e.stopOnFalse){i=!1;break}t=!1,l&&(c?c.length&&d(c.shift()):i?l=[]:u.disable())},u={add:function(){if(l){var n=l.length;!function t(i){ie.each(i,function(i,n){var o=ie.type(n);"function"===o?e.unique&&u.has(n)||l.push(n):n&&n.length&&"string"!==o&&t(n)})}(arguments),t?a=l.length:i&&(s=n,d(i))}return this},remove:function(){return l&&ie.each(arguments,function(e,i){for(var n;(n=ie.inArray(i,l,n))>-1;)l.splice(n,1),t&&(n<=a&&a--,n<=r&&r--)}),this},has:function(e){return e?ie.inArray(e,l)>-1:!(!l||!l.length)},empty:function(){return l=[],a=0,this},disable:function(){return l=c=i=void 0,this},disabled:function(){return!l},lock:function(){return c=void 0,i||u.disable(),this},locked:function(){return!c},fireWith:function(e,i){return!l||o&&!c||(i=[e,(i=i||[]).slice?i.slice():i],t?c.push(i):d(i)),this},fire:function(){return u.fireWith(this,arguments),this},fired:function(){return!!o}};return u},ie.extend({Deferred:function(e){var t=[["resolve","done",ie.Callbacks("once memory"),"resolved"],["reject","fail",ie.Callbacks("once memory"),"rejected"],["notify","progress",ie.Callbacks("memory")]],i="pending",n={state:function(){return i},always:function(){return o.done(arguments).fail(arguments),this},then:function(){var e=arguments;return ie.Deferred(function(i){ie.each(t,function(t,a){var r=ie.isFunction(e[t])&&e[t];o[a[1]](function(){var e=r&&r.apply(this,arguments);e&&ie.isFunction(e.promise)?e.promise().done(i.resolve).fail(i.reject).progress(i.notify):i[a[0]+"With"](this===n?i.promise():this,r?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?ie.extend(e,n):n}},o={};return n.pipe=n.then,ie.each(t,function(e,a){var r=a[2],s=a[3];n[a[1]]=r.add,s&&r.add(function(){i=s},t[1^e][2].disable,t[2][2].lock),o[a[0]]=function(){return o[a[0]+"With"](this===o?n:this,arguments),this},o[a[0]+"With"]=r.fireWith}),n.promise(o),e&&e.call(o,o),o},when:function(e){var t,i,n,o=0,a=W.call(arguments),r=a.length,s=1!==r||e&&ie.isFunction(e.promise)?r:0,l=1===s?e:ie.Deferred(),c=function(e,i,n){return function(o){i[e]=this,n[e]=arguments.length>1?W.call(arguments):o,n===t?l.notifyWith(i,n):--s||l.resolveWith(i,n)}};if(r>1)for(t=new Array(r),i=new Array(r),n=new Array(r);o<r;o++)a[o]&&ie.isFunction(a[o].promise)?a[o].promise().done(c(o,n,a)).fail(l.reject).progress(c(o,i,t)):--s;return s||l.resolveWith(n,a),l.promise()}});var ye;ie.fn.ready=function(e){return ie.ready.promise().done(e),this},ie.extend({isReady:!1,readyWait:1,holdReady:function(e){e?ie.readyWait++:ie.ready(!0)},ready:function(e){if(!0===e?!--ie.readyWait:!ie.isReady){if(!pe.body)return setTimeout(ie.ready);ie.isReady=!0,!0!==e&&--ie.readyWait>0||(ye.resolveWith(pe,[ie]),ie.fn.trigger&&ie(pe).trigger("ready").off("ready"))}}}),ie.ready.promise=function(e){if(!ye)if(ye=ie.Deferred(),"complete"===pe.readyState)setTimeout(ie.ready);else if(pe.addEventListener)pe.addEventListener("DOMContentLoaded",a,!1),window.addEventListener("load",a,!1);else{pe.attachEvent("onreadystatechange",a),window.attachEvent("onload",a);var t=!1;try{t=null==window.frameElement&&pe.documentElement}catch(e){}t&&t.doScroll&&function e(){if(!ie.isReady){try{t.doScroll("left")}catch(t){return setTimeout(e,50)}o(),ie.ready()}}()}return ye.promise(e)};var Ee,be="undefined";for(Ee in ie(te))break;te.ownLast="0"!==Ee,te.inlineBlockNeedsLayout=!1,ie(function(){var e,t,i=pe.getElementsByTagName("body")[0];i&&((e=pe.createElement("div")).style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",t=pe.createElement("div"),i.appendChild(e).appendChild(t),typeof t.style.zoom!==be&&(t.style.cssText="border:0;margin:0;width:1px;padding:1px;display:inline;zoom:1",(te.inlineBlockNeedsLayout=3===t.offsetWidth)&&(i.style.zoom=1)),i.removeChild(e),e=t=null)}),function(){var e=pe.createElement("div");if(null==te.deleteExpando){te.deleteExpando=!0;try{delete e.test}catch(e){te.deleteExpando=!1}}e=null}(),ie.acceptData=function(e){var t=ie.noData[(e.nodeName+" ").toLowerCase()],i=+e.nodeType||1;return(1===i||9===i)&&(!t||!0!==t&&e.getAttribute("classid")===t)};var Se=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Ce=/([A-Z])/g;ie.extend({cache:{},noData:{"applet ":!0,"embed ":!0,"object ":"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return!!(e=e.nodeType?ie.cache[e[ie.expando]]:e[ie.expando])&&!s(e)},data:function(e,t,i){return l(e,t,i)},removeData:function(e,t){return c(e,t)},_data:function(e,t,i){return l(e,t,i,!0)},_removeData:function(e,t){return c(e,t,!0)}}),ie.fn.extend({data:function(e,t){var i,n,o,a=this[0],s=a&&a.attributes;if(void 0===e){if(this.length&&(o=ie.data(a),1===a.nodeType&&!ie._data(a,"parsedAttrs"))){for(i=s.length;i--;)0===(n=s[i].name).indexOf("data-")&&r(a,n=ie.camelCase(n.slice(5)),o[n]);ie._data(a,"parsedAttrs",!0)}return o}return"object"==typeof e?this.each(function(){ie.data(this,e)}):arguments.length>1?this.each(function(){ie.data(this,e,t)}):a?r(a,e,ie.data(a,e)):void 0},removeData:function(e){return this.each(function(){ie.removeData(this,e)})}}),ie.extend({queue:function(e,t,i){var n;if(e)return t=(t||"fx")+"queue",n=ie._data(e,t),i&&(!n||ie.isArray(i)?n=ie._data(e,t,ie.makeArray(i)):n.push(i)),n||[]},dequeue:function(e,t){t=t||"fx";var i=ie.queue(e,t),n=i.length,o=i.shift(),a=ie._queueHooks(e,t),r=function(){ie.dequeue(e,t)};"inprogress"===o&&(o=i.shift(),n--),o&&("fx"===t&&i.unshift("inprogress"),delete a.stop,o.call(e,r,a)),!n&&a&&a.empty.fire()},_queueHooks:function(e,t){var i=t+"queueHooks";return ie._data(e,i)||ie._data(e,i,{empty:ie.Callbacks("once memory").add(function(){ie._removeData(e,t+"queue"),ie._removeData(e,i)})})}}),ie.fn.extend({queue:function(e,t){var i=2;return"string"!=typeof e&&(t=e,e="fx",i--),arguments.length<i?ie.queue(this[0],e):void 0===t?this:this.each(function(){var i=ie.queue(this,e,t);ie._queueHooks(this,e),"fx"===e&&"inprogress"!==i[0]&&ie.dequeue(this,e)})},dequeue:function(e){return this.each(function(){ie.dequeue(this,e)})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,t){var i,n=1,o=ie.Deferred(),a=this,r=this.length,s=function(){--n||o.resolveWith(a,[a])};for("string"!=typeof e&&(t=e,e=void 0),e=e||"fx";r--;)(i=ie._data(a[r],e+"queueHooks"))&&i.empty&&(n++,i.empty.add(s));return s(),o.promise(t)}});var _e=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,we=["Top","Right","Bottom","Left"],Ie=function(e,t){return e=t||e,"none"===ie.css(e,"display")||!ie.contains(e.ownerDocument,e)},xe=ie.access=function(e,t,i,n,o,a,r){var s=0,l=e.length,c=null==i;if("object"===ie.type(i)){o=!0;for(s in i)ie.access(e,t,s,i[s],!0,a,r)}else if(void 0!==n&&(o=!0,ie.isFunction(n)||(r=!0),c&&(r?(t.call(e,n),t=null):(c=t,t=function(e,t,i){return c.call(ie(e),i)})),t))for(;s<l;s++)t(e[s],i,r?n:n.call(e[s],s,t(e[s],i)));return o?e:c?t.call(e):l?t(e[0],i):a},ke=/^(?:checkbox|radio)$/i;!function(){var e=pe.createDocumentFragment(),t=pe.createElement("div"),i=pe.createElement("input");if(t.setAttribute("className","t"),t.innerHTML="  <link/><table></table><a href='/a'>a</a>",te.leadingWhitespace=3===t.firstChild.nodeType,te.tbody=!t.getElementsByTagName("tbody").length,te.htmlSerialize=!!t.getElementsByTagName("link").length,te.html5Clone="<:nav></:nav>"!==pe.createElement("nav").cloneNode(!0).outerHTML,i.type="checkbox",i.checked=!0,e.appendChild(i),te.appendChecked=i.checked,t.innerHTML="<textarea>x</textarea>",te.noCloneChecked=!!t.cloneNode(!0).lastChild.defaultValue,e.appendChild(t),t.innerHTML="<input type='radio' checked='checked' name='t'/>",te.checkClone=t.cloneNode(!0).cloneNode(!0).lastChild.checked,te.noCloneEvent=!0,t.attachEvent&&(t.attachEvent("onclick",function(){te.noCloneEvent=!1}),t.cloneNode(!0).click()),null==te.deleteExpando){te.deleteExpando=!0;try{delete t.test}catch(e){te.deleteExpando=!1}}e=t=i=null}(),function(){var e,t,i=pe.createElement("div");for(e in{submit:!0,change:!0,focusin:!0})t="on"+e,(te[e+"Bubbles"]=t in window)||(i.setAttribute(t,"t"),te[e+"Bubbles"]=!1===i.attributes[t].expando);i=null}();var Le=/^(?:input|select|textarea)$/i,Ae=/^key/,Te=/^(?:mouse|contextmenu)|click/,Oe=/^(?:focusinfocus|focusoutblur)$/,De=/^([^.]*)(?:\.(.+)|)$/;ie.event={global:{},add:function(e,t,i,n,o){var a,r,s,l,c,d,u,p,f,m,h,g=ie._data(e);if(g){for(i.handler&&(i=(l=i).handler,o=l.selector),i.guid||(i.guid=ie.guid++),(r=g.events)||(r=g.events={}),(d=g.handle)||((d=g.handle=function(e){return typeof ie===be||e&&ie.event.triggered===e.type?void 0:ie.event.dispatch.apply(d.elem,arguments)}).elem=e),s=(t=(t||"").match(ge)||[""]).length;s--;)f=h=(a=De.exec(t[s])||[])[1],m=(a[2]||"").split(".").sort(),f&&(c=ie.event.special[f]||{},f=(o?c.delegateType:c.bindType)||f,c=ie.event.special[f]||{},u=ie.extend({type:f,origType:h,data:n,handler:i,guid:i.guid,selector:o,needsContext:o&&ie.expr.match.needsContext.test(o),namespace:m.join(".")},l),(p=r[f])||((p=r[f]=[]).delegateCount=0,c.setup&&!1!==c.setup.call(e,n,m,d)||(e.addEventListener?e.addEventListener(f,d,!1):e.attachEvent&&e.attachEvent("on"+f,d))),c.add&&(c.add.call(e,u),u.handler.guid||(u.handler.guid=i.guid)),o?p.splice(p.delegateCount++,0,u):p.push(u),ie.event.global[f]=!0);e=null}},remove:function(e,t,i,n,o){var a,r,s,l,c,d,u,p,f,m,h,g=ie.hasData(e)&&ie._data(e);if(g&&(d=g.events)){for(c=(t=(t||"").match(ge)||[""]).length;c--;)if(s=De.exec(t[c])||[],f=h=s[1],m=(s[2]||"").split(".").sort(),f){for(u=ie.event.special[f]||{},p=d[f=(n?u.delegateType:u.bindType)||f]||[],s=s[2]&&new RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"),l=a=p.length;a--;)r=p[a],!o&&h!==r.origType||i&&i.guid!==r.guid||s&&!s.test(r.namespace)||n&&n!==r.selector&&("**"!==n||!r.selector)||(p.splice(a,1),r.selector&&p.delegateCount--,u.remove&&u.remove.call(e,r));l&&!p.length&&(u.teardown&&!1!==u.teardown.call(e,m,g.handle)||ie.removeEvent(e,f,g.handle),delete d[f])}else for(f in d)ie.event.remove(e,f+t[c],i,n,!0);ie.isEmptyObject(d)&&(delete g.handle,ie._removeData(e,"events"))}},trigger:function(e,t,i,n){var o,a,r,s,l,c,d,u=[i||pe],p=Z.call(e,"type")?e.type:e,f=Z.call(e,"namespace")?e.namespace.split("."):[];if(r=c=i=i||pe,3!==i.nodeType&&8!==i.nodeType&&!Oe.test(p+ie.event.triggered)&&(p.indexOf(".")>=0&&(p=(f=p.split(".")).shift(),f.sort()),a=p.indexOf(":")<0&&"on"+p,e=e[ie.expando]?e:new ie.Event(p,"object"==typeof e&&e),e.isTrigger=n?2:3,e.namespace=f.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+f.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=i),t=null==t?[e]:ie.makeArray(t,[e]),l=ie.event.special[p]||{},n||!l.trigger||!1!==l.trigger.apply(i,t))){if(!n&&!l.noBubble&&!ie.isWindow(i)){for(s=l.delegateType||p,Oe.test(s+p)||(r=r.parentNode);r;r=r.parentNode)u.push(r),c=r;c===(i.ownerDocument||pe)&&u.push(c.defaultView||c.parentWindow||window)}for(d=0;(r=u[d++])&&!e.isPropagationStopped();)e.type=d>1?s:l.bindType||p,(o=(ie._data(r,"events")||{})[e.type]&&ie._data(r,"handle"))&&o.apply(r,t),(o=a&&r[a])&&o.apply&&ie.acceptData(r)&&(e.result=o.apply(r,t),!1===e.result&&e.preventDefault());if(e.type=p,!n&&!e.isDefaultPrevented()&&(!l._default||!1===l._default.apply(u.pop(),t))&&ie.acceptData(i)&&a&&i[p]&&!ie.isWindow(i)){(c=i[a])&&(i[a]=null),ie.event.triggered=p;try{i[p]()}catch(e){}ie.event.triggered=void 0,c&&(i[a]=c)}return e.result}},dispatch:function(e){e=ie.event.fix(e);var t,i,n,o,a,r=[],s=W.call(arguments),l=(ie._data(this,"events")||{})[e.type]||[],c=ie.event.special[e.type]||{};if(s[0]=e,e.delegateTarget=this,!c.preDispatch||!1!==c.preDispatch.call(this,e)){for(r=ie.event.handlers.call(this,e,l),t=0;(o=r[t++])&&!e.isPropagationStopped();)for(e.currentTarget=o.elem,a=0;(n=o.handlers[a++])&&!e.isImmediatePropagationStopped();)e.namespace_re&&!e.namespace_re.test(n.namespace)||(e.handleObj=n,e.data=n.data,void 0!==(i=((ie.event.special[n.origType]||{}).handle||n.handler).apply(o.elem,s))&&!1===(e.result=i)&&(e.preventDefault(),e.stopPropagation()));return c.postDispatch&&c.postDispatch.call(this,e),e.result}},handlers:function(e,t){var i,n,o,a,r=[],s=t.delegateCount,l=e.target;if(s&&l.nodeType&&(!e.button||"click"!==e.type))for(;l!=this;l=l.parentNode||this)if(1===l.nodeType&&(!0!==l.disabled||"click"!==e.type)){for(o=[],a=0;a<s;a++)void 0===o[i=(n=t[a]).selector+" "]&&(o[i]=n.needsContext?ie(i,this).index(l)>=0:ie.find(i,this,null,[l]).length),o[i]&&o.push(n);o.length&&r.push({elem:l,handlers:o})}return s<t.length&&r.push({elem:this,handlers:t.slice(s)}),r},fix:function(e){if(e[ie.expando])return e;var t,i,n,o=e.type,a=e,r=this.fixHooks[o];for(r||(this.fixHooks[o]=r=Te.test(o)?this.mouseHooks:Ae.test(o)?this.keyHooks:{}),n=r.props?this.props.concat(r.props):this.props,e=new ie.Event(a),t=n.length;t--;)e[i=n[t]]=a[i];return e.target||(e.target=a.srcElement||pe),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,r.filter?r.filter(e,a):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,t){var i,n,o,a=t.button,r=t.fromElement;return null==e.pageX&&null!=t.clientX&&(o=(n=e.target.ownerDocument||pe).documentElement,i=n.body,e.pageX=t.clientX+(o&&o.scrollLeft||i&&i.scrollLeft||0)-(o&&o.clientLeft||i&&i.clientLeft||0),e.pageY=t.clientY+(o&&o.scrollTop||i&&i.scrollTop||0)-(o&&o.clientTop||i&&i.clientTop||0)),!e.relatedTarget&&r&&(e.relatedTarget=r===e.target?t.toElement:r),e.which||void 0===a||(e.which=1&a?1:2&a?3:4&a?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==p()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){if(this===p()&&this.blur)return this.blur(),!1},delegateType:"focusout"},click:{trigger:function(){if(ie.nodeName(this,"input")&&"checkbox"===this.type&&this.click)return this.click(),!1},_default:function(e){return ie.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){void 0!==e.result&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,i,n){var o=ie.extend(new ie.Event,i,{type:e,isSimulated:!0,originalEvent:{}});n?ie.event.trigger(o,null,t):ie.event.dispatch.call(t,o),o.isDefaultPrevented()&&i.preventDefault()}},ie.removeEvent=pe.removeEventListener?function(e,t,i){e.removeEventListener&&e.removeEventListener(t,i,!1)}:function(e,t,i){var n="on"+t;e.detachEvent&&(typeof e[n]===be&&(e[n]=null),e.detachEvent(n,i))},ie.Event=function(e,t){if(!(this instanceof ie.Event))return new ie.Event(e,t);e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||void 0===e.defaultPrevented&&(!1===e.returnValue||e.getPreventDefault&&e.getPreventDefault())?d:u):this.type=e,t&&ie.extend(this,t),this.timeStamp=e&&e.timeStamp||ie.now(),this[ie.expando]=!0},ie.Event.prototype={isDefaultPrevented:u,isPropagationStopped:u,isImmediatePropagationStopped:u,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=d,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=d,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=d,this.stopPropagation()}},ie.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){ie.event.special[e]={delegateType:t,bindType:t,handle:function(e){var i,n=this,o=e.relatedTarget,a=e.handleObj;return o&&(o===n||ie.contains(n,o))||(e.type=a.origType,i=a.handler.apply(this,arguments),e.type=t),i}}}),te.submitBubbles||(ie.event.special.submit={setup:function(){if(ie.nodeName(this,"form"))return!1;ie.event.add(this,"click._submit keypress._submit",function(e){var t=e.target,i=ie.nodeName(t,"input")||ie.nodeName(t,"button")?t.form:void 0;i&&!ie._data(i,"submitBubbles")&&(ie.event.add(i,"submit._submit",function(e){e._submit_bubble=!0}),ie._data(i,"submitBubbles",!0))})},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&ie.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){if(ie.nodeName(this,"form"))return!1;ie.event.remove(this,"._submit")}}),te.changeBubbles||(ie.event.special.change={setup:function(){if(Le.test(this.nodeName))return"checkbox"!==this.type&&"radio"!==this.type||(ie.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),ie.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),ie.event.simulate("change",this,e,!0)})),!1;ie.event.add(this,"beforeactivate._change",function(e){var t=e.target;Le.test(t.nodeName)&&!ie._data(t,"changeBubbles")&&(ie.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||ie.event.simulate("change",this.parentNode,e,!0)}),ie._data(t,"changeBubbles",!0))})},handle:function(e){var t=e.target;if(this!==t||e.isSimulated||e.isTrigger||"radio"!==t.type&&"checkbox"!==t.type)return e.handleObj.handler.apply(this,arguments)},teardown:function(){return ie.event.remove(this,"._change"),!Le.test(this.nodeName)}}),te.focusinBubbles||ie.each({focus:"focusin",blur:"focusout"},function(e,t){var i=function(e){ie.event.simulate(t,e.target,ie.event.fix(e),!0)};ie.event.special[t]={setup:function(){var n=this.ownerDocument||this,o=ie._data(n,t);o||n.addEventListener(e,i,!0),ie._data(n,t,(o||0)+1)},teardown:function(){var n=this.ownerDocument||this,o=ie._data(n,t)-1;o?ie._data(n,t,o):(n.removeEventListener(e,i,!0),ie._removeData(n,t))}}}),ie.fn.extend({on:function(e,t,i,n,o){var a,r;if("object"==typeof e){"string"!=typeof t&&(i=i||t,t=void 0);for(a in e)this.on(a,t,i,e[a],o);return this}if(null==i&&null==n?(n=t,i=t=void 0):null==n&&("string"==typeof t?(n=i,i=void 0):(n=i,i=t,t=void 0)),!1===n)n=u;else if(!n)return this;return 1===o&&(r=n,(n=function(e){return ie().off(e),r.apply(this,arguments)}).guid=r.guid||(r.guid=ie.guid++)),this.each(function(){ie.event.add(this,e,n,i,t)})},one:function(e,t,i,n){return this.on(e,t,i,n,1)},off:function(e,t,i){var n,o;if(e&&e.preventDefault&&e.handleObj)return n=e.handleObj,ie(e.delegateTarget).off(n.namespace?n.origType+"."+n.namespace:n.origType,n.selector,n.handler),this;if("object"==typeof e){for(o in e)this.off(o,t,e[o]);return this}return!1!==t&&"function"!=typeof t||(i=t,t=void 0),!1===i&&(i=u),this.each(function(){ie.event.remove(this,e,i,t)})},trigger:function(e,t){return this.each(function(){ie.event.trigger(e,t,this)})},triggerHandler:function(e,t){var i=this[0];if(i)return ie.event.trigger(e,t,i,!0)}});var Me="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",Re=/ jQuery\d+="(?:null|\d+)"/g,Fe=new RegExp("<(?:"+Me+")[\\s/>]","i"),Ne=/^\s+/,Pe=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Be=/<([\w:]+)/,je=/<tbody/i,Ue=/<|&#?\w+;/,He=/<(?:script|style|link)/i,qe=/checked\s*(?:[^=]|=\s*.checked.)/i,Ge=/^$|\/(?:java|ecma)script/i,ze=/^true\/(.*)/,$e=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Ye={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:te.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},We=f(pe).appendChild(pe.createElement("div"));Ye.optgroup=Ye.option,Ye.tbody=Ye.tfoot=Ye.colgroup=Ye.caption=Ye.thead,Ye.th=Ye.td,ie.extend({clone:function(e,t,i){var n,o,a,r,s,l=ie.contains(e.ownerDocument,e);if(te.html5Clone||ie.isXMLDoc(e)||!Fe.test("<"+e.nodeName+">")?a=e.cloneNode(!0):(We.innerHTML=e.outerHTML,We.removeChild(a=We.firstChild)),!(te.noCloneEvent&&te.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||ie.isXMLDoc(e)))for(n=m(a),s=m(e),r=0;null!=(o=s[r]);++r)n[r]&&S(o,n[r]);if(t)if(i)for(s=s||m(e),n=n||m(a),r=0;null!=(o=s[r]);r++)b(o,n[r]);else b(e,a);return(n=m(a,"script")).length>0&&E(n,!l&&m(e,"script")),n=s=o=null,a},buildFragment:function(e,t,i,n){for(var o,a,r,s,l,c,d,u=e.length,p=f(t),g=[],v=0;v<u;v++)if((a=e[v])||0===a)if("object"===ie.type(a))ie.merge(g,a.nodeType?[a]:a);else if(Ue.test(a)){for(s=s||p.appendChild(t.createElement("div")),l=(Be.exec(a)||["",""])[1].toLowerCase(),d=Ye[l]||Ye._default,s.innerHTML=d[1]+a.replace(Pe,"<$1></$2>")+d[2],o=d[0];o--;)s=s.lastChild;if(!te.leadingWhitespace&&Ne.test(a)&&g.push(t.createTextNode(Ne.exec(a)[0])),!te.tbody)for(o=(a="table"!==l||je.test(a)?"<table>"!==d[1]||je.test(a)?0:s:s.firstChild)&&a.childNodes.length;o--;)ie.nodeName(c=a.childNodes[o],"tbody")&&!c.childNodes.length&&a.removeChild(c);for(ie.merge(g,s.childNodes),s.textContent="";s.firstChild;)s.removeChild(s.firstChild);s=p.lastChild}else g.push(t.createTextNode(a));for(s&&p.removeChild(s),te.appendChecked||ie.grep(m(g,"input"),h),v=0;a=g[v++];)if((!n||-1===ie.inArray(a,n))&&(r=ie.contains(a.ownerDocument,a),s=m(p.appendChild(a),"script"),r&&E(s),i))for(o=0;a=s[o++];)Ge.test(a.type||"")&&i.push(a);return s=null,p},cleanData:function(e,t){for(var i,n,o,a,r=0,s=ie.expando,l=ie.cache,c=te.deleteExpando,d=ie.event.special;null!=(i=e[r]);r++)if((t||ie.acceptData(i))&&(o=i[s],a=o&&l[o])){if(a.events)for(n in a.events)d[n]?ie.event.remove(i,n):ie.removeEvent(i,n,a.handle);l[o]&&(delete l[o],c?delete i[s]:typeof i.removeAttribute!==be?i.removeAttribute(s):i[s]=null,Y.push(o))}}}),ie.fn.extend({text:function(e){return xe(this,function(e){return void 0===e?ie.text(this):this.empty().append((this[0]&&this[0].ownerDocument||pe).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){1!==this.nodeType&&11!==this.nodeType&&9!==this.nodeType||g(this,e).appendChild(e)})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=g(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){for(var i,n=e?ie.filter(e,this):this,o=0;null!=(i=n[o]);o++)t||1!==i.nodeType||ie.cleanData(m(i)),i.parentNode&&(t&&ie.contains(i.ownerDocument,i)&&E(m(i,"script")),i.parentNode.removeChild(i));return this},empty:function(){for(var e,t=0;null!=(e=this[t]);t++){for(1===e.nodeType&&ie.cleanData(m(e,!1));e.firstChild;)e.removeChild(e.firstChild);e.options&&ie.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null!=e&&e,t=null==t?e:t,this.map(function(){return ie.clone(this,e,t)})},html:function(e){return xe(this,function(e){var t=this[0]||{},i=0,n=this.length;if(void 0===e)return 1===t.nodeType?t.innerHTML.replace(Re,""):void 0;if("string"==typeof e&&!He.test(e)&&(te.htmlSerialize||!Fe.test(e))&&(te.leadingWhitespace||!Ne.test(e))&&!Ye[(Be.exec(e)||["",""])[1].toLowerCase()]){e=e.replace(Pe,"<$1></$2>");try{for(;i<n;i++)1===(t=this[i]||{}).nodeType&&(ie.cleanData(m(t,!1)),t.innerHTML=e);t=0}catch(e){}}t&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=arguments[0];return this.domManip(arguments,function(t){e=this.parentNode,ie.cleanData(m(this)),e&&e.replaceChild(t,this)}),e&&(e.length||e.nodeType)?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t){e=V.apply([],e);var i,n,o,a,r,s,l=0,c=this.length,d=this,u=c-1,p=e[0],f=ie.isFunction(p);if(f||c>1&&"string"==typeof p&&!te.checkClone&&qe.test(p))return this.each(function(i){var n=d.eq(i);f&&(e[0]=p.call(this,i,n.html())),n.domManip(e,t)});if(c&&(s=ie.buildFragment(e,this[0].ownerDocument,!1,this),i=s.firstChild,1===s.childNodes.length&&(s=i),i)){for(o=(a=ie.map(m(s,"script"),v)).length;l<c;l++)n=s,l!==u&&(n=ie.clone(n,!0,!0),o&&ie.merge(a,m(n,"script"))),t.call(this[l],n,l);if(o)for(r=a[a.length-1].ownerDocument,ie.map(a,y),l=0;l<o;l++)n=a[l],Ge.test(n.type||"")&&!ie._data(n,"globalEval")&&ie.contains(r,n)&&(n.src?ie._evalUrl&&ie._evalUrl(n.src):ie.globalEval((n.text||n.textContent||n.innerHTML||"").replace($e,"")));s=i=null}return this}}),ie.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){ie.fn[e]=function(e){for(var i,n=0,o=[],a=ie(e),r=a.length-1;n<=r;n++)i=n===r?this:this.clone(!0),ie(a[n])[t](i),J.apply(o,i.get());return this.pushStack(o)}});var Ve,Je={};!function(){var e,t,i=pe.createElement("div");i.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(e=i.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",te.opacity=/^0.5/.test(e.style.opacity),te.cssFloat=!!e.style.cssFloat,i.style.backgroundClip="content-box",i.cloneNode(!0).style.backgroundClip="",te.clearCloneStyle="content-box"===i.style.backgroundClip,e=i=null,te.shrinkWrapBlocks=function(){var e,i,n;if(null==t){if(!(e=pe.getElementsByTagName("body")[0]))return;"border:0;width:0;height:0;position:absolute;top:0;left:-9999px",i=pe.createElement("div"),n=pe.createElement("div"),e.appendChild(i).appendChild(n),t=!1,typeof n.style.zoom!==be&&(n.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0;width:1px;padding:1px;zoom:1",n.innerHTML="<div></div>",n.firstChild.style.width="5px",t=3!==n.offsetWidth),e.removeChild(i),e=i=n=null}return t}}();var Xe,Qe,Ke=/^margin/,Ze=new RegExp("^("+_e+")(?!px)[a-z%]+$","i"),et=/^(top|right|bottom|left)$/;window.getComputedStyle?(Xe=function(e){return e.ownerDocument.defaultView.getComputedStyle(e,null)},Qe=function(e,t,i){var n,o,a,r,s=e.style;return i=i||Xe(e),r=i?i.getPropertyValue(t)||i[t]:void 0,i&&(""!==r||ie.contains(e.ownerDocument,e)||(r=ie.style(e,t)),Ze.test(r)&&Ke.test(t)&&(n=s.width,o=s.minWidth,a=s.maxWidth,s.minWidth=s.maxWidth=s.width=r,r=i.width,s.width=n,s.minWidth=o,s.maxWidth=a)),void 0===r?r:r+""}):pe.documentElement.currentStyle&&(Xe=function(e){return e.currentStyle},Qe=function(e,t,i){var n,o,a,r,s=e.style;return i=i||Xe(e),null==(r=i?i[t]:void 0)&&s&&s[t]&&(r=s[t]),Ze.test(r)&&!et.test(t)&&(n=s.left,(a=(o=e.runtimeStyle)&&o.left)&&(o.left=e.currentStyle.left),s.left="fontSize"===t?"1em":r,r=s.pixelLeft+"px",s.left=n,a&&(o.left=a)),void 0===r?r:r+""||"auto"}),function(){function e(){var e,t,i=pe.getElementsByTagName("body")[0];i&&(e=pe.createElement("div"),t=pe.createElement("div"),e.style.cssText=s,i.appendChild(e).appendChild(t),t.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;position:absolute;display:block;padding:1px;border:1px;width:4px;margin-top:1%;top:1%",ie.swap(i,null!=i.style.zoom?{zoom:1}:{},function(){n=4===t.offsetWidth}),o=!0,a=!1,window.getComputedStyle&&(a="1%"!==(window.getComputedStyle(t,null)||{}).top,o="4px"===(window.getComputedStyle(t,null)||{width:"4px"}).width),i.removeChild(e),t=i=null)}var t,i,n,o,a,r=pe.createElement("div"),s="border:0;width:0;height:0;position:absolute;top:0;left:-9999px";r.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",(t=r.getElementsByTagName("a")[0]).style.cssText="float:left;opacity:.5",te.opacity=/^0.5/.test(t.style.opacity),te.cssFloat=!!t.style.cssFloat,r.style.backgroundClip="content-box",r.cloneNode(!0).style.backgroundClip="",te.clearCloneStyle="content-box"===r.style.backgroundClip,t=r=null,ie.extend(te,{reliableHiddenOffsets:function(){if(null!=i)return i;var e,t,n,o=pe.createElement("div"),a=pe.getElementsByTagName("body")[0];if(a)return o.setAttribute("className","t"),o.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=pe.createElement("div"),e.style.cssText=s,a.appendChild(e).appendChild(o),o.innerHTML="<table><tr><td></td><td>t</td></tr></table>",t=o.getElementsByTagName("td"),t[0].style.cssText="padding:0;margin:0;border:0;display:none",n=0===t[0].offsetHeight,t[0].style.display="",t[1].style.display="none",i=n&&0===t[0].offsetHeight,a.removeChild(e),o=a=null,i},boxSizing:function(){return null==n&&e(),n},boxSizingReliable:function(){return null==o&&e(),o},pixelPosition:function(){return null==a&&e(),a},reliableMarginRight:function(){var e,t,i,n,o=!0;if(window.getComputedStyle){if(!(e=pe.getElementsByTagName("body")[0]))return;t=pe.createElement("div"),i=pe.createElement("div"),t.style.cssText=s,e.appendChild(t).appendChild(i),(n=i.appendChild(pe.createElement("div"))).style.cssText=i.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;padding:0;margin:0;border:0",n.style.marginRight=n.style.width="0",i.style.width="1px",o=!parseFloat((window.getComputedStyle(n,null)||{}).marginRight),e.removeChild(t)}return o}})}(),ie.swap=function(e,t,i,n){var o,a,r={};for(a in t)r[a]=e.style[a],e.style[a]=t[a];o=i.apply(e,n||[]);for(a in t)e.style[a]=r[a];return o};var tt=/alpha\([^)]*\)/i,it=/opacity\s*=\s*([^)]*)/,nt=/^(none|table(?!-c[ea]).+)/,ot=new RegExp("^("+_e+")(.*)$","i"),at=new RegExp("^([+-])=("+_e+")","i"),rt={position:"absolute",visibility:"hidden",display:"block"},st={letterSpacing:0,fontWeight:400},lt=["Webkit","O","Moz","ms"];ie.extend({cssHooks:{opacity:{get:function(e,t){if(t){var i=Qe(e,"opacity");return""===i?"1":i}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{float:te.cssFloat?"cssFloat":"styleFloat"},style:function(e,t,i,n){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var o,a,r,s=ie.camelCase(t),l=e.style;if(t=ie.cssProps[s]||(ie.cssProps[s]=I(l,s)),r=ie.cssHooks[t]||ie.cssHooks[s],void 0===i)return r&&"get"in r&&void 0!==(o=r.get(e,!1,n))?o:l[t];if("string"===(a=typeof i)&&(o=at.exec(i))&&(i=(o[1]+1)*o[2]+parseFloat(ie.css(e,t)),a="number"),null!=i&&i===i&&("number"!==a||ie.cssNumber[s]||(i+="px"),te.clearCloneStyle||""!==i||0!==t.indexOf("background")||(l[t]="inherit"),!(r&&"set"in r&&void 0===(i=r.set(e,i,n)))))try{l[t]="",l[t]=i}catch(e){}}},css:function(e,t,i,n){var o,a,r,s=ie.camelCase(t);return t=ie.cssProps[s]||(ie.cssProps[s]=I(e.style,s)),(r=ie.cssHooks[t]||ie.cssHooks[s])&&"get"in r&&(a=r.get(e,!0,i)),void 0===a&&(a=Qe(e,t,n)),"normal"===a&&t in st&&(a=st[t]),""===i||i?(o=parseFloat(a),!0===i||ie.isNumeric(o)?o||0:a):a}}),ie.each(["height","width"],function(e,t){ie.cssHooks[t]={get:function(e,i,n){if(i)return 0===e.offsetWidth&&nt.test(ie.css(e,"display"))?ie.swap(e,rt,function(){return A(e,t,n)}):A(e,t,n)},set:function(e,i,n){var o=n&&Xe(e);return k(e,i,n?L(e,t,n,te.boxSizing()&&"border-box"===ie.css(e,"boxSizing",!1,o),o):0)}}}),te.opacity||(ie.cssHooks.opacity={get:function(e,t){return it.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var i=e.style,n=e.currentStyle,o=ie.isNumeric(t)?"alpha(opacity="+100*t+")":"",a=n&&n.filter||i.filter||"";i.zoom=1,(t>=1||""===t)&&""===ie.trim(a.replace(tt,""))&&i.removeAttribute&&(i.removeAttribute("filter"),""===t||n&&!n.filter)||(i.filter=tt.test(a)?a.replace(tt,o):a+" "+o)}}),ie.cssHooks.marginRight=w(te.reliableMarginRight,function(e,t){if(t)return ie.swap(e,{display:"inline-block"},Qe,[e,"marginRight"])}),ie.each({margin:"",padding:"",border:"Width"},function(e,t){ie.cssHooks[e+t]={expand:function(i){for(var n=0,o={},a="string"==typeof i?i.split(" "):[i];n<4;n++)o[e+we[n]+t]=a[n]||a[n-2]||a[0];return o}},Ke.test(e)||(ie.cssHooks[e+t].set=k)}),ie.fn.extend({css:function(e,t){return xe(this,function(e,t,i){var n,o,a={},r=0;if(ie.isArray(t)){for(n=Xe(e),o=t.length;r<o;r++)a[t[r]]=ie.css(e,t[r],!1,n);return a}return void 0!==i?ie.style(e,t,i):ie.css(e,t)},e,t,arguments.length>1)},show:function(){return x(this,!0)},hide:function(){return x(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){Ie(this)?ie(this).show():ie(this).hide()})}}),ie.Tween=T,T.prototype={constructor:T,init:function(e,t,i,n,o,a){this.elem=e,this.prop=i,this.easing=o||"swing",this.options=t,this.start=this.now=this.cur(),this.end=n,this.unit=a||(ie.cssNumber[i]?"":"px")},cur:function(){var e=T.propHooks[this.prop];return e&&e.get?e.get(this):T.propHooks._default.get(this)},run:function(e){var t,i=T.propHooks[this.prop];return this.options.duration?this.pos=t=ie.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):this.pos=t=e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),i&&i.set?i.set(this):T.propHooks._default.set(this),this}},T.prototype.init.prototype=T.prototype,T.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=ie.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){ie.fx.step[e.prop]?ie.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[ie.cssProps[e.prop]]||ie.cssHooks[e.prop])?ie.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},T.propHooks.scrollTop=T.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},ie.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},ie.fx=T.prototype.init,ie.fx.step={};var ct,dt,ut=/^(?:toggle|show|hide)$/,pt=new RegExp("^(?:([+-])=|)("+_e+")([a-z%]*)$","i"),ft=/queueHooks$/,mt=[R],ht={"*":[function(e,t){var i=this.createTween(e,t),n=i.cur(),o=pt.exec(t),a=o&&o[3]||(ie.cssNumber[e]?"":"px"),r=(ie.cssNumber[e]||"px"!==a&&+n)&&pt.exec(ie.css(i.elem,e)),s=1,l=20;if(r&&r[3]!==a){a=a||r[3],o=o||[],r=+n||1;do{r/=s=s||".5",ie.style(i.elem,e,r+a)}while(s!==(s=i.cur()/n)&&1!==s&&--l)}return o&&(r=i.start=+r||+n||0,i.unit=a,i.end=o[1]?r+(o[1]+1)*o[2]:+o[2]),i}]};ie.Animation=ie.extend(N,{tweener:function(e,t){ie.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");for(var i,n=0,o=e.length;n<o;n++)i=e[n],ht[i]=ht[i]||[],ht[i].unshift(t)},prefilter:function(e,t){t?mt.unshift(e):mt.push(e)}}),ie.speed=function(e,t,i){var n=e&&"object"==typeof e?ie.extend({},e):{complete:i||!i&&t||ie.isFunction(e)&&e,duration:e,easing:i&&t||t&&!ie.isFunction(t)&&t};return n.duration=ie.fx.off?0:"number"==typeof n.duration?n.duration:n.duration in ie.fx.speeds?ie.fx.speeds[n.duration]:ie.fx.speeds._default,null!=n.queue&&!0!==n.queue||(n.queue="fx"),n.old=n.complete,n.complete=function(){ie.isFunction(n.old)&&n.old.call(this),n.queue&&ie.dequeue(this,n.queue)},n},ie.fn.extend({fadeTo:function(e,t,i,n){return this.filter(Ie).css("opacity",0).show().end().animate({opacity:t},e,i,n)},animate:function(e,t,i,n){var o=ie.isEmptyObject(e),a=ie.speed(t,i,n),r=function(){var t=N(this,ie.extend({},e),a);(o||ie._data(this,"finish"))&&t.stop(!0)};return r.finish=r,o||!1===a.queue?this.each(r):this.queue(a.queue,r)},stop:function(e,t,i){var n=function(e){var t=e.stop;delete e.stop,t(i)};return"string"!=typeof e&&(i=t,t=e,e=void 0),t&&!1!==e&&this.queue(e||"fx",[]),this.each(function(){var t=!0,o=null!=e&&e+"queueHooks",a=ie.timers,r=ie._data(this);if(o)r[o]&&r[o].stop&&n(r[o]);else for(o in r)r[o]&&r[o].stop&&ft.test(o)&&n(r[o]);for(o=a.length;o--;)a[o].elem!==this||null!=e&&a[o].queue!==e||(a[o].anim.stop(i),t=!1,a.splice(o,1));!t&&i||ie.dequeue(this,e)})},finish:function(e){return!1!==e&&(e=e||"fx"),this.each(function(){var t,i=ie._data(this),n=i[e+"queue"],o=i[e+"queueHooks"],a=ie.timers,r=n?n.length:0;for(i.finish=!0,ie.queue(this,e,[]),o&&o.stop&&o.stop.call(this,!0),t=a.length;t--;)a[t].elem===this&&a[t].queue===e&&(a[t].anim.stop(!0),a.splice(t,1));for(t=0;t<r;t++)n[t]&&n[t].finish&&n[t].finish.call(this);delete i.finish})}}),ie.each(["toggle","show","hide"],function(e,t){var i=ie.fn[t];ie.fn[t]=function(e,n,o){return null==e||"boolean"==typeof e?i.apply(this,arguments):this.animate(D(t,!0),e,n,o)}}),ie.each({slideDown:D("show"),slideUp:D("hide"),slideToggle:D("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){ie.fn[e]=function(e,i,n){return this.animate(t,e,i,n)}}),ie.timers=[],ie.fx.tick=function(){var e,t=ie.timers,i=0;for(ct=ie.now();i<t.length;i++)(e=t[i])()||t[i]!==e||t.splice(i--,1);t.length||ie.fx.stop(),ct=void 0},ie.fx.timer=function(e){ie.timers.push(e),e()?ie.fx.start():ie.timers.pop()},ie.fx.interval=13,ie.fx.start=function(){dt||(dt=setInterval(ie.fx.tick,ie.fx.interval))},ie.fx.stop=function(){clearInterval(dt),dt=null},ie.fx.speeds={slow:600,fast:200,_default:400},ie.fn.delay=function(e,t){return e=ie.fx?ie.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,i){var n=setTimeout(t,e);i.stop=function(){clearTimeout(n)}})},function(){var e,t,i,n,o=pe.createElement("div");o.setAttribute("className","t"),o.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",e=o.getElementsByTagName("a")[0],n=(i=pe.createElement("select")).appendChild(pe.createElement("option")),t=o.getElementsByTagName("input")[0],e.style.cssText="top:1px",te.getSetAttribute="t"!==o.className,te.style=/top/.test(e.getAttribute("style")),te.hrefNormalized="/a"===e.getAttribute("href"),te.checkOn=!!t.value,te.optSelected=n.selected,te.enctype=!!pe.createElement("form").enctype,i.disabled=!0,te.optDisabled=!n.disabled,(t=pe.createElement("input")).setAttribute("value",""),te.input=""===t.getAttribute("value"),t.value="t",t.setAttribute("type","radio"),te.radioValue="t"===t.value,e=t=i=n=o=null}();var gt=/\r/g;ie.fn.extend({val:function(e){var t,i,n,o=this[0];{if(arguments.length)return n=ie.isFunction(e),this.each(function(i){var o;1===this.nodeType&&(null==(o=n?e.call(this,i,ie(this).val()):e)?o="":"number"==typeof o?o+="":ie.isArray(o)&&(o=ie.map(o,function(e){return null==e?"":e+""})),(t=ie.valHooks[this.type]||ie.valHooks[this.nodeName.toLowerCase()])&&"set"in t&&void 0!==t.set(this,o,"value")||(this.value=o))});if(o)return(t=ie.valHooks[o.type]||ie.valHooks[o.nodeName.toLowerCase()])&&"get"in t&&void 0!==(i=t.get(o,"value"))?i:(i=o.value,"string"==typeof i?i.replace(gt,""):null==i?"":i)}}}),ie.extend({valHooks:{option:{get:function(e){var t=ie.find.attr(e,"value");return null!=t?t:ie.text(e)}},select:{get:function(e){for(var t,i,n=e.options,o=e.selectedIndex,a="select-one"===e.type||o<0,r=a?null:[],s=a?o+1:n.length,l=o<0?s:a?o:0;l<s;l++)if(((i=n[l]).selected||l===o)&&(te.optDisabled?!i.disabled:null===i.getAttribute("disabled"))&&(!i.parentNode.disabled||!ie.nodeName(i.parentNode,"optgroup"))){if(t=ie(i).val(),a)return t;r.push(t)}return r},set:function(e,t){for(var i,n,o=e.options,a=ie.makeArray(t),r=o.length;r--;)if(n=o[r],ie.inArray(ie.valHooks.option.get(n),a)>=0)try{n.selected=i=!0}catch(e){n.scrollHeight}else n.selected=!1;return i||(e.selectedIndex=-1),o}}}}),ie.each(["radio","checkbox"],function(){ie.valHooks[this]={set:function(e,t){if(ie.isArray(t))return e.checked=ie.inArray(ie(e).val(),t)>=0}},te.checkOn||(ie.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var vt,yt,Et=ie.expr.attrHandle,bt=/^(?:checked|selected)$/i,St=te.getSetAttribute,Ct=te.input;ie.fn.extend({attr:function(e,t){return xe(this,ie.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){ie.removeAttr(this,e)})}}),ie.extend({attr:function(e,t,i){var n,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return typeof e.getAttribute===be?ie.prop(e,t,i):(1===a&&ie.isXMLDoc(e)||(t=t.toLowerCase(),n=ie.attrHooks[t]||(ie.expr.match.bool.test(t)?yt:vt)),void 0===i?n&&"get"in n&&null!==(o=n.get(e,t))?o:(o=ie.find.attr(e,t),null==o?void 0:o):null!==i?n&&"set"in n&&void 0!==(o=n.set(e,i,t))?o:(e.setAttribute(t,i+""),i):void ie.removeAttr(e,t))},removeAttr:function(e,t){var i,n,o=0,a=t&&t.match(ge);if(a&&1===e.nodeType)for(;i=a[o++];)n=ie.propFix[i]||i,ie.expr.match.bool.test(i)?Ct&&St||!bt.test(i)?e[n]=!1:e[ie.camelCase("default-"+i)]=e[n]=!1:ie.attr(e,i,""),e.removeAttribute(St?i:n)},attrHooks:{type:{set:function(e,t){if(!te.radioValue&&"radio"===t&&ie.nodeName(e,"input")){var i=e.value;return e.setAttribute("type",t),i&&(e.value=i),t}}}}}),yt={set:function(e,t,i){return!1===t?ie.removeAttr(e,i):Ct&&St||!bt.test(i)?e.setAttribute(!St&&ie.propFix[i]||i,i):e[ie.camelCase("default-"+i)]=e[i]=!0,i}},ie.each(ie.expr.match.bool.source.match(/\w+/g),function(e,t){var i=Et[t]||ie.find.attr;Et[t]=Ct&&St||!bt.test(t)?function(e,t,n){var o,a;return n||(a=Et[t],Et[t]=o,o=null!=i(e,t,n)?t.toLowerCase():null,Et[t]=a),o}:function(e,t,i){if(!i)return e[ie.camelCase("default-"+t)]?t.toLowerCase():null}}),Ct&&St||(ie.attrHooks.value={set:function(e,t,i){if(!ie.nodeName(e,"input"))return vt&&vt.set(e,t,i);e.defaultValue=t}}),St||(vt={set:function(e,t,i){var n=e.getAttributeNode(i);if(n||e.setAttributeNode(n=e.ownerDocument.createAttribute(i)),n.value=t+="","value"===i||t===e.getAttribute(i))return t}},Et.id=Et.name=Et.coords=function(e,t,i){var n;if(!i)return(n=e.getAttributeNode(t))&&""!==n.value?n.value:null},ie.valHooks.button={get:function(e,t){var i=e.getAttributeNode(t);if(i&&i.specified)return i.value},set:vt.set},ie.attrHooks.contenteditable={set:function(e,t,i){vt.set(e,""!==t&&t,i)}},ie.each(["width","height"],function(e,t){ie.attrHooks[t]={set:function(e,i){if(""===i)return e.setAttribute(t,"auto"),i}}})),te.style||(ie.attrHooks.style={get:function(e){return e.style.cssText||void 0},set:function(e,t){return e.style.cssText=t+""}});var _t=/^(?:input|select|textarea|button|object)$/i,wt=/^(?:a|area)$/i;ie.fn.extend({prop:function(e,t){return xe(this,ie.prop,e,t,arguments.length>1)},removeProp:function(e){return e=ie.propFix[e]||e,this.each(function(){try{this[e]=void 0,delete this[e]}catch(e){}})}}),ie.extend({propFix:{for:"htmlFor",class:"className"},prop:function(e,t,i){var n,o,a=e.nodeType;if(e&&3!==a&&8!==a&&2!==a)return(1!==a||!ie.isXMLDoc(e))&&(t=ie.propFix[t]||t,o=ie.propHooks[t]),void 0!==i?o&&"set"in o&&void 0!==(n=o.set(e,i,t))?n:e[t]=i:o&&"get"in o&&null!==(n=o.get(e,t))?n:e[t]},propHooks:{tabIndex:{get:function(e){var t=ie.find.attr(e,"tabindex");return t?parseInt(t,10):_t.test(e.nodeName)||wt.test(e.nodeName)&&e.href?0:-1}}}}),te.hrefNormalized||ie.each(["href","src"],function(e,t){ie.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),te.optSelected||(ie.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),ie.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){ie.propFix[this.toLowerCase()]=this}),te.enctype||(ie.propFix.enctype="encoding");var It=/[\t\r\n\f]/g;ie.fn.extend({addClass:function(e){var t,i,n,o,a,r,s=0,l=this.length,c="string"==typeof e&&e;if(ie.isFunction(e))return this.each(function(t){ie(this).addClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(ge)||[];s<l;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(It," "):" ")){for(a=0;o=t[a++];)n.indexOf(" "+o+" ")<0&&(n+=o+" ");r=ie.trim(n),i.className!==r&&(i.className=r)}return this},removeClass:function(e){var t,i,n,o,a,r,s=0,l=this.length,c=0===arguments.length||"string"==typeof e&&e;if(ie.isFunction(e))return this.each(function(t){ie(this).removeClass(e.call(this,t,this.className))});if(c)for(t=(e||"").match(ge)||[];s<l;s++)if(i=this[s],n=1===i.nodeType&&(i.className?(" "+i.className+" ").replace(It," "):"")){for(a=0;o=t[a++];)for(;n.indexOf(" "+o+" ")>=0;)n=n.replace(" "+o+" "," ");r=e?ie.trim(n):"",i.className!==r&&(i.className=r)}return this},toggleClass:function(e,t){var i=typeof e;return"boolean"==typeof t&&"string"===i?t?this.addClass(e):this.removeClass(e):ie.isFunction(e)?this.each(function(i){ie(this).toggleClass(e.call(this,i,this.className,t),t)}):this.each(function(){if("string"===i)for(var t,n=0,o=ie(this),a=e.match(ge)||[];t=a[n++];)o.hasClass(t)?o.removeClass(t):o.addClass(t);else i!==be&&"boolean"!==i||(this.className&&ie._data(this,"__className__",this.className),this.className=this.className||!1===e?"":ie._data(this,"__className__")||"")})},hasClass:function(e){for(var t=" "+e+" ",i=0,n=this.length;i<n;i++)if(1===this[i].nodeType&&(" "+this[i].className+" ").replace(It," ").indexOf(t)>=0)return!0;return!1}}),ie.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){ie.fn[t]=function(e,i){return arguments.length>0?this.on(t,null,e,i):this.trigger(t)}}),ie.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,i){return this.on(e,null,t,i)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,i,n){return this.on(t,e,i,n)},undelegate:function(e,t,i){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",i)}});var xt=ie.now(),kt=/\?/,Lt=/(,)|(\[|{)|(}|])|"(?:[^"\\\r\n]|\\["\\\/bfnrt]|\\u[\da-fA-F]{4})*"\s*:?|true|false|null|-?(?!0\d)\d+(?:\.\d+|)(?:[eE][+-]?\d+|)/g;ie.parseJSON=function(e){if(window.JSON&&window.JSON.parse)return window.JSON.parse(e+"");var t,i=null,n=ie.trim(e+"");return n&&!ie.trim(n.replace(Lt,function(e,n,o,a){return t&&n&&(i=0),0===i?e:(t=o||n,i+=!a-!o,"")}))?Function("return "+n)():ie.error("Invalid JSON: "+e)},ie.parseXML=function(e){var t,i;if(!e||"string"!=typeof e)return null;try{window.DOMParser?(i=new DOMParser,t=i.parseFromString(e,"text/xml")):((t=new ActiveXObject("Microsoft.XMLDOM")).async="false",t.loadXML(e))}catch(e){t=void 0}return t&&t.documentElement&&!t.getElementsByTagName("parsererror").length||ie.error("Invalid XML: "+e),t};var At,Tt,Ot=/#.*$/,Dt=/([?&])_=[^&]*/,Mt=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,Rt=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Ft=/^(?:GET|HEAD)$/,Nt=/^\/\//,Pt=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,Bt={},jt={},Ut="*/".concat("*");try{Tt=location.href}catch(e){(Tt=pe.createElement("a")).href="",Tt=Tt.href}At=Pt.exec(Tt.toLowerCase())||[],ie.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Tt,type:"GET",isLocal:Rt.test(At[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":Ut,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":ie.parseJSON,"text xml":ie.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?j(j(e,ie.ajaxSettings),t):j(ie.ajaxSettings,e)},ajaxPrefilter:P(Bt),ajaxTransport:P(jt),ajax:function(e,t){function i(e,t,i,n){var o,d,v,y,b,C=t;2!==E&&(E=2,s&&clearTimeout(s),c=void 0,r=n||"",S.readyState=e>0?4:0,o=e>=200&&e<300||304===e,i&&(y=U(u,S,i)),y=H(u,y,S,o),o?(u.ifModified&&((b=S.getResponseHeader("Last-Modified"))&&(ie.lastModified[a]=b),(b=S.getResponseHeader("etag"))&&(ie.etag[a]=b)),204===e||"HEAD"===u.type?C="nocontent":304===e?C="notmodified":(C=y.state,d=y.data,o=!(v=y.error))):(v=C,!e&&C||(C="error",e<0&&(e=0))),S.status=e,S.statusText=(t||C)+"",o?m.resolveWith(p,[d,C,S]):m.rejectWith(p,[S,C,v]),S.statusCode(g),g=void 0,l&&f.trigger(o?"ajaxSuccess":"ajaxError",[S,u,o?d:v]),h.fireWith(p,[S,C]),l&&(f.trigger("ajaxComplete",[S,u]),--ie.active||ie.event.trigger("ajaxStop")))}"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,o,a,r,s,l,c,d,u=ie.ajaxSetup({},t),p=u.context||u,f=u.context&&(p.nodeType||p.jquery)?ie(p):ie.event,m=ie.Deferred(),h=ie.Callbacks("once memory"),g=u.statusCode||{},v={},y={},E=0,b="canceled",S={readyState:0,getResponseHeader:function(e){var t;if(2===E){if(!d)for(d={};t=Mt.exec(r);)d[t[1].toLowerCase()]=t[2];t=d[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===E?r:null},setRequestHeader:function(e,t){var i=e.toLowerCase();return E||(e=y[i]=y[i]||e,v[e]=t),this},overrideMimeType:function(e){return E||(u.mimeType=e),this},statusCode:function(e){var t;if(e)if(E<2)for(t in e)g[t]=[g[t],e[t]];else S.always(e[S.status]);return this},abort:function(e){var t=e||b;return c&&c.abort(t),i(0,t),this}};if(m.promise(S).complete=h.add,S.success=S.done,S.error=S.fail,u.url=((e||u.url||Tt)+"").replace(Ot,"").replace(Nt,At[1]+"//"),u.type=t.method||t.type||u.method||u.type,u.dataTypes=ie.trim(u.dataType||"*").toLowerCase().match(ge)||[""],null==u.crossDomain&&(n=Pt.exec(u.url.toLowerCase()),u.crossDomain=!(!n||n[1]===At[1]&&n[2]===At[2]&&(n[3]||("http:"===n[1]?"80":"443"))===(At[3]||("http:"===At[1]?"80":"443")))),u.data&&u.processData&&"string"!=typeof u.data&&(u.data=ie.param(u.data,u.traditional)),B(Bt,u,t,S),2===E)return S;(l=u.global)&&0==ie.active++&&ie.event.trigger("ajaxStart"),u.type=u.type.toUpperCase(),u.hasContent=!Ft.test(u.type),a=u.url,u.hasContent||(u.data&&(a=u.url+=(kt.test(a)?"&":"?")+u.data,delete u.data),!1===u.cache&&(u.url=Dt.test(a)?a.replace(Dt,"$1_="+xt++):a+(kt.test(a)?"&":"?")+"_="+xt++)),u.ifModified&&(ie.lastModified[a]&&S.setRequestHeader("If-Modified-Since",ie.lastModified[a]),ie.etag[a]&&S.setRequestHeader("If-None-Match",ie.etag[a])),(u.data&&u.hasContent&&!1!==u.contentType||t.contentType)&&S.setRequestHeader("Content-Type",u.contentType),S.setRequestHeader("Accept",u.dataTypes[0]&&u.accepts[u.dataTypes[0]]?u.accepts[u.dataTypes[0]]+("*"!==u.dataTypes[0]?", "+Ut+"; q=0.01":""):u.accepts["*"]);for(o in u.headers)S.setRequestHeader(o,u.headers[o]);if(u.beforeSend&&(!1===u.beforeSend.call(p,S,u)||2===E))return S.abort();b="abort";for(o in{success:1,error:1,complete:1})S[o](u[o]);return c=B(jt,u,t,S),S.send=function(){S.readyState=1,l&&f.trigger("ajaxSend",[S,u]),u.async&&u.timeout>0&&(s=setTimeout(function(){S.abort("timeout")},u.timeout));try{E=1,c.send(v,i)}catch(e){if(!(E<2))throw e;i(-1,e)}},c?!1!==t.autostart&&S.send():i(-1,"No Transport"),S},getJSON:function(e,t,i){return ie.get(e,t,i,"json")},getScript:function(e,t){return ie.get(e,void 0,t,"script")}}),ie.each(["get","post"],function(e,t){ie[t]=function(e,i,n,o){return ie.isFunction(i)&&(o=o||n,n=i,i=void 0),ie.ajax({url:e,type:t,dataType:o,data:i,success:n})}}),ie.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){ie.fn[t]=function(e){return this.on(t,e)}}),ie._evalUrl=function(e){return ie.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,throws:!0})},ie.fn.extend({wrapAll:function(e){if(ie.isFunction(e))return this.each(function(t){ie(this).wrapAll(e.call(this,t))});if(this[0]){var t=ie(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){for(var e=this;e.firstChild&&1===e.firstChild.nodeType;)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return ie.isFunction(e)?this.each(function(t){ie(this).wrapInner(e.call(this,t))}):this.each(function(){var t=ie(this),i=t.contents();i.length?i.wrapAll(e):t.append(e)})},wrap:function(e){var t=ie.isFunction(e);return this.each(function(i){ie(this).wrapAll(t?e.call(this,i):e)})},unwrap:function(){return this.parent().each(function(){ie.nodeName(this,"body")||ie(this).replaceWith(this.childNodes)}).end()}}),ie.expr.filters.hidden=function(e){return e.offsetWidth<=0&&e.offsetHeight<=0||!te.reliableHiddenOffsets()&&"none"===(e.style&&e.style.display||ie.css(e,"display"))},ie.expr.filters.visible=function(e){return!ie.expr.filters.hidden(e)};var Ht=/%20/g,qt=/\[\]$/,Gt=/\r?\n/g,zt=/^(?:submit|button|image|reset|file)$/i,$t=/^(?:input|select|textarea|keygen)/i;ie.param=function(e,t){var i,n=[],o=function(e,t){t=ie.isFunction(t)?t():null==t?"":t,n[n.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(void 0===t&&(t=ie.ajaxSettings&&ie.ajaxSettings.traditional),ie.isArray(e)||e.jquery&&!ie.isPlainObject(e))ie.each(e,function(){o(this.name,this.value)});else for(i in e)q(i,e[i],t,o);return n.join("&").replace(Ht,"+")},ie.fn.extend({serialize:function(){return ie.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=ie.prop(this,"elements");return e?ie.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!ie(this).is(":disabled")&&$t.test(this.nodeName)&&!zt.test(e)&&(this.checked||!ke.test(e))}).map(function(e,t){var i=ie(this).val();return null==i?null:ie.isArray(i)?ie.map(i,function(e){return{name:t.name,value:e.replace(Gt,"\r\n")}}):{name:t.name,value:i.replace(Gt,"\r\n")}}).get()}}),ie.ajaxSettings.xhr=void 0!==window.ActiveXObject?function(){return!this.isLocal&&/^(get|post|head|put|delete|options)$/i.test(this.type)&&G()||z()}:G;var Yt=0,Wt={},Vt=ie.ajaxSettings.xhr();window.ActiveXObject&&ie(window).on("unload",function(){for(var e in Wt)Wt[e](void 0,!0)}),te.cors=!!Vt&&"withCredentials"in Vt,(Vt=te.ajax=!!Vt)&&ie.ajaxTransport(function(e){if(!e.crossDomain||te.cors){var t;return{send:function(i,n){var o,a=e.xhr(),r=++Yt;if(a.open(e.type,e.url,e.async,e.username,e.password),e.xhrFields)for(o in e.xhrFields)a[o]=e.xhrFields[o];e.mimeType&&a.overrideMimeType&&a.overrideMimeType(e.mimeType),e.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");for(o in i)void 0!==i[o]&&a.setRequestHeader(o,i[o]+"");a.send(e.hasContent&&e.data||null),t=function(i,o){var s,l,c;if(t&&(o||4===a.readyState))if(delete Wt[r],t=void 0,a.onreadystatechange=ie.noop,o)4!==a.readyState&&a.abort();else{c={},s=a.status,"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(e){l=""}s||!e.isLocal||e.crossDomain?1223===s&&(s=204):s=c.text?200:404}c&&n(s,l,c,a.getAllResponseHeaders())},e.async?4===a.readyState?setTimeout(t):a.onreadystatechange=Wt[r]=t:t()},abort:function(){t&&t(void 0,!0)}}}}),ie.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return ie.globalEval(e),e}}}),ie.ajaxPrefilter("script",function(e){void 0===e.cache&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),ie.ajaxTransport("script",function(e){if(e.crossDomain){var t,i=pe.head||ie("head")[0]||pe.documentElement;return{send:function(n,o){(t=pe.createElement("script")).async=!0,e.scriptCharset&&(t.charset=e.scriptCharset),t.src=e.url,t.onload=t.onreadystatechange=function(e,i){(i||!t.readyState||/loaded|complete/.test(t.readyState))&&(t.onload=t.onreadystatechange=null,t.parentNode&&t.parentNode.removeChild(t),t=null,i||o(200,"success"))},i.insertBefore(t,i.firstChild)},abort:function(){t&&t.onload(void 0,!0)}}}});var Jt=[],Xt=/(=)\?(?=&|$)|\?\?/;ie.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=Jt.pop()||ie.expando+"_"+xt++;return this[e]=!0,e}}),ie.ajaxPrefilter("json jsonp",function(e,t,i){var n,o,a,r=!1!==e.jsonp&&(Xt.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Xt.test(e.data)&&"data");if(r||"jsonp"===e.dataTypes[0])return n=e.jsonpCallback=ie.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,r?e[r]=e[r].replace(Xt,"$1"+n):!1!==e.jsonp&&(e.url+=(kt.test(e.url)?"&":"?")+e.jsonp+"="+n),e.converters["script json"]=function(){return a||ie.error(n+" was not called"),a[0]},e.dataTypes[0]="json",o=window[n],window[n]=function(){a=arguments},i.always(function(){window[n]=o,e[n]&&(e.jsonpCallback=t.jsonpCallback,Jt.push(n)),a&&ie.isFunction(o)&&o(a[0]),a=o=void 0}),"script"}),ie.parseHTML=function(e,t,i){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(i=t,t=!1),t=t||pe;var n=ce.exec(e),o=!i&&[];return n?[t.createElement(n[1])]:(n=ie.buildFragment([e],t,o),o&&o.length&&ie(o).remove(),ie.merge([],n.childNodes))};var Qt=ie.fn.load;ie.fn.load=function(e,t,i){if("string"!=typeof e&&Qt)return Qt.apply(this,arguments);var n,o,a,r=this,s=e.indexOf(" ");return s>=0&&(n=e.slice(s,e.length),e=e.slice(0,s)),ie.isFunction(t)?(i=t,t=void 0):t&&"object"==typeof t&&(a="POST"),r.length>0&&ie.ajax({url:e,type:a,dataType:"html",data:t}).done(function(e){o=arguments,r.html(n?ie("<div>").append(ie.parseHTML(e)).find(n):e)}).complete(i&&function(e,t){r.each(i,o||[e.responseText,t,e])}),this},ie.expr.filters.animated=function(e){return ie.grep(ie.timers,function(t){return e===t.elem}).length};var Kt=window.document.documentElement;ie.offset={setOffset:function(e,t,i){var n,o,a,r,s,l,c=ie.css(e,"position"),d=ie(e),u={};"static"===c&&(e.style.position="relative"),s=d.offset(),a=ie.css(e,"top"),l=ie.css(e,"left"),("absolute"===c||"fixed"===c)&&ie.inArray("auto",[a,l])>-1?(r=(n=d.position()).top,o=n.left):(r=parseFloat(a)||0,o=parseFloat(l)||0),ie.isFunction(t)&&(t=t.call(e,i,s)),null!=t.top&&(u.top=t.top-s.top+r),null!=t.left&&(u.left=t.left-s.left+o),"using"in t?t.using.call(e,u):d.css(u)}},ie.fn.extend({offset:function(e){if(arguments.length)return void 0===e?this:this.each(function(t){ie.offset.setOffset(this,e,t)});var t,i,n={top:0,left:0},o=this[0],a=o&&o.ownerDocument;if(a)return t=a.documentElement,ie.contains(t,o)?(typeof o.getBoundingClientRect!==be&&(n=o.getBoundingClientRect()),i=$(a),{top:n.top+(i.pageYOffset||t.scrollTop)-(t.clientTop||0),left:n.left+(i.pageXOffset||t.scrollLeft)-(t.clientLeft||0)}):n},position:function(){if(this[0]){var e,t,i={top:0,left:0},n=this[0];return"fixed"===ie.css(n,"position")?t=n.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),ie.nodeName(e[0],"html")||(i=e.offset()),i.top+=ie.css(e[0],"borderTopWidth",!0),i.left+=ie.css(e[0],"borderLeftWidth",!0)),{top:t.top-i.top-ie.css(n,"marginTop",!0),left:t.left-i.left-ie.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var e=this.offsetParent||Kt;e&&!ie.nodeName(e,"html")&&"static"===ie.css(e,"position");)e=e.offsetParent;return e||Kt})}}),ie.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,t){var i=/Y/.test(t);ie.fn[e]=function(n){return xe(this,function(e,n,o){var a=$(e);if(void 0===o)return a?t in a?a[t]:a.document.documentElement[n]:e[n];a?a.scrollTo(i?ie(a).scrollLeft():o,i?o:ie(a).scrollTop()):e[n]=o},e,n,arguments.length,null)}}),ie.each(["top","left"],function(e,t){ie.cssHooks[t]=w(te.pixelPosition,function(e,i){if(i)return i=Qe(e,t),Ze.test(i)?ie(e).position()[t]+"px":i})}),ie.each({Height:"height",Width:"width"},function(e,t){ie.each({padding:"inner"+e,content:t,"":"outer"+e},function(i,n){ie.fn[n]=function(n,o){var a=arguments.length&&(i||"boolean"!=typeof n),r=i||(!0===n||!0===o?"margin":"border");return xe(this,function(t,i,n){var o;return ie.isWindow(t)?t.document.documentElement["client"+e]:9===t.nodeType?(o=t.documentElement,Math.max(t.body["scroll"+e],o["scroll"+e],t.body["offset"+e],o["offset"+e],o["client"+e])):void 0===n?ie.css(t,i,r):ie.style(t,i,n,r)},t,a?n:void 0,a,null)}})}),ie.fn.size=function(){return this.length},ie.fn.andSelf=ie.fn.addBack,function(){var e,t;ie.uaMatch=function(e){e=e.toLowerCase();var t=/(chrome)[ \/]([\w.]+)/.exec(e)||/(webkit)[ \/]([\w.]+)/.exec(e)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(e)||/(msie) ([\w.]+)/.exec(e)||e.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(e)||[];return{browser:t[1]||"",version:t[2]||"0"}},t={},(e=ie.uaMatch(navigator.userAgent)).browser&&(t[e.browser]=!0,t.version=e.version),t.chrome?t.webkit=!0:t.webkit&&(t.safari=!0),ie.browser=t}(),ie.version="4.0",ie.long_version="4.0.32",ie.uid=function(e,t){return(e||"")+Math.random().toString().replace(".","")+(t||"")},ie.globalNamespace=ie.uid("Foundry"),window[ie.globalNamespace]=ie,ie.run=function(e){return ie.isFunction(e)?e(ie):null},ie.initialize=function(e){ie.initialized||(ie.extend(ie,e),"development"==ie.environment&&(window.F=ie),ie.initialized=!0,FD40.module.execute())},FD40.jquery(ie)}(),FD40.plugin("lodash",function(e){function t(e,t,i){for(var n=(i||0)-1,o=e?e.length:0;++n<o;)if(e[n]===t)return n;return-1}function i(e,i){var n=typeof i;if(e=e.cache,"boolean"==n||null==i)return e[i]?0:-1;"number"!=n&&"string"!=n&&(n="object");var o="number"==n?i:y+i;return e=(e=e[n])&&e[o],"object"==n?e&&t(e,i)>-1?0:-1:e?0:-1}function n(e){var t=this.cache,i=typeof e;if("boolean"==i||null==e)t[e]=!0;else{"number"!=i&&"string"!=i&&(i="object");var n="number"==i?e:y+e,o=t[i]||(t[i]={});"object"==i?(o[n]||(o[n]=[])).push(e):o[n]=!0}}function o(e){return e.charCodeAt(0)}function a(e,t){for(var i=e.criteria,n=t.criteria,o=-1,a=i.length;++o<a;){var r=i[o],s=n[o];if(r!==s){if(r>s||void 0===r)return 1;if(r<s||void 0===s)return-1}}return e.index-t.index}function r(e){var t=-1,i=e.length,o=e[0],a=e[i/2|0],r=e[i-1];if(o&&"object"==typeof o&&a&&"object"==typeof a&&r&&"object"==typeof r)return!1;var s=c();s.false=s.null=s.true=s.undefined=!1;var l=c();for(l.array=e,l.cache=s,l.push=n;++t<i;)l.push(e[t]);return l}function s(e){return"\\"+V[e]}function l(){return h.pop()||[]}function c(){return g.pop()||{array:null,cache:null,criteria:null,false:!1,index:0,null:!1,number:null,object:null,push:null,string:null,true:!1,undefined:!1,value:null}}function d(e){e.length=0,h.length<b&&h.push(e)}function u(e){var t=e.cache;t&&u(t),e.array=e.cache=e.criteria=e.object=e.number=e.string=e.value=null,g.length<b&&g.push(e)}function p(e,t,i){t||(t=0),void 0===i&&(i=e?e.length:0);for(var n=-1,o=i-t||0,a=Array(o<0?0:o);++n<o;)a[n]=e[t+n];return a}function f(e){function n(e){return e&&"object"==typeof e&&!Qi(e)&&Mi.call(e,"__wrapped__")?e:new h(e)}function h(e,t){this.__chain__=!!t,this.__wrapped__=e}function g(e){function t(){if(n){var e=p(n);Ri.apply(e,arguments)}if(this instanceof t){var a=V(i.prototype),r=i.apply(a,e||arguments);return Te(r)?r:a}return i.apply(o,e||arguments)}var i=e[0],n=e[2],o=e[4];return Xi(t,e),t}function b(e,t,i,n,o){if(i){var a=i(e);if(void 0!==a)return a}if(!Te(e))return e;var r=xi.call(e);if(!z[r])return e;var s=Vi[r];switch(r){case P:case B:return new s(+e);case U:case G:return new s(e);case q:return a=s(e.source,x.exec(e)),a.lastIndex=e.lastIndex,a}var c=Qi(e);if(t){var u=!n;n||(n=l()),o||(o=l());for(var f=n.length;f--;)if(n[f]==e)return o[f];a=c?s(e.length):{}}else a=c?p(e):an({},e);return c&&(Mi.call(e,"index")&&(a.index=e.index),Mi.call(e,"input")&&(a.input=e.input)),t?(n.push(e),o.push(a),(c?Xe:ln)(e,function(e,r){a[r]=b(e,t,i,n,o)}),u&&(d(n),d(o)),a):a}function V(e,t){return Te(e)?ji(e):{}}function X(e,t,i){if("function"!=typeof e)return Qt;if(void 0===t||!("prototype"in e))return e;var n=e.__bindData__;if(void 0===n&&(Ji.funcNames&&(n=!e.name),!(n=n||!Ji.funcDecomp))){var o=Oi.call(e);Ji.funcNames||(n=!k.test(o)),n||(n=O.test(o),Xi(e,n))}if(!1===n||!0!==n&&1&n[1])return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,o){return e.call(t,i,n,o)};case 4:return function(i,n,o,a){return e.call(t,i,n,o,a)}}return Rt(e,t)}function Q(e){function t(){var e=l?r:this;if(o){var m=p(o);Ri.apply(m,arguments)}if((a||d)&&(m||(m=p(arguments)),a&&Ri.apply(m,a),d&&m.length<s))return n|=16,Q([i,u?n:-4&n,m,null,r,s]);if(m||(m=arguments),c&&(i=e[f]),this instanceof t){e=V(i.prototype);var h=i.apply(e,m);return Te(h)?h:e}return i.apply(e,m)}var i=e[0],n=e[1],o=e[2],a=e[3],r=e[4],s=e[5],l=1&n,c=2&n,d=4&n,u=8&n,f=i;return Xi(t,e),t}function K(e,n){var o=-1,a=le(),s=e?e.length:0,l=s>=E&&a===t,c=[];if(l){var d=r(n);d?(a=i,n=d):l=!1}for(;++o<s;){var p=e[o];a(n,p)<0&&c.push(p)}return l&&u(n),c}function ee(e,t,i,n){for(var o=(n||0)-1,a=e?e.length:0,r=[];++o<a;){var s=e[o];if(s&&"object"==typeof s&&"number"==typeof s.length&&(Qi(s)||pe(s))){t||(s=ee(s,t,i));var l=-1,c=s.length,d=r.length;for(r.length+=c;++l<c;)r[d++]=s[l]}else i||r.push(s)}return r}function te(e,t,i,n,o,a){if(i){var r=i(e,t);if(void 0!==r)return!!r}if(e===t)return 0!==e||1/e==1/t;var s=typeof e,c=typeof t;if(!(e!==e||e&&W[s]||t&&W[c]))return!1;if(null==e||null==t)return e===t;var u=xi.call(e),p=xi.call(t);if(u==F&&(u=H),p==F&&(p=H),u!=p)return!1;switch(u){case P:case B:return+e==+t;case U:return e!=+e?t!=+t:0==e?1/e==1/t:e==+t;case q:case G:return e==Si(t)}var f=u==N;if(!f){var m=Mi.call(e,"__wrapped__"),h=Mi.call(t,"__wrapped__");if(m||h)return te(m?e.__wrapped__:e,h?t.__wrapped__:t,i,n,o,a);if(u!=H)return!1;var g=e.constructor,v=t.constructor;if(g!=v&&!(Ae(g)&&g instanceof g&&Ae(v)&&v instanceof v)&&"constructor"in e&&"constructor"in t)return!1}var y=!o;o||(o=l()),a||(a=l());for(var E=o.length;E--;)if(o[E]==e)return a[E]==t;var b=0;if(r=!0,o.push(e),a.push(t),f){if(E=e.length,b=t.length,(r=b==E)||n)for(;b--;){var S=E,C=t[b];if(n)for(;S--&&!(r=te(e[S],C,i,n,o,a)););else if(!(r=te(e[b],C,i,n,o,a)))break}}else sn(t,function(t,s,l){if(Mi.call(l,s))return b++,r=Mi.call(e,s)&&te(e[s],t,i,n,o,a)}),r&&!n&&sn(e,function(e,t,i){if(Mi.call(i,t))return r=--b>-1});return o.pop(),a.pop(),y&&(d(o),d(a)),r}function ie(e,t,i,n,o){(Qi(t)?Xe:ln)(t,function(t,a){var r,s,l=t,c=e[a];if(t&&((s=Qi(t))||cn(t))){for(var d=n.length;d--;)if(r=n[d]==t){c=o[d];break}if(!r){var u;i&&(u=void 0!==(l=i(c,t)))&&(c=l),u||(c=s?Qi(c)?c:[]:cn(c)?c:{}),n.push(t),o.push(c),u||ie(c,t,i,n,o)}}else i&&void 0===(l=i(c,t))&&(l=t),void 0!==l&&(c=l);e[a]=c})}function ne(e,t){return e+Ti(Wi()*(t-e+1))}function oe(e,n,o){var a=-1,s=le(),c=e?e.length:0,p=[],f=!n&&c>=E&&s===t,m=o||f?l():p;for(f&&(s=i,m=r(m));++a<c;){var h=e[a],g=o?o(h,a,e):h;(n?!a||m[m.length-1]!==g:s(m,g)<0)&&((o||f)&&m.push(g),p.push(h))}return f?(d(m.array),u(m)):o&&d(m),p}function ae(e){return function(t,i,o){var a={};i=n.createCallback(i,o,3);var r=-1,s=t?t.length:0;if("number"==typeof s)for(;++r<s;){var l=t[r];e(a,l,i(l,r,t),t)}else ln(t,function(t,n,o){e(a,t,i(t,n,o),o)});return a}}function re(e,t,i,n,o,a){var r=1&t,s=4&t,l=16&t,c=32&t;if(!(2&t)&&!Ae(e))throw new Ci;l&&!i.length&&(t&=-17,l=i=!1),c&&!n.length&&(t&=-33,c=n=!1);var d=e&&e.__bindData__;return d&&!0!==d?((d=p(d))[2]&&(d[2]=p(d[2])),d[3]&&(d[3]=p(d[3])),!r||1&d[1]||(d[4]=o),!r&&1&d[1]&&(t|=8),!s||4&d[1]||(d[5]=a),l&&Ri.apply(d[2]||(d[2]=[]),i),c&&Pi.apply(d[3]||(d[3]=[]),n),d[1]|=t,re.apply(null,d)):(1==t||17===t?g:Q)([e,t,i,n,o,a])}function se(e){return en[e]}function le(){var e=(e=n.indexOf)===vt?t:e;return e}function ce(e){return"function"==typeof e&&ki.test(e)}function de(e){var t,i;return!!(e&&xi.call(e)==H&&(t=e.constructor,!Ae(t)||t instanceof t))&&(sn(e,function(e,t){i=t}),void 0===i||Mi.call(e,i))}function ue(e){return tn[e]}function pe(e){return e&&"object"==typeof e&&"number"==typeof e.length&&xi.call(e)==F||!1}function fe(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i=t,t=!1),b(e,t,"function"==typeof i&&X(i,n,1))}function me(e,t,i){return b(e,!0,"function"==typeof t&&X(t,i,1))}function he(e,t){var i=V(e);return t?an(i,t):i}function ge(e,t,i){var o;return t=n.createCallback(t,i,3),ln(e,function(e,i,n){if(t(e,i,n))return o=i,!1}),o}function ve(e,t,i){var o;return t=n.createCallback(t,i,3),Ee(e,function(e,i,n){if(t(e,i,n))return o=i,!1}),o}function ye(e,t,i){var n=[];sn(e,function(e,t){n.push(t,e)});var o=n.length;for(t=X(t,i,3);o--&&!1!==t(n[o--],n[o],e););return e}function Ee(e,t,i){var n=Zi(e),o=n.length;for(t=X(t,i,3);o--;){var a=n[o];if(!1===t(e[a],a,e))break}return e}function be(e){var t=[];return sn(e,function(e,i){Ae(e)&&t.push(i)}),t.sort()}function Se(e,t){return!!e&&Mi.call(e,t)}function Ce(e){for(var t=-1,i=Zi(e),n=i.length,o={};++t<n;){var a=i[t];o[e[a]]=a}return o}function _e(e){return!0===e||!1===e||e&&"object"==typeof e&&xi.call(e)==P||!1}function we(e){return e&&"object"==typeof e&&xi.call(e)==B||!1}function Ie(e){return e&&1===e.nodeType||!1}function xe(e){var t=!0;if(!e)return t;var i=xi.call(e),n=e.length;return i==N||i==G||i==F||i==H&&"number"==typeof n&&Ae(e.splice)?!n:(ln(e,function(){return t=!1}),t)}function ke(e,t,i,n){return te(e,t,"function"==typeof i&&X(i,n,2))}function Le(e){return Hi(e)&&!qi(parseFloat(e))}function Ae(e){return"function"==typeof e}function Te(e){return!(!e||!W[typeof e])}function Oe(e){return Me(e)&&e!=+e}function De(e){return null===e}function Me(e){return"number"==typeof e||e&&"object"==typeof e&&xi.call(e)==U||!1}function Re(e){return e&&"object"==typeof e&&xi.call(e)==q||!1}function Fe(e){return"string"==typeof e||e&&"object"==typeof e&&xi.call(e)==G||!1}function Ne(e){return void 0===e}function Pe(e,t,i){var o={};return t=n.createCallback(t,i,3),ln(e,function(e,i,n){o[i]=t(e,i,n)}),o}function Be(e){var t=arguments,i=2;if(!Te(e))return e;if("number"!=typeof t[2]&&(i=t.length),i>3&&"function"==typeof t[i-2])var n=X(t[--i-1],t[i--],2);else i>2&&"function"==typeof t[i-1]&&(n=t[--i]);for(var o=p(arguments,1,i),a=-1,r=l(),s=l();++a<i;)ie(e,o[a],n,r,s);return d(r),d(s),e}function je(e,t,i){var o={};if("function"!=typeof t){var a=[];sn(e,function(e,t){a.push(t)});for(var r=-1,s=(a=K(a,ee(arguments,!0,!1,1))).length;++r<s;){var l=a[r];o[l]=e[l]}}else t=n.createCallback(t,i,3),sn(e,function(e,i,n){t(e,i,n)||(o[i]=e)});return o}function Ue(e){for(var t=-1,i=Zi(e),n=i.length,o=fi(n);++t<n;){var a=i[t];o[t]=[a,e[a]]}return o}function He(e,t,i){var o={};if("function"!=typeof t)for(var a=-1,r=ee(arguments,!0,!1,1),s=Te(e)?r.length:0;++a<s;){var l=r[a];l in e&&(o[l]=e[l])}else t=n.createCallback(t,i,3),sn(e,function(e,i,n){t(e,i,n)&&(o[i]=e)});return o}function qe(e,t,i,o){var a=Qi(e);if(null==i)if(a)i=[];else{var r=e&&e.constructor,s=r&&r.prototype;i=V(s)}return t&&(t=n.createCallback(t,o,4),(a?Xe:ln)(e,function(e,n,o){return t(i,e,n,o)})),i}function Ge(e){for(var t=-1,i=Zi(e),n=i.length,o=fi(n);++t<n;)o[t]=e[i[t]];return o}function ze(e){for(var t=arguments,i=-1,n=ee(t,!0,!1,1),o=t[2]&&t[2][t[1]]===e?1:n.length,a=fi(o);++i<o;)a[i]=e[n[i]];return a}function $e(e,t,i){var n=-1,o=le(),a=e?e.length:0,r=!1;return i=(i<0?zi(0,a+i):i)||0,Qi(e)?r=o(e,t,i)>-1:"number"==typeof a?r=(Fe(e)?e.indexOf(t,i):o(e,t,i))>-1:ln(e,function(e){if(++n>=i)return!(r=e===t)}),r}function Ye(e,t,i){var o=!0;t=n.createCallback(t,i,3);var a=-1,r=e?e.length:0;if("number"==typeof r)for(;++a<r&&(o=!!t(e[a],a,e)););else ln(e,function(e,i,n){return o=!!t(e,i,n)});return o}function We(e,t,i){var o=[];t=n.createCallback(t,i,3);var a=-1,r=e?e.length:0;if("number"==typeof r)for(;++a<r;){var s=e[a];t(s,a,e)&&o.push(s)}else ln(e,function(e,i,n){t(e,i,n)&&o.push(e)});return o}function Ve(e,t,i){t=n.createCallback(t,i,3);var o=-1,a=e?e.length:0;if("number"!=typeof a){var r;return ln(e,function(e,i,n){if(t(e,i,n))return r=e,!1}),r}for(;++o<a;){var s=e[o];if(t(s,o,e))return s}}function Je(e,t,i){var o;return t=n.createCallback(t,i,3),Qe(e,function(e,i,n){if(t(e,i,n))return o=e,!1}),o}function Xe(e,t,i){var n=-1,o=e?e.length:0;if(t=t&&void 0===i?t:X(t,i,3),"number"==typeof o)for(;++n<o&&!1!==t(e[n],n,e););else ln(e,t);return e}function Qe(e,t,i){var n=e?e.length:0;if(t=t&&void 0===i?t:X(t,i,3),"number"==typeof n)for(;n--&&!1!==t(e[n],n,e););else{var o=Zi(e);n=o.length,ln(e,function(e,i,a){return i=o?o[--n]:--n,t(a[i],i,a)})}return e}function Ke(e,t){var i=p(arguments,2),n=-1,o="function"==typeof t,a=e?e.length:0,r=fi("number"==typeof a?a:0);return Xe(e,function(e){r[++n]=(o?t:e[t]).apply(e,i)}),r}function Ze(e,t,i){var o=-1,a=e?e.length:0;if(t=n.createCallback(t,i,3),"number"==typeof a)for(var r=fi(a);++o<a;)r[o]=t(e[o],o,e);else r=[],ln(e,function(e,i,n){r[++o]=t(e,i,n)});return r}function et(e,t,i){var a=-1/0,r=a;if("function"!=typeof t&&i&&i[t]===e&&(t=null),null==t&&Qi(e))for(var s=-1,l=e.length;++s<l;){var c=e[s];c>r&&(r=c)}else t=null==t&&Fe(e)?o:n.createCallback(t,i,3),Xe(e,function(e,i,n){var o=t(e,i,n);o>a&&(a=o,r=e)});return r}function tt(e,t,i){var a=1/0,r=a;if("function"!=typeof t&&i&&i[t]===e&&(t=null),null==t&&Qi(e))for(var s=-1,l=e.length;++s<l;){var c=e[s];c<r&&(r=c)}else t=null==t&&Fe(e)?o:n.createCallback(t,i,3),Xe(e,function(e,i,n){var o=t(e,i,n);o<a&&(a=o,r=e)});return r}function it(e,t,i,o){if(!e)return i;var a=arguments.length<3;t=n.createCallback(t,o,4);var r=-1,s=e.length;if("number"==typeof s)for(a&&(i=e[++r]);++r<s;)i=t(i,e[r],r,e);else ln(e,function(e,n,o){i=a?(a=!1,e):t(i,e,n,o)});return i}function nt(e,t,i,o){var a=arguments.length<3;return t=n.createCallback(t,o,4),Qe(e,function(e,n,o){i=a?(a=!1,e):t(i,e,n,o)}),i}function ot(e,t,i){return t=n.createCallback(t,i,3),We(e,function(e,i,n){return!t(e,i,n)})}function at(e,t,i){if(e&&"number"!=typeof e.length&&(e=Ge(e)),null==t||i)return e?e[ne(0,e.length-1)]:m;var n=rt(e);return n.length=$i(zi(0,t),n.length),n}function rt(e){var t=-1,i=e?e.length:0,n=fi("number"==typeof i?i:0);return Xe(e,function(e){var i=ne(0,++t);n[t]=n[i],n[i]=e}),n}function st(e){var t=e?e.length:0;return"number"==typeof t?t:Zi(e).length}function lt(e,t,i){var o;t=n.createCallback(t,i,3);var a=-1,r=e?e.length:0;if("number"==typeof r)for(;++a<r&&!(o=t(e[a],a,e)););else ln(e,function(e,i,n){return!(o=t(e,i,n))});return!!o}function ct(e,t,i){var o=-1,r=Qi(t),s=e?e.length:0,p=fi("number"==typeof s?s:0);for(r||(t=n.createCallback(t,i,3)),Xe(e,function(e,i,n){var a=p[++o]=c();r?a.criteria=Ze(t,function(t){return e[t]}):(a.criteria=l())[0]=t(e,i,n),a.index=o,a.value=e}),s=p.length,p.sort(a);s--;){var f=p[s];p[s]=f.value,r||d(f.criteria),u(f)}return p}function dt(e){return e&&"number"==typeof e.length?p(e):Ge(e)}function ut(e){for(var t=-1,i=e?e.length:0,n=[];++t<i;){var o=e[t];o&&n.push(o)}return n}function pt(e){return K(e,ee(arguments,!0,!0,1))}function ft(e,t,i){var o=-1,a=e?e.length:0;for(t=n.createCallback(t,i,3);++o<a;)if(t(e[o],o,e))return o;return-1}function mt(e,t,i){var o=e?e.length:0;for(t=n.createCallback(t,i,3);o--;)if(t(e[o],o,e))return o;return-1}function ht(e,t,i){var o=0,a=e?e.length:0;if("number"!=typeof t&&null!=t){var r=-1;for(t=n.createCallback(t,i,3);++r<a&&t(e[r],r,e);)o++}else if(null==(o=t)||i)return e?e[0]:m;return p(e,0,$i(zi(0,o),a))}function gt(e,t,i,n){return"boolean"!=typeof t&&null!=t&&(n=i,i="function"!=typeof t&&n&&n[t]===e?null:t,t=!1),null!=i&&(e=Ze(e,i,n)),ee(e,t)}function vt(e,i,n){if("number"==typeof n){var o=e?e.length:0;n=n<0?zi(0,o+n):n||0}else if(n){var a=xt(e,i);return e[a]===i?a:-1}return t(e,i,n)}function yt(e,t,i){var o=0,a=e?e.length:0;if("number"!=typeof t&&null!=t){var r=a;for(t=n.createCallback(t,i,3);r--&&t(e[r],r,e);)o++}else o=null==t||i?1:t||o;return p(e,0,$i(zi(0,a-o),a))}function Et(){for(var e=[],n=-1,o=arguments.length,a=l(),s=le(),c=s===t,p=l();++n<o;){var f=arguments[n];(Qi(f)||pe(f))&&(e.push(f),a.push(c&&f.length>=E&&r(n?e[n]:p)))}var m=e[0],h=-1,g=m?m.length:0,v=[];e:for(;++h<g;){var y=a[0];if(f=m[h],(y?i(y,f):s(p,f))<0){for(n=o,(y||p).push(f);--n;)if(y=a[n],(y?i(y,f):s(e[n],f))<0)continue e;v.push(f)}}for(;o--;)(y=a[o])&&u(y);return d(a),d(p),v}function bt(e,t,i){var o=0,a=e?e.length:0;if("number"!=typeof t&&null!=t){var r=a;for(t=n.createCallback(t,i,3);r--&&t(e[r],r,e);)o++}else if(null==(o=t)||i)return e?e[a-1]:m;return p(e,zi(0,a-o))}function St(e,t,i){var n=e?e.length:0;for("number"==typeof i&&(n=(i<0?zi(0,n+i):$i(i,n-1))+1);n--;)if(e[n]===t)return n;return-1}function Ct(e){for(var t=arguments,i=0,n=t.length,o=e?e.length:0;++i<n;)for(var a=-1,r=t[i];++a<o;)e[a]===r&&(Ni.call(e,a--,1),o--);return e}function _t(e,t,i){e=+e||0,i="number"==typeof i?i:+i||1,null==t&&(t=e,e=0);for(var n=-1,o=zi(0,Li((t-e)/(i||1))),a=fi(o);++n<o;)a[n]=e,e+=i;return a}function wt(e,t,i){var o=-1,a=e?e.length:0,r=[];for(t=n.createCallback(t,i,3);++o<a;){var s=e[o];t(s,o,e)&&(r.push(s),Ni.call(e,o--,1),a--)}return r}function It(e,t,i){if("number"!=typeof t&&null!=t){var o=0,a=-1,r=e?e.length:0;for(t=n.createCallback(t,i,3);++a<r&&t(e[a],a,e);)o++}else o=null==t||i?1:zi(0,t);return p(e,o)}function xt(e,t,i,o){var a=0,r=e?e.length:a;for(t=(i=i?n.createCallback(i,o,1):Qt)(t);a<r;){var s=a+r>>>1;i(e[s])<t?a=s+1:r=s}return a}function kt(){return oe(ee(arguments,!0,!0))}function Lt(e,t,i,o){return"boolean"!=typeof t&&null!=t&&(o=i,i="function"!=typeof t&&o&&o[t]===e?null:t,t=!1),null!=i&&(i=n.createCallback(i,o,3)),oe(e,t,i)}function At(e){return K(e,p(arguments,1))}function Tt(){for(var e=-1,t=arguments.length;++e<t;){var i=arguments[e];if(Qi(i)||pe(i))var n=n?oe(K(n,i).concat(K(i,n))):i}return n||[]}function Ot(){for(var e=arguments.length>1?arguments:arguments[0],t=-1,i=e?et(fn(e,"length")):0,n=fi(i<0?0:i);++t<i;)n[t]=fn(e,t);return n}function Dt(e,t){var i=-1,n=e?e.length:0,o={};for(t||!n||Qi(e[0])||(t=[]);++i<n;){var a=e[i];t?o[a]=t[i]:a&&(o[a[0]]=a[1])}return o}function Mt(e,t){if(!Ae(t))throw new Ci;return function(){if(--e<1)return t.apply(this,arguments)}}function Rt(e,t){return arguments.length>2?re(e,17,p(arguments,2),null,t):re(e,1,null,null,t)}function Ft(e){for(var t=arguments.length>1?ee(arguments,!0,!1,1):be(e),i=-1,n=t.length;++i<n;){var o=t[i];e[o]=re(e[o],1,null,null,e)}return e}function Nt(e,t){return arguments.length>2?re(t,19,p(arguments,2),null,e):re(t,3,null,null,e)}function Pt(){for(var e=arguments,t=e.length;t--;)if(!Ae(e[t]))throw new Ci;return function(){for(var t=arguments,i=e.length;i--;)t=[e[i].apply(this,t)];return t[0]}}function Bt(e,t){return t="number"==typeof t?t:+t||e.length,re(e,4,null,null,null,t)}function jt(e,t,i){var n,o,a,r,s,l,c,d=0,u=!1,p=!0;if(!Ae(e))throw new Ci;if(t=zi(0,t)||0,!0===i){var f=!0;p=!1}else Te(i)&&(f=i.leading,u="maxWait"in i&&(zi(t,i.maxWait)||0),p="trailing"in i?i.trailing:p);var h=function(){var i=t-(hn()-r);if(i<=0){o&&Ai(o);var u=c;o=l=c=m,u&&(d=hn(),a=e.apply(s,n),l||o||(n=s=null))}else l=Fi(h,i)},g=function(){l&&Ai(l),o=l=c=m,(p||u!==t)&&(d=hn(),a=e.apply(s,n),l||o||(n=s=null))};return function(){if(n=arguments,r=hn(),s=this,c=p&&(l||!f),!1===u)var i=f&&!l;else{o||f||(d=r);var m=u-(r-d),v=m<=0;v?(o&&(o=Ai(o)),d=r,a=e.apply(s,n)):o||(o=Fi(g,m))}return v&&l?l=Ai(l):l||t===u||(l=Fi(h,t)),i&&(v=!0,a=e.apply(s,n)),!v||l||o||(n=s=null),a}}function Ut(e){if(!Ae(e))throw new Ci;var t=p(arguments,1);return Fi(function(){e.apply(m,t)},1)}function Ht(e,t){if(!Ae(e))throw new Ci;var i=p(arguments,2);return Fi(function(){e.apply(m,i)},t)}function qt(e,t){if(!Ae(e))throw new Ci;var i=function(){var n=i.cache,o=t?t.apply(this,arguments):y+arguments[0];return Mi.call(n,o)?n[o]:n[o]=e.apply(this,arguments)};return i.cache={},i.reset=function(){var e=i.cache,n=t?t.apply(this,arguments):y+arguments[0];Mi.call(e,n)&&delete e[n]},i}function Gt(e){var t,i;if(!Ae(e))throw new Ci;return function(){return t?i:(t=!0,i=e.apply(this,arguments),e=null,i)}}function zt(e){return re(e,16,p(arguments,1))}function $t(e){return re(e,32,null,p(arguments,1))}function Yt(e,t,i){var n=!0,o=!0;if(!Ae(e))throw new Ci;return!1===i?n=!1:Te(i)&&(n="leading"in i?i.leading:n,o="trailing"in i?i.trailing:o),$.leading=n,$.maxWait=t,$.trailing=o,jt(e,t,$)}function Wt(e,t){return re(t,16,[e])}function Vt(e){return function(){return e}}function Jt(e,t,i){var n=typeof e;if(null==e||"function"==n)return X(e,t,i);if("object"!=n)return ti(e);var o=Zi(e),a=o[0],r=e[a];return 1!=o.length||r!==r||Te(r)?function(t){for(var i=o.length,n=!1;i--&&(n=te(t[o[i]],e[o[i]],null,!0)););return n}:function(e){var t=e[a];return r===t&&(0!==r||1/r==1/t)}}function Xt(e){return null==e?"":Si(e).replace(on,se)}function Qt(e){return e}function Kt(e,t,i){var o=!0,a=t&&be(t);t&&(i||a.length)||(null==i&&(i=t),r=h,t=e,e=n,a=be(t)),!1===i?o=!1:Te(i)&&"chain"in i&&(o=i.chain);var r=e,s=Ae(r);Xe(a,function(i){var n=e[i]=t[i];s&&(r.prototype[i]=function(){var t=this.__chain__,i=this.__wrapped__,a=[i];Ri.apply(a,arguments);var s=n.apply(e,a);if(o||t){if(i===s&&Te(s))return this;(s=new r(s)).__chain__=t}return s})})}function Zt(){return e._=Ii,this}function ei(){}function ti(e){return function(t){return t[e]}}function ii(e,t,i){var n=null==e,o=null==t;if(null==i&&("boolean"==typeof e&&o?(i=e,e=1):o||"boolean"!=typeof t||(i=t,o=!0)),n&&o&&(t=1),e=+e||0,o?(t=e,e=0):t=+t||0,i||e%1||t%1){var a=Wi();return $i(e+a*(t-e+parseFloat("1e-"+((a+"").length-1))),t)}return ne(e,t)}function ni(e,t){if(e){var i=e[t];return Ae(i)?e[t]():i}}function oi(e,t,i){var o=n.templateSettings;e=Si(e||""),i=rn({},i,o);var a,r=rn({},i.imports,o.imports),l=Zi(r),c=Ge(r),d=0,u=i.interpolate||T,p="__p += '",f=bi((i.escape||T).source+"|"+u.source+"|"+(u===L?I:T).source+"|"+(i.evaluate||T).source+"|$","g");e.replace(f,function(t,i,n,o,r,l){return n||(n=o),p+=e.slice(d,l).replace(D,s),i&&(p+="' +\n__e("+i+") +\n'"),r&&(a=!0,p+="';\n"+r+";\n__p += '"),n&&(p+="' +\n((__t = ("+n+")) == null ? '' : __t) +\n'"),d=l+t.length,t}),p+="';\n";var h=i.variable,g=h;g||(p="with ("+(h="obj")+") {\n"+p+"\n}\n"),p=(a?p.replace(C,""):p).replace(_,"$1").replace(w,"$1;"),p="function("+h+") {\n"+(g?"":h+" || ("+h+" = {});\n")+"var __t, __p = '', __e = _.escape"+(a?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+p+"return __p\n}";var v="\n/*\n//# sourceURL="+(i.sourceURL||"/lodash/template/source["+R+++"]")+"\n*/";try{var y=gi(l,"return "+p+v).apply(m,c)}catch(e){throw e.source=p,e}return t?y(t):(y.source=p,y)}function ai(e,t,i){e=(e=+e)>-1?e:0;var n=-1,o=fi(e);for(t=X(t,i,1);++n<e;)o[n]=t(n);return o}function ri(e){return null==e?"":Si(e).replace(nn,ue)}function si(e){var t=++v;return Si(null==e?"":e)+t}function li(e){return e=new h(e),e.__chain__=!0,e}function ci(e,t){return t(e),e}function di(){return this.__chain__=!0,this}function ui(){return Si(this.__wrapped__)}function pi(){return this.__wrapped__}var fi=(e=e?Z.defaults(J.Object(),e,Z.pick(J,M)):J).Array,mi=e.Boolean,hi=e.Date,gi=e.Function,vi=e.Math,yi=e.Number,Ei=e.Object,bi=e.RegExp,Si=e.String,Ci=e.TypeError,_i=[],wi=Ei.prototype,Ii=e._,xi=wi.toString,ki=bi("^"+Si(xi).replace(/[.*+?^${}()|[\]\\]/g,"\\$&").replace(/toString| for [^\]]+/g,".*?")+"$"),Li=vi.ceil,Ai=e.clearTimeout,Ti=vi.floor,Oi=gi.prototype.toString,Di=ce(Di=Ei.getPrototypeOf)&&Di,Mi=wi.hasOwnProperty,Ri=_i.push,Fi=e.setTimeout,Ni=_i.splice,Pi=_i.unshift,Bi=function(){try{var e={},t=ce(t=Ei.defineProperty)&&t,i=t(e,e,e)&&t}catch(e){}return i}(),ji=ce(ji=Ei.create)&&ji,Ui=ce(Ui=fi.isArray)&&Ui,Hi=e.isFinite,qi=e.isNaN,Gi=ce(Gi=Ei.keys)&&Gi,zi=vi.max,$i=vi.min,Yi=e.parseInt,Wi=vi.random,Vi={};Vi[N]=fi,Vi[P]=mi,Vi[B]=hi,Vi[j]=gi,Vi[H]=Ei,Vi[U]=yi,Vi[q]=bi,Vi[G]=Si,h.prototype=n.prototype;var Ji=n.support={};Ji.funcDecomp=!ce(e.WinRTError)&&O.test(f),Ji.funcNames="string"==typeof gi.name,n.templateSettings={escape:/<%-([\s\S]+?)%>/g,evaluate:/<%([\s\S]+?)%>/g,interpolate:L,variable:"",imports:{_:n}},ji||(V=function(){function t(){}return function(i){if(Te(i)){t.prototype=i;var n=new t;t.prototype=null}return n||e.Object()}}());var Xi=Bi?function(e,t){Y.value=t,Bi(e,"__bindData__",Y)}:ei,Qi=Ui||function(e){return e&&"object"==typeof e&&"number"==typeof e.length&&xi.call(e)==N||!1},Ki=function(e){var t,i=e,n=[];if(!i)return n;if(!W[typeof e])return n;for(t in i)Mi.call(i,t)&&n.push(t);return n},Zi=Gi?function(e){return Te(e)?Gi(e):[]}:Ki,en={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},tn=Ce(en),nn=bi("("+Zi(tn).join("|")+")","g"),on=bi("["+Zi(en).join("")+"]","g"),an=function(e,t,i){var n,o=e,a=o;if(!o)return a;var r=arguments,s=0,l="number"==typeof i?2:r.length;if(l>3&&"function"==typeof r[l-2])var c=X(r[--l-1],r[l--],2);else l>2&&"function"==typeof r[l-1]&&(c=r[--l]);for(;++s<l;)if((o=r[s])&&W[typeof o])for(var d=-1,u=W[typeof o]&&Zi(o),p=u?u.length:0;++d<p;)a[n=u[d]]=c?c(a[n],o[n]):o[n];return a},rn=function(e,t,i){var n,o=e,a=o;if(!o)return a;for(var r=arguments,s=0,l="number"==typeof i?2:r.length;++s<l;)if((o=r[s])&&W[typeof o])for(var c=-1,d=W[typeof o]&&Zi(o),u=d?d.length:0;++c<u;)void 0===a[n=d[c]]&&(a[n]=o[n]);return a},sn=function(e,t,i){var n,o=e,a=o;if(!o)return a;if(!W[typeof o])return a;t=t&&void 0===i?t:X(t,i,3);for(n in o)if(!1===t(o[n],n,e))return a;return a},ln=function(e,t,i){var n,o=e,a=o;if(!o)return a;if(!W[typeof o])return a;t=t&&void 0===i?t:X(t,i,3);for(var r=-1,s=W[typeof o]&&Zi(o),l=s?s.length:0;++r<l;)if(n=s[r],!1===t(o[n],n,e))return a;return a},cn=Di?function(e){if(!e||xi.call(e)!=H)return!1;var t=e.valueOf,i=ce(t)&&(i=Di(t))&&Di(i);return i?e==i||Di(e)==i:de(e)}:de,dn=ae(function(e,t,i){Mi.call(e,i)?e[i]++:e[i]=1}),un=ae(function(e,t,i){(Mi.call(e,i)?e[i]:e[i]=[]).push(t)}),pn=ae(function(e,t,i){e[i]=t}),fn=Ze,mn=We,hn=ce(hn=hi.now)&&hn||function(){return(new hi).getTime()},gn=8==Yi(S+"08")?Yi:function(e,t){return Yi(Fe(e)?e.replace(A,""):e,t||0)};return n.after=Mt,n.assign=an,n.at=ze,n.bind=Rt,n.bindAll=Ft,n.bindKey=Nt,n.chain=li,n.compact=ut,n.compose=Pt,n.constant=Vt,n.countBy=dn,n.create=he,n.createCallback=Jt,n.curry=Bt,n.debounce=jt,n.defaults=rn,n.defer=Ut,n.delay=Ht,n.difference=pt,n.filter=We,n.flatten=gt,n.forEach=Xe,n.forEachRight=Qe,n.forIn=sn,n.forInRight=ye,n.forOwn=ln,n.forOwnRight=Ee,n.functions=be,n.groupBy=un,n.indexBy=pn,n.initial=yt,n.intersection=Et,n.invert=Ce,n.invoke=Ke,n.keys=Zi,n.map=Ze,n.mapValues=Pe,n.max=et,n.memoize=qt,n.merge=Be,n.min=tt,n.omit=je,n.once=Gt,n.pairs=Ue,n.partial=zt,n.partialRight=$t,n.pick=He,n.pluck=fn,n.property=ti,n.pull=Ct,n.range=_t,n.reject=ot,n.remove=wt,n.rest=It,n.shuffle=rt,n.sortBy=ct,n.tap=ci,n.throttle=Yt,n.times=ai,n.toArray=dt,n.transform=qe,n.union=kt,n.uniq=Lt,n.values=Ge,n.where=mn,n.without=At,n.wrap=Wt,n.xor=Tt,n.zip=Ot,n.zipObject=Dt,n.collect=Ze,n.drop=It,n.each=Xe,n.eachRight=Qe,n.extend=an,n.methods=be,n.object=Dt,n.select=We,n.tail=It,n.unique=Lt,n.unzip=Ot,Kt(n),n.clone=fe,n.cloneDeep=me,n.contains=$e,n.escape=Xt,n.every=Ye,n.find=Ve,n.findIndex=ft,n.findKey=ge,n.findLast=Je,n.findLastIndex=mt,n.findLastKey=ve,n.has=Se,n.identity=Qt,n.indexOf=vt,n.isArguments=pe,n.isArray=Qi,n.isBoolean=_e,n.isDate=we,n.isElement=Ie,n.isEmpty=xe,n.isEqual=ke,n.isFinite=Le,n.isFunction=Ae,n.isNaN=Oe,n.isNull=De,n.isNumber=Me,n.isObject=Te,n.isPlainObject=cn,n.isRegExp=Re,n.isString=Fe,n.isUndefined=Ne,n.lastIndexOf=St,n.mixin=Kt,n.noConflict=Zt,n.noop=ei,n.now=hn,n.parseInt=gn,n.random=ii,n.reduce=it,n.reduceRight=nt,n.result=ni,n.runInContext=f,n.size=st,n.some=lt,n.sortedIndex=xt,n.template=oi,n.unescape=ri,n.uniqueId=si,n.all=Ye,n.any=lt,n.detect=Ve,n.findWhere=Ve,n.foldl=it,n.foldr=nt,n.include=$e,n.inject=it,Kt(function(){var e={};return ln(n,function(t,i){n.prototype[i]||(e[i]=t)}),e}(),!1),n.first=ht,n.last=bt,n.sample=at,n.take=ht,n.head=ht,ln(n,function(e,t){var i="sample"!==t;n.prototype[t]||(n.prototype[t]=function(t,n){var o=this.__chain__,a=e(this.__wrapped__,t,n);return o||null!=t&&(!n||i&&"function"==typeof t)?new h(a,o):a})}),n.VERSION="2.4.1",n.prototype.chain=di,n.prototype.toString=ui,n.prototype.value=pi,n.prototype.valueOf=pi,Xe(["join","pop","shift"],function(e){var t=_i[e];n.prototype[e]=function(){var e=this.__chain__,i=t.apply(this.__wrapped__,arguments);return e?new h(i,e):i}}),Xe(["push","reverse","sort","unshift"],function(e){var t=_i[e];n.prototype[e]=function(){return t.apply(this.__wrapped__,arguments),this}}),Xe(["concat","slice","splice"],function(e){var t=_i[e];n.prototype[e]=function(){return new h(t.apply(this.__wrapped__,arguments),this.__chain__)}}),n}var m,h=[],g=[],v=0,y=+new Date+"",E=75,b=40,S=" \t\v\f \ufeff\n\r\u2028\u2029",C=/\b__p \+= '';/g,_=/\b(__p \+=) '' \+/g,w=/(__e\(.*?\)|\b__t\)) \+\n'';/g,I=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,x=/\w*$/,k=/^\s*function[ \n\r\t]+\w/,L=/<%=([\s\S]+?)%>/g,A=RegExp("^["+S+"]*0+(?=.$)"),T=/($^)/,O=/\bthis\b/,D=/['\n\r\t\u2028\u2029\\]/g,M=["Array","Boolean","Date","Function","Math","Number","Object","RegExp","String","_","attachEvent","clearTimeout","isFinite","isNaN","parseInt","setTimeout"],R=0,F="[object Arguments]",N="[object Array]",P="[object Boolean]",B="[object Date]",j="[object Function]",U="[object Number]",H="[object Object]",q="[object RegExp]",G="[object String]",z={};z[j]=!1,z[F]=z[N]=z[P]=z[B]=z[U]=z[H]=z[q]=z[G]=!0;var $={leading:!1,maxWait:0,trailing:!1},Y={configurable:!1,enumerable:!1,value:null,writable:!1},W={boolean:!1,function:!0,object:!0,number:!1,string:!1,undefined:!1},V={"\\":"\\","'":"'","\n":"n","\r":"r","\t":"t","\u2028":"u2028","\u2029":"u2029"},J=W[typeof window]&&window||this,X=W[typeof exports]&&exports&&!exports.nodeType&&exports,Q=W[typeof module]&&module&&!module.nodeType&&module,K=(Q&&Q.exports,W[typeof global]&&global);!K||K.global!==K&&K.window!==K||(J=K);var Z=e._=f();e.each(Z,function(t,i){Object.hasOwnProperty.call(Z,t)&&!/VERSION/.test(name)&&(e[t]||(e[t]=i))})}),FD40.plugin("bootstrap3",function(e){var t=e;if(window["Foundry/Bootstrap"])throw new Error("An instance of Bootstrap has been initialized before this.");window["Foundry/Bootstrap"]={version:"3.0.3",foundry:t},function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var i in t)if(void 0!==e.style[i])return{end:t[i]}}e.fn.emulateTransitionEnd=function(t){var i=!1,n=this;e(this).one(e.support.transition.end,function(){i=!0});var o=function(){i||e(n).trigger(e.support.transition.end)};return setTimeout(o,t),this},e(function(){e.support.transition=t()})}(t),function(e){"use strict";var t='[data-bs-dismiss="alert"]',i=function(i){e(i).on("click",t,this.close)};i.prototype.close=function(t){function i(){a.trigger("closed.bs.alert").remove()}var n=e(this),o=n.attr("data-target");o||(o=(o=n.attr("href"))&&o.replace(/.*(?=#[^\s]*$)/,""));var a=e(o);t&&t.preventDefault(),a.length||(a=n.hasClass("alert")?n:n.parent()),a.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(a.removeClass("in"),e.support.transition&&a.hasClass("fade")?a.one(e.support.transition.end,i).emulateTransitionEnd(150):i())};var n=e.fn.alert;e.fn.alert=function(t){return this.each(function(){var n=e(this),o=n.data("bs.alert");o||n.data("bs.alert",o=new i(this)),"string"==typeof t&&o[t].call(n)})},e.fn.alert.Constructor=i,e.fn.alert.noConflict=function(){return e.fn.alert=n,this},e(document).on("click.bs.alert.data-api",t,i.prototype.close)}(t),function(e){"use strict";var t=function(i,n){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,n)};t.DEFAULTS={loadingText:"loading..."},t.prototype.setState=function(e){var t="disabled",i=this.$element,n=i.is("input")?"val":"html",o=i.data();e+="Text",o.resetText||i.data("resetText",i[n]()),i[n](o[e]||this.options[e]),setTimeout(function(){"loadingText"==e?i.addClass(t).attr(t,t):i.removeClass(t).removeAttr(t)},0)},t.prototype.toggle=function(){var e=this.$element.closest('[data-bs-toggle="buttons"]'),t=!0;if(e.length){var i=this.$element.find("input");"radio"===i.prop("type")&&(i.prop("checked")&&this.$element.hasClass("active")?t=!1:e.find(".active").removeClass("active")),t&&i.prop("checked",!this.$element.hasClass("active")).trigger("change")}t&&this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=function(i){return this.each(function(){var n=e(this),o=n.data("bs.button"),a="object"==typeof i&&i;o||n.data("bs.button",o=new t(this,a)),"toggle"==i?o.toggle():i&&o.setState(i)})},e.fn.button.Constructor=t,e.fn.button.noConflict=function(){return e.fn.button=i,this},e(document).on("click.bs.button.data-api","[data-bs-toggle^=button]",function(t){var i=e(t.target);i.hasClass("btn")||(i=i.closest(".btn")),i.button("toggle"),t.preventDefault()})}(t),function(e){"use strict";var t=function(t,i){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=i,this.paused=this.sliding=this.interval=this.$active=this.$items=null,"hover"==this.options.pause&&this.$element.on("mouseenter",e.proxy(this.pause,this)).on("mouseleave",e.proxy(this.cycle,this))};t.DEFAULTS={interval:5e3,pause:"hover",wrap:!0},t.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},t.prototype.getActiveIndex=function(){return this.$active=this.$element.find(".item.active"),this.$items=this.$active.parent().children(),this.$items.index(this.$active)},t.prototype.to=function(t){var i=this,n=this.getActiveIndex();if(!(t>this.$items.length-1||t<0))return this.sliding?this.$element.one("slid.bs.carousel",function(){i.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",e(this.$items[t]))},t.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition.end&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},t.prototype.next=function(){if(!this.sliding)return this.slide("next")},t.prototype.prev=function(){if(!this.sliding)return this.slide("prev")},t.prototype.slide=function(t,i){var n=this.$element.find(".item.active"),o=i||n[t](),a=this.interval,r="next"==t?"left":"right",s="next"==t?"first":"last",l=this;if(!o.length){if(!this.options.wrap)return;o=this.$element.find(".item")[s]()}this.sliding=!0,a&&this.pause();var c=e.Event("slide.bs.carousel",{relatedTarget:o[0],direction:r});if(!o.hasClass("active")){if(this.$indicators.length&&(this.$indicators.find(".active").removeClass("active"),this.$element.one("slid.bs.carousel",function(){var t=e(l.$indicators.children()[l.getActiveIndex()]);t&&t.addClass("active")})),e.support.transition&&this.$element.hasClass("slide")){if(this.$element.trigger(c),c.isDefaultPrevented())return;o.addClass(t),o[0].offsetWidth,n.addClass(r),o.addClass(r),n.one(e.support.transition.end,function(){o.removeClass([t,r].join(" ")).addClass("active"),n.removeClass(["active",r].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger("slid.bs.carousel")},0)}).emulateTransitionEnd(600)}else{if(this.$element.trigger(c),c.isDefaultPrevented())return;n.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger("slid.bs.carousel")}return a&&this.cycle(),this}};var i=e.fn.carousel;e.fn.carousel=function(i){return this.each(function(){var n=e(this),o=n.data("bs.carousel"),a=e.extend({},t.DEFAULTS,n.data(),"object"==typeof i&&i),r="string"==typeof i?i:a.slide;o||n.data("bs.carousel",o=new t(this,a)),"number"==typeof i?o.to(i):r?o[r]():a.interval&&o.pause().cycle()})},e.fn.carousel.Constructor=t,e.fn.carousel.noConflict=function(){return e.fn.carousel=i,this},e(document).on("click.bs.carousel.data-api","[data-bs-slide], [data-bs-slide-to]",function(t){var i,n=e(this),o=e(n.attr("data-target")||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,"")),a=e.extend({},o.data(),n.data()),r=n.attr("data-bs-slide-to");r&&(a.interval=!1),o.carousel(a),(r=n.attr("data-bs-slide-to"))&&o.data("bs.carousel").to(r),t.preventDefault()}),e(window).on("load",function(){e('[data-bs-ride="carousel"]').each(function(){var t=e(this);t.carousel(t.data())})})}(t),function(e){"use strict";var t=function(i,n){this.$element=e(i),this.options=e.extend({},t.DEFAULTS,n),this.transitioning=null,this.options.parent&&(this.$parent=e(this.options.parent)),this.options.toggle&&this.toggle()};t.DEFAULTS={toggle:!0},t.prototype.dimension=function(){return this.$element.hasClass("width")?"width":"height"},t.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t=e.Event("show.bs.collapse");if(this.$element.triggerHandler(t),!t.isDefaultPrevented()){var i=this.$parent&&this.$parent.find("> .panel > .in");if(i&&i.length){var n=i.data("bs.collapse");if(n&&n.transitioning)return;i.collapse("hide"),n||i.data("bs.collapse",null)}var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("in")[o]("auto"),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return a.call(this);var r=e.camelCase(["scroll",o].join("-"));this.$element.one(e.support.transition.end,e.proxy(a,this)).emulateTransitionEnd(350)[o](this.$element[0][r])}}},t.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.triggerHandler(t),!t.isDefaultPrevented()){var i=this.dimension();this.$element[i](this.$element[i]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse").removeClass("in"),this.transitioning=1;var n=function(){this.transitioning=0,this.$element.trigger("hidden.bs.collapse").removeClass("collapsing").addClass("collapse")};if(!e.support.transition)return n.call(this);this.$element[i](0).one(e.support.transition.end,e.proxy(n,this)).emulateTransitionEnd(350)}}},t.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()};var i=e.fn.collapse;e.fn.collapse=function(i){return this.each(function(){var n=e(this),o=n.data("bs.collapse"),a=e.extend({},t.DEFAULTS,n.data(),"object"==typeof i&&i);o||n.data("bs.collapse",o=new t(this,a)),"string"==typeof i&&o[i]()})},e.fn.collapse.Constructor=t,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api","[data-bs-toggle=collapse]",function(t){var i,n=e(this),o=n.attr("data-target")||t.preventDefault()||(i=n.attr("href"))&&i.replace(/.*(?=#[^\s]+$)/,""),a=e(o),r=a.data("bs.collapse"),s=r?"toggle":n.data(),l=n.attr("data-parent"),c=l&&e(l);r&&r.transitioning||(c&&c.find('[data-bs-toggle=collapse][data-parent="'+l+'"]').not(n).addClass("collapsed"),n[a.hasClass("in")?"addClass":"removeClass"]("collapsed")),a.collapse(s)})}(t),function(e){"use strict";function t(){e(n).remove(),e(o).each(function(t){var n=i(e(this));n.hasClass("open")&&(n.triggerHandler(t=e.Event("hide.bs.dropdown")),t.isDefaultPrevented()||n.removeClass("open").trigger("hidden.bs.dropdown"))})}function i(t){var i=t.attr("data-target");i||(i=(i=t.attr("href"))&&/#/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,""));var n=i&&e(i);return n&&n.length?n:t.parent()}var n=".dropdown-backdrop",o="[data-bs-toggle=dropdown]",a=function(t){e(t).on("click.bs.dropdown",this.toggle)};a.prototype.toggle=function(n){var o=e(this);if(!o.is(".disabled, :disabled")){var a=i(o),r=a.hasClass("open");if(t(),!r){if("ontouchstart"in document.documentElement&&!a.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t),a.triggerHandler(n=e.Event("show.bs.dropdown")),n.isDefaultPrevented())return;a.toggleClass("open").trigger("shown.bs.dropdown"),o.focus()}return!1}},a.prototype.keydown=function(t){if(/(38|40|27)/.test(t.keyCode)){var n=e(this);if(t.preventDefault(),t.stopPropagation(),!n.is(".disabled, :disabled")){var a=i(n),r=a.hasClass("open");if(!r||r&&27==t.keyCode)return 27==t.which&&a.find(o).focus(),n.click();var s=e("[role=menu] li:not(.divider):visible a",a);if(s.length){var l=s.index(s.filter(":focus"));38==t.keyCode&&l>0&&l--,40==t.keyCode&&l<s.length-1&&l++,~l||(l=0),s.eq(l).focus()}}}};var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var i=e(this),n=i.data("bs.dropdown");n||i.data("bs.dropdown",n=new a(this)),"string"==typeof t&&n[t].call(i)})},e.fn.dropdown.Constructor=a,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=r,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown_ form, .dropdown-static",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",o,a.prototype.toggle).on("keydown.bs.dropdown.data-api",o+", [role=menu]",a.prototype.keydown)}(t),function(e){"use strict";var t=function(t,i){this.options=i,this.$element=e(t),this.$backdrop=this.isShown=null,this.options.remote&&this.$element.load(this.options.remote)};t.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},t.prototype.toggle=function(e){return this[this.isShown?"hide":"show"](e)},t.prototype.show=function(t){var i=this,n=e.Event("show.bs.modal",{relatedTarget:t});this.$element.triggerHandler(n),this.isShown||n.isDefaultPrevented()||(this.isShown=!0,this.escape(),this.$element.on("click.dismiss.modal",'[data-bs-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var n=e.support.transition&&i.$element.hasClass("fade");i.$element.parent().length||i.$element.appendTo(document.body),i.$element.show(),n&&i.$element[0].offsetWidth,i.$element.addClass("in").attr("aria-hidden",!1),i.enforceFocus();var o=e.Event("shown.bs.modal",{relatedTarget:t});n?i.$element.find(".modal-dialog").one(e.support.transition.end,function(){i.$element.focus().trigger(o)}).emulateTransitionEnd(300):i.$element.focus().trigger(o)}))},t.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.triggerHandler(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one(e.support.transition.end,e.proxy(this.hideModal,this)).emulateTransitionEnd(300):this.hideModal())},t.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.focus()},this))},t.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keyup.dismiss.bs.modal")},t.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.removeBackdrop(),e.$element.trigger("hidden.bs.modal")})},t.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},t.prototype.backdrop=function(t){var i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var n=e.support.transition&&i;if(this.$backdrop=e('<div class="modal-backdrop '+i+'" />').appendTo(document.body),this.$element.on("click.dismiss.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),n&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;n?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()}else!this.isShown&&this.$backdrop?(this.$backdrop.removeClass("in"),e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one(e.support.transition.end,t).emulateTransitionEnd(150):t()):t&&t()};var i=e.fn.modal;e.fn.modal=function(i,n){return this.each(function(){var o=e(this),a=o.data("bs.modal"),r=e.extend({},t.DEFAULTS,o.data(),"object"==typeof i&&i);a||o.data("bs.modal",a=new t(this,r)),"string"==typeof i?a[i](n):r.show&&a.show(n)})},e.fn.modal.Constructor=t,e.fn.modal.noConflict=function(){return e.fn.modal=i,this},e(document).on("click.bs.modal.data-api",'[data-bs-toggle="modal"]',function(t){var i=e(this),n=i.attr("href"),o=e(i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"")),a=o.data("modal")?"toggle":e.extend({remote:!/#/.test(n)&&n},o.data(),i.data());t.preventDefault(),o.modal(a,this).one("hide",function(){i.is(":visible")&&i.focus()})}),e(document).on("show.bs.modal",".modal.bs",function(){e(document.body).addClass("modal-open")}).on("hidden.bs.modal",".modal.bs",function(){e(document.body).removeClass("modal-open")})}(t),function(e){"use strict";var t=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};t.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1},t.prototype.init=function(t,i,n){this.enabled=!0,this.type=t,this.$element=e(i),this.options=this.getOptions(n);for(var o=this.options.trigger.split(" "),a=o.length;a--;){var r=o[a];if("click"==r)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=r){var s="hover"==r?"mouseenter":"focus",l="hover"==r?"mouseleave":"blur";this.$element.on(s+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(l+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.getOptions=function(t){return(t=e.extend({},this.getDefaults(),this.$element.data(),t)).delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},t.prototype.getDelegateOptions=function(){var t={},i=this.getDefaults();return this._options&&e.each(this._options,function(e,n){i[e]!=n&&(t[e]=n)}),t},t.prototype.enter=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(i.timeout),i.hoverState="in",!i.options.delay||!i.options.delay.show)return i.show();i.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)},t.prototype.leave=function(t){var i=t instanceof this.constructor?t:e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type);if(clearTimeout(i.timeout),i.hoverState="out",!i.options.delay||!i.options.delay.hide)return i.hide();i.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)},t.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){if(this.$element.triggerHandler(t),t.isDefaultPrevented())return;var i=this.tip();this.setContent(),this.options.animation&&i.addClass("fade");var n="function"==typeof this.options.placement?this.options.placement.call(this,i[0],this.$element[0]):this.options.placement,o=/\s?auto?\s?/i,a=o.test(n);a&&(n=n.replace(o,"")||"top"),i.detach().css({top:0,left:0,display:"block"}).addClass(n.split("-")[0]),this.options.container?i.appendTo(this.options.container):i.insertAfter(this.$element);var r=this.getPosition(),s=i[0].offsetWidth,l=i[0].offsetHeight;if(a){var c=this.$element.parent(),d=n,u=document.documentElement.scrollTop||document.body.scrollTop,p="body"==this.options.container?window.innerWidth:c.outerWidth(),f="body"==this.options.container?window.innerHeight:c.outerHeight(),m="body"==this.options.container?0:c.offset().left;n="bottom"==n&&r.top+r.height+l-u>f?"top":"top"==n&&r.top-u-l<0?"bottom":"right"==n&&r.right+s>p?"left":"left"==n&&r.left-s<m?"right":n,i.removeClass(d).addClass(n)}var h=this.getCalculatedOffset(n,r,s,l);this.applyPlacement(h,n),this.$element.trigger("shown.bs."+this.type)}},t.prototype.applyPlacement=function(e,t){var i,n=this.tip(),o=n[0].offsetWidth,a=n[0].offsetHeight,r=parseInt(n.css("margin-top"),10),s=parseInt(n.css("margin-left"),10);isNaN(r)&&(r=0),isNaN(s)&&(s=0),e.top=e.top+r,e.left=e.left+s,n.offset(e).addClass("in");var l=n[0].offsetWidth,c=n[0].offsetHeight;if("top"==t&&c!=a&&(i=!0,e.top=e.top+a-c),0===["top","bottom"].indexOf(t.split("-")[0])){var d=0;e.left<0&&(d=-2*e.left,e.left=0,n.offset(e),l=n[0].offsetWidth,c=n[0].offsetHeight),this.replaceArrow(d-o+l,l,"left")}0===["left","right"].indexOf(t.split("-")[0])&&this.replaceArrow(c-a,c,"top"),i&&n.offset(e)},t.prototype.replaceArrow=function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},t.prototype.hide=function(){function t(){"in"!=i.hoverState&&n.detach()}var i=this,n=this.tip(),o=e.Event("hide.bs."+this.type);if(this.$element.triggerHandler(o),!o.isDefaultPrevented())return n.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?n.one(e.support.transition.end,t).emulateTransitionEnd(150):t(),this.$element.trigger("hidden.bs."+this.type),this},t.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},t.prototype.hasContent=function(){return this.getTitle()},t.prototype.getPosition=function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},t.prototype.getCalculatedOffset=function(e,t,i,n){return"left-top"==e?{top:t.top,left:t.left-i}:"left-bottom"==e?{top:t.top+t.height-n,left:t.left-i}:"right-top"==e?{top:t.top,left:t.left+t.width}:"right-bottom"==e?{top:t.top+t.height-n,left:t.left+t.width}:"top-left"==e?{top:t.top-n,left:t.left}:"top-right"==e?{top:t.top-n,left:t.left+t.width-i}:"bottom-left"==e?{top:t.top+t.height,left:t.left}:"bottom-right"==e?{top:t.top+t.height,left:t.left+t.width-i}:"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-i/2}:"top"==e?{top:t.top-n,left:t.left+t.width/2-i/2}:"left"==e?{top:t.top+t.height/2-n/2,left:t.left-i}:{top:t.top+t.height/2-n/2,left:t.left+t.width}},t.prototype.getTitle=function(){var e=this.$element,t=this.options;return e.attr("data-original-title")||("function"==typeof t.title?t.title.call(e[0]):t.title)},t.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},t.prototype.validate=function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},t.prototype.enable=function(){this.enabled=!0},t.prototype.disable=function(){this.enabled=!1},t.prototype.toggleEnabled=function(){this.enabled=!this.enabled},t.prototype.toggle=function(t){var i=t?e(t.currentTarget)[this.type](this.getDelegateOptions()).data("bs."+this.type):this;i.tip().hasClass("in")?i.leave(i):i.enter(i)},t.prototype.destroy=function(){this.hide().$element.off("."+this.type).removeData("bs."+this.type)};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),o=n.data("bs.tooltip"),a="object"==typeof i&&i;o||n.data("bs.tooltip",o=new t(this,a)),"string"==typeof i&&o[i]()})},e.fn.tooltip.Constructor=t,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=i,this}}(t),function(e){"use strict";var t=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");t.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div id="fd" class="fd-popover"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'}),(t.prototype=e.extend({},e.fn.tooltip.Constructor.prototype)).constructor=t,t.prototype.getDefaults=function(){return t.DEFAULTS},t.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),i=this.getContent();e.find(".fd-popover-title")[this.options.html?"html":"text"](t),e.find(".fd-popover-content")[this.options.html?"html":"text"](i),e.removeClass("fade top bottom left right in"),e.find(".fd-popover-title").html()||e.find(".fd-popover-title").hide()},t.prototype.hasContent=function(){return this.getTitle()||this.getContent()},t.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},t.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},t.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var i=e.fn.popover;e.fn.popover=function(i){return this.each(function(){var n=e(this),o=n.data("bs.popover"),a="object"==typeof i&&i;o||n.data("bs.popover",o=new t(this,a)),"string"==typeof i&&o[i]()})},e.fn.popover.Constructor=t,e.fn.popover.noConflict=function(){return e.fn.popover=i,this}}(t),function(e){"use strict";function t(i,n){var o,a=e.proxy(this.process,this);this.$element=e(e(i).is("body")?window:i),this.$body=e("body"),this.$scrollElement=this.$element.on("scroll.bs.scroll-spy.data-api",a),this.options=e.extend({},t.DEFAULTS,n),this.selector=(this.options.target||(o=e(i).attr("href"))&&o.replace(/.*(?=#[^\s]+$)/,"")||"")+" .nav li > a",this.offsets=e([]),this.targets=e([]),this.activeTarget=null,this.refresh(),this.process()}t.DEFAULTS={offset:10},t.prototype.refresh=function(){var t=this.$element[0]==window?"offset":"position";this.offsets=e([]),this.targets=e([]);var i=this;this.$body.find(this.selector).map(function(){var n=e(this),o=n.data("target")||n.attr("href"),a=/^#\w/.test(o)&&e(o);return a&&a.length&&[[a[t]().top+(!e.isWindow(i.$scrollElement.get(0))&&i.$scrollElement.scrollTop()),o]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){i.offsets.push(this[0]),i.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,i=(this.$scrollElement[0].scrollHeight||this.$body[0].scrollHeight)-this.$scrollElement.height(),n=this.offsets,o=this.targets,a=this.activeTarget;if(t>=i)return a!=(e=o.last()[0])&&this.activate(e);for(e=n.length;e--;)a!=o[e]&&t>=n[e]&&(!n[e+1]||t<=n[e+1])&&this.activate(o[e])},t.prototype.activate=function(t){this.activeTarget=t,e(this.selector).parents(".active").removeClass("active");var i=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',n=e(i).parents("li").addClass("active");n.parent(".dropdown-menu").length&&(n=n.closest("li.dropdown").addClass("active")),n.trigger("activate.bs.scrollspy")};var i=e.fn.scrollspy;e.fn.scrollspy=function(i){return this.each(function(){var n=e(this),o=n.data("bs.scrollspy"),a="object"==typeof i&&i;o||n.data("bs.scrollspy",o=new t(this,a)),"string"==typeof i&&o[i]()})},e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=i,this},e(window).on("load",function(){e('[data-bs-spy="scroll"]').each(function(){var t=e(this);t.scrollspy(t.data())})})}(t),function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype.show=function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.data("target");if(n||(n=(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var o=i.find(".active:last a")[0],a=e.Event("show.bs.tab",{relatedTarget:o});if(t.triggerHandler(a),!a.isDefaultPrevented()){var r=e(n);this.activate(t.parent("li"),i),this.activate(r,r.parent(),function(){t.trigger({type:"shown.bs.tab",relatedTarget:o})})}}},t.prototype.activate=function(t,i,n){function o(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active"),t.addClass("active"),r?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active"),n&&n()}var a=i.find("> .active"),r=n&&e.support.transition&&a.hasClass("fade");r?a.one(e.support.transition.end,o).emulateTransitionEnd(150):o(),a.removeClass("in")};var i=e.fn.tab;e.fn.tab=function(i){return this.each(function(){var n=e(this),o=n.data("bs.tab");o||n.data("bs.tab",o=new t(this)),"string"==typeof i&&o[i]()})},e.fn.tab.Constructor=t,e.fn.tab.noConflict=function(){return e.fn.tab=i,this},e(document).on("click.bs.tab.data-api",'[data-bs-toggle="tab"], [data-bs-toggle="pill"]',function(t){t.preventDefault(),e(this).tab("show")})}(t),function(e){"use strict";var t=function(i,n){this.options=e.extend({},t.DEFAULTS,n),this.$window=e(window).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(i),this.affixed=this.unpin=null,this.checkPosition()};t.RESET="affix affix-top affix-bottom",t.DEFAULTS={offset:0},t.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},t.prototype.checkPosition=function(){if(this.$element.is(":visible")){var i=e(document).height(),n=this.$window.scrollTop(),o=this.$element.offset(),a=this.options.offset,r=a.top,s=a.bottom;"object"!=typeof a&&(s=r=a),"function"==typeof r&&(r=a.top()),"function"==typeof s&&(s=a.bottom());var l=!(null!=this.unpin&&n+this.unpin<=o.top)&&(null!=s&&o.top+this.$element.height()>=i-s?"bottom":null!=r&&n<=r&&"top");this.affixed!==l&&(this.unpin&&this.$element.css("top",""),this.affixed=l,this.unpin="bottom"==l?o.top-n:null,this.$element.removeClass(t.RESET).addClass("affix"+(l?"-"+l:"")),"bottom"==l&&this.$element.offset({top:document.body.offsetHeight-s-this.$element.height()}))}};var i=e.fn.affix;e.fn.affix=function(i){return this.each(function(){var n=e(this),o=n.data("bs.affix"),a="object"==typeof i&&i;o||n.data("bs.affix",o=new t(this,a)),"string"==typeof i&&o[i]()})},e.fn.affix.Constructor=t,e.fn.affix.noConflict=function(){return e.fn.affix=i,this},e(window).on("load",function(){e('[data-bs-spy="affix"]').each(function(){var t=e(this),i=t.data();i.offset=i.offset||{},i.offsetBottom&&(i.offset.bottom=i.offsetBottom),i.offsetTop&&(i.offset.top=i.offsetTop),t.affix(i)})})}(t),function(e){var t=function(t,i){if(this.$element=e(t),this.$note=e('<div class="alert"></div>'),this.options=e.extend(!0,e.fn.notify.defaults,i),this.options.transition?"fade"==this.options.transition?this.$note.addClass("in").addClass(this.options.transition):this.$note.addClass(this.options.transition):this.$note.addClass("fade").addClass("in"),this.options.type?this.$note.addClass("alert-"+this.options.type):this.$note.addClass("alert-success"),this.options.message||""===this.$element.data("message")?"object"==typeof this.options.message&&(this.options.message.html?this.$note.html(this.options.message.html):this.options.message.text?this.$note.text(this.options.message.text):this.$note.html(this.options.message)):this.$note.html(this.$element.data("message")),this.options.closable)var n=e('<a class="close pull-right" href="javascript: void(0);">&times;</a>');return e(n).on("click",e.proxy(onClose,this)),this.$note.prepend(n),this};onClose=function(){this.options.onClose(),e(this.$note).remove(),this.options.onClosed()},t.prototype.show=function(){this.options.fadeOut.enabled&&this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",e.proxy(onClose,this)),this.$element.append(this.$note),this.$note.alert()},t.prototype.hide=function(){this.options.fadeOut.enabled?this.$note.delay(this.options.fadeOut.delay||3e3).fadeOut("slow",e.proxy(onClose,this)):onClose.call(this)},e.fn.notify=function(e){return new t(this,e)},e.fn.notify.defaults={type:"success",closable:!0,transition:"fade",fadeOut:{enabled:!0,delay:3e3},message:null,onClose:function(){},onClosed:function(){}}}(e)}),FD40.plugin("responsive",function(e){var t={elementWidth:function(e){return e.outerWidth(!0)}};e.responsive=function(i,n){e.isArray(n)&&(n={conditions:n});var n=e.extend({},t,n);return new o(i,n)},e.fn.responsive=function(t){return t&&e.responsive(e(this),t),this};var i=e(window),n=e.isFunction,o=function(t,n){var a=this;e(t).each(function(){e(this);var t=e(this).data("$responsive");t instanceof o&&t.destroy()}),e.extend(a,{elem:t,options:n,conditions:e.sortBy(e.makeArray(n.conditions),function(e){return e.at}),event:"resize.responsive."+e.uid(),handler:e.debounce(function(){a.set()},250)}),delete n.conditions,e(function(){i.on(a.event,a.handler),a.set()}),e(window).load(function(){a.set()})};e.extend(o.prototype,{set:function(){var t=this,i=t.options.elementWidth;e(t.elem).each(function(){var o=e(this),a=n(i)?i(o):i;e(o).data("$responsive",t),t.removeCondition(o.data("currentCondition"),o),e.each(t.conditions,function(e,i){var n=i.at;if(a<=n)return t.applyCondition(i,o),!1})})},applyCondition:function(t,i){var o,a,r,s;(o=t.switchTo)&&i.addClass(o),(a=t.alsoSwitch)&&e.each(a,function(t,i){e(t).addClass(i)}),(r=t.switchStylesheet)&&e.each(e.makeArray(r),function(t,i){e('link[href$="'+i+'"]').length<1&&e("<link/>").attr({rel:"stylesheet",type:"text/css",href:i}).appendTo("head")}),(s=t.whenApplied)&&n(s)&&s(),i.data("currentCondition",t).trigger("responsive",[t])},removeCondition:function(t,i){if(t){var o,a,r,s;(o=t.switchTo)&&i.removeClass(o),(a=t.alsoSwitch)&&e.each(a,function(t,i){e(t).removeClass(i)}),(r=t.switchStylesheet)&&e.each(e.makeArray(r),function(t,i){e('link[href$="'+i+'"]').remove()}),(s=t.whenRemoved)&&n(s)&&s(),i.removeData("currentCondition")}},resetToDefault:function(t){var i=this,n=e(i.elem);e.each(i.conditions,function(e,o){t&&e==t||i.removeCondition(o,n)})},destroy:function(){if(!t.destroyed){i.off(this.event);var t=this;e(t.elem).each(function(){var i=e(this);t.removeCondition(i.data("currentCondition"),i),i.removeData("$responsive")}),t.destroyed=!0}}})}),FD40.plugin("utils",function(e){!function(){var t=function(e){this.items=e,this.start=0,this.end=e.length-1,this.node=null,this.stopped=!1};e.extend(t.prototype,{isLooping:function(){return!this.stopped&&(Math.abs(this.start-this.end)>1&&(this.node=Math.floor((this.start+this.end)/2),!0))},flip:function(e){e?this.end=this.node-1:this.start=this.node+1},stop:function(){this.stop=!0}}),e.Bloop=function(e){return new t(e)}}(),e.Chunk=function(t,i){e.isArray(t)&&(t=[]);var i=e.extend({},{size:256,every:1e3},i),n=e.extend(e.Deferred(),{size:i.size,every:i.every,from:0,to:t.length,process:function(e){return n.process.fn=e,n},chunkStart:function(e){return n.chunkStart.fn=e,n},chunkEnd:function(e){return n.chunkEnd.fn=e,n},start:function(){return n.stopped=!1,n.iterate(),n},iterate:function(){if(!n.stopped){var e=n.process.fn;if(e){n.to=from.size+n.size;var i=t.length;n.to>i&&(n.to=i);var o={from:n.from,to:n.to};for(n.chunkStart.fn&&n.chunkStart.fn.call(n,o.from,o.to);n.from<n.to&&!n.stopped;)e.call(n,t[n.from]),n.from++;return n.chunkEnd.fn&&n.chunkEnd.fn.call(n,o.from,o.to),n.completed=n.from>=t.length-1,n.completed?n.resolveWith(n):n.nextIteration=setTimeout(n.iterate,n.every),n}}},pause:function(){return n.stopped=!0,clearTimeout(n.nextIteration),n},restart:function(){return"rejected"===n.state()?n:(n.from=0,n.start(),n)},stop:function(){return n.pause(),n.rejectWith(n,[n.from]),n}});return n},function(t){var i=function(){this.lastId=0};i.prototype.queue=function(i){var n=this,o=e.uid();return n.lastId=o,function(){if(n.lastId===o){var e=arguments,e=t(i)?i.apply(this,e):e;return t(n.fn)?n.fn.apply(this,e):e}}},e.Enqueue=function(n){var o=new i;t(n)&&(o.fn=n);var a=e.proxy(o.queue,o);return a.reset=function(){o.lastId=0},a}}(e.isFunction),function(){var t={error:"error",warning:"warn",success:"log",info:"info"};e.Exception=function(i){var n=arguments,o=1==n.length,a=3==n.length;return i=e.isPlainObject(i)?i:{type:o?"error":n[0],message:o?n[0]:n[1]},a&&e.extend(i,n[2]),"development"==e.environment&&console[t[i.type]](i.message,i),i}}(),e.IE=function(){var e=navigator.userAgent;if(e.match(/MSIE 9/))return 9;if(e.match(/MSIE 10/))return 10;if(e.match(/rv:11/i))return 11;for(var t=3,i=document.createElement("div"),n=i.getElementsByTagName("i");t++,i.innerHTML="\x3c!--[if gt IE "+t+"]><i></i><![endif]--\x3e",n[0];);return t>4?t:void 0}(),e.Task=function(t){var i=e.extend(e.Deferred(),{data:{},list:[],add:function(t){var n=e.extend(e.Deferred(),{name:t,item:n});return i.list.push(n),i},process:function(){return i._promise||(i._promise=e.when.apply(e,i.list).then(i.resolve,i.reject,i.progress)),i}},t);return i},function(){var t=function(e){this.threads=[],this.threadCount=0,this.threadLimit=e.threadLimit||1,this.threadDelay=e.threadDelay||0};e.extend(t.prototype,{add:function(t,i){e.isFunction(t)&&(t.type=i||"normal","deferred"==i&&(t.deferred=e.Deferred().always(e.proxy(this.next,this))),this.threads.push(t),this.run())},addDeferred:function(e){return this.add(e,"deferred")},next:function(){this.threadCount--,this.run()},run:function(){var e=this;setTimeout(function(){if(!(e.threads.length<1)&&e.threadCount<e.threadLimit){e.threadCount++;var t=e.threads.shift();try{t.call(t,t.deferred)}catch(e){console.error(e)}!t.deferred&&e.next()}},e.threadDelay)}}),e.Threads=function(e){return new t(e)}}(),e.callback=function(t,i){if(e.isFunction(t)){n=e.uid("cb");return window[n]=function(){return i||delete window[n],t.apply(null,arguments)},n}if(e.isString(t))switch(t){case"destroy":var n=i;delete window[n]}},e.fn.checkList=function(t){var i={checkbox:".checkbox",masterCheckbox:".master-checkbox",check:function(){},uncheck:function(){},change:function(){}},t=e.extend({},i,t),n=this,o=n.find(t.checkbox),a=n.find(t.masterCheckbox),r=!1,s=function(){if(!r){var e=o.filter(":checked"),i=o.not(":checked");e.length<1&&a.removeAttr("checked"),e.length==o.length&&a.prop("checked",!0),t.change.call(n,e,i)}};return o.checked(function(){t.check.apply(n),s()},function(){t.uncheck.apply(n),s()}),a.checked(function(){r=!0,o.checked(!0),r=!1,s()},function(){r=!0,o.checked(!1),r=!1,s()}),s(),this},e.fn.switchClass=function(t,i){var i=i||"-",n=t.split(i)[0]+i,o=n.length;return this.each(function(){var i=e(this),a=e.map(i.attr("class").split(" "),function(e){return e.slice(0,o)==n||""==e?null:e});a.push(t),i.attr("class",a.join(" "))})},e.fn.activateClass=function(t){return this.prevObject.removeClass(t),e(this).addClass(t)},e.fn.htmlData=function(t){var i,n=new RegExp("^data-"+(t?t+"-":"")+"(.*)","i"),o={};return e.each(this[0].attributes,function(e,t){if(t.specified&&(i=t.name.match(n))&&i[1]){var e,a,r=i[1].split("-"),s=o;for(max=r.length-1,e=0;e<=max;e++)a=r[e],e==max?s[a]=t.value:(!s[a]&&(s[a]={}),s=s[a])}}),o},e.fn.defineData=function(e,t){return void 0===this.data(e)&&this.data(e,t),this},e.deletes=function(t,i){e.each(i,function(e,i){delete t[i]})},e.fn.disabled=function(e){return void 0===e?this.is(":disabled")||this.hasClass("disabled"):this.prop("disabled",!!e).toggleClass("disabled",!!e)},e.fn.enabled=function(e){return void 0===e?!this.disabled():this.disabled(!e)},e.distinct=function(t){var i=e.unique;if(!(t.length<1)){if(t[0].nodeType)return i.apply(this,arguments);if("object"==typeof t[0]){var n=Math.random(),o=[];return e.each(t,function(e){t[e][n]||(o.push(t[e]),t[e][n]=!0)}),e.each(o,function(e){delete o[e][n]}),o}return e.grep(t,function(i,n){return e.inArray(i,t)===n})}},e.fn.tagName=function(){return(this[0]||{}).tagName},e.create=function(t){return e(document.createElement(t))},e.fn.editable=function(t){return e.isUndefined(t)?"true"===this.prop("contenteditable"):this.prop("contenteditable",t)},e.download=function(t){return e("<iframe>").hide().appendTo("body").bind("load",function(){e(this).remove()}).attr("src",t)},e.ns=function(e,t){return e.split(" ").join(t+" ")+t},function(){var t=["on","off","fire"],i=function(e){return e.split(".")[0]},n=function(e){this.fnList={},this.events={},this.mode=e};e.extend(n.prototype,{createEvent:function(t){return this.events[t]=e.Callbacks(this.mode)},on:function(t,n){if(!t||!e.isFunction(n))return this;var o=this.fnList;(o[t]||(o[t]=[])).push(n);var a=i(t);return(this.events[a]||this.createEvent(a)).add(n),this},off:function(t){if(!t)return this;var n=i(t),o=this.events[n];if(!o)return this;var a=function(t){e.each(t,function(e,t){o.remove(t)})};return n!==t?e.each(this.fnList,function(e,t){e.indexOf(n)>-1&&a(t)}):a(this.fnList[t]),this},fire:function(t){var i=this.events[t];if(i)return i.fire.apply(i,e.makeArray(arguments).slice(1)),this},destroy:function(){for(name in this.events)this.events[name].disable()}}),e.eventable=function(i,o){var a=i.___eventable;return a&&"destroy"===o?(a.destroy(),e.deletes(i,t),delete i.___eventable):(a=i.___eventable=new n(o),i.on=e.proxy(a.on,a),i.off=e.proxy(a.off,a),i.fire=e.proxy(a.fire,a),i)}}(),e.fn.checkList=function(t){var i={checkbox:".checkbox",masterCheckbox:".master-checkbox",check:function(){},uncheck:function(){},change:function(){}},t=e.extend({},i,t),n=this,o=n.find(t.checkbox),a=n.find(t.masterCheckbox),r=!1,s=function(){if(!r){var e=o.filter(":checked"),i=o.not(":checked");e.length<1&&a.removeAttr("checked"),e.length==o.length&&a.prop("checked",!0),t.change.call(n,e,i)}};return o.checked(function(){t.check.apply(n),s()},function(){t.uncheck.apply(n),s()}),a.checked(function(){r=!0,o.checked(!0),r=!1,s()},function(){r=!0,o.checked(!1),r=!1,s()}),s(),this},e.fn.checked=function(t,i){return arguments.length<1?this.is(":checked"):(this.each(function(n){var o=e(this);"boolean"!=typeof t?(o.is("input[type=checkbox]")||o.is("input[type=radio]"))&&o.off("change.checked").on("change.checked",function(){try{return o.is(":checked")?t.apply(o):i.apply(o)}catch(e){}}):o.attr("checked",t).trigger("change")}),this)},e.fn.locate=function(t){var i="data";return e.each(this[0].attributes,function(e,t){if(t.specified&&"$"===t.value)return i=t.name,!1}),this.find("["+i+"-"+t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},function(){var t=["overflow","overflow-x","overflow-y"];e.fn.noscroll=function(i){return void 0===i&&(i=!0),this.each(function(){var n=e(this),o=n.data("noscroll");!o&&i&&(o={},e.each(t,function(e,t){o[t]=n.css(t)}),n.data("noscroll",o)),i?e.each(t,function(e,t){n.css(t,"hidden")}):o&&n.css(o)})}}(),e.fn.visible=function(t){var i=e(this),n=e(window);if(!(i.length<1)){var o=n.scrollTop(),a=o+n.height(),r=i.offset().top,s=r+i.height(),l=!0===t?s:r;return(!0===t?r:s)<=a&&l>=o}},e.fn.where=e.fn.filterBy=function(e,t,i){var i=i||"=",n="[data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+i+t+"]";return this.filter(n)},e.fn.checked=function(t,i){return arguments.length<1?this.is(":checked"):(this.each(function(n){var o=e(this);"boolean"!=typeof t?(o.is("input[type=checkbox]")||o.is("input[type=radio]"))&&o.off("change.checked").on("change.checked",function(){try{return o.is(":checked")?t.apply(o):i.apply(o)}catch(e){}}):o.attr("checked",t).trigger("change")}),this)},e.fn.selectAll=function(){return this.each(function(){this.select()})},e.fn.unselect=function(){return this.each(function(){var e=this,t=e.value;e.value+=" ",e.value=t})},e.fn.toObject=e.fn.serializeObject=function(){var t={};return e.each(e(this).serializeArray(),function(i,n){t.hasOwnProperty(n.name)?(e.isArray(t[n.name])||(t[n.name]=[t[n.name]]),t[n.name].push(n.value)):t[n.name]=n.value}),t},e.fn.toJSON=e.fn.serializeJSON=function(){return JSON.stringify(e(this).serializeObject())},e.sanitizeHTML=function(t){return e(e.parseHTML(t,document,!0)).toHTML()},e.toHTML=function(t){return e("<div>").html(t).html()},e.fn.toHTML=function(){return e.toHTML(this.clone())},e.toXHTML=function(e,t){var i=e.innerHTML?String(e.innerHTML):e,n=i.match(/(<.+[^>])/g);if(n)for(var o=0;o<n.length;o+=1){var a,r=n[o],s=/\=[a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+[?\s+|?>]/g;if(n[o]=n[o].replace(/([<|<\/].+?\w+).+[^>]/,function(e){return e}),a=n[o].match(s))for(var l=0,c=a.length;l<c;){var d=/(\=)([a-zA-Z\.\:\[\]_\(\)\&\$\%#\@\!0-9\/]+)?([\s+|?>])/g,u=function(){var e=Array.prototype.slice.call(arguments);return'="'+(t?e[2]:e[2].toLowerCase())+'"'+e[3]};n[o]=n[o].replace(a[l],a[l].replace(d,u)),l+=1}i=i.replace(r,n[o])}return i},e.fn.xhtml=function(){return e.IE?e.toXHTML(this[0]):this.html()},e.buildHTML=function(t,i){if(t instanceof e)return t;var n=document;if(window.CloudFlare){var o=e.buildHTML.iframe;o&&o.contentDocument||((o=e.buildHTML.iframe=document.createElement("iframe")).style.display="none",document.body.appendChild(o)),n=o.contentDocument}var t=e.trim(t),a=[],r=e.buildFragment([t],n,a),s=e.merge([],r.childNodes);if(!i&&a.length>0){var l=n.createElement("script");l.text="try{"+e.callback(function(){e(a).remove()})+"();}catch(e){}";for(var c,d,u=s.length-1;(c=s[u--])&&("SCRIPT"===c.nodeName?d=s.push(l):1===c.nodeType&&(d=c.appendChild(l)),!d););d||s.push(l),a.push(l)}return e(s)},e.intersects=function(t,i){return e.isArray(i)&&(i={top:i.y,left:i.x,bottom:i.y,right:i.x}),i.left<=t.right&&t.left<=i.right&&i.top<=t.bottom&&t.top<=i.bottom},e.fn.intersectsWith=function(t,i,n,o){var a=this.offset(),r={top:a.top,left:a.left,bottom:a.top+(sourceHeight=this.height()),right:a.left+(sourceWidth=this.width()),width:sourceWidth,height:sourceHeight},s={top:t,left:i,bottom:t+(o||(o=0)),right:i+(n||(n=0)),width:n,height:o};return!!e.intersects(r,s)&&{reference:r,subject:s}},e.isDeferred=function(t){return t&&e.isFunction(t.always)},e.isNumeric=function(e){return!isNaN(parseFloat(e))&&isFinite(e)},e.rotateNumber=function(e,t,i,n){return void 0===n&&(n=0),e+=n,e<t?e+=i+1:e>i&&(e-=i+1),e},e.regExpEscape=function(e){return e.replace(/([-()\[\]{}+?*.$\^|,:#<!\\])/g,"\\$1").replace(/\x08/g,"\\x08")},e.remap=function(t,i,n){return e.each(n,function(e,n){t[n]=i[n]}),obj},function(){var t=e.Ajax=function(i){i.autostart=!1;var n=e.ajax(i);return t.queue.addDeferred(function(e){n.send(),setTimeout(e.resolve,t.interval)}),n};t.queue=e.Threads({threadLimit:1}),t.interval=1200;var i=e.joomla.version.split("."),n=i[0],o=i[1];n>=3&&o>=2&&(t.interval=0)}(),function(){e.fn.addTransitoryClass=function(e,t){var i=this.addClass(e);return setTimeout(function(){i.removeClass(e)},t||1),this};var t=function(e,t,i){var n=this;return setTimeout(function(){n[e+"Class"](t)},i||50),this};e.fn.addClassAfter=function(e,i){return t.call(this,"add",e,i)},e.fn.removeClassAfter=function(e,i){return t.call(this,"remove",e,i)};var i=function(e,t,i){var n=e?"-in":"-out";return this.addTransitoryClass(t.replace(/ /g,n+" ")+n,i||1e3)[(e?"add":"remove")+"ClassAfter"](t)};e.fn.addTransitionClass=function(e,t){return i.call(this,!0,e,t)},e.fn.removeTransitionClass=function(e,t){return i.call(this,!1,e,t)}}(),e.trimSeparators=function(t,i,n){var o=i;return t=t.replace(new RegExp("^["+o+"\\s]+|["+o+",\\s]+$","g"),"").replace(new RegExp(o+"["+o+"\\s]*"+o,"g"),o).replace(new RegExp("[\\s]+"+o,"g"),o).replace(new RegExp(o+"[\\s]+","g"),o),n&&(t=e.distinct(t.split(o)).join(o)),t},e.uid=function(e,t){return(e||"")+Math.random().toString().replace(".","")+(t||"")}}),FD40.plugin("storage",function(e){function t(e){return function(){var t=Array.prototype.slice.call(arguments,0);t.unshift(n),l.appendChild(n),n.addBehavior("#default#userData"),n.load(s);var i=e.apply(o,t);return l.removeChild(n),i}}function i(e){return e.replace(/^d/,"___$&").replace(d,"___")}var n,o={},a=window,r=document,s="localStorage";if(o.disabled=!1,o.set=function(e,t){},o.get=function(e){},o.remove=function(e){},o.clear=function(){},o.transact=function(e,t,i){var n=o.get(e);null==i&&(i=t,t=null),void 0===n&&(n=t||{}),i(n),o.set(e,n)},o.getAll=function(){},o.forEach=function(){},o.serialize=function(e){return JSON.stringify(e)},o.deserialize=function(e){if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e||void 0}},function(){try{return s in a&&a[s]}catch(e){return!1}}())n=a[s],o.set=function(e,t){return void 0===t?o.remove(e):(n.setItem(e,o.serialize(t)),t)},o.get=function(e){return o.deserialize(n.getItem(e))},o.remove=function(e){n.removeItem(e)},o.clear=function(){n.clear()},o.getAll=function(){var e={};return o.forEach(function(t,i){e[t]=i}),e},o.forEach=function(e){for(var t=0;t<n.length;t++){var i=n.key(t);e(i,o.get(i))}};else if(r.documentElement.addBehavior){var l,c;try{(c=new ActiveXObject("htmlfile")).open(),c.write('<script>document.w=window<\/script><iframe src="/favicon.ico"></iframe>'),c.close(),l=c.w.frames[0].document,n=l.createElement("div")}catch(e){n=r.createElement("div"),l=r.body}var d=new RegExp("[!\"#$%&'()*+,/\\\\:;<=>?@[\\]^`{|}~]","g");o.set=t(function(e,t,n){return t=i(t),void 0===n?o.remove(t):(e.setAttribute(t,o.serialize(n)),e.save(s),n)}),o.get=t(function(e,t){return t=i(t),o.deserialize(e.getAttribute(t))}),o.remove=t(function(e,t){t=i(t),e.removeAttribute(t),e.save(s)}),o.clear=t(function(e){var t=e.XMLDocument.documentElement.attributes;e.load(s);for(var i,n=0;i=t[n];n++)e.removeAttribute(i.name);e.save(s)}),o.getAll=function(e){var t={};return o.forEach(function(e,i){t[e]=i}),t},o.forEach=t(function(e,t){for(var i,n=e.XMLDocument.documentElement.attributes,a=0;i=n[a];++a)t(i.name,o.deserialize(e.getAttribute(i.name)))})}try{var u="__storejs__";o.set(u,u),o.get(u)!=u&&(o.disabled=!0),o.remove(u)}catch(e){o.disabled=!0}o.enabled=!o.disabled,e.Storage=o}),FD40.plugin("uri",function(e){e.isUrl=function(e){return/^(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/.test(e)};var t=function(e){"use strict";var t=function(e){var t,i,n,o,a,r,s=[];if(void 0===e||null===e||""===e)return s;for(0===e.indexOf("?")&&(e=e.substring(1)),i=e.toString().split(/[&;]/),t=0;t<i.length;t++)a=(o=(n=i[t]).split("="))[0],r=-1===n.indexOf("=")?null:null===o[1]?"":o[1],s.push([a,r]);return s}(e),i=function(e){return e=decodeURIComponent(e),e=e.replace("+"," ")},n=function(e,n){var o,a,r,s,l=[];for(o=0;o<t.length;o++)a=t[o],r=i(a[0])===i(e),s=i(a[1])===i(n),(1===arguments.length&&!r||2===arguments.length&&!r&&!s)&&l.push(a);return t=l,this},o=function(e,i,n){return 3===arguments.length&&-1!==n?(n=Math.min(n,t.length),t.splice(n,0,[e,i])):arguments.length>0&&t.push([e,i]),this};return{getParamValue:function(e){var n,o;for(o=0;o<t.length;o++)if(n=t[o],i(e)===i(n[0]))return n[1]},getParamValues:function(e){var n,o,a=[];for(n=0;n<t.length;n++)o=t[n],i(e)===i(o[0])&&a.push(o[1]);return a},deleteParam:n,addParam:o,replaceParam:function(e,a,r){var s,l,c=-1;if(3===arguments.length){for(s=0;s<t.length;s++)if(l=t[s],i(l[0])===i(e)&&decodeURIComponent(l[1])===i(r)){c=s;break}n(e,r).addParam(e,a,c)}else{for(s=0;s<t.length;s++)if(l=t[s],i(l[0])===i(e)){c=s;break}n(e),o(e,a,c)}return this},toString:function(){var e,i,n="";for(e=0;e<t.length;e++)i=t[e],n.length>0&&(n+="&"),null===i[1]?n+=i[0]:n+=i.join("=");return n.length>0?"?"+n:n}}},i=function(e){"use strict";var n=/[-a-zA-Z0-9@:%_\+.~#?&//=]{2,256}\.[a-z]{2,4}\b(\/[-a-zA-Z0-9@:%_\+.~#?&//=]*)?/gi,o=function(e){for(var t=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],i={name:"queryKey",parser:/(?:^|&)([^&=]*)=?([^&]*)/g},n={strict:/^(?:([^:\/?#]+):)?(?:\/\/((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?))?((((?:[^?#\/]*\/)*)([^?#]*))(?:\?([^#]*))?(?:#(.*))?)/,loose:/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/}.loose.exec(e),o={},a=14;a--;)o[t[a]]=n[a]||"";return o[i.name]={},o[t[12]].replace(i.parser,function(e,t,n){t&&(o[i.name][t]=n)}),o}(e||""),a=new t(o.query),r=function(e){return void 0!==e&&(o.protocol=e),o.protocol},s=null,l=function(e){return void 0!==e&&(s=e),null===s?-1!==o.source.indexOf("//"):s},c=function(e){return void 0!==e&&(o.userInfo=e),o.userInfo},d=function(e){return void 0!==e&&(o.host=e),o.host},u=function(e){return void 0!==e&&(o.port=e),o.port},p=function(e){return void 0!==e&&(o.path=e),o.path},f=function(e){return void 0!==e&&(a=new t(e)),a},m=function(e){return void 0!==e&&(o.anchor=e),o.anchor},h=function(){var e="",t=function(e){return null!==e&&""!==e};return t(r())?(e+=r(),r().indexOf(":")!==r().length-1&&(e+=":"),e+="//"):l()&&t(d())&&(e+="//"),t(c())&&t(d())&&(e+=c(),c().indexOf("@")!==c().length-1&&(e+="@")),t(d())&&(e+=d(),t(u())&&(e+=":"+u())),t(p())?e+=p():t(d())&&(t(f().toString())||t(m()))&&(e+="/"),t(f().toString())&&(0!==f().toString().indexOf("?")&&(e+="?"),e+=f().toString()),t(m())&&(0!==m().indexOf("#")&&(e+="#"),e+=m()),e};return{protocol:r,hasAuthorityPrefix:l,userInfo:c,host:d,port:u,path:p,query:f,anchor:m,setProtocol:function(e){return r(e),this},setHasAuthorityPrefix:function(e){return l(e),this},setUserInfo:function(e){return c(e),this},setHost:function(e){return d(e),this},setPort:function(e){return u(e),this},setPath:function(e){return p(e),this},setQuery:function(e){return f(e),this},setAnchor:function(e){return m(e),this},getQueryParamValue:function(e){return f().getParamValue(e)},getQueryParamValues:function(e){return f().getParamValues(e)},deleteQueryParam:function(e,t){return 2===arguments.length?f().deleteParam(e,t):f().deleteParam(e),this},addQueryParam:function(e,t,i){return 3===arguments.length?f().addParam(e,t,i):f().addParam(e,t),this},replaceQueryParam:function(e,t,i){return 3===arguments.length?f().replaceParam(e,t,i):f().replaceParam(e,t),this},extract:function(t){var i=e.match(n)||[];return void 0===t?i:i[t]||""},toPath:function(e){if(void 0===e)return o.path;if("/"==e.substring(0,1))return o.path=e;var t=o.path.split("/"),i=e.split("/");""===t.slice(-1)[0]&&t.pop();for(var n;n=i.shift();)switch(n){case"..":t.length>1&&t.pop();break;case".":break;default:t.push(n)}return o.path=t.join("/"),this},toString:h,clone:function(){return new i(h())}}};e.uri=function(e){return new i(e)}}),FD40.plugin("mvc",function($){!function(){var e,t={undHash:/_|-/,colons:/::/,words:/([A-Z]+)([A-Z][a-z])/g,lowUp:/([a-z\d])([A-Z])/g,dash:/([a-z\d])([A-Z])/g,replacer:/\{([^\}]+)\}/g,dot:/\./},i=function(e,t,i){return void 0!==e[t]?e[t]:i&&(e[t]={})},n=function(e){var t=typeof e;return e&&("function"==t||"object"==t)},o=$.String=$.extend($.String||{},{getObject:e=function(e,o,a){var r,s,l,c=e?e.split(t.dot):[],d=c.length,u=0;if(o=$.isArray(o)?o:[o||window],0==d)return o[0];for(;r=o[u++];){for(l=0;l<d-1&&n(r);l++)r=i(r,c[l],a);if(n(r)&&void 0!==(s=i(r,c[l],a)))return!1===a&&delete r[c[l]],s}},capitalize:function(e,t){return e.charAt(0).toUpperCase()+e.substr(1)},camelize:function(e){return(e=o.classize(e)).charAt(0).toLowerCase()+e.substr(1)},classize:function(e,i){for(var n=e.split(t.undHash),a=0;a<n.length;a++)n[a]=o.capitalize(n[a]);return n.join(i||"")},niceName:function(e){return o.classize(e," ")},underscore:function(e){return e.replace(t.colons,"/").replace(t.words,"$1_$2").replace(t.lowUp,"$1_$2").replace(t.dash,"_").toLowerCase()},sub:function(i,n,o){var a=[];return a.push(i.replace(t.replacer,function(t,i){var r=e(t,n,"boolean"==typeof o?!o:o)||e(i,n,"boolean"==typeof o?!o:o),s=typeof r;return"object"!==s&&"function"!==s||null===s?""+r:(a.push(r),"")})),a.length<=1?a[0]:a},_regs:t});$.extend($,o)}(),function(){$.String.rsplit=function(e,t){for(var i,n=t.exec(e),o=[];null!==n;)i=n.index,t.lastIndex,0!==i&&(o.push(e.substring(0,i)),e=e.slice(i)),o.push(n[0]),e=e.slice(n[0].length),n=t.exec(e);return""!==e&&o.push(e),o}}(),function(){var e=/^\d+$/,t=/([^\[\]]+)|(\[\])/g,i=/\+/g,n=/([^?#]*)(#.*)?$/;$.String=$.extend($.String||{},{deparam:function(o){if(!o||!n.test(o))return{};for(var a,r={},s=o.split("&"),l=0;l<s.length;l++){a=r;var c=s[l].split("=");2!=c.length&&(c=[c[0],c.slice(1).join("=")]);for(var d=decodeURIComponent(c[0].replace(i," ")),u=decodeURIComponent(c[1].replace(i," ")),p=d.match(t),f=0;f<p.length-1;f++){var m=p[f];a[m]||(a[m]=e.test(p[f+1])||"[]"==p[f+1]?[]:{}),a=a[m]}lastPart=p[p.length-1],"[]"==lastPart?a.push(u):a[lastPart]=u}return r}})}(),function(){var e=$.cleanData;$.cleanData=function(t){for(var i,n=0;void 0!==(i=t[n]);n++)$(i).triggerHandler("destroyed");e(t)}}(),function(){var e=$.fn._closest=$.fn.closest;$.fn.closest=function(t,i){var n,o,a,r,s={},l=!0,c=t;if("string"==typeof t&&(c=[t]),$.each(c,function(e,i){if(0==i.indexOf(">")){if(-1!=i.indexOf(" "))throw" closest does not work with > followed by spaces!";s[c[e]=i.substr(1)]=i,"string"==typeof t&&(t=i.substr(1)),l=!1}}),n=e.call(this,t,i),l)return n;for(a=0;a<n.length;)r=(o=n[a]).selector,void 0===s[r]||(o.selector=s[r],s[r]=!1,"string"==typeof o.selector&&o.elem.parentNode===i)?a++:n.splice(a,1);return n}}(),function(){$.cookie=function(e,t,i){if(void 0===t){var n=null;if(document.cookie&&""!=document.cookie)for(var o=document.cookie.split(";"),a=0;a<o.length;a++){var r=jQuery.trim(o[a]);if(r.substring(0,e.length+1)==e+"="){n=decodeURIComponent(r.substring(e.length+1));break}}if(jQuery.evalJSON&&n&&n.match(/^\s*\{/))try{n=jQuery.evalJSON(n)}catch(e){}return n}i=i||{},null===t&&(t="",i.expires=-1),"object"==typeof t&&jQuery.toJSON&&(t=jQuery.toJSON(t));var s="";if(i.expires&&("number"==typeof i.expires||i.expires.toUTCString)){var l;"number"==typeof i.expires?(l=new Date).setTime(l.getTime()+24*i.expires*60*60*1e3):l=i.expires,s="; expires="+l.toUTCString()}var c=i.path?"; path="+i.path:"",d=i.domain?"; domain="+i.domain:"",u=i.secure?"; secure":"";document.cookie=[e,"=",encodeURIComponent(t),s,c,d,u].join("")}}(),function(){var e=!1,t=$.makeArray,i=$.isFunction,n=$.isArray,o=$.extend,a=$.String.getObject,r=function(e,i){return e.concat(t(i))},s=/xyz/.test(function(){xyz})?/\b_super\b/:/.*/,l=function(e,t,n){n=n||e;for(var o in e)n[o]=i(e[o])&&i(t[o])&&s.test(e[o])?function(e,i){return function(){var n,o=this._super;return this._super=t[e],n=i.apply(this,arguments),this._super=o,n}}(o,e[o]):e[o]};clss=$.Class=function(){arguments.length&&clss.extend.apply(clss,arguments)},o(clss,{proxy:function(e){var i,o=t(arguments);return e=o.shift(),n(e)||(e=[e]),i=this,function(){for(var t,a,s=r(o,arguments),l=e.length,c=0;c<l;c++)(a=e[c])&&((t="string"==typeof a)&&i._set_called&&(i.called=a),s=(t?i[a]:a).apply(i,s||[]),c<l-1&&(s=!n(s)||s._use_call?[s]:s));return s}},newInstance:function(){var e,t=this.rawInstance();return t.setup&&(e=t.setup.apply(t,arguments)),t.init&&t.init.apply(t,n(e)?e:arguments),t},setup:function(e,t){return this.defaults=o(!0,{},e.defaults,this.defaults),arguments},rawInstance:function(){e=!0;var t=new this;return e=!1,t},extend:function(t,i,n){function s(){if(!e)return this.constructor!==s&&arguments.length?arguments.callee.extend.apply(arguments.callee,arguments):this.Class.newInstance.apply(this.Class,arguments)}"string"!=typeof t&&(n=i,i=t,t=null),n||(n=i,i=null),n=n||{};var c,d,u=this,p=this.prototype;e=!0,d=new this,e=!1,l(n,p,d);for(c in this)this.hasOwnProperty(c)&&(s[c]=this[c]);if(l(i,this,s),t){var f;i&&i.root&&(f=i.root,$.isString(f)&&(f=a(f,window,!0)));var m=t.split(/\./),h=m.pop(),g=a(m.join("."),f||window,!0),v=g;o(!0,s,g[h]),g[h]=s}o(s,{prototype:d,namespace:v,shortName:h,constructor:s,fullName:t}),s.prototype.Class=s.prototype.constructor=s;var y=s.setup.apply(s,r([u],arguments));return s.init&&s.init.apply(s,y||r([u],arguments)),s}}),clss.callback=clss.prototype.callback=clss.prototype.proxy=clss.proxy}(),function(){var e=function(e,t,i,o){var a,r=e.bind&&e.unbind?e:$(n(e)?[e]:e);return 0===t.indexOf(">")&&(t=t.substr(1),a=function(t){t.target===e&&i.apply(this,arguments)}),o?r.bind(t,o,a||i):r.bind(t,a||i),function(){r.unbind(t,a||i),e=t=i=a=null}},t=$.makeArray,i=$.isArray,n=$.isFunction,o=$.isString,a=$.extend,r=$.String,s=$.each,l=r.getObject,c=Array.prototype.slice,d=function(e,t,i,o,a){0===t.indexOf(">")&&(t=(e.data("directSelector")+" "||"")+t);var r=e.delegate&&e.undelegate?e:$(n(e)?[e]:e);return a?r.delegate(t,i,a,o):r.delegate(t,i,o),function(){r.undelegate(t,i,o),r=e=i=o=t=null}},u=function(t,i,n,o,a){return o?d(t,o,i,n,a):e(t,i,n,a)},p=function(e,t){var o="string"==typeof t?e[t]:t;return i(o)&&n(o[1])&&(o=o[1]),function(){return e.called=t,o.apply(e,[this.nodeName?$(this):this].concat(c.call(arguments,0)))}},f=/\./g,m=/_?controllers?/gi,h=function(e){return r.underscore(e.replace($.globalNamespace+".","").replace(f,"_").replace(m,""))},g=/^\S(.*)\s(.*)/,v=/\{([^\}]+)\}/g,y=/\{([^\.]+[\.][^\.]+)\}/g,E=/^(?:(.*?)\s)?([\w\.\:>]+)$/,b=function(e,t){return $.data(e,"controllers",t)},S=$.globalNamespace+".Controller";$.Controller=function(e){var i,n=t(arguments),o={root:S};return n.length>2?(o=$.extend(o,n[1]),i=n[2]):i=n[1],o.namespace&&(e=o.namespace+"."+e),$.Controller.Class(e,o,i)};var C=S+".Class";$.Class(C,{setup:function(e,a){if(this._super.apply(this,arguments),this.shortName&&this.fullName!=C){for(var r=this.elements||[],s=0,l=this.defaults;element=r[s++];)for(var c=element.indexOf("{"),d=element.indexOf("}"),u=(element.length,element.slice(0,c)),p=element.slice(d+1),f=element.slice(c+1,d).split("|"),m=0;a=f[m++];){var g="{"+$.camelize(a)+"}";!$.has(l,g)&&(l[g]=u+a+p)}this._fullName=h(this.fullName),this._shortName=h(this.shortName);var v,y=this;if(o(this.pluginName)){var E=this._fullName,S=this.pluginName;$.fn[S]||($.fn[S]=function(e){var i=t(arguments);if($.isString(e)&&"controller"===e){var n=b(this[0]);return n&&n[E]}return this.each(function(){var t=b(this),n=t&&t[E];if(n){if($.isString(e)){var o=n[e];return void($.isFunction(o)&&o.apply(n,i.slice(1)))}n.update.apply(n,i)}else y.newInstance.apply(y,[this].concat(i))})})}var _=t(arguments),w=this.prototype,I=_[_.length>3?3:2];n(I)&&(this.protoFactory=I,w=this.protoFactory.call(this,null)),this.actions={};for(v in w)if("constructor"!=v&&this._isAction(v)){var x=w[v];if(!(n(x)||i(x)&&n(x[1])))continue;this.actions[v]=this._action(v)}$.module("$:/Controllers/"+this.fullName).resolve(this)}},hookup:function(e){return new this(e)},_isAction:function(e){return!!g.test(e)||($.inArray(e,this.listensTo)>-1||$.event.special[e]||_[e])},_action:function(e,t){if(v.lastIndex=0,!t&&v.test(e))return null;var n=e=e.replace("{self} ","");if(t){var o=!1;if(y.test(e)){var a,s="";n=e.replace(y,function(e,i){var n=i.split(".");return a=t["{"+n[0]+"}"]||{},$.isControllerInstance(a)&&(s=(a[n[1]]||{}).selector),s}).match(E),o=!!s,n=[a.element].concat(n||[])}o||(n=r.sub(e,[t,window]))}var l=i(n),c=(l?n[1]:n).match(E),d=c[2];return{processor:_[d]||w,parts:c,delegate:l?n[0]:void 0}},processors:{},listensTo:[],defaults:{},hostname:"parent"},{setup:function(e,i){var n=this,r=n.constructor,l=n.prototype,c=r._fullName;n.instanceId=$.uid(c+"_");var d=n.options=a(!0,{},r.defaults,r.defaultOptions,i),u=n.element=$(e);if(r.protoFactory&&(l=r.protoFactory.apply(r,[n,d,u]),a(!0,n,l)),(b(e)||b(e,{}))[c]=n,!u.data("directSelector")){var p=$.uid("DS");u.addClass(p).data("directSelector","."+p)}for(name in d)if(name.match(/^\{.+\}$/)){var f=name.replace(/^\{|\}$/g,""),m=d[name];if(o(m)){var h=n[f];n[f]=function(e,t,i){t=/^(\.|\#)$/.test(t)?t+i:t;var n=function(i){var n=e.element.find(t);return $.isString(i)&&(n=n.filter(i)),$.isPlainObject(i)&&$.each(i,function(e,t){n=n.filterBy(e,t)}),n};return n.selector=t,n.css=function(){var e=n.cssRule;if(!e){var i=u.data("directSelector"),o=$.map(t.split(","),function(e){return i+" "+e});(e=n.cssRule=$.cssRule(o)).important=!0}return arguments.length?e.css.apply(e,arguments):e},n.inside=function(e){return $(e).find(t)},n.of=function(e){return $(e).parents(t).eq(0)},$.isPlainObject(h)&&$.extend(n,h),n}(n,m,f)}else n[f]=m}var g=d.view,v=n.view;n.view=function(){return v.apply(this,arguments)},s(g||{},function(e,i){n.view[e]=function(i){var o=t(arguments);return $.isBoolean(i)?o=o.slice(1):i=!1,n.view.apply(n,[i,e].concat(o))}}),$.extend(n,d.controller),n.pluginInstances={},n.called="init",n._bind();var y=n.init||$.noop;return n.init=function(){return n.init=y,result=y.apply(n,arguments),n.trigger("init."+r.fullName.toLowerCase(),[n]),result},[u,d].concat(t(arguments).slice(2))},on:function(e){var i=t(arguments),n=this.element,a=i.length;return 2==a?this._binder(n,e,i[1]):3==a&&o(i[1])?this._binder(n,e,i[2],i[1]):this._binder(i[1],e,i[2])},_bind:function(){var e=this,t=e.constructor,i=t.actions,n=e._bindings=[],o=e.element;s(i||{},function(a,r){if(i.hasOwnProperty(a)){var s=t.actions[a]||t._action(a,e.options);$.isControllerInstance(s.delegate)&&(s.delegate=s.delegate.element),n.push(s.processor(s.delegate||o,s.parts[2],s.parts[1],a,e))}});var a=p(this,"destroy");return o.bind("destroyed",a),n.push(function(e){$(e).unbind("destroyed",a)}),n.length},_binder:function(e,t,i,n){return"string"==typeof i&&(i=p(this,i)),this._bindings.push(u(e,t,i,n)),this._bindings.length},_unbind:function(){var e=this.element[0];s(this._bindings,function(t,i){i(e)}),this._bindings=[]},trigger:function(e){var t=this.element;if(t){var i=$.Event(e);return t.trigger.apply(t,[i].concat($.makeArray(arguments).slice(1))),i}},delegate:function(e,t,i,n){return"string"==typeof e&&(n=i,i=t,t=e,e=this.element),this._binder(e,i,n,t)},update:function(e){a(this.options,e),this._unbind(),this._bind()},destroy:function(){if(!this._destroyed){var e=this.constructor._fullName;for(pname in this.pluginInstances)this.removePlugin(pname);this._destroyed=!0,this.element.removeClass(e),this._unbind(),delete this._actions,delete this.element.data("controllers")[e],$(this).triggerHandler("destroyed"),this.element=$()}},find:function(e){return this.element.find(e)},view:function(){var e=t(arguments),i=e,n=!1,o=this.constructor.component||$,a="",r=this.options.view||{};return"boolean"==typeof e[0]&&(n=e[0],i=e.slice(1)),void 0==(i[0]=r[i[0]])?n?"":$(""):(a=o.View.apply(o,i),n?a:$($.parseHTML($.trim(a))))},getPlugin:function(e){return this.pluginInstances[e]},addSubscriber:function(e){var t=$.isArray(e)?e:[e||{}],i=this,n=this.Class.hostname,o={};return o["{"+n+"}"]=i,$.map(t,function(e,t){return!!$.isControllerInstance(e)&&(e.options[n]===this?e:(e[n]=i,e.update(o)))}),t},addPlugin:function(e,t,i){if(e){(!t&&!i||$.isPlainObject(t))&&(i=t,t=[this.Class.root,this.Class.fullName,$.String.capitalize(e)].join(".")),$.isString(t)&&(t=$.getController(t));var o=$.isControllerInstance(t);if(n(t)||o){var a=this.Class.pluginExtendsInstance?this.options[e]:(this.options.plugin||{})[e];i=$.extend(!0,{element:this.element},i,a);var r=o?"instance":$.isController(t)?"controller":"function";this.trigger("addPlugin",[e,t,i,r]);var s=this.Class.hostname;i["{"+s+"}"]=this;var l;switch(r){case"instance":l=t,t.update(i),t[s]=this;break;case"controller":l=i.element.addController(t,i);break;case"function":l=t(this,i)}if(l){if(this.pluginInstances[e]=l,this.Class.pluginExtendsInstance&&(this[e]=l),"function"!==r){var c={};c["{"+e+"}"]=l,this.update(c)}return this.trigger("registerPlugin",[e,l,i,r]),l}}}},removePlugin:function(e){var t=this.getPlugin(e);if(t)return this.trigger("removePlugin",[e,t]),delete this.pluginInstances[e],$.isFunction(t.destroy)?t.destroy():null},invokePlugin:function(e,t,i){var n=this.getPlugin(e);if(n&&$.isFunction(n[t]))return this.trigger("invokePlugin",[e,n,i]),n[t].apply(this,i)},getMessageGroup:function(){var e=$.isFunction(this.messageGroup)?this.messageGroup():this.element.find("[data-message-group]");return e.length<1&&(e=$("<div data-message-group></div>").prependTo(this.element)),e},setMessage:function(e,t){var i={type:"warning",message:"",parent:this.getMessageGroup(),element:$('<div class="alert fade in"><button type="button" class="close" data-bs-dismiss="alert"></button></div>')},n={},o=$.isDeferred(e);n=$.isPlainObject(e)&&!o?e:{message:e,type:t||"warning"};var a=$.extend({},i,n),r=a.element;if($.isDeferred(e)){var s=arguments.callee,l=this;e.done(function(e,t){a.message=e,a.type=t||"warning",s.call(l,a),r.show()})}else r.addClass("alert-"+a.type).append(a.message),$("html").has(r).length<1&&r.appendTo(a.parent);return r},clearMessage:function(){this.getMessageGroup().empty()},_set_called:!0});var _=$.Controller.Class.processors,w=function(e,t,o,a,r){var s,l=r[a];return i(l)&&n(l[1])&&(s=l[0]),u(e,t,p(r,a),o,s)};s("change click contextmenu dblclick keydown keyup keypress mousedown mousemove mouseout mouseover mouseup reset resize scroll select submit focusin focusout mouseenter mouseleave".split(" "),function(e,t){_[t]=w});var I=function(e){return e.replace("$.Controller",S)},x=function(e){if(o(e)&&(e=I(e),e=l(e)||l(S+"."+e)),k(e))return e},k=function(e){return n(e)&&e.hasOwnProperty("_fullName")},L=function(e){return $.map(e,function(e){return i(e)?L(e):x(e)})};$.getController=x,$.isController=function(e){return!!x(e)},$.isControllerInstance=function(e){return e&&e.constructor&&k(e.constructor)},$.isControllerOf=function(e,t){if(!t)return!1;i(t)||(t=[t]);for(var n=0;n<t.length;n++)if(e instanceof x(t[n]))return!0;return!1},$.fn.extend({controllers:function(){var e=L(t(arguments)),i=[];return this.each(function(){var t=$.data(this,"controllers");s(t||{},function(n,o){t.hasOwnProperty(n)&&(e.length&&!$.isControllerOf(o,e)||i.push(o))})}),i},controller:function(e,t){return void 0===t?this.controllers(e)[0]:(this.addController.apply(this,arguments),this)},hasController:function(e){var t=(x(e)||{})._fullName||(o(e)?h(I(e)):"");return!!t&&($(this).data("controllers")||{}).hasOwnProperty(t)},addController:function(e,t,i){var o=x(e);if(o){var a=[];return this.each(function(){if(1===this.nodeType&&"SCRIPT"!=this.nodeName){var r=$(this).controller(e);if(r)a.push(r);else{var s=new o(this,t);n(i)&&i.apply(s,[$(this),s]),a.push(s)}}}),a.length>1?a:a[0]}},removeController:function(e){return this.each(function(){for(var t=$(this).controllers(e);t.length;)t.shift().destroy()}),this},addControllerWhenAvailable:function(e){var t=this,i=arguments,n=$.Deferred();return $.isController(e)&&(e=e.fullName),o(e)?($.module("$:/Controllers/"+e).pipe(function(){var e=t.addController.apply(t,i);n.resolveWith(e,[t,e])},n.reject,n.fail),n):n.reject()},implement:function(){return this.addController.apply(this,arguments),this}}),function(){for(var e,t=["is","find"],i={};e=t.shift();)i[e]=$.fn[e],$.fn[e]=function(e){return function(t){return i[e].apply(this,(t||{}).hasOwnProperty("of")?[t.selector]:arguments)}}(e)}()}(),function(){var e=function(e){return e.replace(/^\/\//,"").replace(/[\/\.]/g,"_")},t=$.makeArray,i=1,n=$.View=function(e,i,n,o){"function"==typeof n&&(o=n,n=void 0);var c=s(i);if(c.length){p=$.Deferred();return c.push(a(e,!0)),$.when.apply($,c).then(function(e){var a,s=t(arguments),c=s.pop()[0];if(r(i))i=l(e);else for(var d in i)r(i[d])&&(i[d]=l(s.shift()));a=c(i,n),p.resolve(a),o&&o(a)}),p.promise()}var d,u="function"==typeof o,p=a(e,u);return u?(d=p,p.done(function(e){o(e(i,n))})):p.done(function(e){d=e(i,n)}),d},o=function(e,t){if(!e.match(/[^\s]/))throw"$.View ERROR: There is no template or an empty template at "+t},a=function(e,t){return $.ajax({url:e,dataType:"view",async:t})},r=function(e){return e&&$.isFunction(e.always)},s=function(e){var t=[];if(r(e))return[e];for(var i in e)r(e[i])&&t.push(e[i]);return t},l=function(e){return $.isArray(e)&&3===e.length&&"success"===e[1]?e[0]:e};$.ajaxTransport("view",function(t,i){var a,r,s,l,c=i.url,d=c.match(/\.[\w\d]+$/),u=function(e){var t=a.renderer(s,e);return n.cache&&(n.cached[s]=t),{view:t}};if((r=document.getElementById(c))&&(d="."+r.type.match(/\/(x\-)?(.+)/)[2]),d||(d=n.ext,c+=n.ext),s=e(c),c.match(/^\/\//)){var p=c.substr(2);c="undefined"==typeof steal?c="/"+p:steal.root.mapJoin(p)+""}a=n.types[d];var f=$.template()[i.url];return{send:function(e,t){return f?(a=n.types["."+f.type],t(200,"success",u(f.content))):n.cached[s]?t(200,"success",{view:n.cached[s]}):void(r?t(200,"success",u(r.innerHTML)):l=$.ajax({async:i.async,url:c,dataType:"text",error:function(){o("",c),t(404)},success:function(e){o(e,c),t(200,"success",u(e))}}))},abort:function(){l&&l.abort()}}}),$.extend(n,{hookups:{},hookup:function(e){var t=++i;return n.hookups[t]=e,t},cached:{},cache:!0,register:function(t){this.types["."+t.suffix]=t,window.steal&&steal.type(t.suffix+" view js",function(t,i,o){var a=n.types["."+t.type],r=e(t.rootSrc+"");t.text=a.script(r,t.text),i()})},types:{},ext:".ejs",registerScript:function(e,t,i){return"$.View.preload('"+t+"',"+n.types["."+e].script(t,i)+");"},preload:function(e,t){n.cached[e]=function(e,i){return t.call(e,e,i)}}}),window.steal&&steal.type("view js",function(t,i,o){var a=n.types["."+t.type],r=e(t.rootSrc+"");t.text="steal('"+(a.plugin||"jquery/view/"+t.type)+"').then(function($){$.View.preload('"+r+"',"+t.text+");\n})",i()});var c,d,u,p,f,m,h,g={val:!0,text:!0};c=function(e){var i=$.fn[e];$.fn[e]=function(){var o,a,s,l=t(arguments),c=this;if(r(l[0]))return l[0].done(function(e){d.call(c,[e],i)}),this;if(u(l)){if(o=m(l))return a=l[o],l[o]=function(e){d.call(c,[e],i),a.call(c,e)},n.apply(n,l),this;if(s=n.apply(n,l),r(s))return s.done(function(e){d.call(c,[e],i)}),this;l=[s]}return g[e]?i.apply(this,l):d.call(this,l,i)}},d=function(e,t){var i,o;for(var a in n.hookups)break;return a&&e[0]&&p(e[0])&&(o=n.hookups,n.hookups={},e[0]=$(e[0])),i=t.apply(this,e),o&&h(e[0],o),i},u=function(e){var t=typeof e[1];return"string"==typeof e[0]&&("object"==t||"function"==t)&&!f(e[1])},f=function(e){return e.nodeType||e.jquery},p=function(e){return!!f(e)||"string"==typeof e&&("<"===(e=$.trim(e)).substr(0,1)&&">"===e.substr(e.length-1,1)&&e.length>=3)},m=function(e){return"function"==typeof e[3]?3:"function"==typeof e[2]&&2},h=function(e,t){var i,o,a,r,s=0;for(o=(i=(e=e.filter(function(){return 3!=this.nodeType})).add("[data-view-id]",e)).length;s<o;s++)i[s].getAttribute&&(a=i[s].getAttribute("data-view-id"))&&(r=t[a])&&(r(i[s],a),delete t[a],i[s].removeAttribute("data-view-id"));$.extend(n.hookups,t)},$.fn.hookup=function(){var e=n.hookups;return n.hookups={},h(this,e),this},$.each(["prepend","append","after","before","text","html","replaceWith","val"],function(e,t){c(t)})}(),function(){var myEval=function(script){eval(script)},rSplit=$.String.rsplit,extend=$.extend,isArray=$.isArray,returnReg=/\r\n/g,retReg=/\r/g,newReg=/\n/g,nReg=/\n/,slashReg=/\\/g,quoteReg=/"/g,singleQuoteReg=/'/g,tabReg=/\t/g,leftBracket=/\{/g,rightBracket=/\}/g,quickFunc=/\s*\(([\$\w]+)\)\s*->([^\n]*)/,clean=function(e){return e.replace(slashReg,"\\\\").replace(newReg,"\\n").replace(quoteReg,'\\"').replace(tabReg,"\\t")},escapeHTML=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(quoteReg,"&#34;").replace(singleQuoteReg,"&#39;")},$View=$.View,bracketNum=function(e){var t=e.match(leftBracket),i=e.match(rightBracket);return(t?t.length:0)-(i?i.length:0)},EJS=function(e){if(this.constructor!=EJS){var t=new EJS(e);return function(e,i){return t.render(e,i)}}"function"!=typeof e?(extend(this,EJS.options,e),this.template=compile(this.text,this.type,this.name)):this.template={fn:e}};$&&($.EJS=EJS),EJS.prototype.render=function(e,t){e=e||{},this._extra_helpers=t;var i=new EJS.Helpers(e,t||{});return this.template.fn.call(e,e,i)},extend(EJS,{text:function(e){if("string"==typeof e)return e;if(null===e||void 0===e)return"";var t=e.hookup&&function(t,i){e.hookup.call(e,t,i)}||"function"==typeof e&&e||isArray(e)&&function(t,i){for(var n=0;n<e.length;n++)e[n].hookup?e[n].hookup(t,i):e[n](t,i)};return t?"data-view-id='"+$View.hookup(t)+"'":e.toString?e.toString():""},clean:function(e){return"string"==typeof e?escapeHTML(e):"number"==typeof e?e:EJS.text(e)},options:{type:"[",ext:".ejs"}});var scan=function(e,t,i){for(var n=rSplit(t,nReg),o=0;o<n.length;o++)scanline(e,n[o],i)},scanline=function(e,t,i){e.lines++;for(var n,o=rSplit(t,e.splitter),a=0;a<o.length;a++)null!==(n=o[a])&&i(n,e)},makeScanner=function(e,t){var i={};return extend(i,{left:e+"%",right:"%"+t,dLeft:e+"%%",dRight:"%%"+t,eeLeft:e+"%==",eLeft:e+"%=",cmnt:e+"%#",cleanLeft:e+"%~",scan:scan,lines:0}),i.splitter=new RegExp("("+[i.dLeft,i.dRight,i.eeLeft,i.eLeft,i.cmnt,i.left,i.right+"\n",i.right,"\n"].join(")|(").replace(/\[/g,"\\[").replace(/\]/g,"\\]")+")"),i},compile=function(e,t,i){e=e.replace(returnReg,"\n").replace(retReg,"\n"),t=t||"[";var n="var ___v1ew = [];",o=new EJS.Buffer([n],[]),a="",r=function(e){o.push("___v1ew.push(",'"',clean(e),'");')},s=null,l=function(){a=""},c=[];scan(makeScanner(t,"["===t?"]":">"),e||"",function(e,t){var i;if(null===s)switch(e){case"\n":r(a+="\n"),o.cr(),l();break;case t.left:case t.eLeft:case t.eeLeft:case t.cmnt:s=e,a.length>0&&r(a),l();break;case t.dLeft:a+=t.left;break;default:a+=e}else switch(e){case t.right:switch(s){case t.left:i=bracketNum(a);var d=c.length&&-1==i?c.pop():";";"));"===d&&o.push("return ___v1ew.join('')"),o.push(a,d),1===i&&c.push(";");break;case t.eLeft:if((i=bracketNum(a))&&c.push("));"),quickFunc.test(a)){var u=a.match(quickFunc);a="function(__){var "+u[1]+"=$(__);"+u[2]+"}"}o.push("___v1ew.push(",$.globalNamespace+".EJS.clean(",a,i?n:"));");break;case t.eeLeft:(i=bracketNum(a))&&c.push("));"),o.push("___v1ew.push(",$.globalNamespace+".EJS.text(",a,i?n:"));")}s=null,l();break;case t.dRight:a+=t.right;break;default:a+=e}}),a.length>0&&o.push("___v1ew.push(",'"',clean(a)+'");');var d={out:"try { with(_VIEW) { with (_CONTEXT) {"+o.close()+" return ___v1ew.join('')}}}catch(e){e.lineNumber=null;throw e;}"};return myEval.call(d,"this.fn = (function(_CONTEXT,_VIEW){ var $ = "+$.globalNamespace+";"+d.out+"});"),d};EJS.Buffer=function(e,t){this.line=[],this.script=[],this.post=t,this.push.apply(this,e)},EJS.Buffer.prototype={push:function(){this.line.push.apply(this.line,arguments)},cr:function(){this.script.push(this.line.join(""),"\n"),this.line=[]},close:function(){return this.line.length>0&&(this.script.push(this.line.join("")),this.line=[]),this.post.length&&this.push.apply(this,this.post),this.script.push(";"),this.script.join("")}},EJS.Helpers=function(e,t){this._data=e,this._extras=t,extend(this,t)},EJS.Helpers.prototype={plugin:function(e){var t=$.makeArray(arguments),i=t.shift();return function(e){var n=$(e);n[i].apply(n,t)}},view:function(e,t,i){return i=i||this._extras,t=t||this._data,$View(e,t,i)}},$View.register({suffix:"ejs",script:function(e,t){return $.globalNamespace+".EJS(function(_CONTEXT,_VIEW) { "+new EJS({text:t,name:e}).template.out+" })"},renderer:function(e,t){return EJS({text:t,name:e})}})}(),function(){var e=$.isArray,t=function(e){return"object"==typeof e&&null!==e&&e},i=$.makeArray,n=$.each,o=function(t,i,n){return t instanceof $.Observe?a([t],n._namespace):t=e(t)?new $.Observe.List(t):new $.Observe(t),t.bind("change"+n._namespace,function(e,o){var a=$.makeArray(arguments),e=a.shift();a[0]="*"===i?n.indexOf(t)+"."+a[0]:i+"."+a[0],$.event.trigger(e,a,n)}),t},a=function(e,t){for(var i,n=0;n<e.length;n++)(i=e[n])&&i.unbind&&i.unbind("change"+t)},r=0,s=null,l=function(){if(!s)return s=[],!0},c=function(e,t,i){if(!e._init)return s?void s.push({t:e,ev:t,args:i}):$.event.trigger(t,i,e,!0)},d=0,u=function(){var e,t=s.length,i=s.slice(0);s=null,d++;for(var n=0;n<t;n++)e=i[n],$.event.trigger({type:e.ev,batchNum:d},e.args,e.t)},p=function(e,i,n){return e.each(function(e,o){n[e]=t(o)&&"function"==typeof o[i]?o[i]():o}),n};$.Class($.globalNamespace+".Observe",{init:function(e){this._data={},this._namespace=".observe"+ ++r,this._init=!0,this.attrs(e),delete this._init},attr:function(e,t){return void 0===t?this._get(e):(this._set(e,t),this)},each:function(){return n.apply(null,[this.__get()].concat(i(arguments)))},removeAttr:function(t){var i=e(t)?t:t.split("."),n=i.shift(),o=this._data[n];return i.length?o.removeAttr(i):(delete this._data[n],c(this,"change",[n,"remove",void 0,o]),o)},_get:function(t){var i=e(t)?t:(""+t).split("."),n=this.__get(i.shift());return i.length?n?n._get(i):void 0:n},__get:function(e){return e?this._data[e]:this._data},_set:function(i,n){var r=e(i)?i:(""+i).split("."),s=r.shift(),l=this.__get(s);if(t(l)&&r.length)l._set(r,n);else{if(r.length)throw"jQuery.Observe: set a property on an object that does not exist";if(n!==l){var d=this.__get().hasOwnProperty(s)?"set":"add";this.__set(s,t(n)?o(n,s,this):n),c(this,"change",[s,d,n,l]),l&&a([l],this._namespace)}}},__set:function(e,t){this._data[e]=t,e in this.constructor.prototype||(this[e]=t)},bind:function(e,t){return $.fn.bind.apply($([this]),arguments),this},unbind:function(e,t){return $.fn.unbind.apply($([this]),arguments),this},serialize:function(){return p(this,"serialize",{})},attrs:function(e,i){if(void 0===e)return p(this,"attrs",{});e=$.extend(!0,{},e);var n=l();for(r in this._data){var o=this._data[r],a=e[r];void 0!==a?(t(o)&&t(a)?o.attrs(a,i):o!=a&&this._set(r,a),delete e[r]):i&&this.removeAttr(r)}for(var r in e)a=e[r],this._set(r,a);n&&u()}});var f=$.Observe($.globalNamespace+".Observe.List",{init:function(e,t){this.length=0,this._namespace=".list"+ ++r,this._init=!0,this.bind("change",this.proxy("_changes")),this.push.apply(this,i(e||[])),$.extend(this,t),this.comparator&&this.sort(),delete this._init},_changes:function(e,t,i,n,o){if(this.comparator&&/^\d+./.test(t)){var a=+/^\d+/.exec(t)[0],r=this[a],s=this.sortedIndex(r);if(s!==a)return[].splice.call(this,a,1),[].splice.call(this,s,0,r),c(this,"move",[r,s,a]),e.stopImmediatePropagation(),void c(this,"change",[t.replace(/^\d+/,s),i,n,o])}-1===t.indexOf(".")&&("add"===i?c(this,i,[n,+t]):"remove"===i&&c(this,i,[o,+t]))},sortedIndex:function(e){for(var t=e.attr(this.comparator),i=0,n=0;n<this.length;n++)if(e!==this[n]){if(t<=this[n].attr(this.comparator))return n+i}else i=-1;return n+i},__get:function(e){return e?this[e]:this},__set:function(e,t){this[e]=t},serialize:function(){return p(this,"serialize",[])},splice:function(e,n){var r,s=i(arguments);for(r=2;r<s.length;r++){var l=s[r];t(l)&&(s[r]=o(l,"*",this))}void 0===n&&(n=s[1]=this.length-e);var d=[].splice.apply(this,s);return n>0&&(c(this,"change",[""+e,"remove",void 0,d]),a(d,this._namespace)),s.length>2&&c(this,"change",[""+e,"add",s.slice(2),d]),d},attrs:function(e,i){if(void 0===e)return p(this,"attrs",[]);e=e.slice(0);for(var n=Math.min(e.length,this.length),o=l(),a=0;a<n;a++){var r=this[a],s=e[a];t(r)&&t(s)?r.attrs(s,i):r!=s&&this._set(a,s)}e.length>this.length?this.push(e.slice(this.length)):e.length<this.length&&i&&this.splice(e.length),o&&u()},sort:function(e,t){var i=this.comparator,n=i?[function(e,t){return e=e[i],t=t[i],e===t?0:e<t?-1:1}]:[];[].sort.apply(this,n);!t&&c(this,"reset")}}),m=function(e){return e[0]&&$.isArray(e[0])?e[0]:i(e)};n({push:"length",unshift:0},function(e,i){f.prototype[e]=function(){for(var n=m(arguments),a=i?this.length:0,r=0;r<n.length;r++){var s=n[r];t(s)&&(n[r]=o(s,"*",this))}if(1==n.length&&this.comparator){var l=this.sortedIndex(n[0]);return this.splice(l,0,n[0]),this.length}var d=[][e].apply(this,n);return this.comparator&&n.length>1?(this.sort(null,!0),c(this,"reset",[n])):c(this,"change",[""+a,"add",n,void 0]),d}}),n({pop:"length",shift:0},function(e,t){f.prototype[e]=function(){var i=m(arguments),n=t&&this.length?this.length-1:0,o=[][e].apply(this,i);return c(this,"change",[""+n,"remove",void 0,[o]]),o&&o.unbind&&o.unbind("change"+this._namespace),o}}),f.prototype.indexOf=[].indexOf||function(e){return $.inArray(e,this)},$.O=function(t,i){return e(t)||t instanceof $.Observe.List?new $.Observe.List(t,i):new $.Observe(t,i)}}()}),FD40.plugin("joomla",function(e){var t={squeezebox:function(){return i.isJoomla15?window.parent.document.getElementById("sbox-window"):window.parent.SqueezeBox}},i=e.Joomla=function(n,o){if(e.isFunction(o)){var a=o;return void(i.isJoomla15?window[n]=a:window.Joomla[n]=a)}var n=t[n]||(i.isJoomla15?window[n]:window.Joomla[n]);if(e.isFunction(n))return n.apply(window,o)},n=parseFloat(e.joomla.version);i.isJoomla15=n<=1.5,i.isJoomla25=n>=1.6&&n<=2.5,i.isJoomla30=n>=3}),FD40.plugin("module",function(e){var t=function(t){var i=this,n=e.Callbacks("once memory");e.extend(this,e.Deferred(),{name:t,status:"pending",ready:function(t){!0===t&&n.fire.call(i,e),e.isFunction(t)&&n.add(t)}}),i.then(function(){i.exports=this,i.status="resolved"},function(){i.status="rejected"});var o=i.done;i.done=function(){i.required=!0;var t=i.factory;return t&&"ready"===i.status&&t.call(i,e),i.done=o,i.done.apply(this,arguments)}};e.module=function(){var i=function(t,n){var o;if("string"==typeof t){if(o=i.get(t),void 0===n)return o;if(e.isFunction(n))return"resolved"==o.status?o:(o.factory=n,o.status="ready",o.ready("true"),o.required&&(o.status="executing",n.call(o,e)),o)}if(e.isArray(t)){var a=e.map(t,function(t){var n=i.get(e.isString(t)?t:t.name);if(n)return"pending"===n.status&&(n.status="ready"),e.isPlainObject(t)?t:void 0});e.each(a,function(e,t){i(t.name,t.factory)})}};return e.extend(i,{registry:{},get:function(t){if(t)return e.isModule(t)&&(t=t.replace("module://","")),i.registry[t]||i.create(t)},create:function(e){return i.registry[e]=new t(e)},remove:function(e){delete i.registry[e]}}),i}(),e.isModule=function(i){return e.isString(i)?!!i.match("module://"):i&&i instanceof t}}),FD40.plugin("script",function(e){e.script=function(){var t=function(e){if(void 0!==e)return"string"==typeof e&&(e={url:e}),new i(e)},i=function(t){var i=e.extend(this,t);i.manager=e.Deferred(),e.extend(i,i.manager.promise()),i.load()},n=document.getElementsByTagName("head")[0];document.getElementsByTagName("base")[0];return e.extend(i.prototype,{timeout:7e3,retry:3,retryCount:1,type:"text/javascript",async:!1,charset:"UTF-8",verbose:!1,head:n,insert:function(){var e=this.node;this.head.appendChild(e)},remove:function(){var e=this.node;setTimeout(function(){e.onload=e.onerror=e.onreadystatechange=null;try{n.removeChild(e)}catch(e){}},1e3)},load:function(){var t,i=this;i.endTime=void 0,i.startTime=new Date,i.node=t=document.createElement("script"),i.insert(),i._ready=e.proxy(i.ready,i),i._error=e.proxy(i.error,i),t.attachEvent&&!e.browser.opera?(t.attachEvent("onreadystatechange",i._ready),t.attachEvent("onerror",i._error)):(t.addEventListener("load",i._ready,!1),t.addEventListener("error",i._error,!1)),e(t).attr({type:i.type,async:i.async,charset:i.charset,src:i.url}),i.monitor()},monitor:function(){var e=this;e.retryCount>e.retry?e._error():setTimeout(function(){"resolved"!==e.state()&&(e.verbose&&console.warn("$.script: Load timeout. [Retry: "+e.retryCount+"]",e),e.remove(),e.retryCount++,e.load())},e.timeout*e.retryCount)},ready:function(e){var t=this,i=t.node;("load"===e.type||/loaded|complete/.test(i.readyState))&&(t.complete.call(t,e),t.manager.resolve(t))},error:function(e){var t=this;t.verbose&&console.error("$.script: Unable to load ",t),t.complete.call(t,e),t.remove(),t.manager.reject(t)},complete:function(t){var i=this,n=i.node;i.endTime=new Date,n.detachEvent&&!e.browser.opera?(n.detachEvent("onreadystatechange",i._ready),n.detachEvent("onerror",i._error)):(n.removeEventListener("load",i._ready,!1),n.removeEventListener("error",i._error,!1))}}),t}()}),FD40.plugin("stylesheet",function(e){var t=document.getElementsByTagName("head")[0],i=document.styleSheets,n=document.createStyleSheet;e.stylesheet=function(){var o=function(t,i){var n={};return e.extend(n,o.defaultOptions,e.isPlainObject(t)?t:{url:t,attr:i||{}}),void 0===n.url?o.create(n):o.load(n)};return e.extend(o,{defaultOptions:{type:"text/css",rel:"stylesheet",media:"all",title:"",forceInject:!1,xhr:!1},setup:function(t){e.extend(o.defaultOptions,t)},availability:function(){var t={},i=e('link[rel*="stylesheet"]');return styles=e("style"),t.groups=31-i.length-styles.length,t.slots=31*t.groups,o.currentGroup&&(t.slots+=31-o.currentGroup.imports.length),t},get:function(e){for(var t=0;t<i.length;t++){var n=i[t];if((n.ownerNode||n.owningElement)==e)return n}},create:function(o){var a,r,s=i.length;if(n){if(s>=31)return;r=(a=document.createStyleSheet()).ownerNode||a.owningElement}else r=document.createElement("style"),t.appendChild(r);e.extend(r,{type:o.type,title:o.title,media:o.media,rel:o.rel});var l=o.content;return void 0!==l&&(n?a.cssText=l:r.appendChild(document.createTextNode(l))),r},nextAvailable:function(e){var t,a=i.length;if(a){var r;for(r=a;r--;r<0){t=i[r];{if(!(n&&(t.cssRules||t.rules).length>=4095))break;t=void 0}}}return t.ownerNode||t.owningElement||(e?o():void 0)},load:function(t){return e.browser.msie&&!t.forceInject?o._import(t):e("<link>").attr({href:t.url,type:t.type,rel:t.rel,media:t.media}).appendTo("head")[0]},_import:function(e){var t;if(void 0===o.currentGroup){var i;try{(i=document.createStyleSheet()).media="all",i.title="jquery_stylesheet"}catch(i){t=!0,e.verbose&&console.error("There is not enough slots left to create a new stylesheet group.")}if(t)return!1;o.currentGroup=i}try{o.currentGroup.addImport(e.url)}catch(i){t=!0,e.verbose&&console.info("Import slots exceeded. Creating a new stylesheet group.")}return!t||(o.currentGroup=void 0,o._import(e))}}),o}(),function(){var t=function(t,i,n){e.extend(this,{id:e.uid(),style:n,selectors:[],preRule:"",rules:{},legacy:8===e.IE,important:!1}),t&&this.set(t,i)};e.extend(t.prototype,{set:function(t,i){return e.isString(t)?this.selectors=t.split(","):this.selectors=t,e.isString(i)?(this.preRule=i+"\n",this.rules={}):(this.preRule="",this.rules=i||this.rules),this.update(),this},cssText:function(){return this.selectors.join(",")+"{"+this.ruleText()+"}\n"},ruleText:function(){var t=this.important;return this.preRule+(this.legacy?"-rule-id:"+this.id+";":"")+e.map(this.rules,function(i,n){return e.isNumeric(i)&&!e.cssNumber[n]&&(i+="px"),t&&(i+=" !important"),n+":"+i}).join(";")},update:function(){if(this.legacy)return this.updateLegacy();var e=this.cssText();return void 0===this.textNode?(this.textNode=document.createTextNode(e),this.style.appendChild(this.textNode)):this.textNode.nodeValue=e,this},updateLegacy:function(){this.removeLegacy();for(var t=e.stylesheet.get(this.style),i=this.selectors,n=this.ruleText(),o=0;o<i.length;o++)t.addRule(i[o],n);return this},remove:function(){return this.legacy?this.removeLegacy():(void 0!==this.textNode&&(this.style.removeChild(this.textNode),delete this.textNode),this)},removeLegacy:function(){for(var t=e.stylesheet.get(this.style),i=t.rules,n=0;n<i.length;n++)null!==i[n].cssText.match(this.id)&&t.removeRule(n);return this},css:function(t,i){return e.isString(t)&&void 0===i?this.rules[t]:(e.isPlainObject(t)?e.extend(this.rules,t):this.rules[t]=i,this.update(),this)}});var i=e.cssRule=function(n,o,a){if(a=a||i.style||e.stylesheet.nextAvailable(!0))return new t(n,o,a)};i.style=e.stylesheet()}(),function(){e.cssUrl=function(e){return'url("'+encodeURI(e)+'")'}}()}),FD40.plugin("language",function(e){e.sprintf=function(){var e=/%%|%(\d+\$)?([-+\'#0 ]*)(\*\d+\$|\*|\d+)?(\.(\*\d+\$|\*|\d+))?([scboxXuidfegEG])/g,t=arguments,i=0,n=function(e,t,i,n){i||(i=" ");var o=e.length>=t?"":Array(1+t-e.length>>>0).join(i);return n?e+o:o+e},o=function(e,t,i,o,a,r){var s=o-e.length;return s>0&&(e=i||!a?n(e,o,r,i):e.slice(0,t.length)+n("",s,"0",!0)+e.slice(t.length)),e},a=function(e,t,i,a,r,s,l){var c=e>>>0;return i=i&&c&&{2:"0b",8:"0",16:"0x"}[t]||"",e=i+n(c.toString(t),s||0,"0",!1),o(e,i,a,r,l)},r=function(e,t,i,n,a,r){return null!=n&&(e=e.slice(0,n)),o(e,"",t,i,a,r)},s=function(e,s,l,c,d,u,p){var f,m,h,g,v;if("%%"==e)return"%";for(var y=!1,E="",b=!1,S=!1,C=" ",_=l.length,w=0;l&&w<_;w++)switch(l.charAt(w)){case" ":E=" ";break;case"+":E="+";break;case"-":y=!0;break;case"'":C=l.charAt(w+1);break;case"0":b=!0;break;case"#":S=!0}if((c=c?"*"==c?+t[i++]:"*"==c.charAt(0)?+t[c.slice(1,-1)]:+c:0)<0&&(c=-c,y=!0),!isFinite(c))throw new Error("sprintf: (minimum-)width must be finite");switch(u=u?"*"==u?+t[i++]:"*"==u.charAt(0)?+t[u.slice(1,-1)]:+u:"fFeE".indexOf(p)>-1?6:"d"==p?0:void 0,v=s?t[s.slice(0,-1)]:t[i++],p){case"s":return r(String(v),y,c,u,b,C);case"c":return r(String.fromCharCode(+v),y,c,u,b);case"b":return a(v,2,S,y,c,u,b);case"o":return a(v,8,S,y,c,u,b);case"x":return a(v,16,S,y,c,u,b);case"X":return a(v,16,S,y,c,u,b).toUpperCase();case"u":return a(v,10,S,y,c,u,b);case"i":case"d":return f=0|+v,m=f<0?"-":E,v=m+n(String(Math.abs(f)),u,"0",!1),o(v,m,y,c,b);case"e":case"E":case"f":case"F":case"g":case"G":return f=+v,m=f<0?"-":E,h=["toExponential","toFixed","toPrecision"]["efg".indexOf(p.toLowerCase())],g=["toString","toUpperCase"]["eEfFgG".indexOf(p)%2],v=m+Math.abs(f)[h](u),o(v,m,y,c,b)[g]();default:return e}};return t[i++].replace(e,s)};var t=e.language=e.JText=function(e){return arguments.length<2?t._(e):t.sprintf.apply(null,arguments)};e.extend(t,{lang:{},add:function(i,n){e.isPlainObject(i)?e.extend(t.lang,i):t.lang[i]=n},remove:function(e){delete t.lang[e]},_:function(e){return t.lang.hasOwnProperty(e)?t.lang[e]:e},sprintf:function(){var i=arguments[0];return arguments[0]=t.lang[i],e.sprintf.apply(null,arguments)}})}),FD40.plugin("template",function(e){e.template=function(){var t={content:"",type:"ejs"},i=function(n,o){if(void 0===n)return i.templates;var a;return"string"==typeof o?(a=e.isPlainObject(o)?o:e.extend({},t,{name:n,content:o}),i.templates[n]=a,a):(a=i.templates[n]||{}).content||""};return e.extend(i,{templates:{},remove:function(e){delete i.templates[e]}}),i}()}),FD40.plugin("require",function(e){e.require=function(){var t=function(t){return e.uri(t).setAnchor("").setQuery("").toPath("../").toString()},i=function(e){var t=new o(e);return i.batches[t.id]=t,t};e.extend(i,{defaultOptions:{path:function(){var i=e.path+"/scripts/"||e("[require-path]").attr("require-path")||t(e("script:last").attr("src"))||t(window.location.href);return/^(\/|\.)/.test(i)&&(i=e.uri(window.location.href).toPath(i).toString()),i}(),timeout:1e4,retry:3,verbose:"development"==e.environment},setup:function(t){e.extend(i.defaultOptions,t)},batches:{},status:function(t){return e.each(i.batches,function(i,n){var o={pending:0,resolved:0,rejected:0,ready:0,total:0},a=[];e.each(n.tasks,function(e,t){state=t.module&&"ready"==t.module.status?"ready":t.state(),o[state]++,o.total++,a.push({state:state,content:"["+state+"] "+t.name})});var r=n.id+": "+n.state()+" ["+o.resolved+"/"+o.total+"]";t&&o[t]<1||(e.IE?(console.log('$.require.batches["'+n.id+'"]'),e.each(a,function(e,t){console.log(t.content)}),console.log("")):(console.groupCollapsed(r),console.log('$.require.batches["'+n.id+'"]',n),e.each(a,function(e,i){var n=i.state,o=i.content;if(!t||n==t)switch(n){case"pending":console.warn(o);break;case"rejected":console.error(o);break;default:console.info(o)}}),console.groupEnd(r)))}),"$.require.status(pending|resolved|rejected|ready);"},loaders:{},addLoader:function(e,t){i[e]=t,o.prototype[e]=function(){var e=this;return e.autoFinalize(),t.apply(e,arguments),e},i.loaders[e]=i[e]=t},removeLoader:function(e){delete o.prototype[e],delete i[e]}});var n=0,o=function(t){var o=e.Callbacks("once memory"),a=!1;return e.extend(this,{id:++n,tasks:[],options:e.extend({},i.defaultOptions,t),autoFinalizeDuration:300,finalized:!1,required:function(t){return!0===t&&(a=o.fire()),e.isFunction(t)&&o.add(t),a}})};return e.extend(o.prototype,{addTask:function(t){var i=this;e.isDeferred(t)&&(i.finalized||(i.tasks.push(t),t.batch=i))},autoFinalize:function(){var e=this,t=e.autoFinalizeDuration;!1!==t&&(clearTimeout(e.autoFinalizeTimer),e.autoFinalizeTimer=setTimeout(function(){e.finalize()},t))},finalize:function(){var t=this;if(!t.finalized){t.finalized=!0;var i=t.manager=e.when.apply(null,t.tasks),n=i.promise(),o=e.Callbacks();e.extend(t,n,{progress:o.add,notify:o.fire,done:function(){return t.required(!0),t.done=n.done,t.done.apply(t,arguments)}});var a=t.options.verbose;i.progress(function(e,t){a&&"rejected"==e&&console.warn("Require: Task "+t.name+" failed to load.",t)}).fail(function(){a&&console.warn("Require: Batch "+t.id+" failed.",t)}),setTimeout(function(){e.each(t.tasks,function(e,i){i.then(function(){t.notify("resolved",i)},function(){t.notify("rejected",i)},function(){t.notify("progress",i)})})},1)}},expand:function(t,i){var t=e.makeArray(t),n=i||{},o=[];return e.isPlainObject(t[0])?(n=e.extend(t[0],i),o=t.slice(1)):o=t,{options:n,names:o}}}),e.each(["done","fail","progress","always","then"],function(e,t){o.prototype[t]=function(){var e=this;return e.finalize(),e[t].apply(e,arguments)}}),i}(),e.require.addLoader("script",function(){var t=e.uri(e.indexUrl).host();t!==e.uri(document.location.href).host()&&t.match("xn--")&&(e.support.cors=!0);!0===document.createElement("script").async||"MozAppearance"in document.documentElement.style||window.opera;var i=function(){var t,n,o=this,a=e.makeArray(arguments);e.isPlainObject(a[0])?(t=a[0],n=a.slice(1)):n=a,t=e.extend({},i.defaultOptions,o.options,t,{batch:o});var r;e.each(n,function(e,n){var a=new i.task(n,t,r);o.addTask(a),t.serial&&void 0!==r?r.always(a.start):a.start(),r=a})};return e.extend(i,{defaultOptions:{path:"",extension:"compressed"==e.mode?"min.js":"js",serial:!1,async:!1,xhr:!1},setup:function(){e.extend(i.defaultOptions,options)},scripts:{},task:function(t,i,n){var o=e.extend(this,e.Deferred());o.name=t,o.options=i,o.taskBefore=n,e.isArray(t)&&(o.name=t[0]+"@"+t[1],o.moduleName=t[0],t[2]||(o.defineModule=!0,e.module.registry[o.moduleName]&&console.warn("$.require.script: "+o.moduleName+" exists! Using existing module instead."),o.options.xhr=!0),t=t[1],o.module=e.module(o.moduleName)),e.isUrl(t)?o.url=t:/^(\/|\.)/.test(t)?o.url=e.uri(o.options.path).toPath(t).toString():(o.url=e.uri(o.options.path).toPath("./"+t+"."+o.options.extension).toString(),o.module=e.module(t))}}),e.extend(i.task.prototype,{start:function(){var e=this,t=e.module;t&&"pending"!==t.status?e.waitForModule():e.load()},waitForModule:function(){var e=this,t=e.module;t.then(e.resolve,e.reject,e.notify),e.batch.required(function(){t.done(e.resolve)})},load:function(){var t=this,n=t.taskBefore;t.script=i.scripts[t.url]||function(){var n=t.options.xhr?e.ajax({url:t.url,dataType:"text"}):e.script({url:t.url,type:"text/javascript",async:t.options.async,timeout:t.batch.options.timeout,retry:t.batch.options.retry,verbose:t.batch.options.verbose});return i.scripts[t.url]=n}(),t.script.done(function(i){var o=function(){t.module?t.waitForModule():t.resolve()};t.options.xhr&&(t.defineModule&&(t.module=e.module(t.moduleName,function(){var t=this;e.globalEval(i),t.resolveWith(i)})),!t.options.async||n)?n.done(function(){e.globalEval(i),o()}):o()}).fail(function(){t.reject()})}}),i}()),e.require.addLoader("stylesheet",function(){var t=function(){var i,n,o=this,a=e.makeArray(arguments);e.isPlainObject(a[0])?(i=a[0],n=a.slice(1)):n=a,i=e.extend({},t.defaultOptions,o.options,{path:e.path+"/styles/"},i,{batch:o}),e.each(n,function(e,n){var a=new t.task(n,i),r=t.stylesheets[a.url];a=r||a,o.addTask(a),r||(t.stylesheets[a.url]=a,a.start())})};return e.extend(t,{defaultOptions:{path:"",extension:"compressed"==e.mode?"min.css":"css",xhr:!1},setup:function(){e.extend(t.defaultOptions,options)},stylesheets:{},task:function(t,i){var n=e.extend(this,e.Deferred());n.name=t,n.options=i,e.isUrl(t)?n.url=t:/^(\/|\.)/.test(t)?n.url=e.uri(n.options.path).toPath(t).toString():n.url=e.uri(n.options.path).toPath("./"+t+"."+n.options.extension).toString(),n.options.url=n.url},loaders:{},loader:function(i){if(e.isArray(i))return e.map(i,function(e){return t.loader(e)});if(e.isPlainObject(i))return e.map(i,function(e,i){return t.loader(e).resolve(i)});var n=t.loaders[i];return n||(n=t.loaders[i]=e.Deferred().done(function(t){e.isPlainObject(t)||e.stylesheet(t)})),n}}),e.extend(t.task.prototype,{start:function(){var i=this,n=t.loaders[i.name];n||(n=t.loader(i.name),e.stylesheet(i.options)?n.resolve():n.reject()),n.then(i.resolve,i.reject)}}),t}()),e.require.addLoader("template",function(){var t=function(){var i,n,o=this,a=e.makeArray(arguments);e.isPlainObject(a[0])?(i=a[0],n=a.slice(1)):n=a,i=e.extend({},t.defaultOptions,o.options,i,{batch:o}),e.each(n,function(e,n){var a=new t.task(n,i);o.addTask(a),a.start()})};return e.extend(t,{defaultOptions:{path:"",extension:"htm"},setup:function(){e.extend(t.defaultOptions,options)},task:function(t,i){var n=e.extend(this,e.Deferred());n.name=t,n.options=i,e.isArray(t)&&(n.name=t[0],t=t[1]),e.isUrl(t)?n.url=t:/^(\/|\.)/.test(t)?n.url=e.uri(n.options.path).toPath(t).toString():n.url=e.uri(n.options.path).toPath("./"+t+"."+n.options.extension).toString()},loaders:{},loader:function(i){if(e.isArray(i))return e.map(i,function(e){return t.loader(e)});if(e.isPlainObject(i))return e.map(i,function(e,i){return t.loader(i).resolve(e)});var n=t.loaders[i];return n||(n=t.loaders[i]=e.Deferred().done(function(t){e.template(i,t)})),n}}),e.extend(t.task.prototype,{start:function(){var i=this,n=t.loaders[i.name];return n||((n=t.loader(i.name)).xhr=e.Ajax({url:i.url,dataType:"text"}).then(n.resolve,n.reject).then(i.resolve,i.reject)),i.loader=n,i}}),t}()),e.require.addLoader("language",function(){var t=function(){var i,n,o=this,a=e.makeArray(arguments);e.isPlainObject(a[0])?(i=a[0],n=a.slice(1)):n=a,i=e.extend({},t.defaultOptions,o.options,i,{batch:o});var r=new t.task(n,i);o.addTask(r),r.start()};return e.extend(t,{defaultOptions:{path:""},setup:function(){e.extend(t.defaultOptions,options)},loaders:{},task:function(t,i){var n=e.extend(this,e.Deferred());n.name=t.join(","),n.options=i,n.url=i.path,n.names=t},loaders:{},loader:function(i){if(e.isArray(i))return e.map(i,function(e){return t.loader(e)});if(e.isPlainObject(i))return e.map(i,function(e,i){return t.loader(i).resolve(e)});var n=t.loaders[i];return n||(n=t.loaders[i]=e.Deferred().done(function(t){e.language.add(i,t)})),n}}),e.extend(t.task.prototype,{start:function(){var i=this,n=[],o=e.map(i.names,function(e){var i=t.loader(e);return i.push(i),/resolved|rejected/.test(i.state())?null:e});return i.fail(function(){e.each(o,function(e,i){t.loader(i).reject()})}),e.when.apply(null,n).then(i.resolve,i.reject),o.length<1?i:(i.xhr=e.Ajax({url:i.url,type:"POST",data:{keys:o}}).done(function(n){e.isPlainObject(n)?t.loader(n):i.reject()}).fail(function(){i.reject()}),i)}}),t}()),e.require.addLoader("library",function(){var t,i=this,n=e.makeArray(arguments),o={};return e.isPlainObject(n[0])?(o=n[0],t=n.slice(1)):t=n,e.extend(o,{path:e.scriptPath}),i.script.apply(i,[o].concat(t))}),e.require.addLoader("image",function(){var t=function(){var i,n,o=this,a=e.makeArray(arguments);e.isPlainObject(a[0])?(i=a[0],n=a.slice(1)):n=a,i=e.extend({},t.defaultOptions,o.options,i,{batch:o}),e.each(n,function(e,n){var a=new t.task(n,i),r=t.images[a.url];a=r||a,o.addTask(a),r||(t.images[a.url]=a,a.start())})};return e.extend(t,{defaultOptions:{path:""},setup:function(){e.extend(t.defaultOptions,options)},images:{},task:function(t,i){var n=e.extend(this,e.Deferred());n.name=t,n.options=i,e.isUrl(t)?n.url=t:/^(\/|\.)/.test(t)?n.url=e.uri(n.options.path).toPath(t).toString():n.url=e.uri(n.options.path).toPath("./"+t).toString(),n.options.url=n.url}}),e.extend(t.task.prototype,{start:function(){var t=this;t.image=e(new Image).load(function(){t.resolve()}).error(function(){t.reject()}).attr("src",t.options.url)}}),t}())}),FD40.plugin("iframe-transport",function(e){e.ajaxPrefilter(function(e,t,i){if(e.iframe)return"iframe"}),e.ajaxTransport("iframe",function(t,i,n){function o(){c&&d.replaceWith(function(e){return l.get(e)}),a.remove(),r.attr("src","javascript:false;").remove()}var a=null,r=null,s="iframe-"+e.now(),l=e(t.files).filter(":file:enabled"),c=l.length>0,d=null;return t.dataTypes.shift(),a=e("<form enctype='multipart/form-data' method='post'></form>").hide().attr({action:t.url,target:s}),"string"==typeof t.data&&t.data.length>0&&e.error("data must not be serialized"),e.each(t.data||{},function(t,i){e.isPlainObject(i)&&(t=i.name,i=i.value),e.isArray(i)||(i=[i]),e.each(i,function(i,n){e("<input type='hidden' />").attr({name:t,value:n}).appendTo(a)})}),e("<input type='hidden' value='IFrame' name='X-Requested-With' />").appendTo(a),c&&(d=l.after(function(t){return e(this).clone().prop("disabled",!0)}).next(),l.appendTo(a)),{send:function(t,i){(r=e("<iframe src='javascript:false;' name='"+s+"' id='"+s+"' style='display:none'></iframe>")).bind("load",function(){r.unbind("load").bind("load",function(){var e=this.contentWindow?this.contentWindow.document:this.contentDocument?this.contentDocument:this.document,t=e.documentElement?e.documentElement:e.body,n=t.getElementsByTagName("textarea")[0],a=n?n.getAttribute("data-type"):null,r=n?n.getAttribute("data-status"):200,s=n?n.getAttribute("data-statusText"):"OK",l={html:t.innerHTML,text:a?n.value:t?t.textContent||t.innerText:null};o(),i(r,s,l,a?"Content-Type: "+a:null)}),a[0].submit()}),e("body").append(a,r)},abort:function(){null!==r&&(r.unbind("load").attr("src","javascript:false;"),o())}}})}),FD40.plugin("server",function($){var self=$.server=function(e){var t=$.Deferred(),i=$.extend(!0,{},self.defaultOptions,e,{success:function(){}}),n=t.xhr=$.Ajax(i).done(function(i){if("string"==typeof i)try{i=$.parseJSON(i)}catch(e){t.rejectWith(t,["Unable to parse Ajax commands.","error"])}if($.isArray(i)){var n=function(i){var n=i.type,o=self.parsers[n]||e[n];if($.isFunction(o))return o.apply(t,i.data)},i=$.map(i,function(e){if("notify"!=e.type)return e;n(e)});$.each(i,function(e,t){n(t)})}else t.rejectWith(t,["Invalid ajax commands.","error"]);"pending"===t.state()&&t.resolveWith(t)}).fail(function(e,i,n){t.rejectWith(t,[n,i])});return t.abort=n.abort,t};self.defaultOptions={type:"POST",data:{tmpl:"component",format:"ajax",no_html:1},cache:!1,contentType:"application/x-www-form-urlencoded",dataType:"json"},self.parsers={script:function(){var data=$.makeArray(arguments);if("string"!=typeof data[0]){var chain=window,chainBroken=!1;$.each(data,function(e,t){"Foundry"===t.property&&(t.property=$.globalNamespace),"Foundry"===t.method&&(t.method=$.globalNamespace);try{switch(t.type){case"get":chain=chain[t.property];break;case"set":chain[t.property]=t.value,chainBroken=!0;break;case"call":chain=chain[t.method].apply(chain,t.args)}}catch(e){chainBroken=!0}})}else try{eval(data[0])}catch(e){}},resolve:function(){this.resolveWith(this,arguments)},reject:function(){this.rejectWith(this,arguments)},notify:function(){this.notifyWith(this,arguments)},redirect:function(e){window.location=e}}}),FD40.plugin("component",function(e){var t=e.Component=function(e,i){return arguments.length<1?t.registry:arguments.length<2?t.registry[e]:t.register(e,i)};t.registry={},t.proxy=function(t,i,n){e.isFunction(n)?t[i]=e.proxy(n,t):t[i]=n},t.register=function(i,n){var o;e.isFunction(i)&&(i=(o=i).className,n=o.options);var a=t.registry[i]=window[i]=function(t){return e.isFunction(t)?t(e):component};if(e.each(t.prototype,function(e,i){t.proxy(a,e,i)}),a.$=e,a.options=n,a.className=i,a.identifier=i.toLowerCase(),a.componentName="com_"+a.identifier,a.prefix=a.identifier+"/",a.version=n.version,a.safeVersion=a.version.replace(/\./g,""),a.environment=n.environment||e.environment,a.mode=n.mode||e.mode,a.debug="development"===a.environment,a.console=t.console(a),a.language=n.language||e.locale.lang||"en",a.baseUrl=n.baseUrl||e.indexUrl+"?option="+a.componentName,a.ajaxUrl=n.ajaxUrl||e.basePath+"/?option="+a.componentName,a.scriptPath=n.scriptPath||e.rootPath+"/media/"+a.componentName+"/scripts/",a.stylePath=n.stylePath||e.rootPath+"/media/"+a.componentName+"/styles/",a.templatePath=n.templatePath||n.scriptPath,a.languagePath=n.languagePath||a.ajaxUrl+"&tmpl=component&no_html=1&controller=lang&task=getLanguage",a.viewPath=n.viewPath||a.ajaxUrl+"&tmpl=component&no_html=1&controller=themes&task=getAjaxTemplate",a.optimizeResources=!0,a.resourcePath=n.resourcePath||a.ajaxUrl+"&tmpl=component&no_html=1&controller=foundry&task=getResource",a.resourceInterval=1200,a.scriptVersioning=n.scriptVersioning||!1,a.tasks=[],FD40.component(i,a),o){if(a.debug)o.queue.execute();else{for(var r,s=FD40.installer(i);r=s.shift();)a.install.apply(a,r);e.when(a.install("definitions"),a.install("scripts"),a.install("resources")).done(function(){o.queue.execute()})}var l=a.storage=function(t,i){var n=a.prefix,t=n+t,o=arguments.length;return 1==o?e.Storage.get(t):2==o?!1===t?e.Storage.remove(n+i):e.Storage.set(t,i):l.getAll()};e.extend(a.storage,{getAll:function(){var t=a.prefix,i=t.length,n=e.Storage.getAll(),o={};for(key in n)key.substr(0,i)==t&&(o[key.substr(i)]=n[key]);return o},remove:function(t){e.Storage.remove(a.prefix+t)},clear:function(){for(key in l.getAll())l.remove(key)}})}},t.extend=function(i,n){t.prototype[i]=n,e.each(t.registry,function(e,o){t.proxy(o,i,n)})},e.template("component/console",'<div id="[%== component.identifier %]-console" class="foundry-console" style="display: none; z-index: 999999;"><div class="console-header"><div class="console-title">[%= component.className %] [%= component.version %]</div><div class="console-remove-button">x</div></div><div class="console-log-item-group"></div><style type="text/css">.foundry-console{position:fixed;width:50%;height:50%;bottom:0;left:0;background:white;box-shadow: 0 0 5px 0;margin-left: 25px;}.console-log-item-group{width: 100%;height: 100%;overflow-y:scroll;}.console-header{position: absolute;background:red;color:white;font-weight:bold;top:-24px;left: 0;line-height:24px;width:100%}.console-remove-button{text-align:center;cursor: pointer;display:block;width: 24px;float:right}.console-remove-button:hover{color: yellow}.console-title{padding: 0 5px;float:left}.console-log-item{padding: 5px}.console-log-item + .console-log-item{border-top: 1px solid #ccc}</style></div>'),t.console=function(t){return function(t){var i,n=function(e){return arguments.length<1?n.toggle():n[e]&&n[e].apply(n,arguments)};return n.selector="#"+t.identifier+"-console",n.init=function(){return(i=e(n.selector)).length<1&&(i=e(e.View("component/console",{component:t})).appendTo("body")).find(".console-remove-button").click(function(){i.hide()}),n.element=i,arguments.callee},n.methods={log:function(n,o,a){o=o||"info";var r=i.find(".console-log-item-group"),s=e(document.createElement("div")).addClass("console-log-item type-"+o).attr("data-code",a).html(n);r.append(s),r[0].scrollTop=r[0].scrollHeight,t.debug&&i.show()},toggle:function(){i.toggle()},reset:function(){i.find(".console-log-item-group").empty()}},e.each(n.methods,function(e,t){n[e]=function(){return n.init(),t.apply(n,arguments)}}),n}(t)};var i=e(document),n=t.prototype;e.extend(n,{run:function(t){return e.isFunction(t)?t(e):this},ready:function(){return i.ready(function(){n.ready=n.run}),function(t){e.isFunction(t)&&i.ready(function(){t(e)})}}(),install:function(t,i){var n=this,o=n.tasks[t]||(n.tasks[t]=e.Deferred());if(!i)return o;var a=function(){return i(e,n),o.resolve()};if("definitions"==t)return a();e.when(n.install("definitions")).done(a)},token:function(){var t=this;if(t.token.value)return t.token.value;var i=t.identifier,n='meta[name="'+i+':token"]',o=e("span#"+i+"-token input").attr("name")||e(n).attr("content");return t.token.value=o},template:function(t){var i=this;return void 0==t?e.grep(e.template(),function(e){return 0==e.indexOf(i.prefix)}):(arguments[0]=i.prefix+t,e.template.apply(null,arguments))},require:function(t){var i=this,t=t||{},n=e.require(t),o={};return e.each(["library","script","language","template","done"],function(e,t){o[t]=n[t]}),n.resource=function(t){if(e.isPlainObject(t)&&t.type&&t.name&&e.isDeferred(t.loader)){var o=i.resourceCollector;o||(o=i.resourceCollector=e.Deferred(),e.extend(o,{name:e.uid("ResourceCollector"),manifest:[],loaderList:[],loaders:[],load:function(){if(delete i.resourceCollector,o.manifest.length<0)o.resolve();else{var t=0,n=function(){t++,e.Ajax({type:"POST",url:i.resourcePath,dataType:"json",data:{resource:o.manifest}}).done(function(n){e.isArray(n)?(e.each(n,function(e,t){var i=t.content;o.loaders[t.id][void 0!==i?"resolve":"reject"](i)}),t>1&&i.debug&&console.info("Attempt to try and get resources again was successful!")):o.reject("Server did not return a valid resource manifest.")}).fail(function(){t>2?i.debug&&console.error("Unable to get resource again. Giving up!"):(i.debug&&console.warn("Unable to get resource. Trying again..."),n())})};n(),e.when.apply(null,o.loaderList).done(o.resolve).fail(o.reject)}}}),setTimeout(o.load,i.resourceCollectionInterval));var a=t.id=e.uid("Resource");return o.loaders[a]=t.loader,o.loaderList.push(t.loader),delete t.loader,o.manifest.push(t),n}},n.view=function(){var t=this,o=t.expand(arguments,{path:i.viewPath}),a={},r=o.options,s=e.map(o.names,function(o){var r=i.prefix+o,s=e.require.template.loaders[r];if(!s)return s=e.require.template.loader(r),s.name=r,t.addTask(s),i.optimizeResources?void n.resource({type:"view",name:o,loader:s}):(a[o]=s,o)});return s.length>0&&e.Ajax({url:r.path,dataType:"json",data:{names:s}}).done(function(t){e.isArray(t)&&e.each(t,function(e,t){var i=t.content;a[t.name][void 0!==i?"resolve":"reject"](i)})}),n},n.language=function(){var t=this,a=t.expand(arguments,{path:i.languagePath});return i.optimizeResources?e.each(a.names,function(i,o){var a=e.require.language.loaders[o];a||((a=e.require.language.loader(o)).name=o,t.addTask(a),n.resource({type:"language",name:o,loader:a}))}):o.language.apply(n,[a.options].concat(a.names)),n},n.library=function(){return o.script.apply(this,arguments),n},n.script=function(){var t=this.expand(arguments,{path:i.scriptPath});return names=e.map(t.names,function(n){return e.isArray(n)||e.isUrl(n)||/^(\/|\.)/.test(n)?n:[[i.prefix+n,e.uri(t.options.path).toPath("./"+n+"."+(t.options.extension||"js")+(i.scriptVersioning?"?version="+i.safeVersion:"")).toString(),!0]]}),o.script.apply(n,[t.options].concat(names)),n},n.template=function(){var t=this.expand(arguments,{path:i.templatePath});return o.template.apply(n,[t.options].concat(e.map(t.names,function(e){return[[i.prefix+e,e]]}))),n},n.app=function(){var t=this.expand(arguments,{path:i.scriptPath});return names=e.map(t.names,function(n){if(e.isArray(n)||e.isUrl(n)||/^(\/|\.)/.test(n))return n;var o=n.split("/"),a=e.rootPath+"/media/"+i.componentName+"/apps";return 4===o.length&&(a+="/"+o.shift()),a+="/"+o[0]+"/"+o[1]+"/scripts/"+o[2],[[i.prefix+n,a+"."+(t.options.extension||"js")+(i.scriptVersioning?"?version="+i.safeVersion:""),!0]]}),o.script.apply(n,[t.options].concat(names)),n},n.done=function(e){return o.done.call(n,function(){i.ready(e)})},n},module:function(t,i){var n=this;if(!e.isArray(t)){var o=n.prefix+t;return i?e.module.apply(null,[o,function(){var t=this;i.call(t,e)}]):e.module(o)}}}),e.Component.extend("ajax",function(t,i,n){var o=this,a=new Date,r={url:o.ajaxUrl+"&_ts="+a.getTime(),data:e.extend(i,{option:o.componentName,namespace:t})};if(r=e.extend(!0,r,o.options.ajax),r.data[o.token()]=1,r.data.hasOwnProperty("args")&&(r.data.args=e.toJSON(r.data.args)),e.isPlainObject(n)){if(n.type){switch(n.type){case"jsonp":n.dataType="jsonp",n.crossDomain=!0,r.data.transport="jsonp";break;case"iframe":n.iframe=!0,n.processData=!1,n.files=r.data.files,delete r.data.files,r.data.transport="iframe"}delete n.type}e.extend(r,n)}e.isFunction(n)&&(r.success=n);var s=e.server(r);return s.progress(function(e,t,i){o.debug&&"debug"==t&&o.console.log(e,t,i)}),s}),e.Component.extend("Controller",function(){var t,i,n=this,o=e.makeArray(arguments),a=o[0];return 1==o.length?e.String.getObject(a):(o.length>2?(t=o[1],i=o[2]):(t={},i=o[1]),e.extend(t,{root:n.className+".Controller",component:n}),e.Controller.apply(this,[a,t,i]))}),e.Component.extend("Model",function(){var t,i,n=this,o=e.makeArray(arguments),a=n.className+".Model."+o[0];return 1==o.length?e.String.getObject(o[0]):(2==o.length&&(t={},i=o[1]),o.length>2&&(t=o[1],i=o[2]),e.extend(t,{component:n}),e.Model.apply(this,[a,t,i]))}),e.Component.extend("Model.List",function(){var t,i,n=this,o=e.makeArray(arguments),a=n.className+".Model.List."+o[0];return 1==o.length?e.String.getObject(o[0]):(2==o.length&&(t={},i=o[1]),o.length>2&&(t=o[1],i=o[2]),e.extend(t,{component:n}),e.Model.List.apply(this,[a,t,i]))}),e.Component.extend("View",function(t){var i=this;return arguments.length<1?i.template():(arguments[0]=i.prefix+arguments[0],e.View.apply(this,arguments))}),FD40.module.execute(),e.each(FD40.component(),function(t,i){i.registered||e.Component.register(i)})}),FD40.plugin("static",function($){!function(){var e=["dialog/default"],t=$.stylesheet({content:".foundryDialog{background:url(images/333-50.png);padding:5px;border:1px solid #333;border-radius:8px;-moz-border-radius:8px;-webkit-border-radius:8px}.foundryDialog.resizing{padding-bottom:7px}.foundryDialog .dialog-wrap{border:1px solid #333;border-radius:4px;-moz-border-radius:4px;-webkit-border-radius:4px;background:#fff;overflow:hidden;min-height:100%;height:100%}.foundryDialog .dialog-wrap>.in{position:relative}.foundryDialog .dialog-head{font:700 14px/30px Arial;height:30px;padding:0 9px;border-top:1px solid #f5f5f5;border-bottom:1px solid #666;background:#eaeaea;color:#444 !important;border-radius:4px 4px 0 0;-moz-border-radius:4px 4px 0 0;-webkit-border-radius:4px 4px 0 0;position:relative}.foundryDialog .dialog-body{background:#fff;padding:10px}.foundryDialog .dialog-body.type-iframe{padding:0}.foundryDialog .dialog-footer{background:#fafafa;border-top:1px solid #aaa;padding:6px;border-radius:0 0 4px 4px;-moz-border-radius:0 0 4px 4px;-webkit-border-radius:0 0 4px 4px}.foundryDialog .dialog-buttons{text-align:right}.foundryDialog .dialog-closeButton{background:url(images/cross-8.png) center;display:block;text-indent:-9999px;width:8px;height:8px;position:absolute !important;right:10px;top:50%;margin-top:-4px;opacity:.4;cursor:pointer}.foundryDialog .dialog-closeButton:hover{opacity:.7}.foundryDialog .dialog-loader{position:absolute;background:rgba(255,255,255,0.5);z-index:9999}.foundryDialog .loader-img{background:url(images/ajax-loader.gif) center no-repeat;width:32px;height:32px;position:absolute;top:50%;left:50%;margin:-16px 0 0 -16px}"})?"resolve":"reject";$.each(e,function(e,i){$.require.stylesheet.loader(i)[t]()})}(),$.module(["uniform","chosen","event/drag","mousewheel","resize","expanding","ui/core","ui/mouse","ui/widget","textboxlist","autosize.input","scrollTo","tinyscrollbar","history","masonry","datetimepicker","","popbox","ui/position","gmaps","placeholder","image","imgareaselect","passwordstrength","mentions","dialog","easing","gritter"]),function(){var e=function(e){var t=this,i=e,n=function(){!function(e){e.uniform={options:{selectClass:"selector",radioClass:"radio",checkboxClass:"checker",fileClass:"uploader",filenameClass:"filename",fileBtnClass:"action",fileDefaultText:"No file selected",fileBtnText:"Choose File",checkedClass:"checked",focusClass:"focus",disabledClass:"disabled",buttonClass:"button",activeClass:"active",hoverClass:"hover",useID:!0,idPrefix:"uniform",resetSelector:!1,autoHide:!0},elements:[]},e.browser.msie&&e.browser.version<7?e.support.selectOpacity=!1:e.support.selectOpacity=!0,e.fn.uniform=function(t){function i(t){$el=e(t),$el.addClass($el.attr("type")),c(t)}function n(t){e(t).addClass("uniform"),c(t)}function o(i){var n=e(i),o=e("<div>"),a=e("<span>");o.addClass(t.buttonClass),t.useID&&""!=n.attr("id")&&o.attr("id",t.idPrefix+"-"+n.attr("id"));var r;n.is("a")||n.is("button")?r=n.text():(n.is(":submit")||n.is(":reset")||n.is("input[type=button]"))&&(r=n.attr("value")),r=""==r?n.is(":reset")?"Reset":"Submit":r,a.html(r),n.css("opacity",0),n.wrap(o),n.wrap(a),o=n.closest("div"),a=n.closest("span"),n.is(":disabled")&&o.addClass(t.disabledClass),o.bind({"mouseenter.uniform":function(){o.addClass(t.hoverClass)},"mouseleave.uniform":function(){o.removeClass(t.hoverClass),o.removeClass(t.activeClass)},"mousedown.uniform touchbegin.uniform":function(){o.addClass(t.activeClass)},"mouseup.uniform touchend.uniform":function(){o.removeClass(t.activeClass)},"click.uniform touchend.uniform":function(t){if(e(t.target).is("span")||e(t.target).is("div"))if(i[0].dispatchEvent){var n=document.createEvent("MouseEvents");n.initEvent("click",!0,!0),i[0].dispatchEvent(n)}else i[0].click()}}),i.bind({"focus.uniform":function(){o.addClass(t.focusClass)},"blur.uniform":function(){o.removeClass(t.focusClass)}}),e.uniform.noSelect(o),c(i)}function a(i){var n=e(i),o=e("<div />"),a=e("<span />");"none"==!n.css("display")&&t.autoHide&&o.hide(),o.addClass(t.selectClass),t.useID&&""!=i.attr("id")&&o.attr("id",t.idPrefix+"-"+i.attr("id"));var r=i.find(":selected:first");0==r.length&&(r=i.find("option:first")),a.html(r.html()),i.css("opacity",0),i.wrap(o),i.before(a),o=i.parent("div"),a=i.siblings("span"),i.bind({"change.uniform":function(){a.text(i.find(":selected").html()),o.removeClass(t.activeClass)},"focus.uniform":function(){o.addClass(t.focusClass)},"blur.uniform":function(){o.removeClass(t.focusClass),o.removeClass(t.activeClass)},"mousedown.uniform touchbegin.uniform":function(){o.addClass(t.activeClass)},"mouseup.uniform touchend.uniform":function(){o.removeClass(t.activeClass)},"click.uniform touchend.uniform":function(){o.removeClass(t.activeClass)},"mouseenter.uniform":function(){o.addClass(t.hoverClass)},"mouseleave.uniform":function(){o.removeClass(t.hoverClass),o.removeClass(t.activeClass)},"keyup.uniform":function(){a.text(i.find(":selected").html())}}),e(i).prop("disabled")&&o.addClass(t.disabledClass),e.uniform.noSelect(a),c(i)}function r(i){var n=e(i),o=e("<div />"),a=e("<span />");"none"==!n.css("display")&&t.autoHide&&o.hide(),o.addClass(t.checkboxClass),t.useID&&""!=i.attr("id")&&o.attr("id",t.idPrefix+"-"+i.attr("id")),e(i).wrap(o),e(i).wrap(a),a=i.parent(),o=a.parent(),e(i).css("opacity",0).bind({"focus.uniform":function(){o.addClass(t.focusClass)},"blur.uniform":function(){o.removeClass(t.focusClass)},"click.uniform touchend.uniform":function(){e(i).prop("checked")?a.addClass(t.checkedClass):a.removeClass(t.checkedClass)},"mousedown.uniform touchbegin.uniform":function(){o.addClass(t.activeClass)},"mouseup.uniform touchend.uniform":function(){o.removeClass(t.activeClass)},"mouseenter.uniform":function(){o.addClass(t.hoverClass)},"mouseleave.uniform":function(){o.removeClass(t.hoverClass),o.removeClass(t.activeClass)}}),e(i).prop("checked")&&a.addClass(t.checkedClass),e(i).prop("disabled")&&o.addClass(t.disabledClass),c(i)}function s(i){var n=e(i),o=e("<div />"),a=e("<span />");"none"==!n.css("display")&&t.autoHide&&o.hide(),o.addClass(t.radioClass),t.useID&&""!=i.attr("id")&&o.attr("id",t.idPrefix+"-"+i.attr("id")),e(i).wrap(o),e(i).wrap(a),a=i.parent(),o=a.parent(),e(i).css("opacity",0).bind({"focus.uniform":function(){o.addClass(t.focusClass)},"blur.uniform":function(){o.removeClass(t.focusClass)},"click.uniform touchend.uniform":function(){if(e(i).prop("checked")){var n=t.radioClass.split(" ")[0];e("."+n+" span."+t.checkedClass+":has([name='"+e(i).attr("name")+"'])").removeClass(t.checkedClass),a.addClass(t.checkedClass)}else a.removeClass(t.checkedClass)},"mousedown.uniform touchend.uniform":function(){e(i).is(":disabled")||o.addClass(t.activeClass)},"mouseup.uniform touchbegin.uniform":function(){o.removeClass(t.activeClass)},"mouseenter.uniform touchend.uniform":function(){o.addClass(t.hoverClass)},"mouseleave.uniform":function(){o.removeClass(t.hoverClass),o.removeClass(t.activeClass)}}),e(i).prop("checked")&&a.addClass(t.checkedClass),e(i).prop("disabled")&&o.addClass(t.disabledClass),c(i)}function l(i){var n=e(i),o=e("<div />"),a=e("<span>"+t.fileDefaultText+"</span>"),r=e("<span>"+t.fileBtnText+"</span>");if("none"==!n.css("display")&&t.autoHide&&o.hide(),o.addClass(t.fileClass),a.addClass(t.filenameClass),r.addClass(t.fileBtnClass),t.useID&&""!=n.attr("id")&&o.attr("id",t.idPrefix+"-"+n.attr("id")),n.wrap(o),n.after(r),n.after(a),o=n.closest("div"),a=n.siblings("."+t.filenameClass),r=n.siblings("."+t.fileBtnClass),!n.attr("size")){var s=o.width();n.attr("size",s/10)}var l=function(){var e=n.val();e=""===e?t.fileDefaultText:(e=e.split(/[\/\\]+/))[e.length-1],a.text(e)};l(),n.css("opacity",0).bind({"focus.uniform":function(){o.addClass(t.focusClass)},"blur.uniform":function(){o.removeClass(t.focusClass)},"mousedown.uniform":function(){e(i).is(":disabled")||o.addClass(t.activeClass)},"mouseup.uniform":function(){o.removeClass(t.activeClass)},"mouseenter.uniform":function(){o.addClass(t.hoverClass)},"mouseleave.uniform":function(){o.removeClass(t.hoverClass),o.removeClass(t.activeClass)}}),e.browser.msie?n.bind("click.uniform.ie7",function(){setTimeout(l,0)}):n.bind("change.uniform",l),n.prop("disabled")&&o.addClass(t.disabledClass),e.uniform.noSelect(a),e.uniform.noSelect(r),c(i)}function c(t){(t=e(t).get()).length>1?e.each(t,function(t,i){e.uniform.elements.push(i)}):e.uniform.elements.push(t)}var d=this;return 0!=(t=e.extend(e.uniform.options,t)).resetSelector&&e(t.resetSelector).mouseup(function(){function t(){e.uniform.update(d)}setTimeout(t,10)}),e.uniform.restore=function(t){void 0==t&&(t=e(e.uniform.elements)),e(t).each(function(){e(this).is(":checkbox")?e(this).unwrap().unwrap():e(this).is("select")?(e(this).siblings("span").remove(),e(this).unwrap()):e(this).is(":radio")?e(this).unwrap().unwrap():e(this).is(":file")?(e(this).siblings("span").remove(),e(this).unwrap()):e(this).is("button, :submit, :reset, a, input[type='button']")&&e(this).unwrap().unwrap(),e(this).unbind(".uniform"),e(this).css("opacity","1");var i=e.inArray(e(t),e.uniform.elements);e.uniform.elements.splice(i,1)})},e.uniform.noSelect=function(t){function i(){return!1}e(t).each(function(){this.onselectstart=this.ondragstart=i,e(this).mousedown(i).css({MozUserSelect:"none"})})},e.uniform.update=function(i){void 0==i&&(i=e(e.uniform.elements)),(i=e(i)).each(function(){var n=e(this);if(n.is("select")){o=n.siblings("span");(a=n.parent("div")).removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass),o.html(n.find(":selected").html()),n.is(":disabled")?a.addClass(t.disabledClass):a.removeClass(t.disabledClass)}else if(n.is(":checkbox")){o=n.closest("span");(a=n.closest("div")).removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass),o.removeClass(t.checkedClass),n.is(":checked")&&o.addClass(t.checkedClass),n.is(":disabled")?a.addClass(t.disabledClass):a.removeClass(t.disabledClass)}else if(n.is(":radio")){var o=n.closest("span");(a=n.closest("div")).removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass),o.removeClass(t.checkedClass),n.is(":checked")&&o.addClass(t.checkedClass),n.is(":disabled")?a.addClass(t.disabledClass):a.removeClass(t.disabledClass)}else if(n.is(":file")){var a=n.parent("div"),r=n.siblings(t.filenameClass);btnTag=n.siblings(t.fileBtnClass),a.removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass),r.text(n.val()),n.is(":disabled")?a.addClass(t.disabledClass):a.removeClass(t.disabledClass)}else(n.is(":submit")||n.is(":reset")||n.is("button")||n.is("a")||i.is("input[type=button]"))&&((a=n.closest("div")).removeClass(t.hoverClass+" "+t.focusClass+" "+t.activeClass),n.is(":disabled")?a.addClass(t.disabledClass):a.removeClass(t.disabledClass))})},this.each(function(){if(e.support.selectOpacity){var t=e(this);t.is("select")?1!=t.attr("multiple")&&(void 0==t.attr("size")||t.attr("size")<=1)&&a(t):t.is(":checkbox")?r(t):t.is(":radio")?s(t):t.is(":file")?l(t):t.is(":text, :password, input[type='email']")?i(t):t.is("textarea")?n(t):(t.is("a")||t.is(":submit")||t.is(":reset")||t.is("button")||t.is("input[type=button]"))&&o(t)}})}}(i)};n(),t.resolveWith(n)};FD40.module("uniform",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){var e={};(function(){var e;(e=function(){function e(){this.options_index=0,this.parsed=[]}return e.prototype.add_node=function(e){return"OPTGROUP"===e.nodeName.toUpperCase()?this.add_group(e):this.add_option(e)},e.prototype.add_group=function(e){var t,i,n,o,a,r;for(t=this.parsed.length,this.parsed.push({array_index:t,group:!0,label:e.label,children:0,disabled:e.disabled}),r=[],n=0,o=(a=e.childNodes).length;n<o;n++)i=a[n],r.push(this.add_option(i,t,e.disabled));return r},e.prototype.add_option=function(e,t,i){if("OPTION"===e.nodeName.toUpperCase())return""!==e.text?(null!=t&&(this.parsed[t].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:!0===i?i:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},e}()).select_to_array=function(t){var i,n,o,a,r;for(n=new e,o=0,a=(r=t.childNodes).length;o<a;o++)i=r[o],n.add_node(i);return n.parsed},this.SelectParser=e}).call(e),function(){var e,t;t=this,e=function(){function e(e,t){this.form_field=e,this.options=null!=t?t:{},this.set_default_values(),this.is_multiple=this.form_field.multiple,this.set_default_text(),this.setup(),this.set_up_html(),this.register_observers(),this.finish_setup()}return e.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.result_single_selected=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.search_contains=this.options.search_contains||!1,this.choices=0,this.single_backstroke_delete=this.options.single_backstroke_delete||!1,this.max_selected_options=this.options.max_selected_options||1/0},e.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||"Select Some Options":this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||"Select an Option",this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||"No results match"},e.prototype.mouse_enter=function(){return this.mouse_on_container=!0},e.prototype.mouse_leave=function(){return this.mouse_on_container=!1},e.prototype.input_focus=function(e){var t=this;if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)},e.prototype.input_blur=function(e){var t=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return t.blur_test()},100)},e.prototype.result_add_option=function(e){var t,i;return e.disabled?"":(e.dom_id=this.container_id+"_o_"+e.array_index,t=e.selected&&this.is_multiple?[]:["active-result"],e.selected&&t.push("result-selected"),null!=e.group_array_index&&t.push("group-option"),""!==e.classes&&t.push(e.classes),i=""!==e.style.cssText?' style="'+e.style+'"':"",'<li id="'+e.dom_id+'" class="'+t.join(" ")+'"'+i+">"+e.html+"</li>")},e.prototype.results_update_field=function(){return this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.result_single_selected=null,this.results_build()},e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},e.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()},e.prototype.keyup_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices>0)return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(e.preventDefault(),this.results_showing)return this.result_select(e);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},e.prototype.generate_field_id=function(){var e;return e=this.generate_random_id(),this.form_field.id=e,e},e.prototype.generate_random_char=function(){var e,t;return e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ",t=Math.floor(Math.random()*e.length),e.substring(t,t+1)},e}(),t.AbstractChosen=e}.call(e),function(){var e,t,n,o,a=Object.prototype.hasOwnProperty,r=function(e,t){function i(){this.constructor=e}for(var n in t)a.call(t,n)&&(e[n]=t[n]);return i.prototype=t.prototype,e.prototype=new i,e.__super__=t.prototype,e};o=this,(e=i).fn.extend({chosen:function(i){return e.browser.msie&&("6.0"===e.browser.version||"7.0"===e.browser.version&&7===document.documentMode)?this:this.each(function(n){var o;if(!(o=e(this)).hasClass("chzn-done"))return o.data("chosen",new t(this,i))})}}),t=function(t){function i(){i.__super__.constructor.apply(this,arguments)}return r(i,t),i.prototype.setup=function(){return this.form_field_jq=e(this.form_field),this.current_value=this.form_field_jq.val(),this.is_rtl=this.form_field_jq.hasClass("chzn-rtl")},i.prototype.finish_setup=function(){return this.form_field_jq.addClass("chzn-done")},i.prototype.set_up_html=function(){var t,i,o,a;return this.container_id=this.form_field.id.length?this.form_field.id.replace(/[^\w]/g,"_"):this.generate_field_id(),this.container_id+="_chzn",this.f_width=this.form_field_jq.outerWidth(),t=e("<div />",{id:this.container_id,class:"chzn-container"+(this.is_rtl?" chzn-rtl":""),style:"width: "+this.f_width+"px;"}),this.is_multiple?t.html('<ul class="chzn-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chzn-drop" style="left:-9000px;"><ul class="chzn-results"></ul></div>'):t.html('<a href="javascript:void(0)" class="chzn-single chzn-default"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chzn-drop" style="left:-9000px;"><div class="chzn-search"><input type="text" autocomplete="off" /></div><ul class="chzn-results"></ul></div>'),this.form_field_jq.hide().after(t),this.container=e("#"+this.container_id),this.container.addClass("chzn-container-"+(this.is_multiple?"multi":"single")),this.dropdown=this.container.find("div.chzn-drop").first(),i=this.container.height(),o=this.f_width-n(this.dropdown),this.dropdown.css({width:o+"px",top:i+"px"}),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chzn-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chzn-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chzn-search").first(),this.selected_item=this.container.find(".chzn-single").first(),a=o-n(this.search_container)-n(this.search_field),this.search_field.css({width:a+"px"})),this.results_build(),this.set_tab_index(),this.form_field_jq.trigger("liszt:ready",{chosen:this})},i.prototype.register_observers=function(){var e=this;return this.container.mousedown(function(t){return e.container_mousedown(t)}),this.container.mouseup(function(t){return e.container_mouseup(t)}),this.container.mouseenter(function(t){return e.mouse_enter(t)}),this.container.mouseleave(function(t){return e.mouse_leave(t)}),this.search_results.mouseup(function(t){return e.search_results_mouseup(t)}),this.search_results.mouseover(function(t){return e.search_results_mouseover(t)}),this.search_results.mouseout(function(t){return e.search_results_mouseout(t)}),this.form_field_jq.bind("liszt:updated",function(t){return e.results_update_field(t)}),this.form_field_jq.bind("liszt:activate",function(t){return e.activate_field(t)}),this.form_field_jq.bind("liszt:open",function(t){return e.container_mousedown(t)}),this.search_field.blur(function(t){return e.input_blur(t)}),this.search_field.keyup(function(t){return e.keyup_checker(t)}),this.search_field.keydown(function(t){return e.keydown_checker(t)}),this.is_multiple?(this.search_choices.click(function(t){return e.choices_click(t)}),this.search_field.focus(function(t){return e.input_focus(t)})):this.container.click(function(e){return e.preventDefault()})},i.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chzn-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus",this.activate_action),this.close_field()):(this.container.removeClass("chzn-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus",this.activate_action))},i.prototype.container_mousedown=function(t){var i;if(!this.is_disabled)return i=null!=t&&e(t.target).hasClass("search-choice-close"),t&&"mousedown"===t.type&&!this.results_showing&&t.stopPropagation(),this.pending_destroy_click||i?this.pending_destroy_click=!1:(this.active_field?this.is_multiple||!t||e(t.target)[0]!==this.selected_item[0]&&!e(t.target).parents("a.chzn-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),e(document).click(this.click_test_action),this.results_show()),this.activate_field())},i.prototype.container_mouseup=function(e){if("ABBR"===e.target.nodeName&&!this.is_disabled)return this.results_reset(e)},i.prototype.blur_test=function(e){if(!this.active_field&&this.container.hasClass("chzn-container-active"))return this.close_field()},i.prototype.close_field=function(){return e(document).unbind("click",this.click_test_action),this.is_multiple||(this.selected_item.attr("tabindex",this.search_field.attr("tabindex")),this.search_field.attr("tabindex",-1)),this.active_field=!1,this.results_hide(),this.container.removeClass("chzn-container-active"),this.winnow_results_clear(),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},i.prototype.activate_field=function(){return this.is_multiple||this.active_field||(this.search_field.attr("tabindex",this.selected_item.attr("tabindex")),this.selected_item.attr("tabindex",-1)),this.container.addClass("chzn-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val()),this.search_field.focus()},i.prototype.test_active_click=function(t){return e(t.target).parents("#"+this.container_id).length?this.active_field=!0:this.close_field()},i.prototype.results_build=function(){var e,t,i,n,a;for(this.parsing=!0,this.results_data=o.SelectParser.select_to_array(this.form_field),this.is_multiple&&this.choices>0?(this.search_choices.find("li.search-choice").remove(),this.choices=0):this.is_multiple||(this.selected_item.addClass("chzn-default").find("span").text(this.default_text),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?this.container.addClass("chzn-container-single-nosearch"):this.container.removeClass("chzn-container-single-nosearch")),e="",i=0,n=(a=this.results_data).length;i<n;i++)(t=a[i]).group?e+=this.result_add_group(t):t.empty||(e+=this.result_add_option(t),t.selected&&this.is_multiple?this.choice_build(t):t.selected&&!this.is_multiple&&(this.selected_item.removeClass("chzn-default").find("span").text(t.text),this.allow_single_deselect&&this.single_deselect_control_build()));return this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.search_results.html(e),this.parsing=!1},i.prototype.result_add_group=function(t){return t.disabled?"":(t.dom_id=this.container_id+"_g_"+t.array_index,'<li id="'+t.dom_id+'" class="group-result">'+e("<div />").text(t.label).html()+"</li>")},i.prototype.result_do_highlight=function(e){var t,i,n,o,a;if(e.length){if(this.result_clear_highlight(),this.result_highlight=e,this.result_highlight.addClass("highlighted"),n=parseInt(this.search_results.css("maxHeight"),10),a=this.search_results.scrollTop(),o=n+a,i=this.result_highlight.position().top+this.search_results.scrollTop(),(t=i+this.result_highlight.outerHeight())>=o)return this.search_results.scrollTop(t-n>0?t-n:0);if(i<a)return this.search_results.scrollTop(i)}},i.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},i.prototype.results_show=function(){var e;if(this.is_multiple){if(this.max_selected_options<=this.choices)return this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1}else this.selected_item.addClass("chzn-single-with-drop"),this.result_single_selected&&this.result_do_highlight(this.result_single_selected);return e=this.is_multiple?this.container.height():this.container.height()-1,this.form_field_jq.trigger("liszt:showing_dropdown",{chosen:this}),this.dropdown.css({top:e+"px",left:0}),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results()},i.prototype.results_hide=function(){return this.is_multiple||this.selected_item.removeClass("chzn-single-with-drop"),this.result_clear_highlight(),this.form_field_jq.trigger("liszt:hiding_dropdown",{chosen:this}),this.dropdown.css({left:"-9000px"}),this.results_showing=!1},i.prototype.set_tab_index=function(e){var t;if(this.form_field_jq.attr("tabindex"))return t=this.form_field_jq.attr("tabindex"),this.form_field_jq.attr("tabindex",-1),this.is_multiple?this.search_field.attr("tabindex",t):(this.selected_item.attr("tabindex",t),this.search_field.attr("tabindex",-1))},i.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},i.prototype.search_results_mouseup=function(t){var i;if((i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first()).length)return this.result_highlight=i,this.result_select(t)},i.prototype.search_results_mouseover=function(t){var i;if(i=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first())return this.result_do_highlight(i)},i.prototype.search_results_mouseout=function(t){if(e(t.target).hasClass("active-result"))return this.result_clear_highlight()},i.prototype.choices_click=function(t){if(t.preventDefault(),this.active_field&&!e(t.target).hasClass("search-choice")&&!this.results_showing)return this.results_show()},i.prototype.choice_build=function(t){var i,n,o=this;return this.is_multiple&&this.max_selected_options<=this.choices?(this.form_field_jq.trigger("liszt:maxselected",{chosen:this}),!1):(i=this.container_id+"_c_"+t.array_index,this.choices+=1,n=t.disabled?'<li class="search-choice search-choice-disabled" id="'+i+'"><span>'+t.html+"</span></li>":'<li class="search-choice" id="'+i+'"><span>'+t.html+'</span><a href="javascript:void(0)" class="search-choice-close" rel="'+t.array_index+'"></a></li>',this.search_container.before(n),e("#"+i).find("a").first().click(function(e){return o.choice_destroy_link_click(e)}))},i.prototype.choice_destroy_link_click=function(t){return t.preventDefault(),this.is_disabled?t.stopPropagation:(this.pending_destroy_click=!0,this.choice_destroy(e(t.target)))},i.prototype.choice_destroy=function(e){if(this.result_deselect(e.attr("rel")))return this.choices-=1,this.show_search_field_default(),this.is_multiple&&this.choices>0&&this.search_field.val().length<1&&this.results_hide(),e.parents("li").first().remove()},i.prototype.results_reset=function(){if(this.form_field.options[0].selected=!0,this.selected_item.find("span").text(this.default_text),this.is_multiple||this.selected_item.addClass("chzn-default"),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field)return this.results_hide()},i.prototype.results_reset_cleanup=function(){return this.current_value=this.form_field_jq.val(),this.selected_item.find("abbr").remove()},i.prototype.result_select=function(e){var t,i,n,o;if(this.result_highlight)return t=this.result_highlight,i=t.attr("id"),this.result_clear_highlight(),this.is_multiple?this.result_deactivate(t):(this.search_results.find(".result-selected").removeClass("result-selected"),this.result_single_selected=t,this.selected_item.removeClass("chzn-default")),t.addClass("result-selected"),o=i.substr(i.lastIndexOf("_")+1),n=this.results_data[o],n.selected=!0,this.form_field.options[n.options_index].selected=!0,this.is_multiple?this.choice_build(n):(this.selected_item.find("span").first().text(n.text),this.allow_single_deselect&&this.single_deselect_control_build()),e.metaKey&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field_jq.val()!==this.current_value)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[n.options_index].value}),this.current_value=this.form_field_jq.val(),this.search_field_scale()},i.prototype.result_activate=function(e){return e.addClass("active-result")},i.prototype.result_deactivate=function(e){return e.removeClass("active-result")},i.prototype.result_deselect=function(t){var i;return i=this.results_data[t],!this.form_field.options[i.options_index].disabled&&(i.selected=!1,this.form_field.options[i.options_index].selected=!1,e("#"+this.container_id+"_o_"+t).removeClass("result-selected").addClass("active-result").show(),this.result_clear_highlight(),this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[i.options_index].value}),this.search_field_scale(),!0)},i.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect&&this.selected_item.find("abbr").length<1)return this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>')},i.prototype.winnow_results=function(){var t,i,n,o,a,r,s,l,c,d,u,p,f,m,h,g,v,y;for(this.no_results_clear(),c=0,d=this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html(),r=this.search_contains?"":"^",a=new RegExp(r+d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),f=new RegExp(d.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),"i"),m=0,g=(y=this.results_data).length;m<g;m++)if(!(i=y[m]).disabled&&!i.empty)if(i.group)e("#"+i.dom_id).css("display","none");else if(!this.is_multiple||!i.selected){if(t=!1,l=i.dom_id,s=e("#"+l),a.test(i.html))t=!0,c+=1;else if((i.html.indexOf(" ")>=0||0===i.html.indexOf("["))&&(o=i.html.replace(/\[|\]/g,"").split(" ")).length)for(h=0,v=o.length;h<v;h++)n=o[h],a.test(n)&&(t=!0,c+=1);t?(d.length?(u=i.html.search(f),p=(p=i.html.substr(0,u+d.length)+"</em>"+i.html.substr(u+d.length)).substr(0,u)+"<em>"+p.substr(u)):p=i.html,s.html(p),this.result_activate(s),null!=i.group_array_index&&e("#"+this.results_data[i.group_array_index].dom_id).css("display","list-item")):(this.result_highlight&&l===this.result_highlight.attr("id")&&this.result_clear_highlight(),this.result_deactivate(s))}return c<1&&d.length?this.no_results(d):this.winnow_results_set_highlight()},i.prototype.winnow_results_clear=function(){var t,i,n,o,a;for(this.search_field.val(""),a=[],n=0,o=(i=this.search_results.find("li")).length;n<o;n++)t=i[n],(t=e(t)).hasClass("group-result")?a.push(t.css("display","auto")):this.is_multiple&&t.hasClass("result-selected")?a.push(void 0):a.push(this.result_activate(t));return a},i.prototype.winnow_results_set_highlight=function(){var e,t;if(!this.result_highlight&&(t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result"),null!=(e=t.length?t.first():this.search_results.find(".active-result").first())))return this.result_do_highlight(e)},i.prototype.no_results=function(t){var i;return(i=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>')).find("span").first().html(t),this.search_results.append(i)},i.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},i.prototype.keydown_arrow=function(){var t,i;if(this.result_highlight?this.results_showing&&(i=this.result_highlight.nextAll("li.active-result").first())&&this.result_do_highlight(i):(t=this.search_results.find("li.active-result").first())&&this.result_do_highlight(e(t)),!this.results_showing)return this.results_show()},i.prototype.keyup_arrow=function(){var e;return this.results_showing||this.is_multiple?this.result_highlight?(e=this.result_highlight.prevAll("li.active-result"),e.length?this.result_do_highlight(e.first()):(this.choices>0&&this.results_hide(),this.result_clear_highlight())):void 0:this.results_show()},i.prototype.keydown_backstroke=function(){var e;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(e=this.search_container.siblings("li.search-choice").last()).length&&!e.hasClass("search-choice-disabled")?(this.pending_backstroke=e,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},i.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},i.prototype.keydown_checker=function(e){var t,i;switch(t=null!=(i=e.which)?i:e.keyCode,this.search_field_scale(),8!==t&&this.pending_backstroke&&this.clear_backstroke(),t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e),this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault(),this.keyup_arrow();break;case 40:this.keydown_arrow()}},i.prototype.search_field_scale=function(){var t,i,n,o,a,r,s,l;if(this.is_multiple){for(0,r=0,o="position:absolute; left: -1000px; top: -1000px; display:none;",s=0,l=(a=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"]).length;s<l;s++)o+=(n=a[s])+":"+this.search_field.css(n)+";";return(i=e("<div />",{style:o})).text(this.search_field.val()),e("body").append(i),r=i.width()+25,i.remove(),r>this.f_width-10&&(r=this.f_width-10),this.search_field.css({width:r+"px"}),t=this.container.height(),this.dropdown.css({top:t+"px"})}},i.prototype.generate_random_id=function(){var t;for(t="sel"+this.generate_random_char()+this.generate_random_char()+this.generate_random_char();e("#"+t).length>0;)t+=this.generate_random_char();return t},i}(o.AbstractChosen),n=function(e){return e.outerWidth()-e.width()},o.get_side_border_padding=n}.call(e)};n(),t.resolveWith(n)};FD40.module("chosen",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e){e.fn.drag=function(t,i,n){var o="string"==typeof t?t:"",a=e.isFunction(t)?t:e.isFunction(i)?i:null;return 0!==o.indexOf("drag")&&(o="drag"+o),n=(t==a?i:n)||{},a?this.bind(o,n,a):this.trigger(o)};var t=e.event,i=t.special,n=i.drag={defaults:{which:1,distance:0,not:":input",handle:null,relative:!1,drop:!0,click:!1},datakey:"dragdata",noBubble:!0,add:function(t){var i=e.data(this,n.datakey),o=t.data||{};i.related+=1,e.each(n.defaults,function(e,t){void 0!==o[e]&&(i[e]=o[e])})},remove:function(){e.data(this,n.datakey).related-=1},setup:function(){if(!e.data(this,n.datakey)){var i=e.extend({related:0},n.defaults);e.data(this,n.datakey,i),t.add(this,"touchstart mousedown",n.init,i),this.attachEvent&&this.attachEvent("ondragstart",n.dontstart)}},teardown:function(){(e.data(this,n.datakey)||{}).related||(e.removeData(this,n.datakey),t.remove(this,"touchstart mousedown",n.init),n.textselect(!0),this.detachEvent&&this.detachEvent("ondragstart",n.dontstart))},init:function(o){if(!n.touched){var a,r=o.data;if(!(0!=o.which&&r.which>0&&o.which!=r.which)&&!e(o.target).is(r.not)&&(!r.handle||e(o.target).closest(r.handle,o.currentTarget).length)&&(n.touched="touchstart"==o.type?this:null,r.propagates=1,r.mousedown=this,r.interactions=[n.interaction(this,r)],r.target=o.target,r.pageX=o.pageX,r.pageY=o.pageY,r.dragging=null,a=n.hijack(o,"draginit",r),r.propagates))return(a=n.flatten(a))&&a.length&&(r.interactions=[],e.each(a,function(){r.interactions.push(n.interaction(this,r))})),r.propagates=r.interactions.length,!1!==r.drop&&i.drop&&i.drop.handler(o,r),n.textselect(!1),n.touched?t.add(n.touched,"touchmove touchend",n.handler,r):t.add(document,"mousemove mouseup",n.handler,r),!(!n.touched||r.live)&&void 0}},interaction:function(t,i){var o=e(t)[i.relative?"position":"offset"]()||{top:0,left:0};return{drag:t,callback:new n.callback,droppable:[],offset:o}},handler:function(o){var a=o.data;switch(o.type){case!a.dragging&&"touchmove":o.preventDefault();case!a.dragging&&"mousemove":if(Math.pow(o.pageX-a.pageX,2)+Math.pow(o.pageY-a.pageY,2)<Math.pow(a.distance,2))break;o.target=a.target,n.hijack(o,"dragstart",a),a.propagates&&(a.dragging=!0);case"touchmove":o.preventDefault();case"mousemove":if(a.dragging){if(n.hijack(o,"drag",a),a.propagates){!1!==a.drop&&i.drop&&i.drop.handler(o,a);break}o.type="mouseup"}case"touchend":case"mouseup":default:n.touched?t.remove(n.touched,"touchmove touchend",n.handler):t.remove(document,"mousemove mouseup",n.handler),a.dragging&&(!1!==a.drop&&i.drop&&i.drop.handler(o,a),n.hijack(o,"dragend",a)),n.textselect(!0),!1===a.click&&a.dragging&&e.data(a.mousedown,"suppress.click",(new Date).getTime()+5),a.dragging=n.touched=!1}},hijack:function(i,o,a,r,s){if(a){var l,c,d,u={event:i.originalEvent,type:i.type},p=o.indexOf("drop")?"drag":"drop",f=r||0,m=isNaN(r)?a.interactions.length:r;i.type=o,i.originalEvent=null,a.results=[];do{if(c=a.interactions[f]){if("dragend"!==o&&c.cancelled)continue;d=n.properties(i,a,c),c.results=[],e(s||c[p]||a.droppable).each(function(r,s){if(d.target=s,i.isPropagationStopped=function(){return!1},l=s?t.dispatch.call(s,i,d):null,!1===l?("drag"==p&&(c.cancelled=!0,a.propagates-=1),"drop"==o&&(c[p][r]=null)):"dropinit"==o&&c.droppable.push(n.element(l)||s),"dragstart"==o&&(c.proxy=e(n.element(l)||c.drag)[0]),c.results.push(l),delete i.result,"dropinit"!==o)return l}),a.results[f]=n.flatten(c.results),"dropinit"==o&&(c.droppable=n.flatten(c.droppable)),"dragstart"!=o||c.cancelled||d.update()}}while(++f<m);return i.type=u.type,i.originalEvent=u.event,n.flatten(a.results)}},properties:function(e,t,i){var o=i.callback;return o.drag=i.drag,o.proxy=i.proxy||i.drag,o.startX=t.pageX,o.startY=t.pageY,o.deltaX=e.pageX-t.pageX,o.deltaY=e.pageY-t.pageY,o.originalX=i.offset.left,o.originalY=i.offset.top,o.offsetX=o.originalX+o.deltaX,o.offsetY=o.originalY+o.deltaY,o.drop=n.flatten((i.drop||[]).slice()),o.available=n.flatten((i.droppable||[]).slice()),o},element:function(e){if(e&&(e.jquery||1==e.nodeType))return e},flatten:function(t){return e.map(t,function(t){return t&&t.jquery?e.makeArray(t):t&&t.length?n.flatten(t):t})},textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart",n.dontstart).css("MozUserSelect",t?"":"none"),document.unselectable=t?"off":"on"},dontstart:function(){return!1},callback:function(){}};n.callback.prototype={update:function(){i.drop&&this.available.length&&e.each(this.available,function(e){i.drop.locate(this,e)})}};var o=t.dispatch;t.dispatch=function(t){return e.data(this,"suppress."+t.type)-(new Date).getTime()>0?void e.removeData(this,"suppress."+t.type):o.apply(this,arguments)};var a=t.fixHooks.touchstart=t.fixHooks.touchmove=t.fixHooks.touchend=t.fixHooks.touchcancel={props:"clientX clientY pageX pageY screenX screenY".split(" "),filter:function(t,i){if(i){var n=i.touches&&i.touches[0]||i.changedTouches&&i.changedTouches[0]||null;n&&e.each(a.props,function(e,i){t[i]=n[i]})}return t}};i.draginit=i.dragstart=i.dragend=n}(i)};n(),t.resolveWith(n)};FD40.module("event/drag",e)}(),function(){var e=function(e){var t=this,i=function(){function t(t){var o,a=t||window.event,r=[].slice.call(arguments,1),s=0,l=0,c=0,d=0,u=0;return t=e.event.fix(a),t.type="mousewheel",a.wheelDelta&&(s=a.wheelDelta),a.detail&&(s=-1*a.detail),a.deltaY&&(s=c=-1*a.deltaY),a.deltaX&&(s=-1*(l=a.deltaX)),void 0!==a.wheelDeltaY&&(c=a.wheelDeltaY),void 0!==a.wheelDeltaX&&(l=-1*a.wheelDeltaX),d=Math.abs(s),(!i||d<i)&&(i=d),u=Math.max(Math.abs(c),Math.abs(l)),(!n||u<n)&&(n=u),o=s>0?"floor":"ceil",s=Math[o](s/i),l=Math[o](l/n),c=Math[o](c/n),r.unshift(t,s,l,c),(e.event.dispatch||e.event.handle).apply(this,r)}var i,n,o=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],a="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"];if(e.event.fixHooks)for(var r=o.length;r;)e.event.fixHooks[o[--r]]=e.event.mouseHooks;e.event.special.mousewheel={setup:function(){if(this.addEventListener)for(var e=a.length;e;)this.addEventListener(a[--e],t,!1);else this.onmousewheel=t},teardown:function(){if(this.removeEventListener)for(var e=a.length;e;)this.removeEventListener(a[--e],t,!1);else this.onmousewheel=null}},e.fn.extend({mousewheel:function(e){return e?this.bind("mousewheel",e):this.trigger("mousewheel")},unmousewheel:function(e){return this.unbind("mousewheel",e)}})};i(),t.resolveWith(i)};FD40.module("mousewheel",e)}(),function(){var e=function(e){var t=this,i=function(){function t(){i=window[a](function(){n.each(function(){var t=e(this),i=t.width(),n=t.height(),o=e.data(this,s);i===o.w&&n===o.h||t.trigger(r,[o.w=i,o.h=n])}),t()},o[l])}var i,n=e([]),o=e.resize=e.extend(e.resize,{}),a="setTimeout",r="resize",s=r+"-special-event",l="delay";o[l]=250,o.throttleWindow=!0,e.event.special[r]={setup:function(){if(!o.throttleWindow&&this[a])return!1;var i=e(this);n=n.add(i),e.data(this,s,{w:i.width(),h:i.height()}),1===n.length&&t()},teardown:function(){if(!o.throttleWindow&&this[a])return!1;var t=e(this);n=n.not(t),t.removeData(s),n.length||clearTimeout(i)},add:function(t){function i(t,i,o){var a=e(this),r=e.data(this,s);null==r&&(r={w:null,h:null}),r.w=void 0!==i?i:a.width(),r.h=void 0!==o?o:a.height(),n.apply(this,arguments)}if(!o.throttleWindow&&this[a])return!1;var n;if(e.isFunction(t))return n=t,i;n=t.handler,t.handler=i}}};i(),t.resolveWith(i)};FD40.module("resize",e)}(),function(){var e=function(e){var t=this,i=function(){function t(){e(this).data("textareaClone").find("div").text(this.value.replace(/\r\n/g,"\n")+" "),e(this).trigger("resize.expanding")}e.expandingTextarea=e.extend({autoInitialize:!0,initialSelector:"textarea.expanding",opts:{resize:function(){}}},e.expandingTextarea||{});var i=["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust","wordWrap","word-break","borderLeftWidth","borderRightWidth","borderTopWidth","borderBottomWidth","paddingLeft","paddingRight","paddingTop","paddingBottom","marginLeft","marginRight","marginTop","marginBottom","boxSizing","webkitBoxSizing","mozBoxSizing","msBoxSizing"],n={position:"absolute",height:"100%",resize:"none"},o={visibility:"hidden",border:"0 solid",whiteSpace:"pre-wrap"},a={position:"relative"};e.fn.expandingTextarea=function(r){var s=e.extend({},e.expandingTextarea.opts,r);return"resize"===r?this.trigger("input.expanding"):"destroy"===r?(this.filter(".expanding-init").each(function(){var t=e(this).removeClass("expanding-init");t.attr("style",t.data("expanding-styles")||"").removeData("expanding-styles")}),this):(this.filter("textarea").not(".expanding-init").addClass("expanding-init").each(function(){var r=e(this),l=r.parent(),c=e(e.parseHTML("<pre class='textareaClone'><div></div></pre>"));r.after(c).data("textareaClone",c),l.css(a),r.data("expanding-styles",r.attr("style")),r.css(n),c.css(o),e.each(i,function(e,t){var i=r.css(t);c.css(t)!==i&&c.css(t,i)}),r.bind("input.expanding propertychange.expanding keyup.expanding",t),t.apply(this),s.resize&&r.bind("resize.expanding",s.resize)}),this)},e(function(){e.expandingTextarea.autoInitialize&&e(e.expandingTextarea.initialSelector).expandingTextarea()})};i(),t.resolveWith(i)};FD40.module("expanding",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e,t){function i(t,i){var o,a,r,s=t.nodeName.toLowerCase();return"area"===s?(o=t.parentNode,a=o.name,!(!t.href||!a||"map"!==o.nodeName.toLowerCase())&&(!!(r=e("img[usemap=#"+a+"]")[0])&&n(r))):(/input|select|textarea|button|object/.test(s)?!t.disabled:"a"===s?t.href||i:i)&&n(t)}function n(t){return e.expr.filters.visible(t)&&!e(t).parents().addBack().filter(function(){return"hidden"===e.css(this,"visibility")}).length}var o=0,a=/^ui-id-\d+$/;e.ui=e.ui||{},e.extend(e.ui,{version:"1.10.4pre",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),e.fn.extend({focus:function(t){return function(i,n){return"number"==typeof i?this.each(function(){var t=this;setTimeout(function(){e(t).focus(),n&&n.call(t)},i)}):t.apply(this,arguments)}}(e.fn.focus),scrollParent:function(){var t;return t=e.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(e.css(this,"position"))&&/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(e.css(this,"overflow")+e.css(this,"overflow-y")+e.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!t.length?e(document):t},zIndex:function(t){if(void 0!==t)return this.css("zIndex",t);if(this.length)for(var i,n,o=e(this[0]);o.length&&o[0]!==document;){if(("absolute"===(i=o.css("position"))||"relative"===i||"fixed"===i)&&(n=parseInt(o.css("zIndex"),10),!isNaN(n)&&0!==n))return n;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++o)})},removeUniqueId:function(){return this.each(function(){a.test(this.id)&&e(this).removeAttr("id")})}}),e.extend(e.expr[":"],{data:e.expr.createPseudo?e.expr.createPseudo(function(t){return function(i){return!!e.data(i,t)}}):function(t,i,n){return!!e.data(t,n[3])},focusable:function(t){return i(t,!isNaN(e.attr(t,"tabindex")))},tabbable:function(t){var n=e.attr(t,"tabindex"),o=isNaN(n);return(o||n>=0)&&i(t,!o)}}),e("<a>").outerWidth(1).jquery||e.each(["Width","Height"],function(t,i){function n(t,i,n,a){return e.each(o,function(){i-=parseFloat(e.css(t,"padding"+this))||0,n&&(i-=parseFloat(e.css(t,"border"+this+"Width"))||0),a&&(i-=parseFloat(e.css(t,"margin"+this))||0)}),i}var o="Width"===i?["Left","Right"]:["Top","Bottom"],a=i.toLowerCase(),r={innerWidth:e.fn.innerWidth,innerHeight:e.fn.innerHeight,outerWidth:e.fn.outerWidth,outerHeight:e.fn.outerHeight};e.fn["inner"+i]=function(t){return void 0===t?r["inner"+i].call(this):this.each(function(){e(this).css(a,n(this,t)+"px")})},e.fn["outer"+i]=function(t,o){return"number"!=typeof t?r["outer"+i].call(this,t):this.each(function(){e(this).css(a,n(this,t,!0,o)+"px")})}}),e.fn.addBack||(e.fn.addBack=function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}),e("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(e.fn.removeData=function(t){return function(i){return arguments.length?t.call(this,e.camelCase(i)):t.call(this)}}(e.fn.removeData)),e.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),e.support.selectstart="onselectstart"in document.createElement("div"),e.fn.extend({disableSelection:function(){return this.bind((e.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(e){e.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),e.extend(e.ui,{plugin:{add:function(t,i,n){var o,a=e.ui[t].prototype;for(o in n)a.plugins[o]=a.plugins[o]||[],a.plugins[o].push([i,n[o]])},call:function(e,t,i){var n,o=e.plugins[t];if(o&&e.element[0].parentNode&&11!==e.element[0].parentNode.nodeType)for(n=0;n<o.length;n++)e.options[o[n][0]]&&o[n][1].apply(e.element,i)}},hasScroll:function(t,i){if("hidden"===e(t).css("overflow"))return!1;var n=i&&"left"===i?"scrollLeft":"scrollTop",o=!1;return t[n]>0||(t[n]=1,o=t[n]>0,t[n]=0,o)}}),e(function(){e("body > [id=fd].ui").length>0||e(document.createElement("div")).attr("id","fd").addClass("ui").css({position:"absolute",top:0,left:0,overflow:"visible",width:0,height:0,zIndex:10002}).appendTo("body")})}(i)};n(),t.resolveWith(n)};FD40.module("ui/core",e)}(),function(){var e=function(e){var t=this,i=e;e.require().script("ui/widget").done(function(){var e=function(){!function(e,t){var i=!1;e(document).mouseup(function(){i=!1}),e.widget("ui.mouse",{version:"1.10.4pre",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var t=this;this.element.bind("mousedown."+this.widgetName,function(e,i){return t._mouseDown(i||e)}).bind("click."+this.widgetName,function(i){if(!0===e.data(i.target,t.widgetName+".preventClickEvent"))return e.removeData(i.target,t.widgetName+".preventClickEvent"),i.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(t){if(!i){this._mouseStarted&&this._mouseUp(t),this._mouseDownEvent=t;var n=this,o=1===t.which,a=!("string"!=typeof this.options.cancel||!t.target.nodeName)&&e(t.target).closest(this.options.cancel).length;return!(o&&!a&&this._mouseCapture(t))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){n.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(t),!this._mouseStarted)?(t.preventDefault(),!0):(!0===e.data(t.target,this.widgetName+".preventClickEvent")&&e.removeData(t.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(e){return n._mouseMove(e)},this._mouseUpDelegate=function(e){return n._mouseUp(e)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),t.preventDefault(),i=!0,!0))}},_mouseMove:function(t){return e.ui.ie&&(!document.documentMode||document.documentMode<9)&&!t.button?this._mouseUp(t):this._mouseStarted?(this._mouseDrag(t),t.preventDefault()):(this._mouseDistanceMet(t)&&this._mouseDelayMet(t)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,t),this._mouseStarted?this._mouseDrag(t):this._mouseUp(t)),!this._mouseStarted)},_mouseUp:function(t){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,t.target===this._mouseDownEvent.target&&e.data(t.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(t)),!1},_mouseDistanceMet:function(e){return Math.max(Math.abs(this._mouseDownEvent.pageX-e.pageX),Math.abs(this._mouseDownEvent.pageY-e.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(i)};e(),t.resolveWith(e)})};FD40.module("ui/mouse",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e,t){var i=0,n=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var i,n=0;null!=(i=t[n]);n++)try{e(i).triggerHandler("remove")}catch(e){}o(t)},e.widget=function(t,i,n){var o,a,r,s,l={},c=t.split(".")[0];t=t.split(".")[1],o=c+"-"+t,n||(n=i,i=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[c]=e[c]||{},a=e[c][t],r=e[c][t]=function(e,t){if(!this._createWidget)return new r(e,t);arguments.length&&this._createWidget(e,t)},e.extend(r,a,{version:n.version,_proto:e.extend({},n),_childConstructors:[]}),(s=new i).options=e.widget.extend({},s.options),e.each(n,function(t,n){e.isFunction(n)?l[t]=function(){var e=function(){return i.prototype[t].apply(this,arguments)},o=function(e){return i.prototype[t].apply(this,e)};return function(){var t,i=this._super,a=this._superApply;return this._super=e,this._superApply=o,t=n.apply(this,arguments),this._super=i,this._superApply=a,t}}():l[t]=n}),r.prototype=e.widget.extend(s,{widgetEventPrefix:a?s.widgetEventPrefix:t},l,{constructor:r,namespace:c,widgetName:t,widgetFullName:o}),a?(e.each(a._childConstructors,function(t,i){var n=i.prototype;e.widget(n.namespace+"."+n.widgetName,r,i._proto)}),delete a._childConstructors):i._childConstructors.push(r),e.widget.bridge(t,r)},e.widget.extend=function(t){for(var i,o,a=n.call(arguments,1),r=0,s=a.length;r<s;r++)for(i in a[r])o=a[r][i],a[r].hasOwnProperty(i)&&void 0!==o&&(e.isPlainObject(o)?t[i]=e.isPlainObject(t[i])?e.widget.extend({},t[i],o):e.widget.extend({},o):t[i]=o);return t},e.widget.bridge=function(t,i){var o=i.prototype.widgetFullName||t;e.fn[t]=function(a){var r="string"==typeof a,s=n.call(arguments,1),l=this;return a=!r&&s.length?e.widget.extend.apply(null,[a].concat(s)):a,r?this.each(function(){var i,n=e.data(this,o);return n?e.isFunction(n[a])&&"_"!==a.charAt(0)?(i=n[a].apply(n,s),i!==n&&void 0!==i?(l=i&&i.jquery?l.pushStack(i.get()):i,!1):void 0):e.error("no such method '"+a+"' for "+t+" widget instance"):e.error("cannot call methods on "+t+" prior to initialization; attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,o);t?t.option(a||{})._init():e.data(this,o,new i(a,this))}),l}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,n){n=e(n||this.defaultElement||this)[0],this.element=e(n),this.uuid=i++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),n!==this&&(e.data(n,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===n&&this.destroy()}}),this.document=e(n.style?n.ownerDocument:n.document||n),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(t,i){var n,o,a,r=t;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof t)if(r={},n=t.split("."),t=n.shift(),n.length){for(o=r[t]=e.widget.extend({},this.options[t]),a=0;a<n.length-1;a++)o[n[a]]=o[n[a]]||{},o=o[n[a]];if(t=n.pop(),void 0===i)return void 0===o[t]?null:o[t];o[t]=i}else{if(void 0===i)return void 0===this.options[t]?null:this.options[t];r[t]=i}return this._setOptions(r),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,i,n){var o,a=this;"boolean"!=typeof t&&(n=i,i=t,t=!1),n?(i=o=e(i),this.bindings=this.bindings.add(i)):(n=i,i=this.element,o=this.widget()),e.each(n,function(n,r){function s(){if(t||!0!==a.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof r?a[r]:r).apply(a,arguments)}"string"!=typeof r&&(s.guid=r.guid=r.guid||s.guid||e.guid++);var l=n.match(/^(\w+)\s*(.*)$/),c=l[1]+a.eventNamespace,d=l[2];d?o.delegate(d,c,s):i.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){function i(){return("string"==typeof e?n[e]:e).apply(n,arguments)}var n=this;return setTimeout(i,t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,i,n){var o,a,r=this.options[t];if(n=n||{},i=e.Event(i),i.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),i.target=this.element[0],a=i.originalEvent)for(o in a)o in i||(i[o]=a[o]);return this.element.trigger(i,n),!(e.isFunction(r)&&!1===r.apply(this.element[0],[i].concat(n))||i.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,i){e.Widget.prototype["_"+t]=function(n,o,a){"string"==typeof o&&(o={effect:o});var r,s=o?!0===o||"number"==typeof o?i:o.effect||i:t;"number"==typeof(o=o||{})&&(o={duration:o}),r=!e.isEmptyObject(o),o.complete=a,o.delay&&n.delay(o.delay),r&&e.effects&&e.effects.effect[s]?n[t](o):s!==t&&n[s]?n[s](o.duration,o.easing,a):n.queue(function(i){e(this)[t](),a&&a.call(n[0]),i()})}})}(i)};n(),t.resolveWith(n)};FD40.module("ui/widget",e)}(),function(){var e=function(e){var t=this;e.require().script("autosize.input","scrollTo").done(function(){var i=function(){var t={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};e.template("textboxlist/item",'<div class="textboxlist-item[%== (this.locked) ? " is-locked" : "" %]" data-textboxlist-item><span class="textboxlist-itemContent" data-textboxlist-itemContent>[%== html %]</span><div class="textboxlist-itemRemoveButton" data-textboxlist-itemRemoveButton><i class="ies-cancel-2"></i></a></div>'),e.template("textboxlist/itemContent",'[%= title %]<input type="hidden" name="[%= name %]" value="[%= id %]"/>'),e.Controller("Textboxlist",{pluginName:"textboxlist",hostname:"textboxlist",defaultOptions:{view:{item:"textboxlist/item",itemContent:"textboxlist/itemContent"},plugin:{},name:"items[]",unique:!0,caseSensitive:!1,max:null,ignoreLocked:!1,filterItem:null,"{item}":"[data-textboxlist-item]","{itemContent}":"[data-textboxlist-itemContent]","{itemRemoveButton}":"[data-textboxlist-itemRemoveButton]","{textField}":"[data-textboxlist-textField]"}},function(i){return{init:function(){var n=i.textField();n.autosizeInput(),n.data("placeholderText",n.attr("placeholder"));var o=n.data("textboxlistName");o&&(i.options.name=o),i.item().each(function(){var t=e(this),n=t.find(i.itemContent.selector);i.createItem({id:t.data("id")||function(){var i=e.uid("item-");return t.data("id",i),i}(),title:t.data("title")||e.trim(n.text()),locked:t.hasClass("is-locked"),html:n.html()})}),(i.options.plugin.autocomplete||i.element.data("query"))&&i.addPlugin("autocomplete"),i.on("keypress",i.textField(),function(e){if(e.keyCode==t.ENTER)return e.preventDefault()})},setLayout:function(){var e=i.textField(),t=e.data("placeholderText");i.item().length>0&&(t=""),e.attr("placeholder",t).data("autosizeInputInstance").update()},enable:function(){i.element.removeClass("disabled"),i.textField().enabled(!0)},disable:function(){i.element.addClass("disabled"),i.textField().disabled(!0)},items:{},itemsByTitle:{},get:function(e){var t=i.getItemKey(e);if(i.itemsByTitle.hasOwnProperty(t))return i.itemsByTitle[t]},getItemKey:function(e){return i.options.caseSensitive?e:e.toLowerCase()},filterItem:function(t){var n=i.options.filterItem;e.isFunction(n)&&(t=n.call(i,t));var o=i.itemsByTitle;if(e.isString(t)&&""!==t){var a=t,r=i.getItemKey(a);t=o.hasOwnProperty(r)?i.itemsByTitle[r]:{id:e.uid("item-"),title:a,key:i.getItemKey(a),locked:!1}}return t.name=t.name||i.options.name,t.html=t.html||i.view.itemContent(!0,t),t},createItem:function(e){e.key=i.getItemKey(e.title),i.items[e.id]=e,i.itemsByTitle[e.key]=e},deleteItem:function(e){var t=i.items[e];i.item().filterBy("id",e).remove(),delete i.items[e];var n=i.options.caseSensitive?t.title:t.title.toLowerCase();delete i.itemsByTitle[n]},addItem:function(t,n){if(t){var o=i.options,a=o.max;if((n||null===a||!((o.ignoreLocked?i.item(":not(.is-locked)"):i.item()).length>=a))&&(t=i.filterItem(t),e.isPlainObject(t))){var r,s=i.item().filterBy("id",t.id);if(o.unique&&s.length>0&&(r=s),r||(r=i.view.item(t).addClass(t.className||"").attr("data-id",t.id)),i.createItem(t),t.locked){var l=i.item(".is-locked:last");l.length>0?r.insertAfter(l):r.prependTo(i.element)}else r.insertBefore(i.textField());return i.trigger("addItem",[t]),i.trigger("listChange"),t}}},removeItem:function(e){var t=i.items[e];i.deleteItem(e),i.trigger("removeItem",[t]),i.trigger("listChange")},clearItems:function(){i.item().each(function(){i.removeItem(e(this).data("id"))})},getAddedItems:function(){var t=[];return i.item().each(function(){var n=e(this).data("id");t.push(i.items[n])}),t},"{self} addItem":function(){i.setLayout()},"{self} removeItem":function(){i.setLayout()},"{itemRemoveButton} click":function(e){var t=e.parents(i.item.selector);i.removeItem(t.data("id"))},"{textField} keydown":function(e,i){var n=i.keyCode;e.data("realEnterKey",n==t.ENTER)},"{textField} keypress":function(n,o){var a=n.data("realEnterKey"),r=o.keyCode==t.ENTER;n.data("realEnterKey",a&&r);var s=e.trim(i.textField().val());switch(o.keyCode){case t.ENTER:if(n.data("realEnterKey")){var l=(o=i.trigger("useItem",[s])).item;if(void 0===l&&(l=s),!1===l||null===l)return;i.addItem(l),n.val("")}}},"{textField} keyup":function(n,o){var a=e.trim(i.textField().val());switch(o.keyCode){case t.BACKSPACE:if(""===a)if(i.canRemoveItemUsingBackspace){var r=n.prev(i.item.selector);if(r.length>0){var s=r.data("id");!(a=i.items[s]).locked&&i.removeItem(s)}}else i.canRemoveItemUsingBackspace=!0;break;default:i.canRemoveItemUsingBackspace=!1}},"{self} click":function(e,t){var n=i.textField();n.is(t.target)||n.focus()},"{textField} focusin":function(){i.activated||(i.activated=!0,i.trigger("textboxlistActivate"))},"{self} mousedown":function(){i.focusing=!0},"{self} mouseup":function(){i.focusing=!1},"{self} focusout":function(){i.focusing||(i.activated=!1,i.deactivateTimer=setTimeout(function(){i.activated||i.trigger("textboxlistDeactivate")},1))}}}),e(document).on("click.textboxlist.data-api","[data-textboxlist]",function(t){e(this).addController(e.Controller.Textboxlist).textField().focus()}).on("focus.textboxlist.data-api","[data-textboxlist] [data-textboxlist-textField]",function(t){e(this).parents("[data-textboxlist]").addController(e.Controller.Textboxlist)}),e.template("textboxlist/menu",'<div id="fd" class="textboxlist-autocomplete" data-textboxlist-autocomplete><b><b></b></b><div class="textboxlist-autocomplete-inner" data-textboxlist-autocomplete-viewport><div class="textboxlist-autocomplete-loading" data-textboxlist-autocomplete-loading></div><div class="textboxlist-autocomplete-empty" data-textboxlist-autocomplete-empty></div><ul class="textboxlist-menu" data-textboxlist-menu></ul></div></div>'),e.template("textboxlist/menuItem",'<li class="textboxlist-menuItem" data-textboxlist-menuItem>[%== html %]</li>'),e.template("textboxlist/loadingHint",'<i class="textboxlist-autocomplete-loading-indicator"></i>'),e.template("textboxlist/emptyHint",'<span class="textboxlist-autocomplete-empty-text">No items found.</span>'),e.Controller("Textboxlist.Autocomplete",{defaultOptions:{view:{menu:"textboxlist/menu",menuItem:"textboxlist/menuItem",loadingHint:"textboxlist/loadingHint",emptyHint:"textboxlist/emptyHint"},cache:!0,minLength:1,limit:10,highlight:!0,caseSensitive:!1,exclusive:!1,query:null,position:{my:"left top",at:"left bottom",collision:"none"},filterItem:null,showEmptyHint:!1,showLoadingHint:!1,id:"fd",component:"",modifier:"",shadow:!1,sticky:!1,animation:!1,"{menu}":"[data-textboxlist-menu]","{menuItem}":"[data-textboxlist-menuItem]","{viewport}":"[data-textboxlist-autocomplete-viewport]","{loadingHint}":"[data-textboxlist-autocomplete-loading]","{emptyHint}":"[data-textboxlist-autocomplete-empty]"}},function(i,n,o){return{init:function(){if(!i.element.data(i.Class.fullName))return i.destroy(),void i.view.menu().attr("id",n.id).addClass(n.component).addClass(n.modifier).addClass(n.shadow?"has-shadow":"").addClass(n.animation?"has-animation":"").addClass(n.sticky?"is-sticky":"").addClass(i.textboxlist.options.component).appendTo("body").data(i.Class.fullName,!0).addController(i.Class,i.options);var e=i.textboxlist;e.autocomplete=i,e.pluginInstances.autocomplete=i,i.options.position.of=i.textboxlist.element,i.initQuery(),i.view.loadingHint().appendTo(i.loadingHint()),i.view.emptyHint().appendTo(i.emptyHint()),i.element.detach()},initQuery:function(){var t=i.options.query||i.textboxlist.element.data("query");if(e.isUrl(t)){var n=t;return void(i.query=function(t){return e.ajax(n+t)})}if(e.isFunction(t)){var o=t;return void(i.query=function(e){return o.call(i,e)})}if(e.isArray(t)){var a=t;return void(i.query=function(t){var i=e.Deferred(),t=t.toLowerCase();return setTimeout(function(){var n=e.grep(a,function(e){return e.title.toLowerCase().indexOf(t)>-1});i.resolve(n)},0),i})}},setLayout:function(){i.hidden||i.element.css({opacity:1,width:i.textboxlist.element.outerWidth()}).position(i.options.position)},"{window} resize":e.debounce(function(){i.element.css("opacity",0),i.setLayout()},250),"{window} scroll":e.debounce(function(){i.element.css("opacity",0),i.setLayout()},250),"{window} dialogTransitionStart":function(){i.hidden=!0,i.element.css("opacity",0)},"{window} dialogTransitionEnd":function(){i.hidden=!1,i.setLayout()},show:function(){clearTimeout(i.sleep),i.element.appendTo("body").show(),i.hidden=!1,i.setLayout()},hide:function(){i.element.hide();var t=i.menuItem(),n=t.filter(".active");n.length>0&&(i.lastItem={keyword:e.trim(i.textboxlist.textField().val()),item:n.data("item")}),t.removeClass("active"),i.render.reset(),i.hidden=!0,clearTimeout(i.sleep),i.sleep=setTimeout(function(){i.element.detach()},3e3)},queries:{},populated:!1,populate:function(t){i.populated=!1;var n=i.element,o=i.options;n.removeClass("loading empty"),o.showLoadingHint&&i.hide();var a=i.trigger("populateKeyword",[t]);a.keyword&&(t=a.keyword);var r=o.caseSensitive?t:t.toLowerCase(),s=i.queries[r],l=!e.isDeferred(s)||!i.options.cache,c=function(){o.showLoadingHint&&(n.addClass("loading"),i.show()),(l||!l&&"rejected"==s.state())&&(s=i.queries[r]=i.query(t)),s.done(i.render(function(e){return[e,t]})).fail(function(){i.hide()}).always(function(){n.removeClass("loading")}),i.trigger("queryKeyword",[s,t])};l?(clearTimeout(i.queryTask),i.queryTask=setTimeout(c,250)):c()},populateTask:null,populateFromTextField:function(){clearTimeout(i.populateTask),i.populateTask=setTimeout(function(){var t=i.textboxlist.textField(),n=e.trim(t.val());""===n||n.length<i.options.minLength?i.hide():i.populate(n)},1)},render:e.Enqueue(function(t,n){e.isArray(t)||(t=[]);var o=i.textboxlist,a=i,r=i.element,s=i.options,l=i.menu();if(t.length<1)s.showEmptyHint?(l.empty(),r.addClass("empty"),o.trigger("renderMenu",[l,a,o]),i.show()):i.hide();else{r.removeClass("empty"),s.cache&&l.data("keyword")===n||(l.empty(),e.each(t,function(t,r){o.trigger("filterItem",[r,a,o]);var c=s.filterItem;if(e.isFunction(c)&&(r=c.call(i,r,n)),e.isPlainObject(r)&&!r.discard){var d=r.menuHtml||r.title;i.view.menuItem({html:d}).addClass(r.className||"").data("item",r).appendTo(l)}}),l.data("keyword",n));var c=i.menuItem();if(o.trigger("filterMenu",[l,c,a,o]),c.filter(":not(.hidden)").length<1&&(r.addClass("empty"),!s.showEmptyHint))return i.hide();s.exclusive&&i.menuItem(":not(.hidden):first").addClass("active"),o.trigger("renderMenu",[l,a,o]),i.show()}}),"{textboxlist.textField} keydown":function(e,n){clearTimeout(i.sleep);var o=i.menuItem(".active:not(.hidden)");o.length<1&&(o=!1);i.textboxlist.textField();switch(n.keyCode){case t.UP:i.menuItem().removeClass("active"),o?o.prev(i.menuItem.selector+":not(.hidden)").addClass("active"):i.menuItem(":not(.hidden):last").addClass("active"),n.preventDefault();break;case t.DOWN:i.menuItem().removeClass("active"),o?o.next(i.menuItem.selector+":not(.hidden)").addClass("active"):i.menuItem(":not(.hidden):first").addClass("active"),n.preventDefault();break;case t.ESCAPE:i.hide();break;case t.ENTER:break;default:i.populateFromTextField()}(o=i.menuItem(".active:not(.hidden)")).length<1||i.viewport().scrollIntoView(o)},"{textboxlist} textboxlistActivate":function(e){i.populateFromTextField()},"{textboxlist} textboxlistDeactivate":function(e){setTimeout(function(){i.hide()},150)},"{textboxlist} destroyed":function(){i.element.remove()},"{textboxlist} useItem":function(e,t,n){var o=i.options.exclusive;if(o&&(t.item=!1),i.hidden){var a=i.lastItem;return void(o&&a&&a.keyword==n&&(t.item=a.item))}var r=i.menuItem(".active");if(r.length>0){var s=r.data("item");t.item=s}i.hide()},"{menuItem} mousedown":function(){i.textboxlist.focusing=!0},"{menuItem} mouseup":function(){i.textboxlist.focusing=!1},"{menuItem} click":function(e){i.hide();var t=e.data("item");i.textboxlist.addItem(t);var n=i.textboxlist.textField().val("");setTimeout(function(){n.focus()},150)},"{menuItem} mouseover":function(e){i.menuItem().removeClass("active"),e.addClass("active")},"{menuItem} mouseout":function(e){i.menuItem().removeClass("active")}}})};i(),t.resolveWith(i)})};FD40.module("textboxlist",e)}(),function(){var e=function(e){var t=this,i=function(){var t=function(i,n){var o=this;o.input=e(i),o.options=e.extend(t.defaultOptions,n),o.mirror=e('<span style="position:absolute; top:-999px; left:0; white-space:pre;"/>'),e.each(["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],function(e,t){o.mirror[0].style[t]=o.input.css(t)}),e("body").append(o.mirror),o.input.bind("keydown keyup input",function(e){o.update()}),o.update()};t.defaultOptions={space:30},t.validTypes=["text","password","search","url","tel","email"],t.prototype.update=function(){var e=this,t=e.input,i=e.mirror,n=t.val();if(n||(n=t.attr("placeholder")),n!==i.text()){i.text(n);var o=i.width()+e.options.space;t.width(o)}},e.fn.autosizeInput=function(i){return this.each(function(){if("INPUT"==this.tagName&&e.inArray(this.type,t.validTypes)>-1){var n=e(this);n.data("autosizeInputInstance")||n.data("autosizeInputInstance",new t(this,i))}})},e(function(){e("input[data-autosize-input]").autosizeInput()})};i(),t.resolveWith(i)};FD40.module("autosize.input",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e){function t(e){return"object"==typeof e?e:{top:e,left:e}}var i=e.scrollTo=function(t,i,n){e(window).scrollTo(t,i,n)};i.defaults={axis:"xy",duration:parseFloat(e.fn.jquery)>=1.3?0:1,limit:!0},i.window=function(t){return e(window)._scrollable()},e.fn._scrollable=function(){return this.map(function(){var t=this;if(!(!t.nodeName||-1!=e.inArray(t.nodeName.toLowerCase(),["iframe","#document","html","body"])))return t;var i=(t.contentWindow||t).document||t.ownerDocument||t;return/webkit/i.test(navigator.userAgent)||"BackCompat"==i.compatMode?i.body:i.documentElement})},e.fn.scrollTo=function(n,o,a){return"object"==typeof o&&(a=o,o=0),"function"==typeof a&&(a={onAfter:a}),"max"==n&&(n=9e9),a=e.extend({},i.defaults,a),o=o||a.duration,a.queue=a.queue&&a.axis.length>1,a.queue&&(o/=2),a.offset=t(a.offset),a.over=t(a.over),this._scrollable().each(function(){function r(e){c.animate(u,o,a.easing,e&&function(){e.call(this,n,a)})}if(null!=n){var s,l=this,c=e(l),d=n,u={},p=c.is("html,body");switch(typeof d){case"number":case"string":if(/^([+-]=)?\d+(\.\d+)?(px|%)?$/.test(d)){d=t(d);break}if(!(d=e(d,this)).length)return;case"object":(d.is||d.style)&&(s=(d=e(d)).offset())}e.each(a.axis.split(""),function(e,t){var n="x"==t?"Left":"Top",o=n.toLowerCase(),f="scroll"+n,m=l[f],h=i.max(l,t);if(s)u[f]=s[o]+(p?0:m-c.offset()[o]),a.margin&&(u[f]-=parseInt(d.css("margin"+n))||0,u[f]-=parseInt(d.css("border"+n+"Width"))||0),u[f]+=a.offset[o]||0,a.over[o]&&(u[f]+=d["x"==t?"width":"height"]()*a.over[o]);else{var g=d[o];u[f]=g.slice&&"%"==g.slice(-1)?parseFloat(g)/100*h:g}a.limit&&/^\d+$/.test(u[f])&&(u[f]=u[f]<=0?0:Math.min(u[f],h)),!e&&a.queue&&(m!=u[f]&&r(a.onAfterFirst),delete u[f])}),r(a.onAfter)}}).end()},e.fn.scrollIntoView=function(t){if(!((t=e(t)).length<1)){var i=this.offset(),n=this.height(),o=i.top,a=o+n,r=t.offset(),s=t.height(),l=r.top;return l+s>a?this.scrollTo(t):l<o?this.scrollTo(t,{offset:-1*(n-s)}):void 0}},i.max=function(t,i){var n="x"==i?"Width":"Height",o="scroll"+n;if(!e(t).is("html,body"))return t[o]-e(t)[n.toLowerCase()]();var a="client"+n,r=t.ownerDocument.documentElement,s=t.ownerDocument.body;return Math.max(r[o],s[o])-Math.min(r[a],s[a])}}(i)};n(),t.resolveWith(n)};FD40.module("scrollTo",e)}(),function(){var e=function(e){var t=this,i=function(){!function(e){function t(t,i){function n(){var e=y.toLowerCase();h.obj.css(v,E/f.ratio),p.obj.css(v,-E),S.start=h.obj.offset()[v],f.obj.css(e,m[i.axis]),m.obj.css(e,m[i.axis]),h.obj.css(e,h[i.axis])}function o(){C?u.obj[0].ontouchstart=function(e){1===e.touches.length&&(a(e.touches[0]),e.stopPropagation())}:(h.obj.bind("mousedown",a),m.obj.bind("mouseup",s)),i.scroll&&window.addEventListener?(d[0].addEventListener("DOMMouseScroll",r,!1),d[0].addEventListener("mousewheel",r,!1)):i.scroll&&(d[0].onmousewheel=r)}function a(t){var i=parseInt(h.obj.css(v),10);S.start=g?t.pageX:t.pageY,b.start="auto"==i?0:i,C?(document.ontouchmove=function(e){e.preventDefault(),s(e.touches[0])},document.ontouchend=l):(e(document).bind("mousemove",s),e(document).bind("mouseup",l),h.obj.bind("mouseup",l))}function r(t){if(p.ratio<1){var n=t||window.event,o=n.wheelDelta?n.wheelDelta/120:-n.detail/3;E-=o*i.wheel,E=Math.min(p[i.axis]-u[i.axis],Math.max(0,E)),h.obj.css(v,E/f.ratio),p.obj.css(v,-E),(i.lockscroll||E!==p[i.axis]-u[i.axis]&&0!==E)&&(n=e.event.fix(n)).preventDefault()}}function s(e){p.ratio<1&&(b.now=C?Math.min(m[i.axis]-h[i.axis],Math.max(0,b.start+(S.start-(g?e.pageX:e.pageY)))):Math.min(m[i.axis]-h[i.axis],Math.max(0,b.start+((g?e.pageX:e.pageY)-S.start))),E=b.now*f.ratio,p.obj.css(v,-E),h.obj.css(v,b.now))}function l(){e(document).unbind("mousemove",s),e(document).unbind("mouseup",l),h.obj.unbind("mouseup",l),document.ontouchmove=document.ontouchend=null}var c=this,d=t,u={obj:e(".viewport",t)},p={obj:e(".overview",t)},f={obj:e(".scrollbar",t)},m={obj:e(".track",f.obj)},h={obj:e(".thumb",f.obj)},g="x"===i.axis,v=g?"left":"top",y=g?"Width":"Height",E=0,b={start:0,now:0},S={},C="ontouchstart"in document.documentElement;return this.update=function(e){u[i.axis]=u.obj[0]["offset"+y],p[i.axis]=p.obj[0]["scroll"+y],p.ratio=u[i.axis]/p[i.axis],f.obj.toggleClass("disable",p.ratio>=1),m[i.axis]="auto"===i.size?u[i.axis]:i.size,h[i.axis]=Math.min(m[i.axis],Math.max(0,"auto"===i.sizethumb?m[i.axis]*p.ratio:i.sizethumb)),f.ratio="auto"===i.sizethumb?p[i.axis]/m[i.axis]:(p[i.axis]-u[i.axis])/(m[i.axis]-h[i.axis]),E="relative"===e&&p.ratio<=1?Math.min(p[i.axis]-u[i.axis],Math.max(0,E)):0,E="bottom"===e&&p.ratio<=1?p[i.axis]-u[i.axis]:isNaN(parseInt(e,10))?E:parseInt(e,10),n()},function(){return c.update(),o(),c}()}e.tiny=e.tiny||{},e.tiny.scrollbar={options:{axis:"y",wheel:40,scroll:!0,lockscroll:!0,size:"auto",sizethumb:"auto"}},e.fn.tinyscrollbar=function(i){var n=e.extend({},e.tiny.scrollbar.options,i);return this.each(function(){e(this).data("tsb",new t(e(this),n))}),this},e.fn.tinyscrollbar_update=function(t){return e(this).data("tsb").update(t)}}(e)};i(),t.resolveWith(i)};FD40.module("tinyscrollbar",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e,t){"use strict";var n=e.History=e.History||{};if(void 0!==n.Adapter)throw new Error("History.js Adapter has already been loaded...");n.Adapter={bind:function(e,t,n){i(e).bind(t,n)},trigger:function(e,t,n){i(e).trigger(t,n)},extractEventData:function(e,t,i){return t&&t.originalEvent&&t.originalEvent[e]||i&&i[e]||void 0},onDomLoad:function(e){i(e)}},void 0!==n.init&&n.init()}(window),function(e,t){"use strict";var i=e.document,n=e.setTimeout||n,o=e.clearTimeout||o,a=e.setInterval||a,r=e.History=e.History||{};if(void 0!==r.initHtml4)throw new Error("History.js HTML4 Support has already been loaded...");r.initHtml4=function(){if(void 0!==r.initHtml4.initialized)return!1;r.initHtml4.initialized=!0,r.enabled=!0,r.savedHashes=[],r.isLastHash=function(e){return e===r.getHashByIndex()},r.saveHash=function(e){return!r.isLastHash(e)&&(r.savedHashes.push(e),!0)},r.getHashByIndex=function(e){return void 0===e?r.savedHashes[r.savedHashes.length-1]:e<0?r.savedHashes[r.savedHashes.length+e]:r.savedHashes[e]},r.discardedHashes={},r.discardedStates={},r.discardState=function(e,t,i){var n,o=r.getHashByState(e);return n={discardedState:e,backState:i,forwardState:t},r.discardedStates[o]=n,!0},r.discardHash=function(e,t,i){var n={discardedHash:e,backState:i,forwardState:t};return r.discardedHashes[e]=n,!0},r.discardedState=function(e){var t=r.getHashByState(e);return r.discardedStates[t]||!1},r.discardedHash=function(e){return r.discardedHashes[e]||!1},r.recycleState=function(e){var t=r.getHashByState(e);return r.discardedState(e)&&delete r.discardedStates[t],!0},r.emulated.hashChange&&(r.hashChangeInit=function(){r.checkerFunction=null;var t,n,o,s,l="";return r.isInternetExplorer()?(t="historyjs-iframe",(n=i.createElement("iframe")).setAttribute("id",t),n.style.display="none",i.body.appendChild(n),n.contentWindow.document.open(),n.contentWindow.document.close(),o="",s=!1,r.checkerFunction=function(){if(s)return!1;s=!0;var t=r.getHash()||"",i=r.unescapeHash(n.contentWindow.document.location.hash)||"";return t!==l?(l=t,i!==t&&(o=i=t,n.contentWindow.document.open(),n.contentWindow.document.close(),n.contentWindow.document.location.hash=r.escapeHash(t)),r.Adapter.trigger(e,"hashchange")):i!==o&&(o=i,r.setHash(i,!1)),s=!1,!0}):r.checkerFunction=function(){var t=r.getHash();return t!==l&&(l=t,r.Adapter.trigger(e,"hashchange")),!0},r.intervalList.push(a(r.checkerFunction,r.options.hashChangeInterval)),!0},r.Adapter.onDomLoad(r.hashChangeInit)),r.emulated.pushState&&(r.onHashChange=function(t){var n,o=t&&t.newURL||i.location.href,a=r.getHashByUrl(o),s=null;return r.isLastHash(a)?(r.busy(!1),!1):(r.doubleCheckComplete(),r.saveHash(a),a&&r.isTraditionalAnchor(a)?(r.Adapter.trigger(e,"anchorchange"),r.busy(!1),!1):(s=r.extractState(r.getFullUrl(a||i.location.href,!1),!0),r.isLastSavedState(s)?(r.busy(!1),!1):(r.getHashByState(s),(n=r.discardedState(s))?(r.getHashByIndex(-2)===r.getHashByState(n.forwardState)?r.back(!1):r.forward(!1),!1):(r.pushState(s.data,s.title,s.url,!1),!0))))},r.Adapter.bind(e,"hashchange",r.onHashChange),r.pushState=function(t,n,o,a){if(r.getHashByUrl(o))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==a&&r.busy())return r.pushQueue({scope:r,callback:r.pushState,args:arguments,queue:a}),!1;r.busy(!0);var s=r.createStateObject(t,n,o),l=r.getHashByState(s),c=r.getState(!1),d=r.getHashByState(c),u=r.getHash();return r.storeState(s),r.expectedStateId=s.id,r.recycleState(s),r.setTitle(s),l===d?(r.busy(!1),!1):l!==u&&l!==r.getShortUrl(i.location.href)?(r.setHash(l,!1),!1):(r.saveState(s),r.Adapter.trigger(e,"statechange"),r.busy(!1),!0)},r.replaceState=function(e,t,i,n){if(r.getHashByUrl(i))throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==n&&r.busy())return r.pushQueue({scope:r,callback:r.replaceState,args:arguments,queue:n}),!1;r.busy(!0);var o=r.createStateObject(e,t,i),a=r.getState(!1),s=r.getStateByIndex(-2);return r.discardState(a,o,s),r.pushState(o.data,o.title,o.url,!1),!0}),r.emulated.pushState&&r.getHash()&&!r.emulated.hashChange&&r.Adapter.onDomLoad(function(){r.Adapter.trigger(e,"hashchange")})},void 0!==r.init&&r.init()}(window),function(e,t){"use strict";var i=e.console||void 0,n=e.document,o=e.navigator,a=e.sessionStorage||!1,r=e.setTimeout,s=e.clearTimeout,l=e.setInterval,c=e.clearInterval,d=e.JSON,u=e.alert,p=e.History=e.History||{},f=e.history;if(d.stringify=d.stringify||d.encode,d.parse=d.parse||d.decode,void 0!==p.init)throw new Error("History.js Core has already been loaded...");p.init=function(){return void 0!==p.Adapter&&(void 0!==p.initCore&&p.initCore(),void 0!==p.initHtml4&&p.initHtml4(),!0)},p.initCore=function(){if(void 0!==p.initCore.initialized)return!1;if(p.initCore.initialized=!0,p.options=p.options||{},p.options.hashChangeInterval=p.options.hashChangeInterval||100,p.options.safariPollInterval=p.options.safariPollInterval||500,p.options.doubleCheckInterval=p.options.doubleCheckInterval||500,p.options.storeInterval=p.options.storeInterval||1e3,p.options.busyDelay=p.options.busyDelay||250,p.options.debug=p.options.debug||!1,p.options.initialTitle=p.options.initialTitle||n.title,p.intervalList=[],p.clearAllIntervals=function(){var e,t=p.intervalList;if(void 0!==t&&null!==t){for(e=0;e<t.length;e++)c(t[e]);p.intervalList=null}},p.debug=function(){p.options.debug&&p.log.apply(p,arguments)},p.log=function(){var e,t,o,a,r,s=!(void 0===i||void 0===i.log||void 0===i.log.apply),l=n.getElementById("log");for(s?(e=(a=Array.prototype.slice.call(arguments)).shift(),void 0!==i.debug?i.debug.apply(i,[e,a]):i.log.apply(i,[e,a])):e="\n"+arguments[0]+"\n",t=1,o=arguments.length;t<o;++t){if("object"==typeof(r=arguments[t])&&void 0!==d)try{r=d.stringify(r)}catch(e){}e+="\n"+r+"\n"}return l?(l.value+=e+"\n-----\n",l.scrollTop=l.scrollHeight-l.clientHeight):s||u(e),!0},p.getInternetExplorerMajorVersion=function(){return p.getInternetExplorerMajorVersion.cached=void 0!==p.getInternetExplorerMajorVersion.cached?p.getInternetExplorerMajorVersion.cached:function(){for(var e=3,t=n.createElement("div"),i=t.getElementsByTagName("i");(t.innerHTML="\x3c!--[if gt IE "+ ++e+"]><i></i><![endif]--\x3e")&&i[0];);return e>4&&e}()},p.isInternetExplorer=function(){return p.isInternetExplorer.cached=void 0!==p.isInternetExplorer.cached?p.isInternetExplorer.cached:Boolean(p.getInternetExplorerMajorVersion())},p.emulated={pushState:!Boolean(e.history&&e.history.pushState&&e.history.replaceState&&!(/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i.test(o.userAgent)||/AppleWebKit\/5([0-2]|3[0-2])/i.test(o.userAgent))),hashChange:Boolean(!("onhashchange"in e||"onhashchange"in n)||p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8)},p.enabled=!p.emulated.pushState,p.bugs={setHash:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),safariPoll:Boolean(!p.emulated.pushState&&"Apple Computer, Inc."===o.vendor&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),ieDoubleCheck:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(p.isInternetExplorer()&&p.getInternetExplorerMajorVersion()<7)},p.isEmptyObject=function(e){for(var t in e)return!1;return!0},p.cloneObject=function(e){var t,i;return e?(t=d.stringify(e),i=d.parse(t)):i={},i},p.getRootUrl=function(){var e=n.location.protocol+"//"+(n.location.hostname||n.location.host);return n.location.port&&(e+=":"+n.location.port),e+="/"},p.getBaseHref=function(){var e=n.getElementsByTagName("base"),t="";return 1===e.length&&(t=e[0].href.replace(/[^\/]+$/,"")),(t=t.replace(/\/+$/,""))&&(t+="/"),t},p.getBaseUrl=function(){return p.getBaseHref()||p.getBasePageUrl()||p.getRootUrl()},p.getPageUrl=function(){return((p.getState(!1,!1)||{}).url||n.location.href).replace(/\/+$/,"").replace(/[^\/]+$/,function(e,t,i){return/\./.test(e)?e:e+"/"})},p.getBasePageUrl=function(){return n.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(e,t,i){return/[^\/]$/.test(e)?"":e}).replace(/\/+$/,"")+"/"},p.getFullUrl=function(e,t){var i=e,n=e.substring(0,1);return t=void 0===t||t,/[a-z]+\:\/\//.test(e)||(i="/"===n?p.getRootUrl()+e.replace(/^\/+/,""):"#"===n?p.getPageUrl().replace(/#.*/,"")+e:"?"===n?p.getPageUrl().replace(/[\?#].*/,"")+e:t?p.getBaseUrl()+e.replace(/^(\.\/)+/,""):p.getBasePageUrl()+e.replace(/^(\.\/)+/,"")),i.replace(/\#$/,"")},p.getShortUrl=function(e){var t=e,i=p.getBaseUrl(),n=p.getRootUrl();return p.emulated.pushState&&(t=t.replace(i,"")),t=t.replace(n,"/"),p.isTraditionalAnchor(t)&&(t="./"+t),t=t.replace(/^(\.\/)+/g,"./").replace(/\#$/,"")},p.store={},p.idToState=p.idToState||{},p.stateToId=p.stateToId||{},p.urlToId=p.urlToId||{},p.storedStates=p.storedStates||[],p.savedStates=p.savedStates||[],p.normalizeStore=function(){p.store.idToState=p.store.idToState||{},p.store.urlToId=p.store.urlToId||{},p.store.stateToId=p.store.stateToId||{}},p.getState=function(e,t){void 0===e&&(e=!0),void 0===t&&(t=!0);var i=p.getLastSavedState();return!i&&t&&(i=p.createStateObject()),e&&((i=p.cloneObject(i)).url=i.cleanUrl||i.url),i},p.getIdByState=function(e){var t,i=p.extractId(e.url);if(!i)if(t=p.getStateString(e),void 0!==p.stateToId[t])i=p.stateToId[t];else if(void 0!==p.store.stateToId[t])i=p.store.stateToId[t];else{for(;;)if(i=(new Date).getTime()+String(Math.random()).replace(/\D/g,""),void 0===p.idToState[i]&&void 0===p.store.idToState[i])break;p.stateToId[t]=i,p.idToState[i]=e}return i},p.normalizeState=function(e){var t,i;return e&&"object"==typeof e||(e={}),void 0!==e.normalized?e:(e.data&&"object"==typeof e.data||(e.data={}),t={},t.normalized=!0,t.title=e.title||"",t.url=p.getFullUrl(p.unescapeString(e.url||n.location.href)),t.hash=p.getShortUrl(t.url),t.data=p.cloneObject(e.data),t.id=p.getIdByState(t),t.cleanUrl=t.url.replace(/\??\&_suid.*/,""),t.url=t.cleanUrl,i=!p.isEmptyObject(t.data),(t.title||i)&&(t.hash=p.getShortUrl(t.url).replace(/\??\&_suid.*/,""),/\?/.test(t.hash)||(t.hash+="?"),t.hash+="&_suid="+t.id),t.hashedUrl=p.getFullUrl(t.hash),(p.emulated.pushState||p.bugs.safariPoll)&&p.hasUrlDuplicate(t)&&(t.url=t.hashedUrl),t)},p.createStateObject=function(e,t,i){var n={data:e,title:t,url:i};return n=p.normalizeState(n)},p.getStateById=function(e){return e=String(e),p.idToState[e]||p.store.idToState[e]||void 0},p.getStateString=function(e){var t,i;return t=p.normalizeState(e),i={data:t.data,title:e.title,url:e.url},d.stringify(i)},p.getStateId=function(e){var t;return t=p.normalizeState(e),t.id},p.getHashByState=function(e){var t;return t=p.normalizeState(e),t.hash},p.extractId=function(e){var t;return t=/(.*)\&_suid=([0-9]+)$/.exec(e),t?t[1]||e:e,(t?String(t[2]||""):"")||!1},p.isTraditionalAnchor=function(e){return!/[\/\?\.]/.test(e)},p.extractState=function(e,t){var i,n,o=null;return t=t||!1,(i=p.extractId(e))&&(o=p.getStateById(i)),o||(n=p.getFullUrl(e),(i=p.getIdByUrl(n)||!1)&&(o=p.getStateById(i)),o||!t||p.isTraditionalAnchor(e)||(o=p.createStateObject(null,null,n))),o},p.getIdByUrl=function(e){return p.urlToId[e]||p.store.urlToId[e]||void 0},p.getLastSavedState=function(){return p.savedStates[p.savedStates.length-1]||void 0},p.getLastStoredState=function(){return p.storedStates[p.storedStates.length-1]||void 0},p.hasUrlDuplicate=function(e){var t;return t=p.extractState(e.url),t&&t.id!==e.id},p.storeState=function(e){return p.urlToId[e.url]=e.id,p.storedStates.push(p.cloneObject(e)),e},p.isLastSavedState=function(e){var t=!1;return p.savedStates.length&&(t=e.id===p.getLastSavedState().id),t},p.saveState=function(e){return!p.isLastSavedState(e)&&(p.savedStates.push(p.cloneObject(e)),!0)},p.getStateByIndex=function(e){return void 0===e?p.savedStates[p.savedStates.length-1]:e<0?p.savedStates[p.savedStates.length+e]:p.savedStates[e]},p.getHash=function(){return p.unescapeHash(n.location.hash)},p.unescapeString=function(t){for(var i,n=t;;){if((i=e.unescape(n))===n)break;n=i}return n},p.unescapeHash=function(e){var t=p.normalizeHash(e);return t=p.unescapeString(t)},p.normalizeHash=function(e){return e.replace(/[^#]*#/,"").replace(/#.*/,"")},p.setHash=function(e,t){var i,o,a;return!1!==t&&p.busy()?(p.pushQueue({scope:p,callback:p.setHash,args:arguments,queue:t}),!1):(i=p.escapeHash(e),p.busy(!0),o=p.extractState(e,!0),o&&!p.emulated.pushState?p.pushState(o.data,o.title,o.url,!1):n.location.hash!==i&&(p.bugs.setHash?(a=p.getPageUrl(),p.pushState(null,null,a+"#"+i,!1)):n.location.hash=i),p)},p.escapeHash=function(t){var i=p.normalizeHash(t);return i=e.escape(i),p.bugs.hashEscape||(i=i.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")),i},p.getHashByUrl=function(e){var t=String(e).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");return t=p.unescapeHash(t)},p.setTitle=function(e){var t,i=e.title;i||(t=p.getStateByIndex(0))&&t.url===e.url&&(i=t.title||p.options.initialTitle);try{n.getElementsByTagName("title")[0].innerHTML=i.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")}catch(e){}return n.title=i,p},p.queues=[],p.busy=function(e){if(void 0!==e?p.busy.flag=e:void 0===p.busy.flag&&(p.busy.flag=!1),!p.busy.flag){s(p.busy.timeout);var t=function(){var e,i,n;if(!p.busy.flag)for(e=p.queues.length-1;e>=0;--e)0!==(i=p.queues[e]).length&&(n=i.shift(),p.fireQueueItem(n),p.busy.timeout=r(t,p.options.busyDelay))};p.busy.timeout=r(t,p.options.busyDelay)}return p.busy.flag},p.busy.flag=!1,p.fireQueueItem=function(e){return e.callback.apply(e.scope||p,e.args||[])},p.pushQueue=function(e){return p.queues[e.queue||0]=p.queues[e.queue||0]||[],p.queues[e.queue||0].push(e),p},p.queue=function(e,t){return"function"==typeof e&&(e={callback:e}),void 0!==t&&(e.queue=t),p.busy()?p.pushQueue(e):p.fireQueueItem(e),p},p.clearQueue=function(){return p.busy.flag=!1,p.queues=[],p},p.stateChanged=!1,p.doubleChecker=!1,p.doubleCheckComplete=function(){return p.stateChanged=!0,p.doubleCheckClear(),p},p.doubleCheckClear=function(){return p.doubleChecker&&(s(p.doubleChecker),p.doubleChecker=!1),p},p.doubleCheck=function(e){return p.stateChanged=!1,p.doubleCheckClear(),p.bugs.ieDoubleCheck&&(p.doubleChecker=r(function(){return p.doubleCheckClear(),p.stateChanged||e(),!0},p.options.doubleCheckInterval)),p},p.safariStatePoll=function(){var t=p.extractState(n.location.href);if(!p.isLastSavedState(t))return t||p.createStateObject(),p.Adapter.trigger(e,"popstate"),p},p.back=function(e){return!1!==e&&p.busy()?(p.pushQueue({scope:p,callback:p.back,args:arguments,queue:e}),!1):(p.busy(!0),p.doubleCheck(function(){p.back(!1)}),f.go(-1),!0)},p.forward=function(e){return!1!==e&&p.busy()?(p.pushQueue({scope:p,callback:p.forward,args:arguments,queue:e}),!1):(p.busy(!0),p.doubleCheck(function(){p.forward(!1)}),f.go(1),!0)},p.go=function(e,t){var i;if(e>0)for(i=1;i<=e;++i)p.forward(t);else{if(!(e<0))throw new Error("History.go: History.go requires a positive or negative integer passed.");for(i=-1;i>=e;--i)p.back(t)}return p},p.emulated.pushState){var t=function(){};p.pushState=p.pushState||t,p.replaceState=p.replaceState||t}else p.onPopState=function(t,i){var o,a,r=!1,s=!1;return p.doubleCheckComplete(),(o=p.getHash())?(a=p.extractState(o||n.location.href,!0),a?p.replaceState(a.data,a.title,a.url,!1):(p.Adapter.trigger(e,"anchorchange"),p.busy(!1)),p.expectedStateId=!1,!1):(r=p.Adapter.extractEventData("state",t,i)||!1,(s=r?p.getStateById(r):p.expectedStateId?p.getStateById(p.expectedStateId):p.extractState(n.location.href))||(s=p.createStateObject(null,null,n.location.href)),p.expectedStateId=!1,p.isLastSavedState(s)?(p.busy(!1),!1):(p.storeState(s),p.saveState(s),p.setTitle(s),p.Adapter.trigger(e,"statechange"),p.busy(!1),!0))},p.Adapter.bind(e,"popstate",p.onPopState),p.pushState=function(t,i,n,o){if(p.getHashByUrl(n)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==o&&p.busy())return p.pushQueue({scope:p,callback:p.pushState,args:arguments,queue:o}),!1;p.busy(!0);var a=p.createStateObject(t,i,n);return p.isLastSavedState(a)?p.busy(!1):(p.storeState(a),p.expectedStateId=a.id,f.pushState(a.id,a.title,a.url),p.Adapter.trigger(e,"popstate")),!0},p.replaceState=function(t,i,n,o){if(p.getHashByUrl(n)&&p.emulated.pushState)throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).");if(!1!==o&&p.busy())return p.pushQueue({scope:p,callback:p.replaceState,args:arguments,queue:o}),!1;p.busy(!0);var a=p.createStateObject(t,i,n);return p.isLastSavedState(a)?p.busy(!1):(p.storeState(a),p.expectedStateId=a.id,f.replaceState(a.id,a.title,a.url),p.Adapter.trigger(e,"popstate")),!0};if(a){try{p.store=d.parse(a.getItem("History.store"))||{}}catch(e){p.store={}}p.normalizeStore()}else p.store={},p.normalizeStore();p.Adapter.bind(e,"beforeunload",p.clearAllIntervals),p.Adapter.bind(e,"unload",p.clearAllIntervals),p.saveState(p.storeState(p.extractState(n.location.href,!0))),a&&(p.onUnload=function(){var e,t;try{e=d.parse(a.getItem("History.store"))||{}}catch(t){e={}}e.idToState=e.idToState||{},e.urlToId=e.urlToId||{},e.stateToId=e.stateToId||{};for(t in p.idToState)p.idToState.hasOwnProperty(t)&&(e.idToState[t]=p.idToState[t]);for(t in p.urlToId)p.urlToId.hasOwnProperty(t)&&(e.urlToId[t]=p.urlToId[t]);for(t in p.stateToId)p.stateToId.hasOwnProperty(t)&&(e.stateToId[t]=p.stateToId[t]);p.store=e,p.normalizeStore(),a.setItem("History.store",d.stringify(e))},p.intervalList.push(l(p.onUnload,p.options.storeInterval)),p.Adapter.bind(e,"beforeunload",p.onUnload),p.Adapter.bind(e,"unload",p.onUnload)),p.emulated.pushState||(p.bugs.safariPoll&&p.intervalList.push(l(p.safariStatePoll,p.options.safariPollInterval)),"Apple Computer, Inc."!==o.vendor&&"Mozilla"!==(o.appCodeName||"")||(p.Adapter.bind(e,"hashchange",function(){p.Adapter.trigger(e,"popstate")}),p.getHash()&&p.Adapter.onDomLoad(function(){p.Adapter.trigger(e,"hashchange")})))},p.init()}(window);var t=[];e.fn.route=function(i){if(this.is("a")){var n=this.attr("title"),o=e.joomla.appendTitle;"before"===o&&(n=e.joomla.sitename+(n?" - "+n:"")),"after"===o&&(n=(n?n+" - ":"")+e.joomla.sitename);var a=(new Date).getTime();t[a]=a,History.pushState(e.extend({timestamp:a,refresh:!0},i),n,this.attr("href"))}return this},History.Adapter.bind(window,"statechange",function(){var e=History.getState();e.id===History.savedStates[0].id&&(window.location=e.url),e.data.timestamp in t?delete t[e.data.timestamp]:e.data.refresh&&(window.location=e.url)})};n(),t.resolveWith(n)};FD40.module("history",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e,t,n){"use strict";var o,a=t.event;a.special.smartresize={setup:function(){t(this).bind("resize",a.special.smartresize.handler)},teardown:function(){t(this).unbind("resize",a.special.smartresize.handler)},handler:function(e,t){var n=this,a=arguments;e.type="smartresize",o&&clearTimeout(o),o=setTimeout(function(){i.event.dispatch.apply(n,a)},"execAsap"===t?0:100)}},t.fn.smartresize=function(e){return e?this.bind("smartresize",e):this.trigger("smartresize",["execAsap"])},t.Mason=function(e,i){this.element=t(i),this._create(e),this._init()},t.Mason.settings={isResizable:!0,isAnimated:!1,animationOptions:{queue:!1,duration:500},gutterWidth:0,isRTL:!1,isFitWidth:!1,containerStyle:{position:"relative"}},t.Mason.prototype={_filterFindBricks:function(e){var t=this.options.itemSelector;return t?e.filter(t).add(e.find(t)):e},_getBricks:function(e){return this._filterFindBricks(e).css({position:"absolute"}).addClass("masonry-brick")},_create:function(i){this.options=t.extend(!0,{},t.Mason.settings,i),this.styleQueue=[];var n=this.element[0].style;this.originalStyle={height:n.height||""};var o=this.options.containerStyle;for(var a in o)this.originalStyle[a]=n[a]||"";this.element.css(o),this.horizontalDirection=this.options.isRTL?"right":"left",this.offset={x:parseInt(this.element.css("padding-"+this.horizontalDirection),10),y:parseInt(this.element.css("padding-top"),10)},this.isFluid=this.options.columnWidth&&"function"==typeof this.options.columnWidth;var r=this;setTimeout(function(){r.element.addClass("masonry")},0),this.options.isResizable&&t(e).bind("smartresize.masonry",function(){r.resize()}),this.reloadItems()},_init:function(e){this._getColumns(),this._reLayout(e)},option:function(e,i){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))},layout:function(e,t){for(var i=0,n=e.length;i<n;i++)this._placeBrick(e[i]);var o={};if(o.height=Math.max.apply(Math,this.colYs),this.options.isFitWidth){var a=0;for(i=this.cols;--i&&0===this.colYs[i];)a++;o.width=(this.cols-a)*this.columnWidth-this.options.gutterWidth}this.styleQueue.push({$el:this.element,style:o});var r,s=this.isLaidOut&&this.options.isAnimated?"animate":"css",l=this.options.animationOptions;for(i=0,n=this.styleQueue.length;i<n;i++)(r=this.styleQueue[i]).$el[s](r.style,l);this.styleQueue=[],t&&t.call(e),this.isLaidOut=!0},_getColumns:function(){var e=(this.options.isFitWidth?this.element.parent():this.element).width();this.columnWidth=this.isFluid?this.options.columnWidth(e):this.options.columnWidth||this.$bricks.outerWidth(!0)||e,this.columnWidth+=this.options.gutterWidth,this.cols=Math.floor((e+this.options.gutterWidth)/this.columnWidth),this.cols=Math.max(this.cols,1)},_placeBrick:function(e){var i,n,o,a,r,s=t(e);if(i=Math.ceil(s.outerWidth(!0)/(this.columnWidth+this.options.gutterWidth)),1===(i=Math.min(i,this.cols)))o=this.colYs;else for(n=this.cols+1-i,o=[],r=0;r<n;r++)a=this.colYs.slice(r,r+i),o[r]=Math.max.apply(Math,a);for(var l=Math.min.apply(Math,o),c=0,d=0,u=o.length;d<u;d++)if(o[d]===l){c=d;break}var p={top:l+this.offset.y};p[this.horizontalDirection]=this.columnWidth*c+this.offset.x,this.styleQueue.push({$el:s,style:p});var f=l+s.outerHeight(!0),m=this.cols+1-u;for(d=0;d<m;d++)this.colYs[c+d]=f},resize:function(){var e=this.cols;this._getColumns(),(this.isFluid||this.cols!==e)&&this._reLayout()},_reLayout:function(e){var t=this.cols;for(this.colYs=[];t--;)this.colYs.push(0);this.layout(this.$bricks,e)},reloadItems:function(){this.$bricks=this._getBricks(this.element.children())},reload:function(e){this.reloadItems(),this._init(e)},appended:function(e,t,i){if(t){this._filterFindBricks(e).css({top:this.element.height()});var n=this;setTimeout(function(){n._appended(e,i)},1)}else this._appended(e,i)},_appended:function(e,t){var i=this._getBricks(e);this.$bricks=this.$bricks.add(i),this.layout(i,t)},remove:function(e){this.$bricks=this.$bricks.not(e),e.remove()},destroy:function(){this.$bricks.removeClass("masonry-brick").each(function(){this.style.position="",this.style.top="",this.style.left="",this.style.right=""});var i=this.element[0].style;for(var n in this.originalStyle)i[n]=this.originalStyle[n];this.element.unbind(".masonry").removeClass("masonry").removeData("masonry"),t(e).unbind(".masonry")}},t.fn.imagesLoaded=function(e){function i(){e.call(o,a)}function n(e){var o=e.target;o.src!==s&&-1===t.inArray(o,l)&&(l.push(o),--r<=0&&(setTimeout(i),a.unbind(".imagesLoaded",n)))}var o=this,a=o.find("img").add(o.filter("img")),r=a.length,s="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",l=[];return r||i(),a.bind("load.imagesLoaded error.imagesLoaded",n).each(function(){var e=this.src;this.src=s,this.src=e}),o};var r=function(t){e.console&&e.console.error(t)};t.fn.masonry=function(e){if("string"==typeof e){var i=Array.prototype.slice.call(arguments,1);this.each(function(){var n=t.data(this,"masonry");n?t.isFunction(n[e])&&"_"!==e.charAt(0)?n[e].apply(n,i):r("no such method '"+e+"' for masonry instance"):r("cannot call methods on masonry prior to initialization; attempted to call method '"+e+"'")})}else this.each(function(){var i=t.data(this,"masonry");i?(i.option(e||{}),i._init()):t.data(this,"masonry",new t.Mason(e,this))});return this}}(window,i)};n(),t.resolveWith(n)};FD40.module("masonry",e)}(),function(){var e=function(e){var t=this;e.require().script("moment").done(function(){var n=function(){var t=0,n=e.moment,o=function(o,a){var r={pickDate:!0,pickTime:!0,useMinutes:!0,useSeconds:!1,useCurrent:!0,minuteStepping:1,minDate:new n({y:1900}),maxDate:(new n).add(100,"y"),showToday:!0,collapse:!0,language:"en",defaultDate:"",disabledDates:!1,enabledDates:!1,icons:{},useStrict:!1,direction:"auto",sideBySide:!1,daysOfWeekDisabled:!1,component:""},s={time:"fa fa-clock-o",date:"fa fa-calendar",up:"fa fa-chevron-up",down:"fa fa-chevron-down"},l=this,c=function(){return l.isInput?l.element:dateStr=l.element.find("input")},d=function(){var e;void 0!==(e=(l.element.is("input"),l.element.data())).dateFormat&&(l.options.format=e.dateFormat),void 0!==e.datePickdate&&(l.options.pickDate=e.datePickdate),void 0!==e.datePicktime&&(l.options.pickTime=e.datePicktime),void 0!==e.dateUseminutes&&(l.options.useMinutes=e.dateUseminutes),void 0!==e.dateUseseconds&&(l.options.useSeconds=e.dateUseseconds),void 0!==e.dateUsecurrent&&(l.options.useCurrent=e.dateUsecurrent),void 0!==e.dateMinutestepping&&(l.options.minuteStepping=e.dateMinutestepping),void 0!==e.dateMindate&&(l.options.minDate=e.dateMindate),void 0!==e.dateMaxdate&&(l.options.maxDate=e.dateMaxdate),void 0!==e.dateShowtoday&&(l.options.showToday=e.dateShowtoday),void 0!==e.dateCollapse&&(l.options.collapse=e.dateCollapse),void 0!==e.dateLanguage&&(l.options.language=e.dateLanguage),void 0!==e.dateDefaultdate&&(l.options.defaultDate=e.dateDefaultdate),void 0!==e.dateDisableddates&&(l.options.disabledDates=e.dateDisableddates),void 0!==e.dateEnableddates&&(l.options.enabledDates=e.dateEnableddates),void 0!==e.dateIcons&&(l.options.icons=e.dateIcons),void 0!==e.dateUsestrict&&(l.options.useStrict=e.dateUsestrict),void 0!==e.dateDirection&&(l.options.direction=e.dateDirection),void 0!==e.dateSidebyside&&(l.options.sideBySide=e.dateSidebyside)},u=function(){var t="absolute",i=l.component?l.component.offset():l.element.offset(),n=e(window);l.width=l.component?l.component.outerWidth():l.element.outerWidth(),i.top=i.top+l.element.outerHeight();var o;"up"===l.options.direction?o="top":"bottom"===l.options.direction?o="bottom":"auto"===l.options.direction&&(o=i.top+l.widget.height()>n.height()+n.scrollTop()&&l.widget.height()+l.element.outerHeight()<i.top?"top":"bottom"),"top"===o?(i.top-=l.widget.height()+l.element.outerHeight()+15,l.widget.addClass("top").removeClass("bottom")):(i.top+=1,l.widget.addClass("bottom").removeClass("top")),void 0!==l.options.width&&l.widget.width(l.options.width),"left"===l.options.orientation&&(l.widget.addClass("left-oriented"),i.left=i.left-l.widget.width()+20),D()&&(t="fixed",i.top-=n.scrollTop(),i.left-=n.scrollLeft()),n.width()<i.left+l.widget.outerWidth()?(i.right=n.width()-i.left-l.width,i.left="auto",l.widget.addClass("pull-right")):(i.right="auto",l.widget.removeClass("pull-right")),l.widget.css({position:t,top:i.top,left:i.left,right:i.right})},p=function(e,t){n(l.date).isSame(n(e))||(l.element.trigger({type:"dp.change",date:n(l.date),oldDate:n(e)}),"change"!==t&&l.element.change())},f=function(e){l.element.trigger({type:"dp.error",date:n(e)})},m=function(e){n.lang(l.options.language);var t=e;t||((t=c().val())&&(l.date=n(t,l.format,l.options.useStrict)),l.date||(l.date=n())),l.viewDate=n(l.date).startOf("month"),v(),S()},h=function(){n.lang(l.options.language);var t,i=e("<tr>"),o=n.weekdaysMin();if(0==n()._lang._week.dow)for(t=0;t<7;t++)i.append('<th class="dow">'+o[t]+"</th>");else for(t=1;t<8;t++)7==t?i.append('<th class="dow">'+o[0]+"</th>"):i.append('<th class="dow">'+o[t]+"</th>");l.widget.find(".datepicker-days thead").append(i)},g=function(){n.lang(l.options.language);for(var e="",t=0,i=n.monthsShort();t<12;)e+='<span class="month">'+i[t++]+"</span>";l.widget.find(".datepicker-months td").append(e)},v=function(){n.lang(l.options.language);var t,i,o,a,r,s,c,d,u,p=l.viewDate.year(),f=l.viewDate.month(),m=l.options.minDate.year(),h=l.options.minDate.month(),g=l.options.maxDate.year(),v=l.options.maxDate.month(),y=[],E=n.months();for(l.widget.find(".datepicker-days").find(".disabled").removeClass("disabled"),l.widget.find(".datepicker-months").find(".disabled").removeClass("disabled"),l.widget.find(".datepicker-years").find(".disabled").removeClass("disabled"),l.widget.find(".datepicker-days th:eq(1)").text(E[f]+" "+p),c=(i=n(l.viewDate).subtract("months",1)).daysInMonth(),i.date(c).startOf("week"),(p==m&&f<=h||p<m)&&l.widget.find(".datepicker-days th:eq(0)").addClass("disabled"),(p==g&&f>=v||p>g)&&l.widget.find(".datepicker-days th:eq(2)").addClass("disabled"),o=n(i).add(42,"d");i.isBefore(o);){if(i.weekday()===n().startOf("week").weekday()&&(a=e("<tr>"),y.push(a)),r="",i.year()<p||i.year()==p&&i.month()<f?r+=" old":(i.year()>p||i.year()==p&&i.month()>f)&&(r+=" new"),i.isSame(n({y:l.date.year(),M:l.date.month(),d:l.date.date()}))&&(r+=" active"),!F(i)&&N(i)||(r+=" disabled"),!0===l.options.showToday&&i.isSame(n(),"day")&&(r+=" today"),l.options.daysOfWeekDisabled)for(s in l.options.daysOfWeekDisabled)if(i.day()==l.options.daysOfWeekDisabled[s]){r+=" disabled";break}a.append('<td class="day'+r+'">'+i.date()+"</td>"),t=i.date(),i.add(1,"d"),t==i.date()&&i.add(1,"d")}for(l.widget.find(".datepicker-days tbody").empty().append(y),u=l.date.year(),E=l.widget.find(".datepicker-months").find("th:eq(1)").text(p).end().find("span").removeClass("active"),u===p&&E.eq(l.date.month()).addClass("active"),u-1<m&&l.widget.find(".datepicker-months th:eq(0)").addClass("disabled"),u+1>g&&l.widget.find(".datepicker-months th:eq(2)").addClass("disabled"),s=0;s<12;s++)p==m&&h>s||p<m?e(E[s]).addClass("disabled"):(p==g&&v<s||p>g)&&e(E[s]).addClass("disabled");for(y="",p=10*parseInt(p/10,10),d=l.widget.find(".datepicker-years").find("th:eq(1)").text(p+"-"+(p+9)).end().find("td"),l.widget.find(".datepicker-years").find("th").removeClass("disabled"),m>p&&l.widget.find(".datepicker-years").find("th:eq(0)").addClass("disabled"),g<p+9&&l.widget.find(".datepicker-years").find("th:eq(2)").addClass("disabled"),p-=1,s=-1;s<11;s++)y+='<span class="year'+(-1===s||10===s?" old":"")+(u===p?" active":"")+(p<m||p>g?" disabled":"")+'">'+p+"</span>",p+=1;d.html(y)},y=function(){n.lang(l.options.language);var e,t,i,o=l.widget.find(".timepicker .timepicker-hours table"),a="";if(o.parent().hide(),l.use24hours)for(e=0,t=0;t<6;t+=1){for(a+="<tr>",i=0;i<4;i+=1)a+='<td class="hour">'+B(e.toString())+"</td>",e++;a+="</tr>"}else for(e=1,t=0;t<3;t+=1){for(a+="<tr>",i=0;i<4;i+=1)a+='<td class="hour">'+B(e.toString())+"</td>",e++;a+="</tr>"}o.html(a)},E=function(){var e,t,i=l.widget.find(".timepicker .timepicker-minutes table"),n="",o=0,a=l.options.minuteStepping;for(i.parent().hide(),1==a&&(a=5),e=0;e<Math.ceil(60/a/4);e++){for(n+="<tr>",t=0;t<4;t+=1)o<60?(n+='<td class="minute">'+B(o.toString())+"</td>",o+=a):n+="<td></td>";n+="</tr>"}i.html(n)},b=function(){var e,t,i=l.widget.find(".timepicker .timepicker-seconds table"),n="",o=0;for(i.parent().hide(),e=0;e<3;e++){for(n+="<tr>",t=0;t<4;t+=1)n+='<td class="second">'+B(o.toString())+"</td>",o+=5;n+="</tr>"}i.html(n)},S=function(){if(l.date){var e=l.widget.find(".timepicker span[data-time-component]"),t=l.date.hours(),i="AM";l.use24hours||(t>=12&&(i="PM"),0===t?t=12:12!=t&&(t%=12),l.widget.find(".timepicker [data-action=togglePeriod]").text(i)),e.filter("[data-time-component=hours]").text(B(t)),e.filter("[data-time-component=minutes]").text(B(l.date.minutes())),e.filter("[data-time-component=seconds]").text(B(l.date.second()))}},C=function(t){t.stopPropagation(),t.preventDefault(),l.unset=!1;var i,o,a,r,s=e(t.target).closest("span, td, th"),c=n(l.date);if(1===s.length&&!s.is(".disabled"))switch(s[0].nodeName.toLowerCase()){case"th":switch(s[0].className){case"switch":k(1);break;case"prev":case"next":a=U.modes[l.viewMode].navStep,"prev"===s[0].className&&(a*=-1),l.viewDate.add(a,U.modes[l.viewMode].navFnc),v()}break;case"span":s.is(".month")?(i=s.parent().find("span").index(s),l.viewDate.month(i)):(o=parseInt(s.text(),10)||0,l.viewDate.year(o)),l.viewMode===l.minViewMode&&(l.date=n({y:l.viewDate.year(),M:l.viewDate.month(),d:l.viewDate.date(),h:l.date.hours(),m:l.date.minutes(),s:l.date.seconds()}),p(c,t.type),M()),k(-1),v();break;case"td":s.is(".day")&&(r=parseInt(s.text(),10)||1,i=l.viewDate.month(),o=l.viewDate.year(),s.is(".old")?0===i?(i=11,o-=1):i-=1:s.is(".new")&&(11==i?(i=0,o+=1):i+=1),l.date=n({y:o,M:i,d:r,h:l.date.hours(),m:l.date.minutes(),s:l.date.seconds()}),l.viewDate=n({y:o,M:i,d:Math.min(28,r)}),v(),M(),p(c,t.type))}},_={incrementHours:function(){R("add","hours",1)},incrementMinutes:function(){R("add","minutes",l.options.minuteStepping)},incrementSeconds:function(){R("add","seconds",1)},decrementHours:function(){R("subtract","hours",1)},decrementMinutes:function(){R("subtract","minutes",l.options.minuteStepping)},decrementSeconds:function(){R("subtract","seconds",1)},togglePeriod:function(){var e=l.date.hours();e>=12?e-=12:e+=12,l.date.hours(e)},showPicker:function(){l.widget.find(".timepicker > div:not(.timepicker-picker)").hide(),l.widget.find(".timepicker .timepicker-picker").show()},showHours:function(){l.widget.find(".timepicker .timepicker-picker").hide(),l.widget.find(".timepicker .timepicker-hours").show()},showMinutes:function(){l.widget.find(".timepicker .timepicker-picker").hide(),l.widget.find(".timepicker .timepicker-minutes").show()},showSeconds:function(){l.widget.find(".timepicker .timepicker-picker").hide(),l.widget.find(".timepicker .timepicker-seconds").show()},selectHour:function(t){var i=l.widget.find(".timepicker [data-action=togglePeriod]").text(),n=parseInt(e(t.target).text(),10);"PM"==i&&(n+=12),l.date.hours(n),_.showPicker.call(l)},selectMinute:function(t){l.date.minutes(parseInt(e(t.target).text(),10)),_.showPicker.call(l)},selectSecond:function(t){l.date.seconds(parseInt(e(t.target).text(),10)),_.showPicker.call(l)}},w=function(t){var i=n(l.date),o=e(t.currentTarget).data("action"),a=_[o].apply(l,arguments);return I(t),l.date||(l.date=n({y:1970})),M(),S(),p(i,t.type),a},I=function(e){e.stopPropagation(),e.preventDefault()},x=function(t){n.lang(l.options.language);var i=e(t.target),o=n(l.date),a=n(i.val(),l.format,l.options.useStrict);a.isValid()&&!F(a)&&N(a)?(m(),l.setValue(a),p(o,t.type),M()):(l.viewDate=o,p(o,t.type),f(a),l.unset=!0)},k=function(e){e&&(l.viewMode=Math.max(l.minViewMode,Math.min(2,l.viewMode+e)));U.modes[l.viewMode].clsName;l.widget.find(".datepicker > div").hide().filter(".datepicker-"+U.modes[l.viewMode].clsName).show()},L=function(){var t,i,n,o,a;l.widget.on("click",".datepicker *",e.proxy(C,this)),l.widget.on("click","[data-action]",e.proxy(w,this)),l.widget.on("mousedown",e.proxy(I,this)),l.options.pickDate&&l.options.pickTime&&l.widget.on("click.togglePicker",".accordion-toggle",function(r){if(r.stopPropagation(),t=e(this),i=t.closest("ul"),n=i.find(".in"),o=i.find(".collapse:not(.in)"),n&&n.length){if((a=n.data("collapse"))&&a.date-transitioning)return;n.collapse("hide"),o.collapse("show"),t.find("span").toggleClass(l.options.icons.time+" "+l.options.icons.date),l.element.find(".input-group-addon span").toggleClass(l.options.icons.time+" "+l.options.icons.date)}}),l.isInput?l.element.on({focus:e.proxy(l.show,this),change:e.proxy(x,this),blur:e.proxy(l.hide,this)}):(l.element.on({change:e.proxy(x,this)},"input"),l.component?l.component.on("click",e.proxy(l.show,this)):l.element.on("click",e.proxy(l.show,this)))},A=function(){e(window).on("resize.datetimepicker"+l.id,e.proxy(u,this)),l.isInput||e(document).on("mousedown.datetimepicker"+l.id,e.proxy(l.hide,this))},T=function(){l.widget.off("click",".datepicker *",l.click),l.widget.off("click","[data-action]"),l.widget.off("mousedown",l.stopEvent),l.options.pickDate&&l.options.pickTime&&l.widget.off("click.togglePicker"),l.isInput?l.element.off({focus:l.show,change:l.change}):(l.element.off({change:l.change},"input"),l.component?l.component.off("click",l.show):l.element.off("click",l.show))},O=function(){e(window).off("resize.datetimepicker"+l.id),l.isInput||e(document).off("mousedown.datetimepicker"+l.id)},D=function(){if(l.element){var t,i=l.element.parents(),n=!1;for(t=0;t<i.length;t++)if("fixed"==e(i[t]).css("position")){n=!0;break}return n}return!1},M=function(){n.lang(l.options.language);var e="";l.unset||(e=n(l.date).format(l.format)),c().val(e),l.element.data("date",e),l.options.pickTime||l.hide()},R=function(e,t,i){n.lang(l.options.language);var o;"add"==e?(23==(o=n(l.date)).hours()&&o.add(i,t),o.add(i,t)):o=n(l.date).subtract(i,t),F(n(o.subtract(i,t)))||F(o)?f(o.format(l.format)):("add"==e?l.date.add(i,t):l.date.subtract(i,t),l.unset=!1)},F=function(e){return n.lang(l.options.language),!(!e.isAfter(l.options.maxDate)&&!e.isBefore(l.options.minDate))||!1!==l.options.disabledDates&&!0===l.options.disabledDates[n(e).format("YYYY-MM-DD")]},N=function(e){return n.lang(l.options.language),!1===l.options.enabledDates||!0===l.options.enabledDates[n(e).format("YYYY-MM-DD")]},P=function(e){var t={},o=0;for(i=0;i<e.length;i++)dDate=n(e[i]),dDate.isValid()&&(t[dDate.format("YYYY-MM-DD")]=!0,o++);return o>0&&t},B=function(e){return e=e.toString(),e.length>=2?e:"0"+e},j=function(){if(l.options.pickDate&&l.options.pickTime){var e="";return e='<div id="fd" class="bootstrap-datetimepicker-widget'+(l.options.sideBySide?" timepicker-sbs":"")+" "+l.options.component+'" style="z-index:9999 !important;">',l.options.sideBySide?e+='<div class="row"><div class="col-sm-6 datepicker">'+U.template+'</div><div class="col-sm-6 timepicker">'+H.getTemplate()+"</div></div>":e+='<ul class="list-unstyled"><li'+(l.options.collapse?' class="collapse in"':"")+'><div class="datepicker">'+U.template+'</div></li><li class="picker-switch accordion-toggle"><a class="btn btn-primary" style="width:100%"><span class="'+l.options.icons.time+'"></span></a></li><li'+(l.options.collapse?' class="collapse"':"")+'><div class="timepicker">'+H.getTemplate()+"</div></li></ul>",e+="</div>"}return l.options.pickTime?'<div id="fd" class="bootstrap-datetimepicker-widget"><div class="timepicker">'+H.getTemplate()+"</div></div>":'<div id="fd" class="bootstrap-datetimepicker-widget"><div class="datepicker">'+U.template+"</div></div>"},U={modes:[{clsName:"days",navFnc:"month",navStep:1},{clsName:"months",navFnc:"year",navStep:1},{clsName:"years",navFnc:"year",navStep:10}],headTemplate:'<thead><tr><th class="prev">&lsaquo;</th><th colspan="5" class="switch"></th><th class="next">&rsaquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>'},H={hourTemplate:'<span data-action="showHours"   data-time-component="hours"   class="timepicker-hour"></span>',minuteTemplate:'<span data-action="showMinutes" data-time-component="minutes" class="timepicker-minute"></span>',secondTemplate:'<span data-action="showSeconds"  data-time-component="seconds" class="timepicker-second"></span>'};U.template='<div class="datepicker-days"><table class="table-condensed">'+U.headTemplate+'<tbody></tbody></table></div><div class="datepicker-months"><table class="table-condensed">'+U.headTemplate+U.contTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+U.headTemplate+U.contTemplate+"</table></div>",H.getTemplate=function(){return'<div class="timepicker-picker"><table class="table-condensed"><tr><td><a href="#" class="btn" data-action="incrementHours"><i class="'+l.options.icons.up+'"></i></a></td><td class="separator"></td><td>'+(l.options.useMinutes?'<a href="#" class="btn" data-action="incrementMinutes"><i class="'+l.options.icons.up+'"></i></a>':"")+"</td>"+(l.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn" data-action="incrementSeconds"><i class="'+l.options.icons.up+'"></i></a></td>':"")+(l.use24hours?"":'<td class="separator"></td>')+"</tr><tr><td>"+H.hourTemplate+'</td> <td class="separator">:</td><td>'+(l.options.useMinutes?H.minuteTemplate:'<span class="timepicker-minute">00</span>')+"</td> "+(l.options.useSeconds?'<td class="separator">:</td><td>'+H.secondTemplate+"</td>":"")+(l.use24hours?"":'<td class="separator"></td><td><button type="button" class="btn btn-primary" data-action="togglePeriod"></button></td>')+'</tr><tr><td><a href="#" class="btn" data-action="decrementHours"><i class="'+l.options.icons.down+'"></i></a></td><td class="separator"></td><td>'+(l.options.useMinutes?'<a href="#" class="btn" data-action="decrementMinutes"><i class="'+l.options.icons.down+'"></i></a>':"")+"</td>"+(l.options.useSeconds?'<td class="separator"></td><td><a href="#" class="btn" data-action="decrementSeconds"><i class="'+l.options.icons.down+'"></i></a></td>':"")+(l.use24hours?"":'<td class="separator"></td>')+'</tr></table></div><div class="timepicker-hours" data-action="selectHour"><table class="table-condensed"></table></div><div class="timepicker-minutes" data-action="selectMinute"><table class="table-condensed"></table></div>'+(l.options.useSeconds?'<div class="timepicker-seconds" data-action="selectSecond"><table class="table-condensed"></table></div>':"")},l.destroy=function(){T(),O(),l.widget.remove(),l.element.removeData("DateTimePicker"),l.component&&l.component.removeData("DateTimePicker")},l.show=function(e){if(l.options.useCurrent&&""==c().val())if(1!==l.options.minuteStepping){var t=n(),i=l.options.minuteStepping;t.minutes(Math.round(t.minutes()/i)*i%60).seconds(0),l.setValue(t.format(l.format))}else l.setValue(n().format(l.format));l.widget.hasClass("picker-open")?(l.widget.hide(),l.widget.removeClass("picker-open")):(l.widget.show(),l.widget.addClass("picker-open")),l.height=l.component?l.component.outerHeight():l.element.outerHeight(),u(),l.element.trigger({type:"dp.show",date:n(l.date)}),A(),e&&I(e)},l.disable=function(){var e=l.element.find("input");e.prop("disabled")||(e.prop("disabled",!0),T())},l.enable=function(){var e=l.element.find("input");e.prop("disabled")&&(e.prop("disabled",!1),L())},l.hide=function(t){if(!t||!e(t.target).is(l.element.attr("id"))){var i,o,a=l.widget.find(".collapse");for(i=0;i<a.length;i++)if((o=a.eq(i).data("collapse"))&&o.date-transitioning)return;l.widget.hide(),l.widget.removeClass("picker-open"),l.viewMode=l.startViewMode,k(),l.element.trigger({type:"dp.hide",date:n(l.date)}),O()}},l.setValue=function(e){n.lang(l.options.language),e?l.unset=!1:(l.unset=!0,M()),n.isMoment(e)||(e=n(e,l.format)),e.isValid()?(l.date=e,M(),l.viewDate=n({y:l.date.year(),M:l.date.month()}),v(),S()):f(e)},l.getDate=function(){return l.unset?null:l.date},l.setDate=function(e){var t=n(l.date);e?l.setValue(e):l.setValue(null),p(t,"function")},l.setDisabledDates=function(e){l.options.disabledDates=P(e),l.viewDate&&m()},l.setEnabledDates=function(e){l.options.enabledDates=P(e),l.viewDate&&m()},l.setMaxDate=function(e){void 0!=e&&(l.options.maxDate=n(e),l.viewDate&&m())},l.setMinDate=function(e){void 0!=e&&(l.options.minDate=n(e),l.viewDate&&m())},function(){var i,u=!1;if(l.options=e.extend({},r,a),l.options.icons=e.extend({},s,l.options.icons),l.element=e(o),d(),!l.options.pickTime&&!l.options.pickDate)throw new Error("Must choose at least one picker");if(l.id=t++,n.lang(l.options.language),l.date=n(),l.unset=!1,l.isInput=l.element.is("input"),l.component=!1,l.element.hasClass("input-group")&&(0==l.element.find(".datepickerbutton").size()?l.component=l.element.find("[class^='input-group-']"):l.component=l.element.find(".datepickerbutton")),l.format=l.options.format,i=n()._lang._longDateFormat,l.format||(l.format=l.options.pickDate?i.L:"",l.options.pickDate&&l.options.pickTime&&(l.format+=" "),l.format+=l.options.pickTime?i.LT:"",l.options.useSeconds&&(~i.LT.indexOf(" A")?l.format=l.format.split(" A")[0]+":ss A":l.format+=":ss")),l.use24hours=l.format.toLowerCase().indexOf("a")<1,l.component&&(u=l.component.find("span")),l.options.pickTime&&u&&u.addClass(l.options.icons.time),l.options.pickDate&&u&&(u.removeClass(l.options.icons.time),u.addClass(l.options.icons.date)),l.widget=e(j()).appendTo("body"),l.options.useSeconds&&!l.use24hours&&l.widget.width(300),l.minViewMode=l.options.minViewMode||0,"string"==typeof l.minViewMode)switch(l.minViewMode){case"months":l.minViewMode=1;break;case"years":l.minViewMode=2;break;default:l.minViewMode=0}if(l.viewMode=l.options.viewMode||0,"string"==typeof l.viewMode)switch(l.viewMode){case"months":l.viewMode=1;break;case"years":l.viewMode=2;break;default:l.viewMode=0}if(l.options.disabledDates=P(l.options.disabledDates),l.options.enabledDates=P(l.options.enabledDates),l.startViewMode=l.viewMode,l.setMinDate(l.options.minDate),l.setMaxDate(l.options.maxDate),h(),g(),y(),E(),b(),m(),k(),L(),""!==l.options.defaultDate&&""==c().val()&&l.setValue(l.options.defaultDate),1!==l.options.minuteStepping){var p=l.options.minuteStepping;l.date.minutes(Math.round(l.date.minutes()/p)*p%60).seconds(0)}}()};e.fn._datetimepicker=function(t){return this.each(function(){var i=e(this);i.data("DateTimePicker")||i.data("DateTimePicker",new o(this,t))})}};n(),t.resolveWith(n)})};FD40.module("datetimepicker",e)}(),function(){var e=function(e){var t=this;e.require().script("ui/position").done(function(){var i=function(){e.fn.popbox=function(i){if(e.isPlainObject(i))return this.each(function(){var n=e(this),o=t.get(n);o?o.update(i):o=new t(n,i)}),this;if(e.isString(i)){var n,o=e(this[0]),a=t.get(o)||new t(o),r=a[i];return e.isFunction(r)&&(n=r.apply(a,e.makeArray(arguments).slice(1))),n||this}return this};var t=function(i,n){var o=this;i.data("popbox",o),e.isString(n)&&(n={content:n}),n||(n={}),i.parentsUntil("body").addBack().each(function(){if("fixed"===e(this).css("position"))return n.fixed=!0,!1});var a={},r=i.attr("data-popbox")||i.find("[data-popbox-content]").html()||e(i.attr("data-popbox-target")).html();r&&(a.content=r),e(["id","component","type","toggle","position","collision"]).each(function(e,t){var n=i.attr("data-popbox-"+t);a[t]=n}),void 0===r&&i.attr("data-popbox",""),o.update(e.extend(!0,{},t.defaultOptions,{tooltip:e(),loader:e('<div id="fd" class="popbox loading" data-popbox-tooltip><div class="arrow"></div></div>'),uid:e.uid(),button:i},a,n))};t.defaultOptions={content:"",id:null,type:"",enabled:!1,wait:!1,locked:!1,exclusive:!1,hideTimer:null,hideDelay:50,toggle:"hover",position:"bottom",collision:"flip",cache:!0,fixed:!1,offset:10},t.get=function(i){var n=e(i).data("popbox");if(n instanceof t)return n},t.toggleEvent=navigator.userAgent.match(/iPhone|iPad|iPod/i)?"touchstart":"click",e.extend(t.prototype,{positions:"top top-left top-right top-center bottom bottom-left bottom-right bottom-center left left-top left-bottom left-center right right-top right-bottom right-center",update:function(t){var i=this;if(e.extend(!0,i,t),e.isModule(i.content))return i.wait=!0,void e.module(i.content).done(function(t){e.isPlainObject(t)&&i.update(t),e.isFunction(t)&&i.update({content:t})}).fail(function(){i.update({content:"Unable to load tooltip content."})}).always(function(){i.wait=!1});e.isString(i.content)&&(i.content=e.Deferred().resolve(i.content));var n=i.position;if(e.isString(n)){var o,a,r,s,l=n.split("-");switch(l[0]){case"top":case"bottom":o=r=l[1]||"center",a="top"==l[0]?"bottom":"top",s="top"==l[0]?"top":"bottom";break;case"left":case"right":a=s=l[1]||"center",o="left"==l[0]?"right":"left",r="left"==l[0]?"left":"right"}i.position={classname:n,my:o+" "+a,at:r+" "+s,using:function(t,n){var o=e(this),a=i.position.classname,r=t.top,s=t.left,c=i.offset,d=i.button.offset();switch(l[0]){case"top":case"bottom":var u=n.vertical;u==l[0]&&(a=a.replace(/top|bottom/gi,"top"==u?"bottom":"top")),r="top"==u?r+c:r-c,"left"==l[1]&&s<Math.floor(d.left)&&(a=a.replace(/left|right/gi,"left"==l[1]?"right":"left"));break;case"left":case"right":var p=n.horizontal;n.horizontal==l[0]&&(a=a.replace(/left|right/gi,"left"==n.horizontal?"right":"left")),s="left"==p?s+c:s-c}o.css({top:r+"px",left:s+"px"}).removeClass(i.positions).addClass(a)}}}e.extend(i.position,{of:i.button,collision:i.collision}),i.loader.attr({id:i.id,"data-popbox-tooltip":i.type,style:i.fixed?"position: fixed":""}).addClass(i.component).addClass("popbox-"+i.type),i.enabled&&i.show()},trigger:function(e,t){this.tooltip.trigger(e,t),this.button.trigger(e,t)},show:function(){var i=this;if(i.enabled=!0,!i.wait){if(clearTimeout(i.hideTimer),i.exclusive&&e("[data-popbox-tooltip]").each(function(){var i=t.get(e(this));i&&i.hide()}),"click"==i.toggle){var n=e(document),o=t.toggleEvent+".popbox."+i.uid;n.off(o).on(o,function(t){var a=e(t.target).parents().andSelf();a.filter(i.button).length>0||a.filter(i.tooltip).length>0||(n.off(o),i.hide())})}var a=e(window),r="resize.popbox"+i.uid;if(a.off(r).on(r,function(){i.tooltip.length>0&&i.tooltip.position(i.position)}),i.tooltip.length>0)return i.tooltip.appendTo("body").position(i.position),void i.trigger("popboxActivate",[i]);if(e.isFunction(i.content)){var s=i.content(i);if(i.update(s),i.wait)return}e.isDeferred(i.content)&&("pending"==i.content.state()&&(i.loader.appendTo("body").position(i.position),i.trigger("popboxLoading",[i])),i.content.always(function(){i.wait=!1}).done(function(t){if(!(i.tooltip.length>0)&&i.enabled){i.loader.detach();var n=e.buildHTML(t);if(n.filter("[data-popbox-tooltip]").length<1){var o=n;(n=e('<div id="fd" class="popbox" data-popbox-tooltip><div class="arrow"></div><div class="popbox-content" data-popbox-content></div></div>').attr({id:i.id,"data-popbox-tooltip":i.type,style:i.fixed?"position: fixed":""}).addClass(i.component).addClass("popbox-"+i.type).appendTo("body")).find("[data-popbox-content]").append(o)}else n=n.appendTo("body").filter("[data-popbox-tooltip]");i.tooltip=n.data("popbox",i).position(i.position),i.trigger("popboxActivate",[i])}}).fail(function(){i.update({content:"Unable to load tooltip content."})}))}},hide:function(t){var i=this;i.enabled=!1,clearTimeout(i.hideTimer),i.loader.detach();var n=function(){i.locked&&!t||(i.tooltip.detach(),e(window).off("resize.popbox"+i.uid),i.trigger("popboxDeactivate",[i]),i.cache||i.destroy())};i.hideTimer=setTimeout(n,i.hideDelay)},destroy:function(){this.button.removeData("popbox")},widget:function(){return this}}),e(document).on(t.toggleEvent+".popbox","[data-popbox]",function(){var t=e(this).popbox("widget");t.enabled?t.hide():t.show()}).on("mouseover.popbox","[data-popbox]",function(){var t=e(this).popbox("widget");"hover"==t.toggle&&t.show()}).on("mouseout.popbox","[data-popbox]",function(){var t=e(this).popbox("widget");"hover"==t.toggle&&t.hide()}).on("mouseover.popbox.tooltip","[data-popbox-tooltip]",function(){var e=t.get(this);e&&"hover"===e.toggle&&(e.locked=!0,clearTimeout(e.hideTimer))}).on("mouseout.popbox.tooltip","[data-popbox-tooltip]",function(){var e=t.get(this);e&&"hover"===e.toggle&&(e.locked=!1,e.hide())}).on("click.popbox.close","[data-popbox-close]",function(){var i=t.get(e(this).parents("[data-popbox-tooltip]"));i&&i.hide()})};i(),t.resolveWith(i)})};FD40.module("popbox",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e,t){function i(e,t,i){return[parseFloat(e[0])*(f.test(e[0])?t/100:1),parseFloat(e[1])*(f.test(e[1])?i/100:1)]}function n(t,i){return parseInt(e.css(t,i),10)||0}function o(t){var i=t[0];return 9===i.nodeType?{width:t.width(),height:t.height(),offset:{top:0,left:0}}:e.isWindow(i)?{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}:i.preventDefault?{width:0,height:0,offset:{top:i.pageY,left:i.pageX}}:{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}}e.ui=e.ui||{};var a,r=Math.max,s=Math.abs,l=Math.round,c=/left|center|right/,d=/top|center|bottom/,u=/[\+\-]\d+(\.[\d]+)?%?/,p=/^\w+/,f=/%$/,m=e.fn.position;e.position={scrollbarWidth:function(){if(void 0!==a)return a;var t,i,n=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),o=n.children()[0];return e("body").append(n),t=o.offsetWidth,n.css("overflow","scroll"),i=o.offsetWidth,t===i&&(i=n[0].clientWidth),n.remove(),a=t-i},getScrollInfo:function(t){var i=t.isWindow?"":t.element.css("overflow-x"),n=t.isWindow?"":t.element.css("overflow-y"),o="scroll"===i||"auto"===i&&t.width<t.element[0].scrollWidth;return{width:"scroll"===n||"auto"===n&&t.height<t.element[0].scrollHeight?e.position.scrollbarWidth():0,height:o?e.position.scrollbarWidth():0}},getWithinInfo:function(t){var i=e(t||window),n=e.isWindow(i[0]);return{element:i,isWindow:n,offset:i.offset()||{left:0,top:0},scrollLeft:i.scrollLeft(),scrollTop:i.scrollTop(),width:n?i.width():i.outerWidth(),height:n?i.height():i.outerHeight()}}},e.fn.position=function(t){if(!t||!t.of)return m.apply(this,arguments);t=e.extend({},t);var a,f,h,g,v,y,E=e(t.of),b=e.position.getWithinInfo(t.within),S=e.position.getScrollInfo(b),C=(t.collision||"flip").split(" "),_={};return y=o(E),E[0].preventDefault&&(t.at="left top"),f=y.width,h=y.height,g=y.offset,v=e.extend({},g),e.each(["my","at"],function(){var e,i,n=(t[this]||"").split(" ");1===n.length&&(n=c.test(n[0])?n.concat(["center"]):d.test(n[0])?["center"].concat(n):["center","center"]),n[0]=c.test(n[0])?n[0]:"center",n[1]=d.test(n[1])?n[1]:"center",e=u.exec(n[0]),i=u.exec(n[1]),_[this]=[e?e[0]:0,i?i[0]:0],t[this]=[p.exec(n[0])[0],p.exec(n[1])[0]]}),1===C.length&&(C[1]=C[0]),"right"===t.at[0]?v.left+=f:"center"===t.at[0]&&(v.left+=f/2),"bottom"===t.at[1]?v.top+=h:"center"===t.at[1]&&(v.top+=h/2),a=i(_.at,f,h),v.left+=a[0],v.top+=a[1],this.each(function(){var o,c,d=e(this),u=d.outerWidth(),p=d.outerHeight(),m=n(this,"marginLeft"),y=n(this,"marginTop"),w=u+m+n(this,"marginRight")+S.width,I=p+y+n(this,"marginBottom")+S.height,x=e.extend({},v),k=i(_.my,d.outerWidth(),d.outerHeight());"right"===t.my[0]?x.left-=u:"center"===t.my[0]&&(x.left-=u/2),"bottom"===t.my[1]?x.top-=p:"center"===t.my[1]&&(x.top-=p/2),x.left+=k[0],x.top+=k[1],e.support.offsetFractions||(x.left=l(x.left),x.top=l(x.top)),o={marginLeft:m,marginTop:y},e.each(["left","top"],function(i,n){e.ui.position[C[i]]&&e.ui.position[C[i]][n](x,{targetWidth:f,targetHeight:h,elemWidth:u,elemHeight:p,collisionPosition:o,collisionWidth:w,collisionHeight:I,offset:[a[0]+k[0],a[1]+k[1]],my:t.my,at:t.at,within:b,elem:d})}),t.using&&(c=function(e){var i=g.left-x.left,n=i+f-u,o=g.top-x.top,a=o+h-p,l={target:{element:E,left:g.left,top:g.top,width:f,height:h},element:{element:d,left:x.left,top:x.top,width:u,height:p},horizontal:n<0?"left":i>0?"right":"center",vertical:a<0?"top":o>0?"bottom":"middle"};f<u&&s(i+n)<f&&(l.horizontal="center"),h<p&&s(o+a)<h&&(l.vertical="middle"),r(s(i),s(n))>r(s(o),s(a))?l.important="horizontal":l.important="vertical",t.using.call(this,e,l)}),d.offset(e.extend(x,{using:c}))})},e.ui.position={fit:{left:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollLeft:n.offset.left,a=n.width,s=e.left-t.collisionPosition.marginLeft,l=o-s,c=s+t.collisionWidth-a-o;t.collisionWidth>a?l>0&&c<=0?(i=e.left+l+t.collisionWidth-a-o,e.left+=l-i):e.left=c>0&&l<=0?o:l>c?o+a-t.collisionWidth:o:l>0?e.left+=l:c>0?e.left-=c:e.left=r(e.left-s,e.left)},top:function(e,t){var i,n=t.within,o=n.isWindow?n.scrollTop:n.offset.top,a=t.within.height,s=e.top-t.collisionPosition.marginTop,l=o-s,c=s+t.collisionHeight-a-o;t.collisionHeight>a?l>0&&c<=0?(i=e.top+l+t.collisionHeight-a-o,e.top+=l-i):e.top=c>0&&l<=0?o:l>c?o+a-t.collisionHeight:o:l>0?e.top+=l:c>0?e.top-=c:e.top=r(e.top-s,e.top)}},flip:{left:function(e,t){var i,n,o=t.within,a=o.offset.left+o.scrollLeft,r=o.width,l=o.isWindow?o.scrollLeft:o.offset.left,c=e.left-t.collisionPosition.marginLeft,d=c-l,u=c+t.collisionWidth-r-l,p="left"===t.my[0]?-t.elemWidth:"right"===t.my[0]?t.elemWidth:0,f="left"===t.at[0]?t.targetWidth:"right"===t.at[0]?-t.targetWidth:0,m=-2*t.offset[0];d<0?((i=e.left+p+f+m+t.collisionWidth-r-a)<0||i<s(d))&&(e.left+=p+f+m):u>0&&((n=e.left-t.collisionPosition.marginLeft+p+f+m-l)>0||s(n)<u)&&(e.left+=p+f+m)},top:function(e,t){var i,n,o=t.within,a=o.offset.top+o.scrollTop,r=o.height,l=o.isWindow?o.scrollTop:o.offset.top,c=e.top-t.collisionPosition.marginTop,d=c-l,u=c+t.collisionHeight-r-l,p="top"===t.my[1]?-t.elemHeight:"bottom"===t.my[1]?t.elemHeight:0,f="top"===t.at[1]?t.targetHeight:"bottom"===t.at[1]?-t.targetHeight:0,m=-2*t.offset[1];d<0?(n=e.top+p+f+m+t.collisionHeight-r-a,e.top+p+f+m>d&&(n<0||n<s(d))&&(e.top+=p+f+m)):u>0&&(i=e.top-t.collisionPosition.marginTop+p+f+m-l,e.top+p+f+m>u&&(i>0||s(i)<u)&&(e.top+=p+f+m))}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments),e.ui.position.fit.left.apply(this,arguments)},top:function(){e.ui.position.flip.top.apply(this,arguments),e.ui.position.fit.top.apply(this,arguments)}}},function(){var t,i,n,o,a,r=document.getElementsByTagName("body")[0],s=document.createElement("div");t=document.createElement(r?"div":"body"),n={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},r&&e.extend(n,{position:"absolute",left:"-1000px",top:"-1000px"});for(a in n)t.style[a]=n[a];t.appendChild(s),(i=r||document.documentElement).insertBefore(t,i.firstChild),s.style.cssText="position: absolute; left: 10.7432222px;",o=e(s).offset().left,e.support.offsetFractions=o>10&&o<11,t.innerHTML="",i.removeChild(t)}()}(i)};n(),t.resolveWith(n)};FD40.module("ui/position",e)}(),function(){var e=function(e){var t=this,i=e.callback(function(){window.google||window.google.maps||t.reject("Google Maps API is required. Please register the following JavaScript library http://maps.google.com/maps/api/js?sensor=true.");var i=function(t){"use strict";var i=document,n=function(t,i){return e("#"+t.replace("#",""),i)[0]},l=function(e){var t=this,c=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","idle","maptypeid_changed","projection_changed","resize","tilesloaded","zoom_changed"],d=["mousemove","mouseout","mouseover"];if(window.context_menu={},"string"==typeof e.el||"string"==typeof e.div?this.el=n(e.el||e.div,e.context):this.el=e.el||e.div,void 0===this.el||null===this.el)throw"No element defined.";this.el.style.width=e.width||this.el.scrollWidth||this.el.offsetWidth,this.el.style.height=e.height||this.el.scrollHeight||this.el.offsetHeight,this.controls=[],this.overlays=[],this.layers=[],this.singleLayers={},this.markers=[],this.polylines=[],this.routes=[],this.polygons=[],this.infoWindow=null,this.overlay_el=null,this.zoom=e.zoom||15,this.registered_events={};var u,p=e.markerClusterer;u=e.mapType?google.maps.MapTypeId[e.mapType.toUpperCase()]:google.maps.MapTypeId.ROADMAP;var f=new google.maps.LatLng(e.lat,e.lng);delete e.el,delete e.lat,delete e.lng,delete e.mapType,delete e.width,delete e.height,delete e.markerClusterer;var m=e.zoomControlOpt||{style:"DEFAULT",position:"TOP_LEFT"},h=e.zoomControl||!0,g=m.style||"DEFAULT",v=m.position||"TOP_LEFT",y=e.panControl||!0,E=e.mapTypeControl||!0,b=e.scaleControl||!0,S=e.streetViewControl||!0,C=C||!0,_={},w={zoom:this.zoom,center:f,mapTypeId:u},I={panControl:y,zoomControl:h,zoomControlOptions:{style:google.maps.ZoomControlStyle[g],position:google.maps.ControlPosition[v]},mapTypeControl:E,scaleControl:b,streetViewControl:S,overviewMapControl:C};1!=e.disableDefaultUI&&(w=a(w,I)),_=a(w,e);for(R=0;R<c.length;R++)delete _[c[R]];for(R=0;R<d.length;R++)delete _[d[R]];this.map=new google.maps.Map(this.el,_),p&&(this.markerClusterer=p.apply(this,[this.map]));var x=function(e){var t=0,i=0;if(e.offsetParent)do{t+=e.offsetLeft,i+=e.offsetTop}while(e=e.offsetParent);return[t,i]},k=function(e,i){var o="",a=window.context_menu[e];for(var r in a)if(a.hasOwnProperty(r)){var s=a[r];o+='<li><a id="'+e+"_"+r+'" href="#">'+s.title+"</a></li>"}if(n("gmaps_context_menu")){var l=n("gmaps_context_menu");l.innerHTML=o;for(var c=l.getElementsByTagName("a"),d=c.length,r=0;r<d;r++){var u=c[r],p=function(n){n.preventDefault(),a[this.id.replace(e+"_","")].action.apply(t,[i]),t.hideContextMenu()};google.maps.event.clearListeners(u,"click"),google.maps.event.addDomListenerOnce(u,"click",p,!1)}var f=x.apply(this,[t.el]),m=f[0]+i.pixel.x-15,h=f[1]+i.pixel.y-15;l.style.left=m+"px",l.style.top=h+"px",l.style.display="block"}},L=function(e,i){if("marker"===e){i.pixel={};var n=new google.maps.OverlayView;n.setMap(t.map),n.draw=function(){var t=n.getProjection(),o=i.marker.getPosition();i.pixel=t.fromLatLngToContainerPixel(o),k(e,i)}}else k(e,i)};this.setContextMenu=function(e){window.context_menu[e.control]={};for(var t in e.options)if(e.options.hasOwnProperty(t)){var o=e.options[t];window.context_menu[e.control][o.name]={title:o.title,action:o.action}}var a=i.createElement("ul");a.id="gmaps_context_menu",a.style.display="none",a.style.position="absolute",a.style.minWidth="100px",a.style.background="white",a.style.listStyle="none",a.style.padding="8px",a.style.boxShadow="2px 2px 6px #ccc",i.body.appendChild(a);var r=n("gmaps_context_menu");google.maps.event.addDomListener(r,"mouseout",function(e){e.relatedTarget&&this.contains(e.relatedTarget)||window.setTimeout(function(){r.style.display="none"},400)},!1)},this.hideContextMenu=function(){var e=n("gmaps_context_menu");e&&(e.style.display="none")};for(var A=function(i,n){google.maps.event.addListener(i,n,function(i){void 0==i&&(i=this),e[n].apply(this,[i]),t.hideContextMenu()})},T=0;T<c.length;T++)(O=c[T])in e&&A(this.map,O);for(T=0;T<d.length;T++){var O=d[T];O in e&&A(this.map,O)}google.maps.event.addListener(this.map,"rightclick",function(t){e.rightclick&&e.rightclick.apply(this,[t]),void 0!=window.context_menu.map&&L("map",t)}),this.refresh=function(){google.maps.event.trigger(this.map,"resize")},this.fitZoom=function(){for(var e=[],t=this.markers.length,i=0;i<t;i++)e.push(this.markers[i].getPosition());this.fitLatLngBounds(e)},this.fitLatLngBounds=function(e){for(var t=e.length,i=new google.maps.LatLngBounds,n=0;n<t;n++)i.extend(e[n]);this.map.fitBounds(i)},this.setCenter=function(e,t,i){this.map.panTo(new google.maps.LatLng(e,t)),i&&i()},this.getElement=function(){return this.el},this.zoomIn=function(e){e=e||1,this.zoom=this.map.getZoom()+e,this.map.setZoom(this.zoom)},this.zoomOut=function(e){e=e||1,this.zoom=this.map.getZoom()-e,this.map.setZoom(this.zoom)};var D=[];for(var M in this.map)"function"!=typeof this.map[M]||this[M]||D.push(M);for(var R=0;R<D.length;R++)!function(e,t,i){e[i]=function(){return t[i].apply(t,arguments)}}(this,this.map,D[R]);this.createControl=function(e){var t=i.createElement("div");t.style.cursor="pointer",t.style.fontFamily="Arial, sans-serif",t.style.fontSize="13px",t.style.boxShadow="rgba(0, 0, 0, 0.398438) 0px 2px 4px";for(var n in e.style)t.style[n]=e.style[n];e.id&&(t.id=e.id),e.classes&&(t.className=e.classes),e.content&&(t.innerHTML=e.content);for(var o in e.events)!function(t,i){google.maps.event.addDomListener(t,i,function(){e.events[i].apply(this,[this])})}(t,o);return t.index=1,t},this.addControl=function(e){var t=google.maps.ControlPosition[e.position.toUpperCase()];delete e.position;var i=this.createControl(e);return this.controls.push(i),this.map.controls[t].push(i),i},this.createMarker=function(e){if(e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")||e.position){var t=this,i=e.details,n=e.fences,o=e.outside,r={position:new google.maps.LatLng(e.lat,e.lng),map:null};delete e.lat,delete e.lng,delete e.fences,delete e.outside;var s=a(r,e),l=new google.maps.Marker(s);if(l.fences=n,e.infoWindow){l.infoWindow=new google.maps.InfoWindow(e.infoWindow);for(var c=["closeclick","content_changed","domready","position_changed","zindex_changed"],d=0;d<c.length;d++)!function(t,i){e.infoWindow[i]&&google.maps.event.addListener(t,i,function(t){e.infoWindow[i].apply(this,[t])})}(l.infoWindow,c[d])}for(var u=["animation_changed","clickable_changed","cursor_changed","draggable_changed","flat_changed","icon_changed","position_changed","shadow_changed","shape_changed","title_changed","visible_changed","zindex_changed"],p=["dblclick","drag","dragend","dragstart","mousedown","mouseout","mouseover","mouseup"],d=0;d<u.length;d++)!function(t,i){e[i]&&google.maps.event.addListener(t,i,function(){e[i].apply(this,[this])})}(l,u[d]);for(d=0;d<p.length;d++)!function(t,i,n){e[n]&&google.maps.event.addListener(i,n,function(i){i.pixel||(i.pixel=t.getProjection().fromLatLngToPoint(i.latLng)),e[n].apply(this,[i])})}(this.map,l,p[d]);return google.maps.event.addListener(l,"click",function(){this.details=i,e.click&&e.click.apply(this,[this]),l.infoWindow&&(t.hideInfoWindows(),l.infoWindow.open(t.map,l))}),google.maps.event.addListener(l,"rightclick",function(t){t.marker=this,e.rightclick&&e.rightclick.apply(this,[t]),void 0!=window.context_menu.marker&&L("marker",t)}),l.fences&&google.maps.event.addListener(l,"dragend",function(){t.checkMarkerGeofence(l,function(e,t){o(e,t)})}),l}throw"No latitude or longitude defined."},this.addMarker=function(e){var t;if(e.hasOwnProperty("gm_accessors_"))t=e;else{if(!(e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")||e.position))throw"No latitude or longitude defined.";t=this.createMarker(e)}return t.setMap(this.map),this.markerClusterer&&this.markerClusterer.addMarker(t),this.markers.push(t),l.fire("marker_added",t,this),t},this.addMarkers=function(e){for(var t,i=0;t=e[i];i++)this.addMarker(t);return this.markers},this.hideInfoWindows=function(){for(var e,t=0;e=this.markers[t];t++)e.infoWindow&&e.infoWindow.close()},this.removeMarker=function(e){for(var t=0;t<this.markers.length;t++)if(this.markers[t]===e){this.markers[t].setMap(null),this.markers.splice(t,1),l.fire("marker_removed",e,this);break}return e},this.removeMarkers=function(e){for(var e=e||this.markers,t=0;t<this.markers.length;t++)this.markers[t]===e[t]&&this.markers[t].setMap(null);for(var i=[],t=0;t<this.markers.length;t++)null!=this.markers[t].getMap()&&i.push(this.markers[t]);this.markers=i},this.drawOverlay=function(e){var n=new google.maps.OverlayView;n.setMap(t.map);var o=!0;return null!=e.auto_show&&(o=e.auto_show),n.onAdd=function(){var t=i.createElement("div");t.style.borderStyle="none",t.style.borderWidth="0px",t.style.position="absolute",t.style.zIndex=100,t.innerHTML=e.content,n.el=t;var o=this.getPanes();e.layer||(e.layer="overlayLayer"),o[e.layer].appendChild(t);for(var a=["contextmenu","DOMMouseScroll","dblclick","mousedown"],r=0;r<a.length;r++)!function(e,t){google.maps.event.addDomListener(e,t,function(e){-1!=navigator.userAgent.toLowerCase().indexOf("msie")&&document.all?(e.cancelBubble=!0,e.returnValue=!1):e.stopPropagation()})}(t,a[r]);google.maps.event.trigger(this,"ready")},n.draw=function(){var t=this.getProjection().fromLatLngToDivPixel(new google.maps.LatLng(e.lat,e.lng));e.horizontalOffset=e.horizontalOffset||0,e.verticalOffset=e.verticalOffset||0;var i=n.el,a=i.children[0],r=a.clientHeight,s=a.clientWidth;switch(e.verticalAlign){case"top":i.style.top=t.y-r+e.verticalOffset+"px";break;default:case"middle":i.style.top=t.y-r/2+e.verticalOffset+"px";break;case"bottom":i.style.top=t.y+e.verticalOffset+"px"}switch(e.horizontalAlign){case"left":i.style.left=t.x-s+e.horizontalOffset+"px";break;default:case"center":i.style.left=t.x-s/2+e.horizontalOffset+"px";break;case"right":i.style.left=t.x+e.horizontalOffset+"px"}i.style.display=o?"block":"none",o||e.show.apply(this,[i])},n.onRemove=function(){var t=n.el;e.remove?e.remove.apply(this,[t]):(n.el.parentNode.removeChild(n.el),n.el=null)},t.overlays.push(n),n},this.removeOverlay=function(e){for(var t=0;t<this.overlays.length;t++)if(this.overlays[t]===e){this.overlays[t].setMap(null),this.overlays.splice(t,1);break}},this.removeOverlays=function(){for(var e,i=0;e=t.overlays[i];i++)e.setMap(null);t.overlays=[]},this.drawPolyline=function(e){var t=[],i=e.path;if(i.length)if(void 0===i[0][0])t=i;else for(var n,o=0;n=i[o];o++)t.push(new google.maps.LatLng(n[0],n[1]));var a={map:this.map,path:t,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight,geodesic:e.geodesic,clickable:!0,editable:!1,visible:!0};e.hasOwnProperty("clickable")&&(a.clickable=e.clickable),e.hasOwnProperty("editable")&&(a.editable=e.editable),e.hasOwnProperty("icons")&&(a.icons=e.icons),e.hasOwnProperty("zIndex")&&(a.zIndex=e.zIndex);for(var r=new google.maps.Polyline(a),s=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],c=0;c<s.length;c++)!function(t,i){e[i]&&google.maps.event.addListener(t,i,function(t){e[i].apply(this,[t])})}(r,s[c]);return this.polylines.push(r),l.fire("polyline_added",r,this),r},this.removePolyline=function(e){for(var t=0;t<this.polylines.length;t++)if(this.polylines[t]===e){this.polylines[t].setMap(null),this.polylines.splice(t,1),l.fire("polyline_removed",e,this);break}},this.removePolylines=function(){for(var e,i=0;e=t.polylines[i];i++)e.setMap(null);t.polylines=[]},this.drawCircle=function(e){delete(e=a({map:this.map,center:new google.maps.LatLng(e.lat,e.lng)},e)).lat,delete e.lng;for(var t=new google.maps.Circle(e),i=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],n=0;n<i.length;n++)!function(t,i){e[i]&&google.maps.event.addListener(t,i,function(t){e[i].apply(this,[t])})}(t,i[n]);return this.polygons.push(t),t},this.drawRectangle=function(e){e=a({map:this.map},e);var t=new google.maps.LatLngBounds(new google.maps.LatLng(e.bounds[0][0],e.bounds[0][1]),new google.maps.LatLng(e.bounds[1][0],e.bounds[1][1]));e.bounds=t;for(var i=new google.maps.Rectangle(e),n=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],o=0;o<n.length;o++)!function(t,i){e[i]&&google.maps.event.addListener(t,i,function(t){e[i].apply(this,[t])})}(i,n[o]);return this.polygons.push(i),i},this.drawPolygon=function(e){var t=!1;e.hasOwnProperty("useGeoJSON")&&(t=e.useGeoJSON),delete e.useGeoJSON,e=a({map:this.map},e),0==t&&(e.paths=[e.paths.slice(0)]),e.paths.length>0&&e.paths[0].length>0&&(e.paths=s(r(e.paths,o,t)));for(var i=new google.maps.Polygon(e),n=["click","dblclick","mousedown","mousemove","mouseout","mouseover","mouseup","rightclick"],c=0;c<n.length;c++)!function(t,i){e[i]&&google.maps.event.addListener(t,i,function(t){e[i].apply(this,[t])})}(i,n[c]);return this.polygons.push(i),l.fire("polygon_added",i,this),i},this.removePolygon=function(e){for(var t=0;t<this.polygons.length;t++)if(this.polygons[t]===e){this.polygons[t].setMap(null),this.polygons.splice(t,1),l.fire("polygon_removed",e,this);break}},this.removePolygons=function(){for(var e,i=0;e=t.polygons[i];i++)e.setMap(null);t.polygons=[]},this.getFromFusionTables=function(e){var t=e.events;delete e.events;var i=e,n=new google.maps.FusionTablesLayer(i);for(var o in t)!function(e,i){google.maps.event.addListener(e,i,function(e){t[i].apply(this,[e])})}(n,o);return this.layers.push(n),n},this.loadFromFusionTables=function(e){var t=this.getFromFusionTables(e);return t.setMap(this.map),t},this.getFromKML=function(e){var t=e.url,i=e.events;delete e.url,delete e.events;var n=e,o=new google.maps.KmlLayer(t,n);for(var a in i)!function(e,t){google.maps.event.addListener(e,t,function(e){i[t].apply(this,[e])})}(o,a);return this.layers.push(o),o},this.loadFromKML=function(e){var t=this.getFromKML(e);return t.setMap(this.map),t};var F,N;this.getRoutes=function(e){switch(e.travelMode){case"bicycling":F=google.maps.TravelMode.BICYCLING;break;case"transit":F=google.maps.TravelMode.TRANSIT;break;case"driving":F=google.maps.TravelMode.DRIVING;break;default:F=google.maps.TravelMode.WALKING}N="imperial"===e.unitSystem?google.maps.UnitSystem.IMPERIAL:google.maps.UnitSystem.METRIC;var t=a({avoidHighways:!1,avoidTolls:!1,optimizeWaypoints:!1,waypoints:[]},e);t.origin=/string/.test(typeof e.origin)?e.origin:new google.maps.LatLng(e.origin[0],e.origin[1]),t.destination=new google.maps.LatLng(e.destination[0],e.destination[1]),t.travelMode=F,t.unitSystem=N,delete t.callback;var i=this;(new google.maps.DirectionsService).route(t,function(t,n){if(n===google.maps.DirectionsStatus.OK)for(var o in t.routes)t.routes.hasOwnProperty(o)&&i.routes.push(t.routes[o]);e.callback&&e.callback(i.routes)})},this.removeRoutes=function(){this.routes=[]},this.getElevations=function(e){(e=a({locations:[],path:!1,samples:256},e)).locations.length>0&&e.locations[0].length>0&&(e.locations=s(r([e.locations],o,!1)));var t=e.callback;delete e.callback;var i=new google.maps.ElevationService;if(e.path){var n={path:e.locations,samples:e.samples};i.getElevationAlongPath(n,function(e,i){t&&"function"==typeof t&&t(e,i)})}else delete e.path,delete e.samples,i.getElevationForLocations(e,function(e,i){t&&"function"==typeof t&&t(e,i)})},this.cleanRoute=this.removePolylines,this.drawRoute=function(e){var t=this;this.getRoutes({origin:e.origin,destination:e.destination,travelMode:e.travelMode,waypoints:e.waypoints,unitSystem:e.unitSystem,callback:function(i){i.length>0&&(t.drawPolyline({path:i[i.length-1].overview_path,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight}),e.callback&&e.callback(i[i.length-1]))}})},this.travelRoute=function(e){if(e.origin&&e.destination)this.getRoutes({origin:e.origin,destination:e.destination,travelMode:e.travelMode,waypoints:e.waypoints,callback:function(t){if(t.length>0&&e.start&&e.start(t[t.length-1]),t.length>0&&e.step){var i=t[t.length-1];if(i.legs.length>0)for(var n,o=i.legs[0].steps,a=0;n=o[a];a++)n.step_number=a,e.step(n,i.legs[0].steps.length-1)}t.length>0&&e.end&&e.end(t[t.length-1])}});else if(e.route&&e.route.legs.length>0)for(var t,i=e.route.legs[0].steps,n=0;t=i[n];n++)t.step_number=n,e.step(t)},this.drawSteppedRoute=function(e){if(e.origin&&e.destination)this.getRoutes({origin:e.origin,destination:e.destination,travelMode:e.travelMode,waypoints:e.waypoints,callback:function(i){if(i.length>0&&e.start&&e.start(i[i.length-1]),i.length>0&&e.step){var n=i[i.length-1];if(n.legs.length>0)for(var o,a=n.legs[0].steps,r=0;o=a[r];r++)o.step_number=r,t.drawPolyline({path:o.path,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight}),e.step(o,n.legs[0].steps.length-1)}i.length>0&&e.end&&e.end(i[i.length-1])}});else if(e.route&&e.route.legs.length>0)for(var i,n=e.route.legs[0].steps,o=0;i=n[o];o++)i.step_number=o,t.drawPolyline({path:i.path,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight}),e.step(i)},this.checkGeofence=function(e,t,i){return i.containsLatLng(new google.maps.LatLng(e,t))},this.checkMarkerGeofence=function(e,i){if(e.fences)for(var n,o=0;n=e.fences[o];o++){var a=e.getPosition();t.checkGeofence(a.lat(),a.lng(),n)||i(e,n)}},this.addLayer=function(e,t){t=t||{};var i;switch(e){case"weather":this.singleLayers.weather=i=new google.maps.weather.WeatherLayer;break;case"clouds":this.singleLayers.clouds=i=new google.maps.weather.CloudLayer;break;case"traffic":this.singleLayers.traffic=i=new google.maps.TrafficLayer;break;case"transit":this.singleLayers.transit=i=new google.maps.TransitLayer;break;case"bicycling":this.singleLayers.bicycling=i=new google.maps.BicyclingLayer;break;case"panoramio":this.singleLayers.panoramio=i=new google.maps.panoramio.PanoramioLayer,i.setTag(t.filter),delete t.filter,t.click&&google.maps.event.addListener(i,"click",function(e){t.click(e),delete t.click});break;case"places":if(this.singleLayers.places=i=new google.maps.places.PlacesService(this.map),t.search||t.nearbySearch){var n={bounds:t.bounds||null,keyword:t.keyword||null,location:t.location||null,name:t.name||null,radius:t.radius||null,rankBy:t.rankBy||null,types:t.types||null};t.search&&i.search(n,t.search),t.nearbySearch&&i.nearbySearch(n,t.nearbySearch)}if(t.textSearch){var o={bounds:t.bounds||null,location:t.location||null,query:t.query||null,radius:t.radius||null};i.textSearch(o,t.textSearch)}}if(void 0!==i)return"function"==typeof i.setOptions&&i.setOptions(t),"function"==typeof i.setMap&&i.setMap(this.map),i},this.removeLayer=function(e){void 0!==this.singleLayers[e]&&(this.singleLayers[e].setMap(null),delete this.singleLayers[e])},this.toImage=function(e){var e=e||{},t={};if(t.size=e.size||[this.el.clientWidth,this.el.clientHeight],t.lat=this.getCenter().lat(),t.lng=this.getCenter().lng(),this.markers.length>0){t.markers=[];for(var i=0;i<this.markers.length;i++)t.markers.push({lat:this.markers[i].getPosition().lat(),lng:this.markers[i].getPosition().lng()})}if(this.polylines.length>0){var n=this.polylines[0];t.polyline={},t.polyline.path=google.maps.geometry.encoding.encodePath(n.getPath()),t.polyline.strokeColor=n.strokeColor,t.polyline.strokeOpacity=n.strokeOpacity,t.polyline.strokeWeight=n.strokeWeight}return l.staticMapURL(t)},this.addMapType=function(e,t){if(!t.hasOwnProperty("getTileUrl")||"function"!=typeof t.getTileUrl)throw"'getTileUrl' function required.";t.tileSize=t.tileSize||new google.maps.Size(256,256);var i=new google.maps.ImageMapType(t);this.map.mapTypes.set(e,i)},this.addOverlayMapType=function(e){if(!e.hasOwnProperty("getTile")||"function"!=typeof e.getTile)throw"'getTile' function required.";var t=e.index;delete e.index,this.map.overlayMapTypes.insertAt(t,e)},this.removeOverlayMapType=function(e){this.map.overlayMapTypes.removeAt(e)},this.addStyle=function(e){var t=new google.maps.StyledMapType(e.styles,e.styledMapName);this.map.mapTypes.set(e.mapTypeId,t)},this.setStyle=function(e){this.map.setMapTypeId(e)},this.createPanorama=function(e){return e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")||(e.lat=this.getCenter().lat(),e.lng=this.getCenter().lng()),this.panorama=l.createPanorama(e),this.map.setStreetView(this.panorama),this.panorama},this.on=function(e,t){return l.on(e,this,t)},this.off=function(e){l.off(e,this)}};return l.createPanorama=function(e){var t=n(e.el,e.context);e.position=new google.maps.LatLng(e.lat,e.lng),delete e.el,delete e.context,delete e.lat,delete e.lng;for(var i=["closeclick","links_changed","pano_changed","position_changed","pov_changed","resize","visible_changed"],o=a({visible:!0},e),r=0;r<i.length;r++)delete o[i[r]];for(var s=new google.maps.StreetViewPanorama(t,o),r=0;r<i.length;r++)!function(t,i){e[i]&&google.maps.event.addListener(t,i,function(){e[i].apply(this)})}(s,i[r]);return s},l.Route=function(e){this.map=e.map,this.route=e.route,this.step_count=0,this.steps=this.route.legs[0].steps,this.steps_length=this.steps.length,this.polyline=this.map.drawPolyline({path:new google.maps.MVCArray,strokeColor:e.strokeColor,strokeOpacity:e.strokeOpacity,strokeWeight:e.strokeWeight}).getPath(),this.back=function(){if(this.step_count>0){this.step_count--;var e=this.route.legs[0].steps[this.step_count].path;for(var t in e)e.hasOwnProperty(t)&&this.polyline.pop()}},this.forward=function(){if(this.step_count<this.steps_length){var e=this.route.legs[0].steps[this.step_count].path;for(var t in e)e.hasOwnProperty(t)&&this.polyline.push(e[t]);this.step_count++}}},l.geolocate=function(e){var t=e.always||e.complete;navigator.geolocation?navigator.geolocation.getCurrentPosition(function(i){e.success(i),t&&t()},function(i){e.error(i),t&&t()},e.options):(e.not_supported(),t&&t())},l.geocode=function(e){this.geocoder=new google.maps.Geocoder;var t=e.callback;e.hasOwnProperty("lat")&&e.hasOwnProperty("lng")&&(e.latLng=new google.maps.LatLng(e.lat,e.lng)),delete e.lat,delete e.lng,delete e.callback,this.geocoder.geocode(e,function(e,i){t(e,i)})},l.staticMapURL=function(e){function t(e,t){if("#"===e[0]&&(e=e.replace("#","0x"),t)){if(t=parseFloat(t),0===(t=Math.min(1,Math.max(t,0))))return"0x00000000";1===(t=(255*t).toString(16)).length&&(t+=t),e=e.slice(0,8)+t}return e}var i,n=[],o="http://maps.googleapis.com/maps/api/staticmap";e.url&&(o=e.url,delete e.url),o+="?";var a=e.markers;delete e.markers,!a&&e.marker&&(a=[e.marker],delete e.marker);var r=e.polyline;if(delete e.polyline,e.center)n.push("center="+e.center),delete e.center;else if(e.address)n.push("center="+e.address),delete e.address;else if(e.lat)n.push(["center=",e.lat,",",e.lng].join("")),delete e.lat,delete e.lng;else if(e.visible){var s=encodeURI(e.visible.join("|"));n.push("visible="+s)}var l=e.size;l?(l.join&&(l=l.join("x")),delete e.size):l="630x300",n.push("size="+l),e.zoom||(e.zoom=15);var c=!e.hasOwnProperty("sensor")||!!e.sensor;delete e.sensor,n.push("sensor="+c);for(var d in e)e.hasOwnProperty(d)&&n.push(d+"="+e[d]);if(a)for(var u,p,f=0;i=a[f];f++)u=[],i.size&&"normal"!==i.size?u.push("size:"+i.size):i.icon&&u.push("icon:"+encodeURI(i.icon)),i.color&&u.push("color:"+i.color.replace("#","0x")),i.label&&u.push("label:"+i.label[0].toUpperCase()),p=i.address?i.address:i.lat+","+i.lng,u.length||0===f?(u.push(p),u=u.join("|"),n.push("markers="+encodeURI(u))):(u=n.pop()+encodeURI("|"+p),n.push(u));if(r){if(i=r,r=[],i.strokeWeight&&r.push("weight:"+parseInt(i.strokeWeight,10)),i.strokeColor){var m=t(i.strokeColor,i.strokeOpacity);r.push("color:"+m)}if(i.fillColor){var h=t(i.fillColor,i.fillOpacity);r.push("fillcolor:"+h)}var g=i.path;if(g.join)for(var v,y=0;v=g[y];y++)r.push(v.join(","));else r.push("enc:"+g);r=r.join("|"),n.push("path="+encodeURI(r))}return n=n.join("&"),o+n},l.custom_events=["marker_added","marker_removed","polyline_added","polyline_removed","polygon_added","polygon_removed","geolocated","geolocation_failed"],l.on=function(e,t,i){if(-1==l.custom_events.indexOf(e))return google.maps.event.addListener(t,e,i);var n={handler:i,eventName:e};return t.registered_events[e]=t.registered_events[e]||[],t.registered_events[e].push(n),n},l.off=function(e,t){-1==l.custom_events.indexOf(e)?google.maps.event.clearListeners(t,e):t.registered_events[e]=[]},l.fire=function(e,t,i){if(-1==l.custom_events.indexOf(e))google.maps.event.trigger(t,e,Array.prototype.slice.apply(arguments).slice(2));else if(e in i.registered_events)for(var n=i.registered_events[e],o=0;o<n.length;o++)!function(e,t,i){e.apply(t,[i])}(n[o].handler,i,t)},google.maps.Polygon.prototype.getBounds||(google.maps.Polygon.prototype.getBounds=function(e){for(var t,i=new google.maps.LatLngBounds,n=this.getPaths(),o=0;o<n.getLength();o++){t=n.getAt(o);for(var a=0;a<t.getLength();a++)i.extend(t.getAt(a))}return i}),google.maps.Polygon.prototype.containsLatLng||(google.maps.Polygon.prototype.containsLatLng=function(e){var t=this.getBounds();if(null!==t&&!t.contains(e))return!1;for(var i=!1,n=this.getPaths().getLength(),o=0;o<n;o++)for(var a=this.getPaths().getAt(o),r=a.getLength(),s=r-1,l=0;l<r;l++){var c=a.getAt(l),d=a.getAt(s);(c.lng()<e.lng()&&d.lng()>=e.lng()||d.lng()<e.lng()&&c.lng()>=e.lng())&&c.lat()+(e.lng()-c.lng())/(d.lng()-c.lng())*(d.lat()-c.lat())<e.lat()&&(i=!i),s=l}return i}),google.maps.LatLngBounds.prototype.containsLatLng=function(e){return this.contains(e)},google.maps.Marker.prototype.setFences=function(e){this.fences=e},google.maps.Marker.prototype.addFence=function(e){this.fences.push(e)},l}(),n=function(e,t){var i=e[0],n=e[1];return t&&(i=e[1],n=e[0]),new google.maps.LatLng(i,n)},o=function(e,t){for(var i=0;i<e.length;i++)e[i].length>0&&"number"!=typeof e[i][0]?e[i]=o(e[i],t):e[i]=n(e[i],t);return e},a=function(e,t){if(e===t)return e;for(var i in t)e[i]=t[i];return e},r=function(e,t){var i=Array.prototype.slice.call(arguments,2);if(Array.prototype.map&&e.map===Array.prototype.map)return Array.prototype.map.call(e,function(e){return callback_params=i,callback_params.splice(0,0,e),t.apply(this,callback_params)});for(var n=[],o=e.length,a=0;a<o;a++)callback_params=i,callback_params=callback_params.splice(0,0,e[a]),n.push(t.apply(this,callback_params));return n},s=function(e){new_array=[];for(var t=0;t<e.length;t++)new_array=new_array.concat(e[t]);return new_array};e.GMaps=i,e.GMaps.mapEvents=["bounds_changed","center_changed","click","dblclick","drag","dragend","dragstart","heading_changed","idle","maptypeid_changed","mousemove","mouseout","mouseover","projection_changed","resize","rightclick","tilesloaded","tilt_changed","zoom_changed"],e.fn.gmaps=function(t){if(!(this.length<1)){var n=e(this[0]),o=n.data("gmaps"),a=void 0===o,r=void 0===t;if(e.isString(t)&&(t={address:t}),a){var s=e.uid("gmaps-"),l={lat:0,lng:0};return e.isPlainObject(t)&&(t=e.extend({},l,t)),n.attr("id",s),t.div="#"+s,e.each(e.GMaps.mapEvents,function(i,a){var r=e.isFunction(t[a])?t[a]:e.noop;t[a]=function(){var t=e.makeArray(arguments);r.apply(o,arguments),n.trigger.apply(n,["map_"+a].concat(t))}}),o=new i(t),n.data("gmaps",o),o.go=function(e,t){o.setCenter(e,t),o.addMarker({lat:e,lng:t})},r&&i.geolocate({success:function(e){o.go(e.coords.latitude,e.coords.longitude)}}),o}var c=t.lat,d=t.lng;return(e.isNumber(c)||e.isNumber(d))&&o.go(c,d),o}},t.resolveWith(i)}),n=e('meta[name="foundry:location:language"]').attr("content")||"en";window.google&&window.google.maps?window[i]():e.require().script(e.uri(window.location).protocol()+"://maps.google.com/maps/api/js?sensor=true&callback="+i+"&language="+n).done()};FD40.module("gmaps",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e,t,i){function n(e){var t={},n=/^jQuery\d+$/;return i.each(e.attributes,function(e,i){i.specified&&!n.test(i.name)&&(t[i.name]=i.value)}),t}function o(e,n){var o=this,a=i(o);if(o.value==a.attr("placeholder")&&a.hasClass("placeholder"))if(a.data("placeholder-password")){if(a=a.hide().next().show().attr("id",a.removeAttr("id").data("placeholder-id")),!0===e)return a[0].value=n;a.focus()}else o.value="",a.removeClass("placeholder"),o==t.activeElement&&o.select()}function a(){var e,t=this,a=i(t),r=this.id;if(""==t.value){if("password"==t.type){if(!a.data("placeholder-textinput")){try{e=a.clone().attr({type:"text"})}catch(t){e=i("<input>").attr(i.extend(n(this),{type:"text"}))}e.removeAttr("name").data({"placeholder-password":!0,"placeholder-id":r}).bind("focus.placeholder",o),a.data({"placeholder-textinput":e,"placeholder-id":r}).before(e)}a=a.removeAttr("id").hide().prev().attr("id",r).show()}a.addClass("placeholder"),a[0].value=a.attr("placeholder")}else a.removeClass("placeholder")}var r,s,l="placeholder"in t.createElement("input"),c="placeholder"in t.createElement("textarea"),d=i.fn,u=i.valHooks;l&&c?(s=d.placeholder=function(){return this}).input=s.textarea=!0:((s=d.placeholder=function(){var e=this;return e.filter((l?"textarea":":input")+"[placeholder]").not(".placeholder").bind({"focus.placeholder":o,"blur.placeholder":a}).data("placeholder-enabled",!0).trigger("blur.placeholder"),e}).input=l,s.textarea=c,r={get:function(e){var t=i(e);return t.data("placeholder-enabled")&&t.hasClass("placeholder")?"":e.value},set:function(e,n){var r=i(e);return r.data("placeholder-enabled")?(""==n?(e.value=n,e!=t.activeElement&&a.call(e)):r.hasClass("placeholder")?o.call(e,!0,n)||(e.value=n):e.value=n,r):e.value=n}},l||(u.input=r),c||(u.textarea=r),i(function(){i(t).delegate("form","submit.placeholder",function(){var e=i(".placeholder",this).each(o);setTimeout(function(){e.each(a)},10)})}),i(e).bind("beforeunload.placeholder",function(){i(".placeholder").each(function(){this.value=""})}))}(window,document,i)};n(),t.resolveWith(n)};FD40.module("placeholder",e)}(),function(){var e=function(e){var t=this,i=function(){e.fn.image=function(t){return(t=e.Image[t])&&t.apply(this[0],e.makeArray(arguments).slice(1))},e.Image={get:function(t){var i="IMG"===this.nodeName,n=e(i?this:new Image),o=e.Deferred();return n.load(function(){var e,t,a,r;i||n.appendTo("body");var s={width:e=n.width(),height:t=n.height(),aspectRatio:a=e/t,orientation:r=1===a?"square":a<1?"tall":"wide"};n.css({position:"absolute",left:"-99999px"}).data(s).addClass("orientation-"+r).removeAttr("style"),i||n.detach(),o.resolve(n,s)}).error(function(){o.reject()}).attr("src",t),o},aspectRatio:function(t,i){return e.isPlainObject(t)&&(i=(t=t.width).height),t/i},orientation:function(t,i){return e.isPlainObject(t)&&(i=(t=t.width).height),t===i?"square":t>i?"wide":"tall"},resizeProportionate:function(e,t,i,n,o){var a=e,r=t,s=i/e;a=e*s;var l=(r=t*s)>n;return"outer"==o&&(l=r<n),l&&(a=e*(s=n/t),r=t*s),{top:(n-r)/2,left:(i-a)/2,width:a,height:r}},resizeWithin:function(t,i,n,o){return e.Image.resizeProportionate(t,i,n,o,"inner")},resizeToFill:function(t,i,n,o){return e.Image.resizeProportionate(t,i,n,o,"outer")}}};i(),t.resolveWith(i)};FD40.module("image",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e){function t(){return e("<div/>")}var i=Math.abs,n=Math.max,o=Math.min,a=Math.round;e.imgAreaSelect=function(r,s){function l(e){return e+ge.left-ve.left}function c(e){return e+ge.top-ve.top}function d(e){return e-ge.left+ve.left}function u(e){return e-ge.top+ve.top}function p(e){return e.pageX-ve.left}function f(e){return e.pageY-ve.top}function m(e){var t=e||z,i=e||$;return{x1:a(be.x1*t),y1:a(be.y1*i),x2:a(be.x2*t),y2:a(be.y2*i),width:a(be.x2*t)-a(be.x1*t),height:a(be.y2*i)-a(be.y1*i)}}function h(e,t,i,n,o){var r=o||z,s=o||$;(be={x1:a(e/r||0),y1:a(t/s||0),x2:a(i/r||0),y2:a(n/s||0)}).width=be.x2-be.x1,be.height=be.y2-be.y1}function g(){de.width()&&(ge={left:a(de.offset().left),top:a(de.offset().top)},j=de.innerWidth(),U=de.innerHeight(),ge.top+=de.outerHeight()-U>>1,ge.left+=de.outerWidth()-j>>1,W=a(s.minWidth/z)||0,V=a(s.minHeight/$)||0,J=a(o(s.maxWidth/z||1<<24,j)),X=a(o(s.maxHeight/$||1<<24,U)),"1.3.2"!=e().jquery||"fixed"!=Ee||Se.getBoundingClientRect||(ge.top+=n(document.body.scrollTop,Se.scrollTop),ge.left+=n(document.body.scrollLeft,Se.scrollLeft)),ve=/absolute|relative/.test(H.css("position"))?{left:a(H.offset().left)-H.scrollLeft(),top:a(H.offset().top)-H.scrollTop()}:"fixed"==Ee?{left:e(document).scrollLeft(),top:e(document).scrollTop()}:{left:0,top:0},P=l(0),B=c(0),(be.x2>j||be.y2>U)&&w())}function v(t){if(K){switch(ue.css({left:l(be.x1),top:c(be.y1)}).add(pe).width(se=be.width).height(le=be.height),pe.add(fe).add(he).css({left:0,top:0}),fe.width(n(se-fe.outerWidth()+fe.innerWidth(),0)).height(n(le-fe.outerHeight()+fe.innerHeight(),0)),e(me[0]).css({left:P,top:B,width:be.x1,height:U}),e(me[1]).css({left:P+be.x1,top:B,width:se,height:be.y1}),e(me[2]).css({left:P+be.x2,top:B,width:j-be.x2,height:U}),e(me[3]).css({left:P+be.x1,top:B+be.y2,width:se,height:U-be.y2}),se-=he.outerWidth(),le-=he.outerHeight(),he.length){case 8:e(he[4]).css({left:se>>1}),e(he[5]).css({left:se,top:le>>1}),e(he[6]).css({left:se>>1,top:le}),e(he[7]).css({top:le>>1});case 4:he.slice(1,3).css({left:se}),he.slice(2,4).css({top:le})}!1!==t&&(e.imgAreaSelect.keyPress!=Ce&&e(document).unbind(e.imgAreaSelect.keyPress,e.imgAreaSelect.onKeyPress),s.keys&&e(document)[e.imgAreaSelect.keyPress](e.imgAreaSelect.onKeyPress=Ce)),e.browser.msie&&fe.outerWidth()-fe.innerWidth()==2&&(fe.css("margin",0),setTimeout(function(){fe.css("margin","auto")},0))}}function y(e){g(),v(e),Z=l(be.x1),ee=c(be.y1),te=l(be.x2),ie=c(be.y2)}function E(e,t){s.fadeSpeed?e.fadeOut(s.fadeSpeed,t):e.hide()}function b(e){var t=d(p(e))-be.x1,i=u(f(e))-be.y1;ce||(g(),ce=!0,ue.one("mouseout",function(){ce=!1})),Y="",s.resizable&&(i<=s.resizeMargin?Y="n":i>=be.height-s.resizeMargin&&(Y="s"),t<=s.resizeMargin?Y+="w":t>=be.width-s.resizeMargin&&(Y+="e")),ue.css("cursor",Y?Y+"-resize":s.movable?"move":""),N&&N.toggle()}function S(t){e("body").css("cursor",""),(s.autoHide||be.width*be.height==0)&&E(ue.add(me),function(){e(this).hide()}),e(document).unbind("mousemove",I),ue.mousemove(b),s.onSelectEnd(r,m())}function C(t){return 1==t.which&&(g(),Y?(e("body").css("cursor",Y+"-resize"),Z=l(be[/w/.test(Y)?"x2":"x1"]),ee=c(be[/n/.test(Y)?"y2":"y1"]),e(document).mousemove(I).one("mouseup",S),ue.unbind("mousemove",b)):s.movable?(q=P+be.x1-p(t),G=B+be.y1-f(t),ue.unbind("mousemove",b),e(document).mousemove(k).one("mouseup",function(){s.onSelectEnd(r,m()),e(document).unbind("mousemove",k),ue.mousemove(b)})):de.mousedown(t),!1)}function _(e){Q&&(e?(te=n(P,o(P+j,Z+i(ie-ee)*Q*(te>Z||-1))),ie=a(n(B,o(B+U,ee+i(te-Z)/Q*(ie>ee||-1)))),te=a(te)):(ie=n(B,o(B+U,ee+i(te-Z)/Q*(ie>ee||-1))),te=a(n(P,o(P+j,Z+i(ie-ee)*Q*(te>Z||-1)))),ie=a(ie)))}function w(){Z=o(Z,P+j),ee=o(ee,B+U),i(te-Z)<W&&((te=Z-W*(te<Z||-1))<P?Z=P+W:te>P+j&&(Z=P+j-W)),i(ie-ee)<V&&((ie=ee-V*(ie<ee||-1))<B?ee=B+V:ie>B+U&&(ee=B+U-V)),te=n(P,o(te,P+j)),ie=n(B,o(ie,B+U)),_(i(te-Z)<i(ie-ee)*Q),i(te-Z)>J&&(te=Z-J*(te<Z||-1),_()),i(ie-ee)>X&&(ie=ee-X*(ie<ee||-1),_(!0)),be={x1:d(o(Z,te)),x2:d(n(Z,te)),y1:u(o(ee,ie)),y2:u(n(ee,ie)),width:i(te-Z),height:i(ie-ee)},v(),s.onSelectChange(r,m())}function I(e){return te=/w|e|^$/.test(Y)||Q?p(e):l(be.x2),ie=/n|s|^$/.test(Y)||Q?f(e):c(be.y2),w(),!1}function x(t,i){te=(Z=t)+be.width,ie=(ee=i)+be.height,e.extend(be,{x1:d(Z),y1:u(ee),x2:d(te),y2:u(ie)}),v(),s.onSelectChange(r,m())}function k(e){return Z=n(P,o(q+p(e),P+j-be.width)),ee=n(B,o(G+f(e),B+U-be.height)),x(Z,ee),e.preventDefault(),!1}function L(){e(document).unbind("mousemove",L),g(),te=Z,ie=ee,w(),Y="",me.is(":visible")||ue.add(me).hide().fadeIn(s.fadeSpeed||0),K=!0,e(document).unbind("mouseup",A).mousemove(I).one("mouseup",S),ue.unbind("mousemove",b),s.onSelectStart(r,m())}function A(){e(document).unbind("mousemove",L).unbind("mouseup",A),E(ue.add(me)),h(d(Z),u(ee),d(Z),u(ee)),this instanceof e.imgAreaSelect||(s.onSelectChange(r,m()),s.onSelectEnd(r,m()))}function T(t){return 1==t.which&&!me.is(":animated")&&(g(),q=Z=p(t),G=ee=f(t),e(document).mousemove(L).mouseup(A),!1)}function O(){y(!1)}function D(){F=!0,R(s=e.extend({classPrefix:"imgareaselect",movable:!0,parent:"body",resizable:!0,resizeMargin:10,onInit:function(){},onSelectStart:function(){},onSelectChange:function(){},onSelectEnd:function(){}},s)),ue.add(me).css({visibility:""}),s.show&&(K=!0,g(),v(),ue.add(me).hide().fadeIn(s.fadeSpeed||0)),setTimeout(function(){s.onInit(r,m())},0)}function M(e,t){for(var i in t)void 0!==s[i]&&e.css(t[i],s[i])}function R(i){if(i.parent&&(H=e(i.parent)).append(ue.add(me)),e.extend(s,i),g(),null!=i.handles){for(he.remove(),he=e([]),ae=i.handles?"corners"==i.handles?4:8:0;ae--;)he=he.add(t());he.addClass(s.classPrefix+"-handle").css({position:"absolute",fontSize:0,zIndex:ye+1||1}),!parseInt(he.css("width"))>=0&&he.width(5).height(5),(re=s.borderWidth)&&he.css({borderWidth:re,borderStyle:"solid"}),M(he,{borderColor1:"border-color",borderColor2:"background-color",borderOpacity:"opacity"})}for(z=s.imageWidth/j||1,$=s.imageHeight/U||1,null!=i.x1&&(h(i.x1,i.y1,i.x2,i.y2),i.show=!i.hide),i.keys&&(s.keys=e.extend({shift:1,ctrl:"resize"},i.keys)),me.addClass(s.classPrefix+"-outer"),pe.addClass(s.classPrefix+"-selection"),ae=0;ae++<4;)e(fe[ae-1]).addClass(s.classPrefix+"-border"+ae);M(pe,{selectionColor:"background-color",selectionOpacity:"opacity"}),M(fe,{borderOpacity:"opacity",borderWidth:"border-width"}),M(me,{outerColor:"background-color",outerOpacity:"opacity"}),(re=s.borderColor1)&&e(fe[0]).css({borderStyle:"solid",borderColor:re}),(re=s.borderColor2)&&e(fe[1]).css({borderStyle:"dashed",borderColor:re}),ue.append(pe.add(fe).add(N).add(he)),e.browser.msie&&((re=(me.css("filter")||"").match(/opacity=(\d+)/))&&me.css("opacity",re[1]/100),(re=(fe.css("filter")||"").match(/opacity=(\d+)/))&&fe.css("opacity",re[1]/100)),i.hide?E(ue.add(me)):i.show&&F&&(K=!0,ue.add(me).fadeIn(s.fadeSpeed||0),y()),Q=(oe=(s.aspectRatio||"").split(/:/))[0]/oe[1],de.add(me).unbind("mousedown",T),s.disable||!1===s.enable?(ue.unbind("mousemove",b).unbind("mousedown",C),e(window).unbind("resize",O)):((s.enable||!1===s.disable)&&((s.resizable||s.movable)&&ue.mousemove(b).mousedown(C),e(window).resize(O)),s.persistent||de.add(me).mousedown(T)),s.enable=s.disable=void 0}var F,N,P,B,j,U,H,q,G,z,$,Y,W,V,J,X,Q,K,Z,ee,te,ie,ne,oe,ae,re,se,le,ce,de=e(r),ue=t(),pe=t(),fe=t().add(t()).add(t()).add(t()),me=t().add(t()).add(t()).add(t()),he=e([]),ge={left:0,top:0},ve={left:0,top:0},ye=0,Ee="absolute",be={x1:0,y1:0,x2:0,y2:0,width:0,height:0},Se=document.documentElement,Ce=function(e){var t,i,a=s.keys,r=e.keyCode;if(t=isNaN(a.alt)||!e.altKey&&!e.originalEvent.altKey?!isNaN(a.ctrl)&&e.ctrlKey?a.ctrl:!isNaN(a.shift)&&e.shiftKey?a.shift:isNaN(a.arrows)?10:a.arrows:a.alt,"resize"==a.arrows||"resize"==a.shift&&e.shiftKey||"resize"==a.ctrl&&e.ctrlKey||"resize"==a.alt&&(e.altKey||e.originalEvent.altKey)){switch(r){case 37:t=-t;case 39:i=n(Z,te),Z=o(Z,te),te=n(i+t,Z),_();break;case 38:t=-t;case 40:i=n(ee,ie),ee=o(ee,ie),ie=n(i+t,ee),_(!0);break;default:return}w()}else switch(Z=o(Z,te),ee=o(ee,ie),r){case 37:x(n(Z-t,P),ee);break;case 38:x(Z,n(ee-t,B));break;case 39:x(Z+o(t,j-d(te)),ee);break;case 40:x(Z,ee+o(t,U-u(ie)));break;default:return}return!1};for(this.remove=function(){R({disable:!0}),ue.add(me).remove()},this.getOptions=function(){return s},this.setOptions=R,this.getSelection=m,this.setSelection=h,this.cancelSelection=A,this.update=y,ne=de;ne.length;)ye=n(ye,isNaN(ne.css("z-index"))?ye:ne.css("z-index")),"fixed"==ne.css("position")&&(Ee="fixed"),ne=ne.parent(":not(body)");ye=s.zIndex||ye,e.browser.msie&&de.attr("unselectable","on"),e.imgAreaSelect.keyPress=e.browser.msie||e.browser.safari?"keydown":"keypress",e.browser.opera&&(N=t().css({width:"100%",height:"100%",position:"absolute",zIndex:ye+2||2})),ue.add(me).css({visibility:"hidden",position:Ee,overflow:"hidden",zIndex:ye||"0"}),ue.css({zIndex:ye+2||2}),pe.add(fe).css({position:"absolute",fontSize:0}),r.complete||"complete"==r.readyState||!de.is("img")?D():de.one("load",D),!F&&e.browser.msie&&e.browser.version>=7&&(r.src=r.src)},e.fn.imgAreaSelect=function(t){return t=t||{},this.each(function(){e(this).data("imgAreaSelect")?t.remove?(e(this).data("imgAreaSelect").remove(),e(this).removeData("imgAreaSelect")):e(this).data("imgAreaSelect").setOptions(t):t.remove||(void 0===t.enable&&void 0===t.disable&&(t.enable=!0),e(this).data("imgAreaSelect",new e.imgAreaSelect(this,t)))}),t.instance?e(this).data("imgAreaSelect"):this}}(i)};n(),t.resolveWith(n)};FD40.module("imgareaselect",e)}(),function(){var e=function(e){var t=this,i=function(){var t=new function(){this.countRegexp=function(e,t){var i=e.match(t);return i?i.length:0},this.getStrength=function(e,t){var i=e.length;if(i<t)return 0;var n=this.countRegexp(e,/\d/g),o=this.countRegexp(e,/[a-z]/g),a=this.countRegexp(e,/[A-Z]/g),r=i-n-o-a;if(n==i||o==i||a==i||r==i)return 1;var s=0;return n&&(s+=2),o&&(s+=a?4:3),a&&(s+=o?4:3),r&&(s+=5),i>10&&(s+=1),s},this.getStrengthLevel=function(e,t){var i=this.getStrength(e,t),e=1;return i<=0?e=1:i>0&&i<=4?e=2:i>4&&i<=8?e=3:i>8&&i<=12?e=4:i>12&&(e=5),e}};e.fn.password_strength=function(i){var n=e.extend({container:null,minLength:6,texts:{1:"Too weak",2:"Weak password",3:"Normal strength",4:"Strong password",5:"Very strong password"},onCheck:null},i);return this.each(function(){var i=null;n.container?i=e(n.container):(i=e("<span/>").attr("class","password_strength"),e(this).after(i)),e(this).keyup(function(){var o=e(this).val(),a=t.getStrengthLevel(o,n.minLength);if(o.length>0){var r="password_strength_"+a;!i.hasClass(r)&&a in n.texts&&i.text(n.texts[a]).attr("class","password_strength "+r)}else i.text("").attr("class","password_strength");n.onCheck&&n.onCheck.call(this,a)})})}};i(),t.resolveWith(i)};FD40.module("passwordstrength",e)}(),function(){var e=function(e){var t=this,i=function(){var t={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};e.fn.caret=function(e,t){if(0!=this.length){if("number"==typeof e)return t="number"==typeof t?t:e,this.each(function(){if(this.setSelectionRange)this.setSelectionRange(e,t);else if(this.createTextRange){var i=this.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",e);try{i.select()}catch(e){}}});if(this[0].setSelectionRange)e=this[0].selectionStart,t=this[0].selectionEnd;else if(document.selection&&document.selection.createRange){var i=document.selection.createRange();e=0-i.duplicate().moveStart("character",-1e5),t=e+i.text.length}return{start:e,end:t}}};var i=function(t){e.extend(this,t)};e.extend(i.prototype,{val:function(e){var t=this;return void 0===e?t.text.nodeValue:(t.text.nodeValue=e,t.end=t.start+(t.length=e.length),t)},nextSibling:function(e){for(var t=e.nextSibling;t&&1===t.nodeType&&t.hasAttribute("data-ignore");)t=t.nextSibling;return t},insert:function(t,n,o){var a=this,r=a.block,s=a.text,l=a.parent,c=a.br,d=a.val(),u=a.length,p="\n"==t,f=" "==t,m=""==t,h=a.trigger||{},g=a.finalized,v=32==d.charCodeAt(n-1),y=h.allowSpace||a.allowSpace,E=f&&(!y||y&&v);if(void 0===n&&(n=u),void 0===o&&(o=n),r&&y&&v&&!g){if(f){var b=e(a.textarea),S=b.val(),C=b.caret().end-1,_=a.start+n;b.val(S.substring(0,_)+S.slice(_+1)).caret(C)}return a.toTextMarker(),f?(e(l).trigger("markerInsert",[a,O,t,n,o]),a):a.insert(t,n,o)}if(r&&o==u&&!m&&(E||p||c||g)){var w=a.spawn().insert(t,0);return e(l).trigger("markerExit",[a,O,w,t,n,o]),w}if(r&&0===a.index&&0===o&&1===t.length){var I=document.createTextNode(t);l.insertBefore(I,r);var x=new i({index:0,start:0,end:t.length,text:I,parent:l,textarea:a.textarea,allowSpace:!0});return e(l).trigger("markerInsert",[x,O,t,n,o]),x}var k=r?r.nextSibling:s.nextSibling,L=d.substring(0,n),A=d.slice(o),T=t.replace(/  /g,"  ").split("\n"),O=[],D=r||s,M=T.length;for(T[0]=L+T[0],T[M-1]+=A;--M;){var D=document.createTextNode(T[M]),c=document.createElement("BR");O.push(l.insertBefore(D,k)),O.push(l.insertBefore(c,D)),k=c}return a.val(T[M]),e(l).trigger("markerInsert",[a,O,t,n,o]),a},remove:function(){var t=this,i=t.parent,n=t.block,o=t.text;return n&&e(n).trigger("triggerDestroy",[t]),i.removeChild(n||o),t.removed=!0,e(i).trigger("markerRemove",[t]),t},toTextMarker:function(){var t=this,i=t.block,n=t.parent;if(!i)return t;var o=t.clone();return i&&e(i).trigger("triggerDestroy",[t]),n.insertBefore(t.text,i.nextSibling),n.removeChild(i),delete t.block,delete t.trigger,e(t.parent).trigger("markerConvert",[t,o,"text"]),t},toBlockMarker:function(t){var i=this;if(!i.block){var n=i.clone(),o=i.parent,a=i.block=document.createElement("SPAN"),r=i.text;return o.insertBefore(a,r.nextSibling),a.appendChild(r),e(a).data("marker",{}),e(i.parent).trigger("markerConvert",[i,n,"block"]),i}},spawn:function(e,t){var n=this,o=n.text,a=n.parent,r=n.block,s=r?r.nextSibling:o.nextSibling;void 0===e&&(e=t=n.length),t<n.length&&(s=a.insertBefore(o.splitText(t),s)),o=a.insertBefore(o.splitText(e),s);var l=new i({index:n.index+1,start:e=n.start+e,end:t=n.start+t,length:t-e,text:o,parent:a,textarea:n.textarea,before:n,after:n.after,br:!1,allowSpace:!0,finalized:!1});return n.end=e,n.length=n.end-n.start,n.after=l,l},clone:function(){return new i(e.pick(this,"index,start,end,length,text,parent,textarea,before,after,br,allowSpace,trigger,value,finalized".split(",")))},finalize:function(t){var i=this,n=i.block;if(n){var o=e(n).data("marker");o.value=t,o.finalized=!0,e.extend(i,o)}}}),e.Controller("Mentions",{pluginName:"mentions",hostname:"mentions",defaultOptions:{cssCloneProps:["lineHeight","textDecoration","letterSpacing","fontSize","fontFamily","fontStyle","fontWeight","textTransform","textAlign","direction","wordSpacing","fontSizeAdjust"],triggers:{},inspector:!1,"{textarea}":"[data-mentions-textarea]","{overlay}":"[data-mentions-overlay]","{block}":"[data-mentions-overlay] > span"}},function(t){return{init:function(){t._overlay=t.overlay()[0],t._textarea=t.textarea()[0],setTimeout(function(){t.cloneLayout()},15),t.options.inspector&&t.inspect(),t.addPlugin("autocomplete"),t.initialCaret=t.textarea().data("initial")||0},inspect:function(){t.inspector=t.addPlugin("inspector"),t.inspector.showInspector()},setLayout:function(){t.normalize()},cloneLayout:function(){for(var e=t.overlay(),i=e.detach()[0],n=t.textarea(),o=t.options.cssCloneProps,a=0;prop=o[a++];)i.style[prop]=n.css(prop);i.style.opacity=1,e.insertBefore(n),t.setLayout()},reset:function(){var i=t.overlay(),n=i.data("default");void 0!==n?i.html(e("<div>").html(n).html()):i.empty();var o=t.textarea(),a=o.data("default");void 0!==a?o.val(e("<div>").html(a).text()):o.val(""),t.caretBefore=t.caretAfter={start:0,end:0},t.previousMarker=null,t.normalize(),t.initialFocus=!0,t.trigger("triggerClear")},getTrigger:function(e){var i=t.options.triggers;if(i.hasOwnProperty(e)){var n=i[e];return n.key=e,n}},getTriggerFromType:function(i){var n,o=t.options.triggers;return e.each(o,function(e,t){if(t.type===i)return n=t,!1}),n},getStopIndex:function(e,t){for(var i=t.length,n=e.length;i--;){var o=t.substr(i,1),a=e.indexOf(o);n=a<0?n:Math.min(n,a)}return n},getMarkers:function(n){var o,a=t._textarea,r=t._overlay,s=e.makeArray(r.childNodes),l=0,c=0,d=null,u=!1,p=[],f=function(e){var t;return n&&(t=n.apply(e,[e])),null!==t&&!1!==t&&p.push(void 0!==t?t:e),t};for(e.remove(s,function(e){return 1===e.nodeType&&e.hasAttribute("data-ignore")});o=s[l++];){var m,h,g,v=o.nodeType,y=o.nodeName,E=null,b=!1,S=!1;if(3==v)m=o,S=!0;else if((E=o)&&"BR"==y)m=document.createTextNode("\n"),b=!0;else if(1!==v||"SPAN"!==y||!(m=o.childNodes[0])||3!==m.nodeType){r.removeChild(o);continue}var C={index:l-1,start:c,end:h=c+(g=m.length),length:g,text:m,block:E,parent:r,textarea:a,before:d,br:b,allowSpace:S,finalized:!1};if(E){var _=e(o),w=_.data("marker");if(w||(w={})&&_.data("marker",w),o.hasAttribute("data-type")){var I=_.attr("data-type"),x=t.getTriggerFromType(I);x&&(w.trigger=x),_.removeAttr("data-type")}o.hasAttribute("data-value")&&(w.value=_.attr("data-value"),w.finalized=!0,_.removeAttr("data-value")),e.extend(C,w)}var k=new i(C);if(l>1&&(d.after=k,u=!1===f(d)))break;c=h,d=k}return u||f(d),p},getMarkerAt:function(e){if(void 0!==e){var i;return t.getMarkers(function(){if(e>=this.start&&e<=this.end)return i=this,!1}),i}},getMarkersBetween:function(e,i){if(void 0!==e)return t.getMarkers(function(){return!(this.start>i)&&(this.end<e?null:this)})},toArray:function(e,i){var n=t.getMarkers(function(){var i=this;if(!i.block||i.br)return null;if(!i.trigger){var n=i.text.nodeValue,o=n.slice(0,1),a=t.getTrigger(o);if(!a)return null;i.trigger=a,i.value=n.slice(1)}var r={start:i.start,length:i.length,type:i.trigger.type,value:i.value};return e?JSON.stringify(r):r});return i?n:n.reverse()},insert:function(e,i,n){var o,a;if(i===n||void 0===n)a=(o=t.getMarkerAt(i)).start,o.insert(e,i-a,n-a);else{var r=t.getMarkersBetween(i,n),s=r.length;if(s<1)return;if(1==s)a=(o=r[0]).start,o.insert(e,i-a,n-a);else{var l=s-1;for((o=r[l]).block&&n>o.start&&o.toTextMarker(),n-o.start>0&&o.insert("",0,n-o.start);(o=r[--l])&&l>0;)o.remove();o.block&&0===o.index&&0===i&&o.toTextMarker(),o.insert(e,i-o.start,o.length),0===i&&o.br&&o.remove()}}return t.normalize(),o},textareaInsert:function(e,i,n){var o=t._textarea,a=o.value;return o.value=a.substring(0,i)+e+a.slice(n)},normalize:function(){var e=t._overlay,i=t._textarea;e.normalize();var n=e.firstChild,o=e.lastChild,a=document.createTextNode("");o&&"BR"!==o.nodeName||e.appendChild(a),o&&o==n&&1===o.nodeType&&o.hasAttribute("data-ignore")&&e.insertBefore(a,o),e.style.height="auto",e.style.height=i.scrollHeight+"px",i.scrollTop=0,t.lengthBefore=i.value.length},lengthBefore:0,caretBefore:{start:0,end:0},caretAfter:{start:0,end:0},skipKeydown:!1,previousMarker:null,initialFocus:!0,"{textarea} focus":function(){t.initialFocus&&t.textarea().caret(t.initialCaret||0)},"{textarea} keydown":function(i,n){if(t.initialFocus=!1,!t.skipKeydown){t.caretBefore=i.caret();8===n.keyCode&&e.IE<10&&t.overlay().css("opacity",0),t.skipKeydown=!0}},"{textarea} keypress":function(e,i){t.caretBefore=e.caret(),i.keyCode},"{textarea} input":function(e){t.reflect(),e.val().length<1&&t.reset()},"{textarea} keyup":function(i,n){if(t.skipKeydown=!1,8===n.keyCode&&e.IE<10){var o=t.caretBefore,a=t.caretAfter=t.textarea().caret();t.insert("",a.end,o.end),t.caretBefore=a,t.overlay().css("opacity",1)}},reflect:function(){var i=t._textarea,n=i.value,o=t.caretBefore,a=t.caretAfter=e(i).caret(),r=e.browser.opera&&a.end>a.start,s=t.getMarkerAt(o.start),l=t.lengthBefore-n.length,c=!1;if(r&&o.start!==o.end&&(o.end+=l),s){var d=t.previousMarker,u=s.block;if(d){var p=d.block,f=(d.trigger||{}).finalize;if(p&&f&&!d.finalized&&p!==u)try{d.toTextMarker()}catch(e){t.previousMarker=null}}if(!s.br&&(0===l||a.end<o.start))var m=s.start,h=s.end-l,g=a.end,v=o.start,c=m!==h;else var g=m=Math.min(o.start,a.start),v=o.end,h=a.end;var y=n.substring(m,h);c?(s.val()!==y&&s.finalized&&s.toTextMarker(),s.val(y),t.overlay().trigger("markerInsert",s,[],y,m,h),t.normalize()):t.insert(y,g,v),r&&(a.start=a.end),t.caretBefore=t.caretAfter}},"{overlay} markerInsert":function(i,n,o,a,r,s,l){var c,d=o.text.nodeValue;if(t.previousMarker=null,c=t.getTrigger(r)){var u=d.charCodeAt(s-1),p=o.before&&o.before.br;if(0===o.index||32===u||p){var f=d.slice(s),m=f.slice(1);l=c.wrap&&f.length>1?t.getStopIndex(m,c.stop)+s+1:s+1;m=(g=o.spawn(s,l).toBlockMarker()).val().slice(1);(v=e(g.block).data("marker")).value=m,v.trigger=c,t.previousMarker=g,t.trigger("triggerCreate",[g,c,m])}}if(o.block&&!o.br)if(o.finalized)l<o.length-1&&o.toTextMarker();else{var h=d.slice(0,1);if(!(c=t.getTrigger(h)))return;var m=d.slice(1),g=!1;(s=t.getStopIndex(m,c.stop)+1)<(l=d.length)&&(g=o.spawn(s,l)),m=o.val().slice(1);var v=e(o.block).data("marker");v.value=m,v.trigger=c,t.previousMarker=o,t.trigger("triggerChange",[o,g,c,m])}},"{overlay} markerExit":function(e,i,n,o,a,r,s,l){var c=n.trigger;if(c){var d=c.allowSpace||n.allowSpace,u=n.val();d||n.val()!==c.key||n.toTextMarker(),t.trigger("triggerExit",[n,a,c,u])}}}}),e.template("mentions/menu",'<div class="mentions-autocomplete" data-mentions-autocomplete><b><b></b></b><div class="mentions-autocomplete-inner" data-mentions-autocomplete-viewport><div class="mentions-autocomplete-loading" data-mentions-autocomplete-loading data-mentions-autocomplete-close></div><div class="mentions-autocomplete-empty" data-mentions-autocomplete-empty></div><div class="mentions-autocomplete-search" data-mentions-autocomplete-search></div><ul class="mentions-menu" data-mentions-menu></ul></div></div>'),e.template("mentions/menuItem",'<li class="mentions-menuItem" data-mentions-menuItem>[%== html %]</li>'),e.template("mentions/loadingHint",'<i class="mentions-autocomplete-loading-indicator"></i>'),e.template("mentions/searchHint",'<span class="mentions-autocomplete-search-hint">Type a keyword to begin.</span>'),e.template("mentions/emptyHint",'<span class="mentions-autocomplete-empty-text">No items found.</span>'),e.Controller("Mentions.Autocomplete",{defaultOptions:{view:{menu:"mentions/menu",menuItem:"mentions/menuItem",searchHint:"mentions/searchHint",loadingHint:"mentions/loadingHint",emptyHint:"mentions/emptyHint"},id:"",component:"",modifier:"",shadow:!1,sticky:!1,animation:!1,query:{data:null,cache:!0,minLength:1,limit:10,highlight:!0,caseSensitive:!1,exclusive:!1,searchHint:!1,loadingHint:!1,emptyHint:!1},position:{my:"left top",at:"left bottom",collision:"none"},size:{width:"auto",height:"auto"},"{menu}":"[data-mentions-menu]","{menuItem}":"[data-mentions-menuItem]","{viewport}":"[data-mentions-autocomplete-viewport]","{loadingHint}":"[data-mentions-autocomplete-loading]","{emptyHint}":"[data-mentions-autocomplete-empty]","{searchHint}":"[data-mentions-autocomplete-search]","{closeButton}":"[data-mentions-autocomplete-close]"}},function(i,n,o){return{init:function(){setTimeout(function(){if(i.element.data(i.Class.fullName)){var t=i.mentions;i.uid=e.uid(),t.autocomplete=i,t.pluginInstances.autocomplete=i,n.position.of||(n.position.of=i.mentions.element),i.defaultSearchHint=i.view.searchHint().toHTML(),i.defaultEmptyHint=i.view.emptyHint().toHTML(),i.defaultLoadingHint=i.view.loadingHint().toHTML(),i.element.detach()}else{i.destroy();i.view.menu().attr("id",n.id).addClass(n.component).addClass(n.modifier).addClass(n.shadow?"has-shadow":"").addClass(n.animation?"has-animation":"").addClass(n.sticky?"is-sticky":"").appendTo("body").data(i.Class.fullName,!0).addController(i.Class,n)}},50)},setLayout:function(){if(!i.hidden){var t=i.options.size,n=i.mentions.element.outerWidth(),o="auto";e.isFunction(t.width)&&(n=t.width(n)),e.isFunction(t.height)&&(o=t.height(o)),i.element.css({opacity:1,width:n}).position(i.options.position),setTimeout(function(){i.viewport().addClass("active")},1)}},"{window} resize":e.debounce(function(){i.element.css("opacity",0),i.setLayout()},250),"{window} scroll":e.debounce(function(){i.element.css("opacity",0),i.setLayout()},250),"{window} dialogTransitionStart":function(){i.hidden=!0,i.element.css("opacity",0)},"{window} dialogTransitionEnd":function(){i.hidden=!1,i.setLayout()},currentMarker:null,"{mentions} triggerCreate":function(e,t,n,o,a){i.populate(n,o,a),i.currentMarker=n},"{mentions} triggerChange":function(e,t,n,o,a,r){i.populate(n,a,r),i.currentMarker=n},"{mentions} triggerExit":function(e,t,n,o,a,r){var s=i.activeQuery;s&&(s.aborted=!0),i.hide()},"{mentions.block} triggerDestroy":function(e,t,n){i.hide()},"{mentions} triggerClear":function(){i.hide()},hidden:!0,show:function(t){clearTimeout(i.sleep),i.element.appendTo("body").show(),i.hidden=!1,i.viewport().removeClass("active"),i.setLayout();var n=e(document),a="click.mentions."+i.uid;n.off(a).on(a,function(t){e(t.target).parents().andSelf().filter(o).length>0||(n.off(a),i.hide())}),t&&(i.sleep=setTimeout(function(){i.hide()},t))},hide:function(){i.element.hide();var e=i.menuItem(),t=e.filter(".active");t.length>0&&(i.lastItem={keyword:"",item:t.data("item")}),i.viewport().removeClass("active"),e.removeClass("active"),i.render.reset(),i.hidden=!0,clearTimeout(i.sleep),i.sleep=setTimeout(function(){i.element.detach()},3e3)},query:function(t){if(t){var n=e.extend({},i.options.query,e.isPlainObject(t)?t:{data:t}),o=n.data;if(o){if(e.isUrl(o)){var a=o;n.lookup=function(){return e.ajax(a+n.keyword)}}if(e.isFunction(o)){var r=o;n.lookup=function(){return r.call(i,n.keyword)}}if(e.isArray(o)){var s=o;n.lookup=function(){var t=e.Deferred(),i=n.keyword.toLowerCase();return setTimeout(function(){var n=e.grep(s,function(e){return e.title.toLowerCase().indexOf(i)>-1});t.resolve(n)},0),t}}return n}}},tasks:{},delayTask:null,activeQuery:null,populate:function(t,n,o){var a=i.activeQuery;if(a&&(a.aborted=!0),a=i.query(n.query)){if(i.activeQuery=a,a.keyword=o,a.trigger=n,a.marker=t,i.trigger("queryPrepare",[a]),""===(o=a.keyword)||o.length<a.minLength){var r=a.searchHint;return void(r?(i.searchHint().html(e.isString(r)?r:i.defaultSearchHint),i.element.addClass("search"),i.show()):i.hide())}var s=a.id=n.key+"|"+a.caseSensitive?o:o.toLowerCase(),l=i.tasks,c=a.task=l[s],d=!e.isDeferred(c)||!a.cache,u=function(){i.trigger("queryBeforeStart",[a]).isDefaultPrevented()||((d||!d&&"rejected"==c.state())&&(c=l[s]=a.task=a.lookup()),c.done(i.render(function(e){return[e,a]})),i.trigger("queryStart",[a]))};d?(clearTimeout(i.delayTask),i.delayTask=setTimeout(u,250)):u()}},"{self} queryPrepare":function(e,t,n){e.removeClass("loading empty search"),n.loadingHint&&i.hide()},"{self} queryBeforeStart":function(t,n,o){var a=o.loadingHint;a&&(i.loadingHint().html(e.isString(a)?a:i.defaultLoadingHint),t.addClass("loading"),i.show())},"{self} queryStart":function(e,t,n){n.task.fail(function(){i.hide()}).always(function(){e.removeClass("loading")})},render:e.Enqueue(function(t,n){if(n.aborted)i.hide();else{e.isArray(t)||(t=[]);var o=i.mentions,a=i,r=i.element,s=i.menu(),l=n.keyword;if(t.length<1){var c=n.emptyHint;return c?(i.emptyHint().html(e.isString(c)?c:i.defaultEmptyHint),s.empty(),r.addClass("empty"),i.show(2e3)):i.hide(),void o.trigger("menuRender",[s,n,a,o])}r.removeClass("empty"),n.cache&&s.data("keyword")===l||(s.empty(),e.each(t,function(t,r){if(o.trigger("menuCreateItem",[r,n,a,o]),e.isPlainObject(r)&&!r.discard){var l=r.menuHtml||r.title;i.view.menuItem({html:l}).data("item",r).appendTo(s)}}),s.data("keyword",l));var d=i.menuItem();if(o.trigger("menuCreate",[s,d,n,a,o]),d.filter(":not(.hidden)").length<1&&(r.addClass("empty"),!n.emptyHint))return i.hide();n.exclusive&&i.menuItem(":not(.hidden):first").addClass("active"),o.trigger("renderMenu",[s,n,a,o]),i.show()}}),"{mentions.textarea} keydown":function(e,n){switch(clearTimeout(i.sleep),(a=i.menuItem(".active:not(.hidden)")).length<1&&(a=!1),n.keyCode){case t.UP:i.menuItem().removeClass("active"),a?a.prev(i.menuItem.selector+":not(.hidden)").addClass("active"):i.menuItem(":not(.hidden):last").addClass("active"),i.hidden||n.preventDefault();break;case t.DOWN:i.menuItem().removeClass("active"),a?a.next(i.menuItem.selector+":not(.hidden)").addClass("active"):i.menuItem(":not(.hidden):first").addClass("active"),i.hidden||n.preventDefault();break;case t.ESCAPE:i.hide();break;case t.ENTER:if(!i.hidden&&a){var o=a.data("item");i.use(o),n.preventDefault()}}var a=i.menuItem(".active:not(.hidden)");i.hidden||i.viewport().scrollIntoView(a)},"{menuItem} mouseup":function(e){i.hide();var t=e.data("item");i.use(t),setTimeout(function(){i.mentions.textarea().focus()},150)},use:function(e){var t=i.activeQuery;if(t){var n=t.marker,o=e.title;n.text.nodeValue=o,delete e.menuHtml;var a=e;t.use&&(a=t.use(e)),n.finalize(a),i.mentions.textareaInsert(o,n.start,n.end),i.mentions.textarea().caret(n.start+o.length),i.mentions.normalize(),i.hidden=!0,i.hide()}},"{menuItem} mouseover":function(e){i.menuItem().removeClass("active"),e.addClass("active")},"{menuItem} mouseout":function(e){i.menuItem().removeClass("active")},"{closeButton} click":function(){i.hide()},"{mentions} destroyed":function(){i.element.remove()}}}),e.template("mentions/inspector",'<div class="mentions-inspector" data-mentions-inspector><fieldset><b>Selection</b><hr/><label>Start</label><input type="text" data-mentions-selection-start/><hr/><label>End</label><input type="text" data-mentions-selection-end/><hr/><label>Length</label><input type="text" data-mentions-selection-length/><hr/></fieldset><fieldset><b>Trigger</b><hr/><label>Key</label><input type="text" data-mentions-trigger-key/><hr/><label>Type</label><input type="text" data-mentions-trigger-type/><hr/><label>Buffer</label><input type="text" data-mentions-trigger-buffer/><hr/></fieldset><hr/> <fieldset><b>Marker</b><hr/><label>Index</label><input type="text" data-mentions-marker-index/><hr/><label>Start</label><input type="text" data-mentions-marker-start/><hr/><label>End</label><input type="text" data-mentions-marker-end/><hr/><label>Length</label><input type="text" data-mentions-marker-length/><hr/><label>Text</label><input type="text" data-mentions-marker-text/><hr/></fieldset><fieldset><b>Block</b><hr/><label>Html</label><input type="text" data-mentions-block-html/><hr/><label>Text</label><input type="text" data-mentions-block-text/><hr/><label>Type</label><input type="text" data-mentions-block-type/><hr/><label>Value</label><input type="text" data-mentions-block-value/><hr/></fieldset></div>'),e.Controller("Mentions.Inspector",{defaultOptions:{view:{item:"mentions/item",inspector:"mentions/inspector"},"{inspector}":"[data-mentions-inspector]","{selectionStart}":"[data-mentions-selection-start]","{selectionEnd}":"[data-mentions-selection-end]","{selectionLength}":"[data-mentions-selection-length]","{markerIndex}":"[data-mentions-marker-index]","{markerStart}":"[data-mentions-marker-start]","{markerEnd}":"[data-mentions-marker-end]","{markerLength}":"[data-mentions-marker-length]","{markerText}":"[data-mentions-marker-text]","{blockText}":"[data-mentions-block-text]","{blockHtml}":"[data-mentions-block-html]","{blockType}":"[data-mentions-block-type]","{blockValue}":"[data-mentions-block-value]","{triggerKey}":"[data-mentions-trigger-key]","{triggerType}":"[data-mentions-trigger-type]","{triggerBuffer}":"[data-mentions-trigger-buffer]"}},function(t){return{init:function(){},showInspector:function(){t.inspector().length<1&&t.view.inspector().appendTo(t.element),t.inspector().show(),t.mentions.overlay().css("color","green")},hideInspector:function(){t.inspector().hide(),t.mentions.overlay().css("color","transparent")},"{mentions.textarea} keyup":function(){t.inspect()},"{inspector} dblclick":function(){t.textarea().toggle()},inspect:e.debounce(function(){var i=t.mentions.textarea().caret();t.selectionStart().val(i.start),t.selectionEnd().val(i.end),t.selectionLength().val(i.end-i.start);var n=t.triggered;if(n){var o=t.getTrigger(n);t.triggerKey().val(n),t.triggerType().val(o.type),t.triggerBuffer().val(t.buffer)}else t.triggerKey().val(""),t.triggerType().val(""),t.triggerBuffer().val("");var a=t.mentions.getMarkerAt(i.start);a?(t.markerIndex().val(a.index).data("marker",a),t.markerStart().val(a.start),t.markerEnd().val(a.end),t.markerLength().val(a.length),t.markerText().val(a.text.nodeValue)):(t.markerIndex().val("").data("marker",null),t.markerStart().val(""),t.markerEnd().val(""),t.markerLength().val(""),t.markerText().val(""));var r=(a||{}).block;r?(t.blockText().val(a.text.nodeValue),t.blockHtml().val(e(r).clone().toHTML())):(t.blockText().val(""),t.blockHtml().val(""))},25),"{markerIndex} click":function(e){console.dir(e.data("marker"))}}})};i(),t.resolveWith(i)};FD40.module("mentions",e)}(),function(){var moduleFactory=function($){var module=this;$.require().script("ui/position","easing").done(function(){var exports=function(){$.template("dialog/default",'<div class="foundryDialog global"><div class="dialog-wrap"><div class="in"><div class="dialog-loader"><div class="loader-img"></div></div><div class="dialog-head"><span class="dialog-title"></span><a class="dialog-closeButton">Close</a></div><div class="dialog-body dialog-content"></div><div class="dialog-footer"><div class="dialog-loading"></div><div class="dialog-buttons"></div></div></div></div></div>'),$.Controller("Dialog",{pluginName:"dialog",defaultOptions:{title:"",content:void 0,buttons:{},customClass:"",width:"auto",height:"auto",css:{position:"absolute",width:"auto",height:"auto",zIndex:10001},position:{my:"center center",at:"center center",of:window},offset:100,showOverlay:!0,overlay:{css:{background:"#000",opacity:"0.4",position:"fixed",top:0,left:0,zIndex:1e4,width:"100%",height:"100%",display:"none"}},body:{css:{minWidth:0,minHeight:0,overflow:"auto"}},loader:{width:300,height:100},loading:"",iframe:{css:{width:"100%",height:"100%",border:"none"}},transition:{show:"zoom",hide:"zoom"},escapeKey:!0,beforeShow:function(){},afterShow:function(){},beforeHide:function(){},afterHide:function(){},dialogHead:".dialog-head",dialogBody:".dialog-body",dialogFooter:".dialog-footer",dialogTitle:".dialog-title",dialogContent:".dialog-content",dialogButtons:".dialog-buttons",dialogLoader:".dialog-loader",dialogLoading:".dialog-loading","{closeButton}":".dialog-closeButton"}},function(self){return{ready:!1,contentReady:!1,init:function(){self.setInitOptions(self.options),self.initElement=self.element.clone(),self.element.finalizeContent=function(){return self.finalizeContent.apply(self,arguments)},$.each(["dialogHead","dialogBody","dialogFooter","dialogTitle","dialogContent","dialogButtons","dialogLoader","dialogLoading"],function(e,t){self[t]=self.find(self.options[t])}),void 0!==self.options.content&&self.display()},"{self} destroyed":function(){$(document).off("keydown.foundry.dialog")},setInitOptions:function(e){self.initOptions=$.extend(!0,{},e),$.each(["beforeShow","afterShow","beforeHide","afterHide"],function(e,t){self.initOptions[t]=function(){}}),$.each(["title","content","buttons","loading","selectors","bindings"],function(e,t){self.initOptions[t]=null})},update:function(e){if(e){if(e.hasOwnProperty("{binder}"))return;var e=$.extend(!0,{},self.initOptions,e);self.setInitOptions(e),self.display(e)}return self},determineContentType:function(e){return/<dialog>(.*?)/.test(e)?"dialog":$.isUrl(e)?"iframe":$.isDeferred(e)?"deferred":"html"},displayQueue:[],display:function(options){if(self.resizing)return self.displayQueue.push(options);$.isPlainObject(options)&&(self.options=$.extend(!0,{},self.Class.defaults,options)),self.ready||self.options.showOverlay&&self.createOverlay();var options=self.options,content=options.content;self.contentReady=null===content,self.contentType=self.determineContentType(content);var transition=options.transition;switch($.isString(transition)&&(options.transition={show:transition,hide:transition}),self.contentType){case"html":self.hideLoader(),self.show();break;case"iframe":var iframe=$(document.createElement("iframe")),iframeUrl=content,iframeCss=options.iframe.css,iframeButtons=options.buttons,dialogContent=self.dialogContent,iframeOptions=$.extend(!0,{},options,{content:iframe,buttons:iframeButtons});self.showLoader(function(){onIframeLoaded=function(){return function(e){try{iframe[0].contentWindow.parentDialog=self}catch(e){}self.update(iframeOptions)}}(),self.dialogBody.addClass("type-iframe"),iframe.appendTo(dialogContent).css(iframeCss).css({position:"absolute",visibility:"hidden"}).one("load",onIframeLoaded).attr("src",iframeUrl)});break;case"deferred":var ajax=content;self.showLoader(function(){ajax.done(function(e){if(e){var t=$.isString(e)?{content:e}:e;t.content&&self.update($.extend(!0,{},options,t))}}).fail(function(e,t){var i=$.isString(t)?$.String.capitalize(t):"Error",n=$.isString(e)?e:"There was an error loading content.";self.update({title:i,content:n})})});break;case"dialog":var xmlOptions=$.buildHTML(content),newOptions={};$.each(xmlOptions.children(),function(i,node){var node=$(node),key=$.String.camelize(this.nodeName.toLowerCase()),val=node.html(),type=node.attr("type");switch(type){case"json":try{val=$.parseJSON(val)}catch(e){}break;case"javascript":try{val=eval("(function($){ return "+$.trim(val)+" })("+$.globalNamespace+")")}catch(e){}break;case"text":val=node.text()}$.isNumeric(val)&&(val=parseFloat(val)),newOptions[key]=val}),self.update($.extend(!0,{},options,newOptions))}},loading:function(e){var t=self.element;if(void 0===e)return t.hasClass("loading");!1!==e?(!0===e&&(e=self.options.loading||""),$.isString(e)&&(t.addClass("loading"),self.dialogLoading.html(e))):t.removeClass("loading")},showLoader:function(e){var t=self.options.width,i=self.options.height,n=function(){return self.dialogLoader.show().css({width:self.dialogBody.outerWidth(!0),height:self.dialogBody.outerHeight(!0)}).position({my:"top left",at:"top left",of:self.options.dialogContent}),self.options.width=t,self.options.height=i,e&&e()};return self.ready?n():self.update($.extend({title:self.options.title,content:"",width:self.initOptions.body.css.minWidth,height:self.initOptions.body.css.minHeight,afterShow:n},self.options.loader))},hideLoader:function(){self.element.removeClass("loading"),self.dialogLoader.hide()},autoSize:function(){return"auto"==self.initOptions.css.width||"auto"==self.initOptions.css.height},finalizeContent:function(e){var t=self.options,i=t.content;if(self.element.css(t.css),self.dialogContent.css(t.body.css),!self.refreshing){if(null!==t.title&&self.dialogTitle.html(t.title),null!==i){var n=!$.isString(i)&&$(i).is("iframe");if(self.dialogBody.toggleClass("type-iframe",n),n){for(var o=i.parent()[0],a=0;o.childNodes.length>1;){var r=o.childNodes[a];r!==i[0]&&o.removeChild(r),a++}i.css({position:"relative",visibility:"visible"})}else{var s;e?(s=i,t.content=self.stripScript(s)):s=self.stripScript(i),self.dialogContent.html(s)}}return self.contentReady||self.finalizeButtons(),self.element}},stripScript:function(e){if(!$.isString(e))return e;var t=$($.parseHTML(e));return t.find("script").remove(),t},finalizeSize:function(e){var t=self.refElement,i=self.options,n=i.body,o=i.content,a=i.css,r=n.css;if(void 0===t?t=self.refElement=self.initElement.clone().removeClass("global").insertAfter(self.element):t.insertAfter(self.element),!e){refTitle=t.find(i.dialogTitle),refBody=t.find(i.dialogBody),refFooter=t.find(i.dialogFooter),refButtons=t.find(i.dialogButtons),t.css(self.initOptions.css).css({display:"block"}),refTitle.html(i.title),$.isEmptyObject(i.buttons)?refFooter.hide():(refFooter.show(),refButtons.append("<button>test</button>"));var s=!$.isString(o)&&$(o).is("iframe"),l=s?document.createElement("div"):self.stripScript(o);r.width=s&&"auto"==i.width?o.contents().width():i.width,r.height=s&&"auto"==i.height?o.contents().height():i.height,refBody.css(r).toggleClass("type-iframe",s).html(l);var c=refBody.width(),d=refBody.height();"border-box"!==refBody.css("boxSizing")&&(r.width=c,r.height=d),r.width<r.minWidth&&(r.width=r.minWidth),r.height<r.minHeight&&(r.height=r.minHeight);var u=i.offset,p=t.width(),f=t.height(),m=$(window).width()-u,h=$(window).height()-u,g=p>m,v=f>h;a.width=g?m:p,a.height=v?h:f,"auto"!==r.width&&(r.width-=p-a.width),r.width<=0&&(r.width="auto"),"auto"!==r.height&&(r.height-=f-a.height),r.height<=0&&(r.height="auto"),r.minWidth=r.minHeight="auto",refBody.css(r),r.overflowX=!g||s||refBody[0].scrollWidth<=r.width?"auto":"scroll",r.overflowY=!v||s||refBody[0].scrollHeight<=r.height?"auto":"scroll",refBody.html("")}t.css(a).css("visibility","hidden").position(i.position),a.top=t.css("top"),a.left=t.css("left")},finalizeButtons:function(){var e=self.dialogFooter,t=self.dialogButtons;t.empty();var i=self.options.buttons;$.isEmptyObject(i)?e.hide():($.isString(i)&&t.html(i),$.isArray(i)&&$.each(i,function(e,i){var n=$.extend({},i),o=i.classNames?i.classNames:"";delete n.name,delete n.classNames,$(document.createElement("button")).attr("type","button").addClass(o).html(i.name).bind(n).appendTo(t)}),e.show())},show:function(e){if(!self.ready||!self.resizing){var t=self.options;self.refElement&&self.refElement.remove(),self.contentReady||t.beforeShow.apply(self),$(document).off("keydown.foundry.dialog"),t.escapeKey&&$(document).on("keydown.foundry.dialog",function(e){27==e.keyCode&&self.close()}),self.resizing=!0,self.finalizeSize(),self.element.addClass("resizing"),$(window).trigger("dialogTransitionStart"),self.transition[t.transition.show].show.apply(self,[function(){self.ready||(self.on("resize.dialog scroll.dialog",window,$._.debounce(function(){self.refresh()},150)),self.ready=!0),self.contentReady||(e&&e.apply(self),t.afterShow.apply(self)),self.refElement.detach(),self.element.removeClass("resizing"),self.contentReady=!0,self.element.css({width:"auto",height:"auto"}),self.removePlugin("binder");var i=t.selectors,n=t.bindings;if(i&&n){var o=$.Controller($.uid("dialogBinder"),{defaultOptions:i},function(e){return n});self.addPlugin("binder",o)}self.displayQueue.length>0?setTimeout(function(){self.resizing=!1,self.display(self.displayQueue.shift())},500):(self.resizing=!1,$(window).trigger("dialogTransitionEnd"))}])}},"{self} removePlugin":function(e,t,i,n){void 0!==n&&delete $.Controller[n.Class.fullName]},hide:function(e){self.contentReady||self.options.beforeHide.apply(self),$(window).trigger("dialogTransitionStart"),self.transition[self.options.transition.hide].hide.apply(self,[function(){e&&e.apply(self),self.options.afterHide.apply(self),$(window).trigger("dialogTransitionEnd")}])},refresh:function(){self.closing||self.resizing||(self.finalizeSize(!0),self.resizing=!0,self.refreshing=!0,$(window).trigger("dialogTransitionStart"),self.transition[self.options.transition.show].show.apply(self,[function(){$(window).trigger("dialogTransitionEnd"),self.resizing=!1,self.refreshing=!1,self.element.css({width:"auto",height:"auto"})}]))},transition:{none:{show:function(e){self.ready||self.overlay.show(),self.element.finalizeContent().show(0,e)},hide:function(e){self.overlay.hide(),self.element.hide(0,e)}},fade:{show:function(e){if(self.ready||self.overlay.fadeOut(0).fadeIn("normal"),self.contentReady)return self.element.finalizeContent(),e&&e();self.element.fadeOut(self.contentReady?"fast":0,function(){self.element.finalizeContent().fadeIn("normal","easeInCubic",e)})},hide:function(e){self.overlay.fadeOut("normal","easeOutCubic"),self.element.fadeOut("normal","easeOutCubic",e)}},zoom:{show:function(e){var t=self.dialogBody,i=self.dialogFooter,n=self.options.css;self.ready||(self.overlay.fadeIn("fast"),self.element.finalizeContent().css({top:parseInt(n.top)+parseInt(n.height)/2,left:parseInt(n.left)+parseInt(n.width)/2,width:0,height:0})),self.contentReady||(t.css({opacity:0}),i.css({opacity:0})),self.element.animate({top:n.top,left:n.left,width:n.width,height:n.height},"normal","easeInCubic",function(){return self.element.finalizeContent(!0),t.css({opacity:1}),i.css({opacity:1}),e&&e()})},hide:function(e){var t=self.options.css;self.element.animate({top:parseInt(t.top)+parseInt(t.height)/2,left:parseInt(t.left)+parseInt(t.width)/2,width:0,height:0},"normal","easeOutCubic",function(){return self.overlay.fadeOut("fast"),e&&e()})}}},overlay:$("<div></div>"),createOverlay:function(){self.overlay.css(self.options.overlay.css).click(function(){self.close()}).appendTo("body")},closing:!1,close:function(){if(!self.closing)return self.closing=!0,$(document).off("keydown.foundry.dialog"),self.hide(function(){self.removePlugin("binder"),self.element.remove(),self.refElement&&self.refElement.remove()}),self},"{closeButton} click":function(){self.close()},content:function(){var e=self.dialogContent,t=e.find("> iframe");return t.length>0?t.contents():e},messageGroup:function(){var e=self.dialogBody,t=e.find("> [data-message-group]");return t.length<1&&(t=$("<div data-message-group></div>").prependTo(e)),t}}}),$.dialog=function(e){if(window.parentDialog)return window.parentDialog.update(e);var t=$(".foundryDialog.global"),i=t.controllers("dialog")[0];if(arguments.length<1&&i)return i;if(t.length<1&&(t=$($.View("dialog/default")).addClass("global").addClass(e.customClass).appendTo("body")),"string"==typeof e||$.isDeferred(e)){var n=arguments[1];e={content:e,afterShow:$.isFunction(n)?n:$.noop}}return i?i.update(e):i=t.addController("Dialog",e),i}};exports(),module.resolveWith(exports)})};FD40.module("dialog",moduleFactory)}(),function(){var e=function(e){var t=this,i=e,n=function(){i.easing.jswing=i.easing.swing,i.extend(i.easing,{def:"easeOutQuad",swing:function(e,t,n,o,a){return i.easing[i.easing.def](e,t,n,o,a)},easeInQuad:function(e,t,i,n,o){return n*(t/=o)*t+i},easeOutQuad:function(e,t,i,n,o){return-n*(t/=o)*(t-2)+i},easeInOutQuad:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t+i:-n/2*(--t*(t-2)-1)+i},easeInCubic:function(e,t,i,n,o){return n*(t/=o)*t*t+i},easeOutCubic:function(e,t,i,n,o){return n*((t=t/o-1)*t*t+1)+i},easeInOutCubic:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t+i:n/2*((t-=2)*t*t+2)+i},easeInQuart:function(e,t,i,n,o){return n*(t/=o)*t*t*t+i},easeOutQuart:function(e,t,i,n,o){return-n*((t=t/o-1)*t*t*t-1)+i},easeInOutQuart:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t*t+i:-n/2*((t-=2)*t*t*t-2)+i},easeInQuint:function(e,t,i,n,o){return n*(t/=o)*t*t*t*t+i},easeOutQuint:function(e,t,i,n,o){return n*((t=t/o-1)*t*t*t*t+1)+i},easeInOutQuint:function(e,t,i,n,o){return(t/=o/2)<1?n/2*t*t*t*t*t+i:n/2*((t-=2)*t*t*t*t+2)+i},easeInSine:function(e,t,i,n,o){return-n*Math.cos(t/o*(Math.PI/2))+n+i},easeOutSine:function(e,t,i,n,o){return n*Math.sin(t/o*(Math.PI/2))+i},easeInOutSine:function(e,t,i,n,o){return-n/2*(Math.cos(Math.PI*t/o)-1)+i},easeInExpo:function(e,t,i,n,o){return 0==t?i:n*Math.pow(2,10*(t/o-1))+i},easeOutExpo:function(e,t,i,n,o){return t==o?i+n:n*(1-Math.pow(2,-10*t/o))+i},easeInOutExpo:function(e,t,i,n,o){return 0==t?i:t==o?i+n:(t/=o/2)<1?n/2*Math.pow(2,10*(t-1))+i:n/2*(2-Math.pow(2,-10*--t))+i},easeInCirc:function(e,t,i,n,o){return-n*(Math.sqrt(1-(t/=o)*t)-1)+i},easeOutCirc:function(e,t,i,n,o){return n*Math.sqrt(1-(t=t/o-1)*t)+i},easeInOutCirc:function(e,t,i,n,o){return(t/=o/2)<1?-n/2*(Math.sqrt(1-t*t)-1)+i:n/2*(Math.sqrt(1-(t-=2)*t)+1)+i},easeInElastic:function(e,t,i,n,o){var a=1.70158,r=0,s=n;if(0==t)return i;if(1==(t/=o))return i+n;if(r||(r=.3*o),s<Math.abs(n)){s=n;a=r/4}else a=r/(2*Math.PI)*Math.asin(n/s);return-s*Math.pow(2,10*(t-=1))*Math.sin((t*o-a)*(2*Math.PI)/r)+i},easeOutElastic:function(e,t,i,n,o){var a=1.70158,r=0,s=n;if(0==t)return i;if(1==(t/=o))return i+n;if(r||(r=.3*o),s<Math.abs(n)){s=n;a=r/4}else a=r/(2*Math.PI)*Math.asin(n/s);return s*Math.pow(2,-10*t)*Math.sin((t*o-a)*(2*Math.PI)/r)+n+i},easeInOutElastic:function(e,t,i,n,o){var a=1.70158,r=0,s=n;if(0==t)return i;if(2==(t/=o/2))return i+n;if(r||(r=o*(.3*1.5)),s<Math.abs(n)){s=n;a=r/4}else a=r/(2*Math.PI)*Math.asin(n/s);return t<1?s*Math.pow(2,10*(t-=1))*Math.sin((t*o-a)*(2*Math.PI)/r)*-.5+i:s*Math.pow(2,-10*(t-=1))*Math.sin((t*o-a)*(2*Math.PI)/r)*.5+n+i},easeInBack:function(e,t,i,n,o,a){return void 0==a&&(a=1.70158),n*(t/=o)*t*((a+1)*t-a)+i},easeOutBack:function(e,t,i,n,o,a){return void 0==a&&(a=1.70158),n*((t=t/o-1)*t*((a+1)*t+a)+1)+i},easeInOutBack:function(e,t,i,n,o,a){return void 0==a&&(a=1.70158),(t/=o/2)<1?n/2*(t*t*((1+(a*=1.525))*t-a))+i:n/2*((t-=2)*t*((1+(a*=1.525))*t+a)+2)+i},easeInBounce:function(e,t,n,o,a){return o-i.easing.easeOutBounce(e,a-t,0,o,a)+n},easeOutBounce:function(e,t,i,n,o){return(t/=o)<1/2.75?n*(7.5625*t*t)+i:t<2/2.75?n*(7.5625*(t-=1.5/2.75)*t+.75)+i:t<2.5/2.75?n*(7.5625*(t-=2.25/2.75)*t+.9375)+i:n*(7.5625*(t-=2.625/2.75)*t+.984375)+i},easeInOutBounce:function(e,t,n,o,a){return t<a/2?.5*i.easing.easeInBounce(e,2*t,0,o,a)+n:.5*i.easing.easeOutBounce(e,2*t-a,0,o,a)+.5*o+n}})};n(),t.resolveWith(n)};FD40.module("easing",e)}(),function(){var e=function(e){var t=this,i=e,n=function(){!function(e){e.gritter={},e.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1e3,time:6e3},e.gritter.add=function(e){try{return t.add(e||{})}catch(t){var i="Gritter Error: "+t;"undefined"!=typeof console&&console.error?console.error(i,e):alert(i)}},e.gritter.remove=function(e,i){t.removeSpecific(e,i||{})},e.gritter.removeAll=function(e){t.stop(e||{})};var t={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<a class="gritter-close" href="#" tabindex="1">Close Notification</a>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none" role="alert"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(i){if("string"==typeof i&&(i={text:i}),null===i.text)throw'You must supply "text" parameter.';this._is_setup||this._runSetup();var n=i.title,o=i.text,a=i.image||"",r=i.sticky||!1,s=i.class_name||e.gritter.options.class_name,l=e.gritter.options.position,c=i.time||"";this._verifyWrapper();var d=++this._item_count,u=this._tpl_item;e(["before_open","after_open","before_close","after_close"]).each(function(n,o){t["_"+o+"_"+d]=e.isFunction(i[o])?i[o]:function(){}}),this._custom_timer=0,c&&(this._custom_timer=c);var p=""!=a?'<img src="'+a+'" class="gritter-image" />':"",f=""!=a?"gritter-with-image":"gritter-without-image";if(n=n?this._str_replace("[[title]]",n,this._tpl_title):"",u=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[n,o,this._tpl_close,p,this._item_count,f,s],u),!1===this["_before_open_"+d]())return!1;e("#gritter-notice-wrapper").addClass(l).append(u);var m=e("#gritter-item-"+this._item_count);return m.fadeIn(this.fade_in_speed,function(){t["_after_open_"+d](e(this))}),r||this._setFadeTimer(m,d),e(m).bind("mouseenter mouseleave",function(i){"mouseenter"==i.type?r||t._restoreItemIfFading(e(this),d):r||t._setFadeTimer(e(this),d),t._hoverState(e(this),i.type)}),e(m).find(".gritter-close").click(function(){return t.removeSpecific(d,{},null,!0),!1}),d},_countRemoveWrapper:function(t,i,n){i.remove(),this["_after_close_"+t](i,n),0==e(".gritter-item-wrapper").length&&e("#gritter-notice-wrapper").remove()},_fade:function(e,i,n,o){var a=void 0===(n=n||{}).fade||n.fade,r=n.speed||this.fade_out_speed,s=o;this["_before_close_"+i](e,s),o&&e.unbind("mouseenter mouseleave"),a?e.animate({opacity:0},r,function(){e.animate({height:0},300,function(){t._countRemoveWrapper(i,e,s)})}):this._countRemoveWrapper(i,e)},_hoverState:function(e,t){"mouseenter"==t?(e.addClass("hover"),e.find(".gritter-close").show()):(e.removeClass("hover"),e.find(".gritter-close").hide())},removeSpecific:function(t,i,n,o){if(!n)var n=e("#gritter-item-"+t);this._fade(n,t,i||{},o)},_restoreItemIfFading:function(e,t){clearTimeout(this["_int_id_"+t]),e.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in e.gritter.options)this[opt]=e.gritter.options[opt];this._is_setup=1},_setFadeTimer:function(e,i){var n=this._custom_timer?this._custom_timer:this.time;this["_int_id_"+i]=setTimeout(function(){t._fade(e,i)},n)},stop:function(t){var i=e.isFunction(t.before_close)?t.before_close:function(){},n=e.isFunction(t.after_close)?t.after_close:function(){},o=e("#gritter-notice-wrapper");i(o),o.fadeOut(function(){e(this).remove(),n()})},_str_replace:function(e,t,i,n){var o=0,a=0,r="",s="",l=0,c=0,d=[].concat(e),u=[].concat(t),p=i,f=u instanceof Array,m=p instanceof Array;for(p=[].concat(p),n&&(this.window[n]=0),o=0,l=p.length;o<l;o++)if(""!==p[o])for(a=0,c=d.length;a<c;a++)r=p[o]+"",s=f?void 0!==u[a]?u[a]:"":u[0],p[o]=r.split(d[a]).join(s),n&&p[o]!==r&&(this.window[n]+=(r.length-p[o].length)/d[a].length);return m?p:p[0]},_verifyWrapper:function(){e("body > [id=fd].gritter").length<1&&e(document.createElement("div")).attr("id","fd").addClass("gritter").css({position:"absolute",top:0,left:0,overflow:"visible",width:0,height:0,zIndex:10003}).appendTo("body"),0==e("#gritter-notice-wrapper").length&&e("[id=fd].gritter").append(this._tpl_wrap)}}}(i)};n(),t.resolveWith(n)};FD40.module("gritter",e)}()}),FD40.installer("EasySocial","definitions",function(e){e.module(["easysocial/admin","easysocial/admin/sidebar/sidebar","easysocial/admin/access/discover","easysocial/progress/progress","easysocial/admin/alerts/discover","easysocial/admin/badges/discover","easysocial/admin/events/users","easysocial/admin/grid/grid","easysocial/admin/grid/sort","easysocial/admin/grid/publishing","easysocial/admin/grid/ordering","easysocial/admin/groups/groups","easysocial/admin/groups/users","easysocial/admin/indexer/indexer","easysocial/admin/mailer/mailer","easysocial/admin/maintenance/database","easysocial/admin/maintenance/maintenance","easysocial/admin/migrators/migrator","easysocial/admin/points/discover","easysocial/admin/privacy/discover","easysocial/admin/profiles/avatar","easysocial/uploader/uploader","easysocial/uploader/queue","easysocial/admin/profiles/fields","easysocial/field","easysocial/admin/profiles/members","easysocial/admin/profiles/profile","easysocial/utilities/alias","easysocial/admin/profiles/profiles","easysocial/admin/regions/form","easysocial/admin/regions/init","easysocial/admin/reports/reporters","easysocial/admin/reports/reports","easysocial/admin/themes/compiler","easysocial/admin/users/form","easysocial/admin/users/privacy","easysocial/admin/users/users","easysocial/admin/widgets/news","easysocial/albums/album","easysocial/albums/browser","easysocial/albums/editor","easysocial/albums/editor/sortable","easysocial/albums/editor/uploader","easysocial/albums/uploader","easysocial/albums/uploader.item","easysocial/albums/item","easysocial/apps/event/discussions","easysocial/apps/event/guests","easysocial/apps/event/tasks","easysocial/apps/fields/event/permalink/content","easysocial/apps/fields/event/permalink/sample_content","easysocial/apps/fields/event/recurring/content","easysocial/apps/fields/event/startend/content","easysocial/apps/fields/event/startend/display","easysocial/apps/fields/group/permalink/content","easysocial/apps/fields/group/permalink/sample_content","easysocial/apps/fields/user/address/content","easysocial/apps/fields/user/address/display_content","easysocial/apps/fields/user/address/maps","easysocial/apps/fields/user/avatar/content","easysocial/apps/fields/user/avatar/sample_content","easysocial/apps/fields/user/checkbox/content","easysocial/apps/fields/user/checkbox/sample_content","easysocial/apps/fields/user/country/content","easysocial/apps/fields/user/country/sample_content","easysocial/apps/fields/user/cover/content","easysocial/apps/fields/user/currency/sample_content","easysocial/apps/fields/user/datetime/content","easysocial/apps/fields/user/datetime/display_content","easysocial/apps/fields/user/datetime/dropdown","easysocial/apps/fields/user/datetime/sample_content","easysocial/apps/fields/user/dropdown/content","easysocial/apps/fields/user/email/content","easysocial/apps/fields/user/file/content","easysocial/apps/fields/user/file/sample_content","easysocial/apps/fields/user/gender/content","easysocial/apps/fields/user/joomla_email/content","easysocial/apps/fields/user/joomla_email/registermini_content","easysocial/apps/fields/user/joomla_email/sample_content","easysocial/apps/fields/user/joomla_fullname/content","easysocial/apps/fields/user/joomla_fullname/sample_content","easysocial/apps/fields/user/joomla_password/content","easysocial/apps/fields/user/joomla_password/registermini_content","easysocial/apps/fields/user/joomla_password/sample_content","easysocial/apps/fields/user/joomla_timezone/content","easysocial/apps/fields/user/joomla_username/content","easysocial/apps/fields/user/joomla_username/registermini_content","easysocial/apps/fields/user/joomla_username/sample_content","easysocial/apps/fields/user/multidropdown/content","easysocial/apps/fields/user/multilist/content","easysocial/apps/fields/user/multitextbox/content","easysocial/apps/fields/user/permalink/content","easysocial/apps/fields/user/permalink/sample_content","easysocial/apps/fields/user/relationship/content","easysocial/site/friends/suggest","easysocial/apps/fields/user/separator/sample","easysocial/apps/fields/user/terms/content","easysocial/apps/fields/user/textarea/content","easysocial/apps/fields/user/textbox/content","easysocial/apps/fields/user/textbox/sample_content","easysocial/apps/fields/user/url/content","easysocial/apps/fields/user/url/sample_content","easysocial/apps/group/feeds","easysocial/apps/group/tasks","easysocial/avatar","easysocial/cover","easysocial/easysocial","easysocial/site/likes/likes","easysocial/site/reports/reports","easysocial/site/blocks/blocks","easysocial/site/repost/repost","easysocial/site/share/share","easysocial/site/layout/dialog","easysocial/site/layout/responsive","easysocial/site/layout/elements","easysocial/site/photos/photos","easysocial/site/photos/popup","easysocial/site/photos/dialog","easysocial/site/photos/avatar","easysocial/site/users/login","easysocial/site/dashboard/dashboard.guest.login","easysocial/validate","easysocial/site/profile/popbox","easysocial/site/conversations/composer","easysocial/site/privacy/privacy","easysocial/site/locations/popbox","easysocial/site/sidebar/sidebar","easysocial/site/friends/api","easysocial/site/popbox/popbox","easysocial/site/conversations/api","easysocial/site/followers/api","easysocial/site/stream/video","easysocial/oauth/facebook","easysocial/locations","easysocial/pagination","easysocial/photos/avatar","easysocial/photos/browser","easysocial/photos/editor","easysocial/photos/item","easysocial/photos/tags","easysocial/photos/tagger","easysocial/photos/navigation","easysocial/prism","easysocial/privacy","easysocial/sharing","easysocial/site/activities/activities","easysocial/site/activities/sidebar","easysocial/site/activities/sidebar.item","easysocial/site/activities/apps","easysocial/site/activities/item","easysocial/site/activities/list","easysocial/site/albums/all","easysocial/site/apps/apps","easysocial/site/badges/badge","easysocial/site/comments/control","easysocial/site/comments/frame","easysocial/site/comments/item","easysocial/site/conversations/conversations","easysocial/site/conversations/mailbox","easysocial/site/conversations/item","easysocial/site/conversations/filter","easysocial/site/conversations/read","easysocial/site/dashboard/apps","easysocial/site/dashboard/dashboard","easysocial/site/dashboard/feeds","easysocial/site/dashboard/sidebar","easysocial/site/stream/filter","easysocial/site/stream/sidebar","easysocial/site/dashboard/groups","easysocial/site/dashboard/events","easysocial/site/events/browser","easysocial/site/events/guestState","easysocial/site/events/create","easysocial/site/events/edit","easysocial/site/events/item","easysocial/site/explorer","easysocial/site/explorer/uploader","easysocial/site/explorer/popup","easysocial/site/followers/followers","easysocial/site/friends/friends","easysocial/site/friends/list","easysocial/site/friends/item","easysocial/site/groups/groups","easysocial/site/groups/item","easysocial/site/notifications/list","easysocial/site/points/history","easysocial/site/profile/about","easysocial/site/profile/edit","easysocial/site/profile/friends","easysocial/site/profile/header","easysocial/site/profile/subscriptions","easysocial/site/profile/miniheader","easysocial/site/profile/notifications","easysocial/site/profile/privacy","easysocial/site/profile/profile","easysocial/site/registrations/registrations","easysocial/site/search/advanced.criteria","easysocial/site/search/map","easysocial/site/search/advanced","easysocial/site/search/advanced.list","easysocial/site/search/item","easysocial/site/search/dating","easysocial/site/search/list","easysocial/site/search/search","easysocial/site/search/sidebar","easysocial/site/search/toolbar","easysocial/site/stream/item","easysocial/site/stream/stream","easysocial/site/subscriptions/follow","easysocial/site/system/broadcast","easysocial/site/toolbar/conversations","easysocial/site/toolbar/friends","easysocial/site/toolbar/login","easysocial/site/toolbar/notifications","easysocial/site/toolbar/story","easysocial/site/toolbar/system","easysocial/site/toolbar/profile","easysocial/site/users/popbox","easysocial/site/users/users","easysocial/story","easysocial/story/broadcast","easysocial/story/event","easysocial/story/files","easysocial/story/friends","easysocial/story/links","easysocial/story/locations","easysocial/story/mood","easysocial/story/photos","easysocial/story/tasks","easysocial/stream","easysocial/comment","easysocial/tab","easysocial/toggle","easysocial/uploader/item"]),e.require.template.loader(["easysocial/site/loading/small","easysocial/site/uploader/queue.item","easysocial/admin/profiles/form.fields.editorItem","easysocial/admin/profiles/form.fields.stepItem","easysocial/admin/profiles/form.fields.editorPage","easysocial/admin/profiles/form.fields.config","easysocial/admin/profiles/dialog.move.field","easysocial/admin/profiles/dialog.delete.profileavatar","easysocial/site/albums/browser.list.item","easysocial/site/albums/upload.item","easysocial/fields/user/checkbox/item","easysocial/site/friends/suggest.item","easysocial/site/friends/suggest.hint.search","easysocial/site/friends/suggest.hint.empty","easysocial/site/hashtags/suggest.item","easysocial/site/hashtags/suggest.hint.search","easysocial/site/hashtags/suggest.hint.empty","easysocial/site/dialog/default","easysocial/site/photos/popup","easysocial/site/location/story.suggestion","easysocial/site/photos/tags.item","easysocial/site/photos/tags.menu.item","easysocial/admin/profiles/form.privacy.custom.item","easysocial/site/activities/loadbutton","easysocial/site/explorer/popup","easysocial/site/friends/default.empty","easysocial/site/friends/list.assign","easysocial/site/registration/dialog.error","easysocial/site/advancedsearch/noresult","easysocial/site/search/loadbutton","easysocial/site/stream/loadbutton","easysocial/site/notifications/system.empty","easysocial/site/users/button.following","easysocial/apps/user/links/story/attachment.item","easysocial/apps/user/files/story/attachment.item","easysocial/apps/user/files/story/progress","easysocial/apps/group/tasks/story/attachment.item","easysocial/site/likes/item","easysocial/site/uploader/preview"]),e.require.language.loader(["COM_EASYSOCIAL_SCAN_COMPLETED","JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST","COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING","COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED","COM_EASYSOCIAL_INDEXER_REINDEX_RESTART","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_PAGE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_FIELD","COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS","COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES","COM_EASYSOCIAL_FIELDS_INVALID_VALUES","COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_ASSIGN_BUTTON","COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR","COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE","COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE","COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE","FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH","FIELDS_EVENT_PERMALINK_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED","FIELDS_USER_DATETIME_LOCAL_TIMEZONE","FIELDS_USER_DATETIME_TIMEZONE_CHECKING","PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_GROUP_PERMALINK_REQUIRED","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS1","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS2","PLG_FIELDS_ADDRESS_PLEASE_ENTER_CITY","PLG_FIELDS_ADDRESS_PLEASE_ENTER_STATE","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ZIP","PLG_FIELDS_ADDRESS_PLEASE_ENTER_COUNTRY","COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT","PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE","PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM","PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED","PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR","PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR","PLG_FIELDS_COVER_VALIDATION_REQUIRED","PLG_FIELDS_DATETIME_VALIDATION_INVALID_DATETIME_FORMAT","PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME","PLG_FIELDS_DATETIME_DAY","PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE","PLG_FIELDS_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT","PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED","COM_EASYSOCIAL_WORKING","PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING","PLG_FIELDS_JOOMLA_EMAIL_CHECKING","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT","PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT","PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG","PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE","PLG_FIELDS_JOOMLA_USERNAME_CHECKING","PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME","PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD","PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE","PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD","PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_PERMALINK_REQUIRED","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT","PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM","PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE","PLG_FIELDS_TERMS_VALIDATION_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT","PLG_FIELDS_URL_VALIDATION_EMPTY_URL","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_PUBLIC","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_MEMBER","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIENDS_OF_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_ONLY_ME","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_CUSTOM","COM_EASYSOCIAL_AT_LOCATION","COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_LOG_LOAD_PREVIOUS_STREAM_ITEMS","COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_LOADING","COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_DELETING","COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR","COM_EASYSOCIAL_LIKES_LIKE","COM_EASYSOCIAL_LIKES_UNLIKE","COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL","COM_EASYSOCIAL_COMMENTS_STATUS_SAVING","COM_EASYSOCIAL_COMMENTS_STATUS_SAVED","COM_EASYSOCIAL_NO_BUTTON","COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY","COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY","COM_EASYSOCIAL_EVENTS_GUEST_PENDING","COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION","COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME","COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL","COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE","COM_EASYSOCIAL_FRIENDS_CANCEL_REQUEST_DIALOG_CANCELLED","COM_EASYSOCIAL_FRIENDS_DIALOG_CANCEL_REQUEST","COM_EASYSOCIAL_YES_CANCEL_MY_REQUEST_BUTTON","COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE","COM_EASYSOCIAL_ADVANCED_SEARCH_ADDRESS_DISTANCE_NOTICE","COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE","COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS","COM_EASYSOCIAL_SUBSCRIPTION_INFO","COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED","COM_EASYSOCIAL_STREAM_META_JOINER","COM_EASYSOCIAL_STORY_SUBMIT_ERROR","COM_EASYSOCIAL_STORY_CONTENT_EMPTY","COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER","COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA","COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME","COM_EASYSOCIAL_STREAM_STORY_WITH","COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER","COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER","COM_EASYSOCIAL_AND","COM_EASYSOCIAL_MOOD_FEELING_CUSTOM","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBSCRIBE","COM_EASYSOCIAL_STREAM_DIALOG_FEED","COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"]),function(){var t=["easysocial/imgareaselect/default"],i=e.stylesheet({content:""})?"resolve":"reject";e.each(t,function(t,n){e.require.stylesheet.loader(n)[i]()})}()}),FD40.installer("EasySocial","scripts",function(e){EasySocial.module("admin",function(e){var t=this;EasySocial.require().library("uniform","chosen","flot").script("admin/sidebar/sidebar").done(function(e){e(".uniform, .check :checkbox, .radio :radio, input:file[data-uniform], .usergroups :checkbox").uniform(),e("[data-chosen]").chosen({disable_search:!0}),e("[data-chosen-search]").chosen({disable_search:!1}),e("[data-sidebar]").implement(EasySocial.Controller.Sidebar.Sidebar),e("[data-sidebar-menu-toggle]").on("click",function(){var t=e(this).parent("li"),i=t.find("ul");e(this).parent("li").hasClass("active")?(t.removeClass("active"),i.removeClass("in")):(t.addClass("active"),i.addClass("in"))}),t.resolve()})}),EasySocial.module("admin/sidebar/sidebar",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Sidebar.Sidebar",{defaultOptions:{intervalPendingUsers:5e3,"{versionNotice}":"[data-easysocial-version]","{usersBadge}":".menu-user > a .badge","{pendingUsersBadge}":".menu-user .menu-ies-vcard > .badge"}},function(t){return{init:function(){t.versionChecks(),t.checkPendingUsers()},versionChecks:function(){EasySocial.ajax("admin/controllers/easysocial/versionChecks").done(function(i,n,o,a){n&&(e("[data-es-version-header]").removeClass("latest").addClass("outdated"),e("[data-es-version-header]").find("[data-es-outdated]").data("local-version",o).data("online-version",a)),t.versionNotice().html(i).show()})},monitorPendingUsers:function(){if(EasySocial.debug){t.options.intervalVersionChecks;console.info("Start monitoring pending users with interval of "+t.options.intervalPendingUsers+" seconds.")}t.options.state=setTimeout(t.checkPendingUsers,t.options.intervalPendingUsers)},checkPendingUsers:function(){t.stopMonitorPendingUsers(),setTimeout(function(){EasySocial.ajax("admin/controllers/users/getTotalPending").done(function(e){e>0?(t.usersBadge().html(e),t.pendingUsersBadge().html(e)):t.usersBadge().html(""),t.monitorPendingUsers()})},t.options.intervalPendingUsers)},stopMonitorPendingUsers:function(){EasySocial.debug,clearTimeout(t.options.state)}}}),t.resolve()})}),EasySocial.module("admin/access/discover",function(e){var t=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(e){EasySocial.Controller("Access.Discover",{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-access-discovery-start]","{progressBar}":".discoverProgress","{results}":"[data-access-discovery-result]"}},function(t){return{init:function(){t.options.progressController=t.progressBar().addController(EasySocial.Controller.Progress)},reset:function(){t.results().html(""),t.options.progressController.reset()},addLog:function(i){e("<tr></tr>").append(e("<td></td>").html(i)).appendTo(t.results())},"{startButton} click":function(i){t.reset(),t.startButton().attr("disabled","disabled"),EasySocial.ajax("admin/controllers/access/scanFiles").done(function(i,n){t.reset(),t.options.files=i,t.options.files.length>0?(t.options.progressController.begin(t.options.files.length),t.addLog(n),t.startIterating()):(t.options.progressController.begin(1),t.options.progressController.completed("Discover Completed"),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})},startIterating:function(){var i=t.options.files.shift();EasySocial.ajax("admin/controllers/access/installFile",{file:i}).always(function(i){t.options.files.length>0?(t.options.progressController.touch("..."),t.addLog(i),t.startIterating()):(t.options.progressController.touch("..."),t.addLog(i),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})}}}),t.resolve()})}),EasySocial.module("progress/progress",function(e){var t=this;EasySocial.Controller("Progress",{defaultOptions:{current:0,eachWidth:null,total:null,progressClass:"progress progress-info progress-striped","{progressBar}":".bar","{progressResult}":".progress-result",view:{}}},function(e){return{init:function(){},reset:function(){e.options.current=0,e.eachWidth=null,e.total=null,e.progressBar().css("width","0%").html("")},begin:function(t){e.options.total=t,e.options.eachWidth=100/t,t>0&&e.element.addClass(e.options.progressClass).show()},touch:function(t){e.options.current+=e.options.eachWidth,e.options.current>100&&(e.options.current=100),e.progressBar().css("width",e.options.current+"%"),e.progressResult().html(Math.round(e.options.current)+"%")},completed:function(t){e.options.current=100,e.progressBar().css("width",e.options.current+"%"),e.progressResult().html(Math.round(e.options.current)+"%")}}}),t.resolve()}),EasySocial.module("admin/alerts/discover",function(e){var t=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(e){EasySocial.Controller("Alerts.Discover",{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-alerts-discovery-start]","{progressBar}":"[data-alerts-discovery-progress]","{results}":"[data-alerts-discovery-result]"}},function(t){return{init:function(){t.initProgressBar()},reset:function(){t.results().html(""),t.options.progressController.reset()},initProgressBar:function(){t.progressBar().implement(EasySocial.Controller.Progress),t.options.progressController=t.progressBar().controller()},addLog:function(i){e("<tr>").append(e("<td>").html(i)).appendTo(t.results())},startIterating:function(){var i=t.options.files.shift();EasySocial.ajax("admin/controllers/alerts/scan",{file:i}).always(function(i,n,o){t.options.files.length>0?(t.options.progressController.touch("..."),t.addLog(n),t.startIterating()):(t.options.progressController.touch("..."),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})},"{startButton} click":function(e){t.reset(),t.startButton().attr("disabled","disabled"),EasySocial.ajax("admin/controllers/alerts/discoverFiles",{}).done(function(e,i){t.reset(),t.options.files=e,t.options.files.length>0&&(t.options.progressController.begin(t.options.files.length),t.addLog(i),t.startIterating())})}}}),t.resolve()})}),EasySocial.module("admin/badges/discover",function(e){var t=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(e){EasySocial.Controller("Badges.Discover",{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-badgesDiscover-start]","{progressBar}":"[data-badgesDiscover-progress]","{results}":"[data-badgesDiscover-result]","{viewLog}":"[data-badgesDiscover-viewLog]"}},function(t){return{init:function(){t.initProgressBar(),t.initLogging()},reset:function(){t.results().html(""),t.initLogging(),t.options.progressController.reset()},initLogging:function(){t.viewLog().hide()},initProgressBar:function(){t.progressBar().implement(EasySocial.Controller.Progress),t.options.progressController=t.progressBar().controller()},addLog:function(i){e("<tr>").append(e("<td>").html(i)).appendTo(t.results())},startIterating:function(){var i=t.options.files.shift();EasySocial.ajax("admin/controllers/badges/scan",{file:i}).always(function(i,n){t.options.files.length>0?(t.options.progressController.touch("..."),t.addLog(n),t.startIterating()):(t.options.progressController.touch("..."),t.addLog(n),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.viewLog().show(),t.startButton().removeAttr("disabled"))})},"{startButton} click":function(i){t.reset(),t.startButton().attr("disabled","disabled"),EasySocial.ajax("admin/controllers/badges/discoverFiles",{}).done(function(i,n){t.options.files=i,t.options.files.length>0?(t.options.progressController.begin(t.options.files.length),t.addLog(n),t.startIterating()):(t.options.progressController.begin(1),t.options.progressController.completed("Discover Completed"),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})},"{viewLog} click":function(){t.results().toggle()}}}),t.resolve()})}),EasySocial.module("admin/events/users",function(e){var t=this;EasySocial.require().language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST").done(function(e){EasySocial.Controller("Events.Users",{defaultOptions:{eventid:null,"{inviteGuest}":"[data-event-invite-guest]","{removeGuest}":"[data-event-remove-guest]","{approveGuest}":"[data-event-approve-guest]","{promoteGuest}":"[data-event-promote-guest]","{demoteGuest}":"[data-event-demote-guest]"}},function(t){return{init:function(){},"{inviteGuest} click":function(e,i){var n={};window.inviteGuests=function(e){e.state?n[e.id]=e:delete n[e.id]};var o=function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/events/confirmInviteGuests",{guests:n,eventid:t.options.eventid}),bindings:{"{submitButton} click":function(){this.inviteGuestsForm().submit()}}})};EasySocial.dialog({content:EasySocial.ajax("admin/views/events/inviteGuests"),bindings:{"{submitButton} click":function(){o()}}})},"{removeGuest} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["removeGuests"])},"{approveGuest} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["approveGuests"])},"{promoteGuest} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["promoteGuests"])},"{demoteGuest} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["demoteGuests"])}}}),t.resolve()})}),EasySocial.module("admin/grid/grid",function(e){var t=this;EasySocial.require().script("admin/grid/sort","admin/grid/publishing").done(function(e){EasySocial.Controller("Grid",{defaultOptions:{"{sortColumns}":"[data-table-grid-sort]","{ordering}":"[data-table-grid-ordering]","{direction}":"[data-table-grid-direction]","{task}":"[data-table-grid-task]","{searchInput}":"[data-table-grid-search-input]","{search}":"[data-table-grid-search]","{resetSearch}":"[data-table-grid-search-reset]","{checkAll}":"[data-table-grid-checkall]","{checkboxes}":"[data-table-grid-id]","{publishItems}":"[data-table-grid-publishing]","{itemRow}":"tr","{boxChecked}":"[data-table-grid-box-checked]","{filters}":"[data-table-grid-filter]"}},function(t){return{init:function(){t.implementSortable(),t.implementPublishing()},"{filters} change":function(){t.setTask(""),t.submitForm()},"{search} click":function(){t.submitForm()},"{resetSearch} click":function(){t.searchInput().val(""),t.submitForm()},submitForm:function(){t.element.submit()},setTask:function(e){t.task().val(e)},setOrdering:function(e){t.ordering().val(e)},setDirection:function(e){t.direction().val(e)},setTotalChecked:function(e){t.boxChecked().val(e)},toggleSelectRow:function(t){var i=t.find("input[name=cid\\[\\]]");1==e(i).prop("checked")?e(i).prop("checked",!1):e(i).prop("checked",!0)},selectRow:function(t){var i=t.find("input[name=cid\\[\\]]");e(i).prop("checked",!0)},implementSortable:function(){t.sortColumns().implement(EasySocial.Controller.Grid.Sort,{"{parent}":t})},implementPublishing:function(){t.publishItems().implement(EasySocial.Controller.Grid.Publishing,{"{parent}":t})},"{checkAll} change":function(i,n){t.checkboxes().prop("checked",e(i).is(":checked"));var o=e(i).is(":checked")?t.checkboxes().length:0;t.setTotalChecked(o)}}}),t.resolve()})}),EasySocial.module("admin/grid/sort",function(e){var t=this;EasySocial.Controller("Grid.Sort",{defaultOptions:{items:"[data-grid-sort-item]"}},function(e){return{init:function(){},"{self} click":function(){var t=e.element.data("direction"),i=e.element.data("sort");e.parent.setOrdering(i),e.parent.setDirection(t),e.parent.setTask(""),e.parent.submitForm()}}}),t.resolve()}),EasySocial.module("admin/grid/publishing",function(e){var t=this;EasySocial.Controller("Grid.Publishing",{defaultOptions:{}},function(e){return{init:function(){},"{self} click":function(t){var i=e.element.parents("tr"),n=e.element.data("task");e.parent.selectRow(i),e.parent.setTask(n),e.parent.submitForm()}}}),t.resolve()}),EasySocial.module("admin/grid/ordering",function(e){var t=this;EasySocial.Controller("Grid.Ordering",{defaultOptions:{"{moveUp}":"[data-grid-order-up]","{moveDown}":"[data-grid-order-down]",row:null}},function(t){return{init:function(){t.options.row=t.element.parents("tr")},selectRow:function(){var i=t.options.row.find("input[name=cid\\[\\]]");e(i).prop("checked",!0)},"{moveUp} click":function(){t.selectRow(),e.Joomla("submitform",["moveUp"])},"{moveDown} click":function(){t.selectRow(),e.Joomla("submitform",["moveDown"])}}}),t.resolve()}),EasySocial.module("admin/groups/groups",function(e){var t=this;EasySocial.require().library("expanding").done(function(e){EasySocial.Controller("Groups.Pending.Item",{defaultOptions:{"{approve}":"[data-pending-approve]","{reject}":"[data-pending-reject]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{approve} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/approveGroup",{ids:e.options.id})})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/rejectGroup",{ids:e.options.id})})}}}),t.resolve()})}),EasySocial.module("admin/groups/users",function(e){var t=this;EasySocial.require().language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST").done(function(e){EasySocial.Controller("Groups.Users",{defaultOptions:{groupid:null,"{addMember}":"[data-group-add-member]","{removeMember}":"[data-group-remove-member]","{approveMember}":"[data-group-approve-member]","{promoteMember}":"[data-group-promote-member]","{demoteMember}":"[data-group-demote-member]"}},function(t){return{init:function(){},"{addMember} click":function(e,i){var n={};window.addMembers=function(e){e.state?n[e.id]=e:delete n[e.id]};var o=function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/confirmAddMembers",{members:n,groupid:t.options.groupid}),bindings:{"{submitButton} click":function(){this.addMembersForm().submit()}}})};EasySocial.dialog({content:EasySocial.ajax("admin/views/groups/addMembers"),bindings:{"{submitButton} click":function(){o()}}})},"{removeMember} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["removeMembers"])},"{approveMember} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["publishUser"])},"{promoteMember} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["promoteMembers"])},"{demoteMember} click":function(t,i){0==document.adminForm.boxchecked.value?alert(e.language("JLIB_HTML_PLEASE_MAKE_A_SELECTION_FROM_THE_LIST")):e.Joomla("submitform",["demoteMembers"])}}}),t.resolve()})}),EasySocial.module("admin/indexer/indexer",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING","COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED","COM_EASYSOCIAL_INDEXER_REINDEX_RESTART").view("site/loading/small").done(function(e){EasySocial.Controller("Indexer",{defaultOptions:{"{startButton}":"[data-start-button]","{indexerBar}":"[data-indexer-bar]","{indexerResult}":"[data-indexer-result]","{indexerMessage}":"[data-indexer-message]","{resultsButton}":"[data-results-button]",view:{loadingContent:"site/loading/small"}}},function(t){return{init:function(){},"{startButton} click":function(){t.runIndex(0),t.indexerMessage().html(e.language("COM_EASYSOCIAL_INDEXER_REINDEX_PROCESSING")),t.indexerMessage().show(),t.startButton().hide()},runIndex:function(e){EasySocial.ajax("admin/controllers/indexer/indexing",{max:e},{beforeSend:function(){}}).done(function(e,i){e<0&&(i="100"),t.updateProgress(i),e>=0&&t.runIndex(e)}).fail(function(e){t.setMessage(e)}).always(function(){})},updateProgress:function(i){t.indexerBar().css("width",i+"%"),t.indexerResult().html(i+"%"),100==i&&(t.indexerMessage().html(e.language("COM_EASYSOCIAL_INDEXER_REINDEX_FINISHED")),t.startButton().html(e.language("COM_EASYSOCIAL_INDEXER_REINDEX_RESTART")),t.startButton().show(),t.resultsButton().removeClass("hide"))}}}),t.resolve()})}),EasySocial.module("admin/mailer/mailer",function(e){var t=this;EasySocial.Controller("Mailer",{defaultOptions:{"{item}":"[data-mailer-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Mailer.Item)}}}),EasySocial.Controller("Mailer.Item",{defaultOptions:{"{preview}":"[data-mailer-item-preview]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{preview} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("admin/views/mailer/preview",{id:e.options.id})})}}}),t.resolve()}),EasySocial.module("admin/maintenance/database",function(e){var t=this;EasySocial.Controller("Maintenance.Database",{defaultOptions:{"{start}":"[data-start]","{progress}":"[data-progress]","{progressBox}":"[data-progress-box]","{progressBar}":"[data-progress-bar]","{progressPercentage}":"[data-progress-percentage]"}},function(e){return{init:function(){},"{start} click":function(t){t.hide(),e.progress().show(),e.process()},counter:0,versions:[],process:function(){e.getStats().done(function(t){e.versions=t,e.execute()})},getStats:function(){return EasySocial.ajax("admin/controllers/maintenance/getDatabaseStats")},execute:function(){if(void 0===e.versions[e.counter])return e.completed();EasySocial.ajax("admin/controllers/maintenance/synchronizeDatabase",{version:e.versions[e.counter]}).done(function(){e.counter++;var t=Math.floor(e.counter/e.versions.length*100)+"%";e.progressBar().css("width",t),e.progressPercentage().text(t),e.execute()})},completed:function(){e.progressBar().css("width","100%"),e.progressPercentage().text("100%"),e.progressBox().removeClass("progress-info").addClass("progress-success")}}}),e("[data-base]").addController("EasySocial.Controller.Maintenance.Database"),t.resolve()}),EasySocial.module("admin/maintenance/maintenance",function(e){var t=this;EasySocial.Controller("Maintenance.Execute",{defaultOptions:{"{row}":"[data-row]"}},function(e){return{init:function(){e.runscript()},counter:0,success:0,fail:0,runscript:function(){var t=e.row().eq(e.counter);if(0===t.length)return e.completed();var i=t.data("key");EasySocial.ajax("admin/controllers/maintenance/runscript",{key:i}).done(function(){e.setStatus(t,1),e.success++}).fail(function(){e.setStatus(t,0),e.fail++}).always(function(){e.counter++,e.runscript()})},completed:function(){e.fail<1&&(window.location="index.php?option=com_easysocial&view=maintenance&success="+e.success)},setStatus:function(e,t){var n=e.find("[data-status]"),o=e.find("[data-icon]"),a=["label-danger","label-success","label-warning"],r=["ies-warning-2","ies-checkmark","ies-wrench-3"];for(i=0;i<3;i++)n.toggleClass(a[i],t==i),o.toggleClass(r[i],t==i)}}}),t.resolve()}),EasySocial.module("admin/migrators/migrator",function(e){var t=this;EasySocial.require().script("progress/progress").done(function(e){EasySocial.Controller("Migrators.Migrator",{defaultOptions:{component:null,processState:0,progressController:null,mapping:null,updateconfig:0,"{initiateButton}":"[data-initiate-migration]","{progressBar}":".discoverProgress","{results}":".scannedResult","{viewLog}":".viewLog","{customFieldsMap}":"[data-custom-fields-map]","{resultForm}":"[data-migration-result]","{startWidget}":"[data-start-widget]","{fieldItem}":"[data-field-item]","{startMigrationButton}":"[data-start-migration]","{rows}":"[data-row-item]","{selection}":"[data-field-item]","{jomsocialBackButton}":"[data-jomsocial-back-button]"}},function(t){return{init:function(){t.initProgressBar(),t.initLogging()},showCustomFields:function(){t.startWidget().slideUp(),t.customFieldsMap().slideDown()},showResultForm:function(){t.customFieldsMap().slideUp(),"com_community"!=t.options.component&&t.startWidget().slideUp(),t.resultForm().slideDown()},startMigration:function(){t.showResultForm(),1!=t.options.processState&&(t.options.processState=1,t.reset(),EasySocial.ajax("admin/controllers/migrators/check",{component:t.options.component}).done(function(e){e.isvalid?(t.options.progressController.begin(e.count),t.startIterating("")):(t.results().show(),t.addLog("Error: "+e.message),t.options.processState=0)}))},reset:function(){t.results().html(""),t.initLogging(),t.options.progressController.reset()},initLogging:function(){t.viewLog().hide()},initProgressBar:function(){t.progressBar().implement(EasySocial.Controller.Progress),t.options.progressController=t.progressBar().controller()},addLog:function(i){e("<li>").html(i).appendTo(t.results())},startIterating:function(i){null==t.options.mapping&&t.selection().length>0&&(t.options.mapping=e("#adminForm").serializeArray()),EasySocial.ajax("admin/controllers/migrators/process",{component:t.options.component,item:i,mapping:t.options.mapping,updateconfig:t.options.updateconfig}).always(function(e,i){t.options.updateconfig=i,e.continue?(t.options.progressController.touch("Discovering..."),t.addLog(e.message),t.startIterating(e.item)):(t.options.progressController.touch("Discover Completed"),t.addLog(e.message),t.addLog("migration process completed."),t.viewLog().show(),t.jomsocialBackButton().show(),t.options.processState=0)})},"{fieldItem} change":function(t){""==e(t).val()?e(t).parents("[data-row-item]").removeClass("success").addClass("error"):e(t).parents("[data-row-item]").removeClass("error").addClass("success")},"{startMigrationButton} click":function(){t.selection().length>0&&t.selection().each(function(t,i){""==e(i).val()?e(i).parents("[data-row-item]").removeClass("success").addClass("error"):e(i).parents("[data-row-item]").removeClass("error").addClass("success")}),t.rows().hasClass("error")?EasySocial.dialog({content:EasySocial.ajax("admin/views/migrators/confirmMigration"),bindings:{"{submitButton} click":function(){t.startMigration(),EasySocial.dialog().close()}}}):t.startMigration()},"{initiateButton} click":function(e){t.showCustomFields()},"{viewLog} click":function(){t.results().toggle()}}}),t.resolve()})}),EasySocial.module("admin/points/discover",function(e){var t=this;EasySocial.require().script("progress/progress").language("COM_EASYSOCIAL_SCAN_COMPLETED").done(function(e){EasySocial.Controller("Points.Discover",{defaultOptions:{files:[],progressController:null,"{startButton}":"[data-points-discovery-start]","{progressBar}":".discoverProgress","{results}":"[data-points-discovery-result]"}},function(t){return{init:function(){t.initProgressBar()},reset:function(){t.results().html(""),t.options.progressController.reset()},initProgressBar:function(){t.progressBar().implement(EasySocial.Controller.Progress),t.options.progressController=t.progressBar().controller()},addLog:function(i){e("<tr>").append(e("<td>").html(i)).appendTo(t.results())},startIterating:function(){var i=t.options.files.shift();EasySocial.ajax("admin/controllers/points/scan",{file:i}).always(function(i,n,o){t.options.files.length>0?(t.options.progressController.touch("..."),t.addLog(n),t.startIterating()):(t.options.progressController.touch("..."),t.addLog(n),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})},"{startButton} click":function(i){t.reset(),t.startButton().attr("disabled","disabled"),EasySocial.ajax("admin/controllers/points/discoverFiles",{}).done(function(i,n){t.reset(),t.options.files=i,t.options.files.length>0?(t.options.progressController.begin(t.options.files.length),t.addLog(n),t.startIterating()):(t.options.progressController.begin(1),t.options.progressController.completed("Discover Completed"),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})}}}),t.resolve()})}),EasySocial.module("admin/privacy/discover",function(e){var t=this;EasySocial.require().script("progress/progress").done(function(e){EasySocial.Controller("Privacy.Discover",{defaultOptions:{files:[],progressController:null,"{startButton}":".scanRules","{progressBar}":".discoverProgress","{results}":".scannedResult","{viewLog}":".viewLog",view:{}}},function(t){return{init:function(){t.initProgressBar(),t.initLogging()},reset:function(){t.results().html(""),t.initLogging(),t.options.progressController.reset()},initLogging:function(){t.viewLog().hide()},initProgressBar:function(){t.progressBar().implement(EasySocial.Controller.Progress),t.options.progressController=t.progressBar().controller()},addLog:function(i){e("<li>").html(i).appendTo(t.results())},startIterating:function(){var e=t.options.files.shift();EasySocial.ajax("admin/controllers/privacy/scan",{file:e}).always(function(e){t.options.files.length>0?(t.options.progressController.touch("Discovering..."),t.addLog("Scanned "+e.file+" : "+e.rules.length+" rules installed."),t.startIterating()):(t.options.progressController.touch("Discover Completed"),t.addLog("Scanned "+e.file+" : "+e.rules.length+" rules installed."),t.addLog("Scanning completed."),t.viewLog().show(),t.startButton().removeAttr("disabled"))})},"{startButton} click":function(i){t.reset(),t.startButton().attr("disabled","disabled"),EasySocial.ajax("admin/controllers/privacy/discoverFiles",{}).done(function(i){t.options.files=i,t.options.files.length>0?(t.options.progressController.begin(t.options.files.length),t.results().hide(),t.addLog("Found a total of "+i.length+" rules file in the site."),t.startIterating()):(t.options.progressController.begin(1),t.options.progressController.completed("Discover Completed"),t.addLog(e.language("COM_EASYSOCIAL_SCAN_COMPLETED")),t.startButton().removeAttr("disabled"))})},"{viewLog} click":function(){t.results().toggle()}}}),t.resolve()})}),EasySocial.module("admin/profiles/avatar",function(e){var t=this;EasySocial.require().script("uploader/uploader").done(function(){EasySocial.Controller("Profiles.Avatar",{defaultOptions:{token:null,"{fileUploader}":"[data-profile-avatars-uploader]","{startUploadButton}":"[data-profile-avatars-startupload]","{avatarList}":"[data-profile-avatars-list]","{avatarEmpty}":"[data-profile-avatars-empty]","{avatarItem}":"[data-profile-avatars-item]","{messagePlaceholder}":"[data-profile-avatars-message]","{removeFile}":".removeFile","{clearUploadedItems}":"[data-uploader-clear]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.initUploader(),t.initAvatar()},initUploader:function(){t.fileUploader().implement(EasySocial.Controller.Uploader,{url:e.indexUrl+"?option=com_easysocial&namespace=admin/controllers/profiles/uploadDefaultAvatars&"+t.options.token+"=1&tmpl=component&format=ajax&uid="+t.options.id})},initAvatar:function(){t.avatarItem().implement("EasySocial.Controller.Profiles.Avatar.Item",{"{parent}":t,items:t.avatarItem})},addMessage:function(e){t.clearMessage(),t.setMessage(e)},"{removeFile} click":function(i,n){var o=e(i).parents("li").attr("id");t.fileUploader().controller().removeItem(o)},"{startUploadButton} click":function(){t.fileUploader().controller().startUpload()},"{fileUploader} UploadProgress":function(t,i,n){var o=n.percent,a="#"+n.id,r=e(a).find(".progressBar");r.show(),r.find(".bar").css("width",o+"%")},"{fileUploader} FileUploaded":function(e,i,n,o){if(void 0!=o[0]){var a=o[0].data[0];t.avatarEmpty().hide(),t.avatarList().prepend(a),t.clearUploadedItems().show(),t.initAvatar()}},"{clearUploadedItems} click":function(){t.fileUploader().controller().reset(),t.clearUploadedItems().hide()}}}),EasySocial.Controller("Profiles.Avatar.Item",{defaultOptions:{id:null,"{deleteLink}":"[data-avatar-delete]","{setDefaultAvatar}":"[data-avatar-default]"}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{setDefaultAvatar} click":function(e,i){EasySocial.ajax("admin/controllers/avatars/setDefault",{id:t.options.id}).done(function(e){t.parent.avatarItem().removeClass("default"),t.element.addClass("default"),t.parent.addMessage(e)})},"{deleteLink} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/profiles/confirmDeleteAvatar"),bindings:{"{deleteButton} click":function(i,n){e(i).addClass("btn-loading"),EasySocial.ajax("admin/controllers/avatars/delete",{id:t.options.id}).done(function(e){t.element.remove(),0==t.parent.avatarList().children().length&&t.parent.avatarEmpty().show(),t.parent.addMessage(e),EasySocial.dialog().close()})}}})}}}),t.resolve()})}),EasySocial.module("uploader/uploader",function(e){var t=this;EasySocial.require().library("plupload").view("site/uploader/queue.item").script("uploader/queue").done(function(){EasySocial.Controller("Uploader",{defaults:{url:e.indexUrl+"?option=com_easysocial&controller=uploader&task=uploadTemporary&format=json&tmpl=component&"+EasySocial.token()+"=1",uploaded:[],query:"",plupload:"",dropArea:"uploaderDragDrop",extensionsAllowed:"jpg,jpeg,png,gif",temporaryUpload:!1,files:[],"{uploaderForm}":"[data-uploader-form]","{uploadButton}":"[data-uploader-browse]","{uploadArea}":".uploadArea","{queue}":"[data-uploaderQueue]","{queueItem}":"[data-uploaderQueue-item]","{emptyFiles}":"[data-uploader-empty]","{removeFile}":"[data-uploaderQueue-remove]","{uploadCounter}":".uploadCounter",view:{queueItem:"site/uploader/queue.item"}}},function(t){return{init:function(){t.queue().implement(EasySocial.Controller.Uploader.Queue),t.options.temporaryUpload&&(t.options.url=e.indexUrl+"?option=com_easysocial&controller=uploader&task=uploadTemporary&format=json&tmpl=component&"+EasySocial.token()+"=1"),""!=t.options.query&&(t.options.url=t.options.url+"&"+t.options.query),t.uploaderForm().implement("plupload",{settings:{url:t.options.url,drop_element:t.options.dropArea,filters:[{title:"Allowed File Type",extensions:t.options.extensionsAllowed}]},"{uploader}":"[data-uploader-form]","{uploadButton}":"[data-uploader-browse]"},function(){t.options.plupload=this.plupload})},"{uploaderForm} FilesAdded":function(e,i,n,o){t.addFiles(o),t.options.temporaryUpload&&t.startUpload()},"{uploaderForm} UploadProgress":function(e,i,n,o){t.queueItem("#"+o.id).trigger("UploadProgress",o)},"{uploaderForm} FileUploaded":function(e,i,n,o,a){t.queueItem("#"+o.id).trigger("FileUploaded",[o,a])},"{uploaderForm} UploadComplete":function(e,i,n,o){t.options.uploading=!1},"{uploaderForm} Error":function(e,i,n,o){t.clearMessage();var a={message:o.message,type:"error"};t.setMessage(a)},"{uploaderForm} FileError":function(e,i,n,o,a){var r={message:a.message,type:"error"};t.setMessage(r),t.queueItem("#"+o.id).trigger("FileError",[o,a])},addFiles:function(i){e.each(i,function(i,n){n.size=t.formatSize(n.size);var o=t.view.queueItem({file:n,temporaryUpload:t.options.temporaryUpload});e(o).implement(EasySocial.Controller.Uploader.Queue.Item,{"{uploader}":t}),t.options.files.push(n),t.emptyFiles().hide(),t.queue().append(o)})},formatSize:function(e){return parseInt(e/1024)},reset:function(){t.queueItem().remove()},removeItem:function(i){var n=e("#"+i),o=e(n).find("input[name=upload-id\\[\\]]").val();EasySocial.ajax("site/controllers/uploader/delete",{id:o}).done(function(){e("#"+i).remove(),t.options.plupload.removeFile(t.options.plupload.getFile(i))})},startUpload:function(){t.upload()},upload:function(){t.options.plupload.files.length>0&&(t.options.uploading=!0,t.options.plupload.start())},hasFiles:function(){return t.options.files.length>0}}}),t.resolve()})}),EasySocial.module("uploader/queue",function(e){var t=this;EasySocial.require().view("site/uploader/queue.item").done(function(e){EasySocial.Controller("Uploader.Queue",{defaults:{"{item}":"[data-uploaderQueue-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Uploader.Queue.Item)}}}),EasySocial.Controller("Uploader.Queue.Item",{defaultOptions:{"{delete}":"[data-uploaderQueue-remove]","{progress}":"[data-uploaderQueue-progress]","{progressBar}":"[data-uploaderQueue-progressBar]","{status}":"[data-uploaderQueue-status]","{id}":"[data-uploaderQueue-id]"}},function(t){return{init:function(){t.uploader.options.temporaryUpload&&(t.idTemplate=t.id().toHTML(),t.id().remove())},"{delete} click":function(){t.uploader.removeItem(t.element.attr("id"))},"{self} FileUploaded":function(i,n,o,a){t.uploader.options.temporaryUpload&&e.buildHTML(t.idTemplate).val(a.id).appendTo(t.element),5==o.status&&(t.element.addClass("is-done"),t.status().html("Done"))},"{self} UploadProgress":function(e,i,n){t.status().html(n.percent+"%"),t.progressBar().css("width",n.percent+"%")},"{self} FileError":function(){t.element.removeClass("is-done is-queue").addClass("is-error"),t.progress().removeClass("progress-danger progress-success progress-info progress-warning").addClass("progress-danger"),t.status().html("Error")}}}),t.resolve()})}),EasySocial.module("admin/profiles/fields",function(e){var t=this;EasySocial.require().library("ui/draggable","ui/sortable","ui/droppable").script("field").view("admin/profiles/form.fields.editorItem","admin/profiles/form.fields.stepItem","admin/profiles/form.fields.editorPage","admin/profiles/form.fields.config","admin/profiles/dialog.move.field").language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRM","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_PAGE","COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_FIELD","COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS","COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES","COM_EASYSOCIAL_FIELDS_INVALID_VALUES").done(function(){var i,n,o,a,r,s={},l={},c={},d={},u={},p={pages:[],fields:[]};EasySocial.Controller("Fields",{defaultOptions:{id:0,group:null,"{wrap}":"[data-fields-wrap]","{browser}":"[data-fields-browser]","{editor}":"[data-fields-editor]","{steps}":"[data-fields-steps]","{config}":"[data-fields-config]","{saveForm}":"[data-fields-save]",view:{config:"admin/profiles/form.fields.config"}}},function(t){return{init:function(){i=t,t.options.id=t.element.data("id"),n=t.addPlugin("browser"),o=t.addPlugin("editor"),a=t.addPlugin("steps");var r=[n.state,o.state,a.state];e.when.apply(null,r).done(function(){i.trigger("controllersReady")}),e(".profileForm").on("save",function(e,i,n){var o=t.save(i);n.push(o)})},changed:!1,customFieldChanged:function(){t.changed=!0},"{window} beforeunload":function(i,n){if(t.changed)return e.language("COM_EASYSOCIAL_FIELDS_UNSAVED_CHANGES")},"{saveForm} click":function(){t.save()},save:function(n){var s=e.Deferred();if(t.element.find("input,select").not(t.saveForm()).prop("disabled",!0),t.saveForm().val(""),"savecopy"===n&&(t.changed=!0),!t.changed)return s.resolve(),s;if(i.trigger("saving"),r&&r.state&&!r.checkConfig())return EasySocial.dialog({content:e.language("COM_EASYSOCIAL_FIELDS_INVALID_VALUES")}),s.reject(),s;c=e.extend(!0,{},l);var d=[];if(e.each(a.step(),function(t,i){i=e(i);var n=o.getPage(i.data("id"));d.push(n._export())}),e._.keys(c).length>0)return i.trigger("saved",[!1]),EasySocial.dialog({content:e.language("COM_EASYSOCIAL_FIELDS_REQUIRE_MANDATORY_FIELDS")}),s.reject(),s;i.changed=!1;var u={data:d,deleted:p};return t.injectSaveData(u),s.resolve(),s},injectSaveData:function(e){e=JSON.stringify(e),t.saveForm().val(e)},updateResult:function(t){e.each(t,function(e,t){var i=a.step().eq(e).data("id"),n=o.getPage(i);a.updateResult(e,t.id),n.updateResult(i,t)})},"{self} doneConfiguring":function(){t.element.removeClass("editting")},loadConfiguration:function(i,n){t.element.addClass("editting");var o=e(t.view.config());r=o.addController("EasySocial.Controller.Fields.Config",{controller:{item:i}}),"page"===n?i.pageHeader().append(o):i.element.append(o),t.element.trigger("loadingConfig",[n])}}}),EasySocial.Controller("Fields.Browser",{defaultOptions:{"{browser}":"[data-fields-browser]","{mandatory}":"[data-fields-browser-group-mandatory]","{unique}":"[data-fields-browser-group-unique]","{standard}":"[data-fields-browser-group-standard]","{list}":"[data-fields-browser-list]","{item}":"[data-fields-browser-item]",affixClass:"es-browser-affix"}},function(t){return{state:e.Deferred(),init:function(){t.registerApps(),t.ready(),t.affixHandler(),t.initAffix()},ready:function(){t.state.resolve()},"{parent} controllersReady":function(){var e=a.getCurrentStep().data("id");t.initDraggable(e)},"{parent} pageChanged":function(e,i,n,o){t.item().draggable("destroy"),t.initDraggable(o)},"{parent} pageAdded":function(e,i,n,o){t.item().draggable("destroy"),t.initDraggable(o)},initDraggable:function(e){t.item().draggable({revert:"invalid",helper:"clone",connectToSortable:"[data-fields-editor-page-items-"+e+"]"})},affixHandler:function(){var i=e(window),n=t.parent.wrap().offset().top,o=i.scrollTop();o>n&&!t.browser().hasClass(t.options.affixClass)&&t.browser().addClass(t.options.affixClass),o<=n&&t.browser().hasClass(t.options.affixClass)&&t.browser().removeClass(t.options.affixClass)},initAffix:function(){e(window).scroll(t.affixHandler)},registerApps:function(){e.each(t.item(),function(t,i){var n=(i=e(i)).data("id");s[n]={id:n,element:i.data("element"),title:i.data("title"),params:i.data("params"),core:i.data("core"),unique:i.data("unique"),item:i},i.data("core")&&(l[n]=s[n])})},checkout:function(e){void 0!==c[e]&&delete c[e]},"{item} click":function(e){var t=o.currentPage(),i=e.data("id");t.addNewField(i)},"{parent} fieldAdded":function(e,i,n){var o=s[n];if(o&&o.core){o.item.hide();a=t.mandatory().find(t.item.selector).filter(":visible");t.mandatory().toggle(a.length>0)}if(o&&o.unique){o.item.hide();var a=t.unique().find(t.item.selector).filter(":visible");t.unique().toggle(a.length>0)}},"{parent} fieldDeleted":function(e,i,n,o){var a=s[n];return a&&a.core?(a.item.show(),void t.mandatory().show()):a&&a.unique?(a.item.show(),void t.unique().show()):void 0}}}),EasySocial.Controller("Fields.Config",{defaultOptions:{"{config}":"[data-fields-config]","{header}":"[data-fields-config-header]","{close}":"[data-fields-config-close]","{form}":"[data-fields-config-form]","{param}":"[data-fields-config-param]","{tabnav}":"[data-fields-config-tab-nav]","{tabcontent}":"[data-fields-config-tab-content]","{done}":"[data-fields-config-done]"}},function(t){return{init:function(){},state:!1,load:function(n){if(t.state=!0,n.find("[data-fields-config-param-choices]").addController("EasySocial.Controller.Config.Choices",{controller:{item:t.item}}),n.find("h4").hide(),t.header().html(n.find("h4").html()),t.form().html(n),t.item.options.newfield&&t.param("[data-fields-config-param-field-unique_key]").attr("disabled",!0).val(e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_PARAMS_CORE_UNIQUE_KEY_SAVE_FIRST")),t.tabnav().length>0){var o=t.tabnav().find('a[data-tabname="core"]');o.length>0?o.tab("show"):t.tabnav().find("a:first").tab("show")}t.populateConfig();var a=t.element.height();i.wrap().css("padding-bottom",a+"px"),i.trigger("configLoaded")},"{close} click":function(e,i){t.closeConfig()},"{done} click":function(e,i){t.closeConfig()},closeConfig:function(){var n=t.populateConfig();t.checkConfig(n)?(t.item.updateHtml(t.form().html()),t.item.content().trigger("onConfigSave",[n]),t.element.remove(),r=null,i.trigger("doneConfiguring")):EasySocial.dialog({content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES"),width:400,height:100})},"{parent} loadingConfig":function(i,n,o){if(void 0!==o&&"field"!=o){var a=e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_CONFIGURE_"+o.toUpperCase());t.header().html(a)}t.config().show(),t.close().hide(),t.form().html(e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_ITEM_CONFIG_LOADING"))},"{parent} configLoaded":function(e,i){t.close().show()},"{param} change":function(e){t.paramChanged(e)},"{param} keyup":function(e){t.paramChanged(e)},paramChanged:function(e){var n=e.data("name"),o=t.getConfigValue(n);"boolean"===t.item.appParams[n].type&&(o=!!o),t.item.fieldItem().trigger("onConfigChange",[n,o]),i.customFieldChanged()},getConfigValue:function(i){var n=t.item.appParams[i],o=t.param().filterBy("name",i);if(0!==o.length){var a="";switch(n.type){case"choices":a=[],e.each(o.find("li"),function(t,i){var n=(i=e(i)).find("[data-fields-config-param-choice-title]"),o=i.find("[data-fields-config-param-choice-value]"),r=i.find("[data-fields-config-param-choice-default]");a.push({id:i.data("id"),title:n.val(),value:o.val(),default:r.val()}),n.attr("value",n.val()),o.attr("value",o.val()),r.attr("value",r.val())});break;case"boolean":var r=o.val();a="true"===r||"1"===r||1===r?1:0,o.attr("value",a);break;case"checkbox":a=[],e.each(n.option,function(e,t){var i=o.filter("[data-fields-config-param-option-"+t.value+"]");i.length>0&&i.is(":checked")?(a.push(t.value),i.attr("checked","checked")):i.removeAttr("checked")});break;case"list":case"select":case"dropdown":a=o.length>0?o.val():n.default||"",o.find("option").prop("selected",!1),o.find('option[value="'+a+'"]').prop("selected",!0);break;case"input":case"text":default:a=o.length>0?o.val():n.default||"",o.attr("value",a)}return a}},populateConfig:function(){var i={};return e.each(t.item.appParams,function(e,n){var o=t.getConfigValue(e);if(void 0===o)return!1;i[e]=o}),t.item.trigger("onPopulateConfig",[i]),i},checkConfig:function(i){void 0===i&&(i=t.populateConfig());var n=!0;return e.each(i,function(i,o){switch(t.item.appParams[i].type){case"choices":var a=[];e.each(o,function(t,i){if(e.isEmpty(i.value)&&!e.isEmpty(i.title)&&(i.value=i.title.toLowerCase().replace(" ","")),!e.isEmpty(i.value)&&e.inArray(i.value,a)>-1)return n=!1,!1;a.push(i.value)})}if(!1===n)return!1}),n},"{parent} fieldDeleted":function(){t.state&&i.trigger("doneConfiguring")},"{parent} pageDeleted":function(){t.state&&i.trigger("doneConfiguring")},"{parent} pageAdded":function(){t.state&&i.trigger("doneConfiguring")},"{parent} pageChanged":function(){t.state&&i.trigger("doneConfiguring")}}}),EasySocial.Controller("Fields.Steps",{defaultOptions:{"{steps}":"[data-fields-step]","{step}":"[data-fields-step-item]","{stepLink}":"[data-fields-step-item-link]","{add}":"[data-fields-step-add]",view:{stepItem:"admin/profiles/form.fields.stepItem"}}},function(t){return{state:e.Deferred(),init:function(){t.ready()},ready:function(){t.state.resolve()},"{parent} controllersReady":function(){t.initSort()},initSort:function(){t.steps().sortable({items:t.step.selector,placeholder:"ui-state-highlight",cursor:"move",helper:"clone",forceHelperSize:!0,stop:function(){e(".tooltip-es").remove(),i.customFieldChanged()}})},"{parent} pageDeleted":function(e,i,n){t.deleteStep(n),a.step().length>0&&a.stepLink(":first").tab("show")},"{step} click":function(e,t){if(!e.hasClass("active")){var n=e.data("id");i.trigger("pageChanged",[o.getPage(n),n])}},"{add} click":function(){var i=e.uid("step");t.addStep(i),o.addPage(i),t.stepLink(":last").tab("show")},addStep:function(e){t.add().before(t.view.stepItem({uid:e}))},getStep:function(e){return t.step().filterBy("id",e)},getStepLink:function(e){return t.stepLink().filterBy("id",e)},deleteStep:function(e){t.getStep(e).remove()},getCurrentStep:function(){return t.step(".active")},currentStepIndex:function(){return t.step().index(t.step(".active"))+1},updateResult:function(e,i){var n=t.step(":eq("+e+")");if(n.data("id")!=i){var o=n.data("id");n.removeAttr("data-fields-step-item-"+o),n.attr("data-fields-step-item-"+i,!0),n.data("id",i),n.attr("data-id",i);var a=t.stepLink().eq(e);a.removeAttr("data-fields-step-item-link-"+o),a.attr("data-fields-step-item-link-"+i,!0),a.attr("href","#formStep_"+i)}},toObject:function(){var i=[];return e.each(t.stepLink(),function(t,n){n=e(n),i.push({uid:n.data("id"),title:n.text(),description:n.attr("data-original-title")})}),i}}}),EasySocial.Controller("Fields.Editor",{defaultOptions:{"{editor}":"[data-fields-editor]","{page}":"[data-fields-editor-page]","{items}":"[data-fields-editor-page-items]","{item}":"[data-fields-editor-page-item]",view:{editorPage:"admin/profiles/form.fields.editorPage"}}},function(t){return{state:e.Deferred(),init:function(){t.ready()},ready:function(){t.state.resolve()},"{parent} controllersReady":function(){t.page().addController("EasySocial.Controller.Fields.Editor.Page")},currentPage:function(){return t.page(".active").controller()},addPage:function(e){var n=t.view.editorPage({uid:e});n.addController("EasySocial.Controller.Fields.Editor.Page",{uid:e,newpage:!0}),t.editor().append(n),t.page().trigger("pageAdded",[n,e]),i.customFieldChanged()},getPage:function(e){return t.page().filterBy("id",e).controller()},"{parent} saving":function(e,i){t.element.addClass("saving")},"{parent} saved":function(e,i,n){t.element.removeClass("saving")}}}),EasySocial.Controller("Fields.Editor.Page",{defaultOptions:{pageid:0,uid:0,newpage:!1,"{items}":"[data-fields-editor-page-items]","{item}":"[data-fields-editor-page-item]","{pageHeader}":"[data-fields-editor-page-header]","{content}":"[data-fields-editor-page-header]","{fieldItem}":"[data-fields-editor-page-header]","{pageTitle}":"[data-fields-editor-page-title]","{pageDescription}":"[data-fields-editor-page-description]","{inputTitle}":"[data-fields-editor-page-title-input]","{inputDescription}":"[data-fields-editor-page-description-input]","{pageVisibleRegistration}":"[data-fields-editor-page-visible-registration]","{pageVisibleEdit}":"[data-fields-editor-page-visible-edit]","{pageVisibleView}":"[data-fields-editor-page-visible-view]","{pageDelete}":"[data-fields-editor-page-delete]","{pageEdit}":"[data-fields-editor-page-edit]","{pageInfo}":"[data-fields-editor-page-info]","{pageInfoDone}":"[data-fields-editor-page-done]",view:{editorItem:"admin/profiles/form.fields.editorItem"}}},function(t){return{init:function(){t.options.newpage||(t.options.uid=t.options.pageid=t.element.data("id")),t.registerPage(),t.item().addController("EasySocial.Controller.Fields.Editor.Item",{pageid:t.options.uid}),t.checkPageDeleteButton(),t.initSort()},fields:{},getStep:function(){return a.getStep(t.options.uid)},registerPage:function(){u[t.options.uid]=t},initSort:function(){t.items().sortable({items:t.item.selector,handle:"[data-fields-editor-page-item-handle]",placeholder:"ui-state-highlight",cursor:"move",helper:"clone",forceHelperSize:!0,stop:function(e,o){if(o.item.is(n.item.selector)){var a=o.item.data("id"),r=t.createPlaceholder();o.item.replaceWith(r),t.createNewField(a,r)}i.customFieldChanged()}})},addNewField:function(n){var o=t.createPlaceholder();t.items().append(o),e.scrollTo(o,200),t.createNewField(n,o),i.customFieldChanged()},createPlaceholder:function(){var i=e.uid("newfield");return t.view.editorItem({uid:i})},createNewField:function(n,o){i.trigger("fieldAdded",[n]),t.getFieldHtml(n).done(function(i){i=e.parseHTML(i,document,!0),i=e(i),o.replaceWith(i),i.filter('[data-appid="'+n+'"]').addController("EasySocial.Controller.Fields.Editor.Item",{controller:{page:t},appid:n,pageid:t.options.uid,newfield:!0})}).fail(function(e){o.html(e)})},getFieldHtml:function(t){var n=e.Deferred();return void 0===s[t].html?EasySocial.ajax("admin/controllers/fields/renderSample",{appid:t,profileid:i.options.id,group:i.options.group}).done(function(e){s[t].html=e,n.resolve(e)}).fail(function(e){n.reject(e)}):n.resolve(s[t].html),n},"{pageHeader} click":function(i,n){if(e(n.target).not("[data-fields-editor-page-delete]")&&!i.hasClass("editting")){if(r&&r.state){if(!r.checkConfig())return void EasySocial.dialog({content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES"),width:400,height:100});r.closeConfig()}t.loadConfiguration()}},loadConfiguration:function(){i.loadConfiguration(t,"page"),t.pageHeader().addClass("editting"),t.getPageConfig().done(function(){var i=e(t.html);r.load(i)}).fail(function(e){r.load(e)})},updateHtml:function(e){t.html=e},getPageConfig:function(){var i=e.Deferred();return e.isEmptyObject(t.params)?EasySocial.ajax("admin/controllers/profiles/getPageConfig",{pageid:t.options.pageid}).done(function(e,n,o){t.params=e,t.values=n,t.html=o,t.appParams=e,i.resolve()}).fail(function(e){i.reject(e)}):i.resolve(),i},getConfigValues:function(){return t.values},"{fieldItem} onConfigChange":function(e,n,o,r){t.values[o]=r;var s=a.getStepLink(t.options.uid);"title"===o&&(s.text(r),t.pageTitle().html(r)),"description"===o&&(s.attr("data-original-title",r),t.pageDescription().html(r)),i.customFieldChanged()},"{pageDelete} click":function(i){if(i.enabled()){if(i.disabled(!0),1==o.page().length)return i.enabled(!0),!1;EasySocial.dialog({width:400,height:150,title:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_TITLE"),content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRMATION"),showOverlay:!1,buttons:[{name:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CANCEL"),classNames:"btn btn-es",click:function(){i.enabled(!0),EasySocial.dialog().close()}},{name:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM"),classNames:"btn btn-es-danger",click:function(){EasySocial.dialog().update({content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_DELETING")}),t.deletePage(),EasySocial.dialog().close()}}]})}},deletePage:function(){t.item().trigger("pageDeleted"),i.trigger("pageDeleted",[t.options.uid]),delete u[t.options.uid],t.options.newpage||p.pages.push(t.options.uid),t.element.remove(),e.each(o.page(),function(t,i){e(i).controller().checkPageDeleteButton()}),i.customFieldChanged()},_export:function(){var i=[];e.each(t.item(),function(t,n){void 0!==(n=e(n).controller())&&i.push(n._export())});n={fields:i,newpage:t.options.newpage,id:t.options.uid};if(void 0!==t.values)var n=e.extend(n,t.values);return n},updateResult:function(i,n){t.options.newpage&&(t.element.attr("id","formStep_"+n.id),t.element.removeAttr("data-fields-editor-page-"+i),t.element.attr("data-fields-editor-page-"+n.id,!0),t.options.pageid=t.options.uid=n.id,u[n.id]=e.extend(!0,{},u[i]),delete u[i],t.options.newpage=!1),void 0!==n.fields&&e.each(n.fields,function(e,i){t.item().eq(e).controller().updateResult(i)})},"{self} pageAdded":function(e,n,o){t.checkPageDeleteButton(),i.customFieldChanged()},checkPageDeleteButton:function(){o.page().length>1?t.pageDelete().show():t.pageDelete().hide()},"{parent} loadingConfig":function(){t.pageHeader().removeClass("editting"),t.item().removeClass("editting")},"{parent} doneConfiguring":function(){t.pageHeader().removeClass("editting"),t.item().removeClass("editting")}}}),EasySocial.Controller("Fields.Editor.Item",{defaultOptions:{appid:0,fieldid:0,pageid:0,newfield:!1,"{edit}":"[data-fields-editor-page-item-edit]","{deleteButton}":"[data-fields-editor-page-item-delete]","{moveButton}":"[data-fields-editor-page-item-move]","{content}":"[data-fields-editor-page-item-content]","{fieldItem}":"[data-field]","{config}":"[data-fields-config]","{closeConfig}":"[data-fields-config-close]",view:{moveDialog:"admin/profiles/dialog.move.field"}}},function(t){return{app:{},field:{id:0,appid:0,params:{}},state:e.Deferred(),appParams:{},init:function(){0==t.options.appid&&void 0!==t.element.data("appid")&&(t.options.appid=t.element.data("appid")),void 0!==s[t.options.appid]&&(t.app=s[t.options.appid]),0==t.options.fieldid&&void 0!==t.element.data("id")&&(t.options.fieldid=t.element.data("id")),t.registerFields(),t.uniqueid=e.uid(t.app.id+"_"),t.loadedInit()},registerFields:function(){0!=t.options.fieldid&&(d[t.options.fieldid]={id:t.options.fieldid,appid:t.options.appid,params:t.field.params||{}},t.field=d[t.options.fieldid])},loadedInit:function(){t.element.addController("EasySocial.Controller.Field.Base",{mode:"sample",element:t.app.element}),t.content().addController("EasySocial.Controller.Fields.Editor.Item.Config")},_export:function(){n.checkout(t.options.appid);var i={fieldid:t.options.fieldid,appid:t.options.appid,newfield:t.options.newfield};return i=e.extend(i,t.expandConfig(t.field.params))},"{self} click":function(i,n){var o=e(n.target);if(!(o.is(t.deleteButton.selector)||o.is(t.moveButton.selector)||o.is(t.config.selector)||o.is(t.closeConfig.selector)||i.hasClass("editting"))){if(r&&r.state){if(!r.checkConfig())return void EasySocial.dialog({content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_INVALID_VALUES"),width:400,height:100});r.closeConfig()}t.loadConfiguration()}},loadConfiguration:function(){i.loadConfiguration(t,"field"),t.element.addClass("editting"),t.getAppParams().done(function(){var i=e(t.field.html);r.load(i)}).fail(function(){})},updateHtml:function(e){t.field.html=e},getAppParams:function(){var i=e.Deferred();return t.field.html?i.resolve():EasySocial.ajax("admin/controllers/fields/renderConfiguration",{appid:t.options.appid,fieldid:t.options.fieldid}).done(function(e,n,o){t.app.params=e,t.field.params=n,t.field.html=o,t.populateAppParams(),i.resolve()}).fail(function(e){i.reject(e)}),i},populateAppParams:function(){e.each(t.app.params,function(i,n){e.each(n.fields,function(i,n){n.subfields?e.each(n.subfields,function(e,n){t.appParams[i+"_"+e]=n}):t.appParams[i]=n})})},getConfigValues:function(){return t.field.params},expandConfig:function(){var i={params:{},choices:{}};return e.each(t.field.params,function(e,n){var o=t.appParams[e];if(!o)return!1;var a="choices"==o.type?"choices":"params";i[a][e]=n}),t.options.newfield&&(i.params.unique_key=""),i},"{moveButton} click":function(n){var r=a.toObject(),s=n.parents(o.page.selector).data("id"),l=[];e.each(r,function(e,t){t.uid!=s&&l.push(t)}),EasySocial.dialog({content:t.view.moveDialog(!0,{pages:l}),selectors:{"{selection}":"[data-move-selection]","{confirmButton}":"[data-move-confirm]","{cancelButton}":"[data-move-cancel]"},bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()},"{confirmButton} click":function(){var e=this.selection().val();o.getPage(e).items().append(t.element),i.customFieldChanged(),EasySocial.dialog().close()}}})},"{deleteButton} click":function(i){i.enabled()&&(i.disabled(!0),EasySocial.dialog({width:400,height:150,title:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_TITLE"),content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CONFIRMATION"),showOverlay:!1,buttons:[{name:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_CANCEL"),classNames:"btn btn-es btn-sm",click:function(){i.enabled(!0),EasySocial.dialog().close()}},{name:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_PAGE_DIALOG_CONFIRM"),classNames:"btn btn-es-danger btn-sm",click:function(){EasySocial.dialog().update({content:e.language("COM_EASYSOCIAL_PROFILES_FORM_FIELDS_DELETE_ITEM_DIALOG_DELETING")}),t.deleteField(),EasySocial.dialog().close()}}]}))},deleteField:function(){i.trigger("fieldDeleted",[t.options.appid,t.options.fieldid]),t.options.newfield||(delete d[t.options.fieldid],p.fields.push(t.options.fieldid)),t.element.remove(),i.customFieldChanged()},"{self} pageDeleted":function(){t.deleteField()},"{content} onConfigChange":function(e,i,n,o){t.field.params[n]=o},"{self} onPopulateConfig":function(e,i,n){t.field.params=n},updateResult:function(i){t.field.params.unique_key=i.unique_key,t.itemParam("[data-fields-config-param-field-unique_key]").val(i.unique_key),t.options.newfield&&(t.options.newfield=!1,t.options.fieldid=i.fieldid,t.element.data("id",i.fieldid),t.itemParam("[data-fields-editor-page-item-param-field-unique_key]").removeAttr("disabled"),t.registerFields()),void 0!==i.choices&&e.each(i.choices,function(i,n){var o=t.itemParam("[data-fields-config-param-field-"+i+"]");e.each(n,function(e,t){var i=o.find("li").eq(e);i.data("id")||(i.attr("data-id",t.id),i.data("id",t.id))})})}}}),EasySocial.Controller("Config.Choices",{defaultOptions:{"{choiceItems}":"[data-fields-config-param-choice]",unique:1}},function(t){return{init:function(){t.options.unique=void 0!==t.element.data("unique")?t.element.data("unique"):1,t.choiceItems().implement(EasySocial.Controller.Config.Choices.Choice,{controller:{item:t.item,choices:t}}),t.initSortable()},initSortable:function(){t.element.sortable({items:t.choiceItems.selector,placeholder:"ui-state-highlight",cursor:"move",forceHelperSize:!0,handle:"[data-fields-config-param-choice-drag]",stop:function(){e(".tooltip-es").remove(),i.customFieldChanged()}})}}}),EasySocial.Controller("Config.Choices.Choice",{defaultOptions:{"{choiceValue}":"[data-fields-config-param-choice-value]","{choiceTitle}":"[data-fields-config-param-choice-title]","{choiceDefault}":"[data-fields-config-param-choice-default]","{addChoice}":"[data-fields-config-param-choice-add]","{removeChoice}":"[data-fields-config-param-choice-remove]","{setDefault}":"[data-fields-config-param-choice-setdefault]","{defaultIcon}":"[data-fields-config-param-choice-defaulticon]"}},function(t){return{init:function(){},"{choiceTitle} keyup":e._.debounce(function(e,n){var o=t.element.index();t.item.fieldItem().trigger("onChoiceTitleChanged",[o,e.val()]),i.customFieldChanged()},500),"{choiceValue} keyup":e._.debounce(function(e,n){var o=t.element.index();t.item.fieldItem().trigger("onChoiceValueChanged",[o,e.val()]),i.customFieldChanged()},500),"{addChoice} click":function(){var e=t.element.clone(),n=e.find('input[type="text"]');n.attr("value",""),n.val("");var o=e.find('input[type="hidden"]');o.attr("value",0),o.val(0),e.find("[data-fields-config-param-choice-defaulticon]").removeClass("es-state-featured").addClass("es-state-default"),e.attr("data-id",0),e.data("id",0),e.implement(EasySocial.Controller.Config.Choices.Choice,{controller:{item:t.item,choices:t.choices}}),t.element.after(e);var a=e.index();t.item.fieldItem().trigger("onChoiceAdded",[a]),i.customFieldChanged()},"{removeChoice} click":function(){if(t.choices.choiceItems().length-1>=1){var n=t.element.index();t.item.fieldItem().trigger("onChoiceRemoved",[n]),t.element.remove(),e(".tooltip-es").remove()}i.customFieldChanged()},"{setDefault} click":function(){var e=t.element.index();t.choiceTitle().val(),t.choiceValue().val();t.choices.choiceItems().trigger("toggleDefault",[e]),t.item.fieldItem().trigger("onChoiceToggleDefault",[e,parseInt(t.choiceDefault().val())]),i.customFieldChanged()},"{self} toggleDefault":function(e,i,n){var o=t.element.index(),a=parseInt(t.choiceDefault().val());o===n?a?(t.defaultIcon().removeClass("es-state-featured").addClass("es-state-default"),t.choiceDefault().val(0)):(t.defaultIcon().removeClass("es-state-default").addClass("es-state-featured"),t.choiceDefault().val(1)):t.choices.options.unique&&(t.defaultIcon().removeClass("es-state-featured").addClass("es-state-default"),t.choiceDefault().val(0))}}}),EasySocial.Controller("Fields.Editor.Item.Config",{defaultOptions:{"{required}":"[data-required]","{title}":"[data-title]","{description}":"[data-description]","{displayTitle}":"[data-display-title]","{displayDescription}":"[data-display-description]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"display_title":e.displayTitle().toggle(!!o);break;case"title":e.title().text(o);break;case"display_description":e.displayDescription().toggle(!!o);break;case"description":e.description().text(o);break;case"required":e.required().toggle(!!o)}}}}),t.resolve()})}),EasySocial.module("field",function(e){var t=this;EasySocial.Controller("Field.Base",{defaultOptions:{regPrefix:"easysocial/",modPrefix:"field.",ctrlPrefix:"EasySocial.Controller.Field.",fieldname:"",element:null,id:null,required:!1,mode:"edit","{field}":"[data-field]","{content}":"[data-content]","{notice}":"[data-check-notice]"}},function(t){return{init:function(){t.options.fieldname=t.element.data("fieldname"),t.options.element=t.options.element||t.element.data("element"),t.options.id=t.element.data("id"),t.options.required=!!t.element.data("required"),t.initMode(),t.notice().text().trim().length>0&&(t.content().popover({animation:!1,content:t.notice().text().trim(),html:!0,placement:"left-top",trigger:"manual",container:"body",template:'<div id="fd" class="fd-popover es es-field-error"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'}),t.content().popover("show"))},initMode:function(){switch(t.options.mode){case"registermini":t.field().trigger("onRegisterMini");break;case"register":t.field().trigger("onRegister");break;case"edit":t.field().trigger("onEdit");break;case"adminedit":t.field().trigger("onAdminEdit");break;case"sample":t.field().trigger("onSample");break;case"display":t.field().trigger("onDisplay")}},"{field} error":function(i,n,o,a){o=void 0===o||o,e.isString(o)&&(a=o,o=!0),e.isBoolean(o)&&t.field().toggleClass("has-error",o),void 0!==a&&(t.content().popover({animation:!1,content:a,html:!0,placement:"left-top",trigger:"manual",container:"body",template:'<div id="fd" class="fd-popover es es-field-error"><div class="arrow"></div><h3 class="fd-popover-title"></h3><div class="fd-popover-content"></div></div>'}),t.content().popover("show"))},"{field} clear":function(e,i){t.field().removeClass("has-error"),t.field().removeClass("is-loading"),t.content().popover("destroy")},"{self} show":function(){t.field().trigger("onShow")},"{field} loading":function(e,i,n){t.field().addClass("is-loading"),t.notice().html(n)},"{field} loaded":function(e,i){t.field().removeClass("is-loading")}}}),t.resolve()}),EasySocial.module("admin/profiles/members",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_ASSIGN_BUTTON","COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE").done(function(e){EasySocial.Controller("Profiles.Members",{defaultOptions:{"{addUser}":"[data-profiles-addUser]","{row}":"[data-profiles-members-row]"}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{memberList} userSelected":function(e,i,n,o){EasySocial.ajax("admin/controllers/profiles/insertMember",{id:n,profile_id:t.options.id}).done(function(e){t.row().append(e),EasySocial.dialog().close()})},"{addUser} click":function(){var i=e.callback(function(e){t.addPlugin("memberList",e)}),n=e.indexUrl+"?option=com_easysocial&view=users&tmpl=component&callback="+i;EasySocial.dialog({title:e.language("COM_EASYSOCIAL_PROFILES_ASSIGN_USER_DIALOG_TITLE"),content:n,showOverlay:!1,width:700,height:600,buttons:[{name:e.language("COM_EASYSOCIAL_CANCEL_BUTTON"),classNames:"btn btn-es",click:function(){EasySocial.dialog().close()}}]})}}}),t.resolve()})}),EasySocial.module("admin/profiles/profile",function(e){var t=this;EasySocial.require().script("utilities/alias").view("admin/profiles/dialog.delete.profileavatar").language("COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR").done(function(e){EasySocial.Controller("Profiles.Profile",{defaultOptions:{id:null,hasAvatar:!1,defaultAvatar:null,"{profileAvatar}":"[data-profile-avatar]","{profileAvatarImage}":"[data-profile-avatar-image]","{profileAvatarRemoveWrap}":"[data-profile-avatar-remove-wrap]","{profileAvatarRemoveButton}":"[data-profile-avatar-remove-button]","{profileAvatarUpload}":"[data-profile-avatar-upload]",view:{deleteProfileAvatar:"admin/profiles/dialog.delete.profileavatar"}}},function(t){return{init:function(){t.element.addController("EasySocial.Controller.Utilities.Alias",{"{source}":"#title","{target}":"#alias"}),t.options.hasAvatar=t.profileAvatar().data("hasavatar"),t.options.defaultAvatar=t.profileAvatar().data("defaultavatar")},"{profileAvatarUpload} change":function(i){var n=i.val();e.isEmpty(n)?t.options.hasAvatar||t.profileAvatarRemoveWrap().hide():t.profileAvatarRemoveWrap().show()},"{profileAvatarRemoveButton} click":function(i){t.options.hasAvatar?EasySocial.dialog({content:t.view.deleteProfileAvatar(!0),bindings:{"{deleteButton} click":function(){var i=this.parent;i.loading(!0),EasySocial.ajax("admin/controllers/profiles/deleteProfileAvatar",{id:t.options.id}).done(function(){i.loading(!1),i.close(),t.profileAvatarImage().attr("src",t.options.defaultAvatar),t.profileAvatarRemoveWrap().hide(),t.profileAvatarRemoveButton().text(e.language("COM_EASYSOCIAL_PROFILES_FORM_CLEAR_AVATAR")),t.options.hasAvatar=!1})}}}):t.profileAvatarUpload().val("").trigger("change")}}}),t.resolve()})}),EasySocial.module("utilities/alias",function(e){var t=this;EasySocial.Controller("Utilities.Alias",{defaultOptions:{"{target}":"","{source}":""}},function(e){return{init:function(){},convertToPermalink:function(e){return e.replace(/\s/g,"-").replace(/[^\w/-]/g,"").toLowerCase()},"{source} keyup":function(){e.target().val(e.convertToPermalink(e.source().val()))},"{target} keyup":function(){e.target().val(e.convertToPermalink(e.target().val()))}}}),t.resolve()}),EasySocial.module("admin/profiles/profiles",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Profiles",{defaultOptions:{"{updateOrdering}":"[data-profiles-update-ordering]","{item}":"[data-profiles-item]",view:{deleteConfirmation:"admin/profiles/dialog.delete.confirm"}}},function(t){return{init:function(){t.item().implement(EasySocial.Controller.Profiles.Item)},"{updateOrdering} click":function(){e("[data-table-checkall]").prop("checked",!0).trigger("change"),e.Joomla("submitform",["updateOrdering"])}}}),EasySocial.Controller("Profiles.Item",{defaultOptions:{"{insertLink}":"[data-profile-insert]"}},function(e){return{init:function(){e.options.title=e.element.data("title"),e.options.id=e.element.data("id")},"{insertLink} click":function(){e.trigger("profileSelected",[e.options.id,e.options.title])}}}),t.resolve()})}),EasySocial.module("admin/regions/form",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE").done(function(){e.template("easysocial/parents.select",'<select name="parent_uid" data-parent-uid></select>'),e.template("easysocial/parents.option",'<option value="[%= uid %]">[%= name %]</option>'),EasySocial.Controller("Regions.Form",{defaultOptions:{"{type}":"[data-type]","{parentBase}":"[data-parent-base]","{parentContent}":"[data-parent-content]","{parentUid}":"[data-parent-uid]","{parentType}":"[data-parent-type]",view:{parentsSelect:"parents.select",parentsOption:"parents.option"}}},function(t){return{init:function(){t.element.find('input[type="text"]').prop("disabled",!t.type().val()),t.element.find('[data-bs-toggle="radio-buttons"]').toggleClass("disabled",!t.type().val()),e.Joomla("submitbutton",function(i){if("cancel"==i)return window.location="index.php?option=com_easysocial&view=regions",!1;t.validate()?e.Joomla("submitform",[i]):alert(e.language("COM_EASYSOCIAL_REGIONS_FORM_INCOMPLETE"))})},"{type} change":function(i){var n=i.find(":selected").data("parent");t.parentType().val(n),t.element.find('input[type="text"]').prop("disabled",!i.val()),t.element.find('[data-bs-toggle="radio-buttons"]').toggleClass("disabled",!i.val()),n?(t.parentBase().show(),!t.parentContent().data("loaded")&&t.getParents(n).done(function(i){var n=e(t.view.parentsSelect());e.each(i,function(e,i){t.view.parentsOption({uid:i.uid,name:i.name}).appendTo(n)}),t.parentContent().html(n)})):t.parentBase().hide()},getParents:e.memoize(function(e){return EasySocial.ajax("admin/controllers/regions/getParents",{type:e})}),validate:function(){return t.type().val()&&t.element.find('input[name="name"]').val()&&t.element.find('input[name="code"]').val()}}}),t.resolve()})}),EasySocial.module("admin/regions/init",function(e){var t=this;EasySocial.Controller("Region.Init",{defaultOptions:{callback:function(){},"{startButton}":"[data-start]","{table}":"[data-table]","{tableBody}":"[data-table-body]","{row}":"[data-table-row]"}},function(t){return{init:function(){t.row().addController("EasySocial.Controller.Region.Init.Row")},"{startButton} click":function(i,n){i.hide(),t.table().show(),t.counter=0,t.progress=e.Deferred().done(function(){t.options.callback()}),t.process()},process:function(){var e=t.row().eq(t.counter);if(0===e.length)return t.progress.resolve();e.show(),EasySocial.ajax("admin/controllers/regions/initialise",{key:e.data("key")}).done(function(){e.trigger("updateStatus",[1]),t.counter++,t.process()})}}}),EasySocial.Controller("Region.Init.Row",{defaultOptions:{"{title}":"[data-row-title]","{status}":"[data-row-status]","{icon}":"[data-row-icon]"}},function(e){return{init:function(){},statuses:["label-danger","label-success","label-warning"],icons:["ies-warning-2","ies-checkmark","ies-wrench-3"],"{self} updateStatus":function(t,n,o){var a=e.status(),r=e.icon();for(i=0;i<3;i++)a.toggleClass(e.statuses[i],o==i),r.toggleClass(e.icons[i],o==i)}}}),t.resolve()}),EasySocial.module("admin/reports/reporters",function(e){var t=this;EasySocial.Controller("Reports.Reporters",{defaultOptions:{"{item}":"[data-reporters-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Reports.Reporters.Item,{"{parent}":e})}}}),EasySocial.Controller("Reports.Reporters.Item",{defaultOptions:{"{removeItem}":"[data-remove-item]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{removeItem} click":function(){e.parent.clearMessage(),EasySocial.ajax("admin/controllers/reports/removeItem",{id:e.options.id}).done(function(t){e.parent.setMessage(t.message,t.type),e.element.remove()})}}}),t.resolve()}),EasySocial.module("admin/reports/reports",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE","COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE").done(function(e){EasySocial.Controller("Reports",{defaultOptions:{"{item}":"[data-reports-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Reports.Item)}}}),EasySocial.Controller("Reports.Item",{defaultOptions:{"{action}":"[data-reports-item-view-actions]","{viewReports}":"[data-reports-item-view-reports]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.extension=t.element.data("extension"),t.options.uid=t.element.data("uid"),t.options.type=t.element.data("type")},"{viewReports} click":function(){EasySocial.dialog({title:e.language("COM_EASYSOCIAL_REPORTS_VIEW_REPORTS_DIALOG_TITLE"),content:EasySocial.ajax("admin/controllers/reports/getReporters",{id:t.options.id}),width:600,height:450})},"{action} click":function(){EasySocial.dialog({title:e.language("COM_EASYSOCIAL_REPORTS_ACTIONS_DIALOG_TITLE"),content:"<div>Perform some actions on the item</div>",width:500,height:250,buttons:[{name:e.language("COM_EASYSOCIAL_CLOSE_BUTTON"),classNames:"btn btn-es",click:function(){EasySocial.dialog().close()}}]})}}}),t.resolve()})}),EasySocial.module("admin/themes/compiler",function(e){var t=this;e.fn.at=function(e){return this.find("[data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},e.template("easysocial/compiler/detail",'<tr class="[%= type %]"><td>[%= timestamp %]</td><td width="100%">[%= message %]</td></tr>'),EasySocial.Controller("Themes.Compiler",{defaultOptions:{view:{detail:"compiler/detail"},"{section}":"[data-section]","{compileButton}":"[data-compile-button]","{minifyButton}":"[data-minify-button]","{buildButton}":"[data-build-button]","{filesButton}":"[data-files-button]","{purgeButton}":"[data-purge-button]","{resetButton}":"[data-reset-button]","{forceCompileButton}":"[data-force-compile-button]","{clearLogButton}":"[data-clear-log-button]","{toggleLogButton}":"[data-toggle-log-button]","{refreshButton}":"[data-refresh-button]","{refreshSectionButton}":"[data-refresh-section-button]","{buildWithoutMinifyButton}":"[data-build-without-minify-button]","{log}":"[data-log]","{details}":"[data-details]","{status}":"[data-status]","{imports}":"[data-imports]","{progress}":"[data-progress]","{progressBar}":"[data-progress-bar]","{progressStatus}":"[data-progress-status]","{tabItem}":".tab-item"}},function(t,i,n){return{init:function(){t.location=n.data("location"),t.name=n.data("name"),t.override=n.data("override")},sections:function(){return e.map(t.section(),function(i){var n=e(i).data("sectionName");return{id:t.sectionId(n),name:n}})},sectionId:function(e){return t.location+"-"+t.name+"-"+e},sectionTab:function(e){return t.tabItem({sectionId:t.sectionId(e)}).find("> a")},sectionNameOf:function(e){return t.section.of(e).data("sectionName")},getLog:function(e){return e?t.section({sectionName:e}).at("log"):t.log(":first")},addLog:function(i,n){var o=t.getLog(n).find("tbody");e.isString(i)&&(i={timestamp:new Date,message:i,type:"info"});var a=i.type;/warning|warn/.test(a)&&(a="warning"),/danger|error|failed|fail/.test(a)&&(a="danger"),/pending|default|primary/.test(a)&&(a="");var r=i.timestamp,s=r instanceof Date?r:new Date(parseFloat(r));r=s.getHours()+":"+s.getMinutes()+":"+s.getSeconds();var l=i.message;t.view.detail({type:a,timestamp:r,message:l}).appendTo(o),o[0].scrollTop=o[0].scrollHeight},appendLog:function(i,n){e.each(i,function(e,i){t.addLog(i,n)})},clearLog:function(e){var i=t.getLog(e);i.find("tbody").empty(),i.at("timeTotal").data("value",0).html("0s"),i.at("memoryUsage").data("value",0).html("0mb")},generateLog:function(e,i){t.clearLog(i),t.appendLog(e.details,i);var n=t.getLog(i),o=parseFloat(e.time_total),a=o.toFixed(2)+"s",r=parseInt(e.mem_peak),s=(r/1024/1024).toFixed(2)+"mb";n.at("timeTotal").data("value",o).html(a),n.at("memoryUsage").data("value",r).html(s),t.addLog({type:e.failed?"danger":"success",timestamp:e.time_end,message:e.failed?"Task failed.":"Task completed."},i)},updateLog:function(e,i){var n=t.getLog(i),o=n.at("timeTotal"),a=n.at("memoryUsage");t.appendLog(e.details,i);var r=o.data("value")+parseFloat(e.time_total),s=r.toFixed(2)+"s",l=Math.max(a.data("value"),parseInt(e.mem_peak)),c=(l/1024/1024).toFixed(2)+"mb";o.data("value",r).html(s),a.data("value",l).html(c)},perform:function(i,n){return EasySocial.ajax("admin/controllers/themes/"+i,e.extend({location:t.location,name:t.name,override:t.override},n))},build:function(e){var i=t.sections(),o="cache"==(e=e||"cache"),a=0,r=i.length-1,s=a+1,l=(r+1)*(o?2:1)+1,c=!1,d=(t.log(":first"),t.progress(":first"),t.progressBar(":first")),u=t.progressStatus(":first"),p=function(){progressValue=s++/l*100,d.show().width(progressValue+"%")},f=function(){var e=i[a],n=(e.id,e.name),r=t.sectionTab(n),s="Compiling section '"+n+"'.";p(),u.html(s),r.tab("show"),t.compile(n,{force:!0}).done(function(e){t.updateLog(e.task)}).fail(function(e){t.updateLog(e.task),c=!0}).always(function(){if(o){var e="Minifying section '"+n+"'.";p(),u.html(e),t.minify(n).done(function(e){t.updateLog(e.task)}).fail(function(e){t.updateLog(e.task),c=!0}).always(function(){m()})}else m()})},m=function(){if(r>a++)return f();h()},h=function(){u.html("Building stylesheets."),p();var i;t.perform("build",{preset:e}).done(function(e){t.status(":first").replaceWith(e.status),i=e.task}).fail(function(e){i=e.task}).always(function(){i||(i={failed:!0,details:[],time_end:new Date}),t.updateLog(i),t.addLog({type:i.failed?"danger":"success",timestamp:i.time_end,message:i.failed?"Build failed.":"Build completed."}),u.html("Build completed!"),d.width("100%"),n.removeClass("is-busy")})};d.hide().width("0%"),n.addClass("is-busy"),t.clearLog(),i.length>0?(t.addLog("Compiling all sections."),f()):h()},minify:function(i,n){var o=t.perform("minify",e.extend({section:i},n));return t.trigger("minify",[i,o]),o},"{self} minify":function(e,i,n,o){var a=t.section({sectionName:n}),r=a.at("progressStatus"),s=a.at("progressBar"),l="Minifying section '"+n+"'.";a.addClass("is-busy"),r.html(l),s.hide().width("0%").show().width("100%"),o.done(function(e){a.at("imports").replaceWith(e.imports),a.at("status").replaceWith(e.status),t.appendLog(e.task.details,n),t.addLog({type:o.failed?"danger":"success",timestamp:e.task.time_end,message:o.failed?"Task failed.":"Task completed."},n)}).always(function(){a.removeClass("is-busy")})},compile:function(i,n){var o=t.perform("compile",e.extend({section:i},n));return t.trigger("compile",[i,o]),o},"{self} compile":function(e,i,n,o){var a=t.section({sectionName:n}),r=a.at("progressStatus"),s=a.at("progressBar"),l="Compiling section '"+n+"'.";a.addClass("is-busy"),r.html(l),s.hide().width("0%").show().width("100%"),t.clearLog(n),t.addLog(l,n),o.done(function(e){a.at("imports").replaceWith(e.imports),a.at("status").replaceWith(e.status),t.generateLog(e.task,n)}).fail(function(e){t.generateLog(e.task,n)}).always(function(){a.removeClass("is-busy")})},purge:function(){t.progress(":first");var e=t.progressBar(":first"),i=t.progressStatus(":first");n.addClass("is-busy"),t.clearLog(),e.hide().width("0%").show().width("100%"),i.html("Purging cache and log files."),t.perform("purge").done(function(e){t.generateLog(e)}).fail(function(e){}).always(function(){n.removeClass("is-busy")})},"{buildButton} click":function(e){t.build("cache")},"{buildWithoutMinifyButton} click":function(){t.build("development")},"{compileAllButton} click":function(e){},"{compileButton} click":function(e){var i=t.sectionNameOf(e);return t.compile(i)},"{forceCompileButton} click":function(e){var i=t.sectionNameOf(e);return t.compile(i,{force:!0})},"{minifyButton} click":function(e){var i=t.sectionNameOf(e);return t.minify(i)},"{refreshButton} click":function(){n.addClass("is-busy"),t.progressBar(":first").show().width("100%"),t.progressStatus(":first").html("Refreshing"),EasySocial.ajax("admin/views/themes/compiler",{location:t.location,name:t.name,override:t.override}).done(function(e){n.replaceWith(e)}).fail(function(){alert("Unable to refresh section.")}).always(function(){n.removeClass("is-busy")})},"{refreshSectionButton} click":function(e){var i=t.sectionNameOf(e),n=t.section({sectionName:i});n.addClass("is-busy"),n.at("progressStatus").html("Refreshing"),EasySocial.ajax("admin/views/themes/section",{location:t.location,name:t.name,override:t.override,section:i}).done(function(e){n.html(e)}).fail(function(){alert("Unable to refresh section.")}).always(function(){n.removeClass("is-busy")})},"{resetButton} click":function(){alert("TODO: Restore to factory default.")},"{purgeButton} click":function(){t.purge()}}}),t.resolve()}),EasySocial.module("admin/users/form",function(e){var t=this;EasySocial.require().script("field").done(function(e){EasySocial.Controller("Users.Form",{defaultOptions:{userid:null,mode:"adminedit","{selectProfile}":"[data-user-select-profile]","{content}":"[data-user-new-content]","{profileTitle}":"[data-profile-title]","{fieldItem}":"[data-profile-adminedit-fields-item]","{tabnav}":"[data-tabnav]","{tabcontent}":"[data-tabcontent]","{stepnav}":"[data-stepnav]","{stepcontent}":"[data-stepcontent]",view:{loading:"site/loading/large"}}},function(t){return{init:function(){window.selectedProfile=t.selectedProfile,t.fieldItem().addController("EasySocial.Controller.Field.Base",{userid:t.options.userid,mode:t.options.mode})},selectedProfile:function(e){EasySocial.dialog().close(),window.location.href="index.php?option=com_easysocial&view=users&layout=form&profileId="+e},"{selectProfile} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/profiles/browse")})},errorFields:[],"{fieldItem} error":function(i,n){var o=i.data("id");e.inArray(o,t.errorFields)<0&&t.errorFields.push(o);var a=i.parents(t.stepcontent.selector).data("for");t.stepnav().filterBy("for",a).trigger("error");var r=i.parents(t.tabcontent.selector).data("for");t.tabnav().filterBy("for",r).trigger("error")},"{fieldItem} clear":function(i,n){var o=i.data("id");t.errorFields=e.without(t.errorFields,o);var a=i.parents(t.stepcontent.selector).data("for");t.stepnav().filterBy("for",a).trigger("clear");var r=i.parents(t.tabcontent.selector).data("for");t.tabnav().filterBy("for",r).trigger("clear")},"{stepnav} error":function(e){e.addClass("error")},"{tabnav} error":function(e){e.addClass("error")},"{stepnav} clear":function(e){t.errorFields.length<1&&e.removeClass("error")},"{tabnav} clear":function(e){t.errorFields.length<1&&e.removeClass("error")},"{stepnav} click":function(e){var i=e.data("for");t.stepcontent().filterBy("for",i).find(t.fieldItem.selector).trigger("show")}}}),t.resolve()})}),EasySocial.module("admin/users/privacy",function(e){var t=this;EasySocial.require().library("textboxlist").view("site/loading/small").done(function(e){EasySocial.Controller("Profile.Privacy",{defaultOptions:{userId:"","{privacyItem}":"[data-privacy-item]","{privacyForm}":"[data-profile-privacy-form]",view:{loading:"site/loading/small"}}},function(e){return{init:function(){e.privacyItem().implement(EasySocial.Controller.Profile.Privacy.Item,{"{parent}":e})}}}),EasySocial.Controller("Profile.Privacy.Item",{defaultOptions:{"{selection}":"[data-privacy-select]","{hiddenCustom}":"[data-hidden-custom]","{customForm}":"[data-privacy-custom-form]","{customTextInput}":"[data-textfield]","{customItems}":"input[]","{customHideBtn}":"[data-privacy-custom-hide-button]","{customInputItem}":"[data-textboxlist-item]","{customEditBtn}":"[data-privacy-custom-edit-button]"}},function(t){return{init:function(){t.customTextInput().textboxlist({component:"es",unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:2,cache:!1,query:function(e){var i=t.getTaggedUsers();return EasySocial.ajax("site/views/privacy/getfriends",{q:e,userid:t.parent.options.userId,exclude:i})}}}}),t.textboxlistLib=t.customTextInput().textboxlist("controller")},getTaggedUsers:function(){var i=[],n=t.customInputItem();return n.length>0&&e.each(n,function(t,n){i.push(e(n).data("id"))}),i},"{customTextInput} addItem":function(e,i,n){var o=t.hiddenCustom().val(),a="";if(""==o)a=n.id;else{var r=o.split(",");r.push(n.id),a=r.join(",")}t.hiddenCustom().val(a)},"{customTextInput} removeItem":function(e,i,n){for(var o="",a=[],r=t.hiddenCustom().val().split(","),s=0;s<r.length;s++)r[s]!=n.id&&a.push(r[s]);o=a.length<=0?"":a.join(","),t.hiddenCustom().val(o)},"{customEditBtn} click":function(e){t.customForm().toggle()},"{selection} change":function(e){"custom"==e.val()?(t.customForm().show(),t.customEditBtn().show()):(t.customForm().hide(),t.customEditBtn().hide())},"{customHideBtn} click":function(){t.customForm().hide(),t.customEditBtn().show(),t.textboxlistLib.autocomplete.hide()}}}),t.resolve()})}),EasySocial.module("admin/users/users",function(e){var t=this;EasySocial.require().library("expanding").done(function(e){EasySocial.Controller("Users",{defaultOptions:{"{item}":"[data-user-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Users.Item)}}}),EasySocial.Controller("Users.Item",{defaultOptions:{"{insertLink}":"[data-user-item-insertLink]"}},function(e){return{init:function(){e.options.name=e.element.data("name"),e.options.avatar=e.element.data("avatar"),e.options.email=e.element.data("email"),e.options.id=e.element.data("id")},"{insertLink} click":function(){e.trigger("userSelected",[e.options.id,e.options.name,e.options.avatar,e.options.email])}}}),EasySocial.Controller("Users.Pending",{defaultOptions:{"{item}":"[data-pending-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Users.Pending.Item)}}}),EasySocial.Controller("Users.Pending.Item",{defaultOptions:{"{approve}":"[data-pending-approve]","{reject}":"[data-pending-reject]"}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{approve} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/users/confirmApprove",{id:t.options.id}),bindings:{"{approveButton} click":function(){e("[data-users-approve-form]").submit()}}})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("admin/views/users/confirmReject",{id:t.options.id})})}}}),t.resolve()})}),EasySocial.module("admin/widgets/news",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("News",{defaultOptions:{loadOnInit:!0,"{news}":"[data-widget-news] > [data-widget-news-items]","{appNews}":"[data-widget-app-news] > [data-widget-news-items]","{placeholder}":"[data-widget-news-placeholder]"}},function(e){return{init:function(){e.options.loadOnInit&&e.getNews()},getNews:function(){EasySocial.ajax("admin/controllers/news/getnews").done(function(t,i){e.news().append(t),e.appNews().append(i),e.placeholder().remove()})}}}),t.resolve()})}),EasySocial.module("albums/album",function(e){var t=this;EasySocial.require().library("tinyscrollbar").done(function(){EasySocial.Controller("Albums.Album",{defaultOptions:{"{title}":"[data-album-title]","{count}":"[data-album-count]","{privacy}":"[data-album-privacy]","{cover}":"[data-album-cover]","{coverImage}":"[data-album-cover-image]","{link}":"[data-album-link]","{menu}":"[data-album-menu]","{menuActions}":"[data-album-menu-actions]","{shareButton}":"[data-album-share-button]","{shareContent}":"[data-sharing]","{followButton}":"[data-album-follow-button]","{reportButton}":"[data-album-report-button]","{deleteButton}":"[data-album-delete-button]","{likeButton}":"[data-album-like-button]","{commentButton}":"[data-album-comment-button]","{countsButton}":"[data-album-counts-button]","{commentCount}":"[data-album-comment-count]","{likeCount}":"[data-album-like-count]","{actions}":"[data-item-actions]","{actionContent}":"[data-item-action-content]","{actionCloseButton}":"[data-item-action-close-button]","{actionsMenu}":"[data-item-actions-menu]","{likesHolder}":"[data-album-likes-holder]","{commentsHolder}":"[data-album-comments-holder]","{responseHolder}":"[data-album-response-holder]","{comments}":"[data-comments]"}},function(t){return{init:function(){t.id=t.element.data("album-id"),t.actionContent().tinyscrollbar(),t.actions().hasClass("open")&&(t.loadResponse(),t.element.addClass("show-all"))},remove:function(){t.element.remove()},"{coverImage} click":function(){window.location=t.link().attr("href")},"{shareButton} click":function(){t.shareContent().show()},"{deleteButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/albums/confirmDelete",{id:t.id})})},like:function(){EasySocial.ajax("site/controllers/albums/like",{id:t.id}).done(function(e){t.likeCount().html(e.count),e.state?t.likeButton().addClass("liked"):t.likeButton().removeClass("liked"),t.likesHolder().html(e.html)})},loadResponse:function(){var e=t.loadResponse.loader;e&&"rejected"!=e.state()||(t.loadResponse.loader=EasySocial.ajax("site/views/albums/response",{id:t.id}).done(function(e){t.responseHolder().html(e),t.actionContent().removeClass("loading").tinyscrollbar_update()}))},getButton:function(i){var i=e(i),n=t.countsButton(),o=t.commentButton();return i.is(n)||i.parents().filter(n).length>0?n:i.is(o)||i.parents().filter(o).length>0?o:e()},lastButton:e(),"{actions} shown.bs.dropdown":function(e,i,n){t.loadResponse(),t.element.addClass("show-all");var o=t.actionContent(),a=t.lastButton=t.getButton(n),r=a.position().left+a.width()/2-o.width()/2;o.css("margin-left",r).tinyscrollbar_update()},"{actions} hide.bs.dropdown":function(e,i,n){t.element.removeClass("show-all");var o=t.getButton(n),a=t.lastButton;o.is(a)||setTimeout(function(){o.trigger("click")},0)},"{actionCloseButton} click":function(e){t.hideActionContent()},"{likeButton} click":function(){t.like()},"{comments} newCommentSaved":function(){var e=t.comments().controller("EasySocial.Controller.Comments.Stat");t.commentCount().html(e.total()),t.actionContent().tinyscrollbar_update("bottom")},"{comments} commentDeleted":function(){var e=t.comments().controller("EasySocial.Controller.Comments.Stat");t.commentCount().html(e.total()),t.actionContent().tinyscrollbar_update()},"{actionsMenu} shown.bs.dropdown":function(){t.element.addClass("show-all")},"{actionsMenu} hidden.bs.dropdown":function(){t.element.removeClass("show-all")}}}),t.resolve()})}),EasySocial.module("albums/browser",function(e){var t=this;EasySocial.require().library("history").view("site/albums/browser.list.item").done(function(){EasySocial.Controller("Albums.Browser",{hostname:"browser",defaultOptions:{view:{listItem:"site/albums/browser.list.item"},itemRenderOptions:{},"{sidebar}":"[data-album-browser-sidebar]","{content}":"[data-album-browser-content]","{createAlbumButton}":"[data-album-create-button]","{createAlbumButtonLink}":"[data-album-create-button] > a","{listItemGroup}":"[data-album-list-item-group]","{listItemRegularGroup}":"[data-album-list-item-group=regular]","{listItemCoreGroup}":"[data-album-list-item-group=core]","{listItem}":"[data-album-list-item]","{listItemLink}":"[data-album-list-item] > a","{listItemTitle}":"[data-album-list-item-title]","{listItemCover}":"[data-album-list-item-cover]","{listItemCount}":"[data-album-list-item-count]","{albumItem}":"[data-album-item]","{photoBrowser}":"[data-photo-browser]"}},function(t){return{init:function(){t.albumItem().each(function(){t.addSubscriber(e(this).controller("EasySocial.Controller.Albums.Item"))})},setLayout:function(e){t.element.hasClass("layout-dialog")||t.element.data("layout",e).switchClass("layout-"+e)},open:function(i){var n=e.makeArray(arguments);t.trigger("contentload",n);var o="view"+e.String.capitalize(i),a=t[o].apply(t,n.slice(1));return a.done(t.displayContent(function(){return t.trigger("contentdisplay",n),arguments})).fail(function(){t.trigger("contentfail",n)}).always(function(){t.trigger("contentcomplete",n)}),a},"{self} contentdisplay":function(e,i,n){/album|albumform/gi.test(n)&&t.setLayout("album"),/photo/gi.test(n)&&t.setLayout("photo")},displayContent:e.Enqueue(function(i){var n=[],o=e(e.buildFragment([i],document,n));t.content().html(o),e(n).remove()}),viewAlbum:function(e){t.listItem().removeClass("active loading");var i=t.getListItem(e).addClass("active loading");return"dialog"!==t.element.data("layout")&&i.find("> a").route(),EasySocial.ajax("site/views/albums/item",{id:e,renderOptions:t.options.itemRenderOptions}).fail(function(){}).always(function(){i.removeClass("loading")})},viewAlbumForm:function(){t.listItem().removeClass("active loading");var e=t.view.listItem({}).addClass("active loading new").prependTo(t.listItemRegularGroup());return EasySocial.ajax("site/views/albums/form",{uid:t.options.uid,type:t.options.type}).fail(function(){}).always(function(){e.removeClass("loading")})},viewPhoto:function(e){return EasySocial.ajax("site/views/photos/item",{id:e,browser:1}).fail(function(){}).always(function(){})},"{listItem} click":function(e){if(!e.hasClass("new")){var i=e.data("albumId");t.open("Album",i)}},"{listItemLink} click":function(e,t){t.preventDefault(),e.blur()},"{createAlbumButton} click":function(){t.open("AlbumForm"),"dialog"!==t.element.data("layout")&&t.createAlbumButtonLink().route()},"{createAlbumButtonLink} click":function(e,t){t.preventDefault()},"{albumItem} init.albums.item":function(e,i,n){t.addSubscriber(n)},getListItem:function(i,n){var o=i?t.listItem().filterBy("albumId",i):t.listItem(".new");return n?o.find(t["listItem"+e.String.capitalize(n)].selector):o},updateListItemCount:function(e,i,n){var o=t.getListItem(e,"count");if(!(o.length<0)){var a;(a=n?(parseInt(o.text())||0)+(parseInt(i)||0):i)<0&&(a=0),o.text(a)}},"{albumItem} albumSave":function(e,i,n){n.done(function(e){t.getListItem().attr("data-album-id",e.id).removeClass("new"),t.getListItem(e.id).find("> a").attr({href:e.permalink,title:e.title}).route(),t.getListItem(e.id,"title").html(e.title)})},"{albumItem} titleChange":function(i,n,o,a){t.getListItem(a.id,"title").html(e.trim(o)||"&nbsp;")},"{albumItem} coverChange":function(i,n,o,a){t.getListItem(a.id,"cover").css("backgroundImage",e.cssUrl(o.sizes.thumbnail.url))},"{albumItem} coverRemove":function(e,i,n){t.getListItem(n.id,"cover").css("backgroundImage","")},"{albumItem} photoAdd":function(e,i,n,o,a){t.updateListItemCount(a.id,1,!0)},"{albumItem} photoMove":function(e,i,n,o){n.done(function(){t.updateListItemCount(o.album.id,-1,!0)})},"{albumItem} photoDelete":function(e,i,n,o){n.done(function(){t.updateListItemCount(o.album.id,-1,!0)})},"{photoBrowser} init.photos.browser":function(e,i,n){t.addSubscriber(n)},"{self} contentload":function(){t.listItem(".new").remove()}}}),t.resolve()})}),EasySocial.module("albums/editor",function(e){var t=this;EasySocial.require().script("albums/editor/sortable","albums/editor/uploader").done();var i=EasySocial.Controller("Albums.Editor",{hostname:"editor",defaultOptions:{view:{uploadItem:"site/albums/upload.item"},canReorder:!1,canUpload:!0,"{titleField}":"[data-album-title-field]","{captionField}":"[data-album-caption-field]","{coverField}":"[data-album-cover-field]","{type}":"[data-album-type]","{uid}":"[data-album-uid]","{location}":"[data-album-location]","{locationCaption}":"[data-album-location-caption]","{addLocationButton}":"[data-album-addLocation-button]","{date}":"[data-album-date]","{dateCaption}":"[data-album-date-caption]","{addDateCaption}":"[data-album-addDate-button]","{privacy}":"[data-album-privacy]","{uploadButton}":"[data-album-upload-button]","{deleteButton}":"[data-album-delete-button]","{moreButton}":"[data-album-more-button]","{privacy}":"[data-privacy-hidden]","{privacycustom}":"[data-privacy-custom-hidden]","{uploadItem}":"[data-photo-upload-item]","{dateDay}":"[data-date-day]","{dateMonth}":"[data-date-month]","{dateYear}":"[data-date-year]","{editButton}":"[data-album-edit-button]","{editButtonLink}":"[data-album-edit-button] > a","{doneButton}":"[data-album-done-button]","{doneButtonLink}":"[data-album-done-button] > a","{cancelButton}":"[data-album-cancel-button]","{cancelButtonLink}":"[data-album-cancel-button] > a","{locationWidget}":".es-album-location-form .es-location","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]"}},function(t){return{init:function(){t.id=t.element.data("album-id");var i=t.options;i.canReorder&&EasySocial.module("albums/sortable").done(function(e){t.addPlugin("sortable",e)}),i.canUpload&&EasySocial.module("albums/editor/uploader").done(function(e){t.uploader=t.addPlugin("uploader",e)}),t.id?(t.createAlbum.task=e.Deferred().resolve(),t.createStream=0):t.createStream=1},data:function(){var e=t.titleField().val(),i=t.captionField().val(),n=t.formatDate(),o=t.locationCaption().html(),a=t.latitude().val(),r=t.longitude().val(),s=t.privacy().val(),l=t.privacycustom().val();return uid=t.element.data("album-uid"),type=t.element.data("album-type"),{id:t.id,uid:uid,type:type,title:e,caption:i,date:n,address:o,latitude:a,longitude:r,privacy:s,privacycustom:l,createStream:t.createStream}},createAlbum:function(){var e=t.createAlbum.task;return e||(e=t.createAlbum.task=t.save({createStream:0}).done(function(e){t.deleteButton().disabled(!1),t.element.attr("data-album-id",t.id=e.id)}).fail(function(e,i){t.setMessage(e,i)})),e},save:function(i){t.trigger("beforeAlbumSave",[t]);var n=e.extend(t.data(),i);n.photos=e.map(t.album.photoItem(),function(t,i){var n=e(t).controller("EasySocial.Controller.Photos.Editor");return n?n.data():null}),t.clearMessage();var o=EasySocial.ajax("site/controllers/albums/store",n);return t.trigger("albumSave",[o,t]),o},"{self} photoAdd":function(e,i,n,o){t.album.photoItem().length<=1&&t.changeCover(o)},setCover:function(e){return EasySocial.ajax("site/controllers/albums/setCover",{albumId:t.id,coverId:e}).done(function(e){t.changeCover(e)}).fail(function(){})},removeCover:function(){t.trigger("coverRemove",[t.album])},changeCover:function(e){t.trigger("coverChange",[e,t])},"{self} coverChange":function(i,n,o){t.coverField().removeClass("no-cover").css("backgroundImage",e.cssUrl(o.sizes.thumbnail.url))},"{self} coverRemove":function(){t.coverField().addClass("no-cover").css("backgroundImage","")},"{editButton} click":function(){t.album.setLayout("form"),t.editButtonLink().route()},"{editButtonLink} click":function(e,t){t.preventDefault()},"{cancelButton} click":function(){t.album.setLayout("item"),t.cancelButtonLink().route()},"{cancelButtonLink} click":function(e,t){t.preventDefault()},"{doneButton} click":function(i,n){t.doneButtonLink().addClass("btn-loading"),t.save().done(function(i,n){t.doneButtonLink().removeClass("btn-loading"),e.buildHTML(n).replaceAll(t.element)}).progress(function(e,i){t.setMessage(e,i)})},"{doneButtonLink} click":function(e,t){t.preventDefault()},"{deleteButton} click":function(e){e.disabled()||EasySocial.dialog({content:EasySocial.ajax("site/views/albums/confirmDelete",{id:t.id})})},formatDate:function(){var e=t.dateDay().val()||t.dateDay().data("date-default"),i=t.dateMonth().val()||t.dateMonth().data("date-default");return(t.dateYear().val()||t.dateYear().data("date-default"))+"-"+i+"-"+e},updateDate:function(){t.date().addClass("has-data");var i=t.dateDay().val()+" "+e.trim(t.dateMonth().find(":selected").html())+" "+t.dateYear().val();t.dateCaption().html(i)},"{dateDay} keyup":function(){t.updateDate()},"{dateMonth} change":function(){t.updateDate()},"{dateYear} keyup":function(){t.updateDate()},"{titleField} keyup":function(e){t.trigger("titleChange",[e.val(),t])},"{locationWidget} locationChange":function(e,i,n){var o=n.formatted_address;t.locationCaption().html(o),t.location().addClass("has-data")}}});t.resolve(i)}),EasySocial.module("albums/editor/sortable",function(e){var t=this;EasySocial.require().library("ui/sortable").done(function(){var i=EasySocial.Controller("Albums.Editor.Sortable",{defaultOptions:{}},function(t){return{init:function(){},getPhotoOrdering:function(){var i={};return t.photoItem().each(function(t){var n=e(this).data("photoId");i[n]=t}),i},"{parent.photoItemGroup} sortstart":function(e,i,n){n.item.addClass("dragging"),e.addClass("ordering"),t.setLayout()},"{parent.photoItemGroup} sortchange":function(e,i,n){t.setLayout()},"{parent.photoItemGroup} sortstop":function(e,i,n){n.item.removeClass("dragging"),e.removeClass("ordering"),t.setLayout(),EasySocial.ajax("site/controllers/photos/reorder",{id:n.item.controller().id,order:n.item.index()})}}});t.resolve(i)})}),EasySocial.module("albums/editor/uploader",function(e){var t=this;EasySocial.require().script("albums/uploader").view("site/albums/upload.item").done(function(){var i=EasySocial.Controller("Albums.Editor.Uploader",{defaultOptions:{}},function(t){return{init:function(){t.album=t.editor.album;var e=t.album.options.uploader;t.uploader=t.addPlugin("uploader",EasySocial.Controller.Albums.Uploader,{settings:e,"{uploadButton}":t.editor.uploadButton.selector,"{uploadItemGroup}":t.album.photoItemGroup.selector,"{uploadDropsite}":t.album.content.selector})},setLayout:function(){t.album.setLayout_()},"{self} beforeAlbumSave":function(){t.uploader.stop()},"{self} albumSave":function(i,n,o){o.done(function(i){var n=e.uri(t.uploader.settings("url")).replaceQueryParam("albumId",i.id).toString();t.uploader.settings("url",n)})},"{self} layoutChange":function(i,n,o){t.uploader.stop(),t.uploader.clear();var a=e.uri(t.uploader.settings("url")).replaceQueryParam("createStream","form"==o?0:1).replaceQueryParam("layout",o).toString();t.uploader.settings("url",a)},"{self} QueueCreated":function(e,i,n){"form"==t.album.currentLayout()&&n.element.addClass("layout-form"),t.setLayout()},startUpload:e.Enqueue(),"{uploader} FilesAdded":function(e,i,n,o){t.id?t.uploader.start():t.editor.createAlbum().done(t.startUpload(function(){t.uploader.start()})),t.setLayout()},"{uploader} FilesRemoved":function(){t.setLayout()},"{uploader} FileUploaded":function(i,n,o,a,r){var s=t.uploader.getItem(a),l=e.buildHTML(r.html),c=r.data;l.addClass("new-item").insertAfter(s.element),setTimeout(function(){l.removeClass("new-item")},1),t.uploader.removeItem(a.id),t.trigger("photoAdd",[l,c,t.album]),t.setLayout()}}});t.resolve(i)})}),EasySocial.module("albums/uploader",function(e){var t=this;EasySocial.require().library("plupload").script("albums/uploader.item").view("site/albums/upload.item").done(function(){EasySocial.Controller("Albums.Uploader",{defaultOptions:{view:{uploadItem:"site/albums/upload.item"},direction:"prepend","{uploadButton}":"[data-upload-button]","{uploadItemGroup}":"[data-upload-item-group]","{uploadItem}":"[data-upload-item]","{uploadDropsite}":"[data-upload-dropsite]"}},function(t,i,n){return{init:function(){var i=t.element;t.pluploadController=t.element.addController("plupload",e.extend({"{uploadButton}":t.uploadButton.selector,"{uploadDropsite}":t.uploadDropsite.selector},t.options.settings)),t.plupload=t.pluploadController.plupload,e.IE||"html5"!=t.plupload.runtime||i.addClass("can-drop-file"),i.addClass("can-upload")},setLayout:function(){t.uploadItemGroup().toggleClass("no-upload-items",t.uploadItem().length<1)},items:{},getItem:function(i){var n;return e.isString(i)&&(n=i),i&&i.id&&(n=i.id),t.items[n]},createItem:function(e){var n=t.view.uploadItem({file:e}).addController("EasySocial.Controller.Albums.Uploader.Item",{"{uploader}":t,file:e});return n.element["append"==i.direction?"appendTo":"prependTo"](t.uploadItemGroup()),t.items[e.id]=n,t.setLayout(),t.trigger("QueueCreated",[n]),n},settings:function(e,i){var n=t.plupload.settings;return void 0!==i&&(n[e]=i),e?n[e]:n},start:function(){return t.plupload.start()},stop:function(){return t.plupload.stop()},"{self} FilesAdded":function(i,n,o,a){try{a.reverse(),e.each(a,function(e,i){t.getItem(i)||t.createItem(i)})}catch(e){console.error(e)}},"{self} BeforeUpload":function(e,i,n,o){var a=t.getItem(o);a&&a.setState("preparing")},"{self} UploadFile":function(e,i,n,o){var a=t.getItem(o);a&&a.setState("uploading")},"{self} UploadProgress":function(e,i,n,o){var a=t.getItem(o);a&&(a.setState("uploading"),a.setProgress())},"{self} FileUploaded":function(i,n,o,a,r){var s=t.getItem(a);s&&(e.isPlainObject(r)?s.setState("done"):s.setState("failed"))},"{self} FileError":function(e,i,n,o,a){var r=t.getItem(o);r||(r=t.createItem(o)),r.setState("failed"),r.setMessage(a.message)},"{self} Error":function(e,i,n,o){if(o.file){var a=o.file,r=t.getItem(a);r||(r=t.createItem(a)),r.setState("failed"),r.setMessage(o.message)}},removeItem:function(e){var i=t.getItem(e);i&&(t.plupload.removeFile(i.file()),i.element.remove(),delete t.items[e],t.setLayout())},clear:function(i){e.each(t.items,function(e,i){t.plupload.removeFile(i.file()),i.element.remove(),delete t.items[e]}),t.items={}}}}),t.resolve()})}),EasySocial.module("albums/uploader.item",function(e){var t=this;EasySocial.Controller("Albums.Uploader.Item",{defaultOptions:{"{status}":".upload-status","{filename}":".upload-filename","{progressBar}":".upload-progress-bar","{percentage}":".upload-percentage","{filesizeTotal}":".upload-filesize-total","{filesizeLeft}":".upload-filesize-left","{details}":".upload-details","{detailsButton}":".upload-details-button","{removeButton}":".upload-remove-button","{message}":".upload-message"}},function(t){return{init:function(){t.id=t.element.attr("id");var i=t.file();t.filename().html(i.name),t.setState("pending"),t.setProgress();var n="html4"==t.uploader.plupload.runtime;(e.IE<10||n)&&t.element.addClass("indefinite-progress"),n&&t.element.addClass("no-filesize")},file:function(){var i=t.uploader.plupload.getFile(t.id)||t.options.file;if(i){var n=void 0===i.size||"N/A"==i.size;i.percentage=i.percent+"%",i.filesize=n?"":e.plupload.formatSize(i.size),i.remaining=n?"":e.plupload.formatSize(i.size-(i.loaded||0))}return i},setProgress:function(){var e=t.file(),i=e.percentage;"100%"==i&&(i="99%"),"0%"==i&&(i="1%"),t.progressBar().width(i),t.percentage().html(i),t.filesizeTotal().html(e.filesize),t.filesizeLeft().html(e.remaining)},setState:function(e){t.element.removeClass("pending preparing uploading failed done").addClass(e),t.state=e},setMessage:function(e){t.detailsButton().attr("data-popbox",e)},"{removeButton} click":function(e,i){t.uploader.removeItem(t.id)}}}),t.resolve()}),EasySocial.module("albums/item",function(e){var t=this;EasySocial.require().script("albums/editor").done(),EasySocial.require().library("masonry").done(function(){EasySocial.Controller("Albums.Item",{hostname:"album",defaultOptions:{tilesPerRow:4,editable:!1,multipleSelection:!1,"{header}":"[data-album-header]","{content}":"[data-album-content]","{footer}":"[data-album-footer]","{info}":"[data-album-info]","{title}":"[data-album-title]","{caption}":"[data-album-caption]","{location}":"[data-album-location]","{date}":"[data-album-date]","{cover}":"[data-album-cover]","{photoItemGroup}":"[data-photo-item-group]","{photoItem}":"[data-photo-item]","{photoImage}":"[data-photo-image]","{photoImageCss}":"[data-photo-image-css]","{featuredItem}":"[data-photo-item].featured","{featuredImage}":"[data-photo-item].featured [data-photo-image]","{featuredImageCss}":"[data-photo-item].featured [data-photo-image-css]","{uploadItem}":"[data-photo-upload-item]","{moreButton}":"[data-album-more-button]","{viewButton}":"[data-album-view-button]","{share}":"[data-repost-action]","{likes}":"[data-likes-action]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{counterBar}":"[data-stream-counter]"}},function(t){return{init:function(){t.id=t.element.data("album-id"),t.nextStart=t.element.data("album-nextstart")||-1,t.options.editable&&EasySocial.module("albums/editor").done(function(e){t.editor=t.addPlugin("editor",e)}),t.setLayout(),setTimeout(function(){t.content().addClass("ready")},1),t.addSubscriber(t.photoItem().controllers("EasySocial.Controller.Photos.Item"))},"{window} resize":e.debounce(function(){t.setLayout()},250),currentLayout:function(){return t.element.data("albumLayout")},setLayout_:e.debounce(function(){t.setLayout()},100),setLayout:function(i){var n=t.photoItemGroup(),o=t.currentLayout(),i=i||o,a=t.setLayout.seed,r=a==n.width()&&o==i;hasPhotoItem=t.photoItem().length>0,hasUploadItem=t.uploadItem().length>0,hasItem=hasPhotoItem||hasUploadItem,masonry=n.data("masonry"),layout={currentLayout:o,seed:a,intact:r,hasPhotoItem:hasPhotoItem,hasUploadItem:hasUploadItem,hasItem:hasItem,masonry:masonry},r||(t.element.data("albumLayout",i).switchClass("layout-"+i),t.photoItem().switchClass("layout-"+i),t.setLayout.seed=layout.seed=null,t.trigger("layoutChange",[i,layout])),t.element.toggleClass("has-photos",hasItem),hasItem||n.css("opacity",1);var s="set"+e.String.capitalize(i)+"Layout";t[s](layout),t.setLayout.seed=n.width()},setItemLayout:function(i){if(t.photoItem().attr("data-es-photo-disabled",0),i.intact)i.masonry&&i.masonry.reload();else{o=4;e(".es-main").hasClass("w600")&&(o=2),e(".es-main").hasClass("w320")&&(o=1);var n=t.photoItemGroup(),o=(t.photoItem(),o),a=n.width(),r=Math.floor(a/o)*o/o,s=r,l=r,c=s;if(o>=4)var d=2*r,u=2*s;else var d=l,u=c;t.photoItem.css({width:l,height:c}),t.featuredItem.css({width:d,height:u}),t.uploadItem.css({width:l,height:c}),n.masonry({columnWidth:r,isRTL:t.options.rtl}),setTimeout(function(){n.addTransitionClass("no-transition").masonry("reload")},1)}},setFormLayout:function(e){t.photoItem().attr("data-es-photo-disabled",1),e.masonry&&e.masonry.destroy(),t.clearLayout()},setDialogLayout:function(){t.photoItem().attr("data-es-photo-disabled",1),layout.masonry&&layout.masonry.destroy(),t.clearLayout()},setThumbnailLayout:function(){},setRowLayout:function(){t.photoItem().attr("data-es-photo-disabled",0),t.clearLayout()},clearLayout:function(){t.photoItemGroup().addClass("no-transition"),t.photoItem.css().remove(),t.photoImage.css().remove(),t.photoImageCss.css().remove(),t.featuredItem.css().remove(),t.featuredImage.css().remove(),t.featuredImageCss.css().remove(),t.uploadItem.css().remove(),t.setLayout.seed=null},getSelectedItems:function(){var i=[];return t.photoItem(".selected").each(function(t,n){i.push(e(n).controller("EasySocial.Controller.Photos.Item").data())}),i},"{photoItem} init.photos.item":function(e,i,n){t.addSubscriber(n)},"{photoItem} destroyed":function(){t.setLayout()},"{photoItem} activate":function(e,i,n){if(n)switch(t.currentLayout()){case"item":case"row":e.addClass("loading"),t.browser?(t.browser.open("photo",n.id).always(function(){e.removeClass("loading")}),n.imageLink().route()):window.location=n.imageLink().attr("href");break;case"form":break;case"dialog":var o=t.photoItem(".selected");if(t.options.multipleSelection)e.toggleClass("selected");else{var a=e.hasClass("selected");o.removeClass("selected"),e.toggleClass("selected",!a)}}},"{photoItem} photoFeature":function(e,i,n,o,a){t.setLayout(),n.fail(function(){t.setLayout()})},"{photoItem} photoMove":function(e,i,n,o,a){t.clearMessage(),n.done(function(){o.element.remove(),t.setLayout(),t.photoItem().length<1&&t.trigger("coverRemove",[t])}).fail(function(e,i){t.setMessage(e,i)})},"{photoItem} photoDelete":function(e,i,n,o){t.clearMessage(),n.done(function(){o.element.remove(),t.setLayout(),t.photoItem().length<1&&t.trigger("coverRemove",[t])}).fail(function(e,i){t.setMessage(e,i)})},"{self} albumSave":function(e,i,n){n.done(function(e){t.id=e.id})},"{self} coverChange":function(i,n,o,a){t.cover().css("backgroundImage",e.cssUrl(o.sizes.thumbnail.url))},"{self} coverRemove":function(){t.cover().css("backgroundImage","")},"{viewButton} click":function(e,i){t.browser&&(i.preventDefault(),t.element.addClass("loading"),t.browser.open("Album",t.id))},"{moreButton} click":function(i){-1!=t.nextStart&&(i.disabled()||(i.disabled(!0),EasySocial.ajax("site/controllers/albums/loadMore",{albumId:t.id,start:t.nextStart,layout:t.currentLayout()}).done(function(n,o){t.nextStart=o;var a=t.photoItemGroup();e.each(n,function(t,i){e.buildHTML(i).appendTo(a)}),o<0&&i.hide(),t.setLayout()}).always(function(){i.disabled(!1)})))},"{share} create":function(e,i,n){t.counterBar().removeClass("hide")},"{likes} onLiked":function(e,i,n){t.counterBar().removeClass("hide")},"{likes} onUnliked":function(e,i,n){var o=t.likeContent().hasClass("hide"),a=t.repostContent().hasClass("hide");o&&a&&t.counterBar().addClass("hide")}}}),t.resolve()})}),EasySocial.module("apps/event/discussions",function(e){var t=this;EasySocial.Controller("Events.Item.Discussions",{defaultOptions:{"{filter}":"[data-event-discussions-filter]","{contents}":"[data-event-discussion-contents]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},setContent:function(t){e.contents().removeClass("is-loading"),e.contents().html(t)},setActiveFilter:function(t){e.filter().removeClass("active"),t.addClass("active")},"{filter} click":function(t,i){var n=t.data("filter");e.contents().html("&nbsp;").addClass("is-loading"),e.setActiveFilter(t),EasySocial.ajax("apps/event/discussions/controllers/discussion/getDiscussions",{id:e.options.id,filter:n}).done(function(t,i){i?e.contents().addClass("is-empty"):e.contents().removeClass("is-empty"),e.setContent(t)})}}}),EasySocial.Controller("Events.Item.Discussion",{defaultOptions:{"{form}":"[data-reply-form]","{list}":"[data-reply-list]","{replies}":"[data-reply-item]","{repliesWrap}":"[data-replies-wrapper]","{replyCounter}":"[data-reply-count]","{lock}":"[data-discussion-lock]","{unlock}":"[data-discussion-unlock]","{delete}":"[data-discussion-delete]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.eventId=e.element.data("eventid"),e.implementReply(e.replies()),e.form().implement(EasySocial.Controller.Events.Item.Discussion.Form,{"{parent}":e})},implementReply:function(){e.replies().implement(EasySocial.Controller.Events.Item.Discussion.Reply,{"{parent}":e})},insertReply:function(t){e.element.removeClass("is-unanswered"),e.repliesWrap().removeClass("is-empty"),e.list().append(t),e.implementReply()},updateReplyCounter:function(t){0==t&&e.repliesWrap().addClass("is-empty"),e.replyCounter().html(t)},setResolved:function(){e.element.addClass("is-resolved")},"{unlock} click":function(t,i){EasySocial.ajax("apps/event/discussions/controllers/discussion/unlock",{id:e.options.id}).done(function(){e.element.removeClass("is-locked")})},"{delete} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("apps/event/discussions/controllers/discussion/confirmDelete",{id:e.options.id,eventId:e.options.eventId})})},"{lock} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("apps/event/discussions/controllers/discussion/confirmLock"),bindings:{"{lockButton} click":function(){EasySocial.ajax("apps/event/discussions/controllers/discussion/lock",{id:e.options.id}).done(function(){EasySocial.dialog().close(),e.element.addClass("is-locked")})}}})}}}),EasySocial.Controller("Events.Item.Discussion.Reply",{defaultOptions:{"{acceptAnswer}":"[data-reply-accept-answer]","{delete}":"[data-reply-delete]","{edit}":"[data-reply-edit]","{cancelEdit}":"[data-reply-edit-cancel]","{update}":"[data-reply-edit-update]","{textarea}":"[data-reply-content]","{content}":"[data-reply-display-content]","{alertDiv}":"div.alert-error"}},function(e){return{init:function(){console.log(e.element),e.options.id=e.element.data("id")},"{acceptAnswer} click":function(){EasySocial.ajax("apps/event/discussions/controllers/reply/accept",{id:e.options.id}).done(function(){e.parent.setResolved()})},cancelEditing:function(){e.element.removeClass("is-editing")},"{cancelEdit} click":function(){e.cancelEditing()},"{edit} click":function(){e.element.addClass("is-editing")},"{update} click":function(){var t=e.textarea().val();if(""==t)return e.element.addClass("is-empty"),e.alertDiv().show(),!1;EasySocial.ajax("apps/event/discussions/controllers/reply/update",{id:e.options.id,eventId:e.parent.options.eventId,content:t}).done(function(t){e.content().html(t),e.element.removeClass("is-empty"),e.alertDiv().hide(),e.cancelEditing()})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/discussions/controllers/reply/confirmDelete",{id:e.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/discussions/controllers/reply/delete",{id:e.options.id}).done(function(t){e.parent.updateReplyCounter(t.total_replies),EasySocial.dialog().close(),e.element.remove()})}}})}}}),EasySocial.Controller("Events.Item.Discussion.Form",{defaultOptions:{"{textarea}":"[data-reply-content]","{submitReply}":"[data-reply-submit]"}},function(e){return{init:function(){},"{submitReply} click":function(t,i){var n=e.textarea().val();if(""==n)return e.element.addClass("is-empty"),!1;EasySocial.ajax("apps/event/discussions/controllers/reply/submit",{id:e.parent.options.id,eventId:e.parent.options.eventId,content:n}).done(function(t){e.parent.insertReply(t),e.textarea().val("")})}}}),t.resolve()}),EasySocial.module("apps/event/guests",function(e){var t=this;EasySocial.Controller("Events.Item.Guests",{defaultOptions:{"{filters}":"[data-event-guests-filter]","{content}":"[data-event-guests-content]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.items=e.addPlugin("Item")},"{filters} click":function(t,i){i.preventDefault(),t.route(),e.filters().removeClass("active"),t.addClass("active");var n=t.data("filter");e.content().html("&nbsp;"),e.content().addClass("is-loading"),EasySocial.ajax("apps/event/guests/controllers/events/filterGuests",{id:e.options.id,filter:n}).done(function(t,i){e.content().removeClass("is-loading"),0==i?e.content().addClass("is-empty"):e.content().removeClass("is-empty"),e.content().html(t)})},"{self} emptyGuest":function(){e.content().addClass("is-empty")}}}),EasySocial.Controller("Events.Item.Guests.Item",{defaultOptions:{"{item}":"[data-event-guest-item]","{promote}":"[data-guest-promote]","{demote}":"[data-guest-demote]","{approve}":"[data-guest-approve]","{reject}":"[data-guest-reject]","{remove}":"[data-guest-remove]"}},function(e){return{init:function(){},getItem:function(t){return e.item.of(t)},"{approve} click":function(t){console.log("here");var i=e.getItem(t),n=i.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmApproveGuest",{id:n}),bindings:{"{approveButton} click":function(){EasySocial.ajax("site/controllers/events/approveGuest",{id:n}).done(function(){EasySocial.dialog().close(),i.remove(),0===e.item().length&&e.element.trigger("emptyGuest")})}}})},"{reject} click":function(t){var i=e.getItem(t),n=i.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmRejectGuest",{id:n}),bindings:{"{rejectButton} click":function(){EasySocial.ajax("site/controllers/events/rejectGuest",{id:n}).done(function(){EasySocial.dialog().close(),i.remove(),0===e.item().length&&e.element.trigger("emptyGuest")})}}})},"{promote} click":function(t){var i=e.getItem(t),n=i.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmPromoteGuest",{id:n}),bindings:{"{promoteButton} click":function(){EasySocial.ajax("site/controllers/events/promoteGuest",{id:n}).done(function(){EasySocial.dialog().close(),i.removeClass("is-member").addClass("is-admin")})}}})},"{demote} click":function(t){var i=e.getItem(t),n=i.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmDemoteGuest",{id:n}),bindings:{"{demoteButton} click":function(){EasySocial.ajax("site/controllers/events/demoteGuest",{id:n}).done(function(){EasySocial.dialog().close(),"admin"==e.parent.filters(".active").data("filter")?(i.remove(),0===e.item().length&&e.element.trigger("emptyGuest")):i.removeClass("is-admin").addClass("is-member")})}}})},"{remove} click":function(t,i){var n=e.getItem(t),o=n.data("guestId");EasySocial.dialog({content:EasySocial.ajax("site/views/events/confirmRemoveGuest",{id:o}),bindings:{"{removeButton} click":function(){EasySocial.ajax("site/controllers.events/removeGuest",{id:o}).done(function(){EasySocial.dialog().close(),n.remove(),0===e.item().length&&e.element.trigger("emptyGuest")})}}})}}}),t.resolve()}),EasySocial.module("apps/event/tasks",function(e){var t=this;EasySocial.Controller("Events.Apps.Tasks.Milestones.Browse",{defaultOptions:{eventId:null,"{milestone}":"[data-tasks-milestone-item]"}},function(e){return{init:function(){e.options.eventId=e.element.data("eventid"),e.milestone().addController(EasySocial.Controller.Events.Apps.Tasks.Milestones.Item,{"{parent}":e})}}}),EasySocial.Controller("Events.Apps.Tasks.Milestones.Item",{defaultOptions:{"{complete}":"[data-milestone-mark-complete]","{incomplete}":"[data-milestone-mark-incomplete]","{delete}":"[data-milestone-delete]","{milestone}":"[data-event-tasks-milestone-item]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{incomplete} click":function(t){EasySocial.ajax("apps/event/tasks/controllers/milestone/unresolve",{id:e.options.id,eventId:e.parent.options.eventId}).done(function(){e.element.removeClass("is-due").removeClass("is-completed"),t.hide(),e.complete().show()})},"{complete} click":function(t){EasySocial.ajax("apps/event/tasks/controllers/milestone/resolve",{id:e.options.id,eventId:e.parent.options.eventId}).done(function(){e.element.removeClass("is-due").addClass("is-completed"),t.hide(),e.incomplete().show()})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/tasks/controllers/milestone/confirmDelete",{id:e.options.id,eventId:e.parent.options.eventId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/delete",{id:e.options.id,eventId:e.parent.options.eventId}).done(function(){EasySocial.dialog().close(),e.element.remove()})}}})}}}),EasySocial.Controller("Events.Apps.Tasks",{defaultOptions:{"{form}":"[data-tasks-form]","{formWrapper}":"[data-tasks-form-wrapper]","{taskList}":"[data-tasks-list]","{item}":"[data-tasks-list-item]","{completedList}":"[data-tasks-completed]","{openCounter}":"[data-tasks-open-counter]","{closedCounter}":"[data-tasks-closed-counter]","{completeMilestone}":"[data-milestone-mark-complete]","{incompleteMilestone}":"[data-milestone-mark-incomplete]","{deleteMilestone}":"[data-milestone-delete]","{wrapper}":"[data-tasks-wrapper]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.eventId=t.element.data("eventid"),t.options.milestoneId=t.element.data("milestoneid"),t.form().addController(EasySocial.Controller.Events.Apps.Tasks.Form,{"{parent}":t}),t.implementItemController()},implementItemController:function(){t.item().addController(EasySocial.Controller.Events.Apps.Tasks.Item,{"{parent}":t})},updateOpenCounter:function(e){t.openCounter().html(e)},updateClosedCounter:function(e){t.closedCounter().html(e)},insertCompleted:function(i){e(i).appendTo(t.completedList())},insertTask:function(e){t.formWrapper().after(e),t.implementItemController()},"{uncompleteMilestone} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/unresolve",{id:t.options.milestoneId,eventId:t.options.eventId}).done(function(){t.wrapper().removeClass("is-due").removeClass("is-completed")})},"{completeMilestone} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/resolve",{id:t.options.milestoneId,eventId:t.options.eventId}).done(function(){t.wrapper().removeClass("is-due").addClass("is-completed")})},"{deleteMilestone} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/tasks/controllers/milestone/confirmDelete",{id:t.options.milestoneId,eventId:t.options.eventId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/tasks/controllers/milestone/delete",{id:t.options.id,eventId:t.options.eventId}).done(function(){EasySocial.dialog().close(),window.location=t.options.redirect})}}})}}}),EasySocial.Controller("Events.Apps.Tasks.Item",{defaultOptions:{"{checkbox}":"[data-item-checkbox]","{delete}":"[data-tasks-item-remove]"}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/event/tasks/controllers/tasks/confirmDelete",{eventId:t.parent.options.eventId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/event/tasks/controllers/tasks/delete",{id:t.options.id,eventId:t.parent.options.eventId}).done(function(){EasySocial.dialog().close();var e=parseInt(t.parent.openCounter().html());t.parent.updateOpenCounter(e-1),t.element.remove()})}}})},"{checkbox} change":function(i,n){e(i).is(":checked")?EasySocial.ajax("apps/event/tasks/controllers/tasks/resolve",{id:t.options.id,eventId:t.parent.options.eventId}).done(function(){e=parseInt(t.parent.openCounter().html());t.parent.updateOpenCounter(e-1);var e=parseInt(t.parent.closedCounter().html());t.parent.updateClosedCounter(e+1),t.parent.insertCompleted(t.element)}):EasySocial.ajax("apps/event/tasks/controllers/tasks/unresolve",{id:t.options.id,eventId:t.parent.options.eventId}).done(function(e){i=parseInt(t.parent.openCounter().html());t.parent.updateOpenCounter(i+1);var i=parseInt(t.parent.closedCounter().html());t.parent.updateClosedCounter(i-1),t.parent.insertTask(t.element)})}}}),EasySocial.Controller("Events.Apps.Tasks.Form",{defaultOptions:{"{title}":"[data-form-tasks-title]","{create}":"[data-form-tasks-create]","{assignee}":"[data-form-tasks-assignee]","{due}":"[data-form-tasks-due]","{error}":"[data-tasks-form-error]"}},function(e){return{init:function(){},resetForm:function(){e.element[0].reset()},"{title} keyup":function(t,i){13==i.keyCode&&e.create().click()},"{create} click":function(){if(""==e.title().val())return e.error().removeClass("hide"),!1;e.error().addClass("hide"),EasySocial.ajax("apps/event/tasks/controllers/tasks/save",{title:e.title().val(),assignee:e.assignee().val(),due:e.due().val(),eventId:e.parent.options.eventId,milestoneId:e.parent.options.milestoneId}).done(function(t){e.resetForm();var i=parseInt(e.parent.openCounter().html());e.parent.updateOpenCounter(i+1),e.parent.insertTask(t)})}}}),t.resolve()}),EasySocial.module("apps/fields/event/permalink/content",function(e){var t=this;EasySocial.require().language("FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH","FIELDS_EVENT_PERMALINK_REQUIRED").done(function(e){EasySocial.Controller("Field.Event.Permalink",{defaultOptions:{required:!1,max:0,id:null,clusterid:null,userid:null,"{field}":"[data-field-permalink]","{checkButton}":"[data-permalink-check]","{input}":"[data-permalink-input]","{available}":"[data-permalink-available]"}},function(t){return{state:!1,init:function(){t.options.max=t.field().data("max")},"{checkButton} click":function(){t.delayedCheck()},"{input} change":function(){t.delayedCheck()},"{input} keyup":function(){t.delayedCheck()},delayedCheck:e.debounce(function(){t.checkPermalink()},250),checkPermalink:function(){t.clearError();var i=t.input().val();if(t.available().hide(),t.options.max>0&&i.length>t.options.max)return t.raiseError(e.language("FIELDS_EVENT_PERMALINK_EXCEEDED_MAX_LENGTH")),!1;if(!e.isEmpty(i)){t.checkButton().addClass("btn-loading");var n=e.Deferred();return EasySocial.ajax("fields/event/permalink/isValid",{id:t.options.id,clusterid:t.options.clusterid,permalink:i}).done(function(e){t.clearError(),t.checkButton().removeClass("btn-loading"),t.available().show(),n.resolve()}).fail(function(e){t.raiseError(e),t.checkButton().removeClass("btn-loading"),t.available().hide(),n.reject()}),n}return!t.options.required||!e.isEmpty(i)||(t.available().hide(),t.raiseError(e.language("FIELDS_EVENT_PERMALINK_REQUIRED")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.checkPermalink())}}}),t.resolve()})}),EasySocial.module("apps/fields/event/permalink/sample_content",function(e){var t=this;EasySocial.Controller("Field.Permalink.Sample",{defaultOptions:{"{checkPermalink}":"[data-check-permalink]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"check_permalink":e.checkPermalink().toggle(!!o)}}}}),t.resolve()}),EasySocial.module("apps/fields/event/recurring/content",function(e){var t=this;EasySocial.require().library("datetimepicker").done(function(){EasySocial.Controller("Field.Event.Recurring",{defaultOptions:{"{type}":"[data-recurring-type]","{endBlock}":"[data-recurring-end-block]","{picker}":"[data-recurring-end-picker]","{toggle}":"[data-recurring-end-toggle]","{result}":"[data-recurring-end-result]"}},function(t){return{init:function(){t.picker()._datetimepicker({pickTime:!1,component:"es",useCurrent:!1});var i=t.result().val();if(!e.isEmpty(i)){var n=e.moment(i);t.datetimepicker("setDate",n)}},"{toggle} click":function(){t.picker().focus()},"{picker} dp.change":function(e,i){t.setDateValue(i.date.toDate())},"{type} change":function(e,i){var n=e.val();t.endBlock()["none"===n?"hide":"show"]()},datetimepicker:function(e,i){return t.picker().data("DateTimePicker")[e](i)},setDateValue:function(e){t.result().val(e.getFullYear()+"-"+("00"+(e.getMonth()+1)).slice(-2)+"-"+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2))},"{self} onSubmit":function(e,t,i){i.push(!0)}}}),t.resolve()})}),EasySocial.module("apps/fields/event/startend/content",function(e){var t=this,i=EasySocial.options.momentLang;EasySocial.require().library("datetimepicker","moment/"+i).language("FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED","FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED").done(function(e){EasySocial.Controller("Field.Event.Startend",{defaultOptions:{dateFormat:"",allowTime:!0,allowTimezone:!0,disallowPast:!1,minuteStepping:15,yearfrom:"",yearto:"",requiredEnd:!1,allday:!1,"{startForm}":"[data-event-start]","{endForm}":"[data-event-end]","{timezone}":"[data-event-timezone]"}},function(t){return{init:function(){e.isEmpty(t.options.yearto)?t.options.yearto=(new Date).getFullYear()+100:t.options.yearto=parseInt(t.options.yearto)+1,t.options.yearfrom=t.options.yearfrom||1930,t.startDatetime=t.startForm().addController("EasySocial.Controller.Field.Event.Startend.Form",{"{parent}":t,type:"start"}),t.endDatetime=t.endForm().addController("EasySocial.Controller.Field.Event.Startend.Form",{"{parent}":t,type:"end"})},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())},validateInput:function(){return t.clearError(),e.isEmpty(t.startDatetime.datetime().val())?(t.raiseError(e.language("FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_START_REQUIRED")),!1):!t.options.requireEnd||!e.isEmpty(t.endDatetime.datetime().val())||(t.raiseError(e.language("FIELDS_EVENT_STARTEND_VALIDATION_DATETIME_END_REQUIRED")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")}}}),EasySocial.Controller("Field.Event.Startend.Form",{defaultOptions:{type:null,"{picker}":"[data-picker]","{toggle}":"[data-picker-toggle]","{datetime}":"[data-datetime]"}},function(t){return{init:function(){t.load()},"{window} easysocial.fields.allday.change":function(e,i,n){t.datetimepicker("destroy"),t.parent.options.allday=1==n,t.load()},load:function(){var n=new e.moment;t.parent.options.disallowPast?n.date(n.date()-1):n.year(t.parent.options.yearfrom);var o=t.parent.options.allowTime&&!t.parent.options.allday,a=t.parent.options.dateFormat;o||(a=a.substr(0,10)),t.picker()._datetimepicker({component:"es",useCurrent:!1,format:a,minDate:n,maxDate:new e.moment({y:t.parent.options.yearto}),icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!1,pickTime:o,minuteStepping:parseInt(t.parent.options.minuteStepping),language:i});var r=t.datetime().val();if(!e.isEmpty(r)){var s=e.moment(r);t.datetimepicker("setDate",s)}},datetimepicker:function(e,i){return t.picker().data("DateTimePicker")[e](i)},"{toggle} click":function(){t.picker().focus()},"{picker} dp.change":function(i,n){t.setDateValue(n.date.toDate()),t.parent.element.trigger("event"+e.String.capitalize(t.options.type),[n.date])},"{picker} change":function(i,n){e.isEmpty(i.val())&&t.datetime().val("")},setDateValue:function(e){t.datetime().val(e.getFullYear()+"-"+("00"+(e.getMonth()+1)).slice(-2)+"-"+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2))},"{parent} eventStart":function(e,i,n){t.options.type},"{parent} eventEnd":function(e,i,n){t.options.type}}}),t.resolve()})}),EasySocial.module("apps/fields/event/startend/display",function(e){var t=this;EasySocial.require().library("chosen","popbox").language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE","FIELDS_USER_DATETIME_TIMEZONE_CHECKING").done(function(e){EasySocial.Controller("Field.Event.Startend.Display",{defaultOptions:{id:null,userid:null,"{box}":"[data-startend-box]"}},function(e){return{init:function(){e.box().addController("EasySocial.Controller.Field.Event.Startend.Display.Box",{"{parent}":e})}}}),EasySocial.Controller("Field.Event.Startend.Display.Box",{defaultOptions:{date:null,timezone:null,local:null,"{toggle}":"[data-popbox]","{content}":"[data-popbox-content]","{date}":"[data-date]","{timezone}":"[data-timezone]","{loading}":"[data-loading]"}},function(t){return{init:function(){t.options.timezone=t.timezone().data("timezone"),t.options.date=t.date().data("date-utc"),t.options.local=-(new Date).getTimezoneOffset()/60;var e=t.content().html(),i=t.toggle().data("popbox-position");t.toggle().popbox({content:e,id:"fd",component:"es",type:"timezone",toggle:"click",position:i}).attr("data-popbox","")},"{toggle} popboxActivate":function(e,i,n){n.tooltip.addController("EasySocial.Controller.Field.Event.Startend.Display.Timezone",{"{parent}":t})},datetime:e.memoize(function(e){return EasySocial.ajax("fields/event/startend/getDatetime",{id:t.parent.options.id,userid:t.parent.options.userid,tz:e,local:t.options.local,datetime:t.options.date})})}}),EasySocial.Controller("Field.Event.Startend.Display.Timezone",{defaultOptions:{"{timezones}":"[data-timezone-select]","{reset}":"[data-timezone-reset]","{local}":"[data-timezone-local]"}},function(t){return{init:function(){t.timezones().chosen({search_contains:!0})},"{timezones} change":function(i,n){var o=i.val();t.parent.date().html(e.language("FIELDS_USER_DATETIME_TIMEZONE_CHECKING")),t.parent.timezone().html("local"===o?e.language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE"):o),t.parent.datetime(o).done(function(e){t.parent.date().html(e)})},"{reset} click":function(){t.setTimezone(t.parent.options.timezone)},"{local} click":function(){t.setTimezone("local")},setTimezone:function(e){t.timezones().val(e).trigger("liszt:updated").trigger("change")}}}),t.resolve()})}),EasySocial.module("apps/fields/group/permalink/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_GROUP_PERMALINK_REQUIRED").done(function(e){EasySocial.Controller("Field.Group.Permalink",{defaultOptions:{required:!1,max:0,id:null,groupid:null,userid:null,"{field}":"[data-field-permalink]","{checkButton}":"[data-permalink-check]","{input}":"[data-permalink-input]","{available}":"[data-permalink-available]"}},function(t){return{state:!1,init:function(){t.options.max=t.field().data("max")},"{checkButton} click":function(){t.delayedCheck()},"{input} change":function(){t.delayedCheck()},"{input} keyup":function(){t.delayedCheck()},delayedCheck:e.debounce(function(){t.checkPermalink()},250),checkPermalink:function(){t.clearError();var i=t.input().val();if(t.available().hide(),t.options.max>0&&i.length>t.options.max)return t.raiseError(e.language("PLG_FIELDS_GROUP_PERMALINK_EXCEEDED_MAX_LENGTH")),!1;if(!e.isEmpty(i)){t.checkButton().addClass("btn-loading");var n=e.Deferred();return EasySocial.ajax("fields/group/permalink/isValid",{id:t.options.id,groupid:t.options.groupid,permalink:i}).done(function(e){t.clearError(),t.checkButton().removeClass("btn-loading"),t.available().show(),n.resolve()}).fail(function(e){t.raiseError(e),t.checkButton().removeClass("btn-loading"),t.available().hide(),n.reject()}),n}return!t.options.required||!e.isEmpty(i)||(t.available().hide(),t.raiseError(e.language("PLG_FIELDS_GROUP_PERMALINK_REQUIRED")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.checkPermalink())}}}),t.resolve()})}),EasySocial.module("apps/fields/group/permalink/sample_content",function(e){var t=this;EasySocial.Controller("Field.Permalink.Sample",{defaultOptions:{"{checkPermalink}":"[data-check-permalink]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"check_permalink":e.checkPermalink().toggle(!!o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/address/content",function(e){var t=this;EasySocial.require().library("gmaps").language("PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS1","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ADDRESS2","PLG_FIELDS_ADDRESS_PLEASE_ENTER_CITY","PLG_FIELDS_ADDRESS_PLEASE_ENTER_STATE","PLG_FIELDS_ADDRESS_PLEASE_ENTER_ZIP","PLG_FIELDS_ADDRESS_PLEASE_ENTER_COUNTRY").done(function(){EasySocial.Controller("Field.Address",{defaultOptions:{required:{},show:{},"{field}":"[data-field-address]","{address1}":"[data-field-address-address1]","{address2}":"[data-field-address-address2]","{city}":"[data-field-address-city]","{state}":"[data-field-address-state]","{country}":"[data-field-address-country]","{zip}":"[data-field-address-zip]","{required}":"[data-required]","{notice}":"[data-check-notice]"}},function(t){return{init:function(){},fields:["address1","address2","city","state","zip","country"],validateInput:function(){t.clearError();var i=!1;return t.clearError(),e.each(t.fields,function(n,o){var a=t[o]();a.removeClass("has-error");var r=a.val();e.isEmpty(r)&&t.options.required[o]&&t.options.show[o]&&(a.addClass("has-error"),i||(t.raiseError(e.language("PLG_FIELDS_ADDRESS_PLEASE_ENTER_"+o.toUpperCase())),i=!0))}),!0},"{address1}, {address2}, {zip}, {city}, {state} blur":function(){t.validateInput()},"{country} change":function(i){t.validateInput(),t.state().is("select")&&EasySocial.ajax("fields/user/address/getStates",{id:t.options.id,country:i.val()}).done(function(i){t.state().html(""),e.each(i,function(i,n){e("<option></option>").html(n).val(n).appendTo(t.state())})})},raiseError:function(e){t.notice().css("color","#a94442").text(e).parent(".controls-error").show()},clearError:function(){t.notice().parent(".controls-error").hide()},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())},"{self} onConfigChange":function(i,n,o,a){var r=["address1","address2","city","zip","state","country"];e.inArray(o,r)>=0&&(t.options.required[o]=!!a),t.required().hide(),e.each(r,function(e,i){if(t.options[i])return t.required().show(),!1})}}}),t.resolve()})}),EasySocial.module("apps/fields/user/address/display_content",function(e){var t=this;EasySocial.require().library("gmaps").done(function(){EasySocial.Controller("Field.Address.Display",{defaultOptions:{latitude:null,longitude:null,ratio:1,"{base}":"[data-location-base]","{map}":"[data-location-map]","{mapImage}":"[data-location-map-image]"}},function(t){return{init:function(){var e=t.map();t.options.latitude=e.data("latitude"),t.options.longitude=e.data("longitude"),t.setLayout()},"{window} resize":e.debounce(function(){t.setLayout()},250),navigate:function(i,n){var o=t.mapImage(),a=Math.floor(o.width()),r=Math.floor(o.height()),s=e.GMaps.staticMapURL({size:[a,r],lat:i,lng:n,markers:[{lat:i,lng:n}]});o.attr("src",s).data({width:a,height:r}),t.base().addClass("has-location")},setLayout:function(){setTimeout(function(){t.options.latitude&&t.options.longitude&&t.navigate(t.options.latitude,t.options.longitude)},1)},"{self} onShow":function(){t.setLayout()}}}),t.resolve()})}),EasySocial.module("apps/fields/user/address/maps",function(e){var t=this;e.template("easysocial/maps.suggestion",'<div class="es-story-location-suggestion" data-location-suggestion><span class="formatted_address">[%= location.formatted_address %]</span></div>'),EasySocial.require().library("gmaps","placeholder").language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT").done(function(){var i={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller("Field.Address.Maps",{defaultOptions:{required:null,zoom:2,latitude:null,longitude:null,address:null,singleLocation:!0,required:!1,ratio:3,"{field}":"[data-field-address]","{base}":"[data-location-base]","{map}":"[data-location-map]","{mapImage}":"[data-location-map-image]","{detectButton}":"[data-location-detect]","{removeButton}":"[data-location-remove]","{form}":"[data-location-form]","{textbox}":"[data-location-textbox]","{textField}":"[data-location-textfield]","{autocomplete}":"[data-location-autocomplete]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-location-suggestion]","{source}":"[data-location-source]",view:{suggestion:"maps.suggestion"}}},function(t){return{init:function(){if(navigator.geolocation&&t.base().addClass("is-detectable"),t.textField().placeholder(),t.textField().removeAttr("disabled"),!e.isEmpty(t.source().val())){var i=JSON.parse(t.source().val());i.latitude&&i.longitude&&(t.navigate(i.latitude,i.longitude),t.base().addClass("has-location"))}},"{window} resize":e.debounce(function(){var e=JSON.parse(t.source().val());if(e.latitude&&e.longitude){var i=t.mapImage();i.data("width")!==i.width()&&t.navigate(e.latitude,e.longitude)}},250),"{self} onShow":function(){var e=JSON.parse(t.source().val());if(e.latitude&&e.longitude){var i=t.mapImage();i.data("width")!==i.width()&&t.navigate(e.latitude,e.longitude)}},navigate:function(i,n){t.field().css({"max-width":"none"});var o=t.mapImage(),a=(Math.floor(o.width()),Math.floor(o.height()),e.GMaps.staticMapURL({size:[1280,1280],lat:i,lng:n,sensor:!0,scale:2,markers:[{lat:i,lng:n}]}));e.Image.get(a).done(function(){o.css({backgroundImage:e.cssUrl(a),backgroundSize:"cover",backgroundPosition:"center center"}),t.base().addClass("has-location")}).always(function(){base.removeClass("is-loading")})},locations:{},lastQueryAddress:null,results:[],result:null,"{textField} keypress":function(n,o){switch(o.keyCode){case i.UP:var a=e(t.suggestion(".active").prev(t.suggestion.selector)[0]||t.suggestion(":last")[0]);t.suggestion().removeClass("active"),a.addClass("active").trigger("activate"),t.suggestions().scrollTo(a,{offset:-1*a.height()}),o.preventDefault();break;case i.DOWN:var r=e(t.suggestion(".active").next(t.suggestion.selector)[0]||t.suggestion(":first")[0]);t.suggestion().removeClass("active"),r.addClass("active").trigger("activate"),t.suggestions().scrollTo(r,{offset:-1*r.height()}),o.preventDefault();break;case i.ENTER:var s=t.suggestion(".active").data("location");t.set(s),t.hideSuggestions();break;case i.ESCAPE:t.hideSuggestions()}},"{textField} keyup":function(n,o){switch(o.keyCode){case i.UP:case i.DOWN:case i.LEFT:case i.RIGHT:case i.ENTER:case i.ESCAPE:break;default:var a=e.trim(n.val());""===a&&(t.base().removeClass("has-location"),t.hideSuggestions());var r=t.locations[a];r?(t.lastQueryAddress=a,t.suggest(r)):t.lookup(a)}},lookup:e.debounce(function(i){t.base().addClass("is-busy"),e.GMaps.geocode({address:i,callback:function(e,n){t.base().removeClass("is-busy"),"OK"==n&&(t.locations[i]=e,t.suggest(e),t.lastQueryAddress=i)}})},250),suggest:function(i){var n=t.suggestions();n.empty(),i.length<0||(t.results=i,e.each(i,function(e,i){t.view.suggestion({location:i}).data("location",i).appendTo(n)}),t.showSuggestions())},showSuggestions:function(){t.focusSuggestion=!0,t.element.find(".es-story-footer").addClass("swap-zindex"),setTimeout(function(){t.autocomplete().addClass("active");var i=e(document),n="click.es.story.location";i.off(n).on(n,function(o){e(o.target).parents().andSelf().filter(t.element).length>0||(i.off(n),t.hideSuggestions())})},500)},hideSuggestions:function(){t.focusSuggestion=!1,t.autocomplete().removeClass("active"),e(document).off("click.es.story.location"),setTimeout(function(){t.focusSuggestion||t.element.find(".es-story-footer").removeClass("swap-zindex")},500)},"{suggestion} activate":function(e,i){var n=e.data("location");t.navigate(n.geometry.location.lat(),n.geometry.location.lng())},"{suggestion} mouseover":function(e){t.suggestion().removeClass("active"),e.addClass("active").trigger("activate")},"{suggestion} click":function(e,i){var n=e.data("location");t.set(n),t.hideSuggestions()},set:function(e){t.currentLocation=e;var i=e.geometry.location.lat(),n=e.geometry.location.lng();t.navigate(i,n);var o=e.formatted_address;t.textField().val(o),t.lastQueryAddress=o,t.base().addClass("has-location"),t.result=e;var a=t.getResult("source");t.source().val(JSON.stringify(a))},unset:function(){t.currentLocation=null,t.textField().val(""),t.mapImage().attr("src",""),t.base().removeClass("has-location"),t.source().val("")},detectTimer:null,"{detectButton} click":function(){t.textbox();t.base().addClass("is-busy"),clearTimeout(t.detectTimer),t.detectTimer=setTimeout(function(){t.base().removeClass("is-busy")},8e3),e.GMaps.geolocate({success:function(i){e.GMaps.geocode({lat:i.coords.latitude,lng:i.coords.longitude,callback:function(e,i){"OK"==i&&(t.suggest(e),t.textField().focus())}})},error:function(t){switch(t.code){case 1:e.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:e.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:e.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR")}},always:function(){clearTimeout(t.detectTimer),t.base().removeClass("is-busy")}})},"{removeButton} click":function(){t.unset(),t.hideSuggestions()},getResult:function(i){if(!t.result){if(0===t.results.length)return!1;t.result=t.results[0]}var n=t.result;if(void 0===i)return n;switch(i){case"coords":return{lat:n.geometry.location.lat(),lng:n.geometry.location.lng()};case"lat":case"latitude":return n.geometry.location.lat();case"lng":case"longitude":return n.geometry.location.lng();case"address":return n.formatted_address;case"viewport":return n.geometry.viewport;case"bounds":return n.geometry.bounds||n.geometry.viewport;case"source":var o={};e.each(n.address_components,function(e,t){t.types[0]&&(o[t.types[0]]=t.long_name)});var a={address1:["street_address","route"],address2:["intersection","colloquial_area","neighborhood","premise","subpremise"],city:["locality","sublocality","sublocality_level_1","sublocality_level_2","sublocality_level_3","sublocality_level_4","sublocality_level_5"],state:["administrative_area_level_1","administrative_area_level_2","administrative_area_level_3"],zip:"postal_code",country:"country"},r={};return e.each(a,function(t,i){if(r[t]="",e.isArray(i))return e.each(i,function(e,i){return void 0===o[i]||(r[t]=o[i],!1)}),!0;void 0!==o[i]&&(r[t]=o[i])}),e.extend(r,{components:o,address:n.formatted_address,latitude:n.geometry.location.lat(),longitude:n.geometry.location.lng()})}}}}),t.resolve()})}),EasySocial.module("apps/fields/user/avatar/content",function(e){var t=this;EasySocial.require().library("image","imgareaselect").stylesheet("imgareaselect/default").language("PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE").done(function(){EasySocial.Controller("Field.Avatar",{defaultOptions:{required:!1,id:0,group:null,origSource:null,defaultAvatar:null,hasAvatar:null,"{field}":"[data-field-avatar]","{gallery}":"[data-field-avatar-gallery]","{galleryList}":"[data-field-avatar-gallery-items]","{galleryItem}":"[data-field-avatar-gallery-item]","{frame}":"[data-field-avatar-frame]","{viewport}":"[data-field-avatar-viewport]","{avatarSource}":"[data-field-avatar-source]","{avatarData}":"[data-field-avatar-data]","{avatarPath}":"[data-field-avatar-path]","{avatarType}":"[data-field-avatar-type]","{avatarName}":"[data-field-avatar-name]","{file}":"[data-field-avatar-file]","{image}":"[data-field-avatar-selected]","{note}":"[data-field-avatar-note]","{actions}":"[data-field-avatar-actions]","{cancel}":"[data-field-avatar-actions-cancel]","{crop}":"[data-field-avatar-actions-crop]","{removeFrame}":"[data-field-avatar-remove]","{remove}":"[data-field-avatar-remove-button]","{revertFrame}":"[data-field-avatar-revert]","{revert}":"[data-field-avatar-revert-button]","{loader}":"[data-field-avatar-loader]"}},function(t){return{init:function(){t.state=!!t.options.hasAvatar},state:!0,"{file} change":function(i,n){if(!e.isEmpty(i.val())){var o=i.val().replace(/\\/g,"/");i.parents(".input-group").find(":text").val(o),t.state=!1,t.loader().show(),t.frame().hide(),t.file().hide(),t.clearError(),EasySocial.ajax("fields/"+t.options.group+"/avatar/upload",{id:t.options.id,files:i},{type:"iframe"}).done(function(e,i,n){t.avatarName().val(e.name),t.avatarSource().val(i),t.avatarPath().val(n),t.avatarType().val("upload"),t.setLayout(i),t.galleryItem().removeClass("active"),t.removeFrame().hide(),t.revertFrame().hide(),t.state=!0}).fail(function(e){t.loader().hide(),t.raiseError(e),t.file().show().val(""),t.frame().show()})}},setLayout:function(i){var n=e.Image.get(i),o=t.frame();n.done(function(n,a){o.css("background-image",e.cssUrl(i)),o.addClass("avatar-frame-crop"),o.show(),t.loader().hide(),t.actions().show(),t.note().show(),t.viewport().imgAreaSelect({remove:!0}),t.viewport().show();var r=e.Image.resizeWithin(a.width,a.height,o.width(),o.height()),s=Math.min(r.width,r.height),l=Math.floor((r.width-s)/2),c=Math.floor((r.height-s)/2),d=l+s,u=c+s;t.viewport().css(r).imgAreaSelect({handles:!0,aspectRatio:"1:1",parent:o,x1:l,y1:c,x2:d,y2:u,onSelectEnd:function(e,i){if(!("0"==i.width&&"0"==i.height)){var n=JSON.stringify(t.data());t.avatarData().val(n)}}})})},"{cancel} click":function(){t.actions().hide(),t.note().hide(),t.frame().hide(),t.file().show(),t.file().val(""),t.file().parents(".input-group").find(":text").val(""),t.avatarSource().val(""),t.avatarPath().val(""),t.avatarData().val(""),t.avatarType().val(""),t.viewport().hide().imgAreaSelect({remove:!0}),e.isEmpty(t.options.origSource)||t.frame().css("background-image",e.cssUrl(t.options.origSource)).removeClass("avatar-frame-crop").show(),t.options.hasAvatar&&t.removeFrame().show()},data:function(){var e=t.viewport(),i=e.width(),n=e.height(),o=e.imgAreaSelect({instance:!0}).getSelection();return{top:o.y1/n,left:o.x1/i,width:o.width/i,height:o.height/n}},"{gallery} click":function(){t.galleryList().toggle()},"{galleryItem} click":function(e,i){if(!e.hasClass("active")){var n=e.data("id");t.galleryItem().removeClass("active"),e.addClass("active"),t.state=!1,t.loader().show(),t.frame().hide(),t.file().hide(),t.file().val(""),t.file().parents(".input-group").find(":text").val(""),t.clearError(),t.avatarType().val("gallery"),t.avatarSource().val(n),EasySocial.ajax("fields/user/avatar/loadDefault",{avatarId:n}).done(function(e){t.frame().css("background-image","url("+e+")"),t.frame().show(),t.frame().removeClass("avatar-frame-crop"),t.loader().hide(),t.viewport().hide(),t.viewport().imgAreaSelect({remove:!0}),t.actions().hide(),t.note().hide(),t.file().show(),t.revertFrame().show(),t.removeFrame().hide(),t.state=!0})}},"{remove} click":function(){t.avatarType().val("remove"),t.frame().css("background-image",e.cssUrl(t.options.defaultAvatar)),t.removeFrame().hide(),t.options.hasAvatar&&t.revertFrame().show(),t.state=!1},"{revert} click":function(){t.avatarType().val(""),t.frame().css("background-image",e.cssUrl(t.options.origSource)),t.options.hasAvatar&&t.removeFrame().show(),t.revertFrame().hide(),t.galleryItem().removeClass("active"),t.state=!0},"{self} onSubmit":function(i,n,o){t.options.required&&(t.state||t.raiseError(e.language("PLG_FIELDS_AVATAR_VALIDATION_EMPTY_PROFILE_PICTURE")),o.push(t.state))},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/avatar/sample_content",function(e){var t=this;EasySocial.Controller("Field.Avatar.Sample",{defaultOptions:{"{upload}":"[data-avatar-upload]","{gallery}":"[data-avatar-gallery]","{galleryTitle}":"[data-avatar-gallery-title]","{galleryButton}":"[data-avatar-gallery-button]","{gallerySelection}":"[data-avatar-gallery-selection]"}},function(e){return{"{self} onConfigChange":function(t,i,n,o){switch(n){case"upload":e.upload().toggle(o);break;case"gallery":e.gallery().toggle(o);break;case"use_gallery_button":e.galleryButton().toggle(o),e.gallerySelection().toggle(!o),e.galleryTitle().toggle(!o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/checkbox/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM").done(function(){EasySocial.Controller("Field.Checkbox",{defaultOptions:{required:!1,"{item}":"[data-field-checkbox-item]"}},function(t){return{init:function(){},validateInput:function(){return t.clearError(),!t.options.required||0!=t.item(":checked").length||(t.raiseError(),!1)},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_CHECKBOX_CHECK_AT_LEAST_ONE_ITEM")])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/checkbox/sample_content",function(e){var t=this;EasySocial.require().view("fields/user/checkbox/item").done(function(e){EasySocial.Controller("Field.Checkbox.Sample",{defaultOptions:{"{checkboxes}":"[data-checkboxes]","{checkbox}":"[data-checkbox]","{checkboxInput}":"[data-checkbox-input]","{checkboxTitle}":"[data-checkbox-title]",view:{sample:"fields/user/checkbox/item"}}},function(e){return{init:function(){},"{self} onChoiceTitleChanged":function(t,i,n,o){e.checkboxTitle().eq(n).text(o)},"{self} onChoiceValueChanged":function(t,i,n,o){e.checkboxInput().eq(n).val(o)},"{self} onChoiceAdded":function(t,i,n,o){e.checkbox().eq(n).length>0?e.checkbox().eq(n).before(e.view.sample()):e.checkboxes().append(e.view.sample())},"{self} onChoiceRemoved":function(t,i,n){e.checkbox().eq(n).remove()},"{self} onChoiceToggleDefault":function(t,i,n,o){var a=e.checkboxInput().eq(n);o?a.prop("checked",!0):a.prop("checked",!1)}}}),t.resolve()})}),EasySocial.module("apps/fields/user/country/content",function(e){var t=this;EasySocial.require().library("textboxlist").language("PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED","PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR","PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR").done(function(){EasySocial.Controller("Field.Country",{defaultOptions:{fieldname:"",required:!1,id:null,min:null,max:null,selecttype:"textboxlist","{field}":"[data-field-country]","{inputTextboxlist}":"[data-country-select-textboxlist]","{inputMultilist}":"[data-country-select-multilist]","{inputCheckbox}":"[data-country-select-checkbox]","{inputCheckboxes}":"[data-country-select-checkbox] input","{inputDropdown}":"[data-country-select-dropdown]"}},function(t){return{init:function(){t.options.max=t.field().data("max"),t.options.min=t.field().data("min"),t.options.selecttype=t.field().data("select-type"),"textboxlist"===t.options.selecttype&&EasySocial.module("field.country/"+t.options.id).done(function(e){t.inputTextboxlist().textboxlist({component:"es",name:t.options.fieldname+"[]",max:t.options.max<1?null:t.options.max,plugin:{autocomplete:{exclusive:!0,query:e}}})})},"{inputMultilist} change":function(e,i){if(t.options.max>0&&e.val().length>t.options.max)return e.val(t.lastValidSelection?t.lastValidSelection:""),!1;t.lastValidSelection=e.val()},"{inputCheckboxes} change":function(e,i){var n=t.inputCheckboxes(":checked").length;if(t.options.max>0&&n>t.options.max)return e.removeAttr("checked"),!1},validateInput:function(){var i=null;if("textboxlist"===t.options.selecttype&&(i=t.inputTextboxlist().controller("textboxlist").getAddedItems()),"multilist"===t.options.selecttype&&(i=t.inputMultilist().val()),"checkbox"===t.options.selecttype&&(i=t.inputCheckboxes(":checked")),"dropdown"===t.options.selecttype){var n=t.inputDropdown().val();e.isEmpty(n)||(i=[n])}var o=i?i.length:0;return!t.options.required&&0===o||(t.options.required&&o<1?(t.raiseError(e.language("PLG_FIELDS_COUNTRY_VALIDATION_REQUIRED")),!1):t.options.min>0&&o<t.options.min?(t.raiseError(e.language("PLG_FIELDS_COUNTRY_VALIDATION_MINIMUM_ERROR")),!1):!(t.options.max>0&&o>t.options.max)||(t.raiseError(e.language("PLG_FIELDS_COUNTRY_VALIDATION_MAXIMUM_ERROR")),!1))},raiseError:function(e){t.trigger("error",[e])},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/country/sample_content",function(e){var t=this;EasySocial.Controller("Field.Country.Sample",{defaultOptions:{"{inputGeneral}":"[data-country-select]","{inputTextboxlist}":"[data-country-select-textboxlist]","{inputMultilist}":"[data-country-select-multilist]","{inputCheckbox}":"[data-country-select-checkbox]","{inputDropdown}":"[data-country-select-dropdown]","{maxMessage}":"[data-country-max-message]","{maxCount}":"[data-country-max-count]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"select_type":e.inputGeneral().hide(),"textboxlist"===o&&e.inputTextboxlist().show(),"multilist"===o&&e.inputMultilist().show(),"checkbox"===o&&e.inputCheckbox().show(),"dropdown"===o&&e.inputDropdown().show();break;case"multilist_size":e.inputMultilist().attr("size",o);break;case"show_max_message":e.maxMessage().toggle(!!o);break;case"max":e.maxCount().text(o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/cover/content",function(e){var t=this;EasySocial.require().library("image").language("PLG_FIELDS_COVER_VALIDATION_REQUIRED").done(function(){EasySocial.Controller("Field.Cover",{defaultOptions:{id:0,group:null,required:!1,hasCover:!0,defaultCover:null,ratio:3,"{image}":"[data-field-cover-image]","{data}":"[data-field-cover-data]","{position}":"[data-field-cover-position]","{file}":"[data-field-cover-file]","{note}":"[data-field-cover-note]","{loader}":"[data-field-cover-loader]","{error}":"[data-field-cover-error]","{removeButton}":"[data-field-cover-remove-button]","{revertFrame}":"[data-field-cover-revert]","{revertButton}":"[data-field-cover-revert-button]"}},function(t){return{init:function(){t.setFrame(),t.setLayout(),t.origCover=t.options.hasCover?e.uri(t.image().css("backgroundImage")).extract(0):null,t.origPosition=t.options.hasCover?t.image().css("backgroundPosition"):null},"{self} onShow":function(){setTimeout(function(){t.setLayout()},1)},setFrame:function(){var e=t.image().width()/t.options.ratio;t.image().css("height",e)},"{window} resize":e.debounce(function(){t.setFrame()},250),imageLoaders:{},"{file} change":function(i,n){if(!e.isEmpty(i.val())){var o=i.val().replace(/\\/g,"/");i.parents(".input-group").find(":text").val(o),t.loader().show(),t.error().hide(),t.image().hide(),t.note().hide(),t.file().hide(),EasySocial.ajax("fields/"+t.options.group+"/cover/upload",{id:t.options.id,files:i},{type:"iframe"}).done(function(i){var n=JSON.stringify(i);t.data().val(n);var o=JSON.stringify({x:.5,y:.5});t.position().val(o),t.position().val();var a=i.large.uri,r=t.imageLoaders;(r[a]||(r[a]=e.Image.get(a))).done(function(e){t.setLayout.image=e,t.file().show(),t.image().show(),t.note().show(),t.loader().hide(),t.revertFrame().hide(),t.removeButton().show(),t.setCover(i.large.uri)})}).fail(function(e){t.loader().hide(),t.file().show(),t.error().show().html(e)})}},setLayout:function(){var i=t.image(),n=t.setLayout.image;if(n){var o=n.data("width"),a=n.data("height"),r=i.width(),s=i.height(),l=e.Image.resizeProportionate(o,a,r,s,"outer");t.availableWidth=r-l.width,t.availableHeight=s-l.height,t.setFrame()}else{var c=e.uri(i.css("backgroundImage")).extract(0);if(!c)return;var d=t.imageLoaders;(d[c]||(d[c]=e.Image.get(c))).done(function(e){t.setLayout.image=e,t.setLayout()})}},setCover:function(i,n){n=n||"50% 50%",t.image().css({backgroundImage:e.cssUrl(i),backgroundPosition:n}),t.setLayout(),t.image().addClass("cover-move"),t.note().show()},x:.5,y:.5,moveCover:function(e,i,n){n||(n=t.image());var o=t.availableWidth,a=t.availableHeight,r=0==o?0:t.x+(e/o||0),s=0==a?0:t.y+(i/a||0);r<0&&(r=0),r>1&&(r=1),s<0&&(s=0),s>1&&(s=1),n.css("backgroundPosition",100*(t.x=r)+"% "+100*(t.y=s)+"% ");var l={x:t.x,y:t.y};t.position().val(JSON.stringify(l))},"{image} mousedown":function(i,n){n.target===t.image()[0]&&n.preventDefault();var o=t.image(),a=o.css("backgroundPosition").split(" ");t.x=parseInt(a[0])/100,t.y=parseInt(a[1])/100;var r=n.pageX,s=n.pageY;e(document).on("mousemove.movingCover mouseup.movingCover",function(e){t.moveCover(-1*(r-(r=e.pageX)),-1*(s-(s=e.pageY)),o)}).on("mouseup.movingCover",function(){e(document).off("mousemove.movingCover mouseup.movingCover")})},"{removeButton} click":function(i){var n=t.data().val();e.isEmpty(n)?t.options.hasCover&&(t.setCover(t.options.defaultCover),t.data().val("delete"),i.hide(),t.revertFrame().show()):(t.origData=n,t.origPosition=t.position().val(),t.data().val(""),t.position().val(""),t.file().val(""),t.file().parents(".input-group").find(":text").val(""),t.options.hasCover?t.setCover(t.origCover):(t.setCover(t.options.defaultCover),t.data().val("delete"),i.hide()))},"{revertButton} click":function(){t.setCover(t.origCover,t.origPosition),t.revertFrame().hide(),t.removeButton().show(),t.data().val(""),t.position().val(""),t.file().val(""),t.file().parents(".input-group").find(":text").val("")},"{self} onSubmit":function(i,n,o){t.options.required&&!t.options.hasCover&&e.isEmpty(t.data().val())&&(t.raiseError(e.language("PLG_FIELDS_COVER_VALIDATION_REQUIRED")),o.push(!1))},raiseError:function(e){t.trigger("error",[e])}}}),t.resolve()})}),EasySocial.module("apps/fields/user/currency/sample_content",function(e){var t=this;EasySocial.Controller("Field.Currency.Sample",{defaultOptions:{}},function(e){return{init:function(){},"{self} onConfigChange":function(e,t,i,n){i}}}),t.resolve()}),EasySocial.module("apps/fields/user/datetime/content",function(e){var t=this;EasySocial.require().library("datetimepicker","chosen").language("PLG_FIELDS_DATETIME_VALIDATION_INVALID_DATETIME_FORMAT","PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME").done(function(e){EasySocial.Controller("Field.Datetime",{defaultOptions:{required:!1,calendarDateFormat:null,yearfrom:null,yearto:null,date:null,lang:null,allowTime:!1,allowTimezone:!1,"{field}":"[data-field-datetime]","{date}":"[data-field-datetime-select]","{dateValue}":"[data-field-datetime-value]","{timezone}":"[date-field-datetime-timezone]","{form}":"[data-field-datetime-form]","{icon}":"[data-field-datetime-icon]","{clearButton}":"[data-clear]"}},function(t){return{init:function(){if(t.options.yearfrom=t.options.yearfrom||1930,e.isEmpty(t.options.yearto)?t.options.yearto=(new Date).getFullYear()+100:t.options.yearto=parseInt(t.options.yearto)+1,t.date()._datetimepicker({component:"es",format:t.options.calendarDateFormat,minDate:t.options.yearfrom+"-01-01",maxDate:t.options.yearto+"-12-31",icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!0,pickTime:t.options.allowTime,useCurrent:!1}),t.options.date=t.dateValue().val(),!e.isEmpty(t.options.date)){var i=e.moment(t.options.date);t.datetimepicker("setDate",i)}t.options.allowTimezone&&t.timezone().chosen({search_contains:!0})},"{icon} click":function(){t.datetimepicker("show")},"{date} dp.change":function(e,i){t.setDateValue(i.date.toDate()),t.form().addClass("has-datetime"),t.options.allowTime||t.date().blur()},datetimepicker:function(e,i){return t.date().data("DateTimePicker")[e](i)},setDateValue:function(e){t.dateValue().val(e.getFullYear()+"-"+("00"+(e.getMonth()+1)).slice(-2)+"-"+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2))},"{date} blur":function(){t.validateCalendar()},validateCalendar:function(){return t.clearError(),!t.options.required||!e.isEmpty(t.dateValue().val())||(t.raiseError(e.language("PLG_FIELDS_DATETIME_VALIDATION_PLEASE_SELECT_DATETIME")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.validateCalendar())},"{clearButton} click":function(i,n){t.form().removeClass("has-datetime"),t.datetimepicker("setValue",new e.moment),t.date().val(""),t.dateValue().val("")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/datetime/display_content",function(e){var t=this;EasySocial.require().library("popbox","chosen").language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE").done(function(e){EasySocial.Controller("Field.Datetime.Display",{defaultOptions:{userid:null,date:null,timezone:null,local:null,"{toggle}":"[data-popbox]","{content}":"[data-popbox-content]","{date}":"[data-date]","{timezone}":"[data-timezone]","{loading}":"[data-loading]"}},function(t){return{init:function(){t.options.timezone=t.timezone().data("timezone"),t.options.date=t.date().data("date-utc"),t.datetime(t.options.timezone,t.date().html()),t.options.local=-(new Date).getTimezoneOffset()/60;var e=t.content().html(),i=t.toggle().data("popbox-position");t.toggle().popbox({content:e,id:"fd",component:"es",type:"timezone",toggle:"click",position:i}).attr("data-popbox","")},"{toggle} popboxActivate":function(i,n,o){e(o.tooltip).addController("EasySocial.Controller.Field.Datetime.Display.Timezone",{"{parent}":t})},data:{},datetime:function(i,n){if(void 0===n){var o=e.Deferred();return void 0===t.data[i]?(t.loading().show(),EasySocial.ajax("fields/user/datetime/getDatetime",{id:t.options.id,userid:t.options.userid,tz:i,local:t.options.local,datetime:t.options.date}).done(function(e){t.loading().hide(),o.resolve(t.datetime(i,e))})):o.resolve(t.data[i]),o}return t.data[i]=n,n},showDatetime:function(i,n){"local"===i&&(i=e.language("FIELDS_USER_DATETIME_LOCAL_TIMEZONE")),t.timezone().html(i),t.date().html(n)}}}),EasySocial.Controller("Field.Datetime.Display.Timezone",{defaultOptions:{"{timezones}":"[data-timezone-select]","{reset}":"[data-timezone-reset]","{local}":"[data-timezone-local]"}},function(e){return{init:function(){e.timezones().chosen({search_contains:!0})},"{timezones} change":function(t,i){var n=t.val();e.parent.date().hide(),e.parent.timezone().hide(),e.parent.datetime(n).done(function(t){e.parent.showDatetime(n,t),e.parent.date().show(),e.parent.timezone().show()})},"{reset} click":function(){e.setTimezone(e.parent.options.timezone)},"{local} click":function(){e.setTimezone("local")},setTimezone:function(t){e.timezones().val(t).trigger("liszt:updated").trigger("change")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/datetime/dropdown",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_DATETIME_DAY").done(function(){EasySocial.Controller("Field.Datetime.Dropdown",{defaultOptions:{required:!1,allowTime:!1,allowTimezone:!1,yearfrom:null,yearto:null,"{dateValue}":"[data-field-datetime-value]","{year}":"[data-field-datetime-year]","{month}":"[data-field-datetime-month]","{day}":"[data-field-datetime-day]","{hour}":"[data-field-datetime-hour]","{minute}":"[data-field-datetime-minute]","{ampm}":"[data-field-datetime-ampm]"}},function(t){return{init:function(){},"{year} change":function(e,i){t.setValue()},"{month} change":function(n,o){var a=t.year().val(),r=t.month().val();if(""!==a&&""!==r){var s=new Date(a,r,0).getDate(),l=t.day().val();for(""!==l&&(l=Math.min(l,s)),t.day().empty(),t.day().append(e('<option value="">'+e.language("PLG_FIELDS_DATETIME_DAY")+"</option>")),i=1;i<=s;i++)e('<option value="'+i+'">'+i+"</option>").appendTo(t.day());""!==l&&t.day().val(l)}t.setValue()},"{day} change":function(e,i){t.setValue()},"{hour} change":function(e,i){t.setValue()},"{minute} change":function(e,i){t.setValue()},"{ampm} change":function(e,i){t.setValue()},setValue:function(){var e,i=t.year().val(),n=t.month().val(),o=t.day().val();if(""!==i&&""!==n&&""!==o){if(e=i+"-"+n+"-"+o,t.options.allowTime){var a=t.hour().val(),r=t.minute().val();""!==a&&t.ampm().length>0&&"pm"==t.ampm().val()&&"24"===(a=(parseInt(a)+12).toString())&&(a="0"),""===r&&(r="00"),e+=" "+("00"+a).slice(-2)+":"+("00"+r).slice(-2)+":00"}t.dateValue().val(e)}}}}),t.resolve()})}),EasySocial.module("apps/fields/user/datetime/sample_content",function(e){var t=this;EasySocial.require().library("ui/datepicker").done(function(){EasySocial.Controller("Field.Datetime.Sample",{defaultOptions:{"{yearPrivacy}":"[data-yearprivacy]","{input}":"[data-field-datetime-select]","{timezone}":"[data-field-datetime-timezone]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"year_privacy":e.yearPrivacy().toggle(o);break;case"allow_timezone":e.timezone().toggle(o);break;case"placeholder":e.input().attr("placeholder",o)}}}}),t.resolve()})}),EasySocial.module("apps/fields/user/dropdown/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE").done(function(e){EasySocial.Controller("Field.Dropdown",{defaultOptions:{required:null,"{field}":"[data-field-dropdown]","{item}":"[data-field-dropdown-item]","{option}":"[data-field-dropdown-item] option"}},function(t){return{init:function(){},validateInput:function(){return t.clearError(),!t.options.required||!e.isEmpty(t.item().val())||(t.raiseError(),!1)},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_DROPDOWN_VALIDATION_PLEASE_SELECT_A_VALUE")])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){t.options.required?n.push(t.validateInput()):n.push(!0)},"{self} onSample":function(){t.option().length<1&&t.item().append(e("<option></option>"))},"{self} onChoiceAdded":function(i,n,o){t.option().eq(o).length>0?t.option().eq(o).before(e("<option></option>")):t.item().append(e("<option></option>"))},"{self} onChoiceValueChanged":function(e,i,n,o){t.option().eq(n).val(o)},"{self} onChoiceTitleChanged":function(e,i,n,o){t.option().eq(n).text(o)},"{self} onChoiceRemoved":function(e,i,n){t.option().eq(n).remove()},"{self} onChoiceToggleDefault":function(e,i,n,o){t.option().removeAttr("selected"),o&&t.option().eq(n).attr("selected","selected")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/email/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT").done(function(e){EasySocial.Controller("Field.Email",{defaultOptions:{required:!1,regex:0,regexFormat:"",regexModifier:"","{field}":"[data-field-email]","{input}":"[data-field-email-input]"}},function(t){return{init:function(){},validateInput:function(){var i=t.input().val();return t.options.required&&e.isEmpty(i)?(t.raiseError(e.language("PLG_FIELDS_EMAIL_VALIDATION_REQUIRED")),!1):!(!e.isEmpty(i)&&t.options.regex&&!new RegExp(t.options.regexFormat,t.options.regexModifier).test(i))||(t.raiseError(e.language("PLG_FIELDS_EMAIL_VALIDATION_INVALID_FORMAT")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/file/content",function(e){var t=this;EasySocial.require().library("ui/sortable").language("PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED","COM_EASYSOCIAL_WORKING").done(function(e){EasySocial.Controller("Field.File",{defaultOptions:{required:!1,id:null,inputName:"",maxFile:0,"{field}":"[data-field-file]","{list}":"[data-field-file-list]","{item}":"[data-field-file-item]","{add}":"[data-field-file-add]","{dragPlaceholder}":".data-field-file-item-drag","{moveHandle}":"[data-field-file-move]"}},function(t){return{init:function(){t.options.maxFile=t.field().data("maxfile"),t.item().addController("EasySocial.Controller.Field.File.Item",{controller:{parent:t}}),t.initSortable()},initSortable:function(){t.list().sortable({items:t.item.selector,placeholder:"data-field-file-item-drag",handle:t.moveHandle.selector,forcePlaceholderSize:!0,start:function(e,i){t.dragPlaceholder().width(i.item.find(".file-wrap").width())}})},"{add} click":function(i,n){if(t.options.maxFile<1||t.item().length<t.options.maxFile){var o=t.item().length,a=e('<div class="data-field-file-item" data-field-file-item></div>');a.data("key",o),a.html(e.language("COM_EASYSOCIAL_WORKING")),a.addController("EasySocial.Controller.Field.File.Item",{controller:{parent:t}}),t.list().append(a),EasySocial.ajax("fields/user/file/getUploadHtml",{id:t.options.id,key:o}).done(function(e){a.html(e)}),t.options.maxFile>1&&t.item().length>=t.options.maxFile&&i.hide()}},"{item} uploadDone":function(){t.add().click()}}}),EasySocial.Controller("Field.File.Item",{defaultOptions:{required:!1,key:null,"{upload}":"[data-field-file-upload]","{progress}":"[data-field-file-progress]","{delete}":"[data-field-file-delete]","{clear}":"[data-field-file-clear]","{id}":"[data-field-file-id]","{tmp}":"[data-field-file-tmp]"}},function(t){return{init:function(){t.options.key=t.element.data("key")},"{upload} change":function(i,n){t.element.html(e.language("COM_EASYSOCIAL_WORKING")),EasySocial.ajax("fields/user/file/upload",{id:t.parent.options.id,files:i,key:t.options.key},{type:"iframe"}).done(function(e){t.element.html(e),t.trigger("uploadDone")}).fail(function(e){t.element.html(e||t.getErrorMsg())})},"{delete} click":function(i,n){var o=t.tmp().val(),a=t.id().val();t.element.html(e.language("COM_EASYSOCIAL_WORKING")),EasySocial.ajax("fields/user/file/delete",{id:t.parent.options.id,key:t.options.key,tmp:o,fileid:a}).done(function(e){t.element.html(e),t.trigger("fileDeleted")}).fail(function(e){t.element.html(e||t.getErrorMsg())})},"{clear} click":function(i,n){t.element.html(e.language("COM_EASYSOCIAL_WORKING")),EasySocial.ajax("fields/user/file/getUploadHtml",{id:t.parent.options.id,key:t.options.key}).done(function(e){t.element.html(e)})},getErrorMsg:function(){return msg=e('<span class="alert field-file-error">'+e.language("PLG_FIELDS_FILE_ERROR_UNKNOWN_ERROR_OCCURED")+'<button class="close" type="button" data-field-file-clear></button></span>'),msg}}}),t.resolve()})}),EasySocial.module("apps/fields/user/file/sample_content",function(e){var t=this;EasySocial.Controller("Field.File",{defaultOptions:{"{sizeText}":"[data-field-file-size-text]","{size}":"[data-field-file-size]","{add}":"[data-field-file-add]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"size_limit":e.size().text(o);break;case"show_size_limit":e.sizeText().toggle(!!o);break;case"file_limit":e.add().toggle(o<1||o>1)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/gender/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED").done(function(e){EasySocial.Controller("Field.Gender",{defaultOptions:{required:!1,"{field}":"[data-field-gender]","{selection}":"[data-field-gender-select]"}},function(t){return{init:function(){},validateInput:function(){if(!t.options.required)return!0;t.clearError();var i=t.selection(":checked").val();return!e.isEmpty(i)||(t.raiseError(),!1)},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_GENDER_VALIDATION_GENDER_REQUIRED")])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())},"{selection} click":function(){t.validateInput()}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_email/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING").done(function(e){EasySocial.Controller("Field.Joomla_email",{defaultOptions:{required:!0,id:null,userid:null,reconfirm:!1,event:null,"{input}":"[data-field-email-input]","{confirm}":"[data-field-email-reconfirm-input]","{confirmFrame}":"[data-field-email-reconfirm-frame]"}},function(t){return{init:function(){t.origEmail=t.input().val()},"{input} blur":function(e,i){var n=t.input().val();t.options.reconfirm&&n!==t.origEmail&&t.confirmFrame().show(),!t.options.reconfirm||n!==t.origEmail||"onEdit"!==t.options.event&&"onAdminEdit"!==t.options.event||t.confirmFrame().hide(),t.validateInput()},"{confirm} blur":function(e,i){t.validateInput()},validateInput:function(){t.clearError();var i=t.input().val();if(e.isEmpty(i))return!t.options.required||(t.raiseError(e.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED")),!1);if(t.options.reconfirm){var n=t.confirm().val();if(i!==t.origEmail&&e.isEmpty(n))return t.raiseError(e.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_RECONFIRM_REQUIRED")),!1;if(!e.isEmpty(n)&&i!==n)return t.raiseError(e.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_NOT_MATCHING")),!1}return t.checkInput().done(function(){t.clearError()}).fail(function(e){t.raiseError(e)})},checkInput:function(){return EasySocial.ajax("fields/user/joomla_email/isValid",{id:t.options.id,userid:t.options.userid,email:t.input().val()})},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n,o){"onRegisterMini"!==o&&n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_email/registermini_content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED","PLG_FIELDS_JOOMLA_EMAIL_CHECKING","PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT").done(function(){EasySocial.Controller("Field.Joomla_email.Mini",{defaultOptions:{require:!0,id:null,"{input}":"#email"}},function(t){return{init:function(){},"{input} keyup":function(e){e.val().length>0&&t.delayedCheck()},state:!1,delayedCheck:e.debounce(function(){t.checkEmail()},250),checkEmail:function(){t.clearError();n=t.input().val();if(t.options.required&&0==n.length)return t.raiseError(e.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_REQUIRED")),!1;if(!e.isEmpty(n)&&t.options.regex&&!new RegExp(t.options.regexFormat,t.options.regexModifier).test(n))return t.raiseError(e.language("PLG_FIELDS_JOOMLA_EMAIL_VALIDATION_INVALID_FORMAT")),!1;if(n.length>0){var i=e.Deferred();t.setLoading(e.language("PLG_FIELDS_JOOMLA_EMAIL_CHECKING"));var n=t.input().val();return EasySocial.ajax("fields/user/joomla_email/isValid",{id:t.options.id,userid:0,email:n}).done(function(e){t.setLoaded(),i.resolve()}).fail(function(e){t.setLoaded(),t.raiseError(e),i.reject()}),i}return!0},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n,o){"onRegisterMini"===o&&(t.options.required||t.input().val().length>0)&&n.push(t.checkEmail())},setLoading:function(e){t.trigger("loading",[e])},setLoaded:function(){t.trigger("loaded")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_email/sample_content",function(e){var t=this;EasySocial.Controller("Field.Joomla_email.Sample",{defaultOptions:{"{confirmEmail}":"[data-field-email-reconfirm-frame]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"reconfirm_email":e.confirmEmail().toggle(o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/joomla_fullname/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME").done(function(e){EasySocial.Controller("Field.Joomla_fullname",{defaultOptions:{nameFormat:1,max:0,required:!0,"{field}":"[data-field-joomla_fullname]","{firstName}":"[data-field-jname-first]","{middleName}":"[data-field-jname-middle]","{lastName}":"[data-field-jname-last]","{name}":"[data-field-jname-name]"}},function(t){return{init:function(){t.options.nameFormat=t.field().data("name-format"),t.options.max=t.field().data("max")},validateInput:function(){return t.clearError(),!t.options.required||(3==t.options.nameFormat?!e.isEmpty(t.name().val())||(t.raiseError(),!1):!e.isEmpty(t.firstName().val())||(t.raiseError(),!1))},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_JOOMLA_FULLNAME_VALIDATION_EMPTY_NAME")])},clearError:function(){t.trigger("clear")},"{firstName} blur":function(e,i){t.validateInput()},"{name} blur":function(e,i){t.validateInput()},"{self} onError":function(e,i,n,o){t.raiseError()},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_fullname/sample_content",function(e){var t=this;EasySocial.Controller("Field.Joomla_fullname.Sample",{defaultOptions:{"{fullnameFormat}":"[data-fullname-format]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"format":e.switchFormat(o)}},switchFormat:function(t){e.fullnameFormat().hide(),e.fullnameFormat().eq(t-1).show()}}}),t.resolve()}),EasySocial.module("apps/fields/user/joomla_password/content",function(e){var t=this;EasySocial.require().library("passwordstrength").language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD","PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING","PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD").done(function(){EasySocial.Controller("Field.Joomla_password",{defaultOptions:{event:null,required:!1,passwordStrength:!1,reconfirmPassword:!1,requireOriginal:!1,min:4,max:0,"{field}":"[data-field-joomla_password]","{original}":"[data-field-password-orig]","{input}":"[data-field-password-input]","{reconfirm}":"[data-field-password-confirm]","{strength}":"[data-field-password-strength]","{reconfirmNotice}":"[data-reconfirmPassword-failed]"}},function(t){return{init:function(){t.options.passwordStrength&&t.initPasswordStrength()},"{input} keyup":function(){t.validatePassword()},"{input} blur":function(){t.validatePassword()},"{reconfirm} keyup":function(){t.validatePassword()},"{reconfirm} blur":function(){t.validatePassword()},validatePassword:function(){t.clearError();t.input().val(),t.reconfirm().val();return!("onRegister"===t.options.event&&!t.validatePasswordInput())&&(!("onEdit"===t.options.event&&!t.validatePasswordEdit())&&!(t.options.reconfirmPassword&&!t.validatePasswordConfirm()))},validatePasswordInput:function(){var i=t.input().val();return e.isEmpty(i)?(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1):t.options.min>0&&i.length<t.options.min?(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_MINIMUM_CHAR",t.options.min)),!1):!(t.options.max>0&&i.length>t.options.max)||(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_MAXIMUM_CHAR",t.options.max)),!1)},validatePasswordEdit:function(){var i=t.original().val(),n=t.input().val();return!(!e.isEmpty(n)||!e.isEmpty(i))||(e.isEmpty(i)&&t.options.requireOriginal?(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_ORIGINAL_PASSWORD")),!1):t.validatePasswordInput())},validatePasswordConfirm:function(){var i=t.input().val(),n=t.reconfirm().val();if(!e.isEmpty(i)||!e.isEmpty(n)){if(e.isEmpty(i))return t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1;if(e.isEmpty(n))return t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_RECONFIRM_PASSWORD")),!1;if(i!==n)return t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_NOT_MATCHING")),!1}return!0},initPasswordStrength:function(){t.input().password_strength({container:t.strength.selector,minLength:t.options.min,texts:{1:e.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_WEAK"),2:e.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_WEAK"),3:e.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_NORMAL"),4:e.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_STRONG"),5:e.language("PLG_FIELDS_JOOMLA_PASSWORD_STRENGTH_VERY_STRONG")},onCheck:function(e){e<=1&&t.strength().removeClass("text-warning").removeClass("text-success").addClass("text-error small help-inline"),e>1&&e<=3&&t.strength().removeClass("text-error").removeClass("text-success").addClass("text-warning small help-inline"),e>=4&&t.strength().removeClass("text-error").removeClass("text-warning").addClass("text-success small help-inline")}})},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n,o){"onRegisterMini"!==o&&n.push(t.validatePassword())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_password/registermini_content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT","PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG","PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD").done(function(){EasySocial.Controller("Field.Joomla_password.Mini",{defaultOptions:{required:!1,min:4,max:0,"{input}":"[data-password]"}},function(t){return{init:function(){},"{input} keyup":function(){t.checkPassword()},checkPassword:function(){t.clearError();var i=t.input().val();return t.options.min>0&&i.length<t.options.min?(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_TOO_SHORT")),!1):t.options.max>0&&i.length>t.options.max?(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_TOO_LONG")),!1):!t.options.required||0!=i.length||(t.raiseError(e.language("PLG_FIELDS_JOOMLA_PASSWORD_EMPTY_PASSWORD")),!1)},"{self} onSubmit":function(e,i,n,o){"onRegisterMini"===o&&n.push(t.checkPassword())},clearError:function(){t.trigger("clear")},raiseError:function(e){t.trigger("error",[e])}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_password/sample_content",function(e){var t=this;EasySocial.Controller("Field.Joomla_password.Sample",{defaultOptions:{"{confirmPassword}":"[data-password-confirm]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"reconfirm_password":e.confirmPassword().toggle(o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/joomla_timezone/content",function(e){var t=this;EasySocial.require().library("chosen").language("PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE").done(function(e){EasySocial.Controller("Field.Joomla_timezone",{defaultOptions:{required:!1,"{field}":"[data-field-joomla_timezone]","{input}":"[data-field-joomla_timezone-input]"}},function(t){return{init:function(){t.input().chosen({allow_single_deselect:!0,search_contains:!0})},validateInput:function(){if(!t.options.required)return!0;t.clearError();var i=t.input().val();return"null"!==i&&!e.isEmpty(i)||(t.raiseError(),!1)},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_JOOMLA_TIMEZONE_VALIDATION_SELECT_TIMEZONE")])},clearError:function(){t.trigger("clear")},"{input} change":function(){t.validateInput()},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_username/content",function(e){var t=this;EasySocial.Controller("Field.Joomla_username",{defaultOptions:{event:null,id:null,userid:null,"{checkUsernameButton}":"[data-username-check]","{input}":"[data-username-input]","{available}":"[data-username-available]"}},function(t){return{state:!1,init:function(){},"{checkUsernameButton} click":function(){t.delayedCheck()},"{input} blur":function(){t.delayedCheck()},"{input} keyup":function(){t.delayedCheck()},delayedCheck:e.debounce(function(){t.checkUsername()},250),checkUsername:function(){t.clearError();var i=e.Deferred();t.checkUsernameButton().addClass("btn-loading");var n=t.input().val();return EasySocial.ajax("fields/user/joomla_username/isValid",{id:t.options.id,userid:t.options.userid,username:n,event:t.options.event}).done(function(e){t.checkUsernameButton().removeClass("btn-loading"),t.available().show(),i.resolve()}).fail(function(e){t.raiseError(e),t.checkUsernameButton().removeClass("btn-loading"),t.available().hide(),i.reject()}),i},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n,o){"onRegisterMini"!==o&&n.push(t.checkUsername())}}}),t.resolve()}),EasySocial.module("apps/fields/user/joomla_username/registermini_content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_JOOMLA_USERNAME_CHECKING","PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME").done(function(){EasySocial.Controller("Field.Joomla_username.Mini",{defaultOptions:{id:null,required:!1,"{input}":"#joomla_username"}},function(t){return{init:function(){},"{input} keyup":function(e){e.val().length>0&&t.delayedCheck()},state:!1,delayedCheck:e.debounce(function(){t.checkUsername()},250),checkUsername:function(){var i=t.input().val();if(t.options.required&&0==i.length)return t.raiseError(e.language("PLG_FIELDS_JOOMLA_USERNAME_EMPTY_USERNAME")),!1;if(i.length>0){var n=e.Deferred();return t.clearError(),t.setLoading(e.language("PLG_FIELDS_JOOMLA_USERNAME_CHECKING")),EasySocial.ajax("fields/user/joomla_username/isValid",{id:t.options.id,userid:0,username:i}).done(function(e){t.setLoaded(),n.resolve()}).fail(function(e){t.setLoaded(),t.raiseError(e),n.reject()}),n}return!0},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n,o){"onRegisterMini"===o&&(t.options.required||t.input().val().length>0)&&n.push(t.checkUsername())},setLoading:function(e){t.trigger("loading",[e])},setLoaded:function(){t.trigger("loaded")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/joomla_username/sample_content",function(e){var t=this;EasySocial.Controller("Field.Joomla_username.Sample",{defaultOptions:{"{checkUsername}":"[data-check-username]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"check_username":e.checkUsername().toggle(!!o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/multidropdown/content",function(e){var t=this;EasySocial.require().library("ui/sortable").language("PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD").done(function(){EasySocial.Controller("Field.Multidropdown",{defaultOptions:{required:!1,id:null,inputName:"",max:0,"{field}":"[data-field-multidropdown]","{list}":"[data-field-multidropdown-list]","{item}":"[data-field-multidropdown-item]","{input}":"[data-field-multidropdown-input]","{add}":"[data-field-multidropdown-add]","{delete}":"[data-field-multidropdown-delete]","{move}":"[data-field-multidropdown-move]"}},function(t){return{init:function(){t.options.max=t.field().data("max"),t.initSortable()},initSortable:function(){t.list().sortable({items:t.item.selector,handle:t.move.selector})},"{add} click":function(e){if(t.options.max<1||t.item().length<t.options.max){var i=t.item().eq(0).clone();i.find(t.input.selector).attr("value","").val(""),t.list().append(i)}t.options.max>0&&t.item().length>=t.options.max&&e.hide()},"{delete} click":function(e){var i=e.parents(t.item.selector);t.item().length>1?i.remove():i.find(t.input.selector).val(""),t.options.max>0&&t.item().length<t.options.max&&t.add().show()},"{self} onConfigChange":function(e,i,n,o){switch(n){case"add_button_text":t.add().text(o)}},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_MULTIDROPDOWN_VALIDATION_REQUIRED_FIELD")])},"{self} onSubmit":function(i,n,o){if(t.options.required){var a=!1;e.each(t.input(),function(t,i){if(!e.isEmpty(e(i).val()))return a=!0,!1}),a||t.raiseError(),o.push(a)}else o.push(!0)}}}),t.resolve()})}),EasySocial.module("apps/fields/user/multilist/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE").done(function(e){EasySocial.Controller("Field.Multilist",{defaultOptions:{required:null,multiple:null,"{field}":"[data-field-multilist]","{item}":"[data-field-multilist-item]","{option}":"[data-field-multilist-item] option"}},function(t){return{init:function(){},validateInput:function(){return t.clearError(),t.options.multiple&&t.item().children(":selected").length<=0?(t.raiseError(),!1):""!=t.item().children(":selected").val()||(t.raiseError(),!1)},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_MULTILIST_VALIDATION_PLEASE_SELECT_A_VALUE")])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){t.options.required?n.push(t.validateInput()):n.push(!0)},"{self} onSample":function(){t.option().length<1&&t.item().append(e("<option></option>"))},"{self} onChoiceAdded":function(i,n,o){t.option().eq(o).length>0?t.option().eq(o).before(e("<option></option>")):t.item().append(e("<option></option>"))},"{self} onChoiceValueChanged":function(e,i,n,o){t.option().eq(n).val(o)},"{self} onChoiceTitleChanged":function(e,i,n,o){t.option().eq(n).text(o)},"{self} onChoiceRemoved":function(e,i,n){t.option().eq(n).remove()},"{self} onChoiceToggleDefault":function(e,i,n,o){o?t.option().eq(n).attr("selected","selected"):t.option().eq(n).removeAttr("selected")}}}),t.resolve()})}),EasySocial.module("apps/fields/user/multitextbox/content",function(e){var t=this;EasySocial.require().library("ui/sortable").language("PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD").done(function(){EasySocial.Controller("Field.Multitextbox",{defaultOptions:{required:!1,id:null,inputName:"",max:0,"{field}":"[data-field-multitextbox]","{list}":"[data-field-multitextbox-list]","{item}":"[data-field-multitextbox-item]","{input}":"[data-field-multitextbox-input]","{add}":"[data-field-multitextbox-add]","{delete}":"[data-field-multitextbox-delete]","{move}":"[data-field-multitextbox-move]"}},function(t){return{init:function(){t.options.max=t.field().data("max"),t.initSortable()},initSortable:function(){t.list().sortable({items:t.item.selector,handle:t.move.selector})},"{add} click":function(e){if(t.options.max<1||t.item().length<t.options.max){var i=t.item().eq(0).clone();i.find(t.input.selector).attr("value","").val(""),t.list().append(i)}t.options.max>0&&t.item().length>=t.options.max&&e.hide()},"{delete} click":function(e){var i=e.parents(t.item.selector);t.item().length>1?i.remove():i.find(t.input.selector).val(""),t.options.max>0&&t.item().length<t.options.max&&t.add().show()},"{self} onConfigChange":function(e,i,n,o){switch(n){case"add_button_text":t.add().text(o)}},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_MULTITEXTBOX_VALIDATION_REQUIRED_FIELD")])},"{self} onSubmit":function(i,n,o){if(t.options.required){var a=!1;e.each(t.input(),function(t,i){if(!e.isEmpty(e(i).val()))return a=!0,!1}),a||t.raiseError(),o.push(a)}else o.push(!0)}}}),t.resolve()})}),EasySocial.module("apps/fields/user/permalink/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH","PLG_FIELDS_PERMALINK_REQUIRED").done(function(e){EasySocial.Controller("Field.Permalink",{defaultOptions:{required:!1,max:0,id:null,userid:null,"{field}":"[data-field-permalink]","{checkButton}":"[data-permalink-check]","{input}":"[data-permalink-input]","{available}":"[data-permalink-available]"}},function(t){return{state:!1,init:function(){t.options.max=t.field().data("max")},"{checkButton} click":function(){t.delayedCheck()},"{input} blur":function(){t.delayedCheck()},"{input} keyup":function(){t.delayedCheck()},delayedCheck:e.debounce(function(){t.checkPermalink()},250),checkPermalink:function(){t.clearError();var i=t.input().val();if(t.available().hide(),t.options.max>0&&i.length>t.options.max)return t.raiseError(e.language("PLG_FIELDS_PERMALINK_EXCEEDED_MAX_LENGTH")),!1;if(!e.isEmpty(i)){t.checkButton().addClass("btn-loading");var n=e.Deferred();return EasySocial.ajax("fields/user/permalink/isValid",{id:t.options.id,userid:t.options.userid,permalink:i}).done(function(e){t.checkButton().removeClass("btn-loading"),t.available().show(),n.resolve()}).fail(function(e){t.raiseError(e),t.checkButton().removeClass("btn-loading"),t.available().hide(),n.reject()}),n}return!t.options.required||!e.isEmpty(i)||(t.available().hide(),t.raiseError(e.language("PLG_FIELDS_PERMALINK_REQUIRED")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.checkPermalink())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/permalink/sample_content",function(e){var t=this;EasySocial.Controller("Field.Permalink.Sample",{defaultOptions:{"{checkPermalink}":"[data-check-permalink]"}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"check_permalink":e.checkPermalink().toggle(!!o)}}}}),t.resolve()}),EasySocial.module("apps/fields/user/relationship/content",function(e){var t=this;EasySocial.require().script("site/friends/suggest").language("PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM","PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE","COM_EASYSOCIAL_CANCEL_BUTTON").done(function(e){EasySocial.Controller("Field.Relationship",{defaultOptions:{required:!1,id:null,types:null,fieldname:null,actor:null,target:null,"{field}":"[data-field-relationship]","{display}":"[data-relationship-display]","{form}":"[data-relationship-form]","{confirm}":"[data-relationship-display-confirm]","{pending}":"[data-relationship-display-pending]","{actions}":"[data-relationship-display-actions]","{pendingTitle}":"[data-relationship-pending-title]"}},function(e){return{init:function(){EasySocial.module("field.relationship/"+e.options.id).done(function(t){e.options.types=t}),e.display().addController("EasySocial.Controller.Field.Relationship.Display",{controller:{parent:e}}),e.addPlugin("form")},"{self} relationshipDeleted":function(){e.confirm().hide(),e.form().show()}}}),EasySocial.Controller("Field.Relationship.Form",{defaultOptions:{origType:null,origTarget:null,origApproved:null,"{form}":"[data-relationship-form]","{type}":"[data-relationship-form-type]","{connectWord}":"[data-relationship-form-connectwords]","{connectWords}":"[data-relationship-form-connectwords] span","{input}":"[data-relationship-form-input]","{target}":"[data-relationship-form-target]","{targetAvatar}":"[data-relationship-form-target-avatar]","{targetName}":"[data-relationship-form-target-name]","{targetPending}":"[data-relationship-form-target-pending]","{targetDelete}":"[data-relationship-form-target-delete]","{textboxlistDelete}":"[data-textboxlist-itemRemoveButton]"}},function(e){return{init:function(){e.input().addController(EasySocial.Controller.Friends.Suggest,{max:1,name:e.parent.options.fieldname+"[target][]"}),e.options.origType=e.form().data("orig-type"),e.options.origTarget=e.form().data("orig-target"),e.options.origApproved=e.form().data("orig-approved")},"{type} change":function(t){var i=t.val(),n=e.parent.options.types[i].connect,o=e.input().controller("Textboxlist").getAddedItems(),a=o.length>0,r=a?e.target():e.input(),s=!!a&&o[0];n?(r.show(),a&&e.options.origApproved&&s.id==e.options.origTarget&&i==e.options.origType?e.targetPending().hide():e.targetPending().show()):r.hide(),e.connectWords().hide(),e.connectWords().filterBy("relationship-form-connectword",i).show()},"{input} addItem":function(t,i,n){n.avatar&&e.targetAvatar().attr("src",n.avatar),n.screenName&&e.targetName().text(n.screenName),n.id&&e.targetDelete().data("id",n.id),e.input().hide(),e.target().show(),e.options.origApproved&&n.id==e.options.origTarget&&e.type().val()==e.options.origType?e.targetPending().hide():e.targetPending().show()},"{targetDelete} click":function(t,i){var n=t.data("id");e.input().controller("Textboxlist").removeItem(n),e.input().show(),e.target().hide()},"{parent} relationshipApproved":function(t,i,n){e.type().val(n.type);var o={avatar:n.avatar,html:n.name+'<input type="hidden" name="'+e.parent.options.fieldname+'[target][]" value="'+n.id+'"/>',id:n.id,key:n.name,menuHtml:void 0,name:e.parent.options.fieldname+"[target]",screenName:n.name,title:n.name};e.input().controller("Textboxlist").addItem(o),e.connectWords().hide(),e.connectWords().filterBy("relationshipFormConnectword",n.type)}}}),EasySocial.Controller("Field.Relationship.Display",{defaultOptions:{id:null,"{pendingFrame}":"[data-relationship-display-pending-text]","{loadingFrame}":"[data-relationship-display-loading]","{errorFrame}":"[data-relationship-display-error]","{actionsFrame}":"[data-relationship-display-actions]","{deleteButton}":"[data-relationship-display-actions-delete]","{approveButton}":"[data-relationship-display-actions-approve]","{rejectButton}":"[data-relationship-display-actions-reject]"}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{deleteButton} click":function(){t.parent.trigger("relationshipDeleted"),t.element.hide()},"{approveButton} click":function(){EasySocial.dialog({width:500,content:e.language("PLG_FIELDS_RELATIONSHIP_APPROVE_CONFIRM"),selectors:{"{approveButton}":"[data-approve-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{approveButton} click":function(){this.parent.close(),t.approveRelationship()},"{cancelButton} click":function(){this.parent.close()}},buttons:'<button data-cancel-button type="button" class="btn btn-es">'+e.language("COM_EASYSOCIAL_CANCEL_BUTTON")+'</button><button data-approve-button type="button" class="btn btn-es-primary">'+e.language("PLG_FIELDS_RELATIONSHIP_ACTION_APPROVE")+"</button>"})},approveRelationship:function(){t.actionsFrame().hide(),t.loadingFrame().show(),EasySocial.ajax("fields/user/relationship/approve",{id:t.parent.options.id,relid:t.options.id}).done(function(e){t.parent.display().hide(),t.element.show(),t.element.removeAttr("data-relationship-display-pending"),t.element.attr("data-relationship-display-confirm",""),t.parent.form().before(t.element),t.parent.form().hide(),t.parent.pending().length<1&&t.parent.pendingTitle().hide(),t.loadingFrame().remove(),t.pendingFrame().remove(),t.approveButton().remove(),t.rejectButton().remove(),t.actionsFrame().show(),t.deleteButton().show(),t.parent.trigger("relationshipApproved",[e])}).fail(function(e){t.loadingFrame().hide(),t.errorFrame().show().find("span").text(e)})},"{rejectButton} click":function(){t.actionsFrame().hide(),t.loadingFrame().show(),EasySocial.ajax("fields/user/relationship/reject",{id:t.parent.options.id,relid:t.options.id}).done(function(){t.element.remove(),t.parent.pending().length<1&&t.parent.pendingTitle().hide()}).fail(function(e){t.parent.trigger("relationshipActionError",[e])})}}}),t.resolve()})}),EasySocial.module("site/friends/suggest",function(e){var t=this;EasySocial.require().view("site/friends/suggest.item").library("textboxlist").language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT").done(function(e){EasySocial.Controller("Friends.Suggest.User",{defaultOptions:{"{addButton}":"[data-friend-suggest-add]","{button}":"[data-friend-suggest-button]"}},function(t){return{init:function(){},"{addButton} click":function(i){EasySocial.ajax("site/controllers/friends/request",{id:t.element.data("uid")}).done(function(i){t.button().html(e.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT"))}).fail(function(e){EasySocial.dialog({width:450,height:180,content:e.message})})}}}),EasySocial.Controller("Friends.Suggest",{defaultOptions:{max:null,exclusive:!0,exclusion:[],minLength:1,highlight:!0,name:"uid[]",type:"",friendList:!1,friendListName:"",view:{suggestItem:"site/friends/suggest.item"}}},function(t){return{init:function(){var e=t.options;t.element.textboxlist({component:"es",name:e.name,max:e.max,plugin:{autocomplete:{exclusive:e.exclusive,minLength:e.minLength,highlight:e.highlight,showLoadingHint:!0,showEmptyHint:!0,query:function(t){return e.friendList?EasySocial.ajax("site/controllers/friends/suggestWithList",{search:t,inputName:e.name,friendListName:e.friendListName}):EasySocial.ajax("site/controllers/friends/suggest",{search:t,type:e.type})}}}}).textboxlist("enable")},"{self} filterItem":function(e,i,n){if(!t.options.friendList){var o=t.view.suggestItem(!0,{item:n,name:t.options.name});return n.title=n.screenName,n.menuHtml=o,n.html=o,n}},"{self} filterMenu":function(i,n,o,a,r,s){if(!t.options.friendList){var l=s.getAddedItems(),c=(c=e.pluck(l,"id")).concat(t.options.exclusion);a.each(function(){var t=e(this),i=t.data("item");t.toggleClass("hidden",e.inArray(i.id.toString(),c)>-1)})}}}}),t.resolve()})}),EasySocial.module("apps/fields/user/separator/sample",function(e){var t=this;EasySocial.Controller("Field.Separator.Sample",{defaultOptions:{"{items}":"[data-separator-type]"}},function(t){return{"{self} onConfigChange":function(i,n,o,a){if("type"==o){var r=e("[data-separator-"+a+"]");t.items().hide(),r.show()}}}}),t.resolve()}),EasySocial.module("apps/fields/user/terms/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_TERMS_VALIDATION_REQUIRED").done(function(e){EasySocial.Controller("Field.Terms",{defaultOptions:{event:null,required:!1,"{textbox}":"[data-field-terms-textbox]","{checkbox}":"[data-field-terms-checkbox]"}},function(t){return{init:function(){},validateInput:function(){return t.clearError(),"onAdminEdit"==t.options.event||(!(t.options.required&&!t.checkbox().is(":checked"))||(t.raiseError(),!1))},"{checkbox} change":function(){t.validateInput()},raiseError:function(){t.trigger("error",[e.language("PLG_FIELDS_TERMS_VALIDATION_REQUIRED")])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())},"{self} onConfigChange":function(e,i,n,o){switch(n){case"message":t.textbox().val(o)}}}}),t.resolve()})}),EasySocial.module("apps/fields/user/textarea/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG").done(function(e){EasySocial.Controller("Field.Textarea",{defaultOptions:{required:!1,min:0,max:0,"{field}":"[data-field-textarea]","{input}":"[data-field-textarea-input]"}},function(t){return{init:function(){t.options.min=t.field().data("min"),t.options.max=t.field().data("max")},validateInput:function(){t.clearError();var i=t.input().val();return t.options.required&&e.isEmpty(i)?(t.raiseError(e.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED")),!1):!e.isEmpty(i)&&t.options.min>0&&i.length<t.options.min?(t.raiseError(e.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_SHORT")),!1):!(t.options.max>0&&i.length>t.options.max)||(t.raiseError(e.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_TOO_LONG")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())},"{self} onError":function(i,n,o){"required"===o&&t.raiseError(e.language("PLG_FIELDS_TEXTAREA_VALIDATION_INPUT_REQUIRED"))},"{self} onConfigChange":function(e,i,n,o){switch(n){case"default":t.input().val(o);break;case"placeholder":t.input().attr("placeholder",o);break;case"readonly":o?t.input().attr("readonly","readonly"):t.input().removeAttr("readonly")}}}}),t.resolve()})}),EasySocial.module("apps/fields/user/textbox/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG","PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT").done(function(e){EasySocial.Controller("Field.Textbox",{defaultOptions:{required:!1,min:0,max:0,"{field}":"[data-field-textbox]","{input}":"[data-field-textbox-input]","{notice}":"[data-check-notice]"}},function(t){return{init:function(){t.options.min=t.field().data("min"),t.options.max=t.field().data("max")},"{input} keyup":function(){t.validateInput()},"{input} blur":function(){t.validateInput()},validateInput:function(){t.clearError();var i=t.input().val();return t.options.required&&e.isEmpty(i)?(t.raiseError(e.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED")),!1):!e.isEmpty(i)&&t.options.min>0&&i.length<t.options.min?(t.raiseError(e.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_SHORT")),!1):!(t.options.max>0&&i.length>t.options.max)||(t.raiseError(e.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_TOO_LONG")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onError":function(i,n,o){"required"===o&&t.raiseError(e.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_REQUIRED")),"validate"===o&&t.raiseError(e.language("PLG_FIELDS_TEXTBOX_VALIDATION_INPUT_INVALID_FORMAT"))},"{self} onSubmit":function(e,i,n){n.push(t.validateInput())}}}),t.resolve()})}),EasySocial.module("apps/fields/user/textbox/sample_content",function(e){var t=this;EasySocial.Controller("Field.Textbox.Sample",{defaultOptions:{"{input}":"[data-input]",min:"",max:"",regex_validate:!1,regex_format:"",regex_modifier:""}},function(e){return{init:function(){},"{self} onConfigChange":function(t,i,n,o){switch(n){case"placeholder":e.input().attr("placeholder",o);break;case"default":e.input().val(o);break;case"readonly":o?e.input().attr("disabled","disabled"):e.input().removeAttr("disabled")}}}}),t.resolve()}),EasySocial.module("apps/fields/user/url/content",function(e){var t=this;EasySocial.require().language("PLG_FIELDS_URL_VALIDATION_EMPTY_URL").done(function(e){EasySocial.Controller("Field.Url",{defaultOptions:{required:!1,"{input}":"[data-field-url-input]"}},function(t){return{init:function(){},"{input} blur":function(){t.validateInput()},validateInput:function(){t.clearError();var i=t.input().val();return!t.options.required||!e.isEmpty(i)||(t.raiseError(e.language("PLG_FIELDS_URL_VALIDATION_EMPTY_URL")),!1)},raiseError:function(e){t.trigger("error",[e])},clearError:function(){t.trigger("clear")},"{self} onError":function(i,n,o,a){t.raiseError(e.language("PLG_FIELDS_URL_VALIDATION_EMPTY_URL"))}}}),t.resolve()})}),EasySocial.module("apps/fields/user/url/sample_content",function(e){var t=this;EasySocial.Controller("Field.Url.Sample",{defaultOptions:{"{urlInput}":"[data-url-input]"}},function(e){return{"{self} onConfigChange":function(t,i,n,o){switch(n){case"placeholder":e.urlInput().attr("placeholder",o);break;case"default":e.urlInput().val(o)}}}}),t.resolve()}),EasySocial.module("apps/group/feeds",function(e){var t=this;EasySocial.Controller("Groups.Apps.Feeds",{defaultOptions:{"{browser}":"[data-feeds-browser]","{sources}":"[data-feeds-sources]","{item}":"[data-feeds-list-item]","{create}":"[data-feeds-create]","{list}":"[data-feeds-list]","{remove}":"[data-feeds-remove]"}},function(t){return{init:function(){t.options.id=t.element.data("groupid"),t.options.appId=t.element.data("appid"),t.list().implement(EasySocial.Controller.Groups.Apps.Feeds.List)},"{remove} click":function(i){var n=e(i).data("id"),o=t.item.of(i);EasySocial.dialog({content:EasySocial.ajax("apps/group/feeds/controllers/feeds/confirmDelete",{groupId:t.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/feeds/controllers/feeds/delete",{appId:t.options.appId,feedId:n,groupId:t.options.id}).done(function(){o.remove(),0==t.sources().children().length&&t.browser().addClass("is-empty"),EasySocial.dialog().close()})}}})},"{create} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/feeds/controllers/feeds/create",{id:t.options.id}),bindings:{"{saveButton} click":function(){var i=this.title().val(),n=this.url().val(),o=e("[data-feeds-form-notice]");return o.removeClass("alert alert-error"),o.addClass("hide"),0==i.trim().length?(o.text(e.language("Please enter title.")),o.addClass("alert alert-error"),void o.removeClass("hide")):0==n.trim().length?(o.text(e.language("Please enter URL.")),o.addClass("alert alert-error"),void o.removeClass("hide")):void EasySocial.ajax("apps/group/feeds/controllers/feeds/save",{title:this.title().val(),url:this.url().val(),appId:t.options.appId,groupId:t.options.id}).done(function(e){t.browser().removeClass("is-empty"),t.sources().append(e),EasySocial.dialog().close()})}}})}}}),EasySocial.Controller("Groups.Apps.Feeds.List",{defaultOptions:{"{item}":"[data-feed-item]","{openPreview}":"[data-feed-open]","{preview}":"[data-feed-preview]"}},function(e){return{init:function(){},"{openPreview} click":function(t){var i=e.item.of(t).find(e.preview.selector);i.hasClass("hide")?(e.preview().addClass("hide"),i.removeClass("hide")):i.addClass("hide")}}}),t.resolve()}),EasySocial.module("apps/group/tasks",function(e){var t=this;EasySocial.Controller("Groups.Apps.Tasks.Milestones.Browse",{defaultOptions:{"{milestone}":"[data-group-tasks-milestone-item]"}},function(e){return{init:function(){e.options.groupId=e.element.data("groupid"),e.milestone().implement(EasySocial.Controller.Groups.Apps.Tasks.Milestones.Item,{"{parent}":e})}}}),EasySocial.Controller("Groups.Apps.Tasks.Milestones.Item",{defaultOptions:{"{complete}":"[data-milestone-mark-complete]","{uncomplete}":"[data-milestone-mark-uncomplete]","{delete}":"[data-milestone-delete]","{milestone}":"[data-group-tasks-milestone-item]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{uncomplete} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/unresolve",{id:e.options.id,groupId:e.parent.options.groupId}).done(function(){e.element.removeClass("is-due").removeClass("is-completed")})},"{complete} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/resolve",{id:e.options.id,groupId:e.parent.options.groupId}).done(function(){e.element.removeClass("is-due").addClass("is-completed")})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/tasks/controllers/milestone/confirmDelete",{id:e.options.id,groupId:e.parent.options.groupId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/delete",{id:e.options.id,groupId:e.parent.options.groupId}).done(function(){EasySocial.dialog().close(),e.element.remove()})}}})}}}),EasySocial.Controller("Groups.Apps.Tasks",{defaultOptions:{"{form}":"[data-group-tasks-form]","{formWrapper}":"[data-group-tasks-form-wrapper]","{taskList}":"[data-group-tasks-list]","{item}":"[data-group-tasks-list-item]","{completedList}":"[data-group-tasks-completed]","{openCounter}":"[data-tasks-open-counter]","{closedCounter}":"[data-tasks-closed-counter]","{completeMilestone}":"[data-milestone-mark-complete]","{uncompleteMilestone}":"[data-milestone-mark-uncomplete]","{deleteMilestone}":"[data-milestone-delete]","{wrapper}":"[data-group-tasks-wrapper]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.groupId=t.element.data("groupid"),t.options.milestoneId=t.element.data("milestoneid"),t.form().implement(EasySocial.Controller.Groups.Apps.Tasks.Form,{"{parent}":t}),t.implementItemController()},implementItemController:function(){t.item().implement(EasySocial.Controller.Groups.Apps.Tasks.Item,{"{parent}":t})},updateOpenCounter:function(e){t.openCounter().html(e)},updateClosedCounter:function(e){t.closedCounter().html(e)},insertCompleted:function(i){e(i).appendTo(t.completedList())},insertTask:function(e){t.formWrapper().after(e),t.implementItemController()},"{uncompleteMilestone} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/unresolve",{id:t.options.milestoneId,groupId:t.options.groupId}).done(function(){t.wrapper().removeClass("is-due").removeClass("is-completed")})},"{completeMilestone} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/resolve",{id:t.options.milestoneId,groupId:t.options.groupId}).done(function(){t.wrapper().removeClass("is-due").addClass("is-completed")})},"{deleteMilestone} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/tasks/controllers/milestone/confirmDelete",{id:t.options.milestoneId,groupId:t.options.groupId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/tasks/controllers/milestone/delete",{id:t.options.id,groupId:t.options.groupId}).done(function(){EasySocial.dialog().close(),window.location=t.options.redirect})}}})}}}),EasySocial.Controller("Groups.Apps.Tasks.Item",{defaultOptions:{"{checkbox}":"[data-item-checkbox]","{delete}":"[data-tasks-item-remove]"}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/tasks/controllers/tasks/confirmDelete",{groupId:t.parent.options.groupId}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/tasks/controllers/tasks/delete",{id:t.options.id,groupId:t.parent.options.groupId}).done(function(){EasySocial.dialog().close();var e=parseInt(t.parent.openCounter().html());t.parent.updateOpenCounter(e-1),t.element.remove()})}}})},"{checkbox} change":function(i,n){e(i).is(":checked")?EasySocial.ajax("apps/group/tasks/controllers/tasks/resolve",{id:t.options.id,groupId:t.parent.options.groupId}).done(function(){e=parseInt(t.parent.openCounter().html());t.parent.updateOpenCounter(e-1);var e=parseInt(t.parent.closedCounter().html());t.parent.updateClosedCounter(e+1),t.parent.insertCompleted(t.element)}):EasySocial.ajax("apps/group/tasks/controllers/tasks/unresolve",{id:t.options.id,groupId:t.parent.options.groupId}).done(function(e){i=parseInt(t.parent.openCounter().html());t.parent.updateOpenCounter(i+1);var i=parseInt(t.parent.closedCounter().html());t.parent.updateClosedCounter(i-1),t.parent.insertTask(t.element)})}}}),EasySocial.Controller("Groups.Apps.Tasks.Form",{defaultOptions:{"{title}":"[data-form-tasks-title]","{create}":"[data-form-tasks-create]","{assignee}":"[data-form-tasks-assignee]","{due}":"[data-form-tasks-due]","{error}":"[data-group-tasks-form-error]"}},function(e){return{init:function(){},resetForm:function(){e.element[0].reset()},"{title} keyup":function(t,i){13==i.keyCode&&e.create().click()},"{create} click":function(){if(""==e.title().val())return e.error().removeClass("hide"),!1;e.error().addClass("hide"),EasySocial.ajax("apps/group/tasks/controllers/tasks/save",{title:e.title().val(),assignee:e.assignee().val(),due:e.due().val(),groupId:e.parent.options.groupId,milestoneId:e.parent.options.id}).done(function(t){e.resetForm();var i=parseInt(e.parent.openCounter().html());e.parent.updateOpenCounter(i+1),e.parent.insertTask(t)})}}}),t.resolve()}),EasySocial.module("avatar",function(e){var t=this;EasySocial.Controller("Avatar",{defaultOptions:{uid:null,type:null,redirectUrl:null,"{menu}":"[data-avatar-menu]","{uploadButton}":"[data-avatar-upload-button]","{selectButton}":"[data-avatar-select-button]","{removeButton}":"[data-avatar-remove-button]"}},function(e){return{init:function(){},"{uploadButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/avatar/upload",{uid:e.options.uid,type:e.options.type})})},"{selectButton} click":function(){EasySocial.photos.selectPhoto({uid:e.options.uid,type:e.options.type,bindings:{"{self} photoSelected":function(t,i,n){var o=n[0];o&&EasySocial.photos.createAvatar(o.id,{uid:e.options.uid,type:e.options.type,redirectUrl:e.options.redirectUrl})},"{cancelButton} click":function(){this.parent.close()}}})},"{menu} shown.bs.dropdown":function(){e.element.addClass("show-all")},"{menu} hidden.bs.dropdown":function(){e.element.removeClass("show-all")},"{removeButton} click":function(){}}}),t.resolve()}),EasySocial.module("cover",function(e){var t=this;EasySocial.require().library("image").done(function(){EasySocial.Controller("Cover",{defaultOptions:{uid:null,type:null,"{image}":"[data-cover-image]","{editButton}":"[data-cover-edit-button]","{doneButton}":"[data-cover-done-button]","{cancelButton}":"[data-cover-cancel-button]","{uploadButton}":"[data-cover-upload-button]","{selectButton}":"[data-cover-select-button]","{removeButton}":"[data-cover-remove-button]","{menu}":"[data-cover-menu]","{flyout}":".es-flyout-content"}},function(t,i,n){return{init:function(){t.setLayout(),t.element.hasClass("editing")&&t.enable()},"{editButton} click":function(){t.enable(),t.reposition=!0,t.image().css("backgroundPosition",t.element.css("backgroundPosition"))},"{cancelButton} click":function(e,i){t.disable()},reposition:!1,ready:!1,disabled:!0,toggle:function(){t[t.disabled?"enable":"disable"]()},enable:function(){t.setLayout(),t.disabled=!1,t.element.addClass("editing"),n.attr("data-es-photo-disabled",1)},disable:function(){t.reposition=!1,t.disabled=!0,t.element.removeClass("editing"),setTimeout(function(){n.attr("data-es-photo-disabled",0)},1);var i=e.uri(window.location.href).deleteQueryParam("cover_id").toString();History.pushState({state:0},window.title,i)},imageLoaders:{},setLayout:function(){var i=t.image(),n=t.setLayout.image;if(n){var o=n.data("width"),a=n.data("height"),r=i.width(),s=i.height(),l=e.Image.resizeProportionate(o,a,r,s,"outer");t.availableWidth=r-l.width,t.availableHeight=s-l.height}else{var c=e.uri(i.css("backgroundImage")).extract(0);if(!c)return;var d=t.imageLoaders;(d[c]||(d[c]=e.Image.get(c))).done(function(e){t.setLayout.image=e,t.setLayout()})}},setCover:function(i,n){t.element.addClass("loading"),e.Image.get(n).done(function(){t.image().data("photoId",i).css({backgroundImage:e.cssUrl(n),backgroundPosition:"50% 50%"}),t.x=.5,t.y=.5,t.enable()}).fail(function(){t.disable()}).always(function(){t.element.removeClass("loading")})},drawing:!1,moveCover:function(e,i,n){n||(n=t.image());var o=t.availableWidth,a=t.availableHeight,r=0==o?0:t.x+(e/o||0),s=0==a?0:t.y+(i/a||0);r<0&&(r=0),r>1&&(r=1),s<0&&(s=0),s>1&&(s=1),n.css("backgroundPosition",100*(t.x=r)+"% "+100*(t.y=s)+"% ")},x:.5,y:.5,"{image} click":function(e,i){t.disabled||i.stopPropagation()},"{image} mousedown":function(i,o){if(!t.disabled&&!t.drawing){o.target===t.image()[0]&&o.preventDefault(),t.drawing=!0,n.addClass("active");var a=t.image(),r=t.image().css("backgroundPosition").split(" ");t.x=parseInt(r[0])/100,t.y=parseInt(r[1])/100;var s=o.pageX,l=o.pageY;e(document).on("mousemove.movingCover mouseup.movingCover",function(e){t.drawing&&t.moveCover(-1*(s-(s=e.pageX)),-1*(l-(l=e.pageY)),a)}).on("mouseup.movingCover",function(i){e(document).off("mousemove.movingCover mouseup.movingCover"),n.removeClass("active"),t.drawing=!1})}},"{image} touchstart":function(i,o){if(!t.disabled&&!t.drawing){t.drawing=!0,n.addClass("active");var a=t.image(),r=t.image().css("backgroundPosition").split(" ");t.x=parseInt(r[0])/100,t.y=parseInt(r[1])/100;o.originalEvent.targetTouches[0];var s=o.pageX,l=o.pageY;e(document).on("touchmove.movingCover",function(e){if(t.drawing){var i=e.originalEvent.targetTouches[0];t.moveCover(-1*(s-(s=i.pageX)),-1*(l-(l=i.pageY)),a),e.preventDefault()}}).on("touchend.movingCover",function(){e(document).off("touchstart.movingCover touchend.movingCover"),n.removeClass("active"),t.drawing=!1})}},save:function(){var i=t.image().data("photoId");return EasySocial.ajax("site/controllers/cover/create",{uid:t.options.uid,type:t.options.type,id:i,x:t.x,y:t.y,reposition:t.reposition?1:0}).done(function(o){n.attr("data-es-photo",i).css({backgroundImage:e.cssUrl(o.url),backgroundPosition:o.position}).removeClass("no-cover"),t.disable()})},"{doneButton} click":function(e,i){t.save()},"{menu} shown.bs.dropdown":function(){t.element.addClass("show-all")},"{menu} hidden.bs.dropdown":function(){t.element.removeClass("show-all")},"{selectButton} click":function(){n.attr("data-es-photo-disabled",1),EasySocial.photos.selectPhoto({uid:t.options.uid,type:t.options.type,bindings:{"{self} photoSelected":function(e,i,o){var a=o[0];a&&(t.setCover(a.id,a.sizes.large),this.parent.close(),n.attr("data-es-photo-disabled",0))},"{cancelButton} click":function(e,t){this.parent.close(),n.attr("data-es-photo-disabled",0)}}})},"{uploadButton} click":function(){n.attr("data-es-photo-disabled",1),EasySocial.dialog({content:EasySocial.ajax("site/views/cover/uploadDialog",{uid:t.options.uid,type:t.options.type}),bindings:{"{self} upload":function(e,i,n,o){n.done(function(e){t.setCover(e.id,e.sizes.large.url)})},"{cancelButton} click":function(){this.parent.close(),n.attr("data-es-photo-disabled",0)}}})},"{removeButton} click":function(){EasySocial.ajax("site/controllers/cover/remove",{uid:t.options.uid,type:t.options.type}).done(function(i){n.css({backgroundImage:e.cssUrl(i),backgroundPosition:"50% 50%"}).addClass("no-cover").removeAttr("data-es-photo"),t.disable()})},"{flyout} click":function(t,i){t.is(e(i.target))&&i.stopPropagation()}}}),t.resolve()})}),EasySocial.require().script("site/likes/likes","site/reports/reports","site/blocks/blocks","site/repost/repost","site/share/share","site/layout/dialog","site/layout/responsive","site/layout/elements","site/photos/photos","site/users/login","site/profile/popbox","site/privacy/privacy","site/locations/popbox","site/sidebar/sidebar","site/friends/api","site/popbox/popbox","site/conversations/api","site/followers/api","site/stream/video","oauth/facebook").library("history").done(),EasySocial.module("site/likes/likes",function(e){var t=this;e(document).on("click.es.likes.action","[data-likes-action]",function(){var t=e(this),i={id:t.data("id"),type:t.data("type"),group:t.data("group"),verb:t.data("verb"),streamid:t.data("streamid")},n=i.type+"-"+i.group+"-"+i.id;EasySocial.ajax("site/controllers/likes/toggle",i).done(function(o,a,r,s,l){t.text(a),id=t.data("streamid"),e("[data-likes-"+n+"]").html(o).toggleClass("hide",r).toggle(!r),i.uid=i.id,i.count=l,t.trigger("like"==s?"onLiked":"onUnliked",[i]),"like"==s&&""!=id&&(ids=e("[data-streams-wrapper]").data("excludeids"),newIds="",""!=ids&&void 0!=ids?newIds=ids+","+id:newIds=id,e("[data-streams-wrapper]").data("excludeids",newIds))}).fail(function(e){console.log(e)})}).on("click.es.likes.others","[data-likes-others]",function(){var t=e(this),i=t.parents("[data-likes-content]"),n={uid:i.data("id"),type:i.data("type"),verb:i.data("verb"),group:i.data("group"),exclude:t.data("authors")};EasySocial.dialog({content:EasySocial.ajax("site/controllers/likes/showOthers",n)})}),t.resolve()}),EasySocial.module("site/reports/reports",function(e){e(document).on("click.es.reports.link","[data-reports-link]",function(){var t=e(this),i="url,extension,uid,type,object,title,description".split(","),n={};e.each(i,function(e,i){n[i]=t.data(i)}),EasySocial.dialog({content:EasySocial.ajax("site/views/reports/confirmReport",{title:n.title,description:n.description}),selectors:{"{message}":"[data-reports-message]","{reportButton}":"[data-report-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{reportButton} click":function(){var e=this.message().val();EasySocial.dialog({content:EasySocial.ajax("site/controllers/reports/store",{url:n.url,extension:n.extension,uid:n.uid,type:n.type,title:n.object,message:e})})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})}),this.resolve()}),EasySocial.module("site/blocks/blocks",function(e){e(document).on("click.es.blocks.link","[data-blocks-link]",function(){var t=e(this).data("target");EasySocial.dialog({content:EasySocial.ajax("site/views/blocks/confirmBlock",{target:t}),selectors:{"{reason}":"[data-block-reason]","{blockButton}":"[data-block-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{blockButton} click":function(){var e=this.reason().val();EasySocial.dialog({content:EasySocial.ajax("site/controllers/blocks/store",{target:t,reason:e})})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})}),e(document).on("click.es.unblock.link","[data-unblock-link]",function(){var t=e(this).data("target");EasySocial.dialog({content:EasySocial.ajax("site/views/blocks/confirmUnblock",{target:t}),selectors:{"{unblockButton}":"[data-unblock-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{unblockButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/controllers/blocks/unblock",{target:t}).done(function(){e("[data-blocked-user-"+t+"]").remove()}),selectors:{"{cancelButton}":"[data-cancel-button]"},bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()}}})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})}),this.resolve()}),EasySocial.module("site/repost/repost",function(e){var t=this;EasySocial.require().view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").library("mentions").done(function(){e(document).on("click.es.repost.action","[data-repost-action]",function(){var t=e(this),i={id:t.data("id"),element:t.data("element"),group:t.data("group"),clusterId:t.data("clusterid"),clusterType:t.data("clustertype")},n=i.element+"-"+i.group+"-"+i.id;EasySocial.dialog({content:EasySocial.ajax("site/views/repost/form",i),bindings:{init:function(){this.setMentionsLayout()},setMentionsLayout:function(){var t=this.textbox(),i=t.controller("mentions");if(i)i.cloneLayout();else{var n=this.header();t.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:e.View("easysocial/site/friends/suggest.hint.search"),emptyHint:e.View("easysocial/site/friends/suggest.hint.empty"),data:function(t){var i=e.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:t}).done(function(t){e.isArray(t)||i.reject();var t=e.map(t,function(t){return t.title=t.screenName,t.type="user",t.menuHtml=e.View("easysocial/site/friends/suggest.item",!0,{item:t,name:"uid[]"}),t});i.resolve(t)}).fail(i.reject),i},use:function(e){return e.type+":"+e.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:e.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:e.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(t){var i=e.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:t}).done(function(t){e.isArray(t)||i.reject();var t=e.map(t,function(t){return t.title="#"+t.title,t.type="hashtag",t.menuHtml=e.View("easysocial/site/hashtags/suggest.item",!0,{item:t,name:"uid[]"}),t});i.resolve(t)}).fail(i.reject),i}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:"left top",at:"left bottom",of:n,collision:"none"},size:{width:function(){return n.outerWidth(!0)}}}}})}},"{sendButton} click":function(o){var a=this.parent,r=e.trim(this.repostContent().val());i.content=r;var s=this.textbox().mentions("controller").toArray();i.mentions=e.map(s,function(t){return"hashtag"===t.type&&e.isPlainObject(t.value)&&(t.value=t.value.title.slice(1)),JSON.stringify(t)}),a.loading(!0),EasySocial.ajax("site/controllers/repost/share",i).done(function(i,o,a,r){var i=e.buildHTML(i);actionContent=e("[data-repost-"+n+"]").toggleClass("hide",o).toggle(!o),actionContent.find("span.repost-counter").html(i),t.trigger("create",[r])}).fail(function(e){a.clearMessage(),a.setMessage(e)}).always(function(){a.loading(!1),a.close()})}}})}),EasySocial.module("repost/authors",function(){this.resolve(function(e){var t=e.button.parents("[data-repost-content]");return data={id:t.data("id"),element:t.data("element")},{content:EasySocial.ajax("site/controllers/repost/getSharers",data),id:"fd",component:"es",type:"repost",position:"bottom-right"}})}),t.resolve()})}),EasySocial.module("site/share/share",function(e){e(document).on("click.es.share.button","[data-es-share-button]",function(){var t=e(this);EasySocial.dialog({title:t.text(),width:500,content:EasySocial.ajax("site/views/sharing/shareDialog",{url:t.data("url"),title:t.data("title")})})}),this.resolve()}),EasySocial.module("site/layout/dialog",function(e){var t=this;EasySocial.require().library("dialog").view("site/dialog/default").done(function(e){EasySocial.dialog=function(t){if(window.parentDialog)return window.parentDialog.update(t);if("string"==typeof t||e.isDeferred(t)){var i=arguments[1];t={content:t,afterShow:e.isFunction(i)?i:e.noop}}var n=e("[id=fd].es-dialog.global");n.length<1&&(n=e(EasySocial.View("site/dialog/default")).addClass("global").appendTo("body"));var o={showOverlay:!1},t=e.extend(o,t),a=n.controller("Dialog");return a?a.update(t):a=n.addController("Dialog",t),a},t.resolve()})}),EasySocial.module("site/layout/responsive",function(e){var t=this;e(function(){e.responsive(".es-responsive",[{at:1200,switchTo:"wide"},{at:960,switchTo:"wide w960"},{at:818,switchTo:"wide w960 w768"},{at:600,switchTo:"wide w960 w768 w600"},{at:560,switchTo:"wide w960 w768 w600 w480"},{at:480,switchTo:"wide w960 w768 w600 w480 w320"}]),e(document).on("responsive",e.debounce(function(){ESImageRefresh()},500))}),t.resolve()}),EasySocial.module("site/layout/elements",function(e){var t=this;e(document).on("click.button.data-bs-api","[data-bs-toggle-value]",function(){var t=e(this),i=t.siblings("[data-bs-toggle-value]"),n=t.parents('[data-bs-toggle="radio-buttons"]');if(!n.hasClass("disabled")&&n.length>0){var o=e(this).data("bs-toggle-value");return t.addClass("active"),i.removeClass("active"),void n.find("input[type=hidden]").val(o).trigger("change")}}),e(document).on("mouseover.tooltip.data-es-api","[data-es-provide=tooltip]",function(){e(this).tooltip({delay:{show:200,hide:100},animation:!1,template:'<div id="fd" class="es tooltip tooltip-es"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',container:"body"}).tooltip("show")}),e(document).on("mouseover.popover.data-es-api","[data-es-provide=popover]",function(){e(this).popover({delay:{show:200,hide:100},animation:!1,trigger:"hover",container:"body"}).popover("show")});var i=function(e){return!(e%400)||!!(e%100)&&!(e%4)};e(document).on("keyup","[data-date-form] [data-date-day]",function(){if(e.trim(e(this).val())){var t=parseInt(e(this).siblings("[data-date-year]").val()||e(this).siblings("[data-date-year]").data("dateDefault")),n=parseInt(e(this).siblings("[data-date-month]").val()||e(this).siblings("[data-date-month]").data("dateDefault")),o=parseInt(e(this).val()||e(this).data("dateDefault")),a=/1|3|5|7|8|10|12/.test(n)?31:30;2==n&&(a=i(t)?29:28),o<1&&(o=1),o>a&&(o=a),e.isNumeric(o)?e(this).val(o):e(this).val("")}}),e(document).on("keyup","[data-date-form] [data-date-year]",function(){if(e.trim(e(this).val())){var t=parseInt(e(this).val());t<1&&(t=1),e.isNumeric(t)?e(this).val(t):e(this).val("")}}),t.resolve()}),EasySocial.module("site/photos/photos",function(e){var t=this;EasySocial.require().script("site/photos/popup","site/photos/dialog","site/photos/avatar").done(),EasySocial.Controller("Photos",{defaultOptions:{}},function(e){return{init:function(){EasySocial.photos=e,EasySocial.module("site/photos/popup").done(function(t){e.popup=e.addPlugin("popup",t)}),EasySocial.module("site/photos/dialog").done(function(t){e.dialog=e.addPlugin("dialog",t)}),EasySocial.module("site/photos/avatar").done(function(t){e.avatar=e.addPlugin("avatar",t)})}}}),e(function(){e("body").addController("EasySocial.Controller.Photos")}),t.resolve()}),EasySocial.module("site/photos/popup",function(e){var t=this;e.fn.at=function(e){return this.find("[data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()+"]")},EasySocial.require().view("site/photos/popup").done(function(){var i=EasySocial.Controller("Photos.Popup",{defaultOptions:{view:{popup:"site/photos/popup"},"{popup}":"[data-photo-popup]","{viewport}":"[data-popup-viewport]","{handle}":"[data-popup-handle]","{photoGroup}":"[data-es-photo-group]","{photo}":"[data-es-photo]","{photoHeader}":"[data-photo-popup] [data-photo-header]","{photoContent}":"[data-photo-popup] [data-photo-content]","{navButton}":".es-photo-nav-button","{closeButton}":"[data-popup-close-button]","{photoItem}":"[data-photo-popup] [data-photo-item]","{desTagItem}":"[data-photo-des-tag-item]"}},function(t,i,n,o){return{init:function(){o=e("body"),t.bodyOverflow={overflow:o.css("overflow"),overflowX:o.css("overflowX"),overflowY:o.css("overflowY")}},setLayout:function(){if(t.popup().is(":visible")){var e=t.viewport().find("img[data-photo-image]")[0];e&&ESImage(e),o.css({overflow:"hidden",overflowX:"hidden",overflowY:"hidden"});var i=t.photoItem(),n=i.controller("EasySocial.Controller.Photos.Tags");n&&n.setLayout();var a=i.controller("EasySocial.Controller.Photos.Navigation"),r=i.controller("EasySocial.Controller.Photos.Tagger");a&&a[r&&!r.disabled||t.playlist.length<2?"disable":"enable"]()}else o.css(t.bodyOverflow)},"{desTagItem} mouseover":function(e,i){var n=t.photoItem().controller("EasySocial.Controller.Photos.Tags");n&&n.getTagItem(e.data("photoDesTagId")).addClass("focus")},"{desTagItem} mouseout":function(e,i){var n=t.photoItem().controller("EasySocial.Controller.Photos.Tags");n&&n.getTagItem(e.data("photoDesTagId")).removeClass("focus")},"{window} resize":e.debounce(function(){t.setLayout()},250),"{self} responsive":function(){t.setLayout()},playlist:[],show:function(){var i,o=t.popup.node;o||(i=t.view.popup(),o=t.popup.node=i[0]),e.contains(n,o)||(i=e(o).addClass("is-loading").appendTo(n)),i.is(":visible")||(i.show(),e(window).trigger("resize.responsive"),i.trigger("show"))},hide:function(){t.popup().hide().trigger("hide").detach(),o.css(t.bodyOverflow)},open:function(){var i,n=arguments,o=[];if(1===n.length&&(i=n[0],o=[i]),e.isArray(n[0]))o=n[0],i=n[1]||o[0];else if(2===n.length){var a,r=n[0],s=!0;e.isNumeric(r)&&(r="album",s=!1,a=n[0],i=n[1],o=[i]),"photo"==r&&(i=n[1],o=[i]),"album"==r&&EasySocial.ajax("site/controllers/albums/playlist",{albumId:a||n[1]}).done(function(i){t.playlist=e.map(i,function(e){return e.id}),s&&t.display(o[0]),t.setLayout()}).fail(function(){alert("Error. Could not get album playlist."),t.hide()})}t.playlist=o,t.show(),t.display(i)},handles:{},display:function(i){if(i){var n=t.currentPhotoId;t.currentPhotoId=i;var o=t.handles[i];if(t.handle().detach(),!o){var a=t.popup();return a.addClass("is-loading"),void EasySocial.ajax("site/views/photos/item",{id:i,browser:0,popup:1}).done(function(n){var o=e.buildHTML('<div class="es-popup-handle" data-popup-handle>'+n+"</div>");t.handles[i]=o,t.display(i)}).fail(function(){alert("There was a problem loading this photo."),t.display(n)}).always(function(){a.removeClass("is-loading")})}t.popup().removeClass("is-loading"),t.viewport().empty().append(o),o instanceof e&&(t.handles[i]=o.filter("[data-popup-handle]")[0]),t.setLayout()}},current:function(){var i=t.currentPhotoId,n=t.playlist,o=e.indexOf(n,i);return o<0&&(o=0),o},next:function(){var e=t.playlist;if(!(e.length<2)){var i=t.current()+1;i>e.length-1&&(i=0),t.display(e[i])}},prev:function(){var e=t.playlist;if(!(e.length<2)){var i=t.current()-1;i<0&&(i=e.length-1),t.display(e[i])}},"{self} click":function(e,i){i.target===t.popup()[0]&&t.hide()},"{photo} click":function(i,n){if("1"!=i.attr("data-es-photo-disabled")){var o=e(n.target),a=o.parents().andSelf();if(!(o.filter("[data-es-photo]").length<1&&a.filter("[data-photo-menu], [data-cover-menu]").length>0)){var r=i.attr("data-es-photo"),s=t.photoGroup.of(i);if(!(s.length<0)){n.preventDefault();var l=(s.attr("data-es-photo-group")||"element").split(":");switch(l[0]){case"album":var c=l[1];t.open(c,r);break;case"photos":d=l[1].split(",");t.open(d,r);break;case"element":var d=[];s.at("esPhoto").each(function(){d.push(e(this).attr("data-es-photo"))}),t.open(d,r)}}}}},"{photoItem} directionmove":function(e,i,n,o){t.playlist.length<2&&t.navButton().removeClass("active")},"{photoItem} directionstop":function(){},"{photoItem} photoNext":function(){t.next()},"{photoItem} photoPrev":function(){t.prev()},"{photoItem} photoDelete":function(i,n,o){t.playlist.length<2?t.hide():t.next(),t.playlist=e.without(t.playlist,o.id)},"{closeButton} click":function(){t.hide()}}});t.resolve(i)})}),EasySocial.module("site/photos/dialog",function(e){var t=this,i=EasySocial.Controller("Photos.Dialog",{defaultOptions:{}},function(t){return{init:function(){EasySocial.photos.selectPhoto=t.show},show:function(t){var i=e.Deferred(),n=EasySocial.ajax("site/views/albums/dialog",{uid:t.uid,type:t.type}),o=EasySocial.require().script("albums/browser").done();EasySocial.dialog(e.extend({content:i},t)),e.when(o,n).done(function(){n.done(function(e){i.resolve(e)})})}}});t.resolve(i)}),EasySocial.module("site/photos/avatar",function(e){var t=this,i=EasySocial.Controller("Photos.Avatar",{defaultOptions:{}},function(t){return{init:function(){EasySocial.photos.createAvatar=t.crop},crop:function(t,i){if(void 0!=t){i||(i={});var n={id:t};i.uid&&(n.uid=i.uid,delete i.uid),i.type&&(n.type=i.type,delete i.type),i.redirect&&(n.redirect=i.redirect,delete i.redirect),EasySocial.dialog(e.extend({content:EasySocial.ajax("site/views/avatar/crop",n)},i))}}}});t.resolve(i)}),EasySocial.module("site/users/login",function(e){var t=this;EasySocial.require().library("dialog").script("site/dashboard/dashboard.guest.login").view("site/loading/small").done(function(){EasySocial.login=function(){EasySocial.ajax("site/views/login/form").done(function(e){EasySocial.dialog({content:e,afterShow:function(){this.element.find("[data-guest-login]").addController("EasySocial.Controller.Dashboard.Guest.Login")}})})},t.resolve()})}),EasySocial.module("site/dashboard/dashboard.guest.login",function(e){var t=this;EasySocial.require().script("field","validate").done(function(){EasySocial.Controller("Dashboard.Guest.Login",{defaultOptions:{"{fieldItem}":"[data-registermini-fields-item]","{submit}":"[data-registermini-submit]","{form}":"[data-registermini-form]"}},function(e){return{init:function(){e.fieldItem().addController("EasySocial.Controller.Field.Base",{userid:0,mode:"registermini"})},"{submit} click":function(t){t.enabled()&&(t.disabled(!0),e.form().validate({mode:"onRegisterMini"}).done(function(){t.enabled(!0),e.form().submit()}).fail(function(){t.enabled(!0)}))}}}),t.resolve()})}),EasySocial.module("validate",function(e){var t=this;e.isController("EasySocial.Controller.Validator")||EasySocial.Controller("Validator",{defaultOptions:{mode:null,checks:["required","validate"],typeAttr:"data-check-type",formatAttr:"data-check-format",modifierAttr:"data-check-modifier",errorTrigger:"onError",submitTrigger:"onSubmit","{container}":"[data-check]","{notice}":"[data-check-notice]","{required}":"[data-check-required]","{validate}":"[data-check-validate]"}},function(t){return{vars:{},register:[],deferreds:[],errors:[],state:e.Deferred(),init:function(){},reset:function(){t.vars={},t.register=[],t.deferreds=[],t.errors=[],t.state=e.Deferred(),t.container().removeClass("error")},start:function(){return t.reset(),e.each(t.container(),function(i,n){t.vars.container=n=e(n),n.trigger(t.options.submitTrigger,[t.register,t.options.mode]),e.each(t.getFields(),function(i,n){t.vars.field=n=e(n),e.each(t.options.checks,function(e,i){t.vars.check=i,t[i+"Check"]()})})}),e.each(t.register,function(i,n){if(e.isDeferred(n))t.deferreds.push(n);else if(e.isPlainObject(n))e.each(n,function(e,n){if(!1===n)return t.errors.push(i),!0});else if(!1===n)return t.errors.push(i),!0}),t.errors.length>0?t.state.reject():t.deferreds.length>0?e.when.apply(null,t.deferreds).done(function(){t.state.resolve()}).fail(function(){t.state.reject()}):t.state.resolve(),t.state},getFields:function(){return e.merge(t.vars.container.find(t.required.selector),t.vars.container.find(t.validate.selector))},requiredCheck:function(){if(t.vars.field.is(t.required.selector)){var i=t.vars.field.attr(t.options.typeAttr)||t.vars.field.attr("type")||"text";"text"===i&&""==e.trim(t.vars.field.val())&&t.raiseError(),"checkbox"===i&&t.vars.field.find('input[type="checkbox"]').filter(":checked").length<1&&t.raiseError()}},validateCheck:function(){if(void 0!==t.vars.field.attr(t.options.formatAttr)){var i=t.vars.field.val();if(e.isEmpty(i))return;var n=t.vars.field.attr(t.options.formatAttr)||"",o=t.vars.field.attr(t.options.modifierAttr)||"";new RegExp(n,o).test(i)||t.raiseError()}},raiseError:function(){t.vars.container.addClass("has-error"),t.vars.container.trigger(t.options.errorTrigger,[t.vars.check,t.vars.field]),t.register.push(!1)}}}),e.fn.validate=function(e){return this.length>0&&this.addController("EasySocial.Controller.Validator",e).start()},t.resolve()}),EasySocial.module("site/profile/popbox",function(e){var t=this;EasySocial.require().library("popbox").done(function(){EasySocial.module("profile/popbox",function(e){this.resolve(function(e){var t=e.button.data("userId"),i=e.button.attr("data-popbox-position")||"top-left";return{content:EasySocial.ajax("site/views/profile/popbox",{id:t}),id:"fd",component:"es",type:"profile",position:i}})})}),EasySocial.require().script("site/conversations/composer").done(),EasySocial.Controller("Profile.Popbox",{defaultOptions:{id:null,"{addButton}":"[data-popbox-friends-add]","{friendsButton}":"[data-popbox-friends-friends]","{respondButton}":"[data-popbox-friends-respond]","{requestedButton}":"[data-popbox-friends-requested]","{messageButton}":"[data-popbox-message]","{friendsSubmenu}":"[data-friends-submenu]","{cancelFriend}":"[data-popbox-friends-friends-cancel]","{cancelFriendRequest}":"[data-popbox-friends-requested-cancel]","{approveFriend}":"[data-popbox-friends-respond-approve]","{rejectFriend}":"[data-popbox-friends-respond-reject]"}},function(t){return{init:function(){t.options.id=t.element.find("[data-user-id]").data("userId"),EasySocial.module("site/conversations/composer").done(function(){t.messageButton().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:t.options.id}})})},"{self} popboxActivate":function(){t.friendsSubmenu().parent().removeClass("open")},"{addButton} click":function(){EasySocial.ajax("site/controllers/friends/request",{id:t.options.id}).done(function(){EasySocial.ajax("site/views/profile/getButton",{button:"button.requested",id:t.options.id}).done(function(e){t.addButton().replaceWith(e)}).fail(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")})})})},"{cancelFriend} click":function(i,n){var o=e(i).data("friendid");EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmRemoveFriend",{id:t.options.id}),bindings:{"{confirmButton} click":function(){EasySocial.ajax("site/controllers/friends/unfriend",{id:o}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/friendRemoved",{id:t.options.id})}),EasySocial.ajax("site/views/profile/getButton",{button:"button.add"}).done(function(e){t.friendsSubmenu().remove(),t.friendsButton().replaceWith(e)})})}}})},"{cancelFriendRequest} click":function(i,n){var o=e(i).data("friendid");EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmCancelRequest",{id:o}),bindings:{"{confirmButton} click":function(){EasySocial.dialog().close(),EasySocial.ajax("site/controllers/friends/cancelRequest",{id:o}).done(function(){EasySocial.ajax("site/views/profile/getButton",{button:"button.add"}).done(function(e){t.friendsSubmenu().remove(),t.requestedButton().replaceWith(e)})})}}})},"{approveFriend} click":function(i,n){var o=e(i).data("friendid");EasySocial.ajax("site/controllers/friends/approve",{id:o}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmFriends",{id:t.options.id})}),EasySocial.ajax("site/views/profile/getButton",{button:"button.friends"}).done(function(e){t.friendsSubmenu().remove(),t.respondButton().replaceWith(e)})})},"{rejectFriend} click":function(i,n){var o=e(i).data("friendid");EasySocial.ajax("site/controllers/friends/reject",{id:o}).done(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/rejected",{id:t.options.id})}),EasySocial.ajax("site/views/profile/getButton",{button:"button.add"}).done(function(e){t.friendsSubmenu().remove(),t.respondButton().replaceWith(e)})})}}}),e(document).on("mouseover.es.profile.popbox","[data-popbox-tooltip=profile]",function(){e(this).addController("EasySocial.Controller.Profile.Popbox")}),t.resolve()}),EasySocial.module("site/conversations/composer",function(e){var t=this;EasySocial.require().library("mentions").script("site/friends/suggest","uploader/uploader").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language("COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS","COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE").done(function(e){EasySocial.Controller("Conversations.Composer",{defaultOptions:{attachments:!0,location:!0,extensionsAllowed:"","{uploader}":"[data-composer-attachment]","{location}":"[data-composer-location]","{editorHeader}":"[data-composer-editor-header]","{editorArea}":"[data-composer-editor-area]","{editor}":"[data-composer-editor]","{friendSuggest}":"[data-friends-suggest]","{recipients}":"input[name=uid\\[\\]],input[name=list_id\\[\\]]","{recipientRow}":"[data-composer-recipients]","{messageRow}":"[data-composer-message]","{submit}":"[data-composer-submit]",view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(t){return{init:function(){t.initSuggest(),t.options.attachments&&t.initUploader(),t.setMentionsLayout()},resetForm:function(){t.editor().val("")},setMentionsLayout:function(){var i=t.editorArea(),n=i.controller("mentions");if(n)n.cloneLayout();else{var o=t.editorHeader();i.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:e.View("easysocial/site/friends/suggest.hint.search"),emptyHint:e.View("easysocial/site/friends/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title=e.screenName,e.type="user",e.menuHtml=t.view.suggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n},use:function(e){return e.type+":"+e.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!1,searchHint:e.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:e.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title="#"+e.title,e.type="hashtag",e.menuHtml=t.view.tagSuggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:"left top",at:"left bottom",of:o,collision:"none"},size:{width:function(){return o.width()}}}}})}},initUploader:function(){t.uploader().implement(EasySocial.Controller.Uploader,{temporaryUpload:!0,query:"type=conversations",type:"conversations",extensionsAllowed:t.options.extensionsAllowed}),"development"==EasySocial.environment&&(console.log("Extensions Allowed: "+t.options.extensionsAllowed),console.log("Maximum individual file size: "+t.options.maxSize))},initSuggest:function(){t.friendSuggest().addController(EasySocial.Controller.Friends.Suggest,{friendList:!0,friendListName:"list_id[]"})},initEditor:function(){t.editor().expandingTextarea()},checkErrors:function(){return t.recipients().length<=0?(t.recipientRow().addClass("error"),t.clearMessage(),t.setMessage(e.language("COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_RECIPIENTS"),"error"),!0):(t.recipientRow().removeClass("error"),""==t.editor().val()?(t.messageRow().addClass("error"),t.clearMessage(),t.setMessage(e.language("COM_EASYSOCIAL_CONVERSATIONS_ERROR_EMPTY_MESSAGE"),"error"),!0):(t.messageRow().removeClass("error"),!1))},"{submit} click":function(i,n){if(n.preventDefault(),t.checkErrors())return!1;if(t.options.attachments){var o=t.uploader().controller();if(o.options.uploading&&o.hasFiles())return!1}var a=t.editorArea().mentions("controller").toArray();e(a).each(function(i,n){e("<input>").attr("type","hidden").attr("name","tags[]").attr("value",JSON.stringify(n)).appendTo(t.element)}),t.element.submit()}}}),EasySocial.Controller("Conversations.Composer.Dialog",{defaultOptions:{recipient:{}}},function(t){return{init:function(){},"{self} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/composer",{id:t.options.recipient.id}),bindings:{"{sendButton} click":function(i){var n=this.parent,o=e("[data-composer-recipient]").val(),a=e("[data-composer-message]").val();i.disabled(!0),EasySocial.ajax("site/controllers/conversations/store",{uid:o,message:a}).done(function(e){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/sent",{id:t.options.recipient.id}),bindings:{"{viewButton} click":function(){document.location=e}}})}).fail(function(e){n.setMessage(e),i.disabled(!1)})}}})}}}),t.resolve()})}),EasySocial.module("site/privacy/privacy",function(e){var t=this;EasySocial.require().library("textboxlist").language("COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_PUBLIC","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_MEMBER","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIENDS_OF_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_FRIEND","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_ONLY_ME","COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_CUSTOM").done(function(e){EasySocial.Controller("Privacy",{defaultOptions:{"{menu}":"[data-privacy-menu]","{item}":"[data-privacy-item]","{icon}":"[data-privacy-icon]","{button}":"[data-privacy-toggle]","{tooltip}":"[data-original-title]","{key}":"[data-privacy-hidden]"}},function(t){return{init:function(){t.instanceId=e.uid(),t.addPlugin("custom")},getData:function(t){return e._.pick(t.data(),"uid","utype","value","pid","privacyicon","streamid")},"{self} click":function(i,n){var o=e(n.target),a=t.button();o.parents().andSelf().filter(a).length>0&&t.toggle()},"{item} click":function(e){var i=t.getData(e);t.trigger("privacyChange",[i]),i.preventSave||(t.save(i),t.deactivate())},"{self} privacyChange":function(e,i,n){t.item().removeClass("active").filter("[data-value="+n.value+"]").addClass("active")},toggle:function(){var e=t.element.hasClass("active");t[e?"deactivate":"activate"]()},activate:function(){t.element.addClass("active"),t.trigger("activate",[t]),e(window).trigger("activatePrivacy",[t]);var i="click.privacy."+t.instanceId;e(document).on(i,function(n){var o=e(n.target);o.parents().andSelf().filter(t.element).length>0||o.parents("[data-textboxlist-autocomplete]").length>0||o.parents("[data-textboxlist-item]").length>0||(e(document).off(i),t.deactivate())})},deactivate:function(){t.element.removeClass("active"),t.trigger("deactivate",[t]),e(window).trigger("deactivatePrivacy",[t])},"{window} activatePrivacy":function(e,i,n){n!==t&&t.deactivate()},save:function(i){t.key().val(i.value),t.icon().attr("class",i.privacyicon),t.trigger("privacySave",[i]),t.element.attr("data-original-title",e.language("COM_EASYSOCIAL_PRIVACY_TOOLTIPS_SHARED_WITH_"+i.value.toUpperCase())),"ajax"==t.element.data("privacyMode")&&EasySocial.ajax("site/controllers/privacy/update",{uid:i.uid,utype:i.utype,value:i.value,pid:i.pid,custom:i.custom,streamid:i.streamid}).done(function(){}).fail(function(){})}}}),EasySocial.Controller("Privacy.Custom",{defaultOptions:{"{textField}":"[data-textfield]","{saveButton}":"[data-save-button]","{cancelButton}":"[data-cancel-button]","{customItem}":"[data-privacy-item][data-value=custom]","{customKey}":"[data-privacy-custom-hidden]"}},function(t){return{init:function(){t.textField().textboxlist({component:"es",unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:1,cache:!1,query:function(e){var i=t.getIds();return EasySocial.ajax("site/views/privacy/getfriends",{q:e,exclude:i})}}}}),t.textboxlist=t.textField().controller("TextboxList")},getIds:function(){var i=t.textField().textboxlist("controller").getAddedItems();return e.map(i,function(e,t){return e.id})},updateIds:function(){var e=t.getIds();t.customKey().val(e.join(","))},"{parent} privacyChange":function(e,i,n){var o="custom"==n.value;t.element.toggleClass("custom-privacy",o),o?n.preventSave=!0:t.textField().textboxlist("controller").clearItems()},"{parent} privacySave":function(e,t,i){},"{parent} deactivate":function(){t.textboxlist.autocomplete.hide()},"{cancelButton} click":function(){t.element.removeClass("custom-privacy"),t.textboxlist.autocomplete.hide()},"{saveButton} click":function(){var e=t.parent,i=t.customItem(),n=e.getData(i);n.custom=t.customKey().val(),t.parent.save(n),t.parent.deactivate()},"{textField} addItem":function(){t.updateIds()},"{textField} removeItem":function(){t.updateIds()}}}),e(document).on("click.es.privacy","[data-es-privacy-container]",function(){var t=e(this);t.hasController("EasySocial.Controller.Privacy")||t.addController("EasySocial.Controller.Privacy").toggle()}),t.resolve()})}),EasySocial.module("site/locations/popbox",function(e){EasySocial.module("locations/popbox",function(e){this.resolve(function(t){var i=t.button,n=i.data("lat"),o=i.data("lng");return{id:"fd",component:"es",type:"location",content:'<a href="'+("//maps.google.com/?q="+n+","+o)+'" target="_blank"><img src="'+("//maps.googleapis.com/maps/api/staticmap?size=400x200&sensor=true&zoom=15&center="+n+","+o+"&markers="+n+","+o+"&language="+(e('meta[property="foundry:location:language"]').attr("content")||"en"))+'" width="400" height="200" /></a>'}})}),this.resolve()}),EasySocial.module("site/sidebar/sidebar",function(e){var t=this;e(document).on("click.es.sidebar","[data-sidebar-toggle]",function(){var t=e(this),i=t.siblings("[data-sidebar]");i.length<1&&(i=t.closest("[data-sidebar]")),i.length<1&&(i=e("[data-sidebar]")),i.toggleClass("sidebar-open").trigger("sidebarToggle")}),t.resolve()}),EasySocial.module("site/friends/api",function(e){var t=this;EasySocial.require().library("dialog","popbox").done(function(){e(document).on("click.es.friends.cancel","[data-es-friends-cancel]",function(){var t=e(this).data("es-friends-id");EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmCancel"),bindings:{"{confirmButton} click":function(){EasySocial.ajax("site/controllers/friends/cancelRequest",{id:t}).done(function(){EasySocial.dialog().close()})}}})}),e(document).on("click.es.friends.add","[data-es-friends-add]",function(){var t=e(this),i=t.data("es-friends-id"),n=e.Deferred();t.popbox({content:n,id:"fd",component:"es",type:"friends",toggle:"click"}),t.popbox("show"),EasySocial.ajax("site/controllers/friends/request",{viewCallback:"popboxRequest",id:i}).done(function(e){n.resolve(e)})}),t.resolve()})}),EasySocial.module("site/popbox/popbox",function(e){var t=this;EasySocial.module("notifications/popbox",function(e){this.resolve(function(e){return{content:EasySocial.ajax("site/controllers/notifications/getSystemItems",{layout:"popbox.notifications"}),id:"fd",component:"es",type:"notifications",cache:!1}})}),EasySocial.module("conversations/popbox",function(e){this.resolve(function(e){return{content:EasySocial.ajax("site/controllers/notifications/getConversationItems",{usemax:"1",layout:"popbox.conversations"}),id:"fd",component:"es",type:"notifications",cache:!1}})}),EasySocial.module("friends/popbox",function(e){this.resolve(function(e){return{content:EasySocial.ajax("site/controllers/notifications/friendsRequests",{layout:"popbox.friends"}),id:"fd",component:"es",type:"notifications",cache:!1}})}),t.resolve()}),EasySocial.module("site/conversations/api",function(e){var t=this;EasySocial.require().library("dialog").done(function(){e(document).on("click.es.conversations.compose","[data-es-conversations-compose]",function(){var t=e(this),i=t.data("es-conversations-id"),n=t.data("es-conversations-listid");EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/composer",{id:i,listId:n}),bindings:{"{sendButton} click":function(){var t=e("input[name=recipient\\[\\]]"),o=e("[data-composer-message]").val(),a=new Array,r=this.parent;e(t).each(function(){a.push(e(this).val())}),EasySocial.ajax("site/controllers/conversations/store",{uid:a,message:o}).done(function(e){i&&EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/sent",{id:i}),bindings:{"{viewButton} click":function(){document.location=e}}}),n&&EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/sentList",{id:n}),bindings:{"{viewButton} click":function(){document.location=e}}})}).fail(function(e){r.setMessage(e)})}}})}),t.resolve()})}),EasySocial.module("site/followers/api",function(e){var t=this;EasySocial.require().library("dialog","popbox").done(function(){e(document).on("click.es.followers.follow","[data-es-followers-follow]",function(){var t=e(this),i=t.data("es-followers-id"),n=e.Deferred(),o=void 0==t.data("es-show-popbox")||"true"==t.data("es-show-popbox");o&&(t.popbox({content:n,id:"fd",component:"es",type:"followers",toggle:"click"}),t.popbox("show")),EasySocial.ajax("site/controllers/profile/follow",{id:i,type:"user"}).done(function(a){e(t).trigger("following",a),o&&EasySocial.ajax("site/views/profile/popboxFollow",{id:i}).done(function(e){n.resolve(e)})})}),e(document).on("click.es.followers.unfollow","[data-es-followers-unfollow]",function(){var t=e(this),i=t.data("es-followers-id"),n=e.Deferred();t.popbox({content:n,id:"fd",component:"es",type:"followers",toggle:"click"}),t.popbox("show"),EasySocial.ajax("site/controllers/profile/unfollow",{id:i,type:"user"}).done(function(e){EasySocial.ajax("site/views/profile/popboxUnfollow",{id:i}).done(function(e){n.resolve(e)})})}),t.resolve()})}),EasySocial.module("site/stream/video",function(e){e(document).on("click","[data-es-links-embed-item]",function(){var t=e(this),i='<div class="video-container">'+e("<div>").html(t.data("es-stream-embed-player")).html()+"</div>";t.replaceWith(i)}),this.resolve()}),EasySocial.module("oauth/facebook",function(e){var t=this;e(document).on("click","[data-oauth-facebook-login]",function(){var t=e(this),i=t.parents("[data-oauth-facebook]"),n="EasySocial.Controller.OAuth.Facebook";i.length<1||i.hasController(n)||i.addController(n,{url:t.data("oauth-facebook-url"),appId:t.data("oauth-facebook-appid")}).openDialog()}),EasySocial.Controller("OAuth.Facebook",{defaultOptions:{appId:null,url:"","{login}":"[data-oauth-facebook-login]","{revoke}":"[data-oauth-facebook-revoke]","{pushInput}":"[data-oauth-facebook-push]"}},function(t){return{init:function(){},openDialog:function(){var e=t.options.url,i=screen.width/2-150,n=screen.height/2-150;window.open(e,"","scrollbars=no,resizable=no,width=300,height=300,left="+i+",top="+n)},"{pushInput} change":function(i){var n=e(i).val();1==n&&t.options.requestPush&&t.openDialog(t.options.addPublishURL),0==n&&t.openDialog(t.options.revokePublishURL)},"{login} click":function(){t.openDialog()},"{revoke} click":function(){var e=t.element.data("callback");EasySocial.dialog({content:EasySocial.ajax("site/views/oauth/confirmRevoke",{client:"facebook",callbackUrl:e})})}}}),t.resolve()}),EasySocial.module("locations",function(e){var t=this;EasySocial.require().library("gmaps").done(),EasySocial.require().library("scrollTo").view("site/location/story.suggestion").language("COM_EASYSOCIAL_AT_LOCATION").done(function(){var i={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller("Locations",{defaultOptions:{view:{suggestion:"site/location/story.suggestion"},map:{lat:0,lng:0},"{textField}":"[data-location-textField]","{detectLocationButton}":"[data-detect-location-button]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-story-location-suggestion]","{mapPreview}":"[data-location-map]","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]"}},function(t){return{init:function(){navigator.geolocation&&t.detectLocationButton().show(),EasySocial.require().library("gmaps").done(function(){t.textField().removeAttr("disabled")})},navigate:function(e,i){var n=t.mapPreview(),o=t.map;void 0===o&&(o=t.map=n.show().gmaps(t.options.map)),o.setCenter(e,i),o.removeMarkers(),o.addMarker({lat:e,lng:i})},locations:{},lastQueryAddress:null,"{textField} keypress":function(n,o){switch(o.keyCode){case i.UP:var a=e(t.suggestion(".active").prev(t.suggestion.selector)[0]||t.suggestion(":last")[0]);t.suggestion().removeClass("active"),a.addClass("active").trigger("activate"),t.suggestions().scrollTo(a,{offset:-1*a.height()}),o.preventDefault();break;case i.DOWN:var r=e(t.suggestion(".active").next(t.suggestion.selector)[0]||t.suggestion(":first")[0]);t.suggestion().removeClass("active"),r.addClass("active").trigger("activate"),t.suggestions().scrollTo(r,{offset:-1*r.height()}),o.preventDefault();break;case i.ENTER:var s=t.suggestion(".active").data("location");t.set(s),t.suggestions().hide()}},"{textField} keyup":function(n,o){switch(o.keyCode){case i.UP:case i.DOWN:case i.ENTER:case i.ESCAPE:break;default:var a=e.trim(n.val());if(""===a&&t.suggestions().hide(),a==t.lastQueryAddress)return;var r=t.locations[a];r?(t.suggest(r),t.lastQueryAddress=a):t.lookup(a)}},lookup:e._.debounce(function(i){e.GMaps.geocode({address:i,callback:function(e,n){"OK"==n&&(t.locations[i]=e,t.suggest(e),t.lastQueryAddress=i)}})},250),suggest:function(i){var n=t.suggestions();n.hide().empty(),e.each(i,function(e,i){t.view.suggestion({location:i}).data("location",i).appendTo(n)}),n.show()},"{suggestion} activate":function(e,i){var n=e.data("location");t.navigate(n.geometry.location.lat(),n.geometry.location.lng())},"{suggestion} mouseover":function(e){t.suggestion().removeClass("active"),e.addClass("active").trigger("activate")},"{suggestion} click":function(e,i){var n=e.data("location");t.set(n),t.suggestions().hide()},set:function(e){t.currentLocation=e;var i=e.formatted_address;t.textField().val(i),t.latitude().val(e.geometry.location.lat()),t.longitude().val(e.geometry.location.lng()),t.trigger("locationChange",[e])},"{detectLocationButton} click":function(){t.map;e.GMaps.geolocate({success:function(i){e.GMaps.geocode({lat:i.coords.latitude,lng:i.coords.longitude,callback:function(e,i){"OK"==i&&(t.suggest(e),t.textField().focus())}})},error:function(e){},always:function(){}})},"{story} save":function(e,i,n){var o=t.currentLocation;o&&n.addData(t,{short_address:o.address_components[0].long_name,formatted_address:o.formatted_address,lat:o.geometry.location.lat(),lng:o.geometry.location.lng()})},"{story} clear":function(){t.unset()}}}),t.resolve()})}),EasySocial.module("pagination",function(){var e=this;EasySocial.require().done(function(t){EasySocial.Controller("Pagination",{defaultOptions:{"{pages}":".pageItem","{limitstart}":"#limitstart","{previousItem}":".previousItem","{nextItem}":".nextItem"}},function(e){return{init:function(){e.pages().implement(EasySocial.Controller.Pagination.Page,{pagination:e})},"{previousItem} click":function(i){var n=t(i).data("limitstart");t(i).hasClass("disabled")||e.submitForm(n)},"{nextItem} click":function(i){var n=t(i).data("limitstart");t(i).hasClass("disabled")||e.submitForm(n)},submitForm:function(i){e.limitstart().val(i),t.Joomla("submitform",[])}}}),EasySocial.Controller("Pagination.Page",{defaultOptions:{pagination:null,limitstart:0}},function(e){return{init:function(){e.options.limitstart=e.element.data("limitstart")},"{self} click":function(){if(e.element.hasClass("active"))return!1;e.options.pagination.submitForm(e.options.limitstart)}}}),e.resolve()})}),EasySocial.module("photos/avatar",function(e){var t=this;EasySocial.require().library("imgareaselect").stylesheet("imgareaselect/default").done(function(){EasySocial.Controller("Photos.Avatar",{defaultOptions:{view:{selection:"site/photos/avatar.selection"},uid:null,type:null,redirect:!0,redirectUrl:"","{image}":"[data-photo-image]","{viewport}":"[data-photo-avatar-viewport]","{photoId}":"[data-photo-id]","{userId}":"[data-user-id]","{createButton}":"[data-create-button]","{selection}":"[data-selection-box]","{loadingIndicator}":"[data-photos-avatar-loading]"}},function(t){return{init:function(){t.setLayout()},data:function(){var e=t.viewport(),i=e.width(),n=e.height(),o=e.imgAreaSelect({instance:!0}).getSelection();return{id:t.photoId().val(),uid:t.options.uid,type:t.options.type,top:o.y1/n,left:o.x1/i,width:o.width/i,height:o.height/n}},imageLoaders:{},setLayout:function(){var i=t.image(),n=i.css("backgroundImage").replace(/^url\(['"]?/,"").replace(/['"]?\)$/,"");(t.imageLoaders[n]||(t.imageLoaders[n]=e.Image.get(n))).done(function(n,o){var a=e.Image.resizeWithin(o.width,o.height,i.width(),i.height()),r=Math.min(a.width,a.height),s=Math.floor((a.width-r)/2),l=Math.floor((a.height-r)/2),c=s+r,d=l+r;t.createButton().enabled(!0),t.viewport().css(a).imgAreaSelect({handles:!0,aspectRatio:"1:1",parent:t.image(),x1:s,y1:l,x2:c,y2:d,onSelectEnd:function(e,i){var n=!("0"==i.width&&"0"==i.height);t.createButton().enabled(n)}})})},"{createButton} click":function(e){var i=t.data(),n=EasySocial.ajax("site/controllers/photos/createAvatar",i).done(function(e,i){t.options.redirect&&(window.location=t.options.redirectUrl)}).fail(function(e,i){t.setMessage(e,i)});t.trigger("avatarCreate",[n,i,t])}}}),t.resolve()})}),EasySocial.module("photos/browser",function(e){var t=this;EasySocial.require().library("masonry").done(),EasySocial.require().library("history").done(function(){EasySocial.Controller("Photos.Browser",{defaultOptions:{tilesPerRow:4,"{sidebar}":"[data-photo-browser-sidebar]","{content}":"[data-photo-browser-content]","{backButton}":"[data-photo-back-button]","{backButtonLink}":"[data-photo-back-button-link]","{listItemGroup}":"[data-photo-list-item-group]","{listItem}":"[data-photo-list-item]","{listItemLink}":"[data-photo-list-item] > a","{listItemTitle}":"[data-photo-list-item-title]","{listItemCover}":"[data-photo-list-item-cover]","{listItemImage}":"[data-photo-list-item-image]","{featuredListItem}":"[data-photo-list-item].featured","{featuredListItemImage}":"[data-photo-list-item].featured [data-photo-list-item-image]","{photoItem}":"[data-photo-item]"}},function(t){return{init:function(){e.module("masonry").done(function(){t.setLayout()})},setLayout:function(){var e=t.listItemGroup().addClass("masonry"),i=t.setLayout.seed==e.width();if(hasPhotoItem=t.listItem().length>0,masonry=e.data("masonry"),i)masonry&&masonry.reload();else{var e=t.listItemGroup(),n=t.listItem(),o=t.options.tilesPerRow,a=e.width(),r=Math.floor(a/o)*o/o,s=n.outerWidth(!0)-n.width(),l=r,c=n.outerHeight(!0)-n.height(),d=r-s,u=l-c,p=d,f=u,m=2*r-s,h=2*l-c,g=m,v=h;t.listItem.css({width:d,height:u}),t.listItemImage.css({width:p,height:f}),t.featuredListItem.css({width:m,height:h}),t.featuredListItemImage.css({width:g,height:v}),e.masonry({columnWidth:r}).masonry("reload")}t.setLayout.seed=e.width()},open:function(i){var n=e.makeArray(arguments);t.trigger("contentLoad",n);var o="view"+e.String.capitalize(i),a=t[o].apply(t,n.slice(1));return a.done(t.displayContent(function(){return t.trigger("contentDisplay",n),arguments})).fail(function(){t.trigger("contentFail",n)}).always(function(){t.trigger("contentComplete",n)}),a},displayContent:e.Enqueue(function(i){var n=[],o=e(e.buildFragment([i],document,n));t.content().html(o),e(n).remove()}),viewPhoto:function(e){var i=t.listItem().removeClass("active loading").filterBy("photoId",e).addClass("active loading");return EasySocial.ajax("site/views/photos/item",{id:e,browser:!1}).fail(function(){}).always(function(){i.removeClass("loading")})},"{listItem} click":function(e){var i=e.data("photoId");t.open("Photo",i),e.find("> a").route()},"{listItemLink} click":function(e,t){t.preventDefault(),e.blur()},"{backButtonLink} click":function(e,i){var n=t.browser;if(n){var o=t.element.data("albumId");n.open("album",o),i.preventDefault(),e.route(),n.setLayout("album"),t.element.remove()}},getListItem:function(i,n){var o=i?t.listItem().filterBy("photoId",i):t.listItem(".new");return n?o.find(t["listItem"+e.String.capitalize(n)].selector):o},getNextListItem:function(e){var i=t.getListItem(e).next(t.listItem.selector);return i.length<1&&(i=t.listItem(":first")),i},getPrevListItem:function(e){var i=t.getListItem(e).prev(t.listItem.selector);return i.length<1&&(i=t.listItem(":last")),i},removeListItem:function(e,i){var n=t.getListItem(e),o=t.getPrevListItem(e);if(n.remove(),t.setLayout(),t.listItem().length<1)return t.element.addClass("loading"),window.location=t.backButtonLink().attr("href");i&&o.click()},"{photoItem} init.photos.item":function(e,i,n){t.addSubscriber(n)},"{photoItem} photoSave":function(e,i,n){n.done(function(e,i){t.getListItem(e.id,"title").html(e.title)})},"{photoItem} photoNext":function(e,i,n){t.getNextListItem(n.id).click()},"{photoItem} photoPrev":function(e,i,n){t.getPrevListItem(n.id).click()},"{photoItem} photoMove":function(e,i,n,o,a){n.done(function(){t.removeListItem(o.id,!0)})},"{photoItem} photoDelete":function(e,i,n,o){n.done(function(){t.removeListItem(o.id,!0)})},"{photoItem} photoFeature":function(e,i,n,o,a){var r=t.getListItem(o.id);r.toggleClass("featured",a),t.setLayout(),n.fail(function(){r.toggleClass("featured",!a),t.setLayout()})},"{sidebar} sidebarToggle":function(){t.setLayout()}}}),t.resolve()})}),EasySocial.module("photos/editor",function(e){var t=this;EasySocial.require().done(function(){var i=EasySocial.Controller("Photos.Editor",{defaultOptions:{view:{uploadItem:"upload.item",photoForm:"site/albums/photo.form"},"{titleField}":"[data-photo-title-field]","{captionField}":"[data-photo-caption-field]","{location}":"[data-photo-location]","{locationCaption}":"[data-photo-location-caption]","{addLocationButton}":"[data-photo-addLocation-button]","{date}":"[data-photo-date]","{dateCaption}":"[data-photo-date-caption]","{addDateCaption}":"[data-photo-adddate-button]","{locationWidget}":".es-photo-location-form .es-location","{latitude}":"[data-location-lat]","{longitude}":"[data-location-lng]","{dateDay}":"[name=date-day]","{dateMonth}":"[name=date-month]","{dateYear}":"[name=date-year]","{actionsMenu}":"[data-item-actions-menu]","{featureButton}":"[data-photo-feature-button]","{coverButton}":"[data-photo-cover-button]","{editButton}":"[data-photo-edit-button]","{editButtonLink}":"[data-photo-edit-button] > a","{cancelButton}":"[data-photo-cancel-button]","{doneButton}":"[data-photo-done-button]","{doneButtonLink}":"[data-photo-done-button] > a","{moveButton}":"[data-photo-move-button]","{deleteButton}":"[data-photo-delete-button]","{rotateLeftButton}":"[data-photo-rotateLeft-button]","{rotateRightButton}":"[data-photo-rotateRight-button]","{profileAvatarButton}":"[data-photo-profileAvatar-button]","{profileCoverButton}":"[data-photo-profileCover-button]"}},function(t){return{init:function(){},data:function(){return{id:t.photo.id,title:t.titleField().val(),caption:t.captionField().val(),date:t.formatDate(),address:t.locationCaption().html(),latitude:t.latitude().val(),longitude:t.longitude().val()}},save:function(){var e=t.data();t.clearMessage();var i=EasySocial.ajax("site/controllers/photos/update",e).done(function(e){t.photo.setLayout("item")}).fail(function(){t.setMessage(message,"error")}).progress(function(e,i){"success"==i&&t.setMessage(e)});return t.trigger("photoSave",[i,t]),i},enable:function(){t.photo.setLayout("form"),t.photo.album&&t.element.addClass("active"),t.trigger("enabled",[t])},disable:function(){t.photo.setLayout("item"),t.photo.album&&t.element.removeClass("active"),t.trigger("disabled",[t])},imageLoader:{},setImage:function(i){var n=t.photo.image(),o=t.photo.imageCss(),a=n.data(i+"Src"),r=t.imageLoader[a];return r||(r=e.Image.get(a),t.imageLoader[a]=r),r.done(function(){n.attr("src",a),o.css({backgroundImage:e.cssUrl(a)})}),r},"{featureButton} click":function(e,i){i.stopPropagation();var n=t.photo.element.parents("[data-photo-popup]").length>0||t.photo.element.parents("[data-photo-browser-content]").length>0,o=t.element.hasClass("featured");t.element.addTransitionClass("featuring",800).toggleClass("featured",!o),n||setTimeout(function(){t.setImage(o?"thumbnail":"featured")},1e3);var a=EasySocial.ajax("site/controllers/photos/feature",{id:t.photo.id}).done(function(t,i){e.toggleClass("btn-es-primary",i)}).fail(function(){t.element.addTransitionClass("featuring",800).toggleClass("featured",o),n||setTimeout(function(){t.setImage(o?"featured":"thumbnail")},1e3)});t.trigger("photoFeature",[a,t.photo,!o])},"{coverButton} click":function(){var e=t.photo.album;e&&e.editor&&e.editor.setCover(t.photo.id)},"{dateDay} keyup":function(){t.updateDate()},"{dateMonth} change":function(){t.updateDate()},"{dateYear} keyup":function(){t.updateDate()},updateDate:function(){setTimeout(function(){t.date().addClass("has-data");var i=t.dateDay().val()+" "+e.trim(t.dateMonth().find(":selected").text()+" "+t.dateYear().val());t.dateCaption().html(i)},1)},formatDate:function(){var e=t.dateDay().val()||t.dateDay().data("date-default"),i=t.dateMonth().val()||t.dateMonth().data("date-default");return(t.dateYear().val()||t.dateYear().data("date-default"))+"-"+i+"-"+e},"{locationWidget} locationChange":function(e,i,n){var o=n.formatted_address;t.locationCaption().html(o),t.location().addClass("has-data")},rotate:function(i){var n=t.photo;t.rotateLeftButton().disabled(!0),t.rotateRightButton().disabled(!0),n.content().addClass("loading");var o=EasySocial.ajax("site/controllers/photos/rotate",{id:n.id,angle:i}).done(function(i){var o;o=t.photo.album?i.sizes.thumbnail.url:i.sizes.large.url,o+="?"+e.uid(),n.image().attr("src",o),n.imageCss().css({backgroundImage:e.cssUrl(o)}),t.element.addTransitionClass("rotating-ready",150).removeClass("rotating-right rotating-left")}).fail(function(e,i){t.setMessage(e,i)}).always(function(){n.content().removeClass("loading"),t.rotateLeftButton().disabled(!1),t.rotateRightButton().disabled(!1)});t.trigger("photoRotate",[o,i,n])},"{rotateRightButton} click":function(){t.element.addClass("rotating-right"),t.rotate(90)},"{rotateLeftButton} click":function(){t.element.addClass("rotating-left"),t.rotate(-90)},"{moveButton} click":function(){var e=t.photo,i=EasySocial.dialog({content:EasySocial.ajax("site/views/photos/moveToAnotherAlbum",{id:e.id}),bindings:{"{moveButton} click":function(){var n=this.albumSelection().val(),o=EasySocial.ajax("site/controllers/photos/move",{id:e.id,albumId:n}).always(function(){i.close()});t.trigger("photoMove",[o,e,n])}}})},"{deleteButton} click":function(){var e=t.photo;EasySocial.dialog({content:EasySocial.ajax("site/views/photos/confirmDelete",{id:e.id}),bindings:{"{deleteButton} click":function(i){var n=this.parent;i.disabled(!0);var o=EasySocial.ajax("site/controllers/photos/delete",{id:e.id}).always(function(){n.close()});t.trigger("photoDelete",[o,e])}}})},"{editButton} click":function(){t.photo.setLayout("form"),t.editButtonLink().route()},"{editButtonLink} click":function(e,t){t.preventDefault()},"{cancelButton} click":function(){t.photo.setLayout("item"),t.doneButtonLink().route()},"{doneButton} click":function(){t.save().done(function(){t.photo.setLayout("item"),t.doneButtonLink().route()}).fail(function(){})},"{doneButtonLink} click":function(e,t){t.preventDefault()},"{profileAvatarButton} click":function(){EasySocial.photos.createAvatar(t.photo.id)}}});t.resolve(i)})}),EasySocial.module("photos/item",function(e){var t=this;EasySocial.require().script("photos/tags","photos/editor","photos/tagger","photos/navigation").done(),EasySocial.require().library("image").done(function(){var i=EasySocial.Controller("Photos.Item",{hostname:"photo",defaultOptions:{editable:!1,taggable:!1,navigation:!1,"{header}":"[data-photo-header]","{content}":"[data-photo-content]","{footer}":"[data-photo-footer]","{viewport}":"[data-photo-viewport]","{info}":"[data-photo-info]","{title}":"[data-photo-title]","{titleLink}":"[data-photo-title-link]","{caption}":"[data-photo-caption]","{image}":"[data-photo-image]","{imageCss}":"[data-photo-image-css]","{imageLink}":"[data-photo-image-link]","{menu}":"[data-photo-menu]","{actions}":"[data-item-actions]","{actionsMenu}":"[data-item-actions-menu]","{comments}":"[data-comments]","{share}":"[data-repost-action]","{likes}":"[data-likes-action]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{counterBar}":"[data-stream-counter]","{privacy}":"[data-es-privacy-container]","{likeCount}":"[data-photo-like-count]","{commentCount}":"[data-photo-comment-count]","{tagCount}":"[data-photo-tag-count]"}},function(t){return{init:function(){t.id=t.element.data("photoId"),EasySocial.module("photos/tags").done(function(e){t.tags=t.addPlugin("tags",e)}),t.options.editable&&EasySocial.module("photos/editor").done(function(e){t.editor=t.addPlugin("editor",e)}),t.options.taggable&&EasySocial.module("photos/tagger").done(function(e){t.tagger=t.addPlugin("tagger",e)}),t.options.navigation&&EasySocial.module("photos/navigation").done(function(e){t.navigation=t.addPlugin("navigation",e)})},data:function(){var i=t.image();return{id:t.id,title:e.trim(t.title().text()),caption:e.trim(t.caption().text()),sizes:{thumbnail:i.data("thumbnailSrc"),featured:i.data("featuredSrc"),large:i.data("largeSrc")}}},setLayout:function(e){t.element.data("photoLayout",e).switchClass("layout-"+e),t.trigger("layoutChange",[e,t])},"{self} click":function(i,n){if(i.data("esPhotoDisabled")){var o=e(n.target),a=t.menu();o.parents().andSelf().filter(a).length>0||t.trigger("activate",[t])}},"{self} photoSave":function(e,i,n){n.done(function(e,i){t.info().replaceWith(i)})},"{self} photoDelete":function(e,i,n){n.done(function(){}).fail(function(e,i){t.setMessage(e,i)})},"{imageLink} click":function(e,t){t.preventDefault()},"{titleLink} click":function(e,t){},"{self} shown.bs.dropdown":function(){t.element.addClass("show-all")},"{self} hidden.bs.dropdown":function(){t.element.removeClass("show-all")},"{share} create":function(e,i,n){t.counterBar().removeClass("hide")},"{likes} onLiked":function(e,i,n){t.counterBar().removeClass("hide"),t.count("like",1,!0)},"{likes} onUnliked":function(e,i,n){var o=t.likeContent().hasClass("hide"),a=t.repostContent().hasClass("hide");o&&a&&t.counterBar().addClass("hide"),t.count("like",-1,!0)},"{self} tagAdd":function(){t.count("tag",1,!0)},"{self} tagRemove":function(){t.count("tag",-1,!0)},"{comments} newCommentSaved":function(){t.count("comment",1,!0)},"{comments} commentDeleted":function(){t.count("comment",-1,!0)},"{privacy} activate":function(){setTimeout(function(){t.element.addClass("show-all")},0)},"{privacy} deactivate":function(){t.element.removeClass("show-all")},count:function(i,n,o){var a=t[i+"Count"];if(e.isFunction(a)){var r=a();if(!(r.length<0)){var s;(s=o?(parseInt(r.text())||0)+(parseInt(n)||0):n)<0&&(s=0),r.text(s)}}}}});t.resolve(i)})}),EasySocial.module("photos/tags",function(e){var t=this;EasySocial.require().library("scrollTo").done(),EasySocial.require().done(function(){var i=EasySocial.Controller("Photos.Tags",{hostname:"tags",defaultOptions:{"{viewport}":"[data-photo-tag-viewport]","{tagItem}":"[data-photo-tag-item]","{tagButton}":"[data-photo-tag-button]","{tagLink}":"[data-photo-tag-link]","{infoTagListItemGroup}":"[data-photoinfo-tag-list-item-group]","{infoTagListItem}":"[data-photo-tags-user]","{tagListItemGroup}":"[data-photo-tag-list-item-group]","{tagListItem}":"[data-photo-tag-list-item]","{descTagItem}":"[data-photo-tags-user]"}},function(t){return{init:function(){t.setLayout()},imageLoaders:{},setLayout:function(i){var n=t.photo.viewport(),o=t.photo.image(),a=o.attr("src");(t.imageLoaders[a]||(t.imageLoaders[a]=e.Image.get(a))).done(function(){var e=o.offset(),a=n.offset();t.viewport().css({top:e.top-a.top,left:e.left-a.left,width:o.width(),height:o.height()}),i&&i()})},"{window} resize":e.debounce(function(){t.setLayout()},1e3),getTagItem:function(e){return t.tagItem().filterBy("photoTagId",e)},getTagListItem:function(e){return t.tagListItem().filterBy("photoTagId",e)},getInfoTagListItem:function(e){return t.infoTagListItem().filterBy("photoTagId",e)},getTaggedUsers:function(){var i=[];return t.tagListItem("[data-photo-tag-uid]").each(function(){i.push(e(this).data("photoTagUid"))}),e.uniq(i)},activateTag:function(e){t.getTagItem(e).addClass("active"),t.getTagListItem(e).addClass("active")},deactivateTag:function(e){t.getTagItem(e).removeClass("active"),t.getTagListItem(e).removeClass("active")},"{tagLink} click":function(e,t){t.stopPropagation()},"{tagListItem} click":function(e){var i=(e.hasClass("active")?"deactivate":"activate")+"Tag",n=e.data("photoTagId");t[i](n)},"{tagListItem} mouseover":function(e){t.getTagItem(e.data("photoTagId")).addClass("focus")},"{tagListItem} mouseout":function(e){t.getTagItem(e.data("photoTagId")).removeClass("focus")},"{descTagItem} mouseover":function(e){t.getTagItem(e.data("photoTagId")).addClass("focus")},"{descTagItem} mouseout":function(e){t.getTagItem(e.data("photoTagId")).removeClass("focus")},"{self} tagCreate":function(e,i,n){n.done(function(){}).always(function(){setTimeout(function(){t.tagListItemGroup().toggleClass("empty-tags",t.tagListItem().length<1)},1)})},"{self} tagRemove":function(e,i,n,o){n.done(function(){t.getTagItem(o).remove(),t.getTagListItem(o).remove(),t.getInfoTagListItem(o).remove();var e=t.infoTagListItemGroup().children().length;if(0==e&&t.infoTagListItemGroup().html(""),1==e){var i=t.infoTagListItemGroup().children().first(),n=i.text();n=n.replace(",",""),console.log(n),i.text(n)}}).always(function(){t.tagListItemGroup().toggleClass("empty-tags",t.tagListItem().length<1)})},"{self} photoRotate":function(i,n,o,a,r){o.done(function(i,n){setTimeout(function(){t.setLayout(function(){var i=t.tagItem();e.each(n,function(e,t){i.filterBy("photoTagId",t.id).css({width:100*t.width+"%",height:100*t.height+"%",top:100*t.top+"%",left:100*t.left+"%"})})})},1)})}}});t.resolve(i)})}),EasySocial.module("photos/tagger",function(e){var t=this,i={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.require().library("scrollTo").done(),EasySocial.require().view("site/photos/tags.item","site/photos/tags.menu.item").done(function(){var n=EasySocial.Controller("Photos.Tagger",{hostname:"tagger",defaultOptions:{view:{tagItem:"site/photos/tags.item"},width:100,height:100,drawTolerance:30,"{viewport}":"[data-photo-tag-viewport]","{tagItem}":"[data-photo-tag-item]","{tagSelection}":"[data-photo-tag-item].new","{tagButton}":"[data-photo-tag-button]","{infoTagListItemGroup}":"[data-photoinfo-tag-list-item-group]","{tagListItemGroup}":"[data-photo-tag-list-item-group]","{tagListItem}":"[data-photo-tag-list-item]","{tagRemoveButton}":"[data-photo-tag-remove-button]"}},function(t){return{init:function(){},newTagItem:function(){var e=t.viewport(),i=t.tagItem(".new");return i.length<1&&(i=t.view.tagItem().addClass("new").appendTo(e),t.addSubscriber(i.addController("EasySocial.Controller.Photos.Tag"))),i},"{tagButton} click":function(e){t[e.data("photoTagButton")||"toggle"]()},disabled:!0,enable:function(){t.photo.imageLink().on("click.tagger",function(e){e.preventDefault()}),t.disabled=!1,t.element.addClass("tagging"),e.scrollTo&&e.scrollTo(t.photo.content(),250,{offset:{top:-100}}),t.trigger("tagEnter")},disable:function(){t.photo.imageLink().off("click.tagger"),t.tagSelection().remove(),t.tagItem(".focus").removeClass("focus"),t.disabled=!0,t.element.removeClass("tagging"),t.trigger("tagLeave")},toggle:function(){t[t.disabled?"enable":"disable"]()},area:{},calculateArea:function(e,i){e||(e="clip"),i||(i={x:0,y:0});var n=t.viewport(),o=n.offset();o.width=n.width(),o.height=n.height(),o.right=o.width+o.left,o.bottom=o.height+o.top;var a=t.area;a.top=(a.startY<=a.endY?a.startY:a.endY)+i.y,a.left=(a.startX<=a.endX?a.startX:a.endX)+i.x,a.width=Math.abs(a.endX-a.startX),a.height=Math.abs(a.endY-a.startY),a.right=a.width+a.left,a.bottom=a.height+a.top,"clip"==e&&(a.top<=o.top&&(a.top=o.top),a.bottom>=o.bottom&&(a.bottom=o.bottom),a.left<=o.left&&(a.left=o.left),a.right>=o.right&&(a.right=o.right),a.width=a.right-a.left,a.height=a.bottom-a.top),"flip"==e&&(a.top<=o.top&&(a.top=o.top),a.left<=o.left&&(a.left=o.left),a.right>=o.right&&(a.right=o.right,a.left=a.right-a.width),a.bottom>=o.bottom&&(a.bottom=o.bottom,a.top=a.bottom-a.height)),a.pixel={top:a.top-o.top,left:a.left-o.left,width:a.width,height:a.height},a.decimal={top:a.pixel.top/o.height,left:a.pixel.left/o.width,width:a.width/o.width,height:a.height/o.height},a.percentage={top:100*a.decimal.top+"%",left:100*a.decimal.left+"%",width:100*a.decimal.width+"%",height:100*a.decimal.height+"%"};var r=t.options.drawTolerance;return t.autodraw=a.width<r&&a.height<r,a},setPivot:function(e,i,n){var o=t.area;o[e+"X"]=i,o[e+"Y"]=n},drawing:!1,autodraw:!1,drawTag:function(){var e=t.calculateArea();options=t.options,t.autodraw&&(e.endX=e.startX+options.width,e.endY=e.startY+options.height,t.calculateArea("flip",{x:options.width/-2,y:options.height/-2})),t.newTagItem().css(e.percentage).trigger("focusInput")},"{viewport} mousedown":function(i,n){t.disabled||n.target===i[0]&&(n.preventDefault(),t.tagItem(".focus").removeClass("focus"),t.drawing=!0,t.setPivot("start",n.pageX,n.pageY),e(document).on("mousemove.tagger",function(e){t.drawing&&(t.setPivot("end",e.pageX,e.pageY),t.drawTag())}).on("mouseup.tagger",function(i){t.setPivot("end",i.pageX,i.pageY),t.drawTag(),e(document).off("mousemove.tagger mouseup.tagger")}))},createTag:function(i){var i=e.extend({photo_id:t.photo.id},i,t.area.decimal),n=EasySocial.ajax("site/controllers/photos/createTag",i);return t.trigger("tagCreate",[n,i,t]),n},removeTag:function(e){var i=EasySocial.ajax("site/controllers/photos/removeTag",{id:e});return t.trigger("tagRemove",[i,e,t]),i},addTag:function(i,n,o,a){var r=e.buildHTML(n).addClass("focus").appendTo(t.viewport()),s=e.buildHTML(o).appendTo(t.tagListItemGroup());0==t.infoTagListItemGroup().children().length&&t.infoTagListItemGroup().append(" - ");e.buildHTML(a).appendTo(t.infoTagListItemGroup());t.trigger("tagAdd",[i,r,s,t])},"{self} avatarEnter":function(){t.tagItem().hide(),t.disable()},"{self} avatarLeave":function(){t.tagItem().show()},"{tagRemoveButton} click":function(e,i){var n=e.data("photoTagId");t.removeTag(n),i.stopPropagation()},"{tagRemoveButton} mouseover":function(){t.viewport().addClass("active")},"{tagRemoveButton} mouseout":function(){t.viewport().removeClass("active")}}});EasySocial.Controller("Photos.Tag",{defaultOptions:{view:{menuItem:"site/photos/tags.menu.item"},"{form}":"[data-photo-tag-form]","{title}":"[data-photo-tag-title]","{removeButton}":"[data-photo-tag-remove-button]","{textField}":"[data-photo-tag-input]","{menu}":"[data-photo-tag-menu]","{menuItem}":"[data-photo-tag-menu-item]"}},function(t){return{init:function(){t.data=t.options.data},"{self} focusInput":function(){t.textField().focus()},"{textField} keyup":e._.debounce(function(n,o){var a=e.trim(t.textField().val());switch(o.keyCode){case i.UP:case i.DOWN:case i.ENTER:case i.ESCAPE:break;default:var r=t.tagger.photo.tags.getTaggedUsers();EasySocial.ajax("site/controllers/friends/suggestPhotoTagging",{search:a,exclude:r,includeme:"1"}).done(t.render())}},250),"{textField} keypress":function(n,o){var a=e.trim(t.textField().val()),r=t.menuItem(".active");switch(o.keyCode){case i.UP:t.menuItem().removeClass("active"),r.length<1?t.menuItem(":last").addClass("active"):r.prev(t.menuItem.selector).addClass("active"),o.preventDefault();break;case i.DOWN:t.menuItem().removeClass("active"),r.length<1?t.menuItem(":first").addClass("active"):r.next(t.menuItem.selector).addClass("active"),o.preventDefault();break;case i.ENTER:r.length>0?r.trigger("click"):t.create({type:"label",label:a}),t.menu().hide();break;case i.ESCAPE:t.menu().hide()}},"{menuItem} mouseover":function(e){t.menuItem().removeClass("active"),e.addClass("active")},"{menuItem} mouseout":function(e){t.menuItem().removeClass("active")},render:e.Enqueue(function(i){var n=t.menu();!i||i.length<1?n.hide():(n.empty(),e.each(i,function(e,i){t.view.menuItem({item:i}).data("item",i).appendTo(n),n.show()}))}),create:function(i){var n=t.element;t.data=i,t.title().html(i.label),""!==e.trim(i.label)&&t.tagger.createTag(i).done(function(e,i,n,o){t.tagger.addTag(e,i,n,o),t.element.remove()}).fail(function(e){alert(e.message),n.remove()})},remove:function(){var e=t.element,i=(t.data||{}).id;if(!i)return e.remove();t.tagger.removeTag(i).done(function(){e.remove()})},"{menuItem} click":function(e){var i=e.data("item");t.create({uid:i.id,type:"person",label:i.screenName})},"{removeButton} click":function(){t.remove()}}}),t.resolve(n)})}),EasySocial.module("photos/navigation",function(e){e.fn.intersectsWith=function(e,t,i,n){var o=this.offset(),a={top:o.top,left:o.left,bottom:o.top+(sourceHeight=this.height()),right:o.left+(sourceWidth=this.width()),width:sourceWidth,height:sourceHeight},r={top:e,left:t,bottom:e+(n||(n=0)),right:t+(i||(i=0)),width:i,height:n};return!!(a.left<=r.right&&r.left<=a.right&&a.top<=r.bottom&&r.top<=a.bottom)&&{reference:a,subject:r}};var t=this,i=EasySocial.Controller("Photos.Navigation",{hostname:"navigation",defaultOptions:{"{navButton}":".es-photo-nav-button","{nextButton}":"[data-photo-next-button]","{prevButton}":"[data-photo-prev-button]"}},function(t,i,n){return{init:function(){t.setDirection(window.esPhotosNavigationLastDirection)},disabled:!1,disable:function(){t.disabled=!0,t.navButton().addClass("disabled")},enable:function(){t.disabled=!1,t.navButton().removeClass("disabled")},setDirection:function(e){t.navButton().removeClass("active"),window.esPhotosNavigationLastDirection=t.currentDirection=e,e&&t[e+"Button"]().addClass("active")},"{window} mousemove":function(i,n){if(!(t.disabled||(t.setDirection(null),t.photo.trigger("directionstop"),e(n.target).parents().filter(t.photo.content.selector).length<1))){var o=t.photo.content().intersectsWith(n.pageY,n.pageX);if(o){var a=o.subject.left<o.reference.right-o.reference.width/2?"prev":"next";t.setDirection(a),t.photo.trigger("directionmove",[o,a])}}},"{self} tagEnter":function(){t.disable()},"{self} tagLeave":function(){t.enable()},"{self} click":function(i,n){if(!(t.disabled||e(n.target).parents().filter(t.photo.content.selector).length<1)){var o=t.currentDirection;o&&t.trigger("photo"+e.String.capitalize(o),[t.photo])}},"{self} photoNext":function(){},"{self} photoPrev":function(){}}});t.resolve(i)}),EasySocial.module("prism",function(e){var t=this;!function(){var e=/\blang(?:uage)?-(?!\*)(\w+)\b/i,t=self.Prism={util:{type:function(e){return Object.prototype.toString.call(e).match(/\[object (\w+)\]/)[1]},clone:function(e){switch(t.util.type(e)){case"Object":var i={};for(var n in e)e.hasOwnProperty(n)&&(i[n]=t.util.clone(e[n]));return i;case"Array":return e.slice()}return e}},languages:{extend:function(e,i){var n=t.util.clone(t.languages[e]);for(var o in i)n[o]=i[o];return n},insertBefore:function(e,i,n,o){var a=(o=o||t.languages)[e],r={};for(var s in a)if(a.hasOwnProperty(s)){if(s==i)for(var l in n)n.hasOwnProperty(l)&&(r[l]=n[l]);r[s]=a[s]}return o[e]=r},DFS:function(e,i){for(var n in e)i.call(e,n,e[n]),"Object"===t.util.type(e)&&t.languages.DFS(e[n],i)}},highlightAll:function(e,i){for(var n,o=document.querySelectorAll('code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'),a=0;n=o[a++];)t.highlightElement(n,!0===e,i)},highlightElement:function(n,o,a){for(var r,s,l=n;l&&!e.test(l.className);)l=l.parentNode;if(l&&(r=(l.className.match(e)||[,""])[1],s=t.languages[r]),s){n.className=n.className.replace(e,"").replace(/\s+/g," ")+" language-"+r,l=n.parentNode,/pre/i.test(l.nodeName)&&(l.className=l.className.replace(e,"").replace(/\s+/g," ")+" language-"+r);var c=n.textContent;if(c){c=c.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ");var d={element:n,language:r,grammar:s,code:c};if(t.hooks.run("before-highlight",d),o&&self.Worker){var u=new Worker(t.filename);u.onmessage=function(e){d.highlightedCode=i.stringify(JSON.parse(e.data),r),t.hooks.run("before-insert",d),d.element.innerHTML=d.highlightedCode,a&&a.call(d.element),t.hooks.run("after-highlight",d)},u.postMessage(JSON.stringify({language:d.language,code:d.code}))}else d.highlightedCode=t.highlight(d.code,d.grammar,d.language),t.hooks.run("before-insert",d),d.element.innerHTML=d.highlightedCode,a&&a.call(n),t.hooks.run("after-highlight",d)}}},highlight:function(e,n,o){return i.stringify(t.tokenize(e,n),o)},tokenize:function(e,i,n){var o=t.Token,a=[e],r=i.rest;if(r){for(var s in r)i[s]=r[s];delete i.rest}e:for(var s in i)if(i.hasOwnProperty(s)&&i[s]){var l=i[s],c=l.inside,d=!!l.lookbehind,u=0;l=l.pattern||l;for(var p=0;p<a.length;p++){var f=a[p];if(a.length>e.length)break e;if(!(f instanceof o)){l.lastIndex=0;var m=l.exec(f);if(m){d&&(u=m[1].length);var h=m.index-1+u,g=h+(m=m[0].slice(u)).length,v=f.slice(0,h+1),y=f.slice(g+1),E=[p,1];v&&E.push(v);var b=new o(s,c?t.tokenize(m,c):m);E.push(b),y&&E.push(y),Array.prototype.splice.apply(a,E)}}}}return a},hooks:{all:{},add:function(e,i){var n=t.hooks.all;n[e]=n[e]||[],n[e].push(i)},run:function(e,i){var n=t.hooks.all[e];if(n&&n.length)for(var o,a=0;o=n[a++];)o(i)}}},i=t.Token=function(e,t){this.type=e,this.content=t};if(i.stringify=function(e,n,o){if("string"==typeof e)return e;if("[object Array]"==Object.prototype.toString.call(e))return e.map(function(t){return i.stringify(t,n,e)}).join("");var a={type:e.type,content:i.stringify(e.content,n,o),tag:"span",classes:["token",e.type],attributes:{},language:n,parent:o};"comment"==a.type&&(a.attributes.spellcheck="true"),t.hooks.run("wrap",a);var r="";for(var s in a.attributes)r+=s+'="'+(a.attributes[s]||"")+'"';return"<"+a.tag+' class="'+a.classes.join(" ")+'" '+r+">"+a.content+"</"+a.tag+">"},self.document){var n=document.getElementsByTagName("script");(n=n[n.length-1])&&(t.filename=n.src,document.addEventListener&&!n.hasAttribute("data-manual")&&document.addEventListener("DOMContentLoaded",t.highlightAll))}else self.addEventListener("message",function(e){var i=JSON.parse(e.data),n=i.language,o=i.code;self.postMessage(JSON.stringify(t.tokenize(o,t.languages[n]))),self.close()},!1)}(),Prism.languages.markup={comment:/&lt;!--[\w\W]*?-->/g,prolog:/&lt;\?.+?\?>/,doctype:/&lt;!DOCTYPE.+?>/,cdata:/&lt;!\[CDATA\[[\w\W]*?]]>/i,tag:{pattern:/&lt;\/?[\w:-]+\s*(?:\s+[\w:-]+(?:=(?:("|')(\\?[\w\W])*?\1|\w+))?\s*)*\/?>/gi,inside:{tag:{pattern:/^&lt;\/?[\w:-]+/i,inside:{punctuation:/^&lt;\/?/,namespace:/^[\w-]+?:/}},"attr-value":{pattern:/=(?:('|")[\w\W]*?(\1)|[^\s>]+)/gi,inside:{punctuation:/=|>|"/g}},punctuation:/\/?>/g,"attr-name":{pattern:/[\w:-]+/g,inside:{namespace:/^[\w-]+?:/}}}},entity:/&amp;#?[\da-z]{1,8};/gi},Prism.hooks.add("wrap",function(e){"entity"===e.type&&(e.attributes.title=e.content.replace(/&amp;/,"&"))}),Prism.languages.css={comment:/\/\*[\w\W]*?\*\//g,atrule:{pattern:/@[\w-]+?.*?(;|(?=\s*{))/gi,inside:{punctuation:/[;:]/g}},url:/url\((["']?).*?\1\)/gi,selector:/[^\{\}\s][^\{\};]*(?=\s*\{)/g,property:/(\b|\B)[\w-]+(?=\s*:)/gi,string:/("|')(\\?.)*?\1/g,important:/\B!important\b/gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[\{\};:]/g},Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{style:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/style(>|&gt;)/gi,inside:{tag:{pattern:/(&lt;|<)style[\w\W]*?(>|&gt;)|(&lt;|<)\/style(>|&gt;)/gi,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.css}}}),Prism.languages.css.selector={pattern:/[^\{\}\s][^\{\}]*(?=\s*\{)/g,inside:{"pseudo-element":/:(?:after|before|first-letter|first-line|selection)|::[-\w]+/g,"pseudo-class":/:[-\w]+(?:\(.*\))?/g,class:/\.[-:\.\w]+/g,id:/#[-:\.\w]+/g}},Prism.languages.insertBefore("css","ignore",{hexcode:/#[\da-f]{3,6}/gi,entity:/\\[\da-f]{1,8}/gi,number:/[\d%\.]+/g,function:/(attr|calc|cross-fade|cycle|element|hsla?|image|lang|linear-gradient|matrix3d|matrix|perspective|radial-gradient|repeating-linear-gradient|repeating-radial-gradient|rgba?|rotatex|rotatey|rotatez|rotate3d|rotate|scalex|scaley|scalez|scale3d|scale|skewx|skewy|skew|steps|translatex|translatey|translatez|translate3d|translate|url|var)/gi}),Prism.languages.clike={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|(^|[^:])\/\/.*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,"class-name":{pattern:/((?:(?:class|interface|extends|implements|trait|instanceof|new)\s+)|(?:catch\s+\())[a-z0-9_\.\\]+/gi,lookbehind:!0,inside:{punctuation:/(\.|\\)/}},keyword:/\b(if|else|while|do|for|return|in|instanceof|function|new|try|throw|catch|finally|null|break|continue)\b/g,boolean:/\b(true|false)\b/g,function:{pattern:/[a-z0-9_]+\(/gi,inside:{punctuation:/\(/}},number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?)\b/g,operator:/[-+]{1,2}|!|&lt;=?|>=?|={1,3}|(&amp;){1,2}|\|?\||\?|\*|\/|\~|\^|\%/g,ignore:/&(lt|gt|amp);/gi,punctuation:/[{}[\];(),.:]/g},Prism.languages.javascript=Prism.languages.extend("clike",{keyword:/\b(var|let|if|else|while|do|for|return|in|instanceof|function|new|with|typeof|try|throw|catch|finally|null|break|continue)\b/g,number:/\b-?(0x[\dA-Fa-f]+|\d*\.?\d+([Ee]-?\d+)?|NaN|-?Infinity)\b/g}),Prism.languages.insertBefore("javascript","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0}}),Prism.languages.markup&&Prism.languages.insertBefore("markup","tag",{script:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)[\w\W]*?(&lt;|<)\/script(>|&gt;)/gi,inside:{tag:{pattern:/(&lt;|<)script[\w\W]*?(>|&gt;)|(&lt;|<)\/script(>|&gt;)/gi,inside:Prism.languages.markup.tag.inside},rest:Prism.languages.javascript}}}),Prism.languages.php=Prism.languages.extend("clike",{keyword:/\b(and|or|xor|array|as|break|case|cfunction|class|const|continue|declare|default|die|do|else|elseif|enddeclare|endfor|endforeach|endif|endswitch|endwhile|extends|for|foreach|function|include|include_once|global|if|new|return|static|switch|use|require|require_once|var|while|abstract|interface|public|implements|extends|private|protected|parent|static|throw|null|echo|print|trait|namespace|use|final|yield|goto|instanceof|finally|try|catch)\b/gi,constant:/\b[A-Z0-9_]{2,}\b/g}),Prism.languages.insertBefore("php","keyword",{delimiter:/(\?>|&lt;\?php|&lt;\?)/gi,variable:/(\$\w+)\b/gi,package:{pattern:/(\\|namespace\s+|use\s+)[\w\\]+/g,lookbehind:!0,inside:{punctuation:/\\/}}}),Prism.languages.insertBefore("php","operator",{property:{pattern:/(->)[\w]+/g,lookbehind:!0}}),Prism.languages.markup&&(Prism.hooks.add("before-highlight",function(e){"php"===e.language&&(e.tokenStack=[],e.code=e.code.replace(/(?:&lt;\?php|&lt;\?|<\?php|<\?)[\w\W]*?(?:\?&gt;|\?>)/gi,function(t){return e.tokenStack.push(t),"{{{PHP"+e.tokenStack.length+"}}}"}))}),Prism.hooks.add("after-highlight",function(e){if("php"===e.language){for(var t,i=0;t=e.tokenStack[i];i++)e.highlightedCode=e.highlightedCode.replace("{{{PHP"+(i+1)+"}}}",Prism.highlight(t,e.grammar,"php"));e.element.innerHTML=e.highlightedCode}}),Prism.hooks.add("wrap",function(e){"php"===e.language&&"markup"===e.type&&(e.content=e.content.replace(/(\{\{\{PHP[0-9]+\}\}\})/g,'<span class="token php">$1</span>'))}),Prism.languages.insertBefore("php","comment",{markup:{pattern:/(&lt;|<)[^?]\/?(.*?)(>|&gt;)/g,inside:Prism.languages.markup},php:/\{\{\{PHP[0-9]+\}\}\}/g})),Prism.languages.insertBefore("php","variable",{this:/\$this/g,global:/\$_?(GLOBALS|SERVER|GET|POST|FILES|REQUEST|SESSION|ENV|COOKIE|HTTP_RAW_POST_DATA|argc|argv|php_errormsg|http_response_header)/g,scope:{pattern:/\b[\w\\]+::/g,inside:{keyword:/(static|self|parent)/,punctuation:/(::|\\)/}}}),Prism.languages.coffeescript=Prism.languages.extend("javascript",{"block-comment":/([#]{3}\s*\r?\n(.*\s*\r*\n*)\s*?\r?\n[#]{3})/g,comment:/(\s|^)([#]{1}[^#^\r^\n]{2,}?(\r?\n|$))/g,keyword:/\b(this|window|delete|class|extends|namespace|extend|ar|let|if|else|while|do|for|each|of|return|in|instanceof|new|with|typeof|try|catch|finally|null|undefined|break|continue)\b/g}),Prism.languages.insertBefore("coffeescript","keyword",{function:{pattern:/[a-z|A-z]+\s*[:|=]\s*(\([.|a-z\s|,|:|{|}|\"|\'|=]*\))?\s*-&gt;/gi,inside:{"function-name":/[_?a-z-|A-Z-]+(\s*[:|=])| @[_?$?a-z-|A-Z-]+(\s*)| /g,operator:/[-+]{1,2}|!|=?&lt;|=?&gt;|={1,2}|(&amp;){1,2}|\|?\||\?|\*|\//g}},"attr-name":/[_?a-z-|A-Z-]+(\s*:)| @[_?$?a-z-|A-Z-]+(\s*)| /g}),Prism.languages.scss=Prism.languages.extend("css",{comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|\/\/.*?(\r?\n|$))/g,lookbehind:!0},atrule:/@[\w-]+(?=\s+(\(|\{|;))/gi,url:/([-a-z]+-)*url(?=\()/gi,selector:/([^@;\{\}\(\)]?([^@;\{\}\(\)]|&amp;|\#\{\$[-_\w]+\})+)(?=\s*\{(\}|\s|[^\}]+(:|\{)[^\}]+))/gm}),Prism.languages.insertBefore("scss","atrule",{keyword:/@(if|else if|else|for|each|while|import|extend|debug|warn|mixin|include|function|return)|(?=@for\s+\$[-_\w]+\s)+from/i}),Prism.languages.insertBefore("scss","property",{variable:/((\$[-_\w]+)|(#\{\$[-_\w]+\}))/i}),Prism.languages.insertBefore("scss","ignore",{placeholder:/%[-_\w]+/i,statement:/\B!(default|optional)\b/gi,boolean:/\b(true|false)\b/g,null:/\b(null)\b/g,operator:/\s+([-+]{1,2}|={1,2}|!=|\|?\||\?|\*|\/|\%)\s+/g}),Prism.languages.bash=Prism.languages.extend("clike",{comment:{pattern:/(^|[^"{\\])(#.*?(\r?\n|$))/g,lookbehind:!0},string:{pattern:/("|')(\\?[\s\S])*?\1/g,inside:{property:/\$([a-zA-Z0-9_#\?\-\*!@]+|\{[^\}]+\})/g}},keyword:/\b(if|then|else|elif|fi|for|break|continue|while|in|case|function|select|do|done|until|echo|exit|return|set|declare)\b/g}),Prism.languages.insertBefore("bash","keyword",{property:/\$([a-zA-Z0-9_#\?\-\*!@]+|\{[^}]+\})/g}),Prism.languages.insertBefore("bash","comment",{important:/(^#!\s*\/bin\/bash)|(^#!\s*\/bin\/sh)/g}),Prism.languages.c=Prism.languages.extend("clike",{keyword:/\b(asm|typeof|inline|auto|break|case|char|const|continue|default|do|double|else|enum|extern|float|for|goto|if|int|long|register|return|short|signed|sizeof|static|struct|switch|typedef|union|unsigned|void|volatile|while)\b/g,operator:/[-+]{1,2}|!=?|&lt;{1,2}=?|&gt;{1,2}=?|\-&gt;|={1,2}|\^|~|%|(&amp;){1,2}|\|?\||\?|\*|\//g}),Prism.languages.insertBefore("c","keyword",{property:/#\s*[a-zA-Z]+/g}),Prism.languages.cpp=Prism.languages.extend("c",{keyword:/\b(alignas|alignof|asm|auto|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|delete\[\]|do|double|dynamic_cast|else|enum|explicit|export|extern|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|new\[\]|noexcept|nullptr|operator|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while)\b/g,operator:/[-+]{1,2}|!=?|&lt;{1,2}=?|&gt;{1,2}=?|\-&gt;|:{1,2}|={1,2}|\^|~|%|(&amp;){1,2}|\|?\||\?|\*|\/|\b(and|and_eq|bitand|bitor|not|not_eq|or|or_eq|xor|xor_eq)\b/g}),Prism.languages.sql={comment:{pattern:/(^|[^\\])(\/\*[\w\W]*?\*\/|((--)|(\/\/)).*?(\r?\n|$))/g,lookbehind:!0},string:/("|')(\\?.)*?\1/g,keyword:/\b(ACTION|ADD|AFTER|ALGORITHM|ALTER|ANALYZE|APPLY|AS|AS|ASC|AUTHORIZATION|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADE|CASCADED|CASE|CHAIN|CHAR VARYING|CHARACTER VARYING|CHECK|CHECKPOINT|CLOSE|CLUSTERED|COALESCE|COLUMN|COLUMNS|COMMENT|COMMIT|COMMITTED|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS|CONTAINSTABLE|CONTINUE|CONVERT|CREATE|CROSS|CURRENT|CURRENT_DATE|CURRENT_TIME|CURRENT_TIMESTAMP|CURRENT_USER|CURSOR|DATA|DATABASE|DATABASES|DATETIME|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DOUBLE PRECISION|DROP|DUMMY|DUMP|DUMPFILE|DUPLICATE KEY|ELSE|ENABLE|ENCLOSED BY|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPE|ESCAPED BY|EXCEPT|EXEC|EXECUTE|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR|FOR EACH ROW|FORCE|FOREIGN|FREETEXT|FREETEXTTABLE|FROM|FULL|FUNCTION|GEOMETRY|GEOMETRYCOLLECTION|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|IDENTITY|IDENTITY_INSERT|IDENTITYCOL|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTO|INVOKER|ISOLATION LEVEL|JOIN|KEY|KEYS|KILL|LANGUAGE SQL|LAST|LEFT|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONGBLOB|LONGTEXT|MATCH|MATCHED|MEDIUMBLOB|MEDIUMINT|MEDIUMTEXT|MERGE|MIDDLEINT|MODIFIES SQL DATA|MODIFY|MULTILINESTRING|MULTIPOINT|MULTIPOLYGON|NATIONAL|NATIONAL CHAR VARYING|NATIONAL CHARACTER|NATIONAL CHARACTER VARYING|NATIONAL VARCHAR|NATURAL|NCHAR|NCHAR VARCHAR|NEXT|NO|NO SQL|NOCHECK|NOCYCLE|NONCLUSTERED|NULLIF|NUMERIC|OF|OFF|OFFSETS|ON|OPEN|OPENDATASOURCE|OPENQUERY|OPENROWSET|OPTIMIZE|OPTION|OPTIONALLY|ORDER|OUT|OUTER|OUTFILE|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREV|PRIMARY|PRINT|PRIVILEGES|PROC|PROCEDURE|PUBLIC|PURGE|QUICK|RAISERROR|READ|READS SQL DATA|READTEXT|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEATABLE|REPLICATION|REQUIRE|RESTORE|RESTRICT|RETURN|RETURNS|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROWCOUNT|ROWGUIDCOL|ROWS?|RTREE|RULE|SAVE|SAVEPOINT|SCHEMA|SELECT|SERIAL|SERIALIZABLE|SESSION|SESSION_USER|SET|SETUSER|SHARE MODE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|START|STARTING BY|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLE|TABLES|TABLESPACE|TEMPORARY|TEMPTABLE|TERMINATED BY|TEXT|TEXTSIZE|THEN|TIMESTAMP|TINYBLOB|TINYINT|TINYTEXT|TO|TOP|TRAN|TRANSACTION|TRANSACTIONS|TRIGGER|TRUNCATE|TSEQUAL|TYPE|TYPES|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNPIVOT|UPDATE|UPDATETEXT|USAGE|USE|USER|USING|VALUE|VALUES|VARBINARY|VARCHAR|VARCHARACTER|VARYING|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH|WITH ROLLUP|WITHIN|WORK|WRITE|WRITETEXT)\b/gi,boolean:/\b(TRUE|FALSE|NULL)\b/gi,number:/\b-?(0x)?\d*\.?[\da-f]+\b/g,operator:/\b(ALL|AND|ANY|BETWEEN|EXISTS|IN|LIKE|NOT|OR|IS|UNIQUE|CHARACTER SET|COLLATE|DIV|OFFSET|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b|[-+]{1}|!|=?&lt;|=?&gt;|={1}|(&amp;){1,2}|\|?\||\?|\*|\//gi,ignore:/&(lt|gt|amp);/gi,punctuation:/[;[\]()`,.]/g},Prism.languages.http={"request-line":{pattern:/^(POST|GET|PUT|DELETE|OPTIONS|PATCH|TRACE|CONNECT)\b\shttps?:\/\/\S+\sHTTP\/[0-9.]+/g,inside:{property:/^\b(POST|GET|PUT|DELETE|OPTIONS|PATCH|TRACE|CONNECT)\b/g,"attr-name":/:\w+/g}},"response-status":{pattern:/^HTTP\/1.[01] [0-9]+.*/g,inside:{property:/[0-9]+[A-Z\s-]+$/g}},keyword:/^[\w-]+:(?=.+)/gm};var i={"application/json":Prism.languages.javascript,"application/xml":Prism.languages.markup,"text/xml":Prism.languages.markup,"text/html":Prism.languages.markup};for(var n in i)if(i[n]){var o={};o[n]={pattern:new RegExp("(content-type:\\s*"+n+"[\\w\\W]*?)\\n\\n[\\w\\W]*","gi"),lookbehind:!0,inside:{rest:i[n]}},Prism.languages.insertBefore("http","keyword",o)}Prism.languages.ruby=Prism.languages.extend("clike",{comment:/#[^\r\n]*(\r?\n|$)/g,keyword:/\b(alias|and|BEGIN|begin|break|case|class|def|define_method|defined|do|each|else|elsif|END|end|ensure|false|for|if|in|module|new|next|nil|not|or|raise|redo|require|rescue|retry|return|self|super|then|throw|true|undef|unless|until|when|while|yield)\b/g,builtin:/\b(Array|Bignum|Binding|Class|Continuation|Dir|Exception|FalseClass|File|Stat|File|Fixnum|Fload|Hash|Integer|IO|MatchData|Method|Module|NilClass|Numeric|Object|Proc|Range|Regexp|String|Struct|TMS|Symbol|ThreadGroup|Thread|Time|TrueClass)\b/,constant:/\b[A-Z][a-zA-Z_0-9]*[?!]?\b/g}),Prism.languages.insertBefore("ruby","keyword",{regex:{pattern:/(^|[^/])\/(?!\/)(\[.+?]|\\.|[^/\r\n])+\/[gim]{0,3}(?=\s*($|[\r\n,.;})]))/g,lookbehind:!0},variable:/[@$&]+\b[a-zA-Z_][a-zA-Z_0-9]*[?!]?\b/g,symbol:/:\b[a-zA-Z_][a-zA-Z_0-9]*[?!]?\b/g}),Prism.languages.csharp=Prism.languages.extend("clike",{keyword:/\b(abstract|as|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|virtual|void|volatile|while|add|alias|ascending|async|await|descending|dynamic|from|get|global|group|into|join|let|orderby|partial|remove|select|set|value|var|where|yield)\b/g,string:/@?("|')(\\?.)*?\1/g,preprocessor:/^\s*#.*/gm,number:/\b-?(0x)?\d*\.?\d+\b/g}),Prism.highlightAll(),t.resolve()}),EasySocial.module("privacy",function(e){var t=this;EasySocial.require().library("dialog").view("admin/profiles/form.privacy.custom.item").done(function(e){EasySocial.Controller("Profiles.Form.Privacy",{defaultOptions:{path:"admin","{selection}":".privacySelection","{browseButton}":".browseButton","{userDeleteButton}":".userDeleteButton","{customContainer}":".customContainer",view:{customItem:"admin/profiles/form.privacy.custom.item"}}},function(t){return{init:function(){},"{selection} change":function(i,n){var o=e(i).val();e(i).attr("name");"custom"==o?t.customContainer().show():t.customContainer().hide()},"{userDeleteButton} click":function(t,i){e(t).parents("li").remove()},"{browseButton} click":function(i,n){var o=e(i).attr("id"),a=e(i).data("index"),r=e.rootPath+"administrator/index.php?option=com_easysocial&view=users&layout=listing&show=iframe";"site"==t.options.path&&(r=e.rootPath+"index.php?option=com_easysocial&view=friends&layout=listing&show=iframe"),e.dialog({title:"Browse Users & Groups",content:r,body:{css:{width:400,height:300}},buttons:[{name:"Assign",click:function(){var i=e(".foundryDialog").find("iframe").contents().find("input:checked");if(i.length>0)for(var n=0;n<i.length;n++)if("toggle"!=e(i[n]).attr("name")){var r=e(i[n]).val(),s=e(".foundryDialog").find("iframe").contents().find('input[name="user_'+r+'"]').val(),l=e("ul#privacy_ul"+a+" input:hidden"),c=!0;if(l.length>0)for(var d=0;d<l.length;d++)if(e(l[d]).val()==r){c=!1;break}c&&(html=t.view.customItem({userName:s,eleName:o,userId:r}),e("ul#privacy_ul"+a).append(html))}e.dialog().close()}},{name:"Close",click:function(){e.dialog().close()}}]})}}}),t.resolve()})}),EasySocial.module("sharing",function(e){var t=this;EasySocial.require().library("textboxlist").done(function(){EasySocial.Controller("Sharing",{defaultOptions:{"{vendors}":"[data-sharing-vendor]","{emailForm}":"[data-sharing-email]"}},function(t){return{init:function(){t.initLinks(),t.initEmail()},initLinks:function(){e.each(t.vendors(),function(t,i){if(!(i=e(i)).data("loaded")){var n=i.attr("href");i.data("href",n),i.attr("href","javascript:void(0);"),i.attr("loaded",!0)}})},initEmail:function(){e.each(t.emailForm(),function(i,n){(n=e(n)).data("loaded")||(t.addPlugin("email"),n.attr("loaded",!0))})},"{vendors} click":function(e,t){var i=e.data("options")||"";window.open(e.data("href"),"",i)}}}),e.template("sharing/recipientContent",'[%= title %]<input type="hidden" name="items" value="[%= title %]" />'),EasySocial.Controller("Sharing.Email",{defaultOptions:{token:"","{container}":"[data-sharing-email]","{frames}":"[data-sharing-email-frame]","{recipients}":"[data-sharing-email-recipients]","{input}":"[data-sharing-email-input]","{content}":"[data-sharing-email-content]","{send}":"[data-sharing-email-send]","{frames}":"[data-sharing-email-frame]","{frameForm}":"[data-sharing-email-form]","{frameSending}":"[data-sharing-email-sending]","{frameDone}":"[data-sharing-email-done]","{frameFail}":"[data-sharing-email-fail]","{failMsg}":"[data-sharing-email-fail-msg]"}},function(t){return{init:function(){t.options.token=t.container().data("token");t.recipients().textboxlist({component:"es",view:{itemContent:"sharing/recipientContent"}});t.originalPosition=t.container().css("position")},getRecipients:function(){var i=t.recipients().controller("textboxlist").getAddedItems(),n=[];e.each(i,function(e,t){n.push(t.title)});var o=t.input().val();return n.length<1&&!e.isEmpty(o)&&n.push(o),n},getContent:function(){return t.content().val()},"{send} click":function(e,i){if(e.enabled()){e.disabled(!0),t.frames().hide(),t.frameSending().show();var n=t.options.token,o=t.getRecipients(),a=t.getContent();t.submitForm(n,o,a).done(function(){t.frames().hide(),t.frameDone().show(),setTimeout(function(){t.recipients().controller("textboxlist").clearItems(),t.content().val(""),t.frameDone().hide(),t.frameForm().show()},1e3)}).fail(function(e){t.frames().hide(),t.frameFail().show(),t.frameForm().show(),void 0!==e&&t.failMsg().html(e)}).always(function(){e.enabled(!0)})}},"{input} keypress":function(e,i){if(44===i.which)return t.recipients().controller("textboxlist").addItem(e.val()),e.val(""),!1},submitForm:function(e,t,i){return EasySocial.ajax("site/controllers/sharing/send",{token:e,recipients:t,content:i})}}}),t.resolve()})}),EasySocial.module("site/activities/activities",function(e){var t=this;EasySocial.require().script("site/activities/sidebar","site/activities/sidebar.item").view("site/loading/small").done(function(e){EasySocial.Controller("Activities",{defaultOptions:{items:null,"{container}":"[data-activities]","{contentTitle}":"[data-activities-content-title]","{content}":"[data-activities-content]","{sidebar}":"[data-activities-sidebar]","{sidebarItem}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(e){return{init:function(){e.sidebar().implement(EasySocial.Controller.Activities.Sidebar,{"{parent}":e}),e.sidebarItem().implement(EasySocial.Controller.Activities.Sidebar.Item,{"{parent}":e})},updatingContents:function(){e.content().html(e.view.loadingContent())},updateContent:function(t,i){e.content().html(t),e.contentTitle().html(i)}}}),t.resolve()})}),EasySocial.module("site/activities/sidebar",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Activities.Sidebar",{defaultOptions:{"{menuItem}":"[data-sidebar-menu]"}},function(t){return{init:function(){},"{menuItem} click":function(i,n){t.menuItem().removeClass("active"),e(i).addClass("active")}}}),t.resolve()})}),EasySocial.module("site/activities/sidebar.item",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Activities.Sidebar.Item",{defaultOptions:{}},function(e){return{init:function(){},"{self} click":function(t,i){var n=e.element.data("type"),o=e.element.data("url"),a=e.element.data("title");e.element.data("description");History.pushState({state:1},a,o),e.parent.updatingContents(),EasySocial.ajax("site/controllers/activities/getActivities",{type:n}).done(function(t){e.parent.updateContent(t,a)}).fail(function(e){console.log(e)}),e.parent.updateContent()}}}),t.resolve()})}),EasySocial.module("site/activities/apps",function(e){var t=this;EasySocial.require().view("site/loading/small").language("COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY","COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY").done(function(e){EasySocial.Controller("Activities.Apps.List",{defaultOptions:{"{item}":"[data-hidden-app-item]","{actorItem}":"[data-hidden-actor-item]",view:{loadingContent:"site/loading/small"}}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Activities.Apps.Item),e.actorItem().implement(EasySocial.Controller.Activities.Actors.Item)}}}),EasySocial.Controller("Activities.Actors.Item",{defaultOptions:{id:"",actor:"","{unhideLink}":"[data-hidden-actor-unhide]","{content}":"[data-hidden-actor-content]",view:{loadingContent:"site/loading/small"}}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.actor=t.element.data("actor")},"{unhideLink} click":function(){EasySocial.ajax("site/controllers/activities/unhideactor",{actor:t.options.actor,id:t.options.id}).done(function(){t.content().html(e.language("COM_EASYSOCIAL_ACTIVITY_USERS_UNHIDE_SUCCESSFULLY"))}).fail(function(e){console.log(e)})}}}),EasySocial.Controller("Activities.Apps.Item",{defaultOptions:{id:"",context:"","{unhideLink}":"[data-hidden-app-unhide]","{content}":"[data-hidden-app-content]",view:{loadingContent:"site/loading/small"}}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.context=t.element.data("context")},"{unhideLink} click":function(){EasySocial.ajax("site/controllers/activities/unhideapp",{context:t.options.context,id:t.options.id}).done(function(){t.content().html(e.language("COM_EASYSOCIAL_ACTIVITY_APPS_UNHIDE_SUCCESSFULLY"))}).fail(function(e){console.log(e)})}}}),t.resolve()})}),EasySocial.module("site/activities/item",function(e){var t=this;EasySocial.require().script().done(function(e){EasySocial.Controller("Activities.Item",{defaultOptions:{"{toggle}":"[data-activity-toggle]","{deleteBtn}":"[data-activity-delete]"}},function(t){return{init:function(){},"{toggle} click":function(i,n){EasySocial.ajax("site/controllers/activities/toggle",{id:t.element.data("id"),curState:t.element.data("current-state")}).done(function(n,o){e(i).text(n),t.element.data("current-state",o),o?t.element.children("div.es-stream").addClass("isHidden"):t.element.children("div.es-stream").removeClass("isHidden")}).fail(function(e){console.log(e)})},"{deleteBtn} click":function(){var e=t.element.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/activities/confirmDelete"),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/activities/delete",{id:e}).done(function(e){t.element.fadeOut(),EasySocial.dialog().close()})}}})}}}),t.resolve()})}),EasySocial.module("site/activities/list",function(e){var t=this;EasySocial.require().view("site/loading/small","site/activities/loadbutton").language("COM_EASYSOCIAL_ACTIVITY_LOG_LOAD_PREVIOUS_STREAM_ITEMS").script("site/activities/item").done(function(e){EasySocial.Controller("Activities.List",{defaultOptions:{"{item}":"[data-activity-item]","{pagination}":"[data-activity-pagination]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/activities/loadbutton"}}},function(t){return{init:function(){t.item().implement(EasySocial.Controller.Activities.Item),t.on("scroll.activities",window,e._.debounce(function(){t.loading||t.pagination().visible()&&t.loadMore()},250))},"{pagination} click":function(){t.loadMore()},loadMore:function(){var i=e("[data-sidebar-menu].active").data("type"),n=t.pagination().data("startlimit");""!=n&&(t.loading=!0,t.pagination().html(t.view.loadingContent({content:""})),EasySocial.ajax("site/controllers/activities/getActivities",{limitstart:n,loadmore:"1",type:i}).done(function(e,i){t.pagination().data("startlimit",i),t.pagination().before(e),t.item().implement(EasySocial.Controller.Activities.Item),""==i?t.pagination().html(""):t.pagination().html(t.view.loadmoreContent())}).fail(function(e){return e}).always(function(){t.loading=!1}))}}}),t.resolve()})}),EasySocial.module("site/albums/all",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Albums.All.Browser",{defaultOptions:{"{sort}":"[data-albums-sort]","{contents}":"[data-albums-content]"}},function(t){return{init:function(){},setActiveSort:function(i){t.sort().removeClass("active"),e(i).addClass("active")},"{sort} click":function(i,n){n.preventDefault(),t.setActiveSort(i),e(i).route(),t.contents().addClass("is-loading"),t.contents().html("&nbsp;"),EasySocial.ajax("site/controllers/albums/getAlbums").done(function(e){t.contents().html(e)})}}}),t.resolve()})}),EasySocial.module("site/apps/apps",function(e){var t=this;EasySocial.require().library("history").view("site/loading/small").done(function(e){EasySocial.Controller("Apps",{defaultOptions:{requireTerms:!0,"{content}":"[data-apps-listing]","{sort}":"[data-apps-sort]","{filter}":"[data-apps-filter]","{filterLink}":"[data-apps-filter-link]","{item}":"[data-apps-item]","{sorting}":"[data-apps-sorting]","{title}":"[data-page-apps-title]",view:{loading:"site/loading/small"}}},function(t){return{init:function(){t.initAppItem()},initAppItem:function(){t.item().implement(EasySocial.Controller.Apps.Item,{requireTerms:t.options.requireTerms})},"{filterLink} click":function(e,t){t.preventDefault()},"{filter} click":function(i,n){t.sort().removeClass("active"),t.filter().removeClass("active"),i.addClass("active"),i.find("a").route();var o=i.data("apps-filter-type"),a=i.data("apps-filter-group"),r=i.find("a").attr("title");t.title().html(r),t.options.filter=o,"mine"==o?t.sorting().hide():t.sorting().show(),EasySocial.ajax("site/controllers/apps/getApps",{filter:o,group:a},{beforeSend:function(){t.sort(".alphabetical").addClass("active"),t.content().html(t.view.loading())}}).done(function(i){t.content().toggleClass("is-empty",e(i).hasClass("empty")),t.content().html(i),t.initAppItem()})},"{sort} click":function(e,i){var n=e.data("apps-sort-type"),o=e.data("apps-sort-url"),a=e.data("apps-sort-group");History.pushState({state:1},"",o),t.sort().removeClass("active"),e.addClass("active"),EasySocial.ajax("site/controllers/apps/getApps",{sort:n,filter:t.options.filter,group:a},{beforeSend:function(){t.content().html(t.view.loading())}}).done(function(e){t.content().html(e),t.initAppItem()})}}}),EasySocial.Controller("Apps.Item",{defaultOptions:{id:null,requireTerms:!0,"{install}":"[data-apps-item-install]","{installed}":"[data-apps-item-installed]","{settings}":"[data-apps-item-settings]",view:{installAppForm:"site/apps/dialog.install",uninstallAppForm:"site/apps/dialog.uninstall"}}},function(e){return{init:function(){e.element.data("id")&&(e.options.id=e.element.data("id"))},"{install} click":function(t){EasySocial.dialog({content:EasySocial.ajax("site/views/apps/getTnc"),bindings:{"{cancelButton} click":function(){EasySocial.dialog().close()},"{installButton} click":function(t){!e.options.requireTerms||this.agreeCheckbox().is(":checked")?(this.termsError().hide(),e.installApp()):this.termsError().show()}}})},installApp:function(){var t=EasySocial.ajax("site/controllers/apps/installApp",{id:e.options.id});EasySocial.dialog({content:t,bindings:{"{closeButton} click":function(){EasySocial.dialog().close()}}}),t.done(function(){e.install().enabled(!0),e.install().hide(),e.installed().show(),e.settings().hide()})},"{settings} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("site/views/apps/settings",{id:e.options.id}),bindings:{}})},"{installed} click":function(t){t.enabled()&&(t.disabled(!0),EasySocial.dialog({content:EasySocial.ajax("site/views/apps/confirmUninstall"),bindings:{"{parent.closeButton} click":function(){e.installed().enabled(!0)},"{cancelButton} click":function(){e.installed().enabled(!0),EasySocial.dialog().close()},"{uninstallButton} click":function(){e.uninstallApp()}}}))},uninstallApp:function(){var t=EasySocial.ajax("site/controllers/apps/uninstallApp",{id:e.options.id});EasySocial.dialog({content:t,bindings:{"{closeButton} click":function(){EasySocial.dialog().close()}}}),t.done(function(){e.installed().enabled(!0),e.installed().hide(),e.settings().hide(),e.install().show()})}}}),t.resolve()})}),EasySocial.module("site/badges/badge",function(e){var t=this;EasySocial.Controller("Badges.Badge",{defaultOptions:{id:0,total:0,"{achieversList}":"[data-badge-achievers-list]","{achiever}":"[data-badge-achievers-achiever]","{loadIndicator}":"[data-badge-achievers-loading]","{loadButton}":"[data-badge-achievers-load]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.total=e.element.data("total-achievers")},"{loadButton} click":function(t){var i=e.achiever().length;t.enabled()&&i<e.options.total&&(t.disabled(!0),t.hide(),e.loadIndicator().show(),EasySocial.ajax("site/controllers/badges/loadAchievers",{id:e.options.id,start:i}).done(function(i){e.achieversList().append(i),t.enabled(!0),e.loadIndicator().hide(),e.achiever().length<e.options.total&&t.show()}).fail(function(e){}))},loadAchievers:function(){}}}),t.resolve()}),EasySocial.module("site/comments/control",function(e){var t=this;EasySocial.Controller("CommentsControl",{defaultOptions:{interval:30}},function(t){return{init:function(){t.startUpdate()},$Blocks:{},startUpdate:function(){t.options.monitoring=!0,t.updateBlocks()},stopUpdate:function(){t.options.monitoring=!1},updateBlocks:function(){(t.updateBlocks=e._.debounce(function(){var i=t.populate();if(!t.options.monitoring)return!1;EasySocial.ajax("site/controllers/comments/getUpdates",{data:i}).done(function(i){e.each(i,function(i,n){e.each(n,function(e,n){var o=t.$Blocks[i][e];o._destroyed||o.updateComment(n)})})}).always(function(){t.updateBlocks()})},1e3*t.options.interval))()},register:function(e){var i=e.options.group,n=e.options.element,o=e.options.streamid,a=e.options.uid,r=e.options.verb;""==o&&(o="0");var s=n+"."+i+"."+r;void 0===t.$Blocks[s]&&(t.$Blocks[s]={});var l=o+"."+a;t.$Blocks[s][l]=e,e.trigger("commentBlockRegistered")},populate:function(){var i={};return e.each(t.$Blocks,function(t,n){i[t]={},e.each(n,function(e,n){i[t][e]=n._export()})}),i}}}),EasySocial.ready(function(){EasySocial.Comments=e("body").addController("EasySocial.Controller.CommentsControl"),t.resolve()})}),EasySocial.module("site/comments/frame",function(e){var t=this;EasySocial.require().library("mentions").script("site/comments/item").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language("COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL","COM_EASYSOCIAL_COMMENTS_STATUS_SAVING","COM_EASYSOCIAL_COMMENTS_STATUS_SAVED").done(function(){EasySocial.Controller("Comments",{defaultOptions:{group:"user",element:"stream",verb:"null",uid:0,enterkey:"submit",url:"",streamid:"","{actionContent}":"[data-action-contents-comments]","{actionLink}":"[data-stream-action-comments]","{stat}":"[data-comments-stat]","{load}":"[data-comments-load]","{list}":"[data-comments-list]","{item}":"[data-comments-item]","{form}":"[data-comments-form]"}},function(t){return{init:function(){t.options.uid=t.element.data("uid")||t.options.uid,t.options.element=t.element.data("element")||t.options.element,t.options.group=t.element.data("group")||t.options.group,t.options.verb=t.element.data("verb")||t.options.verb,t.options.url=t.element.data("url")||t.options.url,t.options.streamid=t.element.data("streamid")||t.options.streamid,t.$Stat=t.addPlugin("stat"),t.$Load=t.addPlugin("load"),t.$List=t.addPlugin("list"),t.$Form=t.addPlugin("form"),EasySocial.require().script("site/comments/control").done(function(){EasySocial.Comments.register(t)}),t.trigger("commentInit",[t])},$Comments:{},registerComment:function(e){var i=e.options.id;t.$Comments[i]=e},"{actionLink} click":function(){t.actionContent().toggle()},_export:function(){return{total:t.$Stat.total(),count:t.$Stat.count(),ids:e._.keys(t.$Comments)}},updateComment:function(i){var n=[];e.each(i.ids,function(i,o){if(!0!==o)if(!1===o)t.trigger("commentDeleted",[i]);else{var a=!1;e.each(t.$Comments,function(e,n){if(e>i)return t.$List.addToList(o,e,!1),a=!0,!1}),a||t.$List.addToList(o,"append",!1),n.push(o)}}),t.$Stat.total(i.total),t.trigger("oldCommentsLoaded",[n])},"{self} show":function(){t.element.show(),t.$Form.input().focus()}}}),EasySocial.Controller("Comments.List",{defaultOptions:{"{list}":"[data-comments-list]","{item}":"[data-comments-item]"}},function(t){return{init:function(){t.initItemController(t.item(),!1)},initItemController:function(e,i){return e.addController("EasySocial.Controller.Comments.Item",{controller:{parent:t.parent},isNew:i}),e},"{parent} newCommentSaved":function(e,i,n){t.addToList(n)},addToList:function(i,n,o){if(n=void 0===n?"append":n,o=void 0===o||o,i=e(i),t.initItemController(i,o),"append"==n||"prepend"==n){var a="append"==n?":last":":first",r="append"==n?"after":"before";0===t.item().length?t.list().html(i):t.item(a)[r](i)}else{var s=t.parent.$Comments[n];void 0!==s&&s.element.before(i)}t.parent.actionContent().show()},"{parent} commentDeleted":function(e,i,n){void 0!==t.parent.$Comments[n]&&(t.parent.$Comments[n].element.remove(),delete t.parent.$Comments[n])}}}),EasySocial.Controller("Comments.Stat",{defaultOptions:{"{stats}":"[data-comments-stats]",count:0,total:0,limit:10}},function(t){return{init:function(){t.options.count=t.element.data("count"),t.options.total=t.element.data("total")},total:function(i){return void 0!==i&&(t.options.total=parseInt(i),t.stats().text(e.language("COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL",t.count(),t.total()))),t.options.total},count:function(i){return void 0!==i&&(t.options.count=parseInt(i),t.stats().text(e.language("COM_EASYSOCIAL_COMMENTS_LOADED_OF_TOTAL",t.count(),t.total()))),t.options.count},getNextCycle:function(){var e=Math.max(t.total()-t.count()-t.options.limit,0);return{start:e,limit:t.total()-t.count()-e}},"{parent} oldCommentsLoaded":function(e,i,n){var o=n.length;t.count(t.count()+o)},"{parent} newCommentSaved":function(){t.total(t.total()+1),t.count(t.count()+1)},"{parent} commentDeleted":function(){t.total(t.total()-1),t.count(t.count()-1)}}}),EasySocial.Controller("Comments.Load",{defaultOptions:{"{load}":"[data-comments-load]","{loadMore}":"[data-comments-load-loadMore]"}},function(t){return{init:function(){},"{loadMore} click":function(i,n){if(i.enabled()){i.disabled(!0);var o=t.parent.$Stat.getNextCycle();if(0==o.limit)return!1;t.loadComments(o.start,o.limit).done(function(n){var a=n.slice().reverse();e.each(a,function(e,i){t.parent.$List.addToList(i,"prepend",!1)}),t.parent.trigger("oldCommentsLoaded",[n]),i.enabled(!0),0==o.start&&t.load().hide()}).fail(function(e){t.parent.trigger("oldCommentsLoadError",[e])})}},loadComments:function(e,i){return i=i||10,EasySocial.ajax("site/controllers/comments/load",{uid:t.parent.options.uid,element:t.parent.options.element,group:t.parent.options.group,verb:t.parent.options.verb,start:e,length:i})}}}),EasySocial.Controller("Comments.Form",{defaultOptions:{"{editorHeader}":"[data-comment-form-header]","{editorArea}":"[data-comment-form-editor-area]","{input}":"[data-comments-form-input]","{submit}":"[data-comments-form-submit]","{status}":"[data-comments-form-status]",view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(t){return{init:function(){t.setMentionsLayout()},"{input} keypress":function(e,i){13==i.keyCode&&("submit"!==t.parent.options.enterkey||i.shiftKey||i.altKey||i.ctrlKey||i.metaKey||t.submitComment(),"newline"===t.parent.options.enterkey&&(i.shiftKey||i.altKey||i.ctrlKey||i.metaKey)&&t.submitComment())},"{submit} click":function(e,i){e.enabled()&&t.submitComment()},setMentionsLayout:function(){e.Deferred();var i=t.editorArea(),n=i.controller("mentions");if(n)n.cloneLayout();else{var o=t.editorHeader();i.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:e.View("easysocial/site/friends/suggest.hint.search"),emptyHint:e.View("easysocial/site/friends/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title=e.screenName,e.type="user",e.menuHtml=t.view.suggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n},use:function(e){return e.type+":"+e.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:e.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:e.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title="#"+e.title,e.type="hashtag",e.menuHtml=t.view.tagSuggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:"left top",at:"left bottom",of:o,collision:"none"},size:{width:function(){return o.width()}}}}})}},submitComment:function(){var i=t.input().val();if(""==e.trim(i))return!1;t.parent.trigger("newCommentSaving"),t.save().done(function(e){t.parent.trigger("newCommentSaved",[e]),t.submit().enabled(!0);var i=t.editorArea().controller("mentions");i&&i.reset(),""!=t.parent.options.streamid&&t.updateStreamExcludeIds(t.parent.options.streamid)}).fail(function(e){t.parent.trigger("newCommentSaveError",[e.message])})},save:function(){var i=t.editorArea().controller("mentions"),n={url:t.parent.options.url,mentions:i?i.toArray():[]};return n.mentions=e.map(n.mentions,function(t){return"hashtag"===t.type&&e.isPlainObject(t.value)&&(t.value=t.value.title.slice(1)),JSON.stringify(t)}),EasySocial.ajax("site/controllers/comments/save",{uid:t.parent.options.uid,element:t.parent.options.element,group:t.parent.options.group,verb:t.parent.options.verb,streamid:t.parent.options.streamid,input:t.input().val(),data:n})},updateStreamExcludeIds:function(t){ids=e("[data-streams-wrapper]").data("excludeids"),newIds="",""!=ids&&void 0!=ids?newIds=ids+","+t:newIds=t,e("[data-streams-wrapper]").data("excludeids",newIds)},disableForm:function(){t.input().attr("disabled",!0),t.submit().disabled(!0)},enableForm:function(){t.input().removeAttr("disabled"),t.submit().enabled(!0)},"{parent} newCommentSaving":function(){t.status().show(),t.status().removeClass("label-important label-success label-info"),t.status().addClass("label-info"),t.status().text(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVING")),t.disableForm()},"{parent} newCommentSaved":function(){t.status().show(),t.status().text(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVED")),t.status().removeClass("label-important label-success label-info"),t.status().addClass("label-success"),setTimeout(function(){t.status().fadeOut("fast")},2e3),t.enableForm(),t.input().val("")},"{parent} newCommentSaveError":function(e,i,n){t.status().show(),t.status().removeClass("label-important label-success label-info"),t.status().addClass("label-important"),t.status().text(n),t.enableForm()}}}),t.resolve()})}),EasySocial.module("site/comments/item",function(e){var t=this;EasySocial.require().library("mentions").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_LOADING","COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR","COM_EASYSOCIAL_COMMENTS_STATUS_DELETING","COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR","COM_EASYSOCIAL_LIKES_LIKE","COM_EASYSOCIAL_LIKES_UNLIKE").done(function(){EasySocial.Controller("Comments.Item",{defaultOptions:{id:0,child:0,loadedChild:0,limit:10,isNew:!1,"{frame}":"[data-comments-item-frame]","{avatar}":"[data-comments-item-avatar]","{commentFrame}":"[data-comments-item-commentFrame]","{author}":"[data-comments-item-author]","{action}":"[data-comments-item-actions]","{edit}":"[data-comments-item-actions-edit]","{delete}":"[data-comments-item-actions-delete]","{spam}":"[data-comments-item-actions-spam]","{comment}":"[data-comments-item-comment]","{meta}":"[data-comments-item-meta]","{date}":"[data-comments-item-date] a","{like}":"[data-comments-item-like]","{likeCount}":"[data-comments-item-likeCount]","{editFrame}":"[data-comments-item-editFrame]","{editInput}":"[data-comments-item-edit-input]","{editCancel}":"[data-comments-item-edit-cancel]","{editSubmit}":"[data-comments-item-edit-submit]","{editStatus}":"[data-comments-item-edit-status]","{statusFrame}":"[data-comments-item-statusFrame]","{loadReplies}":"[data-comments-item-loadReplies]","{readMore}":"[data-es-comment-readmore]","{fullContent}":"[data-es-comment-full]",view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"}}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.child=t.element.data("child"),t.parent.registerComment(t),t.status=t.element.addController("EasySocial.Controller.Comments.Item.Status",{controller:{parent:t.parent,item:t}})},"{like} click":function(i){i.enabled()&&(i.disabled(!0),t.likeComment().done(function(n,o,a){i.enabled(!0),t.likeCount().text(o),a=e("<div></div>").html(a).text(),t.likeCount().attr("data-original-title",a),t.like().find("a").text(e.language(n?"COM_EASYSOCIAL_LIKES_UNLIKE":"COM_EASYSOCIAL_LIKES_LIKE"))}).fail(function(){}))},likeComment:function(){return EasySocial.ajax("site/controllers/comments/like",{id:t.options.id})},"{likeCount} click":function(){EasySocial.dialog({content:t.getLikedUsers()})},getLikedUsers:function(){return EasySocial.ajax("site/controllers/comments/likedUsers",{id:t.options.id})},"{edit} click":function(e){if(e.enabled()){var i=t.editFrame(),n=i.controller("mentions");i.html(""),n&&n.destroy(),e.disabled(!0),t.trigger("commentEditLoading",[t.options.id]),t.getEditComment().done(function(e){t.trigger("commentEditLoaded",[t.options.id,e]),t.editFrame().html(e).show(),t.setMentionsLayout()}).fail(function(e){t.trigger("commentEditLoadError",[t.options.id,e])})}},setMentionsLayout:function(){var i=t.editFrame(),n=i.controller("mentions");if(n)n.cloneLayout();else{var o=t.editFrame();i.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:e.View("easysocial/site/friends/suggest.hint.search"),emptyHint:e.View("easysocial/site/friends/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title=e.screenName,e.type="user",e.menuHtml=t.view.suggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n},use:function(e){return e.type+":"+e.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!1,searchHint:e.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:e.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title="#"+e.title,e.type="hashtag",e.menuHtml=t.view.tagSuggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n}}}},plugin:{autocomplete:{id:"fd",component:"es",position:{my:"left top",at:"left bottom",of:o,collision:"none"},size:{width:function(){return o.width()}}}}})}},getRawComment:function(){return EasySocial.ajax("site/controllers/comments/getRawComment",{id:t.options.id})},getEditComment:function(){return EasySocial.ajax("site/controllers/comments/getEditComment",{id:t.options.id})},"{editCancel} click":function(){t.trigger("commentEditCancel",[t.options.id]),t.edit().enabled(!0)},"{editSubmit} click":function(){t.submitEdit()},submitEdit:function(){var e=t.editInput().val();if(""==e)return!1;t.trigger("commentEditSaving",[t.options.id,e]),t.saveEdit().done(function(e){t.trigger("commentEditSaved",[t.options.id,e]),t.comment().html(e),t.edit().enabled(!0)}).fail(function(e){t.trigger("commentEditSaveError",[t.options.id,e])})},saveEdit:function(){var e=t.editFrame().mentions("controller");return EasySocial.ajax("site/controllers/comments/update",{id:t.options.id,input:t.editInput().val(),mentions:e?e.toArray():[]})},"{delete} click":function(e){t.frame().hide(),t.commentFrame().show(),EasySocial.dialog({content:EasySocial.ajax("site/views/comments/confirmDelete",{id:t.options.id}),selectors:{"{deleteButton}":"[data-delete-button]","{cancelButton}":"[data-cancel-button]"},bindings:{"{deleteButton} click":function(){EasySocial.dialog().close(),t.parent.trigger("commentDeleting",[t.options.id]),t.trigger("commentDeleting"),t.deleteComment().done(function(){t.parent.trigger("commentDeleted",[t.options.id])}).fail(function(e){t.parent.trigger("commentDeleteError",[t.options.id,e]),t.trigger("commentDeleteError",[t.options.id,e])})},"{cancelButton} click":function(){EasySocial.dialog().close()}}})},deleteComment:function(){return EasySocial.ajax("site/controllers/comments/delete",{id:t.options.id})},"{loadReplies} click":function(i){i.hide();var n=Math.max(t.options.child-t.options.loadedChild-t.options.limit,0);EasySocial.ajax().done(function(i){e.each(i,function(e,i){t.parent.$List.addToList(i,"child",!1)}),t.parent.trigger("oldCommentsLoaded",[i]),n>0&&t.loadMoreReplies().show()})},"{readMore} click":function(e,i){t.comment().html(t.fullContent().html())}}}),EasySocial.Controller("Comments.Item.Status",{defaultOptions:{"{frame}":"[data-comments-item-frame]","{statusFrame}":"[data-comments-item-statusFrame]","{statusContent}":"[data-comments-item-statusFrame] div","{commentFrame}":"[data-comments-item-commentFrame]","{editFrame}":"[data-comments-item-editFrame]"}},function(t){return{init:function(){},setStatus:function(i){t.frame().hide(),e.isPlainObject(i)&&void 0!==i.message&&(i=i.message),t.statusContent().html(i),t.statusFrame().show()},"{self} commentEditLoading":function(){t.setStatus(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_LOADING"))},"{self} commentEditLoaded":function(){t.frame().hide(),t.editFrame().show()},"{self} commentEditLoadError":function(){t.setStatus(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_LOAD_ERROR"))},"{self} commentEditCancel":function(){t.frame().hide(),t.commentFrame().show()},"{self} commentEditSaving":function(){t.setStatus(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVING"))},"{self} commentEditSaved":function(){t.frame().hide(),t.commentFrame().show()},"{self} commentEditSaveError":function(){t.setStatus(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_SAVE_ERROR"))},"{self} commentDeleting":function(){t.setStatus(e.language("COM_EASYSOCIAL_COMMENTS_STATUS_DELETING"))},"{self} commentDeleteError":function(i,n,o,a){a=a||e.language("COM_EASYSOCIAL_COMMENTS_STATUS_DELETE_ERROR"),t.setStatus(a)}}}),t.resolve()})}),EasySocial.module("site/conversations/conversations",function(e){var t=this;EasySocial.require().script("site/conversations/mailbox","site/conversations/item","site/conversations/filter").language("COM_EASYSOCIAL_NO_BUTTON").done(function(e){EasySocial.Controller("Conversations",{defaultOptions:{"{mailbox}":"[data-conversations-mailbox]","{list}":"[data-conversations-list]","{content}":"[data-conversations-content]","{item}":"[data-conversations-item]","{actions}":"[data-conversations-actions]","{filterItem}":"[data-conversations-filter]","{checkAll}":"[data-conversations-checkAll]","{checkbox}":"[data-conversationItem-checkbox]","{delete}":"[data-conversations-delete]","{archive}":"[data-conversations-archive]","{unarchive}":"[data-conversations-unarchive]","{unread}":"[data-conversations-unread]","{read}":"[data-conversations-read]"}},function(t){return{init:function(){t.mailbox().implement(EasySocial.Controller.Conversations.Mailbox,{"{parent}":t}),t.item().implement(EasySocial.Controller.Conversations.Item,{"{parent}":t}),t.filterItem().implement(EasySocial.Controller.Conversations.Filter,{"{parent}":t})},"{filterItem} click":function(i){t.filterItem().removeClass("active"),e(i).addClass("active")},"{checkbox} change":function(e){if(t.checkbox(":checked").length<=0&&!e.is(":checked"))return t.actions().removeClass("is-checked");t.actions().addClass("is-checked")},"{checkAll} click":function(i){if(t.checkbox().length<=0)return e(i).prop("checked",!1),!1;i.is(":checked")?t.checkbox(":not(:checked)").click():t.checkbox(":checked").click()},showEmpty:function(){t.content().addClass("is-empty")},hideEmpty:function(){t.content().removeClass("is-empty")},toggleLoading:function(){t.content().removeClass("is-empty").toggleClass("is-loading")},updateContent:function(e,i){void 0!=i?t.content().addClass("layout-"+i):t.content().removeClass("layout-archives"),t.actions().removeClass("is-checked"),t.checkAll().removeAttr("checked"),t.list().html(e)},getSelectedConversations:function(){if(t.checkbox(":checked").length<=0)return!1;var i=new Array;return t.checkbox(":checked").each(function(t,n){i.push(e(n).val())}),i},"{archive} click":function(){var i=t.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmArchive",{ids:i}),bindings:{"{confirmButton} click":function(){e("[data-conversation-archive-form]").submit()}}})},"{unarchive} click":function(){var i=t.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmUnarchive",{ids:i}),bindings:{"{confirmButton} click":function(){e("[data-conversation-archive-form]").submit()}}})},"{delete} click":function(){var i=t.getSelectedConversations();EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmDelete",{ids:i}),bindings:{"{deleteButton} click":function(){e("[data-conversation-delete-form]").submit()}}})},"{read} click":function(){if(t.checkbox(":checked").length<=0)return!1;var i=new Array;t.checkbox(":checked").each(function(t,n){i.push(e(n).val())}),EasySocial.ajax("site/controllers/conversations/markRead",{ids:i}).done(function(){t.checkbox().parents("[data-conversations-item]").removeClass("unread").addClass("read"),t.mailbox().controller().updateCounters()}).fail(function(e){t.setMessage(e)})},"{unread} click":function(){if(t.checkbox(":checked").length<=0)return!1;var i=new Array;t.checkbox(":checked").each(function(t,n){i.push(e(n).val())}),EasySocial.ajax("site/controllers/conversations/markUnread",{ids:i}).done(function(){t.checkbox().parents("[data-conversations-item]").removeClass("read").addClass("unread"),t.mailbox().controller().updateCounters()}).fail(function(e){console.log(e)})}}}),t.resolve()})}),EasySocial.module("site/conversations/mailbox",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Conversations.Mailbox",{defaultOptions:{"{item}":"[data-mailboxItem]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Conversations.Mailbox.Item,{"{parent}":e})},updateCounters:function(){e.item(".active").controller().updateCounter()},updateContent:function(t,i){e.parent.updateContent(t,i)},showEmpty:function(){e.parent.showEmpty()},hideEmpty:function(){e.parent.hideEmpty()},toggleLoading:function(){e.parent.toggleLoading()}}}),EasySocial.Controller("Conversations.Mailbox.Item",{defaultOptions:{"{counter}":"[data-mailboxItem-counter]",view:{emptyTemplate:"site/conversations/default.item.empty"}}},function(e){return{init:function(){},updateCounter:function(){EasySocial.ajax("site/controllers/conversations/getCount",{mailbox:e.element.data("mailbox")}).done(function(t){t<=0?e.counter().html(""):e.counter().html("("+t+")")})},toggleLoading:function(){e.element.toggleClass("loading")},"{self} click":function(){var t=e.element.data("url"),i=e.element.data("title"),n=e.element.data("mailbox");e.parent.item().removeClass("active"),e.element.addClass("active"),History.pushState({state:1},i,t),EasySocial.ajax("site/views/conversations/getItems",{mailbox:n,limitstart:0},{beforeSend:function(){e.toggleLoading(),e.parent.toggleLoading()}}).done(function(t,i){if(e.toggleLoading(),e.parent.toggleLoading(),t.length<=0)return e.parent.updateContent(""),e.parent.showEmpty();e.parent.hideEmpty(),e.parent.updateContent(t,e.element.data("mailbox"))})}}}),t.resolve()})}),EasySocial.module("site/conversations/item",function(e){var t=this;EasySocial.require().script("site/conversations/mailbox").done(function(e){EasySocial.Controller("Conversations.Item",{defaultOptions:{"{checkbox}":"[data-conversationItem-checkbox]"}},function(t){return{init:function(){},"{checkbox} change":function(i){return e(i).is(":checked")?t.element.addClass("selected"):t.element.removeClass("selected")}}}),t.resolve()})}),EasySocial.module("site/conversations/filter",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Conversations.Filter",{defaultOptions:{}},function(t){return{init:function(){},"{self} click":function(){var i=t.element.data("filter"),n="."+i;t.parent.item(n).length;if(1==e("[data-mailboxitem]").filter(".active").length){var o=e("[data-mailboxitem]").filter(".active"),a=o.data("url"),r=o.data("title"),s=o.data("mailbox");History.pushState({state:1},r,a),EasySocial.ajax("site/views/conversations/getItems",{mailbox:s,filter:i,limitstart:0},{beforeSend:function(){t.parent.toggleLoading()}}).done(function(e,i){if(t.parent.toggleLoading(),e.length<=0)return t.parent.updateContent(""),t.parent.showEmpty();t.parent.hideEmpty(),t.parent.updateContent(e,s)})}}}}),t.resolve()})}),EasySocial.module("site/conversations/read",function(e){var t=this;EasySocial.require().library("dialog").script("site/conversations/composer","site/friends/suggest").language("COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY","COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY").done(function(e){EasySocial.Controller("Conversations.Read",{defaultOptions:{id:"",attachments:!0,location:!1,maxSize:"3mb",extensionsAllowed:"",attachmentController:null,composerController:null,"{item}":"[data-readConversation-item]","{items}":"[data-readConversation-items]","{composer}":"[data-readConversation-composer]","{replyButton}":"[data-readConversation-replyButton]","{addParticipant}":"[data-readConversation-addParticipant]","{leaveConversation}":"[data-readConversation-leaveConversation]","{delete}":"[data-readConversation-delete]","{attachments}":"[data-uploaderQueue-id]","{replyNotice}":"[data-readConversation-replyNotice]","{readLoadMore}":"[data-readconversation-load-more]",view:{messageItem:"site/conversations/read.message"}}},function(t){return{init:function(){t.composer().implement(EasySocial.Controller.Conversations.Composer,{"{uploader}":"[data-readConversation-attachment]","{location}":"[data-readConversation-location]",maxSize:t.options.maxSize,extensionsAllowed:t.options.extensionsAllowed}),t.options.composerController=t.composer().controller(),t.options.attachments&&(t.options.attachmentController=t.options.composerController.uploader().controller()),t.options.location&&(t.options.locationController=t.options.composerController.location().controller()),t.item().implement(EasySocial.Controller.Conversations.Read.Item),t.options.id=t.element.data("id")},resetForm:function(){t.options.composerController.resetForm(),t.composer().controller().editorArea().mentions("controller").reset(),t.options.location&&t.options.locationController.removeLocation(),t.options.attachments&&t.options.attachmentController.reset()},"{readLoadMore} click":function(i){var n=e(i).data("id"),o=e(i).data("limitstart");t.readLoadMore().hide(),e(".loading-indicator").show();var a={id:n,limitstart:o};EasySocial.ajax("site/controllers/conversations/loadPrevious",a).done(function(n,o){e.buildHTML(n).prependTo(t.items()).addController("EasySocial.Controller.Conversations.Read.Item"),0==o?t.readLoadMore().hide():(t.readLoadMore().show(),e(i).data("limitstart",o))}).always(function(){e(".loading-indicator").hide()})},"{replyButton} click":function(i,n){n.preventDefault();var o=t.options.composerController.editor().val(),a=new Array;if(o.length<=0)return t.replyNotice().html(e.language("COM_EASYSOCIAL_CONVERSATION_REPLY_FORM_EMPTY")).addClass("alert alert-error").removeClass("alert-success"),!1;t.options.attachments&&t.attachments().each(function(t,i){a.push(e(i).val())});var r={id:t.options.id,message:o};return t.options.attachments&&(r["upload-id"]=a),t.options.location&&(r.address=t.options.locationController.locationInput().val(),r.latitude=t.options.locationController.locationLatitude().val(),r.longitude=t.options.locationController.locationLongitude().val()),r.tags=t.composer().controller().editorArea().mentions("controller").toArray(),t.replyButton().attr("disabled",!0),EasySocial.ajax("site/controllers/conversations/reply",r).done(function(i){t.replyNotice().html(e.language("COM_EASYSOCIAL_CONVERSATION_REPLY_POSTED_SUCCESSFULLY")).addClass("alert alert-success").removeClass("alert-error");var n=e(i);n.implement(EasySocial.Controller.Conversations.Read.Item),t.items().append(n),t.resetForm()}).always(function(){t.replyButton().attr("disabled",!1)}),!1},"{leaveConversation} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmLeave",{id:t.options.id})})},"{addParticipant} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/addParticipantsForm",{id:t.options.id})})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmDelete",{ids:[t.options.id]}),bindings:{"{deleteButton} click":function(){e("[data-conversation-delete-form]").submit()}}})},addItem:function(e){t.messageList().append(t.view.messageItem({item:e})),t.textMessage().val("").focus()}}}),EasySocial.Controller("Conversations.Read.Item",{defaultOptions:{id:null,"{attachmentsWrapper}":"[data-conversation-attachment-wrapper]","{attachments}":"[data-conversation-attachment]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.attachments().implement(EasySocial.Controller.Conversations.Read.Item.Attachment,{"{parent}":t})},removeAttachment:function(i,n){e(i).remove(),0==t.attachments().length&&t.attachmentsWrapper().hide()}}}),EasySocial.Controller("Conversations.Read.Item.Attachment",{defaultOptions:{"{deleteAttachment}":"[data-attachment-delete]"}},function(t){return{init:function(){},"{deleteAttachment} click":function(i,n){var o=e(i).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/confirmDeleteAttachment",{id:o}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/conversations/deleteAttachment",{id:o}).done(function(){t.parent.removeAttachment(t.element),EasySocial.dialog({content:EasySocial.ajax("site/views/conversations/attachmentDeleted",{})})}).fail(function(e){t.setMessage(e)})}}})}}}),t.resolve()})}),EasySocial.module("site/dashboard/apps",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Dashboard.Apps",{defaultOptions:{parent:null,pageTitle:null,"{item}":"[data-dashboardApps-item]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Dashboard.Apps.Item,{"{parent}":e,"{dashboard}":e.parent,pageTitle:e.options.pageTitle})}}}),EasySocial.Controller("Dashboard.Apps.Item",{defaultOptions:{}},function(t){return{init:function(){},"{self} click":function(i,n){n.preventDefault();var o=t.element.data("layout"),a=t.element.data(o+"-url"),r=t.element.data("title"),s=t.element.data("description"),l=t.element.data("id");"canvas"!=o?(r=e._.isEmpty(t.options.pageTitle)?r:t.options.pageTitle,History.pushState({state:1},r,a),t.dashboard.content().html(""),t.dashboard.updatingContents(),t.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getAppContents",{appId:l}).done(function(e){t.dashboard.updateHeading(r,s),t.dashboard.updateContents(e)}).fail(function(e){return e}).always(function(){t.element.removeClass("loading")})):window.location=a}}}),t.resolve()})}),EasySocial.module("site/dashboard/dashboard",function(e){var t=this;EasySocial.require().script("site/dashboard/apps","site/dashboard/feeds","site/dashboard/sidebar","site/stream/filter","site/dashboard/groups","site/dashboard/events").done(function(e){EasySocial.Controller("Dashboard",{defaultOptions:{currentTitle:null,pageTitle:null,"{heading}":"[data-dashboard-heading]","{sidebar}":"[data-dashboard-sidebar]","{content}":"[data-dashboard-real-content]","{feeds}":"[data-dashboard-feeds]","{groups}":"[data-dashboard-groups]","{events}":"[data-dashboard-events]","{groupItems}":"[data-dashboard-group-item]","{eventItems}":"[data-dashboard-event-item]","{showAllFilters}":"[data-app-filters-showall]","{showAllGroups}":"[data-groups-filters-showall]","{showAllEvents}":"[data-events-filters-showall]","{appFilters}":"[data-sidebar-app-filter]","{apps}":"[data-dashboard-apps]","{saveHashTag}":"[data-hashtag-filter-save]"}},function(t){return{init:function(){t.sidebar().implement(EasySocial.Controller.Dashboard.Sidebar,{"{parent}":t}),t.feedsController=t.feeds().addController(EasySocial.Controller.Dashboard.Feeds,{"{parent}":t}),t.apps().implement(EasySocial.Controller.Dashboard.Apps,{"{parent}":t,pageTitle:t.options.pageTitle}),t.groups().implement(EasySocial.Controller.Dashboard.Groups,{"{parent}":t}),t.events().implement(EasySocial.Controller.Dashboard.Events,{"{parent}":t})},"{showAllGroups} click":function(i,n){e(i).hide(),t.groupItems().removeClass("hide")},"{showAllEvents} click":function(i,n){e(i).hide(),t.eventItems().removeClass("hide")},"{showAllFilters} click":function(i,n){e(i).hide(),t.appFilters().removeClass("hide")},updateHeading:function(e,i){t.heading().find("[data-heading-title]").html(e),t.heading().find("[data-heading-desc]").html(i)},updatingContents:function(){t.element.addClass("loading")},updateContents:function(i){t.element.removeClass("loading"),e.buildHTML(i).appendTo(t.content())},"{saveHashTag} click":function(i){var n=i.data("tag");EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmSaveFilter",{tag:n}),bindings:{"{saveButton} click":function(){this.inputWarning().hide(),filterName=this.inputTitle().val(),""!=filterName?EasySocial.ajax("site/controllers/stream/addFilter",{title:filterName,tag:n}).done(function(i,n){var o=e.buildHTML(i);t.feedsController.addFilterItem(o),EasySocial.dialog(n),setTimeout(function(){EasySocial.dialog().close()},2e3)}):this.inputWarning().show()}}})}}}),t.resolve()})}),EasySocial.module("site/dashboard/feeds",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Dashboard.Feeds",{defaultOptions:{"{item}":"[data-dashboardFeeds-item]","{filter}":"[data-dashboardFeeds-Filter-edit]"}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Dashboard.Feeds.Item,{"{parent}":e,"{dashboard}":e.parent})},addFilterItem:function(t){t.find("[data-dashboardFeeds-item]").implement(EasySocial.Controller.Dashboard.Feeds.Item,{"{parent}":e,"{dashboard}":e.parent}),t.appendTo(e.element)}}}),EasySocial.Controller("Dashboard.Feeds.Item",{defaultOptions:{}},function(t){return{clicked:!1,init:function(){},"{self} click":function(){e(".es-streams").removeClass("no-stream");var i=t.element.data("type"),n=t.element.data("id"),o=t.element.data("url"),a=t.element.data("title"),r=t.element.data("description");if(!t.clicked){t.clicked=!0;var s="[data-stream-counter-";"list"==i?s=s+i+"-"+n:s+=i,e(s+="]").html("0"),t.element.removeClass("has-notice"),History.pushState({state:1},a,o),t.dashboard.content().html(""),t.dashboard.updatingContents(),t.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getStream",{type:i,id:n,view:"dashboard"}).done(function(n,o){t.dashboard.updateHeading(a,r),0==o&&e(".es-streams").addClass("no-stream"),t.trigger("onStreamUpdate",[i]),window.streamFilter=i,t.dashboard.updateContents(n);try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(e){}}).fail(function(e){return e}).always(function(){t.clicked=!1,t.element.removeClass("loading")})}}}}),t.resolve()})}),EasySocial.module("site/dashboard/sidebar",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Dashboard.Sidebar",{defaultOptions:{"{menuItem}":"[data-dashboardSidebar-menu]","{filterBtn}":"[data-stream-filter-button]","{editIcon}":"[data-dashboardFeeds-Filter-edit]"}},function(t){return{init:function(){},"{menuItem} click":function(i,n){t.menuItem().removeClass("active"),e(i).addClass("active")},"{editIcon} click":function(i,n){n.preventDefault(),e(i).route();var o=i.data("id");t.parent.content().html(""),t.parent.updatingContents(),EasySocial.ajax("site/controllers/stream/getFilter",{id:o}).done(function(e){t.parent.updateContents(e)}).fail(function(e){return e})},"{filterBtn} click":function(i,n){n.preventDefault(),e(i).route(),t.parent.content().html(""),t.parent.updatingContents(),EasySocial.ajax("site/controllers/stream/getFilter",{id:0}).done(function(e){t.parent.updateContents(e)}).fail(function(e){return e}).always(function(){})}}}),t.resolve()})}),EasySocial.module("site/stream/filter",function(e){var t=this;EasySocial.require().script("site/stream/sidebar").language("COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY","COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY").done(function(e){EasySocial.Controller("Stream.Filter",{defaultOptions:{"{heading}":"[data-filter-heading]","{sidebar}":"[data-sidebar-item]","{content}":"[data-filter-real-content]"}},function(e){return{init:function(){e.sidebar().implement(EasySocial.Controller.Stream.Filter.Sidebar,{"{parent}":e})},updateHeading:function(t,i){e.heading().find("[data-heading-title]").html(t),e.heading().find("[data-heading-desc]").html(i)},updatingContents:function(){e.element.addClass("loading")},updateContents:function(t){e.element.removeClass("loading"),e.content().html(t)}}}),EasySocial.Controller("Stream.Filter.Item",{defaultOptions:{"{title}":"[data-filter-name]","{hashtag}":"[data-filter-hashtag]","{saveBtn}":"[data-stream-filter-save]","{deleteBtn}":"[data-stream-filter-delete]","{form}":"[data-filter-inputForm]","{notice}":"[filter-form-notice]"}},function(t){return{init:function(){},"{deleteBtn} click":function(e){var i=e.data("id"),n=e.data("uid"),o=e.data("utype"),a="site/controllers/stream/deleteFilter";if(n)a="site/controllers/"+o+"s/deleteFilter";EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmFilterDelete"),bindings:{"{deleteButton} click":function(){EasySocial.ajax(a,{id:i,uid:n,utype:o}).done(function(e){t.element.fadeOut(),EasySocial.dialog().close()})}}})},"{saveBtn} click":function(){return e("div.control-group").removeClass("error"),t.notice().html(),t.notice().hide(),""==t.title().val()?(t.title().parents("div.control-group").addClass("error"),t.notice().html(e.language("COM_EASYSOCIAL_STREAM_FILTER_WARNING_TITLE_EMPTY")),t.notice().show(),!1):""==t.hashtag().val()?(t.hashtag().parents("div.control-group").addClass("error"),t.notice().html(e.language("COM_EASYSOCIAL_STREAM_FILTER_WARNING_HASHTAG_EMPTY")),t.notice().show(),!1):void t.form().submit()}}}),t.resolve()})}),EasySocial.module("site/stream/sidebar",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Stream.Filter.Sidebar",{defaultOptions:{}},function(t){return{init:function(){},"{self} click":function(){e("[data-sidebar-item]").removeClass("active loading"),t.element.addClass("active");var i=t.element.data("id"),n=t.element.data("url"),o=t.element.data("title");History.pushState({state:1},o,n),t.parent.content().html(""),t.parent.updatingContents(),t.element.addClass("loading"),EasySocial.ajax("site/controllers/stream/getFilter",{id:i}).done(function(e){t.parent.updateContents(e)}).fail(function(e){return e}).always(function(){t.element.removeClass("loading")})}}}),t.resolve()})}),EasySocial.module("site/dashboard/groups",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Dashboard.Groups",{defaultOptions:{"{item}":"[data-dashboard-group-item]","{itemLink}":"[data-dashboard-group-item] > a"}},function(t){return{init:function(){},"{item} click":function(i,n){n.preventDefault(),e(".es-streams").removeClass("no-stream");var o=e(i).data("type"),a=e(i).data("id");e(i).data("description");t.element.removeClass("has-notice"),e(i).find("a").route(),t.parent.content().html(""),t.parent.updatingContents(),t.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getStream",{type:o,id:a,view:"dashboard"}).done(function(e){t.parent.updateContents(e)})}}}),t.resolve()})}),EasySocial.module("site/dashboard/events",function(e){var t=this;EasySocial.require().library("history").done(function(e){EasySocial.Controller("Dashboard.Events",{defaultOptions:{"{item}":"[data-dashboard-event-item]","{itemLink}":"[data-dashboard-event-item] > a"}},function(t){return{init:function(){},"{item} click":function(i,n){n.preventDefault(),e(".es-streams").removeClass("no-stream");var o=e(i).data("type"),a=e(i).data("id");e(i).data("description");t.element.removeClass("has-notice"),e(i).find("a").route(),t.parent.content().html(""),t.parent.updatingContents(),t.element.addClass("loading"),EasySocial.ajax("site/controllers/dashboard/getStream",{type:o,id:a,view:"dashboard"}).done(function(e){t.parent.updateContents(e)})}}}),t.resolve()})}),EasySocial.module("site/events/browser",function(e){var t=this;EasySocial.require().library("popbox").script("site/events/guestState").language("COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION").view("site/loading/small").done(function(){EasySocial.Controller("Events.Browser",{defaultOptions:{"{filters}":"[data-events-filters] > li","{content}":"[data-events-content]","{list}":"[data-events-list]","{items}":"[data-events-item]","{sort}":"[data-events-sorting] a","{calendar}":"[data-events-calendar]","{pastFilter}":"[data-events-past]","{pastLink}":"[data-events-past-link]","{prevDate}":"[data-events-nav-prevdate]","{nextDate}":"[data-events-nav-nextdate]","{radius}":"[data-events-radius]","{nearbyTitle}":"[data-events-nearby-title]",filter:null,categoryid:0,delayed:!1,includePast:!1,ordering:"start",hasLocation:!1,userLatitude:"",userLongitude:"",distance:10,view:{loadingContent:"site/loading/small"}}},function(t){return{init:function(){t.options.filter=t.element.data("filter"),t.options.categoryid=t.element.data("categoryid"),t.renderCalendar(),t.initItems(),t.options.delayed&&t.delayedInit()},delayedInit:function(){if("nearby"===t.options.filter){var i=function(){EasySocial.ajax("site/controllers/events/getEvents",{filter:t.options.filter,latitude:t.options.userLatitude,longitude:t.options.userLongitude,distance:t.options.distance,ordering:t.options.ordering,includePast:t.options.includePast}).done(function(e){t.element.removeClass("loading"),t.content().html(e),t.initItems()})};if(t.options.hasLocation&&t.options.userLatitude&&t.options.userLongitude)return i();EasySocial.require().library("gmaps").done(function(){e.GMaps.geolocate({success:function(e){return t.options.userLatitude=e.coords.latitude,t.options.userLongitude=e.coords.longitude,i()}})})}},renderCalendar:function(){EasySocial.ajax("site/views/events/renderCalendar",{}).done(function(e){t.calendar().html(e).addController("EasySocial.Controller.Events.Browser.Calendar",{"{parent}":t}),t.calendar().trigger("calendarLoaded")})},initItems:function(){t.items().addController("EasySocial.Controller.Events.Browser.Item",{"{parent}":t})},"{filters} click":function(e,i){if(i.preventDefault(),t.filters().removeClass("active"),e.addClass("active"),t.content().html("&nbsp;"),e.find("a").route(),t.options.filter=e.data("events-filters-type"),t.options.categoryid=e.data("events-filters-categoryid"),"nearby"==t.options.filter)return t.filterByNearby();t.element.addClass("loading"),EasySocial.ajax("site/controllers/events/getEvents",{filter:t.options.filter,categoryid:t.options.categoryid}).done(function(e){t.element.removeClass("loading"),t.content().html(e),t.initItems()})},filterByNearby:function(){var i=function(){EasySocial.ajax("site/controllers/events/getEvents",{filter:t.options.filter,latitude:t.options.userLatitude,longitude:t.options.userLongitude}).done(function(e){t.element.removeClass("loading"),t.content().html(e),t.initItems()})};if(t.options.hasLocation&&t.options.userLatitude&&t.options.userLongitude)return t.element.addClass("loading"),i();t.content().html('<div class="es-detecting-location"><i class="ies-earth es-muted"></i> '+e.language("COM_EASYSOCIAL_EVENTS_DETECTING_LOCATION")+' <i class="icon-loader"></i></div>'),EasySocial.require().library("gmaps").done(function(){e.GMaps.geolocate({success:function(e){return t.options.userLatitude=e.coords.latitude,t.options.userLongitude=e.coords.longitude,t.options.hasLocation=!0,i()}})})},"{sort} click":function(e,i){i.preventDefault(),t.sort().removeClass("active"),e.addClass("active"),t.list().html(t.view.loadingContent());var n=e.data("ordering"),o=e.data("filter"),a=e.data("categoryid"),r=t.pastFilter().is(":checked")?1:0;t.setPastLink(),t.setSortLink(),e.route(),"nearby"!==o?EasySocial.ajax("site/controllers/events/getEvents",{filter:o,categoryid:a,ordering:n,sort:1,includePast:r}).done(function(e){t.list().html(e),t.initItems()}):EasySocial.ajax("site/controllers/events/getEvents",{filter:t.options.filter,latitude:t.options.userLatitude,longitude:t.options.userLongitude,distance:t.options.distance,ordering:n,sort:1,includePast:r}).done(function(e){t.list().html(e),t.initItems()})},"{pastFilter} change":function(e){var i=t.sort(".active"),n=e.is(":checked")?1:0,o=i.data("ordering"),a=i.data("filter"),r=i.data("categoryid");t.list().html(t.view.loadingContent()),t.pastLink().route(),t.setPastLink(),t.setSortLink(),"nearby"!==a?EasySocial.ajax("site/controllers/events/getEvents",{filter:a,categoryid:r,ordering:o,sort:1,includePast:n}).done(function(e){t.list().html(e),t.initItems()}):EasySocial.ajax("site/controllers/events/getEvents",{filter:t.options.filter,latitude:t.options.userLatitude,longitude:t.options.userLongitude,distance:t.options.distance,ordering:o,sort:1,includePast:n}).done(function(e){t.list().html(e),t.initItems()})},"{pastLink} click":function(e,i){i.preventDefault(),t.pastFilter().trigger("click")},setPastLink:function(){var e=t.pastLink(),i=t.pastFilter().is(":checked")?1:0,n=t.sort(".active").data("ordering"),o=e.data(n+"-"+(i?"nopast":"past"));e.attr("href",o)},setSortLink:function(){var i=t.pastFilter().is(":checked")?1:0;e.each(t.sort(),function(n,o){(o=e(o)).attr("href",t.pastLink().data(o.data("ordering")+"-"+(i?"past":"nopast")))})},"{prevDate} click":function(e,i){i.preventDefault(),e.route(),t.filters().removeClass("active"),t.element.addClass("loading"),t.content().html("&nbsp;"),EasySocial.ajax("site/controllers/events/getEvents",{filter:"date",date:e.data("events-nav-prevdate")}).done(function(e,i){t.element.removeClass("loading"),t.content().html(e),t.initItems(),i.isToday&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="date"]').addClass("active")),i.isTomorrow&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="tomorrow"]').addClass("active")),i.isCurrentMonth&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="month"]').addClass("active")),i.isCurrentYear&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="year"]').addClass("active"))})},"{nextDate} click":function(e,i){i.preventDefault(),e.route(),t.filters().removeClass("active"),t.element.addClass("loading"),t.content().html("&nbsp;"),EasySocial.ajax("site/controllers/events/getEvents",{filter:"date",date:e.data("events-nav-nextdate")}).done(function(e,i){t.element.removeClass("loading"),t.content().html(e),t.initItems(),i.isToday&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="date"]').addClass("active")),i.isTomorrow&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="tomorrow"]').addClass("active")),i.isCurrentMonth&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="month"]').addClass("active")),i.isCurrentYear&&(t.filters().removeClass("active"),t.filters('[data-events-filters-type="year"]').addClass("active"))})},"{radius} change":function(i,n){var o=t.sort(".active"),a=t.pastFilter().is(":checked")?1:0,r=o.data("ordering"),s=(o.data("filter"),o.data("categoryid"),i.val());t.options.distance=s,t.list().html(t.view.loadingContent()),EasySocial.ajax("site/controllers/events/getEvents",{filter:"nearby",latitude:t.options.userLatitude,longitude:t.options.userLongitude,distance:t.options.distance,ordering:r,includePast:a,sort:1}).done(function(i,n){t.list().html(i),t.initItems(),History.pushState({state:1},document.title,n.hrefs[r][a?"past":"nopast"]),t.pastLink().attr("href",n.hrefs[r][a?"nopast":"past"]),e.each(t.sort(),function(i,o){(o=e(o)).attr("href",n.hrefs[o.data("ordering")][a?"past":"nopast"]),t.pastLink().attr("data-"+o.data("ordering")+"-past",n.hrefs[o.data("ordering")].past),t.pastLink().attr("data-"+o.data("ordering")+"-nopast",n.hrefs[o.data("ordering")].nopast)}),t.nearbyTitle().text(n.title)})}}}),EasySocial.Controller("Events.Browser.Item",{defaultOptions:{id:null,"{action}":"[data-item-action]","{unfeature}":"[data-item-unfeature]","{feature}":"[data-item-feature]","{unpublish}":"[data-item-unpublish]","{delete}":"[data-item-delete]","{guestStateWrap}":"[data-guest-state-wrap]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.initGuestStates()},initGuestStates:function(){e.guestStateWrap().addController("EasySocial.Controller.Events.GuestState")},"{action} click":function(t){EasySocial.dialog({content:EasySocial.ajax("site/views/events/itemActionDialog",{id:e.options.id,action:t.data("item-action"),from:"list"})})}}}),EasySocial.Controller("Events.Browser.Calendar",{defaultOptions:{"{nav}":"[data-calendar-nav]","{day}":".day","{month}":"[data-month]",view:{loading:"site/loading/small"}}},function(t){return{init:function(){},"{self} calendarLoaded":function(){t.day(".has-events").each(function(t,i){var n=(i=e(i)).find(".event-details").html();i.popbox({content:n,id:"fd",component:"es",type:"events-calendar-filter",position:"bottom-left",toggle:"hover"})});var i=t.month(".has-events");if(i.length>0){var n=i.find(".event-details").html();i.popbox({content:n,id:"fd",component:"es",type:"events-calendar-filter",position:"bottom-left",toggle:"hover"})}},"{nav} click":function(e,i){var n=e.data("calendar-nav");t.element.html(t.view.loading()),EasySocial.ajax("site/views/events/renderCalendar",{date:n}).done(function(e){t.element.html(e).trigger("calendarLoaded")})},"{day} click":function(e,i){i.preventDefault(),e.find("a[data-route]:first").route(),t.loadEvents(e.data("date"))},"{day} popboxActivate":function(i,n,o){o.tooltip.find("a[data-route]").on("click",function(i){i.preventDefault(),e(this).route(),t.loadEvents(e(this).data("date"))})},"{month} click":function(e,i){i.preventDefault(),e.find("a[data-route]:first").route(),t.loadEvents(e.data("month"))},"{month} popboxActivate":function(i,n,o){o.tooltip.find("a[data-route]").on("click",function(i){i.preventDefault(),e(this).route(),t.loadEvents(e(this).data("month"))})},loadEvents:function(e){t.parent.filters().removeClass("active"),t.parent.element.addClass("loading"),t.parent.content().html("&nbsp;"),EasySocial.ajax("site/controllers/events/getEvents",{filter:"date",date:e}).done(function(e,i){t.parent.element.removeClass("loading"),t.parent.content().html(e),t.parent.initItems(),i.isToday&&(t.parent.filters().removeClass("active"),t.parent.filters('[data-events-filters-type="date"]').addClass("active")),i.isTomorrow&&(t.parent.filters().removeClass("active"),t.parent.filters('[data-events-filters-type="tomorrow"]').addClass("active")),i.isCurrentMonth&&(t.parent.filters().removeClass("active"),t.parent.filters('[data-events-filters-type="month"]').addClass("active")),i.isCurrentYear&&(t.parent.filters().removeClass("active"),t.parent.filters('[data-events-filters-type="year"]').addClass("active"))})}}}),t.resolve()})}),EasySocial.module("site/events/guestState",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_EVENTS_GUEST_PENDING").done(function(e){EasySocial.Controller("Events.GuestState",{defaultOptions:{id:null,allowMaybe:1,allowNotGoingGuest:1,hidetext:1,refresh:!1,"{guestAction}":"[data-guest-action]","{guestState}":"[data-guest-state]","{request}":"[data-guest-request]","{withdraw}":"[data-guest-withdraw]","{respond}":"[data-guest-respond]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.allowMaybe=t.element.data("allowmaybe"),t.options.allowNotGoingGuest=t.element.data("allownotgoingguest"),t.options.hidetext=t.element.data("hidetext"),t.options.refresh=t.element.is("[data-refresh]")},showError:function(e){EasySocial.dialog({content:e})},stateClasses:{going:"btn-es-success",maybe:"btn-es-info",notgoing:"btn-es-danger"},"{guestAction} click":function(i){var n=i.data("guestAction");if("state"===n){var o=i.data("guestState");t.guestAction().removeClass("btn-es-success btn-es-info btn-es-danger"),i.addClass(t.stateClasses[o]),"notgoing"!==o||t.options.allowNotGoingGuest?t.response(o).done(function(){if(t.options.refresh)return location.reload()}).fail(function(e){i.removeClass(t.stateClasses[n]),t.showError(e)}):EasySocial.dialog({content:EasySocial.ajax("site/views/events/notGoingDialog",{id:t.options.id}),bindings:{"{closeButton} click":function(){EasySocial.ajax("site/views/events/refreshGuestState",{id:t.options.id,hidetext:t.options.hidetext}).done(function(e){t.element.html(e),EasySocial.dialog().close()})},"{submitButton} click":function(){t.response("notgoing").done(function(){if(t.options.refresh)return location.reload();EasySocial.ajax("site/views/events/refreshGuestState",{id:t.options.id,hidetext:t.options.hidetext}).done(function(e){t.element.html(e),EasySocial.dialog().close()})})}}})}"request"===n&&EasySocial.dialog({content:EasySocial.ajax("site/views/events/requestDialog",{id:t.options.id}),bindings:{"{submitButton} click":function(){i.attr("data-guest-action","withdraw").data("guestAction","withdraw").removeAttr("data-guest-request").attr("data-guest-withdraw","").text(e.language("COM_EASYSOCIAL_EVENTS_GUEST_PENDING")),t.response(n),EasySocial.dialog().close()}}}),"withdraw"===n&&EasySocial.dialog({content:EasySocial.ajax("site/views/events/withdrawDialog",{id:t.options.id}),bindings:{"{submitButton} click":function(){t.response("withdraw").done(function(){EasySocial.ajax("site/views/events/refreshGuestState",{id:t.options.id,hidetext:t.options.hidetext}).done(function(e){t.element.html(e),EasySocial.dialog().close()})})}}}),"attend"===n&&t.response("going").done(function(){EasySocial.ajax("site/views/events/refreshGuestState",{id:t.options.id,hidetext:t.options.hidetext}).done(function(e){if(t.options.refresh)return location.reload();void 0!==e&&(t.element.html(e),EasySocial.dialog().close())})})},response:function(e){return EasySocial.ajax("site/controllers/events/guestResponse",{id:t.options.id,state:e})}}}),t.resolve()})}),EasySocial.module("site/events/create",function(e){var t=this;EasySocial.require().script("validate","field").done(function(){EasySocial.Controller("Events.Create",{defaultOptions:{previousLink:null,"{fields}":"[data-create-field]","{previous}":"[data-create-previous]","{next}":"[data-create-submit]"}},function(e){return{init:function(){e.fields().addController("EasySocial.Controller.Field.Base")},"{previous} click":function(){window.location=e.options.previousLink},"{next} click":function(t){t.enabled()&&(t.disabled(!0),t.addClass("btn-loading"),e.element.validate().done(function(){t.removeClass("btn-loading"),t.enabled(!0),e.element.submit()}).fail(function(){t.removeClass("btn-loading"),t.enabled(!0),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}))}}}),t.resolve()})}),EasySocial.module("site/events/edit",function(e){var t=this;EasySocial.require().script("validate","field").done(function(){EasySocial.Controller("Events.Edit",{defaultOptions:{id:null,"{form}":"[data-form]","{nav}":"[data-step-nav]","{content}":"[data-step-content]","{fields}":"[data-edit-field]","{saveButton}":"[data-edit-save]"}},function(t){return{init:function(){t.fields().addController("EasySocial.Controller.Field.Base",{mode:"edit"})},errorFields:[],"{nav} click":function(i,n){var o=e(i).data("for");t.content().hide(),t.nav().removeClass("active"),i.addClass("active"),t.content().filterBy("id",o).show().find(t.fields.selector).trigger("show")},"{nav} error":function(e){e.addClass("error")},"{nav} clear":function(e){t.errorFields.length<1&&e.removeClass("error")},"{fields} error":function(e,i){t.triggerStepError(e)},"{fields} clear":function(e,i){t.clearStepError(e)},"{fieldItem} onError":function(e,i){t.triggerStepError(e)},triggerStepError:function(i){var n=i.data("id"),o=i.parents(t.content.selector).data("id");e.inArray(n,t.errorFields)<0&&t.errorFields.push(n),t.nav().filterBy("for",o).trigger("error")},clearStepError:function(i){var n=i.data("id"),o=i.parents(t.content.selector).data("id");t.errorFields=e.without(t.errorFields,n),t.nav().filterBy("for",o).trigger("clear")},"{saveButton} click":function(e,i){i.preventDefault(),e.addClass("btn-loading"),t.form().validate().done(function(){t.form().submit()}).fail(function(){e.removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})})}}}),t.resolve()})}),EasySocial.module("site/events/item",function(e){var t=this;EasySocial.template("info/item",'<li data-sidebar-item><a class="ml-20" href="[%= url %]" title="[%= title %]" data-info-item data-info-index="[%= index %]"><i class="ies-info ies-small mr-5"></i> [%= title %]</a></li>'),EasySocial.require().script("site/friends/suggest","site/events/guestState").view("site/loading/small").library("history").done(function(e){EasySocial.Controller("Events.Item",{defaultOptions:{id:null,"{filterStreamList}":"[data-filter-stream-list]","{sidebarItem}":"[data-sidebar-item]","{addFilter}":"[data-filter-add]","{editFilter}":"[data-filter-edit]","{filterStream}":"[data-filter-stream]","{filterApp}":"[data-filter-app]","{showAllFilters}":"[data-filter-showall]","{apps}":"[data-app-item]","{content}":"[data-content]","{saveHashtag}":"[data-hashtag-filter-save]","{invite}":"[data-action-invite]","{unpublish}":"[data-action-unpublish]","{delete}":"[data-action-delete]","{guestStateWrap}":"[data-guest-state-wrap]","{info}":"[data-info]","{infoItem}":"[data-info-item]","{menuItem}":"[data-dashboardSidebar-menu]",view:{infoItem:"info/item",loading:"site/loading/small"}}},function(t){return{init:function(){t.initGuestStates()},initGuestStates:function(){t.guestStateWrap().addController("EasySocial.Controller.Events.GuestState")},setActive:function(e){t.sidebarItem().removeClass("active"),e.parents(t.sidebarItem.selector).addClass("active")},setLoading:function(e){t.content().html(""),t.element.addClass("loading")},updateContents:function(e){t.element.removeClass("loading"),t.content().html(e)},"{showAllFilters} click":function(e,i){e.hide(),t.sidebarItem().show()},"{editFilter} click":function(e,i){i.preventDefault(),e.route(),t.setLoading(),t.getFilter(e.data("id")),t.setActive(e.parents("[data-sidebar-item]"))},"{addFilter} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading(),t.getFilter(0)},getFilter:function(e){EasySocial.ajax("site/controllers/events/getFilter",{filterId:e,eventId:t.options.id}).always(function(e){t.updateContents(e)})},"{filterApp} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading(),t.getStream(e.data("id"),"apps")},"{filterStream} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading(),t.getStream(e.data("id"),e.data("type"))},"{menuItem} click":function(i,n){t.menuItem().removeClass("active"),e(i).addClass("active")},getStream:function(e,i){EasySocial.ajax("site/controllers/events/getStream",{id:e,type:i,view:"events",eventId:t.options.id}).always(function(e){t.updateContents(e)})},"{saveHashtag} click":function(i){var n=i.data("tag");EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmSaveFilter",{tag:n}),bindings:{"{saveButton} click":function(){this.inputWarning().hide();var i=this.inputTitle().val();""!=i?EasySocial.ajax("site/controllers/events/addFilter",{title:i,tag:n,id:t.options.id}).done(function(i,n){var o=e.buildHTML(i);t.filterStreamList().append(o),EasySocial.dialog(n),setTimeout(function(){EasySocial.dialog().close()},2e3)}):this.inputWarning().show()}}})},"{apps} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading(),EasySocial.ajax("site/controllers/events/getAppContents",{appId:e.data("app-id"),eventId:t.options.id}).always(function(e){t.updateContents(e)})},"{info} click":function(i,n){n.preventDefault(),i.route(),t.setActive(i),t.setLoading(),i.data("loaded")?t.infoItem().eq(0).trigger("click"):i.enabled()&&(i.disabled(!0),EasySocial.ajax("site/controllers/events/initInfo",{eventId:t.options.id}).done(function(n){i.data("loaded",1);var o=i.parent("[data-sidebar-item]");e.each(n.reverse(),function(e,i){i.hide||o.after(t.view.infoItem({url:i.url,title:i.title,index:i.index})),i.html&&(t.updateContents(i.html),t.content().find("[data-field]").trigger("onShow"))});var a=t.infoItem().eq(0);t.setActive(a),e(document).prop("title",a.attr("title")),i.enabled(!0)}).fail(function(e){i.enabled(!0),t.updateContents(e.message)}))},"{infoItem} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading();var n=e.data("info-index");EasySocial.ajax("site/controllers/events/getInfo",{eventId:t.options.id,index:n}).done(function(e){t.updateContents(e),t.content().find("[data-field]").trigger("onShow")}).fail(function(e){t.updateContents(e.message)})},"{invite} click":function(e,i){EasySocial.dialog({content:t.view.loading(),width:400,heigth:150}),EasySocial.ajax("site/views/events/inviteFriendsDialog",{id:t.options.id}).done(function(e){EasySocial.dialog({content:e})})},"{unpublish} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/events/unpublishEventDialog",{id:t.options.id})})},"{delete} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/events/deleteEventDialog",{id:t.options.id})})}}}),t.resolve()})}),EasySocial.module("site/explorer",function(e){var t=this;e.template("explorer/folder",'<div class="fd-explorer-folder" data-id="[%== data.id %]">[%== data.name %]<a href="javascript: void(0);" class="fd-folder-remove-button" data-fd-explorer-delete-folder-button><i class="ies-cancel-2"></i></a></div>'),e.template("explorer/fileGroup",'<div class="fd-explorer-file-group" data-folder="[%== data.id %]" data-plupload-dropsite></div>'),e.template("explorer/file",'<div class="fd-explorer-file" data-id="[%== data.id %]">[%== data.name %]</div>'),EasySocial.require().script("site/explorer/uploader").done(),e.Controller("Explorer",{pluginName:"explorer",hostname:"explorer",defaultOptions:{view:{folder:"explorer/folder",fileGroup:"explorer/fileGroup",file:"explorer/file"},layout:{fileItemHeight:52},uid:null,type:null,disableValidation:!1,mockError:!1,controllerName:null,"{browser}":".fd-explorer-browser","{viewport}":".fd-explorer-viewport","{folderGroup}":".fd-explorer-folder-group","{folder}":".fd-explorer-folder","{fileGroup}":".fd-explorer-file-group","{file}":".fd-explorer-file","{button}":"[data-fd-explorer-button]","{mockError}":"[name=mock_error]","{disableValidation}":"[name=disable_validation]","{fileInput}":"[name=file]","{logs}":"[data-alertlog]","{togglefunky}":".togglefunky","{funky}":".fd-explorer-funky","{serviceState}":".service-state","{selectAllCheckbox}":"[data-fd-explorer-select-all]","{selectCheckbox}":"[data-fd-explorer-select]","{deleteButton}":"[data-fd-explorer-delete-button]","{deleteFolderButton}":"[data-fd-explorer-delete-folder-button]"}},function(t,i,n){return{init:function(){t.options.type=t.element.data("type"),t.options.uid=t.element.data("uid"),t.options.controllerName=t.element.data("controller-name"),e.module("easysocial/site/explorer/uploader").done(function(e){t.addPlugin("uploader",e)}),t.services.getFolders().done(function(e){t.insertFolder(e),t.folder(":first").click()}),t.viewport().on("scroll",e.debounce(t.viewportScroll,250))},baseParams:function(){return{uid:n.data("uid"),type:n.data("type")}},exception:function(i){var n=t.logs();switch(e.isPlainObject(i)||(i={message:i,type:"error"}),i.type){case"error":n.switchClass("alert-error").html(i.message),EasySocial.debug&&console.error(i.message);break;case"warning":n.switchClass("alert-warning").html(i.message),EasySocial.debug&&console.warn(i.message);break;case"success":n.switchClass("alert-success").html(i.message),EasySocial.debug&&console.log(i.message);break;case"info":default:n.switchClass("alert-info").html(i.message),EasySocial.debug&&console.log(i.message)}return i},library:{file:{},folder:{}},data:function(e,i){return t.library[e][i]},addData:function(i,n){if(e.isPlainObject(n)&&(n=[n]),!e.isArray(n))return t.exception("Unable to add "+i+" to library due to invalid data given.");e.each(n,function(n){e.isPlainObject(this)||t.exception("Skipping invalid "+i+" data at index "+n+"."),null===this.id&&(this.id=0),t.library[i][this.id]=this})},removeData:function(e,i){delete t.library[e][i]},"{folder} click":function(e){t.activateFolder(e.data("id"))},currentFolder:function(){return t.folder(".is-active").data("id")},activateFolder:function(e){var i=t.folder().filterBy("id",e),n=t.data("folder",e);i.length<1||(t.deactivateFolder(t.folder(".is-active").data("id")),i.addClass("is-active"),t.trigger("folderActivate",[e,i,n]))},deactivateFolder:function(e){var i=t.folder().filterBy("id",e),n=i.data("folder");i.length<1||(i.removeClass("is-active"),t.trigger("folderDeactivate",[e,i,n]))},selectedFolder:function(){return t.currentFolder()},"{file} click":function(e,i){i.metaKey||i.ctrlKey||t.deselectAllFiles(),t.toggleFile(e.data("id"))},toggleFile:function(e){var i=t.file().filterBy("id",e),n=i.hasClass("is-selected")?"deselectFile":"selectFile";i.length<1||t[n](e)},selectFile:function(e){var i=t.file().filterBy("id",e),n=t.data("file",e);i.length<1||(i.addClass("is-selected"),t.trigger("fileSelect",[e,i,n]))},deselectFile:function(e){var i=t.file().filterBy("id",e),n=i.data("file",e);i.length<1||(i.removeClass("is-selected"),t.trigger("fileDeselect",[e,i,n]))},selectAllFiles:function(){t.file(":not(.is-selected)").each(function(){t.selectFile(e(this).data("id"))})},deselectAllFiles:function(){t.file(".is-selected").each(function(){t.deselectFile(e(this).data("id"))})},selectedFile:function(){return t.selectedFiles()[0]},selectedFiles:function(){var i,n=[];return(i=t.file(".is-checked")).length<1&&(i=t.file(".is-selected")),i.each(function(){var t=e(this).data("id");n.push(t)}),n},insertFolder:function(i){e.isArray(i)||(i=[i]);var n=i[0];if(!e.isPlainObject(n))return t.exception("Invalid folder data given to be inserted into the folder group.");var o=t.folderGroup();if(o.length<1)return t.exception("Could not locate folder group element.");var a="";e.each(i,function(){null===this.id&&(this.id=0),a+=t.view.folder(!0,{data:this})}),a=e.buildHTML(a).appendTo(o),t.trigger("folderInsert",[a,i])},prependFile:function(i){if(!e.isPlainObject(i))return t.exception("Invalid file data given to be inserted.");var n=t.fileGroup().filterBy("folder",i.folder);if(n.length<1)return t.exception("Could not locate file group element for folder id "+i.folder+".");var o=i.html||t.view.file(!0,{data:i});e.buildHTML(o).data("finalized",!0).prependTo(n)},insertFile:function(i,n){if(e.isArray(i)||(i=[i]),void 0===n){var o=i[0];if(!e.isPlainObject(o))return t.exception("Invalid file data given to be inserted.");n=o.folder}if(t.fileGroup().filterBy("folder",n).length<1)return t.exception("Could not locate file group element for folder id "+i.folder+".");var a=[];e.each(i,function(){var i=this;t.file().filterBy("id",this.id).each(function(){var n=e(this);if(!n.data("finalized")){var o=e.buildHTML(i.html||t.view.file(!0,{data:i})).data("finalized",!0);n.replaceWith(o)}})}),t.trigger("fileInsert",[a,i])},removeFolder:function(e){var i,n=t.folder().filterBy("id",e);n.length<1&&(i=t.exception("Could not locate to remove folder element for folder id "+e+".")),n.remove();var o=t.fileGroup().filterBy("folder",e);o.length<1&&(i=t.exception("Could not locate to remove file group element for folder id "+e+".")),o.remove(),t.trigger("folderRemove",[e,i])},removeFile:function(e){var i,n=t.file().filterBy("id",e);n.length<1&&(i=t.exception("Could not locate to remove file element for file id "+e+".")),n.remove(),t.trigger("fileRemove",[e,i])},service:function(o,a,r){t.serviceState().switchClass("state-busy");var s=EasySocial.ajax(n.data("url"),e.extend({hook:o,error:i.mockError},a),r).always(function(){t.serviceState().switchClass("state-idle")}).fail(function(e){t.exception(e)});return t.trigger("serviceRequest",[o,s,a]),s},"{button} click":function(e){var i=e.attr("data-fd-explorer-button"),n=t.services[i];n&&n()},services:{getFolders:function(i){var n={start:0,limit:100};return t.service("getFolders",e.extend(t.baseParams(),n,i)).done(function(e){t.addData("folder",e)})},addFolder:function(n){n||(n={name:prompt(e.language("COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME"))});var o={name:""};if((n=e.extend(t.baseParams(),o,n)).name||i.disableValidation)return t.service("addFolder",n).done(function(e){t.addData("folder",e),t.insertFolder(e)});t.exception({message:e.language("COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME"),type:"error"})},removeFolder:function(n){var o={id:t.selectedFolder()};{if(i.disableValidation||void 0!==t.selectedFolder())return t.service("removeFolder",e.extend(t.baseParams(),o,n)).done(function(e){t.removeFolder(e)});t.exception("No folder selected")}},getFiles:function(i){var n={start:0,limit:100};return t.service("getFiles",e.extend(t.baseParams(),n,i)).done(function(e){t.addData("file",e)})},addFile:function(n){var o={id:t.currentFolder(),files:t.fileInput()};{if(i.disableValidation||t.fileInput().val())return t.service("addFile",e.extend(t.baseParams(),o,n),{type:"iframe"}).done(function(e){console.log("Upload returned data:",e),t.addData("file",e),t.prependFile(e),t.exception({message:"Added file "+e.name,type:"success"})});t.exception("No file chosen yet.")}},removeFile:function(n){var o={id:t.selectedFiles()},n=e.extend(t.baseParams(),o,n);if(!(!i.disableValidation&&e.isArray(n.id)&&n.length<1))return t.service("removeFile",n).done(function(i){e.isArray(i)?e.each(i,function(){t.removeFile(this)}):t.removeFile(i),t.selectAllCheckbox().prop("checked",!1)});t.exception("No file selected")},useFile:function(){var e=t.selectedFile(),i=t.file().filterBy("id",e),n=t.data("file",e);i.length<1||t.trigger("fileUse",[e,i,n])},previewFile:function(){var e=t.selectedFile(),i=t.file().filterBy("id",e),n=(t.data("file",e),i.data("previewUri"));n&&window.open(n,"_blank")}},"{self} folderActivate":function(e,i,n,o,a){var r=t.fileGroup(),s=r.filterBy("folder",n);if(r.removeClass("is-active"),s.length<1){a.map||(a.map=[]);var l='<div class="fd-explorer-file" data-id="'+a.map.join('">&nbsp;</div><div class="fd-explorer-file" data-id="')+'">&nbsp;</div>';s=t.view.fileGroup({data:a}).html(l).appendTo(t.viewport()),t.services.getFiles({id:n}).done(function(e){t.insertFile(e,n)})}s.addClass("is-active")},viewportScroll:function(){var e=t.viewport()[0],i=(t.viewport().height(),e.scrollHeight,e.scrollTop),n=t.file(":nth(2)").outerHeight(!0),o=Math.floor(i/n),a=t.fileGroup(".is-active").data("folder");t.services.getFiles({id:a,start:o-3}).done(function(e){t.insertFile(e,a)}).always(function(){})},"{togglefunky} click":function(){t.funky().toggle()},"{disableValidation} change":function(e){i.disableValidation=!!e.prop("checked"),t.exception({message:"Client-side validation is "+(i.disableValidation?"OFF!":"ON!"),type:"info"})},"{mockError} change":function(e){i.mockError=!!e.prop("checked"),t.exception({message:"Error mocking is "+(i.mockError?"ON!":"OFF!"),type:"info"})},"{selectAllCheckbox} click":function(e){var i=e.prop("checked");t.fileGroup(".is-active").find(t.selectCheckbox.selector).prop("checked",i).trigger("change")},"{selectCheckbox} change":function(e){var i=t.file.of(e),n=(i.data("id"),e.prop("checked"));i.toggleClass("is-checked",n)},"{deleteButton} click":function(e){var i=t.file.of(e).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/explorer/confirmDeleteFile",{id:i}),bindings:{"{deleteButton} click":function(){EasySocial.dialog().close(),t.services.removeFile({id:i})}}})},"{deleteFolderButton} click":function(e,i){i.preventDefault();var n=t.folder.of(e).data("id");0!==n&&EasySocial.dialog({content:EasySocial.ajax("site/views/explorer/confirmDeleteFolder",{id:n}),bindings:{"{deleteButton} click":function(){EasySocial.dialog().close(),t.services.removeFolder({id:n})}}})}}}),EasySocial.require().language("COM_EASYSOCIAL_EXPLORER_ENTER_FOLDER_NAME","COM_EASYSOCIAL_EXPLORER_INVALID_FOLDER_NAME").done(function(){t.resolve()})}),EasySocial.module("site/explorer/uploader",function(e){var t=this;e.require().library("plupload").done(function(){var i=e.Controller("Explorer/Uploader",{defaultOptions:{settings:{},"{uploadItemGroup}":"[data-fd-explorer-upload-item-group]","{uploadItem}":"[data-fd-explorer-upload-item]"}},function(t,i,n){return{init:function(){n.plupload(i.settings),t.plupload=n.plupload("controller").plupload},settings:function(e,i){var n=t.plupload.settings;return void 0!==i&&(n[e]=i),e?n[e]:n},"{self} folderActivate":function(e,t,i,n,o){},"{self} BeforeUpload":function(i,o,a,r){var s=e.uri(EasySocial.ajaxUrl).addQueryParam("controller",t.explorer.options.controllerName).addQueryParam("task","explorer").addQueryParam("id",t.explorer.currentFolder()).addQueryParam("no_html",1).addQueryParam("format","json").addQueryParam("hook","addFile").addQueryParam("tmpl","component").addQueryParam("uid",n.data("uid")).addQueryParam("type",n.data("type")).addQueryParam(EasySocial.token(),1).toString();t.settings("url",s)},"{self} FilesAdded":function(e,i,n,o){t.plupload.start()},"{self} UploadFile":function(){clearTimeout(t.loadTimer),n.addClass("is-loading")},"{self} FileUploaded":function(i,o,a,r,s){t.loadTimer=setTimeout(function(){n.removeClass("is-loading")},1e3);var l=t.explorer;e.isPlainObject(s)?(l.addData("file",s),l.prependFile(s)):t.setMessage("Server did not return proper data after uploading.","error")},"{self} FileError":function(i,o,a,r,s){n.removeClass("is-loading"),e.isPlainObject(s)&&t.setMessage(s.message,"error")},"{self} Error":function(e,i,o,a){n.removeClass("is-loading"),t.setMessage(a.message,"error")}}});t.resolve(i)})}),EasySocial.module("site/explorer/popup",function(e){var t=this;EasySocial.require().view("site/explorer/popup").done(function(){e.Controller("Explorer/Popup",{defaultOptions:{view:{popup:"easysocial/site/explorer/popup"},"{popup}":"[data-explorer-popup]","{viewport}":"[data-popup-viewport]","{explorer}":"[data-explorer-popup] .fd-explorer","{closeButton}":".fd-explorer .close-button"}},function(t,i,n){return{init:function(){},"{window} resize":e.debounce(function(){},100),show:function(){var i,o=t.popup.node;o||(i=t.view.popup(),o=t.popup.node=i[0]),e.contains(n,o)||(i=e(o).appendTo(n)),i.is(":visible")||i.show().trigger("show")},hide:function(){t.popup().hide().trigger("hide").detach()},open:function(i){t.show();var n=e.Deferred(),o=t.explorer();return o.length>0&&o.data("uid")===i.uid&&o.data("type")===i.type?n.resolve(o.explorer("controller"),t):(EasySocial.ajax("site/views/explorer/browser",i).done(function(i){var o=e.buildHTML(i);t.viewport().empty().append(o);var a=o.filter(".fd-explorer").explorer("controller");n.resolve(a,t)}).fail(function(){n.reject()}),n)},"{self} click":function(e,i){i.target===t.popup()[0]&&t.hide()},"{closeButton} click":function(){t.hide()}}});var i=EasySocial.explorer=e("body").addController("Explorer/Popup");t.resolve(i)})}),EasySocial.module("site/followers/followers",function(e){var t=this;EasySocial.require().view("site/loading/small").script("site/conversations/composer").done(function(e){EasySocial.Controller("Followers",{defaultOptions:{"{content}":"[data-followers-content]","{filter}":"[data-followers-filter]","{items}":"[data-followers-item]","{followingCounter}":"[data-following-count]",view:{loader:"site/loading/small"}}},function(e){return{init:function(){e.initItemController()},initItemController:function(){e.items().implement(EasySocial.Controller.Followers.Item,{"{parent}":e})},updateFollowingCounter:function(t){var i=e.followingCounter().html(),n=parseInt(i)+t;e.followingCounter().html(n)},updateContents:function(t){e.content().replaceWith(t)},"{filter} click":function(t,i){var n=t.data("followers-filter-type"),o=t.data("followers-filter-title"),a=t.data("followers-filter-id"),r=t.data("followers-filter-url");e.filter().removeClass("active"),t.addClass("active"),History.pushState({state:1},o,r),EasySocial.ajax("site/controllers/followers/filter",{id:a,type:n}).done(function(t){e.updateContents(t),e.initItemController()})}}}),EasySocial.Controller("Followers.Item",{defaultOptions:{"{unfollowButton}":"[data-followers-item-unfollow]","{composer}":"[data-followers-item-compose]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.initComposer()},initComposer:function(){e.composer().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:e.options.id}})},"{unfollowButton} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/followers/confirmUnfollow",{id:e.options.id}),bindings:{"{unfollowButton} click":function(){EasySocial.ajax("site/controllers/followers/unfollow",{id:e.options.id}).done(function(){e.parent.updateFollowingCounter(-1),e.element.remove(),EasySocial.dialog().close()})}}})}}}),t.resolve()})}),EasySocial.module("site/friends/friends",function(e){var t=this;EasySocial.require().script("site/friends/list","site/friends/item","site/friends/suggest","site/conversations/composer").view("site/loading/small","site/friends/default.empty","site/friends/list.assign").done(function(e){EasySocial.Controller("Friends.Birthday",{defaultOptions:{"{messageButton}":"[data-upcoming-birthday-message-button]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.name=e.element.data("name"),e.options.avatar=e.element.data("avatar"),e.messageButton().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:e.options.id,name:e.options.name,avatar:e.options.avatar}})}}}),EasySocial.Controller("Friends",{defaultOptions:{activeList:null,"{friendList}":"[data-friends-list]","{content}":"[data-friends-content]","{friendItems}":"[data-friends-items]","{friendItem}":"[data-friends-item]","{emptyList}":"[data-friends-emptyItems]","{activeTitle}":"[data-friends-activeTitle]","{filterItem}":"[data-friends-filter]","{friendListActions}":"[data-friendList-actions]","{addFriendToList}":"[data-friends-add]","{friendsCounter}":"[data-total-friends]","{pendingCounter}":"[data-total-friends-pending]","{suggestionCounter}":"[data-total-friends-suggestion]","{requestCount}":"[data-frields-request-sent-count]",view:{loader:"site/loading/small",emptyFriendItems:"site/friends/default.empty",addUserForm:"site/friends/list.assign"}}},function(t){return{init:function(){t.friendList().implement(EasySocial.Controller.Friends.List,{"{parent}":t}),t.initFriendItems()},initFriendItems:function(){t.friendListActions().implement(EasySocial.Controller.Friends.List.Actions,{"{parent}":t}),t.friendItem().implement(EasySocial.Controller.Friends.Item,{"{parent}":t})},updateFriendsCounter:function(){EasySocial.ajax("site/controllers/friends/getCounters").done(function(e,i,n,o){t.friendsCounter().html(e),t.pendingCounter().html(i),t.requestCount().html(n),t.suggestionCounter().html(o)})},updateListCounters:function(){EasySocial.ajax("site/controllers/friends/getListCounts",{}).done(function(t){e(t).each(function(t,i){e("[data-list-"+i.id+"]").controller().updateCounter(i.count)})})},insertItem:function(i){t.emptyList().hide(),t.updateListCounters(),e(i).implement(EasySocial.Controller.Friends.Item,{"{parent}":t}).prependTo(t.friendItems())},removeItem:function(e){t.friendItem("[data-friendItem-"+e+"]").remove(),t.friendItem().length<=0&&t.emptyList().show(),t.updateListCounters()},updateFriendRequestCount:function(e){curCount=parseInt(t.requestCount().text(),10),NaN!=curCount&&(curCount+=e,t.requestCount().text(curCount))},updateContent:function(e){t.content().replaceWith(e),t.initFriendItems()},removeActiveFilter:function(){t.filterItem().removeClass("active")},"{filterItem} click":function(e,i){var n=e.data("filter"),o=e.data("title"),a=e.data("userid"),r=e.data("url");t.friendList().length>0&&t.friendList().controller().removeActiveList(),t.filterItem().removeClass("active"),e.addClass("active"),History.pushState({state:1},o,r),e.addClass("loading"),EasySocial.ajax("site/controllers/friends/filter",{filter:n,userid:a}).done(function(e){t.updateContent(e)}).always(function(){e.removeClass("loading")})}}}),t.resolve()})}),EasySocial.module("site/friends/list",function(e){var t=this;EasySocial.require().view("site/loading/small").library("history").script("site/friends/suggest").done(function(e){EasySocial.Controller("Friends.List",{defaultOptions:{parent:null,"{item}":"[data-friends-listItem]","{items}":"[data-friends-listItems]","{loadMoreButton}":".loadMoreButton","{loadMore}":".loadMore",view:{loader:"site/loading/small",items:"site/friends/default.lists"}}},function(t){return{init:function(){t.item().implement(EasySocial.Controller.Friends.List.Item,{"{parent}":t})},removeActiveList:function(){t.item().removeClass("active")},setDefault:function(e){t.item().removeClass("default"),t.item(".item-"+e).addClass("default")},"{item} click":function(i){var n=e(i).data("title"),o=e(i).data("url");History.pushState({state:1},n,o),t.parent.removeActiveFilter(),t.item().removeClass("active"),t.item(i).addClass("active");var a=e(i).data("id");t.parent.options.activeList=a,EasySocial.ajax("site/controllers/friends/getListFriends",{id:a},{beforeSend:function(){e(i).addClass("loading")}}).done(function(n){e(i).removeClass("loading"),t.parent.updateContent(n)})},"{loadMoreButton} click":function(){var e=t.loadMoreButton().data("limitstart");t.loadMore().html(t.view.loader()),EasySocial.ajax("site/controllers/friends/getLists",{limitstart:e}).done(function(e){t.loadMore().hide(),t.view.items({items:e}).appendTo(t.items())})}}}),EasySocial.Controller("Friends.List.Item",{defaultOptions:{id:null,"{counter}":"[data-list-counter]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},updateCounter:function(t){e.counter().html(t)}}}),EasySocial.Controller("Friends.List.Actions",{defaultOptions:{"{delete}":"[data-friendListActions-delete]","{add}":"[data-friendListActions-add]","{default}":"[data-friendListActions-default]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.title=t.element.data("title"),t.options.userId=t.element.data("userid")},"{default} click":function(){EasySocial.ajax("site/controllers/friends/setDefault",{id:t.options.id}).done(function(){t.parent.friendList().controller().setDefault(t.options.id)})},"{add} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/assignList",{id:t.options.id}),bindings:{"{insertButton} click":function(){var i=this.suggest().textboxlist("controller").getAddedItems();EasySocial.ajax("site/controllers/friends/assign",{uid:e.pluck(i,"id"),userId:t.options.userId,listId:t.options.id}).done(function(i){e("[data-assignFriends-notice]").hide(),e(i).each(function(e,i){t.parent.insertItem(i),EasySocial.dialog().close()})}).fail(function(t){e("[data-assignFriends-notice]").addClass("alert alert-error").html(t.message)})}}})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmDeleteList",{id:t.options.id}),bindings:{"{deleteButton} click":function(){e("[data-friends-list-delete-form]").submit()}}})}}}),t.resolve()})}),EasySocial.module("site/friends/item",function(e){var t=this;EasySocial.require().script("site/conversations/composer").language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL","COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE","COM_EASYSOCIAL_FRIENDS_CANCEL_REQUEST_DIALOG_CANCELLED","COM_EASYSOCIAL_FRIENDS_REQUEST_SENT").done(function(e){EasySocial.Controller("Friends.Item",{defaultOptions:{id:null,name:null,friendId:null,"{removeFromList}":"[data-lists-removeFriend]","{unfriend}":"[data-friends-unfriend]","{addfriend}":"[data-friends-addfriend]","{block}":"[data-friends-block]","{message}":"[data-friendItem-message]","{reject}":"[data-friendItem-reject]","{approve}":"[data-friendItem-approve]","{addContainer}":"[data-friendItem-addbutton]","{addButton}":"[data-friendItem-add]","{cancelRequest}":"[data-friendItem-cancel-request]"}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.options.name=t.element.data("name"),t.options.friendId=t.element.data("friendid"),t.options.avatar=t.element.data("avatar"),t.initConversation()},"{addButton} click":function(i){EasySocial.ajax("site/controllers/friends/request",{id:t.options.id}).done(function(i){t.addContainer().html(e.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT")),t.addContainer().addClass("btn btn-es-success btn-sm mt-20")}).fail(function(e){EasySocial.dialog({width:450,height:180,content:e.message})})},initConversation:function(){t.message().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{name:t.options.name,id:t.options.id,avatar:t.options.avatar}})},"{removeFromList} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmRemoveFromList",{id:t.options.id}),bindings:{"{removeButton} click":function(){EasySocial.ajax("site/controllers/friends/removeFromList",{listId:t.parent.options.activeList,userId:t.options.id}).done(function(){t.parent.removeItem(t.options.id),EasySocial.dialog({title:"User removed from list",content:"The user has been removed from the list.",buttons:[{name:"Done",classNames:"btn btn-es",click:function(){EasySocial.dialog().close()}}]})}).fail(function(e){console.log(e)})}}})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmReject",{id:t.options.id}),bindings:{"{rejectButton} click":function(){EasySocial.ajax("site/controllers/friends/reject",{id:t.options.friendId}).done(function(){t.parent.removeItem(t.options.id),t.parent.updateFriendsCounter(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/friendRejected")})})}}})},"{unfriend} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmUnfriend",{id:t.options.id}),bindings:{"{unfriendButton} click":function(){EasySocial.ajax("site/controllers/friends/unfriend",{id:t.options.friendId}).done(function(){t.parent.removeItem(t.options.id),t.parent.updateFriendsCounter(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/friendRemoved",{id:t.options.id})})})}}})},"{cancelRequest} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmCancelRequest",{id:t.options.id}),bindings:{"{cancelRequestButton} click":function(){EasySocial.ajax("site/controllers/friends/cancelRequest",{id:t.options.friendId}).done(function(){t.parent.removeItem(t.options.id),t.parent.updateFriendRequestCount(-1),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/requestCancelled",{id:t.options.id})})})}}})},"{approve} click":function(e){EasySocial.ajax("site/controllers/friends/approve",{id:t.options.friendId}).done(function(){t.parent.updateFriendsCounter(),t.element.remove()})},"{addfriend} click":function(i){EasySocial.ajax("site/controllers/friends/request",{id:t.options.id}).done(function(i){t.parent.updateFriendRequestCount(1),EasySocial.dialog({title:e.language("COM_EASYSOCIAL_FRIENDS_REQUEST_DIALOG_TITLE"),content:e.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_PENDING_APPROVAL",t.options.name)}),t.parent.removeItem(t.options.id)}).fail(function(e){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")})})},"{block} click":function(){console.log("block")}}}),t.resolve()})}),EasySocial.module("site/groups/groups",function(e){var t=this;EasySocial.require().view("site/loading/small").script("validate","field").done(function(e){EasySocial.Controller("Groups.Browser",{defaultOptions:{"{filters}":"[data-es-groups-filters] > li","{categories}":"[data-es-groups-categories] >li","{content}":"[data-es-groups-content]","{items}":"[data-groups-item]","{featured}":"[data-groups-featured-item]",view:{loader:"site/loading/small"}}},function(t){return{init:function(){t.filters().implement(EasySocial.Controller.Groups.Filter,{"{parent}":t}),t.categories().implement(EasySocial.Controller.Groups.Filter.Category,{"{parent}":t}),t.featured().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":t}),t.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":t})},setActive:function(i){t.categories().removeClass("active"),t.filters().removeClass("active"),e(i).addClass("active"),t.content().html("&nbsp;"),t.element.addClass("loading")},setContent:function(e){t.element.removeClass("loading"),t.content().html(e),t.items().implement(EasySocial.Controller.Groups.Browser.Item,{"{parent}":t})}}}),EasySocial.Controller("Groups.Browser.Item",{defaultOptions:{"{joinGroup}":"[data-groups-item-join]","{respond}":"[data-groups-item-respond]","{setFeatured}":"[data-groups-item-set-featured]","{removeFeatured}":"[data-groups-item-remove-featured]","{deleteGroup}":"[data-groups-item-delete]","{unpublishGroup}":"[data-groups-item-unpublish]"}},function(t){return{init:function(){t.options.id=t.element.data("groups-item-id"),t.options.type=t.element.data("groups-item-type")},"{deleteGroup} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmDelete",{id:t.options.id})})},"{unpublishGroup} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmUnpublishGroup",{id:t.options.id})})},"{respond} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/respondInvitation",{id:t.options.id})})},"{setFeatured} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/setFeatured",{id:t.options.id})})},"{removeFeatured} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/removeFeatured",{id:t.options.id})})},"{joinGroup} click":function(i,n){"open"==t.options.type&&e(i).hide(),EasySocial.dialog({content:EasySocial.ajax("site/controllers/groups/joinGroup",{id:t.options.id})})}}}),EasySocial.Controller("Groups.Edit",{defaultOptions:{id:null,"{stepContent}":"[data-group-edit-fields-content]","{stepItem}":"[data-group-edit-fields-step]","{profileForm}":"[data-group-fields-form]","{profileContent}":"[data-group-edit-fields]","{fieldItem}":"[data-group-edit-fields-item]","{save}":"[data-group-fields-save]"}},function(t){return{init:function(){t.fieldItem().addController("EasySocial.Controller.Field.Base",{mode:"edit"})},errorFields:[],"{fieldItem} error":function(e,i){t.triggerStepError(e)},"{fieldItem} clear":function(e,i){t.clearStepError(e)},"{fieldItem} onError":function(e,i){t.triggerStepError(e)},triggerStepError:function(i){var n=i.data("id"),o=i.parents(t.stepContent.selector).data("id");e.inArray(n,t.errorFields)<0&&t.errorFields.push(n),t.stepItem().filterBy("for",o).trigger("error")},clearStepError:function(i){var n=i.data("id"),o=i.parents(t.stepContent.selector).data("id");t.errorFields=e.without(t.errorFields,n),t.stepItem().filterBy("for",o).trigger("clear")},"{stepItem} click":function(i,n){var o=e(i).data("for");t.profileContent().show(),t.stepContent().hide(),t.stepItem().removeClass("active"),i.addClass("active");var a=t.stepContent(".step-"+o);a.show(),a.find(t.fieldItem.selector).trigger("show")},"{stepItem} error":function(e){e.addClass("error")},"{stepItem} clear":function(e){t.errorFields.length<1&&e.removeClass("error")},"{save} click":function(e,i){return i.preventDefault(),e.addClass("btn-loading"),t.profileForm().validate().fail(function(){e.removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}).done(function(){t.profileForm().submit()}),!1}}}),EasySocial.Controller("Groups.Filter",{defaultOptions:{}},function(t){return{init:function(){},"{self} click":function(i,n){n.preventDefault(),t.parent.setActive(i),e(i).find("a").route(),EasySocial.ajax("site/controllers/groups/getGroups",{filter:t.element.data("es-groups-filters-type")}).done(function(e){t.parent.setContent(e)})}}}),EasySocial.Controller("Groups.Filter.Category",{defaultOptions:{id:null}},function(t){return{init:function(){t.options.id=t.element.data("es-groups-category-id")},"{self} click":function(i,n){n.preventDefault(),t.parent.setActive(i),e(i).find("a").route(),EasySocial.ajax("site/controllers/groups/getGroups",{categoryId:t.options.id}).done(function(e){t.parent.setContent(e)})}}}),EasySocial.Controller("Groups.Create",{defaultOptions:{previousLink:null,"{fieldItem}":"[data-groups-create-fields-item]","{previousButton}":"[data-groups-create-previous]","{nextButton}":"[data-groups-create-submit]"}},function(e){return{init:function(){e.fieldItem().addController("EasySocial.Controller.Field.Base")},"{previousButton} click":function(){window.location=e.options.previousLink},"{nextButton} click":function(t){t.enabled()&&(t.disabled(!0),t.addClass("btn-loading"),e.element.validate().done(function(){t.removeClass("btn-loading"),t.enabled(!0),e.element.submit()}).fail(function(){t.removeClass("btn-loading"),t.enabled(!0),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}))}}}),t.resolve()})}),EasySocial.module("site/groups/item",function(e){var t=this;EasySocial.template("info/item",'<li data-es-group-filter><a class="ml-20" href="[%= url %]" title="[%= title %]" data-info-item data-info-index="[%= index %]"><i class="ies-info ies-small mr-5"></i> [%= title %]</a></li>'),EasySocial.require().script("site/friends/suggest").library("history").done(function(e){EasySocial.Controller("Groups.Item",{defaultOptions:{"{content}":"[data-es-group-item-content]","{apps}":"[data-es-group-item-app]","{filters}":"[data-es-group-filter]","{filterStream}":"[data-es-group-stream]","{appFilter}":"[data-es-group-app-filter]","{appFilterShowAll}":"[data-app-filters-showall]","{filterBtn}":"[data-stream-filter-button]","{filterEditBtn}":"[data-dashboardFeeds-Filter-edit]","{saveHashTag}":"[data-hashtag-filter-save]","{filterUL}":"[data-es-group-ul]","{joinGroup}":"[data-es-group-join]","{leaveGroup}":"[data-es-group-leave]","{invite}":"[data-es-group-invite]","{respond}":"[data-es-group-respond]","{withdraw}":"[data-es-group-withdraw]","{info}":"[data-info]","{infoItem}":"[data-info-item]",view:{infoItem:"info/item"}}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.apps().implement(EasySocial.Controller.Groups.Item.App,{"{parent}":t,groupId:t.options.id})},setActive:function(e){t.filters().removeClass("active"),e.parent().addClass("active")},setLoading:function(e){t.content().html(""),t.element.addClass("loading")},updateContents:function(e){t.element.removeClass("loading"),t.content().html(e)},"{appFilterShowAll} click":function(e,i){e.hide(),t.filters().removeClass("hide")},"{filterEditBtn} click":function(e,i){i.preventDefault(),e.route(),t.setLoading(),t.setActive(e),EasySocial.ajax("site/controllers/groups/getFilter",{id:e.data("id"),clusterId:t.options.id}).done(function(e){t.updateContents(e)}).fail(function(e){return e}).always(function(){})},"{filterBtn} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading(),EasySocial.ajax("site/controllers/groups/getFilter",{id:0,clusterId:t.options.id}).done(function(e){t.updateContents(e)}).fail(function(e){return e}).always(function(){})},"{appFilter} click":function(e,i){i.preventDefault();var n=e.data("url"),o=e.data("title");History.pushState({state:1},o,n),t.setActive(e),t.setLoading(),t.setActive(e);var a=e.data("id");EasySocial.ajax("site/controllers/groups/getStream",{id:t.options.id,app:a,view:"groups"}).done(function(e){t.updateContents(e)})},"{filterStream} click":function(i,n){n.preventDefault(),t.setActive(i),i.route();var o=e("[data-dashboardSidebar-menu].active").data("fid");EasySocial.ajax("site/controllers/groups/getStream",{id:t.options.id,filterId:o,view:"groups"}).done(function(e){t.updateContents(e)})},"{saveHashTag} click":function(i){var n=i.data("tag"),o=i.data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmSaveFilter",{tag:n}),bindings:{"{saveButton} click":function(){this.inputWarning().hide(),filterName=this.inputTitle().val(),""!=filterName?EasySocial.ajax("site/controllers/groups/addFilter",{title:filterName,tag:n,id:o}).done(function(i,n){var o=e.buildHTML(i);t.filterUL().append(o),EasySocial.dialog(n),setTimeout(function(){EasySocial.dialog().close()},2e3)}):this.inputWarning().show()}}})},"{withdraw} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmWithdraw",{id:t.options.id})})},"{invite} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/inviteFriends",{id:t.options.id})})},"{respond} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/respondInvitation",{id:t.options.id})})},"{joinGroup} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/controllers/groups/joinGroup",{id:t.options.id})})},"{leaveGroup} click":function(e,i){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmLeaveGroup",{id:t.options.id})})},"{info} click":function(i,n){n.preventDefault(),i.route(),t.setActive(i),t.setLoading(),i.data("loaded")?t.infoItem().eq(0).trigger("click"):i.enabled()&&(i.disabled(!0),EasySocial.ajax("site/controllers/groups/initInfo",{groupId:t.options.id}).done(function(n){i.data("loaded",1);var o=i.parent("[data-es-group-filter]");e.each(n.reverse(),function(e,i){i.hide||o.after(t.view.infoItem({url:i.url,title:i.title,index:i.index})),i.html&&(t.updateContents(i.html),t.content().find("[data-field]").trigger("onShow"))});var a=t.infoItem().eq(0);t.setActive(a),e(document).prop("title",a.attr("title")),i.enabled(!0)}).fail(function(e){i.enabled(!0),t.updateContents(e.message)}))},"{infoItem} click":function(e,i){i.preventDefault(),e.route(),t.setActive(e),t.setLoading();var n=e.data("info-index");EasySocial.ajax("site/controllers/groups/getInfo",{groupId:t.options.id,index:n}).done(function(e){t.updateContents(e),t.content().find("[data-field]").trigger("onShow")}).fail(function(e){t.updateContents(e.message)})}}}),EasySocial.Controller("Groups.Item.App",{defaultOptions:{}},function(e){return{init:function(){e.options.id=e.element.data("app-id")},"{self} click":function(t,i){i.preventDefault(),t.route(),e.parent.setActive(t),e.parent.setLoading(),EasySocial.ajax("site/controllers/groups/getAppContents",{appId:e.options.id,groupId:e.options.groupId}).done(function(t){e.parent.updateContents(t)}).fail(function(e){return e})}}}),EasySocial.Controller("Groups.Item.Members",{defaultOptions:{"{items}":"[data-group-members-item]","{filters}":"[data-group-members-filter]","{content}":"[data-group-members-content]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.items().implement(EasySocial.Controller.Groups.Item.Members.Record)},"{filters} click":function(t,i){e.filters().removeClass("active"),t.addClass("active");var n=t.data("filter");e.content().html("&nbsp;"),e.content().addClass("is-loading"),EasySocial.ajax("apps/group/members/controllers/groups/filterMembers",{id:e.options.id,filter:n}).done(function(t){e.content().removeClass("is-loading"),e.content().html(t),e.items().implement(EasySocial.Controller.Groups.Item.Members.Record)})}}}),EasySocial.Controller("Groups.Item.Members.Record",{defaultOptions:{"{makeAdmin}":"[data-members-make-admin]","{revokeAdmin}":"[data-members-revoke-admin]","{approve}":"[data-members-approve]","{reject}":"[data-members-reject]","{removeMember}":"[data-members-remove]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.groupId=e.element.data("groupid")},"{approve} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmApprove",{id:e.options.groupId,userId:e.options.id})})},"{reject} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmReject",{id:e.options.groupId,userId:e.options.id})})},"{revokeAdmin} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmRevokeAdmin",{id:e.options.groupId,userId:e.options.id}),bindings:{"{revokeButton} click":function(){EasySocial.ajax("site/controllers/groups/revokeAdmin",{id:e.options.groupId,userId:e.options.id}).done(function(){EasySocial.dialog().close(),e.element.removeClass("is-admin").addClass("is-member")})}}})},"{removeMember} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmRemoveMember",{id:e.options.groupId,userId:e.options.id})})},"{makeAdmin} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/groups/confirmMakeAdmin",{id:e.options.id}),bindings:{"{makeAdminButton} click":function(){EasySocial.ajax("site/controllers/groups/makeAdmin",{id:e.options.groupId,userId:e.options.id}).done(function(){EasySocial.dialog().close(),e.element.removeClass("is-member").addClass("is-admin")})}}})}}}),EasySocial.Controller("Groups.Item.Discussions",{defaultOptions:{"{filter}":"[data-group-discussions-filter]","{contents}":"[data-group-discussion-contents]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},setContent:function(t){e.contents().removeClass("is-loading"),e.contents().html(t)},setActiveFilter:function(t){e.filter().removeClass("active"),t.addClass("active")},"{filter} click":function(t,i){var n=t.data("filter");e.contents().html("&nbsp;").addClass("is-loading"),e.setActiveFilter(t),EasySocial.ajax("apps/group/discussions/controllers/discussion/getDiscussions",{id:e.options.id,filter:n}).done(function(t,i){i?e.contents().addClass("is-empty"):e.contents().removeClass("is-empty"),e.setContent(t)})}}}),EasySocial.Controller("Groups.Item.Discussion",{defaultOptions:{"{form}":"[data-reply-form]","{list}":"[data-reply-list]","{replies}":"[data-reply-item]","{repliesWrap}":"[data-replies-wrapper]","{replyCounter}":"[data-reply-count]","{lock}":"[data-discussion-lock]","{unlock}":"[data-discussion-unlock]","{delete}":"[data-discussion-delete]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.groupId=e.element.data("groupid"),e.implementReply(e.replies()),e.form().implement(EasySocial.Controller.Groups.Item.Discussion.Form,{"{parent}":e})},implementReply:function(){e.replies().implement(EasySocial.Controller.Groups.Item.Discussion.Reply,{"{parent}":e})},insertReply:function(t){e.element.removeClass("is-unanswered"),e.repliesWrap().removeClass("is-empty"),e.list().append(t),e.implementReply()},updateReplyCounter:function(t){0==t&&e.repliesWrap().addClass("is-empty"),e.replyCounter().html(t)},setResolved:function(){e.element.addClass("is-resolved")},"{unlock} click":function(t,i){EasySocial.ajax("apps/group/discussions/controllers/discussion/unlock",{id:e.options.id}).done(function(){e.element.removeClass("is-locked")})},"{delete} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("apps/group/discussions/controllers/discussion/confirmDelete",{id:e.options.id,groupId:e.options.groupId})})},"{lock} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("apps/group/discussions/controllers/discussion/confirmLock"),bindings:{"{lockButton} click":function(){EasySocial.ajax("apps/group/discussions/controllers/discussion/lock",{id:e.options.id}).done(function(){EasySocial.dialog().close(),e.element.addClass("is-locked")})}}})}}}),EasySocial.Controller("Groups.Item.Discussion.Reply",{defaultOptions:{"{acceptAnswer}":"[data-reply-accept-answer]","{delete}":"[data-reply-delete]","{edit}":"[data-reply-edit]","{cancelEdit}":"[data-reply-edit-cancel]","{update}":"[data-reply-edit-update]","{textarea}":"[data-reply-content]","{content}":"[data-reply-display-content]","{alertDiv}":"div.alert-error"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{acceptAnswer} click":function(){EasySocial.ajax("apps/group/discussions/controllers/reply/accept",{id:e.options.id}).done(function(){e.parent.setResolved()})},cancelEditing:function(){e.element.removeClass("is-editing")},"{cancelEdit} click":function(){e.cancelEditing()},"{edit} click":function(){e.element.addClass("is-editing")},"{update} click":function(){var t=e.textarea().val();if(""==t)return e.element.addClass("is-empty"),e.alertDiv().show(),!1;EasySocial.ajax("apps/group/discussions/controllers/reply/update",{id:e.options.id,content:t}).done(function(t){e.content().html(t),e.element.removeClass("is-empty"),e.alertDiv().hide(),e.cancelEditing()})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("apps/group/discussions/controllers/reply/confirmDelete",{id:e.options.id}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("apps/group/discussions/controllers/reply/delete",{id:e.options.id}).done(function(t){e.parent.updateReplyCounter(t.total_replies),EasySocial.dialog().close(),e.element.remove()})}}})}}}),EasySocial.Controller("Groups.Item.Discussion.Form",{defaultOptions:{"{textarea}":"[data-reply-content]","{submitReply}":"[data-reply-submit]"}},function(e){return{init:function(){},"{submitReply} click":function(t,i){var n=e.textarea().val();if(""==n)return e.element.addClass("is-empty"),!1;EasySocial.ajax("apps/group/discussions/controllers/reply/submit",{id:e.parent.options.id,groupId:e.parent.options.groupId,content:n}).done(function(t){e.parent.insertReply(t),e.textarea().val("")})}}}),EasySocial.Controller("Groups.Item.News",{defaultOptions:{"{delete}":"[data-news-delete]","{likes}":"[data-likes-action]","{counter}":"[data-news-counter]","{likeContent}":"[data-likes-content]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.groupId=e.element.data("group-id")},"{likes} onLiked":function(t,i,n){e.counter().removeClass("hide")},"{likes} onUnliked":function(t,i,n){e.likeContent().hasClass("hide")&&e.counter().addClass("hide")},"{delete} click":function(t,i){EasySocial.dialog({content:EasySocial.ajax("apps/group/news/controllers/news/confirmDelete",{id:e.options.id,groupId:e.options.groupId})})}}}),t.resolve()})}),EasySocial.module("site/notifications/list",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("NotificationsList",{defaultOptions:{"{item}":"[data-notifications-list-item]","{list}":"[data-notifications-list]","{allread}":"[data-notification-all-read]","{allclear}":"[data-notification-all-clear]","{notiLoadMoreBtn}":"[data-notification-loadmore-btn]"}},function(t){return{init:function(){t.item().implement(EasySocial.Controller.NotificationsList.Item,{"{parent}":t})},"{allread} click":function(){EasySocial.ajax("site/controllers/notifications/setAllState",{state:"read"}).done(function(){t.item().removeClass("is-read is-hidden is-unread").addClass("is-read")})},"{allclear} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/notifications/clearAllConfirm"),bindings:{"{clearButton} click":function(){EasySocial.ajax("site/controllers/notifications/setAllState",{state:"clear"}).done(function(){t.item().removeClass("is-read is-hidden is-unread is-read").addClass("is-remove"),EasySocial.dialog().close()})}}})},"{notiLoadMoreBtn} click":function(i,n){var o=e(i).data("startlimit");o<0||EasySocial.ajax("site/controllers/notifications/loadmore",{startlimit:o}).done(function(n,o){e(i).data("startlimit",o),console.log(o),n.length>0&&(e.buildHTML(n).insertBefore(t.notiLoadMoreBtn()),t.item().implement(EasySocial.Controller.NotificationsList.Item)),o<0&&t.notiLoadMoreBtn().hide()}).fail(function(e){return e}).always(function(){})}}}),EasySocial.Controller("NotificationsList.Item",{defaultOptions:{"{unread}":"[data-notifications-list-item-unread]","{read}":"[data-notifications-list-item-read]","{delete}":"[data-notifications-list-item-delete]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},"{unread} click":function(){EasySocial.ajax("site/controllers/notifications/setState",{id:e.options.id,state:"unread"}).done(function(){e.element.removeClass("is-read is-hidden is-unread").addClass("is-unread\t")})},"{read} click":function(){EasySocial.ajax("site/controllers/notifications/setState",{id:e.options.id,state:"read"}).done(function(){e.element.removeClass("is-read is-hidden is-unread").addClass("is-read")})},"{delete} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/notifications/clearConfirm"),bindings:{"{clearButton} click":function(){EasySocial.ajax("site/controllers/notifications/setState",{id:e.options.id,state:"clear"}).done(function(){e.element.removeClass("is-read is-hidden is-unread is-read").addClass("is-remove"),EasySocial.dialog().close()}).fail(function(e){EasySocial.dialog({content:e.message})})}}})}}}),t.resolve()})}),EasySocial.module("site/points/history",function(){var e=this;EasySocial.require().done(function(t){EasySocial.Controller("Points.History",{defaultOptions:{"{loadMore}":"[data-points-history-pagination]","{timeline}":"[data-points-history-timeline]"}},function(e){return{init:function(){},"{loadMore} click":function(i,n){var o=t(i).data("current");EasySocial.ajax("site/views/points/getHistory",{limitstart:o,id:e.options.id}).done(function(n,o,a){e.timeline().append(n),t(i).data("current",o),a&&t(i).hide()})}}}),e.resolve()})}),EasySocial.module("site/profile/about",function(e){var t=this;EasySocial.require().script("field").library("history").done(function(e){EasySocial.Controller("Profile.About",{defaultOptions:{"{stepItem}":"[data-profile-about-step-item]","{stepContent}":"[data-profile-about-step-content]","{fieldItem}":"[data-field]"}},function(e){return{init:function(){e.fieldItem().addController("EasySocial.Controller.Field.Base",{mode:"display"})},"{stepItem} click":function(t,i){i.preventDefault(),t.find("a").route();var n=t.data("for");e.stepItem().removeClass("active"),t.addClass("active"),e.stepContent().filterBy("id",n).trigger("activateTab")},"{stepContent} activateTab":function(t,i){e.stepContent().removeClass("active"),t.addClass("active"),t.find(e.fieldItem.selector).trigger("onShow")}}}),t.resolve()})}),EasySocial.module("site/profile/edit",function(e){var t=this;EasySocial.require().script("validate","field","oauth/facebook").done(function(e){EasySocial.Controller("Profile.Edit",{defaultOptions:{userid:null,"{stepContent}":"[data-profile-edit-fields-content]","{stepItem}":"[data-profile-edit-fields-step]","{profileForm}":"[data-profile-fields-form]","{profileContent}":"[data-profile-edit-fields]","{fieldItem}":"[data-profile-edit-fields-item]","{save}":"[data-profile-fields-save]","{deleteProfile}":"[data-profile-edit-delete]"}},function(t){return{init:function(){t.fieldItem().addController("EasySocial.Controller.Field.Base",{userid:t.options.userid,mode:"edit"})},errorFields:[],"{fieldItem} error":function(e,i){t.triggerStepError(e)},"{fieldItem} clear":function(e,i){t.clearStepError(e)},"{fieldItem} onError":function(e,i){t.triggerStepError(e)},triggerStepError:function(i){var n=i.data("id"),o=i.parents(t.stepContent.selector).data("id");e.inArray(n,t.errorFields)<0&&t.errorFields.push(n),t.stepItem().filterBy("for",o).trigger("error")},clearStepError:function(i){var n=i.data("id"),o=i.parents(t.stepContent.selector).data("id");t.errorFields=e.without(t.errorFields,n),t.stepItem().filterBy("for",o).trigger("clear")},"{stepItem} click":function(i,n){var o=e(i).data("for");t.profileContent().show(),t.stepItem().removeClass("active"),i.addClass("active"),t.stepContent().removeClass("active");var a=t.stepContent().filterBy("id",o);a.addClass("active"),a.find(t.fieldItem.selector).trigger("show")},"{stepItem} error":function(e){e.addClass("error")},"{stepItem} clear":function(e){t.errorFields.length<1&&e.removeClass("error")},"{save} click":function(i,n){return n.preventDefault(),e(i).addClass("btn-loading"),t.profileForm().validate().fail(function(){e(i).removeClass("btn-loading"),EasySocial.dialog({content:EasySocial.ajax("site/views/profile/showFormError")})}).done(function(){t.profileForm().submit()}),!1},"{deleteProfile} click":function(){EasySocial.dialog({content:EasySocial.ajax("site/views/profile/confirmDelete")})}}}),t.resolve()})}),EasySocial.module("site/profile/friends",function(e){var t=this;EasySocial.require().view("site/loading/small").language("COM_EASYSOCIAL_FRIENDS_DIALOG_CANCEL_REQUEST","COM_EASYSOCIAL_CANCEL_BUTTON","COM_EASYSOCIAL_YES_CANCEL_MY_REQUEST_BUTTON").done(function(e){EasySocial.Controller("Profile.Friends.Request",{defaultOptions:{id:null,callback:null,"{addButton}":"[data-profileFriends-add]","{manageButton}":"[data-profileFriends-manage]","{pendingButton}":"[data-profileFriends-pending]","{respondButton}":"[data-profileFriends-respond]","{cancelRequest}":"[data-profileFriends-cancelRequest]","{unfriend}":"[data-profile-friends-unfriend]","{approve}":"[data-friends-response-approve]","{reject}":"[data-friends-response-reject]","{button}":"[data-profileFriends-button]","{dropdown}":"[data-profileFriends-dropdown]",view:{loader:"site/loading/small"}}},function(t){return{init:function(){t.options.id=t.element.data("friend"),t.options.target=t.element.data("id"),t.options.callback=t.element.data("callback")},showDropDown:function(){t.element.addClass("open")},hideDropDown:function(){t.element.removeClass("open")},"{addButton} click":function(e){var i=t.button();i.addClass("loading"),EasySocial.ajax("site/controllers/friends/request",{id:t.options.target}).done(function(e,i){t.dropdown().remove(),t.options.id=e,t.button().replaceWith(i)}).fail(function(){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")}),i.removeClass("loading")})},"{cancelRequest} click":function(e,i){t.options.id;t.hideDropDown(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmCancel"),bindings:{"{confirmButton} click":function(){EasySocial.ajax("site/controllers/friends/cancelRequest",{id:t.options.id}).done(function(e){t.dropdown().remove(),t.button().replaceWith(e),EasySocial.dialog().close()})}}})},"{unfriend} click":function(i,n){var o=e(i).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmUnfriend",{id:o}),bindings:{"{unfriendButton} click":function(){EasySocial.ajax("site/controllers/friends/unfriend",{id:t.options.id}).done(function(e){t.dropdown().remove(),t.button().replaceWith(e),EasySocial.dialog().close()})}}})},"{approve} click":function(e,i){var n=t.options.id;t.hideDropDown(),EasySocial.ajax("site/controllers/friends/approve",{id:n}).done(function(e){t.button().replaceWith(e)})},"{reject} click":function(e,i){var n=t.options.id;t.hideDropDown(),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/confirmReject"),bindings:{"{rejectButton} click":function(){EasySocial.ajax("site/controllers/friends/reject",{id:n}).done(function(e){t.button().replaceWith(e),EasySocial.dialog({content:EasySocial.ajax("site/views/friends/friendRejected")})})}}})},"{dropdown} click":function(e,t){t.stopPropagation()},"{approveRequest} click":function(){t.respondForm().find("input[name=task]").val("approve"),t.respondForm().find("input[name=id]").val(t.options.friendId),t.respondForm().find("input[name=return]").val(t.options.callback),t.respondForm().submit()}}}),t.resolve()})}),EasySocial.module("site/profile/header",function(e){var t=this;EasySocial.require().script("site/profile/friends","site/profile/subscriptions","site/conversations/composer").done(function(e){EasySocial.Controller("Profile.Header",{defaultOptions:{id:null,"{friendRequest}":"[data-profile-friends]","{subscribe}":"[data-profile-followers]","{conversation}":"[data-profile-conversation]"}},function(e){return{init:function(){e.options.id=e.element.data("id"),e.options.name=e.element.data("name"),e.options.avatar=e.element.data("avatar"),e.friendRequest().implement(EasySocial.Controller.Profile.Friends.Request,{"{parent}":e}),e.subscribe().implement(EasySocial.Controller.Profile.Subscriptions,{"{parent}":e}),e.conversation().implement(EasySocial.Controller.Conversations.Composer.Dialog,{recipient:{id:e.options.id,name:e.options.name,avatar:e.options.avatar}})}}}),t.resolve()})}),EasySocial.module("site/profile/subscriptions",function(e){var t=this;EasySocial.Controller("Profile.Subscriptions",{defaultOptions:{id:null,"{follow}":"[data-subscription-follow]","{unfollow}":"[data-subscription-unfollow]","{message}":"[data-subscription-message]","{button}":"[data-subscription-button]"}},function(e){return{init:function(){e.options.id=e.element.data("id")},toggleDropDown:function(){e.element.toggleClass("open")},"{unfollow} click":function(){e.toggleDropDown(),EasySocial.ajax("site/controllers/profile/unfollow",{id:e.options.id,type:"user"}).done(function(t){e.button().replaceWith(t)})},"{follow} click":function(){e.toggleDropDown(),EasySocial.ajax("site/controllers/profile/follow",{id:e.options.id,type:"user"}).done(function(t){e.button().replaceWith(t)})}}}),t.resolve()}),EasySocial.module("site/profile/miniheader",function(e){var t=this;EasySocial.require().library("scrollTo").done(function(e){EasySocial.Controller("Profile.MiniHeader",{defaultOptions:{"{viewport}":"[data-appscroll-viewport]","{content}":"[data-appscroll-content]","{apps}":"[data-appscroll-content] li","{buttons}":"[data-appscroll-buttons]","{nextButton}":"[data-appscroll-next-button]","{prevButton}":"[data-appscroll-prev-button]"}},function(t){return{init:function(){t.setLayout(),t.viewport().scrollTo(0)},"{window} resize":e.debounce(function(){t.setLayout()},300),setLayout:function(){var i=t.viewport(),n=5;if(e(".es-main").hasClass("w480"))return t.content().css({width:"auto"}),void(t.enabled=!1);t.apps().each(function(){n+=e(this).outerWidth(!0)}),n>i.width()&&(t.content().css({width:n,float:"none"}),t.buttons().css("opacity",1),t.enabled=!0)},enabled:!1,"{nextButton} click":function(){if(t.enabled){var e=t.viewport(),i=e.width()-80;e.scrollTo("+="+i+"px",800,{axis:"x",easing:"easeInOutCubic"})}},"{prevButton} click":function(){if(t.enabled){var e=t.viewport(),i=e.width()-80;e.scrollTo("-="+i+"px",800,{axis:"x",easing:"easeInOutCubic"})}}}}),t.resolve()})}),EasySocial.module("site/profile/notifications",function(e){var t=this;EasySocial.require().script("site/profile/header").done(function(){EasySocial.Controller("Profile.Notifications",{defaultOptions:{"{sidebarItem}":"[data-notification-item]","{contentItem}":"[data-notification-content]","{notificationForm}":"[data-notifications-form]"}},function(e){return{init:function(){},"{sidebarItem} click":function(t,i){e.sidebarItem().removeClass("active"),t.addClass("active"),e.contentItem().hide();var n=t.data("alert-element");e.contentItem('[data-alert-element="'+n+'"]').show()}}}),t.resolve()})}),EasySocial.module("site/profile/privacy",function(e){var t=this;EasySocial.require().script("site/profile/header").library("history","textboxlist").view("site/loading/small").done(function(e){EasySocial.Controller("Profile.Privacy",{defaultOptions:{"{sidebarItem}":"[data-profile-privacy-item]","{contentItem}":"[data-privacy-content]","{privacyItem}":"[data-privacy-item]","{privacyForm}":"[data-profile-privacy-form]","{formActions}":"[data-form-actions]",view:{loading:"site/loading/small"}}},function(t){return{init:function(){t.sidebarItem().implement(EasySocial.Controller.Profile.Privacy.Sidebar,{"{parent}":t}),t.privacyItem().implement(EasySocial.Controller.Profile.Privacy.Item,{"{parent}":t})},updateContent:function(i){t.contentItem().hide(),e(".privacy-content-"+i).show(),"blocked"==i?t.formActions().hide():t.formActions().show()}}}),EasySocial.Controller("Profile.Privacy.Sidebar",{defaultOptions:{"{sidebarItem}":"[data-profile-privacy-item]"}},function(t){return{init:function(){},"{self} click":function(i){e("[data-profile-privacy-item]").removeClass("active"),e(i).addClass("active");var n=t.element.data("group");t.parent.updateContent(n)}}}),EasySocial.Controller("Profile.Privacy.Item",{defaultOptions:{"{selection}":"[data-privacy-select]","{hiddenCustom}":"[data-hidden-custom]","{customForm}":"[data-privacy-custom-form]","{customTextInput}":"[data-textfield]","{customItems}":"input[]","{customHideBtn}":"[data-privacy-custom-hide-button]","{customInputItem}":"[data-textboxlist-item]","{customEditBtn}":"[data-privacy-custom-edit-button]"}},function(t){return{init:function(){t.customTextInput().textboxlist({component:"es",unique:!0,plugin:{autocomplete:{exclusive:!0,minLength:2,cache:!1,query:function(e){var i=t.getTaggedUsers();return EasySocial.ajax("site/views/privacy/getfriends",{q:e,exclude:i})}}}}),t.textboxlistLib=t.customTextInput().textboxlist("controller")},getTaggedUsers:function(){var i=[],n=t.customInputItem();return n.length>0&&e.each(n,function(t,n){i.push(e(n).data("id"))}),i},"{customTextInput} addItem":function(e,i,n){var o=t.hiddenCustom().val(),a="";if(""==o)a=n.id;else{var r=o.split(",");r.push(n.id),a=r.join(",")}t.hiddenCustom().val(a)},"{customTextInput} removeItem":function(e,i,n){for(var o="",a=[],r=t.hiddenCustom().val().split(","),s=0;s<r.length;s++)r[s]!=n.id&&a.push(r[s]);o=a.length<=0?"":a.join(","),t.hiddenCustom().val(o)},"{customEditBtn} click":function(e){t.customForm().toggle()},"{selection} change":function(e){"custom"==e.val()?(t.customForm().show(),t.customEditBtn().show()):(t.customForm().hide(),t.customEditBtn().hide())},"{customHideBtn} click":function(){t.customForm().hide(),t.customEditBtn().show(),t.textboxlistLib.autocomplete.hide()}}}),t.resolve()})}),EasySocial.module("site/profile/profile",function(e){var t=this;EasySocial.template("info/item",'<li data-profile-apps-item data-layout="custom"><a class="ml-20" href="[%= url %]" title="[%= title %]" data-info-item data-info-index="[%= index %]"><i class="ies-info ies-small mr-5"></i> [%= title %]</a></li>'),EasySocial.require().script("site/profile/header").library("history").done(function(e){EasySocial.Controller("Profile",{defaultOptions:{id:null,"{header}":"[data-profile-header]","{app}":"[data-profile-apps-item]","{action}":"[data-profile-apps-menu]","{contents}":"[data-profile-real-content]","{sidebar}":"[data-sidebar]","{sidebarToggle}":"[data-sidebar-toggle]","{info}":"[data-info]","{infoItem}":"[data-info-item]",view:{infoItem:"info/item"}}},function(t){return{init:function(){t.options.id=t.element.data("id"),t.header().implement(EasySocial.Controller.Profile.Header,{"{parent}":t}),e(function(){t.setLayout()}),e(".es-responsive").on("responsive",function(){t.setLayout()})},setLayout:function(){var i=t.sidebar(),n=t.sidebarToggle();if(n.is(":visible"))e('<div class="es-container responsive">').append(i).insertAfter(n);else e(".es-profile .es-container:not(.responsive)").prepend(i),e(".es-profile .es-container.responsive").remove()},"{sidebarToggle} sidebarToggle":function(e){t.setLayout()},"{app} click":function(i,n){t.app().removeClass("active"),e(i).addClass("active"),n.preventDefault();var o=i.data();"canvas"!==o.layout?"custom"!==o.layout&&(History.pushState({state:1},o.title,o[o.layout+"Url"]),t.sidebarToggle().is(":visible")&&e.scrollTo(t.contents()),EasySocial.ajax(o.namespace,{id:o.id,view:"profile",appId:o.appId},{beforeSend:function(){t.loading()}}).done(function(e){t.updateContent(e)}).fail(function(e){return e})):window.location=o[o.layout+"Url"]},updateContent:function(e){t.element.removeClass("loading"),t.contents().html(e)},loading:function(){t.contents().html(""),t.element.addClass("loading")},"{info} click":function(i,n){n.preventDefault(),i.route(),t.loading(),i.data("loaded")?t.infoItem().eq(0).trigger("click"):EasySocial.ajax("site/controllers/profile/initInfo",{id:t.options.id}).done(function(n){i.data("loaded",1);var o=i.parent("[data-profile-apps-item]");e.each(n.reverse(),function(e,i){i.hide||o.after(t.view.infoItem({url:i.url,title:i.title,index:i.index})),i.html&&(t.updateContent(i.html),t.contents().find("[data-field]").trigger("onShow"))});var a=t.infoItem().eq(0).parent("[data-profile-apps-item]");t.app().removeClass("active"),a.addClass("active"),e(document).prop("title",t.infoItem().eq(0).attr("title"))})},"{infoItem} click":function(e,i){i.preventDefault(),e.route(),t.loading();var n=e.data("info-index");EasySocial.ajax("site/controllers/profile/getInfo",{id:t.options.id,index:n}).done(function(i){t.updateContent(i),t.contents().find("[data-field]").trigger("onShow"),t.app().removeClass("active"),e.parent("[data-profile-apps-item]").addClass("active")}).fail(function(e){t.updateContent(e.message)})}}}),t.resolve()})}),EasySocial.module("site/registrations/registrations",function(e){var t=this;EasySocial.require().script("validate","field").view("site/registration/dialog.error").language("COM_EASYSOCIAL_CLOSE_BUTTON","COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE").done(function(e){EasySocial.Controller("Registrations.Form",{defaultOptions:{previousLink:null,"{submit}":"[data-registration-submit]","{field}":"[data-registration-fields-item ]","{previous}":"[data-registration-previous]",view:{formError:"site/registration/dialog.error"}}},function(t){return{init:function(){t.field().addController("EasySocial.Controller.Field.Base",{mode:"register"})},"{previous} click":function(e,i){return i.preventDefault(),window.location.href=t.options.previousLink,!1},"{submit} click":function(i,n){return n.preventDefault(),e(i).addClass("btn-loading"),e(t.element).validate().fail(function(){e(i).removeClass("btn-loading"),EasySocial.dialog({title:e.language("COM_EASYSOCIAL_REGISTRATION_ERROR_DIALOG_TITLE"),content:t.view.formError(!0),width:400,height:150,buttons:[{name:e.language("COM_EASYSOCIAL_CLOSE_BUTTON"),classNames:"btn btn-es-primary",click:function(){EasySocial.dialog().close()}}]})}).done(function(){t.element.submit()}),!1}}}),t.resolve()})}),EasySocial.module("site/search/advanced.criteria",function(){var e=this;EasySocial.require().view("site/loading/small").script("site/search/map").language("COM_EASYSOCIAL_ADVANCED_SEARCH_ADDRESS_DISTANCE_NOTICE").done(function(t){EasySocial.Controller("Search.Advanced.Criteria",{defaultOptions:{"{addButton}":"[data-criteria-add-button]","{removeButton}":"[data-criteria-remove-button]","{itemConditionDiv}":"[data-itemConditionDiv]","{itemCriteria}":"[data-itemCriteria]","{itemDataKey}":"[data-itemDataKey]","{itemOperator}":"[data-itemOperator]","{itemCondition}":"[data-itemCondition]","{dateStart}":"[data-start]","{dateEnd}":"[data-end]","{dataCondition}":"[data-condition]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]","{dataNotice}":"[data-criteria-notice]","{locationLabel}":"[data-location-label]",view:{loadingContent:"site/loading/small"}}},function(e){return{init:function(){e.element.addController(EasySocial.Controller.Search.Map),""!=e.frmAddress().val()&&(e.locationLabel().html(e.frmAddress().val()),e.locationLabel().removeClass("hide"))},"{itemOperator} change":function(){criteria=e.itemCriteria().find("select"),o=e.itemDataKey().find("select"),operator=e.itemOperator().find("select");var t=criteria.val().split("|"),i=(t[0],t[1]),n=operator.val(),o=o.val();"blank"==n||"notblank"==n?e.itemCondition().hide():("between"==n?e.getConditions(i,n,o):"datetime"!=i&&"birthday"!=i||e.dateStart().length>0&&e.getConditions(i,n,o),e.itemCondition().is(":hidden")&&e.itemCondition().show())},getConditions:function(i,n,o){EasySocial.ajax("site/controllers/search/getConditions",{element:i,operator:n,datakey:o}).done(function(i){e.itemCondition().show(),e.itemCondition().remove(),t.buildHTML(i).insertAfter(e.itemOperator())}).fail(function(e){return e}).always(function(){})},"{frmDistance} change":function(){var t=e.frmDistance().val(),i=e.frmAddress().val(),n=t+"|"+e.frmLatitude().val()+"|"+e.frmLongitude().val()+"|"+i;e.dataCondition().val(n)},"{dateStart} change":function(t){start=e.dateStart().val(),end=e.dateEnd().val();var i=start;end.length>0&&(i=i+"|"+end),e.dataCondition().val(i)},"{dateEnd} change":function(){start=e.dateStart().val(),end=e.dateEnd().val();var t=start;t=t+"|"+end,e.dataCondition().val(t)},"{itemCriteria} change":function(){if(select=e.itemCriteria().find("select"),""!=select.val()){var i=select.val().split("|"),n=i[0],o=i[1];e.dataNotice().addClass("hide"),EasySocial.ajax("site/controllers/search/getDataKeys",{key:n,element:o}).done(function(i,n,o){e.itemDataKey().remove(),e.itemOperator().remove(),e.itemCondition().remove();var a=t.buildHTML(n);a.insertAfter(e.itemConditionDiv()),""!=i&&(a=t.buildHTML(i)).insertAfter(e.itemConditionDiv()),(a=t.buildHTML(o)).insertAfter(e.itemOperator())}).fail(function(e){return e}).always(function(){})}},"{itemDataKey} change":function(){if(select=e.itemCriteria().find("select"),""!=select.val()){var i=select.val().split("|"),n=i[0],o=i[1],a=e.itemDataKey().find("select").val();EasySocial.ajax("site/controllers/search/getOperators",{key:n,element:o,datakey:a}).done(function(i,n){e.itemOperator().remove();var o=t.buildHTML(i);o.insertAfter(e.itemDataKey()),e.itemCondition().remove(),(o=t.buildHTML(n)).insertAfter(e.itemOperator())}).fail(function(e){return e}).always(function(){})}},"{removeButton} click":function(){e.element.remove()}}}),e.resolve()})}),EasySocial.module("site/search/map",function(e){var t=this;e.template("easysocial/maps.suggestion",'<div class="es-story-location-suggestion" data-location-suggestion><span class="formatted_address">[%= location.formatted_address %]</span></div>'),EasySocial.require().library("gmaps").done(function(){EasySocial.Controller("Search.Map",{defaultOptions:{"{icon}":"[data-loaction-icon]","{locationLabel}":"[data-location-label]","{detectButton}":"[data-location-detect]","{suggestions}":"[data-location-suggestions]","{suggestion}":"[data-location-suggestion]","{autocomplete}":"[data-location-autocomplete]","{dataCondition}":"[data-condition]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]",view:{suggestion:"maps.suggestion"}}},function(t){return{init:function(){},"{detectButton} click":function(){t.icon().removeClass("ies-power").addClass("btn-loading"),clearTimeout(t.detectTimer),t.detectTimer=setTimeout(function(){t.base().removeClass("is-busy")},8e3),e.GMaps.geolocate({success:function(i){e.GMaps.geocode({lat:i.coords.latitude,lng:i.coords.longitude,callback:function(e,i){"OK"==i&&t.suggest(e)}})},error:function(t){var i="";switch(t.code){case 1:i=e.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:i=e.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:i=e.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR")}EasySocial.dialog({content:i})},always:function(){clearTimeout(t.detectTimer),t.icon().removeClass("btn-loading").addClass("ies-power")}})},"{suggestion} click":function(e,i){var n=e.data("location"),o=n.geometry.location.lat(),a=n.geometry.location.lng(),r=n.formatted_address,s=t.frmDistance().val();t.frmAddress().val(r),t.frmLatitude().val(o),t.frmLongitude().val(a);var l=s+"|"+o+"|"+a+"|"+r;t.dataCondition().val(l),t.locationLabel().html(r),t.locationLabel().removeClass("hide"),t.clearSuggestions()},suggest:function(i){t.clearSuggestions();var n=t.suggestions();i.length<0||(t.results=i,e.each(i,function(e,i){t.view.suggestion({location:i}).data("location",i).appendTo(n)}),t.autocomplete().addClass("active"))},clearSuggestions:function(){t.autocomplete().removeClass("active"),t.suggestions().empty()}}}),t.resolve()})}),EasySocial.module("site/search/advanced",function(){var e=this;EasySocial.require().script("site/search/advanced.criteria").view("site/loading/small","site/advancedsearch/noresult").language("COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS").done(function(t){EasySocial.Controller("Search.Advanced",{defaultOptions:{"{sidebar}":"[data-advsearch-sidebar]","{sidebarItem}":"[data-sidebar-item]","{item}":"[data-adv-search-item]","{list}":"[data-advsearch-list]","{searchForm}":"[data-adv-search-form]","{savefilterBtn}":"[data-advsearch-savefilter]","{deletefilterBtn}":"[data-advsearch-deletefilter]","{content}":"[data-advsearch-content]","{addCriteria}":"[data-adv-search-add-criteria]","{criteriaTemplate}":"[data-adv-search-criteria-template]","{resultlist}":"[data-advsearch-result-list]",view:{loadingContent:"site/loading/small",noresult:"site/advancedsearch/noresult"}}},function(e){return{init:function(){e.sidebarController=e.sidebar().addController(EasySocial.Controller.Search.Advanced.Sidebar,{"{parent}":e}),e.item().addController(EasySocial.Controller.Search.Advanced.Criteria,{"{parent}":e})},updatingContents:function(){e.element.addClass("loading")},updateContents:function(t){e.element.removeClass("loading"),e.content().html(t)},"{deletefilterBtn} click":function(i){var n=t(i).data("id");EasySocial.dialog({content:EasySocial.ajax("site/views/search/confirmFilterDelete",{fid:n}),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/search/deleteFilter",{fid:n}).done(function(){t("[data-search-filter-"+n+"]").remove(),t("[data-search-filter-0]").addClass("active"),e.content().html(""),e.updatingContents(),EasySocial.ajax("site/controllers/search/getFilterResults",{fid:"0"}).done(function(i){(i=t.buildHTML(i)).addController("EasySocial.Controller.Search.Advanced.Criteria",{"{parent}":e}),e.updateContents(i)}).fail(function(e){return e}),EasySocial.dialog().close()})}}})},"{savefilterBtn} click":function(){var i=e.searchForm().serializeJSON();EasySocial.dialog({content:EasySocial.ajax("site/views/search/confirmSaveFilter"),bindings:{"{saveButton} click":function(){this.inputWarning().hide(),filterName=this.inputTitle().val(),filterSitewide=this.inputSitewide().is(":checked")?1:0,""!=filterName?EasySocial.ajax("site/controllers/search/addFilter",{title:filterName,sitewide:filterSitewide,data:i}).done(function(i,n){var o=t.buildHTML(i);e.sidebarController.addFilterItem(o),EasySocial.dialog(n),setTimeout(function(){EasySocial.dialog().close()},2e3)}):this.inputWarning().show()}}})},"{addCriteria} click":function(i,n){var o=e.criteriaTemplate().clone();t(o).removeClass("hide").removeAttr("data-adv-search-criteria-template").addController(EasySocial.Controller.Search.Advanced.Criteria,{"{parent}":e}),e.list().append(o)}}}),EasySocial.Controller("Search.Advanced.Sidebar",{defaultOptions:{"{item}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(e){return{init:function(){e.item().implement(EasySocial.Controller.Search.Advanced.Sidebar.Item,{"{parent}":e,"{root}":e.parent})},addFilterItem:function(i){i.implement(EasySocial.Controller.Search.Advanced.Sidebar.Item,{"{parent}":e,"{root}":e.parent}),i.appendTo(t("[data-advsearch-sidebar-ul]"))}}}),EasySocial.Controller("Search.Advanced.Sidebar.Item",{defaultOptions:{"{filterDeleteBtn}":"[data-search-filter-delete]","{filterItem}":"[data-search-filter-item]","{item}":"[data-adv-search-item]",view:{loadingContent:"site/loading/small"}}},function(e){return{init:function(){},"{filterItem} click":function(i,n){n.preventDefault(),t("[data-sidebar-item]").removeClass("active loading"),e.element.addClass("active");var o=e.element.data("id");e.element.data("url"),e.element.data("title");t(i).route(),e.root.content().html(""),e.root.updatingContents(),e.element.addClass("loading"),EasySocial.ajax("site/controllers/search/getFilterResults",{fid:o}).done(function(i){(i=t.buildHTML(i)).find(e.item.selector).addController("EasySocial.Controller.Search.Advanced.Criteria",{"{parent}":e.root}),e.root.updateContents(i)}).fail(function(e){return e}).always(function(){e.element.removeClass("loading")})}}}),e.resolve()})}),EasySocial.module("site/search/advanced.list",function(e){var t=this;EasySocial.require().view("site/loading/small","site/search/loadbutton").script("site/search/item").language("COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS").done(function(e){EasySocial.Controller("Search.Advanced.List",{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]","{searchForm}":"[data-adv-search-form]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(t){return{init:function(){t.item().implement(EasySocial.Controller.Search.Item),t.on("scroll.advsearch",window,e._.debounce(function(){t.loading||t.pagination().visible()&&t.loadMore()},250))},"{loadmorebutton} click":function(){t.loadMore()},loadMore:function(){var e=t.pagination().data("last-limit"),i=t.searchForm().serializeJSON();"-1"!=e?(t.loading=!0,EasySocial.ajax("site/controllers/search/loadmore",{data:i,nextlimit:e},{beforeSend:function(){t.pagination().html(t.view.loadingContent())}}).done(function(e,i){t.pagination().data("last-limit",i),t.pagination().before(e),t.item().implement(EasySocial.Controller.Search.Item),"-1"==i?t.pagination().html(""):t.pagination().html(t.view.loadmoreContent())}).fail(function(e){return e}).always(function(){t.loading=!1})):t.loadmorebutton().hide()}}}),t.resolve()})}),EasySocial.module("site/search/item",function(e){var t=this;EasySocial.require().view("site/loading/small").language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE").done(function(e){EasySocial.Controller("Search.Item",{defaultOptions:{"{toggle}":"[data-activity-toggle]","{deleteBtn}":"[data-activity-delete]","{addFriendButton}":"[data-search-friend-button]","{pendingFriendButton}":"[data-search-friend-pending-button]","{dropdown}":"[data-profileFriends-dropdown]",view:{loader:"site/loading/small"}}},function(t){return{init:function(){},"{pendingFriendButton} click":function(i){t.dropdown().html(e.language("COM_EASYSOCIAL_FRIENDS_REQUEST_SENT_NOTICE"))},"{addFriendButton} click":function(i){var n=t.element.data("friend-uid");e(i).addClass("btn-loading"),EasySocial.ajax("site/controllers/friends/request",{viewCallback:"usersRequest",id:n}).done(function(n){e(i).replaceWith(n),t.dropdown().remove(),e(i).removeClass("btn-loading")}).fail(function(e){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")}),t.dropdown().html(e)})}}}),t.resolve()})}),EasySocial.module("site/search/dating",function(e){var t=this;EasySocial.require().script("site/search/map").done(function(){EasySocial.Controller("Search.Dating",{defaultOptions:{"{itemCriteria}":"[data-itemCriteria]","{itemDataKey}":"[data-itemDataKey]","{itemOperator}":"[data-itemOperator]","{itemCondition}":"[data-itemCondition]","{dateStart}":"[data-start]","{dateEnd}":"[data-end]","{dataCondition}":"[data-condition]","{dataGender}":"[data-gender-radio]","{frmDistance}":"[data-distance]","{frmAddress}":"[data-address]","{frmLatitude}":"[data-latitude]","{frmLongitude}":"[data-longitude]","{locationLabel}":"[data-location-label]"}},function(e){return{init:function(){e.element.addController(EasySocial.Controller.Search.Map),""!=e.frmAddress().val()&&(e.locationLabel().html(e.frmAddress().val()),e.locationLabel().removeClass("hide"))},"{frmDistance} change":function(){var t=e.frmDistance().val(),i=e.frmAddress().val(),n=t+"|"+e.frmLatitude().val()+"|"+e.frmLongitude().val()+"|"+i;e.dataCondition().val(n)},"{dataGender} click":function(t){e.dataCondition().val(t.val())},"{dateStart} change":function(){start=e.dateStart().val(),end=e.dateEnd().val();var t=start;end.length>0&&(t=t+"|"+end),e.dataCondition().val(t)},"{dateEnd} change":function(){start=e.dateStart().val(),end=e.dateEnd().val();var t=end;start.length>0&&(t=start+"|"+t),e.dataCondition().val(t)}}}),t.resolve()})}),EasySocial.module("site/search/list",function(e){var t=this;EasySocial.require().view("site/loading/small","site/search/loadbutton").script("site/search/item").language("COM_EASYSOCIAL_SEARCH_LOAD_MORE_ITEMS").done(function(e){EasySocial.Controller("Search.List",{defaultOptions:{"{item}":"[data-search-item]","{pagination}":"[data-search-pagination]","{loadmorebutton}":"[data-search-loadmore-button]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/search/loadbutton"}}},function(t){return{init:function(){t.item().implement(EasySocial.Controller.Search.Item),t.on("scroll.search",window,e._.debounce(function(){t.loading||t.pagination().visible()&&t.loadMore()},250))},"{loadmorebutton} click":function(){t.loadMore()},loadMore:function(){var i=e("[data-search-query]").val(),n=e("[data-sidebar-menu].active").data("type"),o=t.pagination().data("last-limit"),a=t.pagination().data("last-type");"-1"!=o?(t.loading=!0,EasySocial.ajax("site/controllers/search/getItems",{next_limit:o,last_type:a,type:n,q:i,loadmore:"1"},{beforeSend:function(){t.pagination().html(t.view.loadingContent())}}).done(function(e,i,n){t.pagination().data("last-limit",n),t.pagination().data("last-type",i),t.pagination().before(e),t.item().implement(EasySocial.Controller.Search.Item),"-1"==n?t.pagination().html(""):t.pagination().html(t.view.loadmoreContent())}).fail(function(e){return e}).always(function(){t.loading=!1})):t.loadmorebutton().hide()}}}),t.resolve()})}),EasySocial.module("site/search/search",function(e){var t=this;EasySocial.require().library("history").script("site/search/sidebar","site/profile/friends").view("site/loading/small").done(function(e){EasySocial.Controller("Search",{defaultOptions:{items:null,"{container}":"[data-search]","{contentTitle}":"[data-search-content-title]","{content}":"[data-search-content]","{sidebar}":"[data-search-sidebar]","{sidebarItem}":"[data-sidebar-item]",view:{loadingContent:"site/loading/small"}}},function(e){return{init:function(){e.sidebar().implement(EasySocial.Controller.Search.Sidebar,{"{parent}":e}),e.sidebarItem().implement(EasySocial.Controller.Search.Sidebar.Item,{"{parent}":e})},updatingContents:function(){e.content().html(e.view.loadingContent())},updateContent:function(t){e.content().html(t)}}}),t.resolve()})}),EasySocial.module("site/search/sidebar",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Search.Sidebar",{defaultOptions:{"{menuItem}":"[data-sidebar-menu]"}},function(t){return{init:function(){},"{menuItem} click":function(i,n){t.menuItem().removeClass("active"),e(i).addClass("active")}}}),EasySocial.Controller("Search.Sidebar.Item",{defaultOptions:{}},function(t){return{init:function(){},"{self} click":function(i,n){var o=t.element.data("type"),a=t.element.data("url"),r=e("[data-search-query]").val();History.pushState({state:1},"",a),t.parent.updatingContents(),EasySocial.ajax("site/controllers/search/getItems",{type:o,q:r}).done(function(e){t.parent.updateContent(e)}).fail(function(e){console.log(e)}),t.parent.updateContent()}}}),t.resolve()})}),EasySocial.module("site/search/toolbar",function(e){var t=this;EasySocial.Controller("Search.Toolbar",{defaultOptions:{"{textfield}":"[data-nav-search-input]"}},function(t,i,n){return{init:function(){},cache:{},search:e.debounce(function(i){if(!t.loading&&i&&(i=e.trim(i))&&!(i.length<=2)){var o=t.textfield();o.popbox("widget").hide(),o.popbox("widget").destroy();var a=t.cache[i]||EasySocial.ajax("site/controllers/search/getItems",{q:i,mini:"1"}).done(function(){t.cache[i]=a});a.fail(function(e){console.log(e)}).always(function(){t.loading=!1}),t.hide(),n.popbox({content:a,id:"fd",component:"es",type:"search",toggle:"click",cache:!1,offset:0});var r=n.popbox("widget");r.show(),r.keyword=i}},250),hide:function(){var e=n.popbox("widget");e&&e.hide()},"{textfield} keydown":function(){t.hide()},"{textfield} keyup":function(e,i){if(27!==i.which){var n=e.val();t.search(n)}},"{self} popboxLoading":function(e,t,i){i.loader.width(n.width()),i.loader.position(i.position),n.addClass("is-active")},"{self} popboxActivate":function(e,t,i){i.tooltip.width(n.width()),i.tooltip.position(i.position),n.addClass("is-active")},"{self} popboxDeactivate":function(e,t,i){n.removeClass("is-active")}}}),t.resolve()}),EasySocial.module("site/stream/item",function(){var e=this;EasySocial.require().library("mentions","placeholder","dialog").view("site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").done(function(t){EasySocial.Controller("Stream.Item",{defaultOptions:{view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"},id:"",context:"","{deleteFeed}":"[data-stream-delete]","{editStream}":"[data-stream-edit]","{updateStream}":"[data-stream-edit-update]","{cancelEditStream}":"[data-stream-edit-cancel]","{addBookmark}":"[data-stream-bookmark-add]","{removeBookmark}":"[data-stream-bookmark-remove]","{hideLink}":"[data-stream-hide]","{unHideLink}":"[data-stream-show]","{hideAppLink}":"[data-stream-hide-app]","{unHideAppLink}":"[data-stream-show-app]","{hideActorLink}":"[data-stream-hide-actor]","{unHideActorLink}":"[data-stream-show-actor]","{hideNotice}":"[data-stream-hide-notice]","{actions}":"[data-streamItem-actions]","{contents}":"[data-streamItem-contents]","{streamContent}":"[data-stream-content]","{streamEditor}":"[data-stream-editor]","{streamData}":"[data-stream-item]","{likes}":"[data-likes-action]","{counterBar}":"[data-stream-counter]","{likeContent}":"[data-likes-content]","{repostContent}":"[data-repost-content]","{share}":"[data-repost-action]","{streamCommentLink}":"[data-stream-action-comments]","{streamCommentBlock}":"[data-comments]"}},function(e,i,n){return{init:function(){i.id=n.data("id"),i.context=n.data("context"),i.ishidden=n.data("ishidden"),i.actor=n.data("actor")},plugins:{},"{addBookmark} click":function(t,i){e.element.addClass("is-bookmarked"),EasySocial.ajax("site/controllers/stream/bookmark",{id:e.options.id}).done(function(){}).fail(function(t){e.element.removeClass("is-bookmarked"),e.setMessage(t)})},"{removeBookmark} click":function(t,i){var n=window.streamFilter||!1;"bookmarks"!=n&&e.element.removeClass("is-bookmarked"),EasySocial.ajax("site/controllers/stream/removeBookmark",{id:e.options.id}).done(function(t){"bookmarks"==n&&e.element.html(t)})},"{likes} onLiked":function(t,i,n){e.counterBar().removeClass("hide")},"{likes} onUnliked":function(t,i,n){var o=e.likeContent().hasClass("hide"),a=e.repostContent().hasClass("hide");o&&a&&e.counterBar().addClass("hide")},"{share} create":function(t,i,n){e.counterBar().removeClass("hide")},"{streamCommentLink} click":function(){e.streamCommentBlock().trigger("show")},"{actions} click":function(i,n){e.actions().removeClass("active"),t(i).addClass("active")},"{deleteFeed} click":function(){var t=e.options.id;EasySocial.dialog({content:EasySocial.ajax("site/views/stream/confirmDelete"),bindings:{"{deleteButton} click":function(){EasySocial.ajax("site/controllers/stream/delete",{id:t}).done(function(t){EasySocial.dialog({content:t}),e.element.fadeOut(),setTimeout(function(){EasySocial.dialog().close()},2e3)}).fail(function(e){EasySocial.dialog({content:e})})}}})},"{cancelEditStream} click":function(){e.element.removeClass("is-editing"),e.streamEditor().html(""),e.streamContent().show()},"{editStream} click":function(){var i=e.options.id;EasySocial.ajax("site/views/stream/edit",{id:i}).done(function(i){e.element.addClass("is-editing"),e.streamContent().hide(),e.streamEditor().html(i);var n=e.streamEditor().find("[data-story-textbox]"),o=n.controller("mentions");o?o.cloneLayout():n.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:t.View("easysocial/site/friends/suggest.hint.search"),emptyHint:t.View("easysocial/site/friends/suggest.hint.empty"),data:function(i){var n=t.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:i}).done(function(i){t.isArray(i)||n.reject();var i=t.map(i,function(t){return t.title=t.screenName,t.type="user",t.menuHtml=e.view.suggestItem(!0,{item:t,name:"uid[]"}),t});n.resolve(i)}).fail(n.reject),n},use:function(e){return e.type+":"+e.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:t.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:t.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(i){var n=t.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:i}).done(function(i){t.isArray(i)||n.reject();var i=t.map(i,function(t){return t.title="#"+t.title,t.type="hashtag",t.menuHtml=e.view.tagSuggestItem(!0,{item:t,name:"uid[]"}),t});n.resolve(i)}).fail(n.reject),n}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:"left top",at:"left bottom",of:e.streamEditor().find(".es-story-text"),collision:"none"}}}})})},"{updateStream} click":function(){var i=e.streamEditor().find("[data-story-textbox]"),n=e.streamEditor().find("[data-story-textfield]"),o=i.mentions("controller").toArray(),a=e.element.data("storyHashtags"),r={};(a=a?a.split(","):[]).length>0&&t.map(o,function(e){if("hashtag"===e.type&&t.inArray(e.value,a)>-1)return e}).length,r.mentions=t.map(o,function(e){return"hashtag"===e.type&&t.isPlainObject(e.value)&&(e.value=e.value.title.slice(1)),JSON.stringify(e)}),r.content=n.val(),r.id=e.options.id,EasySocial.ajax("site/controllers/story/update",r).done(function(t,i){e.streamContent().html(t),e.cancelEditStream().click()})},"{hideLink} click":function(){e.streamData().addClass("es-feed-loading"),EasySocial.ajax("site/controllers/stream/hide",{id:e.options.id}).done(function(t){e.streamData().removeClass("es-feed-loading"),e.streamData().hide(),e.element.append(t)}).fail(function(e){})},"{hideActorLink} click":function(){EasySocial.ajax("site/controllers/stream/hideactor",{actor:e.options.actor}).done(function(i){e.streamData().hide(),t(".stream-actor-"+e.options.actor).addClass("hide-stream"),e.element.append(i)}).fail(function(e){console.log(e)})},"{unHideActorLink} click":function(){EasySocial.ajax("site/controllers/stream/unhideactor",{actor:e.options.actor}).done(function(){e.hideNotice().remove(),e.streamData().show(),t(".stream-actor-"+e.options.actor).removeClass("hide-stream")}).fail(function(e){console.log(e)})},"{hideAppLink} click":function(){EasySocial.ajax("site/controllers/stream/hideapp",{context:e.options.context}).done(function(i){e.streamData().hide(),t(".stream-context-"+e.options.context).addClass("hide-stream"),e.element.append(i)}).fail(function(e){console.log(e)})},"{unHideLink} click":function(){EasySocial.ajax("site/controllers/stream/unhide",{id:e.options.id}).done(function(){e.hideNotice().remove(),e.streamData().show()}).fail(function(e){console.log(e)})},"{unHideAppLink} click":function(){EasySocial.ajax("site/controllers/stream/unhideapp",{context:e.options.context}).done(function(){e.hideNotice().remove(),e.streamData().show(),t(".stream-context-"+e.options.context).removeClass("hide-stream")}).fail(function(e){console.log(e)})}}}),e.resolve()})}),EasySocial.module("site/stream/stream",function(){var e=this;EasySocial.require().script("site/stream/item").view("site/loading/small","site/stream/loadbutton").language("COM_EASYSOCIAL_STREAM_LOAD_PREVIOUS_STREAM_ITEMS").done(function(t){EasySocial.Controller("Stream",{defaultOptions:{interval:30,checknew:null,source:null,sourceId:null,autoload:!0,"{story}":"[data-story]","{share}":"[data-repost-action]","{list}":"[data-stream-list]","{newNotiBar}":"[data-stream-notification-bar]","{newNotiButton}":"[data-stream-notification-button]","{item}":"[data-streamItem]","{pagination}":"[data-stream-pagination]","{paginationGuest}":"[data-stream-pagination-guest]","{paginationCluster}":"[data-stream-pagination-cluster]",view:{loadingContent:"site/loading/small",loadmoreContent:"site/stream/loadbutton"}}},function(e){return{init:function(){e.item().addController(EasySocial.Controller.Stream.Item,{"{parent}":e}),"stream"!=e.options.source&&"unity"!=e.options.source&&1==e.options.checknew&&e.startMonitoring(),1==e.options.autoload&&e.on("scroll.stream",window,t._.debounce(function(){e.loading||("unity"==e.options.source?e.paginationGuest().visible()&&e.loadMoreGuest():(iscluster="dashboard"!=e.options.source&&"profile"!=e.options.source,(!0===iscluster?e.paginationCluster():e.pagination()).visible()&&e.loadMore(iscluster)))},250)),e.setLayout()},setLayout:function(){},"{window} resize":t.debounce(function(){e.setLayout()},500),"{story} create":function(i,n,o,a){""!=a&&e.updateExcludeIds(a),e.updateCurrentDate(),t.buildHTML(o).prependTo(e.list()).addController("EasySocial.Controller.Stream.Item"),e.list().children("li.empty").remove()},"{share} create":function(i,n,o){t.buildHTML(o).prependTo(e.list()).addController("EasySocial.Controller.Stream.Item"),e.list().children("li.empty").remove(),e.updateCurrentDate()},updateCurrentDate:function(){EasySocial.ajax("site/controllers/stream/getCurrentDate",{}).done(function(t){e.element.data("currentdate",t)}).fail(function(e){})},updateExcludeIds:function(t){ids=e.element.data("excludeids"),newIds="",""!=ids&&void 0!=ids?newIds=ids+","+t:newIds=t,e.element.data("excludeids",newIds)},clearExcludeIds:function(){e.element.data("excludeids","")},startMonitoring:function(){if(e._destroyed)return e.stopMonitoring();var t=1e3*e.options.interval;EasySocial.debug,e.options.state=setTimeout(e.check,t)},stopMonitoring:function(){clearTimeout(e.options.state)},"{self} destroyed":function(){e.stopMonitoring()},check:function(){e.stopMonitoring();e.options.interval;var i=t("[data-dashboardSidebar-menu].active").data("type"),n=t("[data-dashboardSidebar-menu].active").data("id"),o=e.element.data("currentdate"),a=e.element.data("excludeids");t.trim(e.newNotiBar().html());void 0==i&&void 0==n&&"profile"==e.options.source&&(i="me",n=e.options.sourceId),EasySocial.ajax("site/controllers/stream/checkUpdates",{type:i,id:n,currentdate:o,exclude:a,source:e.options.source,view:e.options.source}).done(function(i,n,o){if(e._destroyed)return e.stopMonitoring();if(e.element.data("currentdate",o),i.length>0){for(var a=0;a<i.length;a++)if(item=i[a],item.cnt>0){var r="[data-stream-counter-"+item.type+"]";curCount=t(r).text(),newCount=""==curCount?item.cnt:parseInt(curCount,10)+parseInt(item.cnt,10),t(r).html(newCount),t(r).parents("li").addClass("has-notice")}n=t.trim(n),curContents=t.trim(e.newNotiBar().text()),n.length>0&&0==curContents.length&&e.newNotiBar().html(n)}e.startMonitoring()})},"{newNotiButton} click":function(i,n){var o=t(i).data("type"),a=t(i).data("uid"),r=t(i).data("since");EasySocial.ajax("site/controllers/stream/getUpdates",{type:o,id:a,currentdate:r,source:e.options.source,view:e.options.source}).done(function(i,n,r){var s="[data-stream-counter-";"list"==o?s=s+o+"-"+a:s+=o,t(s+="]").parents("li").removeClass("has-notice"),t(s).html("0"),t.each(r,function(t,i){e.item().where("id",i).remove()}),e.newNotiBar().html(""),t.buildHTML(i).prependTo(e.list()).addController("EasySocial.Controller.Stream.Item"),e.clearExcludeIds(),e.element.data("currentdate",n)})},"{paginationGuest} click":function(){e.loadMoreGuest()},loadMoreGuest:function(){var i=e.paginationGuest(),n=i.data("nextlimit"),o=e.options.source;n&&(e.loading=!0,i.html(e.view.loadingContent({content:""})),EasySocial.ajax("site/controllers/stream/loadmoreGuest",{startlimit:n,view:o}).done(function(n,o){i.data({nextlimit:o}),(n=t.buildHTML(n)).insertBefore(i).filter(e.item.selector).addController("EasySocial.Controller.Stream.Item");try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(e){}""==o?i.html(""):i.html(e.view.loadmoreContent())}).fail(function(e){return e}).always(function(){e.loading=!1}))},"{paginationCluster} click":function(){e.loadMore(!0)},"{pagination} click":function(){e.loadMore()},loadMore:function(i){var n=t("[data-dashboardSidebar-menu].active"),o=n.data("type"),a=n.data("id");tag=n.data("tag"),fid=n.data("fid");var r=!0===i?e.paginationCluster():e.pagination(),s=r.data("nextlimit"),l=r.data("context"),c=e.options.source;s&&(void 0==o&&void 0==a&&"profile"==e.options.source&&(o="me",a=e.options.sourceId),e.loading=!0,r.html(e.view.loadingContent({content:""})),EasySocial.ajax("site/controllers/stream/loadmore",{id:a,type:o,startlimit:s,view:c,tag:tag,filterId:fid,context:l,iscluster:i}).done(function(i,n){r.data({nextlimit:n}),(i=t.buildHTML(i)).insertBefore(r).filter(e.item.selector).addController("EasySocial.Controller.Stream.Item"),e.setLayout();try{MathJax&&MathJax.Hub.Queue(["Typeset",MathJax.Hub])}catch(e){}""==n?r.html(""):r.html(e.view.loadmoreContent())}).fail(function(e){return e}).always(function(){e.loading=!1}))}}}),e.resolve()})}),EasySocial.module("site/subscriptions/follow",function(){var e=this;EasySocial.require().language("COM_EASYSOCIAL_SUBSCRIPTION_INFO").done(function(t){EasySocial.Controller("Follow",{defaultOptions:{}},function(e){return{init:function(){},"{self} click":function(){EasySocial.ajax("site/controllers/subscriptions/toggle",{uid:e.element.data("id"),type:e.element.data("type"),notify:"1"}).done(function(i,n){e.element.text(n),EasySocial.dialog({title:t.language("COM_EASYSOCIAL_SUBSCRIPTION_INFO"),content:i})}).fail(function(t){e.setMessage(t,"error")})}}}),e.resolve()})}),EasySocial.module("site/system/broadcast",function(e){var t=this;EasySocial.require().library("gritter").done(function(e){EasySocial.Controller("System.Broadcast",{defaultOptions:{interval:30,sticky:!1,period:8}},function(t){return{init:function(){t.startMonitoring()},startMonitoring:function(){var e=1e3*t.options.interval;t.options.state=setTimeout(t.check,e)},stopMonitoring:function(){clearTimeout(t.options.state)},check:function(){t.stopMonitoring();var i=1e3*t.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/getBroadcasts").done(function(i){i&&e(i).each(function(i,n){e.gritter.add({title:n.title,text:n.content,image:n.authorAvatar,sticky:t.options.sticky,time:1e3*t.options.period,class_name:"es-broadcast"})}),t.startMonitoring()})},i)}}}),t.resolve()})}),EasySocial.module("site/toolbar/conversations",function(e){var t=this;EasySocial.require().library("tinyscrollbar").done(function(e){EasySocial.Controller("Notifications.Conversations",{defaultOptions:{interval:30,"{counter}":"[data-notificationConversation-counter]"}},function(e){return{init:function(){e.startMonitoring()},startMonitoring:function(){var t=1e3*e.options.interval;EasySocial.debug,e.options.state=setTimeout(e.check,t)},stopMonitoring:function(){EasySocial.debug,clearTimeout(e.options.state)},check:function(){e.stopMonitoring();var t=1e3*e.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/getConversationCounter").done(function(t){t>0?(e.element.addClass("has-notice"),e.counter().html(t)):e.element.removeClass("has-notice"),e.startMonitoring()})},t)}}}),t.resolve()})}),EasySocial.module("site/toolbar/friends",function(e){var t=this;EasySocial.require().library("tinyscrollbar").language("COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED").done(function(e){EasySocial.Controller("Notifications.Friends",{defaultOptions:{interval:3,returnURL:"","{counter}":"[data-notificationFriends-counter]","{loadRequestsButton}":".loadRequestsButton"}},function(e){return{init:function(){e.startMonitoring()},startMonitoring:function(){var t=1e3*e.options.interval;EasySocial.debug,e.options.state=setTimeout(e.check,t)},stopMonitoring:function(){EasySocial.debug,clearTimeout(e.options.state)},check:function(){e.stopMonitoring();var t=1e3*e.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/friendsCounter").done(function(t){t>0?(e.element.addClass("has-notice"),e.counter().html(t)):e.element.removeClass("has-notice"),e.startMonitoring()})},t)}}}),EasySocial.Controller("Notifications.Friends.Item",{defaultOptions:{"{actionsWrapper}":"[data-friend-item-actions]","{acceptFriend}":"[data-friend-item-accept]","{rejectFriend}":"[data-friend-item-reject]","{actions}":"[data-friend-item-action]","{title}":"[data-friend-item-title]","{mutual}":"[data-friend-item-mutual]",view:{loader:"site/loading/small"}}},function(t){return{init:function(){},"{acceptFriend} click":function(i,n){n.stopPropagation();var o=e("[data-notifications-friends]").controller();t.actionsWrapper().addClass("friend-adding"),EasySocial.ajax("site/controllers/friends/approve",{viewCallback:"notificationsApprove",id:e(i).data("id")}).done(function(e,i){if(t.actionsWrapper().removeClass("friend-adding").addClass("added-friends"),t.title().html(e),t.mutual().html(i),o){var n=o.counter().html();n=(n=(n=parseInt(n))-1).toString(),o.counter().html(n),0==n&&o.element.removeClass("has-notice")}}).fail(function(e){t.element.html(e.message)})},"{rejectFriend} click":function(i,n){n.stopPropagation(),EasySocial.ajax("site/controllers/friends/reject",{id:e(i).data("id")}).done(function(i){t.actionsWrapper().html(e.language("COM_EASYSOCIAL_FRIENDS_REQUEST_REJECTED"))}).fail(function(e){t.element.html(e.message)})}}}),t.resolve()})}),EasySocial.module("site/toolbar/login",function(e){var t=this;EasySocial.require().library("popbox").done(function(e){EasySocial.Controller("Toolbar.Login",{defaultOptions:{"{dropdown}":"[data-toolbar-login-dropdown]"}},function(t){return{init:function(){var e=t.dropdown().html(),i=t.dropdown().data("dropdown-position");t.dropdown().remove(),t.element.popbox({content:e,id:"fd",component:"es",type:"toolbar",toggle:"click",position:i,collision:"flip none"}).attr("data-popbox","")},"{self} popboxActivate":function(t,i,n){e(n.tooltip).find("label").on("click",function(e){e.stopPropagation()})}}}),t.resolve()})}),EasySocial.module("site/toolbar/notifications",function(e){var t=this;EasySocial.require().script("site/toolbar/friends","site/toolbar/story","site/toolbar/system","site/toolbar/profile","site/toolbar/login","site/toolbar/conversations").done(function(e){EasySocial.Controller("Notifications",{defaultOptions:{friendsInterval:30,systemInterval:30,"{friendNotifications}":"[data-notifications-friends]","{conversationNotifications}":"[data-notifications-conversations]","{systemNotifications}":"[data-notifications-system]","{profileItem}":"[data-toolbar-profile]","{storyForm}":"[data-toolbar-story]","{login}":"[data-toolbar-login]","{item}":"[data-toolbar-item]"}},function(t){return{init:function(){t.login().addController(EasySocial.Controller.Toolbar.Login),t.profileItem().addController(EasySocial.Controller.Toolbar.Profile,{interval:t.options.systemInterval}),t.systemNotifications().addController(EasySocial.Controller.Notifications.System,{interval:t.options.systemInterval}),t.friendNotifications().addController(EasySocial.Controller.Notifications.Friends,{interval:t.options.friendsInterval}),t.conversationNotifications().addController(EasySocial.Controller.Notifications.Conversations,{interval:t.options.friendsInterval}),t.storyForm().addController(EasySocial.Controller.Notifications.Story),t.setLayout(),e("body").on("click.out-of-dropdown",function(){t.item().removeClass("open")})},"{window} resize":e.debounce(function(){t.setLayout()},250),setLayout:function(){var i=t.element,n=i.outerWidth(!0)-80,o=0;t.item().each(function(){o+=e(this).outerWidth(!0)});var a=o>n;i.toggleClass("narrow",a).toggleClass("wide",!a)}}}),t.resolve()})}),EasySocial.module("site/toolbar/story",function(e){var t=this;EasySocial.require().done(function(e){EasySocial.Controller("Notifications.Story",{defaultOptions:{"{loadFormButton}":".loadFormButton","{dropdown}":".dropdown-menu"}},function(e){return{init:function(){},"{dropdown} click":function(e,t){},"{self} hideDropdown":function(){},"{dropdown} click":function(e,t){t.stopPropagation()}}}),t.resolve()})}),EasySocial.module("site/toolbar/system",function(e){var t=this;EasySocial.require().view("site/notifications/system.empty").library("tinyscrollbar").done(function(e){EasySocial.Controller("Notifications.System",{defaultOptions:{pageTitle:null,interval:30,"{counter}":"[data-notificationSystem-counter]"}},function(t){return{init:function(){t.options.pageTitle=e(document).attr("title"),t.startMonitoring()},startMonitoring:function(){var e=1e3*t.options.interval;EasySocial.debug,t.options.state=setTimeout(t.check,e)},stopMonitoring:function(){EasySocial.debug,clearTimeout(t.options.state)},check:function(){t.stopMonitoring();var i=1e3*t.options.interval;setTimeout(function(){EasySocial.ajax("site/controllers/notifications/getSystemCounter").done(function(i){i>0?(e(document).attr("title",t.options.pageTitle+" ("+i+")"),t.element.addClass("has-notice"),t.counter().html(i)):(t.element.removeClass("has-notice"),e(document).attr("title",t.options.pageTitle)),t.startMonitoring()})},i)},"{window} easysocial.clearSystemNotification":function(){t.element.removeClass("has-notice"),t.counter().html(0)}}}),EasySocial.Controller("Notifications.System.Popbox",{defaultOptions:{"{readall}":"[data-notificationsystem-readall]","{items}":"[data-notificationsystem-items]",view:{empty:"site/notifications/system.empty"}}},function(t){return{init:function(){},"{readall} click":function(){e("[data-notificationSystem-counter]").parents("li").removeClass("has-notice"),e("[data-notificationSystem-counter]").html(0),EasySocial.ajax("site/controllers/notifications/setAllState",{state:"read"}).done(function(){t.items().html(""),t.items().append(t.view.empty()),t.items().addClass("is-empty"),e(window).trigger("easysocial.clearSystemNotification")})}}}),t.resolve()})}),EasySocial.module("site/toolbar/profile",function(e){var t=this;EasySocial.require().library("popbox").done(function(e){EasySocial.Controller("Toolbar.Profile",{defaultOptions:{"{dropdown}":"[data-toolbar-profile-dropdown]"}},function(t){return{init:function(){var e=t.dropdown().html(),i=(i=t.dropdown().data("dropdown-position"))||"bottom-right";t.element.popbox({content:e,id:"fd",component:"es",type:"toolbar",toggle:"click",position:i,collision:"flip none"}).attr("data-popbox","")},"{self} popboxActivate":function(t,i,n){e(n.tooltip).implement(EasySocial.Controller.Toolbar.Profile.Logout)}}}),EasySocial.Controller("Toolbar.Profile.Logout",{defaultOptions:{"{logoutForm}":"[data-toolbar-logout-form]","{logoutButton}":"[data-toolbar-logout-button]"}},function(e){return{logout:function(){e.logoutForm().submit()},"{logoutButton} click":function(){e.logout()}}}),t.resolve()})}),EasySocial.module("site/users/popbox",function(e){var t=this;EasySocial.require().library("popbox").done(function(){EasySocial.module("users/popbox",function(e){this.resolve(function(e){var t=e.button.data("ids"),i=e.button.attr("data-popbox-position")||"top-left";return{content:EasySocial.ajax("site/views/users/popbox",{ids:t}),id:"fd",component:"es",type:"users",position:i}})})}),t.resolve()}),EasySocial.module("site/users/users",function(e){var t=this;EasySocial.require().library("history").view("site/loading/small","site/users/button.following").done(function(e){EasySocial.Controller("Users",{defaultOptions:{"{content}":"[data-users-content]","{listing}":"[data-users-listing]","{sort}":"[data-users-sort]","{filter}":"[data-users-filter]","{items}":"[data-users-item]","{pagination}":"[data-users-pagination]","{profile}":"[data-users-filter-profile]","{search}":"[data-users-filter-search]",view:{loading:"site/loading/small"}}},function(t){return{init:function(){t.initUserController()},initUserController:function(){t.items().implement(EasySocial.Controller.Users.Item,{"{parent}":t})},removeActiveFilter:function(){t.filter().each(function(){e(this).parent().removeClass("active")}),t.profile().each(function(){e(this).parent().removeClass("active")}),t.search().each(function(){e(this).parent().removeClass("active")})},"{profile} click":function(i,n){n.preventDefault();var o=e(i).data("id");t.removeActiveFilter(),e(i).parent().addClass("active"),e(i).route(),t.listing().html(t.view.loading()),EasySocial.ajax("site/controllers/users/getUsersByProfile",{id:o}).done(function(e){t.content().html(e),t.initUserController()})},"{search} click":function(i,n){n.preventDefault();var o=e(i).data("id");t.removeActiveFilter(),e(i).parent().addClass("active"),e(i).route(),t.listing().html(t.view.loading()),EasySocial.ajax("site/controllers/users/getUsersByFilter",{id:o}).done(function(e){t.content().html(e),t.initUserController()})},"{filter} click":function(i,n){n.preventDefault(),t.sort().removeClass("active"),t.removeActiveFilter(),e(i).parent().addClass("active");var o=e(i).data("filter");t.options.filter=o,e(i).route(),t.listing().html(t.view.loading()),t.sort(":first").addClass("active"),EasySocial.ajax("site/controllers/users/getUsers",{filter:o,showpagination:1}).done(function(e){t.content().html(e),t.initUserController()})},"{sort} click":function(i,n){n.preventDefault();var o=e(i).data("type");e("<a>").attr({title:document.title,href:e(i).attr("href")}).route(),t.sort().removeClass("active"),e(i).addClass("active"),t.listing().html(t.view.loading()),t.pagination().remove(),EasySocial.ajax("site/controllers/users/getUsers",{sort:o,filter:t.options.filter,isSort:!0,showpagination:1}).done(function(e){t.listing().html(e),t.initUserController()})}}}),EasySocial.Controller("Users.Item",{defaultOptions:{id:null,"{followUser}":"[data-es-followers-follow]","{addFriend}":"[data-users-add-friend]","{friendsButton}":"[data-users-friends-button]","{compose}":"[data-users-friends-compose]","{unfriend}":"[data-users-friends-unfriend]",view:{followingButton:"site/users/button.following"}}},function(t){return{init:function(){t.options.id=t.element.data("id")},"{followUser} following":function(i,n){e(i).popbox("hide"),e(i).replaceWith(t.view.followingButton())},"{addFriend} click":function(i,n){e(i).addClass("btn-loading"),EasySocial.ajax("site/controllers/friends/request",{viewCallback:"usersRequest",id:t.options.id}).done(function(t){e(i).replaceWith(t),e(i).removeClass("btn-loading")}).fail(function(e){EasySocial.dialog({content:EasySocial.ajax("site/views/friends/exceeded")})})}}}),t.resolve()})}),EasySocial.module("story",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_STREAM_META_JOINER").view("apps/user/links/story/attachment.item","site/location/story.suggestion","site/albums/upload.item","site/friends/suggest.item","site/friends/suggest.hint.search","site/friends/suggest.hint.empty","site/hashtags/suggest.item","site/hashtags/suggest.hint.search","site/hashtags/suggest.hint.empty").done(),EasySocial.require().script("story/locations","story/friends","story/mood"),EasySocial.require().library("mentions","placeholder").script("site/stream/item").language("COM_EASYSOCIAL_STORY_SUBMIT_ERROR","COM_EASYSOCIAL_STORY_CONTENT_EMPTY","COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER").done(function(){EasySocial.Controller("Story",{defaultOptions:{view:{suggestItem:"site/friends/suggest.item",tagSuggestItem:"site/hashtags/suggest.item"},plugin:{text:{id:"text",name:"text",selector:"[data-story-plugin-name=photos]",type:"panel"}},sourceView:null,attachment:{limit:1,lifo:!0},enterToSubmit:!1,"{header}":"[data-story-header]","{body}":"[data-story-body]","{footer}":"[data-story-footer]","{form}":"[data-story-form]","{textbox}":"[data-story-textbox]","{textField}":"[data-story-textField]","{target}":"[data-story-target]","{cluster}":"[data-story-cluster]","{clusterType}":"[data-story-clustertype]","{submitButton}":"[data-story-submit]","{resetButton}":"[data-story-reset]","{privacyButton}":"[data-story-privacy]","{panelContents}":"[data-story-panel-contents]","{panelContent}":"[data-story-panel-content]","{panelButton}":"[data-story-panel-button]","{streamContainer}":"[data-streams]","{streamItem}":"[data-streamItem]","{friends}":"[data-story-friends]","{location}":"[data-story-location]","{mood}":"[data-story-mood]","{mentionsOverlay}":"[data-mentions-overlay]","{meta}":"[data-story-meta]","{metaContents}":"[data-story-meta-contents]","{metaContent}":"[data-story-meta-content]","{metaButtons}":"[data-story-meta-buttons]","{metaButton}":"[data-story-meta-button]"},hostname:"story"},function(t,i,n){return{init:function(){t.id=n.data("story"),e.each(t.options.plugin,function(e,i){var n=t.plugins[e]=i;"attachment"==n.type&&t.attachments.max++,n.selector=t.getPluginSelector(e)}),t.setMentionsLayout(),t.friends().length>0&&EasySocial.module("story/friends").done(function(){t.addPlugin("friends")}),t.location().length>0&&EasySocial.module("story/locations").done(function(){t.addPlugin("locations")}),t.mood().length>0&&EasySocial.module("story/mood").done(function(){t.addPlugin("mood")}),t.placeholder=t.textField().attr("placeholder"),t._setMessage=t.setMessage,t.setMessage=function(){n.hasClass("is-collapsed")||n.hasClass("is-resizing")||t._setMessage.apply(this,arguments)},navigator.userAgent.match(/MSIE 9.0/i)&&n.addClass("is-ie"),t.checkResetButton(),e.module("story-"+t.id).resolve(t)},checkResetButton:function(){var e=t.textField(),i=e.attr("data-default");i&&t.resetButton().toggle(e.val()!==i)},"{textField} keyup":e.debounce(function(e){t.checkResetButton()},250,{leading:!0}),"{self} click":function(i,n){e(n.target).parents().andSelf().filter(t.resetButton()[0]).length>0||t.expand()},"{textField} touchstart":function(){t.expand()},"{textField} keydown":function(e,i){t.expand()},"{textField} click":function(){t.expand()},"{textField} mousedown":function(e,i){t.expand()},"{textField} keypress":function(e,n){i.enterToSubmit&&13==n.keyCode&&!(n.shiftKey||n.altKey||n.ctrlKey||n.metaKey)&&(t.save(),n.preventDefault())},expand:e.debounce(function(){if(!n.hasClass("is-expanded")&&!n.hasClass("is-resizing")){var i=e.support&&e.support.transition&&e.support.transition.end,o=(i||"transitionend")+".es.story",a=e.debounce(function(){n.off(o).addClass("is-expanded").removeClass("is-resizing"),t.setMentionsLayout(),t.submitButton().removeAttr("data-disabled"),t.textField().focus()},1);i?n.on(o,a):setTimeout(a,600),n.removeClass("is-collapsed").addClass("is-resizing")}},1),collapse:function(){n.hasClass("is-collapsed")||n.hasClass("is-resizing")||(n.addClass("is-resizing").removeClass("is-expanded"),setTimeout(function(){n.addClass("is-collapsed").removeClass("is-resizing")},1))},reset:function(e){t.clear(),""===t.textField().val()&&e&&t.collapse()},setMentionsLayout:function(){var i=t.textbox(),n=i.controller("mentions");if(n)n.cloneLayout();else{var o=t.body();i.mentions({triggers:{"@":{type:"entity",wrap:!1,stop:"",allowSpace:!0,finalize:!0,query:{loadingHint:!0,searchHint:e.View("easysocial/site/friends/suggest.hint.search"),emptyHint:e.View("easysocial/site/friends/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/friends/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title=e.screenName,e.type="user",e.menuHtml=t.view.suggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n},use:function(e){return e.type+":"+e.id}}},"#":{type:"hashtag",wrap:!0,stop:" #",allowSpace:!1,query:{loadingHint:!0,searchHint:e.View("easysocial/site/hashtags/suggest.hint.search"),emptyHint:e.View("easysocial/site/hashtags/suggest.hint.empty"),data:function(i){var n=e.Deferred();return EasySocial.ajax("site/controllers/hashtags/suggest",{search:i}).done(function(i){e.isArray(i)||n.reject();var i=e.map(i,function(e){return e.title="#"+e.title,e.type="hashtag",e.menuHtml=t.view.tagSuggestItem(!0,{item:e,name:"uid[]"}),e});n.resolve(i)}).fail(n.reject),n}}}},plugin:{autocomplete:{id:"fd",component:"es",modifier:"es-story-mentions-autocomplete",sticky:!0,shadow:!0,position:{my:"left top",at:"left bottom",of:i.parent(),collision:"none"},size:{width:function(){return o.width()}}}}})}},plugins:{},getPluginName:function(t){return e(t).data("story-plugin-name")},getPluginSelector:function(e){return"[data-story-plugin-name="+e+"]"},hasPlugin:function(e,i){var n=t.plugins[e];return!!n&&(!i||n.type===i)},buildPluginSelectors:function(i,n,o){var a={};return e.each(i,function(e,i){var r=t[i].selector+n.selector;"function"==o?a[i]=function(){return t.find(r)}:a["{"+i+"}"]=r}),a},"{self} addPlugin":function(i,n,o,a,r,s){if(t.hasPlugin(o)){var l=t.plugins[o],c={};switch(l.type){case"panel":var d=["panelButton","panelContent"];c=t.buildPluginSelectors(d,l,s)}e.extend(r,c)}},"{self} registerPlugin":function(e,i,n,o){t.hasPlugin(n)&&(t.plugins[n].instance=o)},panels:{},currentPanel:"text",getPanel:function(e){if(t.hasPlugin(e,"panel")){var i=t.plugins[e];return t.panels[i.name]||(t.panels[i.name]={plugin:i,button:t.panelButton(i.selector),content:t.panelContent(i.selector)})}},activatePanel:function(e){var i=t.getPanel(e);if(i){t.deactivatePanel(t.currentPanel),t.currentPanel=e;var o=t.panelContents();o.addClass("active"),i.button.addClass("active"),i.content.appendTo(o).addClass("active"),n.addClass("plugin-"+e),t.invokePlugin(e,"activatePanel",[i]),t.trigger("activatePanel",[e]),t.textField().focus()}},deactivatePanel:function(e){var i=t.getPanel(e);i&&(i.button.removeClass("active"),i.content.removeClass("active"),n.removeClass("plugin-"+e),t.panelContents().removeClass("active"),t.invokePlugin(e,"deactivatePanel",[i]),t.trigger("deactivatePanel",[e]))},addPanelCaption:function(e,i){var n=t.getPanel(e);n&&n.button.addClass("has-data").find(".with-data").html(i)},removePanelCaption:function(e){var i=t.getPanel(e);i&&i.button.removeClass("has-data").find(".with-data").empty()},"{panelButton} click":function(e,i){var n=t.getPluginName(e);t.activatePanel(n)},saving:!1,save:function(){if(!t.saving){t.saving=!0;var i=e.Deferred();i.data={},i.tasks=[],i.addData=function(n,o){var a=n.options.name;n.options.type;a===t.currentPanel&&(i.data.attachment=t.currentPanel,e.isPlainObject(o)?e.each(o,function(e,t){i.data[a+"_"+e]=t}):i.data[a]=o)},i.addTask=function(t){var n=e.Deferred();return n.name=t,n.save=i,i.tasks.push(n),n},i.process=function(){return"pending"===i.state()&&e.when.apply(e,i.tasks).done(function(){e.trim(i.data.content)||i.data.attachment?i.resolve():i.reject(e.language("COM_EASYSOCIAL_STORY_CONTENT_EMPTY"),"warning")}).fail(i.reject),i},i.currentPanel=t.currentPanel,t.trigger("save",[i]),t.element.addClass("saving"),i.process().done(function(){var n=t.textbox().mentions("controller").toArray(),o=t.element.data("storyHashtags"),a=!1;if((o=o?o.split(","):[]).length>0){var r=e.map(n,function(t){if("hashtag"===t.type&&e.inArray(t.value,o)>-1)return t});a=r.length<1}t.trigger("beforeSubmit",[i]),EasySocial.ajax("site/controllers/story/create",i.data).done(function(i,n){a&&(i=t.setMessage(e.language("COM_EASYSOCIAL_STORY_NOT_ON_STREAM_FILTER"))),t.trigger("create",[i,n]),t.clear(),t.reset()}).fail(function(e){t.trigger("fail",arguments),e&&t.setMessage(e.message,e.type)}).always(function(){t.element.removeClass("saving"),t.saving=!1})}).fail(function(i,n){i||(i=e.language("COM_EASYSOCIAL_STORY_SUBMIT_ERROR"),n="error"),t.setMessage(i,n),t.element.removeClass("saving"),t.saving=!1})}},clear:function(){t.textField().val(""),t.clearMessage(),t.activatePanel("text"),t.deactivateMeta(t.currentMeta),t.trigger("clear");var e=t.textbox().mentions("controller");e.reset(),t.checkResetButton(),setTimeout(function(){e.cloneLayout()},500),t.textField().focus()},"{self} save":function(i,n,o){var a=t.textField().val(),r=o.data;r.view=t.options.sourceView,r.content=a,r.target=t.target().val(),r.cluster=t.cluster().val(),r.clusterType=t.clusterType().val(),r.privacy=t.find("[data-privacy-hidden]").val(),r.privacyCustom=t.find("[data-privacy-custom-hidden]").val();var s=t.textbox().mentions("controller").toArray();r.mentions=e.map(s,function(t){return"hashtag"===t.type&&e.isPlainObject(t.value)&&(t.value=t.value.title.slice(1)),JSON.stringify(t)})},"{submitButton} click":function(e,i){t.save()},"{resetButton} click":function(){t.reset(!0)},"{privacyButton} click":function(e){setTimeout(function(){e.find("[data-es-privacy-container]").hasClass("active")},1)},metas:{friends:"",location:"",mood:""},currentMeta:null,getMeta:function(e){var i={name:e,button:t.metaButton().filterBy("storyMetaButton",e),content:t.metaContent().filterBy("storyMetaContent",e)};return i.button.length<1||i.content.length<1?null:i},activateMeta:function(e){var i=t.getMeta(e);i&&(t.deactivateMeta(t.currentMeta),i.button.addClass("active"),i.content.appendTo(t.metaContents()).addClass("active"),t.currentMeta=e,t.trigger("activateMeta",[i]),n.addClass("has-meta"))},deactivateMeta:function(e){var i=t.getMeta(e);i&&(i.button.removeClass("active"),i.content.removeClass("active"),t.currentMeta=null,t.trigger("deactivateMeta",[i]),n.removeClass("has-meta"))},toggleMeta:function(e){t.currentMeta==e?t.deactivateMeta(e):t.activateMeta(e)},getMetaText:function(){var i=t.metas,n=[],o=e.language("COM_EASYSOCIAL_STREAM_META_JOINER");return e.each(["friends","location","mood"],function(e,t){var o=i[t];o&&n.push(o)}),n.join(o)},setMeta:function(e,i){t.metas[e]=i,t.updateMeta()},updateMeta:e.debounce(function(){var i=t.getMetaText(),n=t.meta(),o=t.textField();if(e.each(t.metas,function(e,i){var n=t.getMeta(e);n&&n.button.toggleClass("has-content",!!i)}),!i)return n.remove(),void o.attr("placeholder",t.placeholder);n.length<1&&(n=e('<u class="es-story-meta" data-story-meta data-ignore></u>').appendTo(t.mentionsOverlay())),n.html(" &mdash; "+i),o.attr("placeholder",""),t.setMentionsLayout()},1),refreshMeta:function(){t.trigger("refreshMeta"),t.updateMeta()},"{textbox} triggerClear":function(){t.refreshMeta()},"{meta} click":function(i,n){e(n.target).is("a")||t.textField().focus()},"{metaButton} click":function(e){var i=e.attr("data-story-meta-button");t.toggleMeta(i)}}}),t.resolve()})}),EasySocial.module("story/broadcast",function(e){var t=this;EasySocial.require().done(function(){EasySocial.Controller("Story.Broadcast",{defaultOptions:{"{profile}":"[data-broadcast-profile]","{title}":"[data-broadcast-title]","{link}":"[data-broadcast-link]","{message}":"[data-broadcast-message]"}},function(e){return{init:function(){},"{story} save":function(t,i,n){var o={broadcast:"1",profileId:e.profile().val(),title:e.title().val(),link:e.link().val()};n.addData(e,o)},"{story} beforeSubmit":function(t,i,n){"broadcast"==n.currentPanel&&(n.data.content=e.message().val())}}}),t.resolve()})}),EasySocial.module("story/event",function(e){var t=this,i=EasySocial.options.momentLang;EasySocial.require().library("datetimepicker","moment/"+i).view("site/loading/small").language("COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA","COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME").done(function(){EasySocial.Controller("Story.Event",{defaultOptions:{"{base}":"[data-story-event-base]","{category}":"[data-story-event-category]","{form}":"[data-story-event-form]","{timezone}":"[data-event-timezone]","{datetimeForm}":"[data-event-datetime-form]","{datetime}":"[data-event-datetime]","{title}":"[data-event-title]","{description}":"[data-event-description]",view:{loading:"site/loading/small"}}},function(t){return{init:function(){},"{category} change":function(i,n){i.val()?(t.form().show().html(t.view.loading()),t.loadStoryForm(i.val()).done(function(i){t.form().html(i);var n,o=t.datetimeForm().htmlData();n=e.isEmpty(o.yearto)?(new Date).getFullYear()+100:parseInt(o.yearto)+1,e.extend(t.options,{yearfrom:o.yearfrom||1930,yearto:n,allowTime:o.allowtime,allowTimezone:o.allowtimezone,dateFormat:o.dateformat,disallowPast:o.disallowpast,minuteStepping:parseInt(o.minutestepping)}),t.datetime().addController("EasySocial.Controller.Story.Events.Datetime",{"{parent}":t})})):t.form().hide().html("")},loadStoryForm:e.memoize(function(e){return EasySocial.ajax("apps/user/events/controllers/events/loadStoryForm",{id:e})}),"{story} save":function(e,i,n){if("event"==n.currentPanel){var o={title:t.title().val(),description:t.description().val(),category:t.category().val()};t.options.allowTimezone&&(o.timezone=t.timezone().val()),t.datetime().trigger("datetimeExport",[o]),t.options.name="event";var a=n.addTask("validateEventForm");t.save(a,o)}},save:function(i,n){return e.isEmpty(n.title)||e.isEmpty(n.category)||e.isEmpty(n.start)?i.reject(e.language("COM_EASYSOCIAL_STORY_EVENT_INSUFFICIENT_DATA")):!e.isEmpty(n.start)&&!e.isEmpty(n.end)&&n.end<n.start?i.reject(e.language("COM_EASYSOCIAL_STORY_EVENT_INVALID_START_END_DATETIME")):(i.save.addData(t,n),void i.resolve())}}}),EasySocial.Controller("Story.Events.Datetime",{defaultOptions:{type:null,"{picker}":"[data-picker]","{toggle}":"[data-picker-toggle]","{datetime}":"[data-datetime]"}},function(t){return{init:function(){t.options.type=t.element.data("event-datetime");var n=new e.moment;t.parent.options.disallowPast?n.date(n.date()-1):n.year(t.parent.options.yearfrom),t.picker()._datetimepicker({component:"es",useCurrent:!1,format:t.parent.options.dateFormat,minDate:n,maxDate:new e.moment({y:t.parent.options.yearto}),icons:{time:"glyphicon glyphicon-time",date:"glyphicon glyphicon-calendar",up:"glyphicon glyphicon-chevron-up",down:"glyphicon glyphicon-chevron-down"},sideBySide:!1,pickTime:1==t.parent.options.allowTime,minuteStepping:t.parent.options.minuteStepping,language:i});var o=e.moment();o.minute(0),o.second(0),"end"==t.options.type&&o.hour(o.hour()+1),t.datetimepicker("setDate",o)},datetimepicker:function(e,i){return t.picker().data("DateTimePicker")[e](i)},"{toggle} click":function(){t.picker().focus()},"{picker} dp.change":function(i,n){t.setDateValue(n.date.toDate()),t.parent.element.trigger("event"+e.String.capitalize(t.options.type),[n.date])},setDateValue:function(e){t.datetime().val(e.getFullYear()+"-"+("00"+(e.getMonth()+1)).slice(-2)+"-"+("00"+e.getDate()).slice(-2)+" "+("00"+e.getHours()).slice(-2)+":"+("00"+e.getMinutes()).slice(-2)+":"+("00"+e.getSeconds()).slice(-2))},"{parent} eventStart":function(e,i,n){t.options.type},"{parent} eventEnd":function(e,i,n){t.options.type},"{self} datetimeExport":function(e,i,n){n[t.options.type]=t.datetime().val()}}}),t.resolve()})}),EasySocial.module("story/files",function(e){var t=this;EasySocial.require().library("plupload").view("apps/user/files/story/attachment.item","apps/user/files/story/progress").done(function(){EasySocial.Controller("Story.Files",{defaultOptions:{"{canvas}":"[data-files-canvas]","{dropsite}":"[data-files-dropsite]","{upload}":"[data-files-upload]","{uploadGroup}":"[data-files-items]","{fileItem}":"[data-files-item]","{removeItem}":"[data-files-item-remove]","{uploadItem}":"[data-files-upload-item]",settings:{url:null,max_file_size:null,filters:[]},view:{attachment:"apps/user/files/story/attachment.item",progress:"apps/user/files/story/progress"}}},function(t){return{items:{},init:function(){var i=e.extend({"{uploadButton}":t.upload.selector,"{uploadDropsite}":t.dropsite.selector},{settings:t.options.settings});t.uploader=t.canvas().addController("plupload",i),t.plupload=t.uploader.plupload,t.addPlugin("uploader",t.uploader),e.IE||"html5"!=t.plupload.runtime||t.canvas().addClass("can-drop-file"),t.canvas().addClass("can-upload"),t.setLayout()},hasItems:function(){var e=t.fileItem().length>0,i=t.uploadItem().length>0;return e||i},setLayout:function(){t.canvas().toggleClass("has-items",t.hasItems())},removeFile:function(e){t.fileItem().where("id",e).remove(),t.setLayout()},clearFiles:function(){t.fileItem().remove(),t.uploadItem().remove(),t.setLayout()},removeFileItem:function(e){var i=t.getItem(e);i&&(t.plupload.removeFile(i.file()),i.element.remove(),delete t.items[e],t.setLayout())},getItem:function(i){var n;return e.isString(i)&&(n=i),i&&i.id&&(n=i.id),t.items[n]},createItem:function(e){var i=t.view.progress({file:e});return t.uploadGroup().append(i),t.items[e.id]=i,t.setLayout(),t.trigger("QueueCreated",[i]),i},"{uploader} FilesAdded":function(i,n,o,a){try{a.reverse(),e.each(a,function(e,i){t.getItem(i)||t.createItem(i)})}catch(e){console.error(e)}t.setLayout(),t.uploader.plupload.start()},"{uploader} FileUploaded":function(e,i,n,o,a){var r=t.getItem(o),s=t.view.attachment({file:o,id:a.id});s.data("file-id",a.id).addClass("new-item").insertAfter(r),r.remove(),t.setLayout(),setTimeout(function(){s.removeClass("new-item")},1)},"{uploader} UploadProgress":function(i,n,o,a){var r=t.getItem(a);if(r){var s=void 0===a.size||"N/A"==a.size;a.percentage=a.percent+"%",a.filesize=s?"":e.plupload.formatSize(a.size),a.remaining=s?"":e.plupload.formatSize(a.size-(a.loaded||0));var l=a.percentage;"100%"==l&&(l="99%"),"0%"==l&&(l="1%"),r.find(".upload-progress-bar").width(l),r.find(".upload-percentage").html(l)}},"{uploader} FileError":function(e,i,n,o,a){t.story.setMessage(a.message,"error");var r=t.uploadingFile;r&&(r.reject(),delete t.uploadingFile),t.setLayout()},"{uploader} Error":function(e,i,n,o){t.story.setMessage(o.message,"error");var a=t.uploadingFile;a&&(a.reject(),delete t.uploadingFile),t.removeItem().click(function(){setTimeout(function(){t.setLayout()},1)}),t.setLayout()},"{removeItem} click":function(e){var i=e.parent(t.fileItem.selector).data("id");t.removeFile(i)},"{story} save":function(e,i,n){t.hasItems()&&(t.uploadingFile=n.addTask("uploadingFile"),t.save())},save:function(){var i=t.uploadingFile;if(i){var n=t.fileItem();if(n.length){var o=[];save=i.save,n.each(function(){o.push(e(this).data("id"))}),save.addData(t,o),i.resolve(),delete t.uploadingFile}}},"{story} clear":function(){t.clearFiles()}}}),t.resolve()})}),EasySocial.module("story/friends",function(e){var t=this;EasySocial.require().library("textboxlist").language("COM_EASYSOCIAL_STREAM_STORY_WITH","COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER","COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER","COM_EASYSOCIAL_AND").done(function(){EasySocial.Controller("Story.Friends",{defaultOptions:{"{friendList}":".es-story-friends-textbox","{textField}":".es-story-friends-textbox [data-textboxlist-textfield]"}},function(t){return{init:function(){t.textField().placeholder(),t.friendList().textboxlist({component:"es",plugin:{autocomplete:{exclusive:!0,cache:!1,query:t.search,filterItem:t.createMenuItem,component:"es",modifier:"es-story-friends-autocomplete",sticky:!0,shadow:!0}}})},search:function(e){var i=t.getTaggedUsers();return EasySocial.ajax("site/controllers/friends/suggest",{search:e,exclude:i})},getTaggedUsers:function(){var t=[],i=e("[data-textboxlist-item]");return i.length>0&&e.each(i,function(i,n){t.push(e(n).data("id"))}),t},createMenuItem:function(t,i){t.title=t.screenName;var n=e(new Image).addClass("textboxlist-menu-avatar").attr({src:t.avatar}).toHTML();return t.html=n+" "+t.title,t.menuHtml=n+" "+t.title,t},mention:function(i,n,o){t.search(n).done(function(t){var i=[];e.each(t,function(e,t){i.push({id:t.id,name:t.screenName,avatar:t.avatar,type:"contact"})}),o(i)})},updateMeta:function(){var i=t.friendList().controller("textboxlist").getAddedItems();if(i.length<1)t.story.setMeta("friends","");else{var n=i.length-1,o=e.language("COM_EASYSOCIAL_STREAM_STORY_WITH")+" ";e.each(i,function(t,i){if(o+='<a href="'+i.permalink+'" target="_blank">'+i.screenName+"</a>",t!=n){var a=e.language("COM_EASYSOCIAL_STREAM_STORY_WITH_JOINER");t==n-1&&(a=e.language("COM_EASYSOCIAL_STREAM_STORY_WITH_LAST_JOINER")),o+=a}}),t.story.setMeta("friends",o)}},"{friendList} addItem":function(){t.updateMeta()},"{friendList} removeItem":function(){t.updateMeta()},"{story} activateMeta":function(e,i,n){"friends"===n.name&&setTimeout(function(){t.textField().focus()},1)},"{story} save":function(e,i,n){var o=t.friendList().controller("textboxlist").getAddedItems().map(function(e){return e.id});n.data.friends_tags=o},"{story} clear":function(){t.friendList().controller("textboxlist").clearItems()}}}),t.resolve()})}),EasySocial.module("story/links",function(e){var t=this;EasySocial.require().view("apps/user/links/story/attachment.item").done(function(){EasySocial.Controller("Story.Links",{defaultOptions:{view:{linkItem:"apps/user/links/story/attachment.item"},urlParser:/(^|\s)(https?:\/\/)?(([a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.([a-z]{2,5}))|(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5]))(:[0-9]{1,5})?(\/.*)?/gi,"{linkForm}":"[data-story-link-form]","{linkInput}":"[data-story-link-input]","{linkContent}":"[data-story-link-content]","{linkItem}":"[data-story-link-item]","{linkTitle}":"[data-story-link-title]","{linkDescription}":"[data-story-link-description]","{linkImages}":"[data-story-link-images]","{linkImage}":"[data-story-link-image]","{linkVideo}":"[data-story-link-video]","{titleTextfield}":"[data-story-link-title-textfield]","{descriptionTextfield}":"[data-story-link-description-textfield]","{panelButton}":"[data-story-link-panel-button]","{attachButton}":"[data-story-link-attach-button]","{removeButton}":"[data-story-link-remove-button]","{removeThumbnail}":"[data-story-link-remove-image]"}},function(t){return{init:function(){t.linkInput().placeholder()},activateAttachment:function(){t.doNotFocus||setTimeout(function(){t.linkInput().focus(),t.doNotFocus=!1},500)},links:{},currentLink:null,crawling:!1,extractUrls:function(i){var n=t.options.urlParser,o=i.match(n);return e.isArray(o)?e.map(o,function(t,i){return e.trim(t)}):[]},fixUrl:function(t){var t=e.uri(t);return/http|https/.test(t.protocol())||t.setProtocol("http"),t.toString()},getLink:function(i){if(e.isString(i)&&(i=t.extractUrls(i)),!(i.length<0)){var n=i[0];return link=t.links[n]||t.createLink(n),link}},createLink:function(i){var n=t.links[i]=e.Deferred();return n.url=i,t.crawling=!0,EasySocial.ajax("site/controllers/crawler/fetch",{urls:[i]}).done(function(o){var a=o[i];a||n.reject(),n.info=a;var r=a.opengraph||{},s=a.oembed||{},l=[];s.thumbnail&&l.push(s.thumbnail),r.image&&l.push(r.image),a.images&&e.merge(l,a.images),n.data={title:s.title||r.title||a.title,desc:s.description||r.desc||a.description,url:i,images:l,video:r.video?r.video:a.videos},n.item=t.view.linkItem(n.data).data("link",n),n.item.addController("EasySocial.Controller.Story.Links.Item"),n.resolve(n)}).fail(function(){n.reject()}).always(function(){t.crawling=!1}),n},addLink:function(e){t.linkContent().empty().append(e.item),t.linkForm().hide(),t.currentLink=e},removeLink:function(){t.linkItem().detach(),t.linkForm().show(),t.currentLink=null},"{attachButton} click":function(){t.linkInput();var i=t.linkForm();if(""!==(n=e.trim(t.linkInput().val()))){var n=t.fixUrl(n);t.linkInput().val(n),i.addClass("busy"),t.getLink(n).done(function(e){t.addLink(e)}).always(function(){i.removeClass("busy")})}},"{removeButton} click":function(e){t.currentLink.disabled=!0,t.removeLink()},"{story.textField} input":e._.debounce(function(e,i){if(!t.currentLink&&!t.crawling){var n=e.val(),o=t.extractUrls(n);if(a=o[o.length-1]){var a=t.fixUrl(a),r=t.links[a];r&&r.disabled||(t.linkInput().val(a),t.doNotFocus=!0,t.panelButton().click(),t.attachButton().click())}}},750),"{story} save":function(e,i,n){if(t.currentLink){var o={title:t.titleTextfield().val(),description:t.descriptionTextfield().val(),url:t.currentLink.url,video:t.linkVideo().val()};t.removeThumbnail().is(":checked")||(o.image=t.linkImage(".active").attr("src")),n.addData(t,o)}},"{story} clear":function(){t.linkInput().val(""),t.removeLink()}}}),EasySocial.Controller("Story.Links.Item",{defaultOptions:{"{previousImage}":"[data-story-link-image-prev]","{nextImage}":"[data-story-link-image-next]","{image}":"[data-story-link-image]","{imagesWrapper}":"[data-story-link-images]","{imageIndex}":"[data-story-link-image-index]","{removeThumbnail}":"[data-story-link-remove-image]","{title}":"[data-story-link-title]","{description}":"[data-story-link-description]","{titleTextfield}":"[data-story-link-title-textfield]","{descriptionTextfield}":"[data-story-link-description-textfield]"}},function(t){return{init:function(){},"{removeThumbnail} click":function(){var e=t.removeThumbnail().is(":checked");e?t.imagesWrapper().hide():t.imagesWrapper().show(),t.element.toggleClass("has-images",!e)},"{previousImage} click":function(){var i=t.image(".active").prev(),n=t.image(".active"),o=parseInt(t.imageIndex().html())-1;i.length>0&&(e(n).removeClass("active"),e(i).addClass("active"),t.imageIndex().html(o))},"{nextImage} click":function(){var i=t.image(".active").next(),n=t.image(".active"),o=parseInt(t.imageIndex().html())+1;i.length>0&&(e(n).removeClass("active"),e(i).addClass("active"),t.imageIndex().html(o))},"{title} click":function(){var e=t.element.hasClass("editing-title");t.element.toggleClass("editing-title",!e),e||t.editTitle()},editTitleEvent:"click.es.story.editLinkTitle",editTitle:function(){t.element.addClass("editing-title"),setTimeout(function(){t.titleTextfield().val(t.title().text()).focus()[0].select(),e(document).on(t.editTitleEvent,function(e){e.target!==t.titleTextfield()[0]&&t.saveTitle("save")})},1)},saveTitle:function(i){i||(i=save);var n=t.titleTextfield().val();switch(i){case"save":""===n&&(n=t.title().data("default")),t.title().html(n)}t.element.removeClass("editing-title"),e(document).off(t.editTitleEvent)},"{titleTextfield} keyup":function(e,i){27==i.keyCode&&t.saveTitle("revert")},"{description} click":function(){var e=t.element.hasClass("editing-description");t.element.toggleClass("editing-description",!e),e||t.editDescription()},editDescriptionEvent:"click.es.story.editLinkDescription",editDescription:function(){t.element.addClass("editing-description"),setTimeout(function(){var i=t.description().clone(),n=i.hasClass("no-description");i.wrapInner(t.descriptionTextfield()),n&&t.descriptionTextfield().val(""),t.descriptionTextfield().focus()[0].select(),e(document).on(t.editDescriptionEvent,function(e){e.target!==t.descriptionTextfield()[0]&&t.saveDescription("save")})},1)},saveDescription:function(i){i||(i=save);var n=t.descriptionTextfield().val().replace(/\n/g,"<br/>");switch(i){case"save":var o=""===n;t.description().toggleClass("no-description",o),o&&(n=t.descriptionTextfield().attr("placeholder")),t.description().html(n)}t.element.find(".textareaClone").remove(),t.element.removeClass("editing-description"),e(document).off(t.editDescriptionEvent)},"{descriptionTextfield} keyup":function(e,i){27==i.keyCode&&t.saveDescription("revert")}}}),t.resolve()})}),EasySocial.module("story/locations",function(e){var t=this;EasySocial.require().library("gmaps","scrollTo").view("site/location/story.suggestion").language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR","COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR","COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR","COM_EASYSOCIAL_STREAM_AT").done(function(){var i={BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,ENTER:13,ESCAPE:27,LEFT:37,RIGHT:39,SPACE:32,TAB:9,UP:38};EasySocial.Controller("Story.Locations",{defaultOptions:{view:{suggestion:"site/location/story.suggestion"},map:{lat:0,lng:0},"{base}":"[data-story-location]","{form}":"[data-story-location-form]","{textField}":"[data-story-location-textField]","{detectButton}":"[data-story-location-detect-button]","{autocomplete}":"[data-story-location-autocomplete]","{suggestions}":"[data-story-location-suggestions]","{suggestion}":"[data-story-location-suggestion]","{textbox}":"[data-story-location-textbox]","{removeButton}":"[data-story-location-remove-button]","{map}":"[data-story-location-map]","{mapImage}":"[data-story-location-map-image]","{meta}":"[data-story-meta-location]"}},function(t,n){return{init:function(){navigator.geolocation&&t.base().addClass("is-detectable"),t.textField().placeholder(),t.textField().removeAttr("disabled")},"{window} resize":e.debounce(function(){var e=t.currentLocation;if(e){var i=t.mapImage();if(i.data("width")!==i.width()){var n=e.geometry.location,o=n.lat(),a=n.lng();t.navigate(o,a)}}},250),navigate:function(i,n){var o=t.mapImage(),a=o.width(),r=o.height(),s=e.GMaps.staticMapURL({size:[a,r],lat:i,lng:n,markers:[{lat:i,lng:n}]});o.attr("src",s).data({width:a,height:r}),t.base().addClass("has-location")},locations:{},lastQueryAddress:null,"{textField} keypress":function(n,o){switch(o.keyCode){case i.UP:var a=e(t.suggestion(".active").prev(t.suggestion.selector)[0]||t.suggestion(":last")[0]);t.suggestion().removeClass("active"),a.addClass("active").trigger("activate"),t.suggestions().scrollTo(a,{offset:-1*a.height()}),o.preventDefault();break;case i.DOWN:var r=e(t.suggestion(".active").next(t.suggestion.selector)[0]||t.suggestion(":first")[0]);t.suggestion().removeClass("active"),r.addClass("active").trigger("activate"),t.suggestions().scrollTo(r,{offset:-1*r.height()}),o.preventDefault();break;case i.ENTER:var s=t.suggestion(".active").data("location");t.set(s),t.hideSuggestions();break;case i.ESCAPE:t.hideSuggestions()}},"{textField} keyup":function(n,o){switch(o.keyCode){case i.UP:case i.DOWN:case i.LEFT:case i.RIGHT:case i.ENTER:case i.ESCAPE:break;default:var a=e.trim(n.val());""===a&&(t.base().removeClass("has-location"),t.hideSuggestions());var r=t.locations[a];r?(t.lastQueryAddress=a,t.suggest(r)):t.lookup(a)}},lookup:e.debounce(function(i){t.base().addClass("is-busy"),e.GMaps.geocode({address:i,callback:function(e,n){t.base().removeClass("is-busy"),"OK"==n&&(t.locations[i]=e,t.suggest(e),t.lastQueryAddress=i)}})},250),suggest:function(i){var n=t.suggestions();n.empty(),i.length<0||(e.each(i,function(e,i){t.view.suggestion({location:i}).data("location",i).appendTo(n)}),t.showSuggestions())},showSuggestions:function(){t.focusSuggestion=!0,t.element.find(".es-story-footer").addClass("swap-zindex"),t.story.clearMessage(),setTimeout(function(){t.autocomplete().addClass("active");var i=e(document),n="click.es.story.location";i.off(n).on(n,function(o){e(o.target).parents().andSelf().filter(t.element).length>0||(i.off(n),t.hideSuggestions())})},500)},hideSuggestions:function(){t.focusSuggestion=!1,t.autocomplete().removeClass("active"),e(document).off("click.es.story.location"),setTimeout(function(){t.focusSuggestion||t.element.find(".es-story-footer").removeClass("swap-zindex")},500)},"{suggestion} activate":function(e,i){var n=e.data("location");t.navigate(n.geometry.location.lat(),n.geometry.location.lng())},"{suggestion} mouseover":function(e){t.suggestion().removeClass("active"),e.addClass("active").trigger("activate")},"{suggestion} click":function(e,i){var n=e.data("location");t.set(n),t.hideSuggestions()},set:function(i){t.currentLocation=i;var n=i.geometry.location.lat(),o=i.geometry.location.lng();t.navigate(n,o);var a=i.formatted_address;t.textField().val(a),t.lastQueryAddress=a;var r=e('<a href="javascript: void(0);" data-story-meta-location>').html(a).toHTML(),s=e.language("COM_EASYSOCIAL_STREAM_AT")+" "+r;t.story.setMeta("location",s),t.base().addClass("has-location")},unset:function(){t.currentLocation=null,t.textField().val(""),t.story.removePanelCaption("locations"),t.mapImage().attr("src",""),t.story.setMeta("location",""),t.base().removeClass("has-location")},activatePanel:function(){setTimeout(function(){t.textField().focus()},500)},deactivatePanel:function(){var e=t.currentLocation;e&&t.set(e)},detectTimer:null,"{detectButton} click":function(){var i=t.story;t.textbox();t.base().addClass("is-busy"),clearTimeout(t.detectTimer),t.detectTimer=setTimeout(function(){i.clearMessage(),i.setMessage(e.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR")),t.base().removeClass("is-busy")},8e3),e.GMaps.geolocate({success:function(i){e.GMaps.geocode({lat:i.coords.latitude,lng:i.coords.longitude,callback:function(e,i){"OK"==i&&(t.suggest(e),t.textField().focus())}})},error:function(t){i.clearMessage();var n="";switch(t.code){case 1:n=e.language("COM_EASYSOCIAL_LOCATION_PERMISSION_ERROR");break;case 2:n=e.language("COM_EASYSOCIAL_LOCATION_TIMEOUT_ERROR");break;case 3:default:n=e.language("COM_EASYSOCIAL_LOCATION_UNAVAILABLE_ERROR")}i.setMessage(n)},always:function(){clearTimeout(t.detectTimer),t.base().removeClass("is-busy")}})},"{removeButton} click":function(){t.unset(),t.hideSuggestions()},"{meta} click":function(){t.story.activateMeta("location")},"{story} activateMeta":function(e,i,n){"location"===n.name&&setTimeout(function(){t.textField().focus()},1)},"{story} save":function(e,i,n){var o=t.currentLocation;o&&(n.data.locations_short_address=o.address_components[0].long_name,n.data.locations_formatted_address=o.formatted_address,n.data.locations_lat=o.geometry.location.lat(),n.data.locations_lng=o.geometry.location.lng(),n.data.locations_data=JSON.stringify(o))},"{story} clear":function(){t.unset(),t.hideSuggestions()}}}),t.resolve()})}),EasySocial.module("story/mood",function(e){var t=this;EasySocial.require().language("COM_EASYSOCIAL_MOOD_FEELING_CUSTOM").done(function(){EasySocial.Controller("Story.Mood",{defaultOptions:{"{base}":"[data-story-mood]","{presets}":"[data-story-mood-presets]","{preset}":"[data-story-mood-preset]","{verb}":"[data-story-mood-verb]","{verbType}":"[data-story-mood-verb-type]","{textField}":"[data-story-mood-textfield]","{removeButton}":"[data-story-mood-remove-button]"}},function(t,i){return{init:function(){t.reset(),t.textField().placeholder()},setLayout:function(){var e=t.base(),i=t.textField();e.toggleClass("is-empty",""===i.val())},currentMood:{},resetMood:function(){t.currentMood={icon:"",verb:"",subject:"",text:"",custom:!1},t.preset().removeClass("is-disabled"),t.story.setMeta("mood","")},setMood:function(i,n){var o=t.currentMood;e.isPlainObject(i)?e.extend(o,i):o[i]=n,t.base().toggleClass("using-preset",!o.custom),t.updateMeta(),t.setLayout()},getVerb:function(){return t.verbType(".active").data("storyMoodVerbType")||"feeling"},reset:function(){t.selecting=!0,t.resetMood(),t.preset().removeClass("is-disabled"),t.textField().val("").focus(),t.setLayout(),t.base().removeClass("using-preset hide-preset"),t.selecting=!1},updateMeta:function(){var e=t.currentMood,i=e.icon?'<i class="es-emoticon '+e.icon+'"></i> ':"";t.verbType().removeClass("active").filterBy("storyMoodVerbType",e.verb).addClass("active"),t.story.setMeta("mood",i+e.text)},"{preset} click":function(e){var i={icon:e.data("storyMoodIcon"),verb:e.data("storyMoodVerb"),subject:e.data("storyMoodSubject"),text:e.data("storyMoodText"),subjectText:e.data("storyMoodSubjectText"),custom:!1};t.selecting=!0,t.textField().val(i.subjectText).focus(),t.setMood(i),t.selecting=!1},"{textField} keydown":function(e,i){t.update()},"{textField} keyup":function(e,i){t.update()},"{textField} input":function(i,n){if(!t.selecting){var o=i.val();if(o){var a=t.currentMood;!a.custom&&o!==a.subjectText&&t.setMood("custom",!0);var r=t.preset().filter(function(){var t=e(this),i=0!==t.data("storyMoodSubjectText").indexOf(o);return t.toggleClass("is-disabled",i),!i});t.base().toggleClass("hide-preset",r.length<1);var s=t.getVerb(),l={verb:s,subject:"",custom:!0,text:e.language("COM_EASYSOCIAL_MOOD_"+s.toUpperCase()+"_CUSTOM",o)};t.setMood(l)}else t.reset()}},"{removeButton} click":function(){t.reset()},"{story} activateMeta":function(e,i,n){"mood"===n.name&&setTimeout(function(){t.textField().focus()},1)},"{story} save":function(e,i,n){var o=t.currentMood;o.verb&&(n.data.mood_icon=o.icon,n.data.mood_verb=o.verb,n.data.mood_subject=o.subject,n.data.mood_custom=o.custom,n.data.mood_text=o.text)},"{story} clear":function(){t.reset()}}}),t.resolve()})}),EasySocial.module("story/photos",function(e){var t=this;EasySocial.require().script("albums/uploader").done(function(){EasySocial.Controller("Story.Photos",{defaultOptions:{"{albumView}":"[data-album-view]","{albumContent}":"[data-album-content]","{uploadButton}":"[data-album-upload-button]","{photoItemGroup}":"[data-photo-item-group]","{photoItem}":"[data-photo-item]","{photoImage}":"[data-photo-image]","{photoRemoveButton}":"[data-photo-remove-button]","{uploadItem}":"[data-photo-upload-item]","{uploadRemoveButton}":".upload-remove-button"}},function(t){return{init:function(){t.uploader=t.albumView().addController(EasySocial.Controller.Albums.Uploader,e.extend({"{uploadButton}":t.uploadButton.selector,"{uploadItemGroup}":t.photoItemGroup.selector,"{uploadDropsite}":t.albumContent.selector},{settings:t.options.uploader})),t.photoItemGroup().css("opacity",1),t.addPlugin("uploader",t.uploader),t.setLayout()},hasItems:function(){var e=t.photoItem().length>0,i=t.uploadItem().length>0;return e||i},setLayout:function(){t.albumView().toggleClass("has-photos",t.hasItems())},activateAttachment:function(){},removePhoto:function(e){t.photoItem().filterBy("photoId",e).remove(),t.setLayout()},clearPhoto:function(){t.photoItem().remove(),t.uploadItem().remove(),t.setLayout()},"{uploader} FilesAdded":function(){t.setLayout(),t.uploader.start()},"{uploader} FileUploaded":function(i,n,o,a,r){var s=t.uploader.getItem(a),l=e(e.parseHTML(e.trim(r.html)));photoData=r.data,l.data("photo",photoData).addClass("new-item").insertAfter(s.element),t.uploader.removeItem(a.id),t.setLayout(),setTimeout(function(){l.removeClass("new-item")},1),t.save()},"{uploader} FileError":function(e,i,n,o,a){t.story.setMessage(a.message,"error");var r=t.uploadingPhoto;r&&(r.reject(),delete t.uploadingPhoto),t.uploader.removeItem(o.id),t.setLayout()},"{uploader} Error":function(e,i,n,o){t.story.setMessage(o.message,"error");var a=t.uploadingPhoto;a&&(a.reject(),delete t.uploadingPhoto),t.uploadRemoveButton().click(function(){setTimeout(function(){t.setLayout()},1)}),t.setLayout()},"{photoRemoveButton} click":function(e){var i=e.parent(t.photoItem.selector).data("photoId");t.removePhoto(i)},"{story} save":function(e,i,n){t.hasItems()&&(t.uploadingPhoto=n.addTask("uploadingPhoto"),t.save())},save:function(){var i=t.uploadingPhoto;if(i&&t.uploadItem().length<1){var n=[],o=i.save;t.photoItem().each(function(){n.push(e(this).data("photoId"))}),o.addData(t,n),i.resolve(),delete t.uploadingPhoto}},"{story} clear":function(){t.clearPhoto()}}}),t.resolve()})}),EasySocial.module("story/tasks",function(e){var t=this;EasySocial.require().view("apps/group/tasks/story/attachment.item").done(function(){EasySocial.Controller("Story.Tasks",{defaultOptions:{view:{taskItem:"apps/group/tasks/story/attachment.item"},"{form}":"[data-story-tasks-form]","{input}":"[data-story-tasks-input]","{list}":"[data-story-tasks-list]","{milestone}":"[data-story-tasks-milestone]"}},function(t){return{init:function(){t.implementForm()},implementForm:function(){t.form().implement(EasySocial.Controller.Story.Tasks.Form,{"{parent}":t})},createInputRow:function(i){var n=t.view.taskItem();e(n).implement(EasySocial.Controller.Story.Tasks.Form,{"{parent}":t}).appendTo(t.list()),e(n).find("input").focus()},"{story} save":function(i,n,o){var a=new Array;e.each(t.input(),function(t,i){""!=e(i).val()&&a.push(e(i).val())});var r={items:a,milestone:t.milestone().val()};o.addData(t,r)},"{story} clear":function(){}}}),EasySocial.Controller("Story.Tasks.Form",{defaultOptions:{"{input}":"[data-story-tasks-input]","{remove}":"[data-story-tasks-remove]"}},function(e){return{init:function(){},"{input} keyup":function(t,i){13==i.keyCode&&e.parent.createInputRow(e.element)},"{remove} click":function(t,i){e.element.remove()}}}),t.resolve()})}),EasySocial.module("stream",function(){var e=this;EasySocial.require().library("dialog").script("comment").view("site/likes/item").language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE","COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBSCRIBE","COM_EASYSOCIAL_STREAM_DIALOG_FEED","COM_EASYSOCIAL_STREAM_BUTTON_CLOSE").done(function(t){EasySocial.Controller("Stream.Item",{defaultOptions:{id:"","{streamItem}":".streamItem","{streamData}":".streamData","{streamResponds}":".stream-responds","{likeItem}":".likeItem","{likeItemList}":".likeItemList","{commentLink}":".commentLink","{commentFrame}":".commentFrame","{commentInput}":".commentInput","{followItem}":".followItem","{unfollowItem}":".unfollowItem","{hideItem}":".hideItem","{unhideItem}":".unhideItem"}},function(e){return{init:function(){e.commentFrame().implement("EasySocial.Controller.Comments",{uid:e.element.data("id"),pagination:new CommentPagination({total:e.commentFrame().data("total")}),commentlist:new Comment.List})},"{likeItem} click":function(){EasySocial.ajax("site:/controllers/likes/toggle",{id:e.element.data("id"),type:"stream"},{success:function(t){var i="";t.likeCount>0&&(i=e.view.likeitem({likeCount:t.likeCount})).find(".likeText").html(t.message),e.likeItemList().html(i),e.likeItem().text(t.label)},fail:function(){}})},"{unfollowItem} click":function(){var i=e.element.data("sid");i&&t.dialog({title:t.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE"),content:t.language("COM_EASYSOCIAL_SUBSCRIPTION_ARE_YOU_SURE_UNSUBSCRIBE"),buttons:[{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_UNSUBSCRIBE"),click:function(){EasySocial.ajax("site:/controllers/subscriptions/remove",{id:i},{success:function(i){t.dialog({title:t.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_UNSUBSCRIBE"),content:i.message,buttons:[{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK"),click:function(){e.unfollowItem().removeClass("unfollowItem"),t.dialog().close()}}]})},fail:function(){}})}},{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL"),click:function(){t.dialog().close()}}]})},"{followItem} click":function(){EasySocial.ajax("site:/controllers/subscriptions/form",{contentId:e.element.data("id"),contentType:"stream"},{success:function(i){""==i.message?t.dialog({title:t.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE"),content:i.htmlform,buttons:[{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_SUBMIT"),click:function(){var i=t("#esfullname").val(),n=t("#email").val();EasySocial.ajax("site:/controllers/subscriptions/add",{contentId:e.element.data("id"),contentType:"stream",esfullname:i,email:n},{success:function(i){t.dialog({title:t.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE"),content:i.message,buttons:[{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_OK"),click:function(){e.followItem().removeClass("followItem"),t.dialog().close()}}]})},fail:function(){}})}},{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL"),click:function(){t.dialog().close()}}]}):t.dialog({title:t.language("COM_EASYSOCIAL_SUBSCRIPTION_DIALOG_SUBSCRIBE"),content:i.message,buttons:[{name:t.language("COM_EASYSOCIAL_SUBSCRIPTION_BUTTON_CANCEL"),click:function(){t.dialog().close()}}]})},fail:function(){}})},"{hideItem} click":function(){EasySocial.ajax("site:/controllers/stream/hide",{id:e.element.data("id")},{success:function(t){var i="<div>"+t.message+"</div>";e.streamData().hide(),e.element.append(i)},fail:function(e){t.dialog({title:t.language("COM_EASYSOCIAL_STREAM_DIALOG_FEED"),content:e.message,buttons:[{name:t.language("COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"),click:function(){t.dialog().close()}}]})}})},"{unhideItem} click":function(){EasySocial.ajax("site:/controllers/stream/unhide",{id:e.element.data("id")},{success:function(t){e.streamData().show(),e.element.children().last().remove()},fail:function(e){t.dialog({title:t.language("COM_EASYSOCIAL_STREAM_DIALOG_FEED"),content:e.message,buttons:[{name:t.language("COM_EASYSOCIAL_STREAM_BUTTON_CLOSE"),click:function(){t.dialog().close()}}]})}})},"{commentLink} click":function(){e.commentInput().focus()}}}),e.resolve()})}),EasySocial.module("tab",function(e){var t=this;EasySocial.Controller("Tab",{defaultOptions:{view:{},"{tabs}":"","{tabsContent}":"","{defaultActive}":""}},function(t){return{init:function(){console.log("Tabs loaded"),t.defaultActive().click()},"{tabs} click":function(i){if(e(i).hasClass("inactive"))return!1;t.tabs(".active").removeClass("active"),e(i).addClass("active"),t.tabsContent().hide();var n=".tab-"+e(i).attr("id");t.tabsContent(n).show()}}}),t.resolve()}),EasySocial.module("toggle",function(e){var t=this;EasySocial.Controller("Toggle",{defaultOptions:{view:{},"{selector}":""}},function(t){return{init:function(){console.log("Toggle loaded")},"{selector} click":function(t){e(t).next().toggle(),e(t).toggleClass("this-closed")}}}),t.resolve()}),EasySocial.module("uploader/item",function(e){var t=this;EasySocial.require().view("site/uploader/preview").done(function(e){EasySocial.Controller("Uploader.Item",{defaults:{"{uploadItem}":".uploadItem","{uploadItemPreview}":".uploadItem.preview a.itemLink","{itemLink}":".itemLink","{itemDelete}":".itemDelete",view:{preview:"site/uploader/preview"}}},function(t){return{init:function(){},"{itemDelete} click":function(t){var i=e(t).data("id");EasySocial.ajax("site:/controllers/uploader/delete",{id:i},function(){e(t).parents("li.uploadItem").remove()})},"{uploadItemPreview} click":function(t){var i=e(t).data("uri"),n=e(t).data("title");e.dialog({title:n,content:e.Image.get(i)})}}})}),t.resolve()})});
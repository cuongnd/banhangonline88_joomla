EasyDiscuss.module("attachments",function(e){var t=this;EasyDiscuss.require().view("field.form.attachments.item","field.form.attachments.fileinput").done(function(e){EasyDiscuss.Controller("Attachments",{defaultOptions:{"{attachmentItem}":".attachmentItem","{fileInput}":".fileInput","{itemQueue}":".uploadQueue",view:{attachmentItem:"field.form.attachments.item",inputFile:"field.form.attachments.fileinput"}}},function(t){return{init:function(){t.attachmentItem().implement(EasyDiscuss.Controller.Attachments.Item)},getExtension:function(e){var t=e.substr(e.lastIndexOf(".")+1);switch(t){case"jpg":case"png":case"gif":t="image";break;case"zip":case"rar":t="archive";break;case"pdf":t="pdf";break;default:t="default"}return t},"{fileInput} change":function(n){n.after(t.view.inputFile({}));var r=t.view.attachmentItem({attachment:{type:t.getExtension(e(n).val()),title:e(n).val()}});r.implement(EasyDiscuss.Controller.Attachments.Item),r.append(e(n).hide()),t.itemQueue().append(r)}}}),EasyDiscuss.Controller("Attachments.Item",{defaultOptions:{"{removeItem}":".removeItem"}},function(t){return{init:function(){},"{removeItem} click":function(n){var r=e(n).data("id");r!=null?(disjax.loadingDialog(),disjax.load("attachments","confirmDelete",r+"")):t.element.remove()}}}),t.resolve()})});
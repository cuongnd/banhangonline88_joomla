EasyDiscuss.module("toolbar",function(e){(function(){var t=e.event,n=function(e,t,n,r){var i,s,o,u,a,f,l,c,h;for(i=0;i<t.length;i++){s=t[i],u=s.indexOf(".")<0,u||(l=s.split("."),s=l.shift(),c=RegExp("(^|\\.)"+l.slice(0).sort().join("\\.(?:.*\\.)?")+"(\\.|$)")),o=(e[s]||[]).slice(0);for(a=0;a<o.length;a++)f=o[a],h=u||c.test(f.namespace),h&&(r?f.selector===r&&n(s,f.origHandler||f.handler):r===null?n(s,f.origHandler||f.handler,f.selector):f.selector||n(s,f.origHandler||f.handler))}};t.find=function(t,r,i){var s=(e._data(t)||{}).events,o=[],u,a,f;return s?(n(s,r,function(e,t){o.push(t)},i),o):o},t.findBySelector=function(t,r){var i=e._data(t).events,s={},o=function(e,t,n){var r=s[e]||(s[e]={}),i=r[t]||(r[t]=[]);i.push(n)};return i?(n(i,r,function(e,t,n){o(n||"",e,t)},null),s):s},t.supportTouch="ontouchend"in document,e.fn.respondsTo=function(n){return this.length?t.find(this[0],e.isArray(n)?n:[n]).length>0:!1},e.fn.triggerHandled=function(t,n){return t=typeof t=="string"?e.Event(t):t,this.trigger(t,n),t.handled},t.setupHelper=function(n,r,i){i||(i=r,r=null);var s=function(s){var o,u=s.selector||"";u?(o=t.find(this,n,u),o.length||e(this).delegate(u,r,i)):t.find(this,n,u).length||t.add(this,r,i,{selector:u,delegate:this})},o=function(s){var o,u=s.selector||"";u?(o=t.find(this,n,u),o.length||e(this).undelegate(u,r,i)):t.find(this,n,u).length||t.remove(this,r,i,{selector:u,delegate:this})};e.each(n,function(){t.special[this]={add:s,remove:o,setup:function(){},teardown:function(){}}})};var r="ontouchend"in document,i="touchmove scroll",s=r?"touchstart":"mousedown",o=r?"touchend":"mouseup",u=r?"touchmove":"mousemove",a=function(t){var n=t.originalEvent.touches?t.originalEvent.touches[0]||t.originalEvent.changedTouches[0]:t;return{time:(new Date).getTime(),coords:[n.pageX,n.pageY],origin:e(t.target)}};e.event.setupHelper(["tap"],s,function(t){function h(o){r=a(o),(Math.abs(n.coords[0]-r.coords[0])<10||Math.abs(n.coords[1]-r.coords[1])<10)&&e.each(e.event.find(i,["tap"],s),function(){this.call(u,t,{start:n,end:r})})}var n=a(t),r,i=t.delegateTarget||t.currentTarget,s=t.handleObj.selector,u=this,f=!1,l=!0,c;c=setTimeout(function(){e(i).unbind(o,h)},500),e(i).one(o,h)})})();var t=this;EasyDiscuss.require().library("responsive").done(function(e){EasyDiscuss.Controller("Toolbar",{defaultOptions:{"{items}":".toolbarItem","{dropdowns}":".dropdown-menu","{notificationLink}":".notificationLink","{notificationDropDown}":".notificationDropDown","{notificationResult}":".notificationResult","{notificationItems}":".notificationItem","{notificationLoader}":".notificationLoader","{messageLink}":".messageLink","{messageDropDown}":".messageDropDown","{messageResult}":".messageResult","{messageLoader}":".messageLoader","{messageItems}":".messageItem","{logoutForm}":"#logoutForm","{logoutButton}":".logoutButton","{loginLink}":".loginLink","{loginDropDown}":".loginDropDown","{profileLink}":".profileLink","{profileDropDown}":".profileDropDown"}},function(t){return{init:function(){e.responsive(t.element,{elementWidth:function(){return t.element.outerWidth(!0)-15},conditions:{at:function(){var n=0;return t.items().each(function(t,r){n+=e(r).outerWidth(!0)}),n}(),alsoSwitch:{".dc_toolbar-wrapper":"narrow",".dc-button":"show","#dc_toolbar":"hidden-height"}}})},"{logoutButton} click":function(){t.logoutForm().submit()},"{loginLink} click":function(){t.messageDropDown().hide(),t.notificationDropDown().hide(),t.loginDropDown().toggle()},"{profileLink} tap":function(){t.messageDropDown().hide(),t.notificationDropDown().hide(),t.profileDropDown().toggle()},"{messageLink} tap":function(){t.profileDropDown().hide(),t.notificationDropDown().hide();if(t.messageDropDown().css("display")=="none"){var n={};n[e(".easydiscuss-token").val()]=1,EasyDiscuss.ajax("site.views.conversation.load",n,{beforeSend:function(){t.messageLoader().show(),t.messageItems().remove()},success:function(e){t.messageLoader().hide(),t.messageResult().append(e)}})}t.messageDropDown().toggle()},"{notificationLink} tap":function(){t.messageDropDown().hide(),t.profileDropDown().hide();if(t.notificationDropDown().css("display")=="none"){var n={};n[e(".easydiscuss-token").val()]=1,EasyDiscuss.ajax("site.views.notifications.load",n,{beforeSend:function(){t.notificationLoader().show(),t.notificationItems().remove()},success:function(e){t.notificationLoader().hide(),t.notificationResult().append(e)}})}t.notificationDropDown().toggle()}}}),EasyDiscuss.Controller("mod_notifications",{defaultOptions:{"{items}":".toolbarItem","{dropdowns}":".dropdown-menu","{notificationLink}":".notificationLink","{notificationDropDown}":".notificationDropDown","{notificationResult}":".notificationResult","{notificationItems}":".notificationItem","{notificationLoader}":".notificationLoader","{messageLink}":".messageLink","{messageDropDown}":".messageDropDown","{messageResult}":".messageResult","{messageLoader}":".messageLoader","{messageItems}":".messageItem","{logoutForm}":"#logoutForm","{logoutButton}":".logoutButton","{loginLink}":".loginLink","{loginDropDown}":".loginDropDown","{profileLink}":".profileLink","{profileDropDown}":".profileDropDown"}},function(t){return{init:function(){e.responsive(t.element,{elementWidth:function(){return t.element.outerWidth(!0)-15},conditions:{at:function(){var n=0;return t.items().each(function(t,r){n+=e(r).outerWidth(!0)}),n}(),alsoSwitch:{".dc_toolbar-wrapper":"narrow",".dc-button":"show","#dc_toolbar":"hidden-height"}}})},"{logoutButton} click":function(){t.logoutForm().submit()},"{loginLink} click":function(){t.messageDropDown().hide(),t.notificationDropDown().hide(),t.loginDropDown().toggle()},"{profileLink} click":function(){t.messageDropDown().hide(),t.notificationDropDown().hide(),t.profileDropDown().toggle()},"{messageLink} click":function(){t.profileDropDown().hide(),t.notificationDropDown().hide();if(t.messageDropDown().css("display")=="none"){var n={};n[e(".easydiscuss-token").val()]=1,EasyDiscuss.ajax("site.views.conversation.load",n,{beforeSend:function(){t.messageLoader().show(),t.messageItems().remove()},success:function(e){t.messageLoader().hide(),t.messageResult().append(e)}})}t.messageDropDown().toggle()},"{notificationLink} click":function(){t.messageDropDown().hide(),t.profileDropDown().hide();if(t.notificationDropDown().css("display")=="none"){var n={};n[e(".easydiscuss-token").val()]=1,EasyDiscuss.ajax("site.views.notifications.load",n,{beforeSend:function(){t.notificationLoader().show(),t.notificationItems().remove()},success:function(e){t.notificationLoader().hide(),t.notificationResult().append(e)}})}t.notificationDropDown().toggle()}}}),t.resolve()})});
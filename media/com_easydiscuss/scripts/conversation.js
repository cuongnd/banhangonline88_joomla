EasyDiscuss.module("conversation",function(e){var t=this;EasyDiscuss.require().language("COM_EASYDISCUSS_CONVERSATION_EMPTY_CONTENT").library("markitup").view("conversation.read.item").done(function(e){EasyDiscuss.Controller("Conversation.Form",{defaultOptions:{"{textEditor}":".replyMessage"}},function(e){return{init:function(){e.initBBCode()},initBBCode:function(){e.textEditor().markItUp({set:"bbcode_easydiscuss"})}}}),EasyDiscuss.Controller("Conversation.Read",{defaultOptions:{"{replyList}":".replyList","{deleteMessage}":".deleteMessage","{unreadMessage}":".unreadMessage","{replyForm}":".replyForm","{replyButton}":".replyButton","{replyMessage}":".replyMessage",messageId:null,view:{reply:"conversation.read.item"}}},function(t){return{init:function(){t.replyForm().implement(EasyDiscuss.Controller.Conversation.Form,{"{textEditor}":".replyMessage"}),t.options.messageId=t.element.data("id")},"{deleteMessage} click":function(){disjax.loadingDialog(),disjax.load("conversation","confirmDelete",t.options.messageId+"")},"{replyButton} click":function(){t.replyButton().addClass("disabled"),EasyDiscuss.ajax("site.views.conversation.reply",{id:t.options.messageId,message:t.replyMessage().val()}).done(function(n){t.replyButton().removeClass("disabled");var r=t.view.reply({post:n});e(r).find(".discuss-message-content").html(n.message),t.replyMessage().val(""),t.replyList().append(r)}).fail(function(t){e(".conversationError").addClass(" alert alert-error").html(e.language("COM_EASYDISCUSS_CONVERSATION_EMPTY_CONTENT"))})}}}),t.resolve()})});
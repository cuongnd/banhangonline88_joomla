EasyDiscuss.module("composer",function(e){var t=this;EasyDiscuss.Controller("Composer",{defaultOptions:{editorType:null,operation:null,"{editor}":"[name=dc_reply_content]","{tabs}":".formTabs [data-foundry-toggle=tab]","{form}":"form[name=dc_submit]","{attachments}":"input.fileInput","{submitButton}":".submit-reply","{cancelButton}":".cancel-reply","{notification}":".replyNotification","{loadingIndicator}":".reply-loading"}},function(e){return{init:function(){e.id=e.element.data("id"),e.options.operation=e.element.data("operation"),e.options.editorType=e.element.data("editortype"),e.options.editorType=="bbcode"&&EasyDiscuss.require().library("markitup","autogrow").done(function(t){e.editor().markItUp({set:"bbcode_easydiscuss"}).autogrow({lineBleed:1})}),e.tabs(":first").tab("show"),EasyDiscuss.module(e.id,function(){this.resolve(e)})},"{submitButton} click":function(){e.submit()},"{cancelButton} click":function(){e.trigger("cancel")},notify:function(t,n){e.notification().addClass("alert-"+t).html(n).show()},submit:function(){var t=e.form().serializeJSON();t.content=t.dc_reply_content,t.files=e.attachments(),EasyDiscuss.ajax("site.views.post.saveReply",t,{type:"iframe",beforeSend:function(){e.submitButton().attr("disabled","disabled"),e.loadingIndicator().show()},notify:e.notify,reloadCaptcha:function(){Recaptcha.reload()},complete:function(){if(e._destroyed)return;e.submitButton().removeAttr("disabled"),e.loadingIndicator().hide()}}).done(function(t){e.trigger("save",t)}).fail(e.notify)}}}),t.resolve()});
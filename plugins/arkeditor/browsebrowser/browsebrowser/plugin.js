/**
 * @license Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
(function(){function r(){var u=this.getDialog(),i=u.getParentEditor(),r,t;i._.filebrowserSe=this;r=this.filebrowser.params&&this.filebrowser.params.type||"";t=this.filebrowser.url||"";t?n.href=t:r=="Images"&&(n.href="index.php?option=com_media&view=images&tmpl=component&e_name={EDITOR}&asset=com_content&arkimage=1&author=");n.exec(i)}function t(n,i,u,f){var e,o,s;for(o in f)(e=f[o],i!="filebrowser")&&typeof e!="function"&&e!=null&&e.type!="undefined"&&e.type!=null&&(e.type&&(e.type=="hbox"||e.type=="vbox")&&t(n,i,u,e.children),e.filebrowser)&&(typeof e.filebrowser=="string"&&(s={action:e.type=="fileButton"?"QuickUpload":"Browse",target:e.filebrowser,params:"auto"},e.filebrowser=s),e.filebrowser.action=="Browse"&&(e.onClick=r))}var i=jInsertEditorText,n={href:"index.php?option=com_media&view=images&tmpl=component&e_name={EDITOR}&asset=com_content&arkmedia=1&author=",exec:function(n){var f,e,r,u,t;jInsertEditorText=function(n,t){var r="",f=this,i,u;n.match(/^<a[^>]+?href/i)?(i=CKEDITOR.dom.element.createFromHtml(n),r=i.getAttribute("href")):n.match(/^<img/i)&&(i=CKEDITOR.dom.element.createFromHtml(n),r=i.getAttribute("src"));u=CKEDITOR.instances[t];CKEDITOR.tools.callFunction(u._.filebrowserFn,r,"")};f=CKEDITOR.plugins.link;e=null;this.href=this.href.replace("{EDITOR}",n.name);r=this;u=function(n){n.cancel()};n.editable().once("blur",u,null,null,-100);SqueezeBox.open(null,{handler:"iframe",size:{x:800,y:500},url:this.href});t=function(){jInsertEditorText=i;CKEDITOR.tools.setTimeout(function(){SqueezeBox.removeEvent("onClose",t)},0,r)};SqueezeBox.addEvent("onClose",t)}};CKEDITOR.plugins.add("browsebrowser",{init:function(n){n.config.filebrowserBrowseUrl="index.php?option=com_media&view=images&tmpl=component&e_name={EDITOR}&asset=com_content&arkmedia=1&author=";n.config.filebrowserImageBrowseUrl="index.php?option=com_media&view=images&tmpl=component&e_name={EDITOR}&asset=com_content&arkimage=1&author=";CKEDITOR.on("dialogDefinition",function(n){for(var i in n.data.definition.contents)t(n.editor,n.data.name,n.data.definition,n.data.definition.contents[i].elements)})}})})()
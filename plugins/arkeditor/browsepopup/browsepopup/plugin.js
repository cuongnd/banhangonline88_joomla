/**
 * @license Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
(function(){function r(n,t){var r=[],i;if(t)for(i in t)r.push(i+"="+encodeURIComponent(t[i]));else return n;return n+(n.indexOf("?")!=-1?"&":"?")+r.join("&")}function u(){var u=this.getDialog(),i=u.getParentEditor(),r,t;i._.filebrowserSe=this;r=this.filebrowser.params&&this.filebrowser.params.type||"";t=this.filebrowser.url||"";t&&(n.href=t);n.href=r=="Images"?n.href.replace("{MEDIA}","images"):n.href.replace("{MEDIA}","documents");n.exec(i)}function t(n,i,r,f){var e,o,s;for(o in f)(e=f[o],i!="filebrowser")&&typeof e!="function"&&e!=null&&e.type!="undefined"&&e.type!=null&&(e.type&&(e.type=="hbox"||e.type=="vbox")&&t(n,i,r,e.children),e.filebrowser)&&(typeof e.filebrowser=="string"&&(s={action:e.type=="fileButton"?"QuickUpload":"Browse",target:e.filebrowser,params:"auto"},e.filebrowser=s),e.filebrowser.action=="Browse"&&(e.onClick=u))}var i=jInsertEditorText,n;CKEDITOR.tools.extend(CKEDITOR.editor.prototype,{popup:function(n,t,r,u){var e,o,f,s,h;if(t=t||"80%",r=r||"70%",typeof t=="string"&&t.length>1&&t.substr(t.length-1,1)=="%"&&(t=parseInt(window.screen.width*parseInt(t,10)/100,10)),typeof r=="string"&&r.length>1&&r.substr(r.length-1,1)=="%"&&(r=parseInt(window.screen.height*parseInt(r,10)/100,10)),t<640&&(t=640),r<420&&(r=420),e=parseInt((window.screen.height-r)/2,10),o=parseInt((window.screen.width-t)/2,10),u=(u||"location=no,menubar=no,toolbar=no,dependent=yes,minimizable=no,modal=yes,alwaysRaised=yes,resizable=yes,scrollbars=yes")+",width="+t+",height="+r+",top="+e+",left="+o,f=window.open("",null,u,!0),!f)return!1;try{s=navigator.userAgent.toLowerCase();s.indexOf(" chrome/")==-1&&(f.moveTo(o,e),f.resizeTo(t,r));f.focus();f.location.href=n}catch(c){f=window.open(n,null,u,!0)}return f&&(h=setInterval(function(){f.closed&&(clearInterval(h),jInsertEditorText=i)},1e3)),!0}},!0);n={href:"index.php?option=com_arkmedia&stack={MEDIA}",exec:function(n){var i,u;jInsertEditorText=function(n,t){var r="",f=this,i,u;n.match(/^<a[^>]+?href/i)?(i=CKEDITOR.dom.element.createFromHtml(n),r=i.getAttribute("href")):n.match(/^<img/i)&&(i=CKEDITOR.dom.element.createFromHtml(n),r=i.getAttribute("src"));u=CKEDITOR.instances[t];CKEDITOR.tools.callFunction(u._.filebrowserFn,r,"")};var f=n.config.filebrowserImageWindowWidth||n.config.filebrowserWindowWidth||"100%",e=n.config.filebrowserImageWindowHeight||n.config.filebrowserWindowHeight||(CKEDITOR.env.gecko?"92%":"100%"),t={};t.tmpl="component";t.editor="CKEDITOR";t.editorname=n.name;t.langCode||(t.language=n.langCode);t.edit=0;i=r(this.href,t);u=function(n){n.cancel()};n.editable().once("blur",u,null,null,-100);n.popup(i,f,e)}};CKEDITOR.plugins.add("browsepopup",{init:function(n){n.config.filebrowserBrowseUrl="index.php?option=com_arkmedia&stack=documents";n.config.filebrowserImageBrowseUrl="index.php?option=com_arkmedia&stack=images";CKEDITOR.on("dialogDefinition",function(n){for(var i in n.data.definition.contents)t(n.editor,n.data.name,n.data.definition,n.data.definition.contents[i].elements)})}})})()
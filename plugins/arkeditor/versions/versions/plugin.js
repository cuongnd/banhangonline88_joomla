/**
 * @license Copyright (c) 2003-2013, CKSource - Frederico Knabben. All rights reserved.
 * For licensing, see LICENSE.md or http://ckeditor.com/license
 */
(function(){var t={readOnly:1,exec:function(n){var r=n.editable(),f=n.config.versionsURL||r.getCustomData("versionsURL"),u=null,e=null,o,s;if(n.elementMode==CKEDITOR.ELEMENT_MODE_INLINE){var h=r.getCustomData("itemId"),t="com_content.content",i=r.getCustomData("itemType");context=r.getCustomData("context");typeid=0;i=="module"?(t="com_modules.custom",typeid=r.getCustomData("modTypeId")):context=="article"?typeid=i=="category"?6:1:i=="category"?(typeid=n.config.versionsCategoryTypeId||n.config.versionsTypeId,t=n.config.categoryTypeAlias||n.config.typeAlias):(typeid=n.config.versionsTypeId,t=n.config.typeAlias,i in n.config.VersionsTypeMap&&(typeid=n.config.VersionsTypeMap[i],t=n.config.VersionsElement+"."+i));typeid==6&&(t="com_content.category");f=f.replace(/\[ITEM_ID\]/,h).replace(/\[TYPE_ID\]/,typeid).replace(/\[ITEM_TYPE\]/,t);u=CKEDITOR.document.getById("sbox-window");u&&(e=CKEDITOR.document.getById("sbox-overlay"),n.focusManager.add(u,1),n.focusManager.add(e,1))}if(o=f,jQuery.fn.squeezeBox?jQuery.fn.squeezeBox({handler:"iframe",size:{x:800,y:500},url:o},!0):SqueezeBox.open(null,{handler:"iframe",size:{x:800,y:500},url:o}),n.elementMode==CKEDITOR.ELEMENT_MODE_INLINE)if(s=function(){u&&(n.focusManager.remove(u,1),n.focusManager.remove(e,1))},jQuery.fn.squeezeBox)jQuery(ARK.squeezeBox).on("onClose",function(){s();jQuery(ARK.squeezeBox).off("onClose")});else SqueezeBox.addEvent("onClose",function(){s();this.removeEvents("onClose")})}},n="versions";CKEDITOR.plugins.add(n,{icons:"versions",hidpi:!1,init:function(i){var u=i.element,f=u.getAttribute("data-itemType"),e=i.config.typeAlias,r;(e||i.elementMode!=CKEDITOR.ELEMENT_MODE_REPLACE)&&(f!="module"||i.config.enableModuleHistory)&&(r=i.addCommand(n,t),r.modes={wysiwyg:1},i.ui.addButton&&i.ui.addButton("Versions",{label:"Versions",command:n}))}})})()
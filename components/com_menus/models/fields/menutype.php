<?php/** * @package     Joomla.Administrator * @subpackage  com_menus * * @copyright   Copyright (C) 2005 - 2016 Open Source Matters, Inc. All rights reserved. * @license     GNU General Public License version 2 or later; see LICENSE.txt */defined('JPATH_BASE') or die;JFormHelper::loadFieldClass('list');/** * Form Field class for the Joomla Framework. * * @since  1.6 */class JFormFieldMenutype extends JFormFieldList{	/**	 * The form field type.	 *	 * @var		string	 * @since   1.6	 */	protected $type = 'menutype';	/**	 * Method to get the field input markup.	 *	 * @return  string	The field input markup.	 *	 * @since   1.6	 */	protected function getInput()	{		$html     = array();		$doc=JFactory::getDocument();		$recordId = (int) $this->form->getValue('id');		$size     = ($v = $this->element['size']) ? ' size="' . $v . '"' : '';		$class    = ($v = $this->element['class']) ? ' class="' . $v . '"' : 'class="text_area"';		$required = ($v = $this->element['required']) ? ' required="required"' : '';		// Get a reverse lookup of the base link URL to Title		$model = JModelLegacy::getInstance('menutypes', 'menusModel');		$rlu   = $model->getReverseLookup();		switch ($this->value)		{			case 'url':				$value = JText::_('COM_MENUS_TYPE_EXTERNAL_URL');				break;			case 'alias':				$value = JText::_('COM_MENUS_TYPE_ALIAS');				break;			case 'separator':				$value = JText::_('COM_MENUS_TYPE_SEPARATOR');				break;			case 'heading':				$value = JText::_('COM_MENUS_TYPE_HEADING');				break;			default:				$link = $this->form->getValue('link');				// Clean the link back to the option, view and layout				$value = JText::_(JArrayHelper::getValue($rlu, MenusHelper::getLinkKey($link)));				break;		}		// Include jQuery		JHtml::_('jqueryfrontend.framework');		// Add the script to the document head.		JFactory::getDocument()->addScriptDeclaration('			function jSelectPosition_' . $this->id . '(name) {				document.getElementById("' . $this->id . '").value = name;			}		');		$link = JRoute::_('index.php?option=com_menus&view=menutypes&tmpl=component&recordId=' . $recordId);		ob_start();		?>		<span class="input-append">			<input type="text" <?php echo $required ?> readonly="readonly" id="<?php echo $this->id ?>" value="<?php echo $value ?>" <?php echo  $size . $class ?> />			<a  role="button" class="btn btn-primary" data-toggle="modal" data-target="#menuTypeModal" title="<?php echo JText::_('JSELECT') ?>">			<span class="icon-list icon-white"></span><?php echo JText::_('JSELECT') ?></a>		</span>'		<input class="input-small" type="hidden" name="<?php echo $this->name ?>" value="<?php echo htmlspecialchars($this->value, ENT_COMPAT, 'UTF-8') ?>" />		<!-- Modal -->		<div class="modal fade" id="menuTypeModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">			<div class="modal-dialog" role="document">				<div class="modal-content">					<div class="modal-header">						<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>						<h4 class="modal-title" id="myModalLabel">Select menu type</h4>					</div>					<div class="modal-body">						<div class="embed-responsive embed-responsive-16by9">							<iframe src="<?php echo $link ?>" class="embed-responsive-item" frameborder="0"></iframe>						</div>					</div>					<div class="modal-footer">						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>						<button type="button" class="btn btn-primary">Save changes</button>					</div>				</div>			</div>		</div>		<?php		$html=ob_get_clean();		ob_start();		?>		<script type="text/javascript">			jQuery(document).ready(function ($) {			});		</script>		<?php		$script=ob_get_clean();		$script=JUtility::remove_string_javascript($script);		$doc->addScriptDeclaration($script);		return $html;	}}
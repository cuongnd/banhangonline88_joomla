<?php/** * @version    CVS: 1.0.0 * @package    Com_Modules * @author     cuong <nguyendinhcuong@gmail.com> * @copyright  2016 cuong * @license    GNU General Public License version 2 or later; see LICENSE.txt */// No direct accessdefined('_JEXEC') or die;use Joomla\Registry\Registry;jimport('joomla.application.component.controllerform');/** * Module controller class. * * @since  1.6 */class ModulesControllerModule extends JControllerLegacy{	public function ajax_render_module()	{		$input=JFactory::getApplication()->input;		$post=json_decode(file_get_contents('php://input'));		if(!$post){		    $post=(object)$input->getArray();		}		$module_id=$post->module_id;		$params=$post->params;		//$module_id=334;		$table_module=JTable::getInstance('module');		$table_module->load($module_id);		$module_name=$table_module->module;		$helper_file=JPATH_ROOT.DS."modules/$module_name/helper.php";		$html='';		if(JFile::exists($helper_file))		{			require_once $helper_file;		}		$module=(object)$table_module->getProperties();        $temp = new Registry;        $temp->loadString($module->params);        if($params){            $post_params = new Registry;            $post_params->loadObject($params);            $temp->merge($post_params);        }        $module->params=$temp;        $html=JModuleHelper::renderModule($module);		echo new JResponseJson($html, null, false, $input->get('ignoreMessages', true, 'bool'));	}	public function app_ajax_render_module()	{		$input=JFactory::getApplication()->input;		$post=json_decode(file_get_contents('php://input'));		if(!$post){		    $post=(object)$input->getArray();		}		$module_id=$post->module_id;		$params=$post->params;        if(is_string($params)){            $params=json_decode($params);        }		//$module_id=334;		$table_module=JTable::getInstance('module');		$table_module->load($module_id);		$module_name=$table_module->module;		$helper_file=JPATH_ROOT.DS."modules/$module_name/helper.php";		$html='';		if(JFile::exists($helper_file))		{			require_once $helper_file;		}		$module=(object)$table_module->getProperties();        $temp = new Registry;        $temp->loadString($module->params);        if($params){            $post_params = new Registry;            $post_params->loadObject($params);            $temp->merge($post_params);        }        $module->params=$temp;        $html=JModuleHelper::renderModule($module);		echo $html;	}}
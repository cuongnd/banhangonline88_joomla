<?php/** * @package    HikaShop for Joomla! * @version    2.6.3 * @author    hikashop.com * @copyright    (C) 2010-2016 HIKARI SOFTWARE. All rights reserved. * @license    GNU/GPLv3 http://www.gnu.org/licenses/gpl-3.0.html */defined('_JEXEC') or die('Restricted access');?><?php$mainDivName = $this->params->get('main_div_name', '');$link='product&task=show&cid=' . $this->row->product_id . '&name=' . $this->row->alias . $this->itemid . $this->category_pathway;$this->row->link = hikashop_contentLink($link, $this->row);if($this->user->user_id){    $this->row->affiliate_link = hikashop_contentLink($link.'&partner_id='.$this->user->user_id, $this->row);}else{    $this->row->affiliate_link=$this->row->link;}if (!empty($this->row->extraData->top)) {    echo implode("\r\n", $this->row->extraData->top);}?><div class="hikashop_listing_img_title" id="div_<?php echo $mainDivName . '_' . $this->row->product_id; ?>">    <?php    if ($this->config->get('thumbnail', 1)) {        ?>        <!-- PRODUCT IMG -->        <div class="hikashop_product_image">            <div class="hikashop_product_image_subdiv">                <?php if ($this->params->get('link_to_product_page', 1)){ ?>                <a href="<?php echo $this->row->link; ?>" title="<?php echo $this->escape($this->row->product_name); ?>">                    <?php }                    $image_options = array('default' => true, 'forcesize' => $this->config->get('image_force_size', true), 'scale' => $this->config->get('image_scale_mode', 'inside'));                    $img = $this->image->getThumbnail(@$this->row->file_path, array('width' => $this->image->main_thumbnail_x, 'height' => $this->image->main_thumbnail_y), $image_options);                    $this->row->image_url=$img->url;                    if ($img->success) {                        echo '<img class="hikashop_product_listing_image img-responsive " title="' . $this->escape(@$this->row->file_description) . '" alt="' . $this->escape(@$this->row->file_name) . '" data-src="' . $img->url . '"/>';                    }                    $main_thumb_x = $this->image->main_thumbnail_x;                    $main_thumb_y = $this->image->main_thumbnail_y;                    if ($this->params->get('display_badges', 1)) {                        $this->classbadge->placeBadges($this->image, $this->row->badges, -10, 0);                    }                    $this->image->main_thumbnail_x = $main_thumb_x;                    $this->image->main_thumbnail_y = $main_thumb_y;                    if ($this->params->get('link_to_product_page', 1)){ ?>                </a>            <?php } ?>            </div>        </div>        <!-- EO PRODUCT IMG -->    <?php } ?>    <!-- PRODUCT PRICE -->    <?php    if ($this->params->get('show_price', '-1') == '-1') {        $config =& hikashop_config();        $this->params->set('show_price', $config->get('show_price'));    }    $link=$this->row->affiliate_link;    $title=$this->row->product_name;    $link=JUri::root().substr($link,1);    $image_url=$this->row->image_url;    $image_url=JUri::root().substr($image_url,1);    JPluginHelper::importPlugin('system');    $result = $this->dispatcher->trigger('kashopsocial_product_listing', array($link, $image_url,$title));    //echo $result[0];    if ($this->params->get('show_price')) {        $this->setLayout('listing_price');        echo $this->loadTemplate();    }    ?>    <!-- EO PRODUCT PRICE -->    <!-- PRODUCT NAME -->	<h3 class="hikashop_product_name">		<?php if ($this->params->get('link_to_product_page', 1)){ ?>        <a href="<?php echo $this->row->link; ?>">            <?php }            echo $this->row->product_name;            if ($this->params->get('link_to_product_page', 1)){ ?>        </a>    <?php } ?>	</h3>    <!-- EO PRODUCT NAME -->    <!-- PRODUCT CODE -->    <?php if ($this->config->get('show_code')) { ?>        <span class='hikashop_product_code_list'>			<?php if ($this->config->get('show_code')) { ?>                <span cdata="hikashop_product_code_label"><?php echo JText::_('HIKA_PRODUCTION_CODE') ?> : </span>				<?php if ($this->params->get('link_to_product_page', 1)) { ?>                    <a href="<?php echo $this->row->link; ?>">                <?php }                echo $this->row->product_code;                if ($this->params->get('link_to_product_page', 1)) { ?>                    </a>                <?php } ?>            <?php } ?>		</span>        <br/>    <?php } ?>    <!-- EO PRODUCT CODE -->    <?php    $vendorLink="";    $vendor_name="test";    ?>    <!-- Chat vendor-->   <!-- <div class="chatting">        <button data-admin_vendor_user_cms_id="<?php /*$row->product_vendor_id */?>"   class="btn btn-link talking-to-suppliers pull-left"><img src="/templates/vina_bonnie/images/vchat.gif"></button>        <a class="" href="<?php /*echo $vendorLink */?>"><?php /*echo $vendor_name */?></a>    </div>-->    <!-- EO chat vendor -->    <!-- PRODUCT CUSTOM FIELDS -->    <?php    if ($this->config->get('display_custom_item_fields')) {        if (!empty($this->productFields)) {            foreach ($this->productFields as $fieldName => $oneExtraField) {                if (!empty($this->row->$fieldName) || (isset($this->row->$fieldName) && $this->row->$fieldName === '0')) {                    ?>                    <dl class="hikashop_product_custom_<?php echo $oneExtraField->field_namekey; ?>_line">                        <dt class="hikashop_product_custom_name">                            <?php echo $this->fieldsClass->getFieldName($oneExtraField); ?>                        </dt>                        <dd class="hikashop_product_custom_value">                            <?php echo $this->fieldsClass->show($oneExtraField, $this->row->$fieldName); ?>                        </dd>                    </dl>                    <?php                }            }        }    }    ?>    <!-- EO PRODUCT CUSTOM FIELDS -->    <?php if (!empty($this->row->extraData->afterProductName)) {        echo implode("\r\n", $this->row->extraData->afterProductName);    } ?>    <!-- PRODUCT VOTE -->    <?php    if ($this->params->get('show_vote_product')) {        $this->setLayout('listing_vote');        echo $this->loadTemplate();    }    ?>    <!-- EO PRODUCT VOTE -->    <!-- ADD TO CART BUTTON AREA -->    <?php    if ($this->params->get('add_to_cart') || $this->params->get('add_to_wishlist')) {        $this->setLayout('add_to_cart_listing');        echo $this->loadTemplate();    } ?>    <!-- EO ADD TO CART BUTTON AREA -->    <!-- COMPARISON AREA -->    <?php    if (JRequest::getVar('hikashop_front_end_main', 0) && JRequest::getVar('task') == 'listing' && $this->params->get('show_compare')) { ?>        <br/><?php        if ($this->params->get('show_compare') == 1) {            $js = 'setToCompareList(' . $this->row->product_id . ',\'' . $this->escape($this->row->product_name) . '\',this); return false;';            echo $this->cart->displayButton(JText::_('ADD_TO_COMPARE_LIST'), 'compare', $this->params, $this->row->link, $js, '', 0, 1, 'hikashop_compare_button');            ?>        <?php } else { ?>            <input type="checkbox" class="hikashop_compare_checkbox"                   id="hikashop_listing_chk_<?php echo $this->row->product_id; ?>"                   onchange="setToCompareList(<?php echo $this->row->product_id; ?>,'<?php echo $this->escape($this->row->product_name); ?>',this);">            <label                for="hikashop_listing_chk_<?php echo $this->row->product_id; ?>"><?php echo JText::_('ADD_TO_COMPARE_LIST'); ?></label>        <?php }    } ?>    <?php    ?>    <!-- EO COMPARISON AREA -->    <div class="list-icon-info">        <i class="icon icon-online"></i>    </div></div><?phpif (!empty($this->row->extraData->bottom)) {    echo implode("\r\n", $this->row->extraData->bottom);}if ($this->rows[0]->product_id == $this->row->product_id) {    ?>    <style>        #        <?php echo $mainDivName; ?>        .hikashop_product_image {            height: <?php echo $this->image->main_thumbnail_y;?>px;            text-align: center;            clear: both;        }        #        <?php echo $mainDivName; ?>        .hikashop_product_image_subdiv {            position: relative;            text-align: center;            clear: both;            width: 100%;            margin: auto;        }    </style>    <?php}?>